var IT=Object.defineProperty;var CT=(t,e,n)=>e in t?IT(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ry=(t,e,n)=>CT(t,typeof e!="symbol"?e+"":e,n);function X3(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const o=Object.getOwnPropertyDescriptor(i,r);o&&Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();function X0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var E3={exports:{}},E0={},Y3={exports:{}},xn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kh=Symbol.for("react.element"),hT=Symbol.for("react.portal"),fT=Symbol.for("react.fragment"),mT=Symbol.for("react.strict_mode"),AT=Symbol.for("react.profiler"),pT=Symbol.for("react.provider"),vT=Symbol.for("react.context"),bT=Symbol.for("react.forward_ref"),yT=Symbol.for("react.suspense"),GT=Symbol.for("react.memo"),BT=Symbol.for("react.lazy"),pR=Symbol.iterator;function ST(t){return t===null||typeof t!="object"?null:(t=pR&&t[pR]||t["@@iterator"],typeof t=="function"?t:null)}var z3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},K3=Object.assign,L3={};function Dd(t,e,n){this.props=t,this.context=e,this.refs=L3,this.updater=n||z3}Dd.prototype.isReactComponent={};Dd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Dd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function T3(){}T3.prototype=Dd.prototype;function OS(t,e,n){this.props=t,this.context=e,this.refs=L3,this.updater=n||z3}var JS=OS.prototype=new T3;JS.constructor=OS;K3(JS,Dd.prototype);JS.isPureReactComponent=!0;var vR=Array.isArray,_3=Object.prototype.hasOwnProperty,QS={current:null},k3={key:!0,ref:!0,__self:!0,__source:!0};function P3(t,e,n){var i,r={},o=null,a=null;if(e!=null)for(i in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(o=""+e.key),e)_3.call(e,i)&&!k3.hasOwnProperty(i)&&(r[i]=e[i]);var s=arguments.length-2;if(s===1)r.children=n;else if(1<s){for(var l=Array(s),c=0;c<s;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(i in s=t.defaultProps,s)r[i]===void 0&&(r[i]=s[i]);return{$$typeof:Kh,type:t,key:o,ref:a,props:r,_owner:QS.current}}function wT(t,e){return{$$typeof:Kh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function jS(t){return typeof t=="object"&&t!==null&&t.$$typeof===Kh}function ZT(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var bR=/\/+/g;function oy(t,e){return typeof t=="object"&&t!==null&&t.key!=null?ZT(""+t.key):e.toString(36)}function TA(t,e,n,i,r){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Kh:case hT:a=!0}}if(a)return a=t,r=r(a),t=i===""?"."+oy(a,0):i,vR(r)?(n="",t!=null&&(n=t.replace(bR,"$&/")+"/"),TA(r,e,n,"",function(c){return c})):r!=null&&(jS(r)&&(r=wT(r,n+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(bR,"$&/")+"/")+t)),e.push(r)),1;if(a=0,i=i===""?".":i+":",vR(t))for(var s=0;s<t.length;s++){o=t[s];var l=i+oy(o,s);a+=TA(o,e,n,l,r)}else if(l=ST(t),typeof l=="function")for(t=l.call(t),s=0;!(o=t.next()).done;)o=o.value,l=i+oy(o,s++),a+=TA(o,e,n,l,r);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function lm(t,e,n){if(t==null)return t;var i=[],r=0;return TA(t,i,"","",function(o){return e.call(n,o,r++)}),i}function xT(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var to={current:null},_A={transition:null},RT={ReactCurrentDispatcher:to,ReactCurrentBatchConfig:_A,ReactCurrentOwner:QS};function U3(){throw Error("act(...) is not supported in production builds of React.")}xn.Children={map:lm,forEach:function(t,e,n){lm(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return lm(t,function(){e++}),e},toArray:function(t){return lm(t,function(e){return e})||[]},only:function(t){if(!jS(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};xn.Component=Dd;xn.Fragment=fT;xn.Profiler=AT;xn.PureComponent=OS;xn.StrictMode=mT;xn.Suspense=yT;xn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=RT;xn.act=U3;xn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=K3({},t.props),r=t.key,o=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,a=QS.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var s=t.type.defaultProps;for(l in e)_3.call(e,l)&&!k3.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&s!==void 0?s[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){s=Array(l);for(var c=0;c<l;c++)s[c]=arguments[c+2];i.children=s}return{$$typeof:Kh,type:t.type,key:r,ref:o,props:i,_owner:a}};xn.createContext=function(t){return t={$$typeof:vT,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:pT,_context:t},t.Consumer=t};xn.createElement=P3;xn.createFactory=function(t){var e=P3.bind(null,t);return e.type=t,e};xn.createRef=function(){return{current:null}};xn.forwardRef=function(t){return{$$typeof:bT,render:t}};xn.isValidElement=jS;xn.lazy=function(t){return{$$typeof:BT,_payload:{_status:-1,_result:t},_init:xT}};xn.memo=function(t,e){return{$$typeof:GT,type:t,compare:e===void 0?null:e}};xn.startTransition=function(t){var e=_A.transition;_A.transition={};try{t()}finally{_A.transition=e}};xn.unstable_act=U3;xn.useCallback=function(t,e){return to.current.useCallback(t,e)};xn.useContext=function(t){return to.current.useContext(t)};xn.useDebugValue=function(){};xn.useDeferredValue=function(t){return to.current.useDeferredValue(t)};xn.useEffect=function(t,e){return to.current.useEffect(t,e)};xn.useId=function(){return to.current.useId()};xn.useImperativeHandle=function(t,e,n){return to.current.useImperativeHandle(t,e,n)};xn.useInsertionEffect=function(t,e){return to.current.useInsertionEffect(t,e)};xn.useLayoutEffect=function(t,e){return to.current.useLayoutEffect(t,e)};xn.useMemo=function(t,e){return to.current.useMemo(t,e)};xn.useReducer=function(t,e,n){return to.current.useReducer(t,e,n)};xn.useRef=function(t){return to.current.useRef(t)};xn.useState=function(t){return to.current.useState(t)};xn.useSyncExternalStore=function(t,e,n){return to.current.useSyncExternalStore(t,e,n)};xn.useTransition=function(){return to.current.useTransition()};xn.version="18.3.1";Y3.exports=xn;var y=Y3.exports;const ze=X0(y),Y0=X3({__proto__:null,default:ze},[y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WT=y,VT=Symbol.for("react.element"),MT=Symbol.for("react.fragment"),NT=Object.prototype.hasOwnProperty,FT=WT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,HT={key:!0,ref:!0,__self:!0,__source:!0};function D3(t,e,n){var i,r={},o=null,a=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(i in e)NT.call(e,i)&&!HT.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:VT,type:t,key:o,ref:a,props:r,_owner:FT.current}}E0.Fragment=MT;E0.jsx=D3;E0.jsxs=D3;E3.exports=E0;var Nt=E3.exports,O3={exports:{}},Oo={},J3={exports:{}},Q3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,L){var z=F.length;F.push(L);e:for(;0<z;){var K=z-1>>>1,O=F[K];if(0<r(O,L))F[K]=L,F[z]=O,z=K;else break e}}function n(F){return F.length===0?null:F[0]}function i(F){if(F.length===0)return null;var L=F[0],z=F.pop();if(z!==L){F[0]=z;e:for(var K=0,O=F.length,j=O>>>1;K<j;){var P=2*(K+1)-1,$=F[P],oe=P+1,ie=F[oe];if(0>r($,z))oe<O&&0>r(ie,$)?(F[K]=ie,F[oe]=z,K=oe):(F[K]=$,F[P]=z,K=P);else if(oe<O&&0>r(ie,z))F[K]=ie,F[oe]=z,K=oe;else break e}}return L}function r(F,L){var z=F.sortIndex-L.sortIndex;return z!==0?z:F.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,s=a.now();t.unstable_now=function(){return a.now()-s}}var l=[],c=[],g=1,u=null,d=3,C=!1,f=!1,v=!1,p=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(F){for(var L=n(c);L!==null;){if(L.callback===null)i(c);else if(L.startTime<=F)i(c),L.sortIndex=L.expirationTime,e(l,L);else break;L=n(c)}}function G(F){if(v=!1,b(F),!f)if(n(l)!==null)f=!0,k(w);else{var L=n(c);L!==null&&J(G,L.startTime-F)}}function w(F,L){f=!1,v&&(v=!1,m(x),x=-1),C=!0;var z=d;try{for(b(L),u=n(l);u!==null&&(!(u.expirationTime>L)||F&&!M());){var K=u.callback;if(typeof K=="function"){u.callback=null,d=u.priorityLevel;var O=K(u.expirationTime<=L);L=t.unstable_now(),typeof O=="function"?u.callback=O:u===n(l)&&i(l),b(L)}else i(l);u=n(l)}if(u!==null)var j=!0;else{var P=n(c);P!==null&&J(G,P.startTime-L),j=!1}return j}finally{u=null,d=z,C=!1}}var S=!1,Z=null,x=-1,R=5,W=-1;function M(){return!(t.unstable_now()-W<R)}function N(){if(Z!==null){var F=t.unstable_now();W=F;var L=!0;try{L=Z(!0,F)}finally{L?X():(S=!1,Z=null)}}else S=!1}var X;if(typeof A=="function")X=function(){A(N)};else if(typeof MessageChannel<"u"){var E=new MessageChannel,Q=E.port2;E.port1.onmessage=N,X=function(){Q.postMessage(null)}}else X=function(){p(N,0)};function k(F){Z=F,S||(S=!0,X())}function J(F,L){x=p(function(){F(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){f||C||(f=!0,k(w))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(F){switch(d){case 1:case 2:case 3:var L=3;break;default:L=d}var z=d;d=L;try{return F()}finally{d=z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,L){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var z=d;d=F;try{return L()}finally{d=z}},t.unstable_scheduleCallback=function(F,L,z){var K=t.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?K+z:K):z=K,F){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=z+O,F={id:g++,callback:L,priorityLevel:F,startTime:z,expirationTime:O,sortIndex:-1},z>K?(F.sortIndex=z,e(c,F),n(l)===null&&F===n(c)&&(v?(m(x),x=-1):v=!0,J(G,z-K))):(F.sortIndex=O,e(l,F),f||C||(f=!0,k(w))),F},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(F){var L=d;return function(){var z=d;d=L;try{return F.apply(this,arguments)}finally{d=z}}}})(Q3);J3.exports=Q3;var XT=J3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ET=y,Uo=XT;function xt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var j3=new Set,TC={};function Eg(t,e){Gd(t,e),Gd(t+"Capture",e)}function Gd(t,e){for(TC[t]=e,t=0;t<e.length;t++)j3.add(e[t])}var rl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),AB=Object.prototype.hasOwnProperty,YT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,yR={},GR={};function zT(t){return AB.call(GR,t)?!0:AB.call(yR,t)?!1:YT.test(t)?GR[t]=!0:(yR[t]=!0,!1)}function KT(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function LT(t,e,n,i){if(e===null||typeof e>"u"||KT(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function no(t,e,n,i,r,o,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var fr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){fr[t]=new no(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];fr[e]=new no(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){fr[t]=new no(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){fr[t]=new no(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){fr[t]=new no(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){fr[t]=new no(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){fr[t]=new no(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){fr[t]=new no(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){fr[t]=new no(t,5,!1,t.toLowerCase(),null,!1,!1)});var $S=/[\-:]([a-z])/g;function qS(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace($S,qS);fr[e]=new no(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace($S,qS);fr[e]=new no(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace($S,qS);fr[e]=new no(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){fr[t]=new no(t,1,!1,t.toLowerCase(),null,!1,!1)});fr.xlinkHref=new no("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){fr[t]=new no(t,1,!1,t.toLowerCase(),null,!0,!0)});function ew(t,e,n,i){var r=fr.hasOwnProperty(e)?fr[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(LT(e,n,r,i)&&(n=null),i||r===null?zT(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var ul=ET.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,cm=Symbol.for("react.element"),_u=Symbol.for("react.portal"),ku=Symbol.for("react.fragment"),tw=Symbol.for("react.strict_mode"),pB=Symbol.for("react.profiler"),$3=Symbol.for("react.provider"),q3=Symbol.for("react.context"),nw=Symbol.for("react.forward_ref"),vB=Symbol.for("react.suspense"),bB=Symbol.for("react.suspense_list"),iw=Symbol.for("react.memo"),Yl=Symbol.for("react.lazy"),e5=Symbol.for("react.offscreen"),BR=Symbol.iterator;function GI(t){return t===null||typeof t!="object"?null:(t=BR&&t[BR]||t["@@iterator"],typeof t=="function"?t:null)}var mi=Object.assign,ay;function aC(t){if(ay===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);ay=e&&e[1]||""}return`
`+ay+t}var sy=!1;function ly(t,e){if(!t||sy)return"";sy=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var i=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){i=c}t.call(e.prototype)}else{try{throw Error()}catch(c){i=c}t()}}catch(c){if(c&&i&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),o=i.stack.split(`
`),a=r.length-1,s=o.length-1;1<=a&&0<=s&&r[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(r[a]!==o[s]){if(a!==1||s!==1)do if(a--,s--,0>s||r[a]!==o[s]){var l=`
`+r[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=s);break}}}finally{sy=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?aC(t):""}function TT(t){switch(t.tag){case 5:return aC(t.type);case 16:return aC("Lazy");case 13:return aC("Suspense");case 19:return aC("SuspenseList");case 0:case 2:case 15:return t=ly(t.type,!1),t;case 11:return t=ly(t.type.render,!1),t;case 1:return t=ly(t.type,!0),t;default:return""}}function yB(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ku:return"Fragment";case _u:return"Portal";case pB:return"Profiler";case tw:return"StrictMode";case vB:return"Suspense";case bB:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case q3:return(t.displayName||"Context")+".Consumer";case $3:return(t._context.displayName||"Context")+".Provider";case nw:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case iw:return e=t.displayName||null,e!==null?e:yB(t.type)||"Memo";case Yl:e=t._payload,t=t._init;try{return yB(t(e))}catch{}}return null}function _T(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return yB(e);case 8:return e===tw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function oc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function t5(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function kT(t){var e=t5(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){i=""+a,o.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function gm(t){t._valueTracker||(t._valueTracker=kT(t))}function n5(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=t5(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function Ap(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function GB(t,e){var n=e.checked;return mi({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function SR(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=oc(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function i5(t,e){e=e.checked,e!=null&&ew(t,"checked",e,!1)}function BB(t,e){i5(t,e);var n=oc(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?SB(t,e.type,n):e.hasOwnProperty("defaultValue")&&SB(t,e.type,oc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function wR(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function SB(t,e,n){(e!=="number"||Ap(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var sC=Array.isArray;function gd(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+oc(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function wB(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(xt(91));return mi({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ZR(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(xt(92));if(sC(n)){if(1<n.length)throw Error(xt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:oc(n)}}function r5(t,e){var n=oc(e.value),i=oc(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function xR(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function o5(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ZB(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?o5(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var um,a5=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(um=um||document.createElement("div"),um.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=um.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function _C(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var CC={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},PT=["Webkit","ms","Moz","O"];Object.keys(CC).forEach(function(t){PT.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),CC[e]=CC[t]})});function s5(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||CC.hasOwnProperty(t)&&CC[t]?(""+e).trim():e+"px"}function l5(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=s5(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var UT=mi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xB(t,e){if(e){if(UT[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(xt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(xt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(xt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(xt(62))}}function RB(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var WB=null;function rw(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var VB=null,ud=null,dd=null;function RR(t){if(t=_h(t)){if(typeof VB!="function")throw Error(xt(280));var e=t.stateNode;e&&(e=_0(e),VB(t.stateNode,t.type,e))}}function c5(t){ud?dd?dd.push(t):dd=[t]:ud=t}function g5(){if(ud){var t=ud,e=dd;if(dd=ud=null,RR(t),e)for(t=0;t<e.length;t++)RR(e[t])}}function u5(t,e){return t(e)}function d5(){}var cy=!1;function I5(t,e,n){if(cy)return t(e,n);cy=!0;try{return u5(t,e,n)}finally{cy=!1,(ud!==null||dd!==null)&&(d5(),g5())}}function kC(t,e){var n=t.stateNode;if(n===null)return null;var i=_0(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(xt(231,e,typeof n));return n}var MB=!1;if(rl)try{var BI={};Object.defineProperty(BI,"passive",{get:function(){MB=!0}}),window.addEventListener("test",BI,BI),window.removeEventListener("test",BI,BI)}catch{MB=!1}function DT(t,e,n,i,r,o,a,s,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(g){this.onError(g)}}var hC=!1,pp=null,vp=!1,NB=null,OT={onError:function(t){hC=!0,pp=t}};function JT(t,e,n,i,r,o,a,s,l){hC=!1,pp=null,DT.apply(OT,arguments)}function QT(t,e,n,i,r,o,a,s,l){if(JT.apply(this,arguments),hC){if(hC){var c=pp;hC=!1,pp=null}else throw Error(xt(198));vp||(vp=!0,NB=c)}}function Yg(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function C5(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function WR(t){if(Yg(t)!==t)throw Error(xt(188))}function jT(t){var e=t.alternate;if(!e){if(e=Yg(t),e===null)throw Error(xt(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var o=r.alternate;if(o===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return WR(r),t;if(o===i)return WR(r),e;o=o.sibling}throw Error(xt(188))}if(n.return!==i.return)n=r,i=o;else{for(var a=!1,s=r.child;s;){if(s===n){a=!0,n=r,i=o;break}if(s===i){a=!0,i=r,n=o;break}s=s.sibling}if(!a){for(s=o.child;s;){if(s===n){a=!0,n=o,i=r;break}if(s===i){a=!0,i=o,n=r;break}s=s.sibling}if(!a)throw Error(xt(189))}}if(n.alternate!==i)throw Error(xt(190))}if(n.tag!==3)throw Error(xt(188));return n.stateNode.current===n?t:e}function h5(t){return t=jT(t),t!==null?f5(t):null}function f5(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=f5(t);if(e!==null)return e;t=t.sibling}return null}var m5=Uo.unstable_scheduleCallback,VR=Uo.unstable_cancelCallback,$T=Uo.unstable_shouldYield,qT=Uo.unstable_requestPaint,xi=Uo.unstable_now,e_=Uo.unstable_getCurrentPriorityLevel,ow=Uo.unstable_ImmediatePriority,A5=Uo.unstable_UserBlockingPriority,bp=Uo.unstable_NormalPriority,t_=Uo.unstable_LowPriority,p5=Uo.unstable_IdlePriority,z0=null,ps=null;function n_(t){if(ps&&typeof ps.onCommitFiberRoot=="function")try{ps.onCommitFiberRoot(z0,t,void 0,(t.current.flags&128)===128)}catch{}}var _a=Math.clz32?Math.clz32:o_,i_=Math.log,r_=Math.LN2;function o_(t){return t>>>=0,t===0?32:31-(i_(t)/r_|0)|0}var dm=64,Im=4194304;function lC(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function yp(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,o=t.pingedLanes,a=n&268435455;if(a!==0){var s=a&~r;s!==0?i=lC(s):(o&=a,o!==0&&(i=lC(o)))}else a=n&~r,a!==0?i=lC(a):o!==0&&(i=lC(o));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,o=e&-e,r>=o||r===16&&(o&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-_a(e),r=1<<n,i|=t[n],e&=~r;return i}function a_(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function s_(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-_a(o),s=1<<a,l=r[a];l===-1?(!(s&n)||s&i)&&(r[a]=a_(s,e)):l<=e&&(t.expiredLanes|=s),o&=~s}}function FB(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function v5(){var t=dm;return dm<<=1,!(dm&4194240)&&(dm=64),t}function gy(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Lh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-_a(e),t[e]=n}function l_(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-_a(n),o=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~o}}function aw(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-_a(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var _n=0;function b5(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var y5,sw,G5,B5,S5,HB=!1,Cm=[],jl=null,$l=null,ql=null,PC=new Map,UC=new Map,Ll=[],c_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function MR(t,e){switch(t){case"focusin":case"focusout":jl=null;break;case"dragenter":case"dragleave":$l=null;break;case"mouseover":case"mouseout":ql=null;break;case"pointerover":case"pointerout":PC.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":UC.delete(e.pointerId)}}function SI(t,e,n,i,r,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},e!==null&&(e=_h(e),e!==null&&sw(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function g_(t,e,n,i,r){switch(e){case"focusin":return jl=SI(jl,t,e,n,i,r),!0;case"dragenter":return $l=SI($l,t,e,n,i,r),!0;case"mouseover":return ql=SI(ql,t,e,n,i,r),!0;case"pointerover":var o=r.pointerId;return PC.set(o,SI(PC.get(o)||null,t,e,n,i,r)),!0;case"gotpointercapture":return o=r.pointerId,UC.set(o,SI(UC.get(o)||null,t,e,n,i,r)),!0}return!1}function w5(t){var e=ig(t.target);if(e!==null){var n=Yg(e);if(n!==null){if(e=n.tag,e===13){if(e=C5(n),e!==null){t.blockedOn=e,S5(t.priority,function(){G5(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function kA(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=XB(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);WB=i,n.target.dispatchEvent(i),WB=null}else return e=_h(n),e!==null&&sw(e),t.blockedOn=n,!1;e.shift()}return!0}function NR(t,e,n){kA(t)&&n.delete(e)}function u_(){HB=!1,jl!==null&&kA(jl)&&(jl=null),$l!==null&&kA($l)&&($l=null),ql!==null&&kA(ql)&&(ql=null),PC.forEach(NR),UC.forEach(NR)}function wI(t,e){t.blockedOn===e&&(t.blockedOn=null,HB||(HB=!0,Uo.unstable_scheduleCallback(Uo.unstable_NormalPriority,u_)))}function DC(t){function e(r){return wI(r,t)}if(0<Cm.length){wI(Cm[0],t);for(var n=1;n<Cm.length;n++){var i=Cm[n];i.blockedOn===t&&(i.blockedOn=null)}}for(jl!==null&&wI(jl,t),$l!==null&&wI($l,t),ql!==null&&wI(ql,t),PC.forEach(e),UC.forEach(e),n=0;n<Ll.length;n++)i=Ll[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<Ll.length&&(n=Ll[0],n.blockedOn===null);)w5(n),n.blockedOn===null&&Ll.shift()}var Id=ul.ReactCurrentBatchConfig,Gp=!0;function d_(t,e,n,i){var r=_n,o=Id.transition;Id.transition=null;try{_n=1,lw(t,e,n,i)}finally{_n=r,Id.transition=o}}function I_(t,e,n,i){var r=_n,o=Id.transition;Id.transition=null;try{_n=4,lw(t,e,n,i)}finally{_n=r,Id.transition=o}}function lw(t,e,n,i){if(Gp){var r=XB(t,e,n,i);if(r===null)vy(t,e,i,Bp,n),MR(t,i);else if(g_(r,t,e,n,i))i.stopPropagation();else if(MR(t,i),e&4&&-1<c_.indexOf(t)){for(;r!==null;){var o=_h(r);if(o!==null&&y5(o),o=XB(t,e,n,i),o===null&&vy(t,e,i,Bp,n),o===r)break;r=o}r!==null&&i.stopPropagation()}else vy(t,e,i,null,n)}}var Bp=null;function XB(t,e,n,i){if(Bp=null,t=rw(i),t=ig(t),t!==null)if(e=Yg(t),e===null)t=null;else if(n=e.tag,n===13){if(t=C5(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Bp=t,null}function Z5(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(e_()){case ow:return 1;case A5:return 4;case bp:case t_:return 16;case p5:return 536870912;default:return 16}default:return 16}}var kl=null,cw=null,PA=null;function x5(){if(PA)return PA;var t,e=cw,n=e.length,i,r="value"in kl?kl.value:kl.textContent,o=r.length;for(t=0;t<n&&e[t]===r[t];t++);var a=n-t;for(i=1;i<=a&&e[n-i]===r[o-i];i++);return PA=r.slice(t,1<i?1-i:void 0)}function UA(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function hm(){return!0}function FR(){return!1}function Jo(t){function e(n,i,r,o,a){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var s in t)t.hasOwnProperty(s)&&(n=t[s],this[s]=n?n(o):o[s]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?hm:FR,this.isPropagationStopped=FR,this}return mi(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=hm)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=hm)},persist:function(){},isPersistent:hm}),e}var Od={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gw=Jo(Od),Th=mi({},Od,{view:0,detail:0}),C_=Jo(Th),uy,dy,ZI,K0=mi({},Th,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uw,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ZI&&(ZI&&t.type==="mousemove"?(uy=t.screenX-ZI.screenX,dy=t.screenY-ZI.screenY):dy=uy=0,ZI=t),uy)},movementY:function(t){return"movementY"in t?t.movementY:dy}}),HR=Jo(K0),h_=mi({},K0,{dataTransfer:0}),f_=Jo(h_),m_=mi({},Th,{relatedTarget:0}),Iy=Jo(m_),A_=mi({},Od,{animationName:0,elapsedTime:0,pseudoElement:0}),p_=Jo(A_),v_=mi({},Od,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),b_=Jo(v_),y_=mi({},Od,{data:0}),XR=Jo(y_),G_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},B_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},S_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function w_(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=S_[t])?!!e[t]:!1}function uw(){return w_}var Z_=mi({},Th,{key:function(t){if(t.key){var e=G_[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=UA(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?B_[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uw,charCode:function(t){return t.type==="keypress"?UA(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?UA(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),x_=Jo(Z_),R_=mi({},K0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ER=Jo(R_),W_=mi({},Th,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uw}),V_=Jo(W_),M_=mi({},Od,{propertyName:0,elapsedTime:0,pseudoElement:0}),N_=Jo(M_),F_=mi({},K0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),H_=Jo(F_),X_=[9,13,27,32],dw=rl&&"CompositionEvent"in window,fC=null;rl&&"documentMode"in document&&(fC=document.documentMode);var E_=rl&&"TextEvent"in window&&!fC,R5=rl&&(!dw||fC&&8<fC&&11>=fC),YR=" ",zR=!1;function W5(t,e){switch(t){case"keyup":return X_.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function V5(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Pu=!1;function Y_(t,e){switch(t){case"compositionend":return V5(e);case"keypress":return e.which!==32?null:(zR=!0,YR);case"textInput":return t=e.data,t===YR&&zR?null:t;default:return null}}function z_(t,e){if(Pu)return t==="compositionend"||!dw&&W5(t,e)?(t=x5(),PA=cw=kl=null,Pu=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return R5&&e.locale!=="ko"?null:e.data;default:return null}}var K_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function KR(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!K_[t.type]:e==="textarea"}function M5(t,e,n,i){c5(i),e=Sp(e,"onChange"),0<e.length&&(n=new gw("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var mC=null,OC=null;function L_(t){_5(t,0)}function L0(t){var e=Ou(t);if(n5(e))return t}function T_(t,e){if(t==="change")return e}var N5=!1;if(rl){var Cy;if(rl){var hy="oninput"in document;if(!hy){var LR=document.createElement("div");LR.setAttribute("oninput","return;"),hy=typeof LR.oninput=="function"}Cy=hy}else Cy=!1;N5=Cy&&(!document.documentMode||9<document.documentMode)}function TR(){mC&&(mC.detachEvent("onpropertychange",F5),OC=mC=null)}function F5(t){if(t.propertyName==="value"&&L0(OC)){var e=[];M5(e,OC,t,rw(t)),I5(L_,e)}}function __(t,e,n){t==="focusin"?(TR(),mC=e,OC=n,mC.attachEvent("onpropertychange",F5)):t==="focusout"&&TR()}function k_(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return L0(OC)}function P_(t,e){if(t==="click")return L0(e)}function U_(t,e){if(t==="input"||t==="change")return L0(e)}function D_(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ja=typeof Object.is=="function"?Object.is:D_;function JC(t,e){if(Ja(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!AB.call(e,r)||!Ja(t[r],e[r]))return!1}return!0}function _R(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function kR(t,e){var n=_R(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=_R(n)}}function H5(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?H5(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function X5(){for(var t=window,e=Ap();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ap(t.document)}return e}function Iw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function O_(t){var e=X5(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&H5(n.ownerDocument.documentElement,n)){if(i!==null&&Iw(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,o=Math.min(i.start,r);i=i.end===void 0?o:Math.min(i.end,r),!t.extend&&o>i&&(r=i,i=o,o=r),r=kR(n,o);var a=kR(n,i);r&&a&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),o>i?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var J_=rl&&"documentMode"in document&&11>=document.documentMode,Uu=null,EB=null,AC=null,YB=!1;function PR(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;YB||Uu==null||Uu!==Ap(i)||(i=Uu,"selectionStart"in i&&Iw(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),AC&&JC(AC,i)||(AC=i,i=Sp(EB,"onSelect"),0<i.length&&(e=new gw("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Uu)))}function fm(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Du={animationend:fm("Animation","AnimationEnd"),animationiteration:fm("Animation","AnimationIteration"),animationstart:fm("Animation","AnimationStart"),transitionend:fm("Transition","TransitionEnd")},fy={},E5={};rl&&(E5=document.createElement("div").style,"AnimationEvent"in window||(delete Du.animationend.animation,delete Du.animationiteration.animation,delete Du.animationstart.animation),"TransitionEvent"in window||delete Du.transitionend.transition);function T0(t){if(fy[t])return fy[t];if(!Du[t])return t;var e=Du[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in E5)return fy[t]=e[n];return t}var Y5=T0("animationend"),z5=T0("animationiteration"),K5=T0("animationstart"),L5=T0("transitionend"),T5=new Map,UR="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function dc(t,e){T5.set(t,e),Eg(e,[t])}for(var my=0;my<UR.length;my++){var Ay=UR[my],Q_=Ay.toLowerCase(),j_=Ay[0].toUpperCase()+Ay.slice(1);dc(Q_,"on"+j_)}dc(Y5,"onAnimationEnd");dc(z5,"onAnimationIteration");dc(K5,"onAnimationStart");dc("dblclick","onDoubleClick");dc("focusin","onFocus");dc("focusout","onBlur");dc(L5,"onTransitionEnd");Gd("onMouseEnter",["mouseout","mouseover"]);Gd("onMouseLeave",["mouseout","mouseover"]);Gd("onPointerEnter",["pointerout","pointerover"]);Gd("onPointerLeave",["pointerout","pointerover"]);Eg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Eg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Eg("onBeforeInput",["compositionend","keypress","textInput","paste"]);Eg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Eg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Eg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cC="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$_=new Set("cancel close invalid load scroll toggle".split(" ").concat(cC));function DR(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,QT(i,e,void 0,t),t.currentTarget=null}function _5(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var o=void 0;if(e)for(var a=i.length-1;0<=a;a--){var s=i[a],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==o&&r.isPropagationStopped())break e;DR(r,s,c),o=l}else for(a=0;a<i.length;a++){if(s=i[a],l=s.instance,c=s.currentTarget,s=s.listener,l!==o&&r.isPropagationStopped())break e;DR(r,s,c),o=l}}}if(vp)throw t=NB,vp=!1,NB=null,t}function ii(t,e){var n=e[_B];n===void 0&&(n=e[_B]=new Set);var i=t+"__bubble";n.has(i)||(k5(e,t,2,!1),n.add(i))}function py(t,e,n){var i=0;e&&(i|=4),k5(n,t,i,e)}var mm="_reactListening"+Math.random().toString(36).slice(2);function QC(t){if(!t[mm]){t[mm]=!0,j3.forEach(function(n){n!=="selectionchange"&&($_.has(n)||py(n,!1,t),py(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[mm]||(e[mm]=!0,py("selectionchange",!1,e))}}function k5(t,e,n,i){switch(Z5(e)){case 1:var r=d_;break;case 4:r=I_;break;default:r=lw}n=r.bind(null,e,n,t),r=void 0,!MB||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function vy(t,e,n,i,r){var o=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var s=i.stateNode.containerInfo;if(s===r||s.nodeType===8&&s.parentNode===r)break;if(a===4)for(a=i.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;a=a.return}for(;s!==null;){if(a=ig(s),a===null)return;if(l=a.tag,l===5||l===6){i=o=a;continue e}s=s.parentNode}}i=i.return}I5(function(){var c=o,g=rw(n),u=[];e:{var d=T5.get(t);if(d!==void 0){var C=gw,f=t;switch(t){case"keypress":if(UA(n)===0)break e;case"keydown":case"keyup":C=x_;break;case"focusin":f="focus",C=Iy;break;case"focusout":f="blur",C=Iy;break;case"beforeblur":case"afterblur":C=Iy;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=HR;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=f_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=V_;break;case Y5:case z5:case K5:C=p_;break;case L5:C=N_;break;case"scroll":C=C_;break;case"wheel":C=H_;break;case"copy":case"cut":case"paste":C=b_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=ER}var v=(e&4)!==0,p=!v&&t==="scroll",m=v?d!==null?d+"Capture":null:d;v=[];for(var A=c,b;A!==null;){b=A;var G=b.stateNode;if(b.tag===5&&G!==null&&(b=G,m!==null&&(G=kC(A,m),G!=null&&v.push(jC(A,G,b)))),p)break;A=A.return}0<v.length&&(d=new C(d,f,null,n,g),u.push({event:d,listeners:v}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",C=t==="mouseout"||t==="pointerout",d&&n!==WB&&(f=n.relatedTarget||n.fromElement)&&(ig(f)||f[ol]))break e;if((C||d)&&(d=g.window===g?g:(d=g.ownerDocument)?d.defaultView||d.parentWindow:window,C?(f=n.relatedTarget||n.toElement,C=c,f=f?ig(f):null,f!==null&&(p=Yg(f),f!==p||f.tag!==5&&f.tag!==6)&&(f=null)):(C=null,f=c),C!==f)){if(v=HR,G="onMouseLeave",m="onMouseEnter",A="mouse",(t==="pointerout"||t==="pointerover")&&(v=ER,G="onPointerLeave",m="onPointerEnter",A="pointer"),p=C==null?d:Ou(C),b=f==null?d:Ou(f),d=new v(G,A+"leave",C,n,g),d.target=p,d.relatedTarget=b,G=null,ig(g)===c&&(v=new v(m,A+"enter",f,n,g),v.target=b,v.relatedTarget=p,G=v),p=G,C&&f)t:{for(v=C,m=f,A=0,b=v;b;b=su(b))A++;for(b=0,G=m;G;G=su(G))b++;for(;0<A-b;)v=su(v),A--;for(;0<b-A;)m=su(m),b--;for(;A--;){if(v===m||m!==null&&v===m.alternate)break t;v=su(v),m=su(m)}v=null}else v=null;C!==null&&OR(u,d,C,v,!1),f!==null&&p!==null&&OR(u,p,f,v,!0)}}e:{if(d=c?Ou(c):window,C=d.nodeName&&d.nodeName.toLowerCase(),C==="select"||C==="input"&&d.type==="file")var w=T_;else if(KR(d))if(N5)w=U_;else{w=k_;var S=__}else(C=d.nodeName)&&C.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(w=P_);if(w&&(w=w(t,c))){M5(u,w,n,g);break e}S&&S(t,d,c),t==="focusout"&&(S=d._wrapperState)&&S.controlled&&d.type==="number"&&SB(d,"number",d.value)}switch(S=c?Ou(c):window,t){case"focusin":(KR(S)||S.contentEditable==="true")&&(Uu=S,EB=c,AC=null);break;case"focusout":AC=EB=Uu=null;break;case"mousedown":YB=!0;break;case"contextmenu":case"mouseup":case"dragend":YB=!1,PR(u,n,g);break;case"selectionchange":if(J_)break;case"keydown":case"keyup":PR(u,n,g)}var Z;if(dw)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Pu?W5(t,n)&&(x="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(x="onCompositionStart");x&&(R5&&n.locale!=="ko"&&(Pu||x!=="onCompositionStart"?x==="onCompositionEnd"&&Pu&&(Z=x5()):(kl=g,cw="value"in kl?kl.value:kl.textContent,Pu=!0)),S=Sp(c,x),0<S.length&&(x=new XR(x,t,null,n,g),u.push({event:x,listeners:S}),Z?x.data=Z:(Z=V5(n),Z!==null&&(x.data=Z)))),(Z=E_?Y_(t,n):z_(t,n))&&(c=Sp(c,"onBeforeInput"),0<c.length&&(g=new XR("onBeforeInput","beforeinput",null,n,g),u.push({event:g,listeners:c}),g.data=Z))}_5(u,e)})}function jC(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Sp(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,o=r.stateNode;r.tag===5&&o!==null&&(r=o,o=kC(t,n),o!=null&&i.unshift(jC(t,o,r)),o=kC(t,e),o!=null&&i.push(jC(t,o,r))),t=t.return}return i}function su(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function OR(t,e,n,i,r){for(var o=e._reactName,a=[];n!==null&&n!==i;){var s=n,l=s.alternate,c=s.stateNode;if(l!==null&&l===i)break;s.tag===5&&c!==null&&(s=c,r?(l=kC(n,o),l!=null&&a.unshift(jC(n,l,s))):r||(l=kC(n,o),l!=null&&a.push(jC(n,l,s)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var q_=/\r\n?/g,ek=/\u0000|\uFFFD/g;function JR(t){return(typeof t=="string"?t:""+t).replace(q_,`
`).replace(ek,"")}function Am(t,e,n){if(e=JR(e),JR(t)!==e&&n)throw Error(xt(425))}function wp(){}var zB=null,KB=null;function LB(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var TB=typeof setTimeout=="function"?setTimeout:void 0,tk=typeof clearTimeout=="function"?clearTimeout:void 0,QR=typeof Promise=="function"?Promise:void 0,nk=typeof queueMicrotask=="function"?queueMicrotask:typeof QR<"u"?function(t){return QR.resolve(null).then(t).catch(ik)}:TB;function ik(t){setTimeout(function(){throw t})}function by(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),DC(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);DC(e)}function ec(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function jR(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Jd=Math.random().toString(36).slice(2),hs="__reactFiber$"+Jd,$C="__reactProps$"+Jd,ol="__reactContainer$"+Jd,_B="__reactEvents$"+Jd,rk="__reactListeners$"+Jd,ok="__reactHandles$"+Jd;function ig(t){var e=t[hs];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ol]||n[hs]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=jR(t);t!==null;){if(n=t[hs])return n;t=jR(t)}return e}t=n,n=t.parentNode}return null}function _h(t){return t=t[hs]||t[ol],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ou(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(xt(33))}function _0(t){return t[$C]||null}var kB=[],Ju=-1;function Ic(t){return{current:t}}function oi(t){0>Ju||(t.current=kB[Ju],kB[Ju]=null,Ju--)}function ei(t,e){Ju++,kB[Ju]=t.current,t.current=e}var ac={},Hr=Ic(ac),mo=Ic(!1),Bg=ac;function Bd(t,e){var n=t.type.contextTypes;if(!n)return ac;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},o;for(o in n)r[o]=e[o];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Ao(t){return t=t.childContextTypes,t!=null}function Zp(){oi(mo),oi(Hr)}function $R(t,e,n){if(Hr.current!==ac)throw Error(xt(168));ei(Hr,e),ei(mo,n)}function P5(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(xt(108,_T(t)||"Unknown",r));return mi({},n,i)}function xp(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ac,Bg=Hr.current,ei(Hr,t),ei(mo,mo.current),!0}function qR(t,e,n){var i=t.stateNode;if(!i)throw Error(xt(169));n?(t=P5(t,e,Bg),i.__reactInternalMemoizedMergedChildContext=t,oi(mo),oi(Hr),ei(Hr,t)):oi(mo),ei(mo,n)}var Ps=null,k0=!1,yy=!1;function U5(t){Ps===null?Ps=[t]:Ps.push(t)}function ak(t){k0=!0,U5(t)}function Cc(){if(!yy&&Ps!==null){yy=!0;var t=0,e=_n;try{var n=Ps;for(_n=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}Ps=null,k0=!1}catch(r){throw Ps!==null&&(Ps=Ps.slice(t+1)),m5(ow,Cc),r}finally{_n=e,yy=!1}}return null}var Qu=[],ju=0,Rp=null,Wp=0,ga=[],ua=0,Sg=null,Js=1,Qs="";function Uc(t,e){Qu[ju++]=Wp,Qu[ju++]=Rp,Rp=t,Wp=e}function D5(t,e,n){ga[ua++]=Js,ga[ua++]=Qs,ga[ua++]=Sg,Sg=t;var i=Js;t=Qs;var r=32-_a(i)-1;i&=~(1<<r),n+=1;var o=32-_a(e)+r;if(30<o){var a=r-r%5;o=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Js=1<<32-_a(e)+r|n<<r|i,Qs=o+t}else Js=1<<o|n<<r|i,Qs=t}function Cw(t){t.return!==null&&(Uc(t,1),D5(t,1,0))}function hw(t){for(;t===Rp;)Rp=Qu[--ju],Qu[ju]=null,Wp=Qu[--ju],Qu[ju]=null;for(;t===Sg;)Sg=ga[--ua],ga[ua]=null,Qs=ga[--ua],ga[ua]=null,Js=ga[--ua],ga[ua]=null}var To=null,Ko=null,li=!1,La=null;function O5(t,e){var n=Ca(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function eW(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,To=t,Ko=ec(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,To=t,Ko=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Sg!==null?{id:Js,overflow:Qs}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ca(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,To=t,Ko=null,!0):!1;default:return!1}}function PB(t){return(t.mode&1)!==0&&(t.flags&128)===0}function UB(t){if(li){var e=Ko;if(e){var n=e;if(!eW(t,e)){if(PB(t))throw Error(xt(418));e=ec(n.nextSibling);var i=To;e&&eW(t,e)?O5(i,n):(t.flags=t.flags&-4097|2,li=!1,To=t)}}else{if(PB(t))throw Error(xt(418));t.flags=t.flags&-4097|2,li=!1,To=t}}}function tW(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;To=t}function pm(t){if(t!==To)return!1;if(!li)return tW(t),li=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!LB(t.type,t.memoizedProps)),e&&(e=Ko)){if(PB(t))throw J5(),Error(xt(418));for(;e;)O5(t,e),e=ec(e.nextSibling)}if(tW(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(xt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ko=ec(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ko=null}}else Ko=To?ec(t.stateNode.nextSibling):null;return!0}function J5(){for(var t=Ko;t;)t=ec(t.nextSibling)}function Sd(){Ko=To=null,li=!1}function fw(t){La===null?La=[t]:La.push(t)}var sk=ul.ReactCurrentBatchConfig;function xI(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(xt(309));var i=n.stateNode}if(!i)throw Error(xt(147,t));var r=i,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(a){var s=r.refs;a===null?delete s[o]:s[o]=a},e._stringRef=o,e)}if(typeof t!="string")throw Error(xt(284));if(!n._owner)throw Error(xt(290,t))}return t}function vm(t,e){throw t=Object.prototype.toString.call(e),Error(xt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function nW(t){var e=t._init;return e(t._payload)}function Q5(t){function e(m,A){if(t){var b=m.deletions;b===null?(m.deletions=[A],m.flags|=16):b.push(A)}}function n(m,A){if(!t)return null;for(;A!==null;)e(m,A),A=A.sibling;return null}function i(m,A){for(m=new Map;A!==null;)A.key!==null?m.set(A.key,A):m.set(A.index,A),A=A.sibling;return m}function r(m,A){return m=rc(m,A),m.index=0,m.sibling=null,m}function o(m,A,b){return m.index=b,t?(b=m.alternate,b!==null?(b=b.index,b<A?(m.flags|=2,A):b):(m.flags|=2,A)):(m.flags|=1048576,A)}function a(m){return t&&m.alternate===null&&(m.flags|=2),m}function s(m,A,b,G){return A===null||A.tag!==6?(A=Ry(b,m.mode,G),A.return=m,A):(A=r(A,b),A.return=m,A)}function l(m,A,b,G){var w=b.type;return w===ku?g(m,A,b.props.children,G,b.key):A!==null&&(A.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Yl&&nW(w)===A.type)?(G=r(A,b.props),G.ref=xI(m,A,b),G.return=m,G):(G=qA(b.type,b.key,b.props,null,m.mode,G),G.ref=xI(m,A,b),G.return=m,G)}function c(m,A,b,G){return A===null||A.tag!==4||A.stateNode.containerInfo!==b.containerInfo||A.stateNode.implementation!==b.implementation?(A=Wy(b,m.mode,G),A.return=m,A):(A=r(A,b.children||[]),A.return=m,A)}function g(m,A,b,G,w){return A===null||A.tag!==7?(A=fg(b,m.mode,G,w),A.return=m,A):(A=r(A,b),A.return=m,A)}function u(m,A,b){if(typeof A=="string"&&A!==""||typeof A=="number")return A=Ry(""+A,m.mode,b),A.return=m,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case cm:return b=qA(A.type,A.key,A.props,null,m.mode,b),b.ref=xI(m,null,A),b.return=m,b;case _u:return A=Wy(A,m.mode,b),A.return=m,A;case Yl:var G=A._init;return u(m,G(A._payload),b)}if(sC(A)||GI(A))return A=fg(A,m.mode,b,null),A.return=m,A;vm(m,A)}return null}function d(m,A,b,G){var w=A!==null?A.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return w!==null?null:s(m,A,""+b,G);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case cm:return b.key===w?l(m,A,b,G):null;case _u:return b.key===w?c(m,A,b,G):null;case Yl:return w=b._init,d(m,A,w(b._payload),G)}if(sC(b)||GI(b))return w!==null?null:g(m,A,b,G,null);vm(m,b)}return null}function C(m,A,b,G,w){if(typeof G=="string"&&G!==""||typeof G=="number")return m=m.get(b)||null,s(A,m,""+G,w);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case cm:return m=m.get(G.key===null?b:G.key)||null,l(A,m,G,w);case _u:return m=m.get(G.key===null?b:G.key)||null,c(A,m,G,w);case Yl:var S=G._init;return C(m,A,b,S(G._payload),w)}if(sC(G)||GI(G))return m=m.get(b)||null,g(A,m,G,w,null);vm(A,G)}return null}function f(m,A,b,G){for(var w=null,S=null,Z=A,x=A=0,R=null;Z!==null&&x<b.length;x++){Z.index>x?(R=Z,Z=null):R=Z.sibling;var W=d(m,Z,b[x],G);if(W===null){Z===null&&(Z=R);break}t&&Z&&W.alternate===null&&e(m,Z),A=o(W,A,x),S===null?w=W:S.sibling=W,S=W,Z=R}if(x===b.length)return n(m,Z),li&&Uc(m,x),w;if(Z===null){for(;x<b.length;x++)Z=u(m,b[x],G),Z!==null&&(A=o(Z,A,x),S===null?w=Z:S.sibling=Z,S=Z);return li&&Uc(m,x),w}for(Z=i(m,Z);x<b.length;x++)R=C(Z,m,x,b[x],G),R!==null&&(t&&R.alternate!==null&&Z.delete(R.key===null?x:R.key),A=o(R,A,x),S===null?w=R:S.sibling=R,S=R);return t&&Z.forEach(function(M){return e(m,M)}),li&&Uc(m,x),w}function v(m,A,b,G){var w=GI(b);if(typeof w!="function")throw Error(xt(150));if(b=w.call(b),b==null)throw Error(xt(151));for(var S=w=null,Z=A,x=A=0,R=null,W=b.next();Z!==null&&!W.done;x++,W=b.next()){Z.index>x?(R=Z,Z=null):R=Z.sibling;var M=d(m,Z,W.value,G);if(M===null){Z===null&&(Z=R);break}t&&Z&&M.alternate===null&&e(m,Z),A=o(M,A,x),S===null?w=M:S.sibling=M,S=M,Z=R}if(W.done)return n(m,Z),li&&Uc(m,x),w;if(Z===null){for(;!W.done;x++,W=b.next())W=u(m,W.value,G),W!==null&&(A=o(W,A,x),S===null?w=W:S.sibling=W,S=W);return li&&Uc(m,x),w}for(Z=i(m,Z);!W.done;x++,W=b.next())W=C(Z,m,x,W.value,G),W!==null&&(t&&W.alternate!==null&&Z.delete(W.key===null?x:W.key),A=o(W,A,x),S===null?w=W:S.sibling=W,S=W);return t&&Z.forEach(function(N){return e(m,N)}),li&&Uc(m,x),w}function p(m,A,b,G){if(typeof b=="object"&&b!==null&&b.type===ku&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case cm:e:{for(var w=b.key,S=A;S!==null;){if(S.key===w){if(w=b.type,w===ku){if(S.tag===7){n(m,S.sibling),A=r(S,b.props.children),A.return=m,m=A;break e}}else if(S.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Yl&&nW(w)===S.type){n(m,S.sibling),A=r(S,b.props),A.ref=xI(m,S,b),A.return=m,m=A;break e}n(m,S);break}else e(m,S);S=S.sibling}b.type===ku?(A=fg(b.props.children,m.mode,G,b.key),A.return=m,m=A):(G=qA(b.type,b.key,b.props,null,m.mode,G),G.ref=xI(m,A,b),G.return=m,m=G)}return a(m);case _u:e:{for(S=b.key;A!==null;){if(A.key===S)if(A.tag===4&&A.stateNode.containerInfo===b.containerInfo&&A.stateNode.implementation===b.implementation){n(m,A.sibling),A=r(A,b.children||[]),A.return=m,m=A;break e}else{n(m,A);break}else e(m,A);A=A.sibling}A=Wy(b,m.mode,G),A.return=m,m=A}return a(m);case Yl:return S=b._init,p(m,A,S(b._payload),G)}if(sC(b))return f(m,A,b,G);if(GI(b))return v(m,A,b,G);vm(m,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,A!==null&&A.tag===6?(n(m,A.sibling),A=r(A,b),A.return=m,m=A):(n(m,A),A=Ry(b,m.mode,G),A.return=m,m=A),a(m)):n(m,A)}return p}var wd=Q5(!0),j5=Q5(!1),Vp=Ic(null),Mp=null,$u=null,mw=null;function Aw(){mw=$u=Mp=null}function pw(t){var e=Vp.current;oi(Vp),t._currentValue=e}function DB(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function Cd(t,e){Mp=t,mw=$u=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(fo=!0),t.firstContext=null)}function fa(t){var e=t._currentValue;if(mw!==t)if(t={context:t,memoizedValue:e,next:null},$u===null){if(Mp===null)throw Error(xt(308));$u=t,Mp.dependencies={lanes:0,firstContext:t}}else $u=$u.next=t;return e}var rg=null;function vw(t){rg===null?rg=[t]:rg.push(t)}function $5(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,vw(e)):(n.next=r.next,r.next=n),e.interleaved=n,al(t,i)}function al(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var zl=!1;function bw(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function q5(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function tl(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function tc(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,Nn&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,al(t,n)}return r=i.interleaved,r===null?(e.next=e,vw(i)):(e.next=r.next,r.next=e),i.interleaved=e,al(t,n)}function DA(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,aw(t,n)}}function iW(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?r=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?r=o=e:o=o.next=e}else r=o=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Np(t,e,n,i){var r=t.updateQueue;zl=!1;var o=r.firstBaseUpdate,a=r.lastBaseUpdate,s=r.shared.pending;if(s!==null){r.shared.pending=null;var l=s,c=l.next;l.next=null,a===null?o=c:a.next=c,a=l;var g=t.alternate;g!==null&&(g=g.updateQueue,s=g.lastBaseUpdate,s!==a&&(s===null?g.firstBaseUpdate=c:s.next=c,g.lastBaseUpdate=l))}if(o!==null){var u=r.baseState;a=0,g=c=l=null,s=o;do{var d=s.lane,C=s.eventTime;if((i&d)===d){g!==null&&(g=g.next={eventTime:C,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=t,v=s;switch(d=e,C=n,v.tag){case 1:if(f=v.payload,typeof f=="function"){u=f.call(C,u,d);break e}u=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=v.payload,d=typeof f=="function"?f.call(C,u,d):f,d==null)break e;u=mi({},u,d);break e;case 2:zl=!0}}s.callback!==null&&s.lane!==0&&(t.flags|=64,d=r.effects,d===null?r.effects=[s]:d.push(s))}else C={eventTime:C,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},g===null?(c=g=C,l=u):g=g.next=C,a|=d;if(s=s.next,s===null){if(s=r.shared.pending,s===null)break;d=s,s=d.next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}while(!0);if(g===null&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=g,e=r.shared.interleaved,e!==null){r=e;do a|=r.lane,r=r.next;while(r!==e)}else o===null&&(r.shared.lanes=0);Zg|=a,t.lanes=a,t.memoizedState=u}}function rW(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(xt(191,r));r.call(i)}}}var kh={},vs=Ic(kh),qC=Ic(kh),eh=Ic(kh);function og(t){if(t===kh)throw Error(xt(174));return t}function yw(t,e){switch(ei(eh,e),ei(qC,t),ei(vs,kh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ZB(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ZB(e,t)}oi(vs),ei(vs,e)}function Zd(){oi(vs),oi(qC),oi(eh)}function eH(t){og(eh.current);var e=og(vs.current),n=ZB(e,t.type);e!==n&&(ei(qC,t),ei(vs,n))}function Gw(t){qC.current===t&&(oi(vs),oi(qC))}var Ii=Ic(0);function Fp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Gy=[];function Bw(){for(var t=0;t<Gy.length;t++)Gy[t]._workInProgressVersionPrimary=null;Gy.length=0}var OA=ul.ReactCurrentDispatcher,By=ul.ReactCurrentBatchConfig,wg=0,fi=null,_i=null,ir=null,Hp=!1,pC=!1,th=0,lk=0;function Br(){throw Error(xt(321))}function Sw(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ja(t[n],e[n]))return!1;return!0}function ww(t,e,n,i,r,o){if(wg=o,fi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,OA.current=t===null||t.memoizedState===null?dk:Ik,t=n(i,r),pC){o=0;do{if(pC=!1,th=0,25<=o)throw Error(xt(301));o+=1,ir=_i=null,e.updateQueue=null,OA.current=Ck,t=n(i,r)}while(pC)}if(OA.current=Xp,e=_i!==null&&_i.next!==null,wg=0,ir=_i=fi=null,Hp=!1,e)throw Error(xt(300));return t}function Zw(){var t=th!==0;return th=0,t}function Is(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ir===null?fi.memoizedState=ir=t:ir=ir.next=t,ir}function ma(){if(_i===null){var t=fi.alternate;t=t!==null?t.memoizedState:null}else t=_i.next;var e=ir===null?fi.memoizedState:ir.next;if(e!==null)ir=e,_i=t;else{if(t===null)throw Error(xt(310));_i=t,t={memoizedState:_i.memoizedState,baseState:_i.baseState,baseQueue:_i.baseQueue,queue:_i.queue,next:null},ir===null?fi.memoizedState=ir=t:ir=ir.next=t}return ir}function nh(t,e){return typeof e=="function"?e(t):e}function Sy(t){var e=ma(),n=e.queue;if(n===null)throw Error(xt(311));n.lastRenderedReducer=t;var i=_i,r=i.baseQueue,o=n.pending;if(o!==null){if(r!==null){var a=r.next;r.next=o.next,o.next=a}i.baseQueue=r=o,n.pending=null}if(r!==null){o=r.next,i=i.baseState;var s=a=null,l=null,c=o;do{var g=c.lane;if((wg&g)===g)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:t(i,c.action);else{var u={lane:g,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(s=l=u,a=i):l=l.next=u,fi.lanes|=g,Zg|=g}c=c.next}while(c!==null&&c!==o);l===null?a=i:l.next=s,Ja(i,e.memoizedState)||(fo=!0),e.memoizedState=i,e.baseState=a,e.baseQueue=l,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do o=r.lane,fi.lanes|=o,Zg|=o,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function wy(t){var e=ma(),n=e.queue;if(n===null)throw Error(xt(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,o=e.memoizedState;if(r!==null){n.pending=null;var a=r=r.next;do o=t(o,a.action),a=a.next;while(a!==r);Ja(o,e.memoizedState)||(fo=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,i]}function tH(){}function nH(t,e){var n=fi,i=ma(),r=e(),o=!Ja(i.memoizedState,r);if(o&&(i.memoizedState=r,fo=!0),i=i.queue,xw(oH.bind(null,n,i,t),[t]),i.getSnapshot!==e||o||ir!==null&&ir.memoizedState.tag&1){if(n.flags|=2048,ih(9,rH.bind(null,n,i,r,e),void 0,null),ar===null)throw Error(xt(349));wg&30||iH(n,e,r)}return r}function iH(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=fi.updateQueue,e===null?(e={lastEffect:null,stores:null},fi.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function rH(t,e,n,i){e.value=n,e.getSnapshot=i,aH(e)&&sH(t)}function oH(t,e,n){return n(function(){aH(e)&&sH(t)})}function aH(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ja(t,n)}catch{return!0}}function sH(t){var e=al(t,1);e!==null&&ka(e,t,1,-1)}function oW(t){var e=Is();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nh,lastRenderedState:t},e.queue=t,t=t.dispatch=uk.bind(null,fi,t),[e.memoizedState,t]}function ih(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=fi.updateQueue,e===null?(e={lastEffect:null,stores:null},fi.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function lH(){return ma().memoizedState}function JA(t,e,n,i){var r=Is();fi.flags|=t,r.memoizedState=ih(1|e,n,void 0,i===void 0?null:i)}function P0(t,e,n,i){var r=ma();i=i===void 0?null:i;var o=void 0;if(_i!==null){var a=_i.memoizedState;if(o=a.destroy,i!==null&&Sw(i,a.deps)){r.memoizedState=ih(e,n,o,i);return}}fi.flags|=t,r.memoizedState=ih(1|e,n,o,i)}function aW(t,e){return JA(8390656,8,t,e)}function xw(t,e){return P0(2048,8,t,e)}function cH(t,e){return P0(4,2,t,e)}function gH(t,e){return P0(4,4,t,e)}function uH(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function dH(t,e,n){return n=n!=null?n.concat([t]):null,P0(4,4,uH.bind(null,e,t),n)}function Rw(){}function IH(t,e){var n=ma();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&Sw(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function CH(t,e){var n=ma();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&Sw(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function hH(t,e,n){return wg&21?(Ja(n,e)||(n=v5(),fi.lanes|=n,Zg|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,fo=!0),t.memoizedState=n)}function ck(t,e){var n=_n;_n=n!==0&&4>n?n:4,t(!0);var i=By.transition;By.transition={};try{t(!1),e()}finally{_n=n,By.transition=i}}function fH(){return ma().memoizedState}function gk(t,e,n){var i=ic(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},mH(t))AH(e,n);else if(n=$5(t,e,n,i),n!==null){var r=jr();ka(n,t,i,r),pH(n,e,i)}}function uk(t,e,n){var i=ic(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(mH(t))AH(e,r);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var a=e.lastRenderedState,s=o(a,n);if(r.hasEagerState=!0,r.eagerState=s,Ja(s,a)){var l=e.interleaved;l===null?(r.next=r,vw(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=$5(t,e,r,i),n!==null&&(r=jr(),ka(n,t,i,r),pH(n,e,i))}}function mH(t){var e=t.alternate;return t===fi||e!==null&&e===fi}function AH(t,e){pC=Hp=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function pH(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,aw(t,n)}}var Xp={readContext:fa,useCallback:Br,useContext:Br,useEffect:Br,useImperativeHandle:Br,useInsertionEffect:Br,useLayoutEffect:Br,useMemo:Br,useReducer:Br,useRef:Br,useState:Br,useDebugValue:Br,useDeferredValue:Br,useTransition:Br,useMutableSource:Br,useSyncExternalStore:Br,useId:Br,unstable_isNewReconciler:!1},dk={readContext:fa,useCallback:function(t,e){return Is().memoizedState=[t,e===void 0?null:e],t},useContext:fa,useEffect:aW,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,JA(4194308,4,uH.bind(null,e,t),n)},useLayoutEffect:function(t,e){return JA(4194308,4,t,e)},useInsertionEffect:function(t,e){return JA(4,2,t,e)},useMemo:function(t,e){var n=Is();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=Is();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=gk.bind(null,fi,t),[i.memoizedState,t]},useRef:function(t){var e=Is();return t={current:t},e.memoizedState=t},useState:oW,useDebugValue:Rw,useDeferredValue:function(t){return Is().memoizedState=t},useTransition:function(){var t=oW(!1),e=t[0];return t=ck.bind(null,t[1]),Is().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=fi,r=Is();if(li){if(n===void 0)throw Error(xt(407));n=n()}else{if(n=e(),ar===null)throw Error(xt(349));wg&30||iH(i,e,n)}r.memoizedState=n;var o={value:n,getSnapshot:e};return r.queue=o,aW(oH.bind(null,i,o,t),[t]),i.flags|=2048,ih(9,rH.bind(null,i,o,n,e),void 0,null),n},useId:function(){var t=Is(),e=ar.identifierPrefix;if(li){var n=Qs,i=Js;n=(i&~(1<<32-_a(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=th++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=lk++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Ik={readContext:fa,useCallback:IH,useContext:fa,useEffect:xw,useImperativeHandle:dH,useInsertionEffect:cH,useLayoutEffect:gH,useMemo:CH,useReducer:Sy,useRef:lH,useState:function(){return Sy(nh)},useDebugValue:Rw,useDeferredValue:function(t){var e=ma();return hH(e,_i.memoizedState,t)},useTransition:function(){var t=Sy(nh)[0],e=ma().memoizedState;return[t,e]},useMutableSource:tH,useSyncExternalStore:nH,useId:fH,unstable_isNewReconciler:!1},Ck={readContext:fa,useCallback:IH,useContext:fa,useEffect:xw,useImperativeHandle:dH,useInsertionEffect:cH,useLayoutEffect:gH,useMemo:CH,useReducer:wy,useRef:lH,useState:function(){return wy(nh)},useDebugValue:Rw,useDeferredValue:function(t){var e=ma();return _i===null?e.memoizedState=t:hH(e,_i.memoizedState,t)},useTransition:function(){var t=wy(nh)[0],e=ma().memoizedState;return[t,e]},useMutableSource:tH,useSyncExternalStore:nH,useId:fH,unstable_isNewReconciler:!1};function Xa(t,e){if(t&&t.defaultProps){e=mi({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function OB(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:mi({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var U0={isMounted:function(t){return(t=t._reactInternals)?Yg(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=jr(),r=ic(t),o=tl(i,r);o.payload=e,n!=null&&(o.callback=n),e=tc(t,o,r),e!==null&&(ka(e,t,r,i),DA(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=jr(),r=ic(t),o=tl(i,r);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=tc(t,o,r),e!==null&&(ka(e,t,r,i),DA(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=jr(),i=ic(t),r=tl(n,i);r.tag=2,e!=null&&(r.callback=e),e=tc(t,r,i),e!==null&&(ka(e,t,i,n),DA(e,t,i))}};function sW(t,e,n,i,r,o,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,o,a):e.prototype&&e.prototype.isPureReactComponent?!JC(n,i)||!JC(r,o):!0}function vH(t,e,n){var i=!1,r=ac,o=e.contextType;return typeof o=="object"&&o!==null?o=fa(o):(r=Ao(e)?Bg:Hr.current,i=e.contextTypes,o=(i=i!=null)?Bd(t,r):ac),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=U0,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=o),e}function lW(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&U0.enqueueReplaceState(e,e.state,null)}function JB(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},bw(t);var o=e.contextType;typeof o=="object"&&o!==null?r.context=fa(o):(o=Ao(e)?Bg:Hr.current,r.context=Bd(t,o)),r.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(OB(t,e,o,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&U0.enqueueReplaceState(r,r.state,null),Np(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function xd(t,e){try{var n="",i=e;do n+=TT(i),i=i.return;while(i);var r=n}catch(o){r=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:r,digest:null}}function Zy(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function QB(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var hk=typeof WeakMap=="function"?WeakMap:Map;function bH(t,e,n){n=tl(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Yp||(Yp=!0,a2=i),QB(t,e)},n}function yH(t,e,n){n=tl(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){QB(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){QB(t,e),typeof i!="function"&&(nc===null?nc=new Set([this]):nc.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function cW(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new hk;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=Rk.bind(null,t,e,n),e.then(t,t))}function gW(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function uW(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=tl(-1,1),e.tag=2,tc(n,e,1))),n.lanes|=1),t)}var fk=ul.ReactCurrentOwner,fo=!1;function Ur(t,e,n,i){e.child=t===null?j5(e,null,n,i):wd(e,t.child,n,i)}function dW(t,e,n,i,r){n=n.render;var o=e.ref;return Cd(e,r),i=ww(t,e,n,i,o,r),n=Zw(),t!==null&&!fo?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,sl(t,e,r)):(li&&n&&Cw(e),e.flags|=1,Ur(t,e,i,r),e.child)}function IW(t,e,n,i,r){if(t===null){var o=n.type;return typeof o=="function"&&!Ew(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,GH(t,e,o,i,r)):(t=qA(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&r)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:JC,n(a,i)&&t.ref===e.ref)return sl(t,e,r)}return e.flags|=1,t=rc(o,i),t.ref=e.ref,t.return=e,e.child=t}function GH(t,e,n,i,r){if(t!==null){var o=t.memoizedProps;if(JC(o,i)&&t.ref===e.ref)if(fo=!1,e.pendingProps=i=o,(t.lanes&r)!==0)t.flags&131072&&(fo=!0);else return e.lanes=t.lanes,sl(t,e,r)}return jB(t,e,n,i,r)}function BH(t,e,n){var i=e.pendingProps,r=i.children,o=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ei(ed,Eo),Eo|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ei(ed,Eo),Eo|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=o!==null?o.baseLanes:n,ei(ed,Eo),Eo|=i}else o!==null?(i=o.baseLanes|n,e.memoizedState=null):i=n,ei(ed,Eo),Eo|=i;return Ur(t,e,r,n),e.child}function SH(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function jB(t,e,n,i,r){var o=Ao(n)?Bg:Hr.current;return o=Bd(e,o),Cd(e,r),n=ww(t,e,n,i,o,r),i=Zw(),t!==null&&!fo?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,sl(t,e,r)):(li&&i&&Cw(e),e.flags|=1,Ur(t,e,n,r),e.child)}function CW(t,e,n,i,r){if(Ao(n)){var o=!0;xp(e)}else o=!1;if(Cd(e,r),e.stateNode===null)QA(t,e),vH(e,n,i),JB(e,n,i,r),i=!0;else if(t===null){var a=e.stateNode,s=e.memoizedProps;a.props=s;var l=a.context,c=n.contextType;typeof c=="object"&&c!==null?c=fa(c):(c=Ao(n)?Bg:Hr.current,c=Bd(e,c));var g=n.getDerivedStateFromProps,u=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function";u||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==i||l!==c)&&lW(e,a,i,c),zl=!1;var d=e.memoizedState;a.state=d,Np(e,i,a,r),l=e.memoizedState,s!==i||d!==l||mo.current||zl?(typeof g=="function"&&(OB(e,n,g,i),l=e.memoizedState),(s=zl||sW(e,n,s,i,d,l,c))?(u||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),a.props=i,a.state=l,a.context=c,i=s):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{a=e.stateNode,q5(t,e),s=e.memoizedProps,c=e.type===e.elementType?s:Xa(e.type,s),a.props=c,u=e.pendingProps,d=a.context,l=n.contextType,typeof l=="object"&&l!==null?l=fa(l):(l=Ao(n)?Bg:Hr.current,l=Bd(e,l));var C=n.getDerivedStateFromProps;(g=typeof C=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==u||d!==l)&&lW(e,a,i,l),zl=!1,d=e.memoizedState,a.state=d,Np(e,i,a,r);var f=e.memoizedState;s!==u||d!==f||mo.current||zl?(typeof C=="function"&&(OB(e,n,C,i),f=e.memoizedState),(c=zl||sW(e,n,c,i,d,f,l)||!1)?(g||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(i,f,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(i,f,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=f),a.props=i,a.state=f,a.context=l,i=c):(typeof a.componentDidUpdate!="function"||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),i=!1)}return $B(t,e,n,i,o,r)}function $B(t,e,n,i,r,o){SH(t,e);var a=(e.flags&128)!==0;if(!i&&!a)return r&&qR(e,n,!1),sl(t,e,o);i=e.stateNode,fk.current=e;var s=a&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&a?(e.child=wd(e,t.child,null,o),e.child=wd(e,null,s,o)):Ur(t,e,s,o),e.memoizedState=i.state,r&&qR(e,n,!0),e.child}function wH(t){var e=t.stateNode;e.pendingContext?$R(t,e.pendingContext,e.pendingContext!==e.context):e.context&&$R(t,e.context,!1),yw(t,e.containerInfo)}function hW(t,e,n,i,r){return Sd(),fw(r),e.flags|=256,Ur(t,e,n,i),e.child}var qB={dehydrated:null,treeContext:null,retryLane:0};function e2(t){return{baseLanes:t,cachePool:null,transitions:null}}function ZH(t,e,n){var i=e.pendingProps,r=Ii.current,o=!1,a=(e.flags&128)!==0,s;if((s=a)||(s=t!==null&&t.memoizedState===null?!1:(r&2)!==0),s?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),ei(Ii,r&1),t===null)return UB(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=i.children,t=i.fallback,o?(i=e.mode,o=e.child,a={mode:"hidden",children:a},!(i&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=J0(a,i,0,null),t=fg(t,i,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=e2(n),e.memoizedState=qB,t):Ww(e,a));if(r=t.memoizedState,r!==null&&(s=r.dehydrated,s!==null))return mk(t,e,a,i,s,r,n);if(o){o=i.fallback,a=e.mode,r=t.child,s=r.sibling;var l={mode:"hidden",children:i.children};return!(a&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=rc(r,l),i.subtreeFlags=r.subtreeFlags&14680064),s!==null?o=rc(s,o):(o=fg(o,a,n,null),o.flags|=2),o.return=e,i.return=e,i.sibling=o,e.child=i,i=o,o=e.child,a=t.child.memoizedState,a=a===null?e2(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=t.childLanes&~n,e.memoizedState=qB,i}return o=t.child,t=o.sibling,i=rc(o,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function Ww(t,e){return e=J0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function bm(t,e,n,i){return i!==null&&fw(i),wd(e,t.child,null,n),t=Ww(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function mk(t,e,n,i,r,o,a){if(n)return e.flags&256?(e.flags&=-257,i=Zy(Error(xt(422))),bm(t,e,a,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=i.fallback,r=e.mode,i=J0({mode:"visible",children:i.children},r,0,null),o=fg(o,r,a,null),o.flags|=2,i.return=e,o.return=e,i.sibling=o,e.child=i,e.mode&1&&wd(e,t.child,null,a),e.child.memoizedState=e2(a),e.memoizedState=qB,o);if(!(e.mode&1))return bm(t,e,a,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var s=i.dgst;return i=s,o=Error(xt(419)),i=Zy(o,i,void 0),bm(t,e,a,i)}if(s=(a&t.childLanes)!==0,fo||s){if(i=ar,i!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|a)?0:r,r!==0&&r!==o.retryLane&&(o.retryLane=r,al(t,r),ka(i,t,r,-1))}return Xw(),i=Zy(Error(xt(421))),bm(t,e,a,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=Wk.bind(null,t),r._reactRetry=e,null):(t=o.treeContext,Ko=ec(r.nextSibling),To=e,li=!0,La=null,t!==null&&(ga[ua++]=Js,ga[ua++]=Qs,ga[ua++]=Sg,Js=t.id,Qs=t.overflow,Sg=e),e=Ww(e,i.children),e.flags|=4096,e)}function fW(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),DB(t.return,e,n)}function xy(t,e,n,i,r){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailMode=r)}function xH(t,e,n){var i=e.pendingProps,r=i.revealOrder,o=i.tail;if(Ur(t,e,i.children,n),i=Ii.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&fW(t,n,e);else if(t.tag===19)fW(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(ei(Ii,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Fp(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),xy(e,!1,r,n,o);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Fp(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}xy(e,!0,n,null,o);break;case"together":xy(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function QA(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function sl(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Zg|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(xt(153));if(e.child!==null){for(t=e.child,n=rc(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=rc(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Ak(t,e,n){switch(e.tag){case 3:wH(e),Sd();break;case 5:eH(e);break;case 1:Ao(e.type)&&xp(e);break;case 4:yw(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;ei(Vp,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(ei(Ii,Ii.current&1),e.flags|=128,null):n&e.child.childLanes?ZH(t,e,n):(ei(Ii,Ii.current&1),t=sl(t,e,n),t!==null?t.sibling:null);ei(Ii,Ii.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return xH(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),ei(Ii,Ii.current),i)break;return null;case 22:case 23:return e.lanes=0,BH(t,e,n)}return sl(t,e,n)}var RH,t2,WH,VH;RH=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};t2=function(){};WH=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,og(vs.current);var o=null;switch(n){case"input":r=GB(t,r),i=GB(t,i),o=[];break;case"select":r=mi({},r,{value:void 0}),i=mi({},i,{value:void 0}),o=[];break;case"textarea":r=wB(t,r),i=wB(t,i),o=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=wp)}xB(n,i);var a;n=null;for(c in r)if(!i.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var s=r[c];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(TC.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in i){var l=i[c];if(s=r!=null?r[c]:void 0,i.hasOwnProperty(c)&&l!==s&&(l!=null||s!=null))if(c==="style")if(s){for(a in s)!s.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&s[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(o||(o=[]),o.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(TC.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ii("scroll",t),o||s===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(e.updateQueue=c)&&(e.flags|=4)}};VH=function(t,e,n,i){n!==i&&(e.flags|=4)};function RI(t,e){if(!li)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Sr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function pk(t,e,n){var i=e.pendingProps;switch(hw(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Sr(e),null;case 1:return Ao(e.type)&&Zp(),Sr(e),null;case 3:return i=e.stateNode,Zd(),oi(mo),oi(Hr),Bw(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(pm(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,La!==null&&(c2(La),La=null))),t2(t,e),Sr(e),null;case 5:Gw(e);var r=og(eh.current);if(n=e.type,t!==null&&e.stateNode!=null)WH(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(xt(166));return Sr(e),null}if(t=og(vs.current),pm(e)){i=e.stateNode,n=e.type;var o=e.memoizedProps;switch(i[hs]=e,i[$C]=o,t=(e.mode&1)!==0,n){case"dialog":ii("cancel",i),ii("close",i);break;case"iframe":case"object":case"embed":ii("load",i);break;case"video":case"audio":for(r=0;r<cC.length;r++)ii(cC[r],i);break;case"source":ii("error",i);break;case"img":case"image":case"link":ii("error",i),ii("load",i);break;case"details":ii("toggle",i);break;case"input":SR(i,o),ii("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},ii("invalid",i);break;case"textarea":ZR(i,o),ii("invalid",i)}xB(n,o),r=null;for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];a==="children"?typeof s=="string"?i.textContent!==s&&(o.suppressHydrationWarning!==!0&&Am(i.textContent,s,t),r=["children",s]):typeof s=="number"&&i.textContent!==""+s&&(o.suppressHydrationWarning!==!0&&Am(i.textContent,s,t),r=["children",""+s]):TC.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&ii("scroll",i)}switch(n){case"input":gm(i),wR(i,o,!0);break;case"textarea":gm(i),xR(i);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(i.onclick=wp)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=o5(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=a.createElement(n,{is:i.is}):(t=a.createElement(n),n==="select"&&(a=t,i.multiple?a.multiple=!0:i.size&&(a.size=i.size))):t=a.createElementNS(t,n),t[hs]=e,t[$C]=i,RH(t,e,!1,!1),e.stateNode=t;e:{switch(a=RB(n,i),n){case"dialog":ii("cancel",t),ii("close",t),r=i;break;case"iframe":case"object":case"embed":ii("load",t),r=i;break;case"video":case"audio":for(r=0;r<cC.length;r++)ii(cC[r],t);r=i;break;case"source":ii("error",t),r=i;break;case"img":case"image":case"link":ii("error",t),ii("load",t),r=i;break;case"details":ii("toggle",t),r=i;break;case"input":SR(t,i),r=GB(t,i),ii("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=mi({},i,{value:void 0}),ii("invalid",t);break;case"textarea":ZR(t,i),r=wB(t,i),ii("invalid",t);break;default:r=i}xB(n,r),s=r;for(o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="style"?l5(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&a5(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&_C(t,l):typeof l=="number"&&_C(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(TC.hasOwnProperty(o)?l!=null&&o==="onScroll"&&ii("scroll",t):l!=null&&ew(t,o,l,a))}switch(n){case"input":gm(t),wR(t,i,!1);break;case"textarea":gm(t),xR(t);break;case"option":i.value!=null&&t.setAttribute("value",""+oc(i.value));break;case"select":t.multiple=!!i.multiple,o=i.value,o!=null?gd(t,!!i.multiple,o,!1):i.defaultValue!=null&&gd(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=wp)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Sr(e),null;case 6:if(t&&e.stateNode!=null)VH(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(xt(166));if(n=og(eh.current),og(vs.current),pm(e)){if(i=e.stateNode,n=e.memoizedProps,i[hs]=e,(o=i.nodeValue!==n)&&(t=To,t!==null))switch(t.tag){case 3:Am(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Am(i.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[hs]=e,e.stateNode=i}return Sr(e),null;case 13:if(oi(Ii),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(li&&Ko!==null&&e.mode&1&&!(e.flags&128))J5(),Sd(),e.flags|=98560,o=!1;else if(o=pm(e),i!==null&&i.dehydrated!==null){if(t===null){if(!o)throw Error(xt(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(xt(317));o[hs]=e}else Sd(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Sr(e),o=!1}else La!==null&&(c2(La),La=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||Ii.current&1?ki===0&&(ki=3):Xw())),e.updateQueue!==null&&(e.flags|=4),Sr(e),null);case 4:return Zd(),t2(t,e),t===null&&QC(e.stateNode.containerInfo),Sr(e),null;case 10:return pw(e.type._context),Sr(e),null;case 17:return Ao(e.type)&&Zp(),Sr(e),null;case 19:if(oi(Ii),o=e.memoizedState,o===null)return Sr(e),null;if(i=(e.flags&128)!==0,a=o.rendering,a===null)if(i)RI(o,!1);else{if(ki!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Fp(t),a!==null){for(e.flags|=128,RI(o,!1),i=a.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)o=n,t=i,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,t=a.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ei(Ii,Ii.current&1|2),e.child}t=t.sibling}o.tail!==null&&xi()>Rd&&(e.flags|=128,i=!0,RI(o,!1),e.lanes=4194304)}else{if(!i)if(t=Fp(a),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),RI(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!li)return Sr(e),null}else 2*xi()-o.renderingStartTime>Rd&&n!==1073741824&&(e.flags|=128,i=!0,RI(o,!1),e.lanes=4194304);o.isBackwards?(a.sibling=e.child,e.child=a):(n=o.last,n!==null?n.sibling=a:e.child=a,o.last=a)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=xi(),e.sibling=null,n=Ii.current,ei(Ii,i?n&1|2:n&1),e):(Sr(e),null);case 22:case 23:return Hw(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Eo&1073741824&&(Sr(e),e.subtreeFlags&6&&(e.flags|=8192)):Sr(e),null;case 24:return null;case 25:return null}throw Error(xt(156,e.tag))}function vk(t,e){switch(hw(e),e.tag){case 1:return Ao(e.type)&&Zp(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Zd(),oi(mo),oi(Hr),Bw(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Gw(e),null;case 13:if(oi(Ii),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(xt(340));Sd()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return oi(Ii),null;case 4:return Zd(),null;case 10:return pw(e.type._context),null;case 22:case 23:return Hw(),null;case 24:return null;default:return null}}var ym=!1,Nr=!1,bk=typeof WeakSet=="function"?WeakSet:Set,jt=null;function qu(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){bi(t,e,i)}else n.current=null}function n2(t,e,n){try{n()}catch(i){bi(t,e,i)}}var mW=!1;function yk(t,e){if(zB=Gp,t=X5(),Iw(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,s=-1,l=-1,c=0,g=0,u=t,d=null;t:for(;;){for(var C;u!==n||r!==0&&u.nodeType!==3||(s=a+r),u!==o||i!==0&&u.nodeType!==3||(l=a+i),u.nodeType===3&&(a+=u.nodeValue.length),(C=u.firstChild)!==null;)d=u,u=C;for(;;){if(u===t)break t;if(d===n&&++c===r&&(s=a),d===o&&++g===i&&(l=a),(C=u.nextSibling)!==null)break;u=d,d=u.parentNode}u=C}n=s===-1||l===-1?null:{start:s,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(KB={focusedElem:t,selectionRange:n},Gp=!1,jt=e;jt!==null;)if(e=jt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,jt=t;else for(;jt!==null;){e=jt;try{var f=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var v=f.memoizedProps,p=f.memoizedState,m=e.stateNode,A=m.getSnapshotBeforeUpdate(e.elementType===e.type?v:Xa(e.type,v),p);m.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(xt(163))}}catch(G){bi(e,e.return,G)}if(t=e.sibling,t!==null){t.return=e.return,jt=t;break}jt=e.return}return f=mW,mW=!1,f}function vC(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var o=r.destroy;r.destroy=void 0,o!==void 0&&n2(e,n,o)}r=r.next}while(r!==i)}}function D0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function i2(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function MH(t){var e=t.alternate;e!==null&&(t.alternate=null,MH(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[hs],delete e[$C],delete e[_B],delete e[rk],delete e[ok])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function NH(t){return t.tag===5||t.tag===3||t.tag===4}function AW(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||NH(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function r2(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=wp));else if(i!==4&&(t=t.child,t!==null))for(r2(t,e,n),t=t.sibling;t!==null;)r2(t,e,n),t=t.sibling}function o2(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(o2(t,e,n),t=t.sibling;t!==null;)o2(t,e,n),t=t.sibling}var ur=null,Ya=!1;function Sl(t,e,n){for(n=n.child;n!==null;)FH(t,e,n),n=n.sibling}function FH(t,e,n){if(ps&&typeof ps.onCommitFiberUnmount=="function")try{ps.onCommitFiberUnmount(z0,n)}catch{}switch(n.tag){case 5:Nr||qu(n,e);case 6:var i=ur,r=Ya;ur=null,Sl(t,e,n),ur=i,Ya=r,ur!==null&&(Ya?(t=ur,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ur.removeChild(n.stateNode));break;case 18:ur!==null&&(Ya?(t=ur,n=n.stateNode,t.nodeType===8?by(t.parentNode,n):t.nodeType===1&&by(t,n),DC(t)):by(ur,n.stateNode));break;case 4:i=ur,r=Ya,ur=n.stateNode.containerInfo,Ya=!0,Sl(t,e,n),ur=i,Ya=r;break;case 0:case 11:case 14:case 15:if(!Nr&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var o=r,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&n2(n,e,a),r=r.next}while(r!==i)}Sl(t,e,n);break;case 1:if(!Nr&&(qu(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(s){bi(n,e,s)}Sl(t,e,n);break;case 21:Sl(t,e,n);break;case 22:n.mode&1?(Nr=(i=Nr)||n.memoizedState!==null,Sl(t,e,n),Nr=i):Sl(t,e,n);break;default:Sl(t,e,n)}}function pW(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new bk),e.forEach(function(i){var r=Vk.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function xa(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var o=t,a=e,s=a;e:for(;s!==null;){switch(s.tag){case 5:ur=s.stateNode,Ya=!1;break e;case 3:ur=s.stateNode.containerInfo,Ya=!0;break e;case 4:ur=s.stateNode.containerInfo,Ya=!0;break e}s=s.return}if(ur===null)throw Error(xt(160));FH(o,a,r),ur=null,Ya=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){bi(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)HH(e,t),e=e.sibling}function HH(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(xa(e,t),ls(t),i&4){try{vC(3,t,t.return),D0(3,t)}catch(v){bi(t,t.return,v)}try{vC(5,t,t.return)}catch(v){bi(t,t.return,v)}}break;case 1:xa(e,t),ls(t),i&512&&n!==null&&qu(n,n.return);break;case 5:if(xa(e,t),ls(t),i&512&&n!==null&&qu(n,n.return),t.flags&32){var r=t.stateNode;try{_C(r,"")}catch(v){bi(t,t.return,v)}}if(i&4&&(r=t.stateNode,r!=null)){var o=t.memoizedProps,a=n!==null?n.memoizedProps:o,s=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{s==="input"&&o.type==="radio"&&o.name!=null&&i5(r,o),RB(s,a);var c=RB(s,o);for(a=0;a<l.length;a+=2){var g=l[a],u=l[a+1];g==="style"?l5(r,u):g==="dangerouslySetInnerHTML"?a5(r,u):g==="children"?_C(r,u):ew(r,g,u,c)}switch(s){case"input":BB(r,o);break;case"textarea":r5(r,o);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var C=o.value;C!=null?gd(r,!!o.multiple,C,!1):d!==!!o.multiple&&(o.defaultValue!=null?gd(r,!!o.multiple,o.defaultValue,!0):gd(r,!!o.multiple,o.multiple?[]:"",!1))}r[$C]=o}catch(v){bi(t,t.return,v)}}break;case 6:if(xa(e,t),ls(t),i&4){if(t.stateNode===null)throw Error(xt(162));r=t.stateNode,o=t.memoizedProps;try{r.nodeValue=o}catch(v){bi(t,t.return,v)}}break;case 3:if(xa(e,t),ls(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{DC(e.containerInfo)}catch(v){bi(t,t.return,v)}break;case 4:xa(e,t),ls(t);break;case 13:xa(e,t),ls(t),r=t.child,r.flags&8192&&(o=r.memoizedState!==null,r.stateNode.isHidden=o,!o||r.alternate!==null&&r.alternate.memoizedState!==null||(Nw=xi())),i&4&&pW(t);break;case 22:if(g=n!==null&&n.memoizedState!==null,t.mode&1?(Nr=(c=Nr)||g,xa(e,t),Nr=c):xa(e,t),ls(t),i&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!g&&t.mode&1)for(jt=t,g=t.child;g!==null;){for(u=jt=g;jt!==null;){switch(d=jt,C=d.child,d.tag){case 0:case 11:case 14:case 15:vC(4,d,d.return);break;case 1:qu(d,d.return);var f=d.stateNode;if(typeof f.componentWillUnmount=="function"){i=d,n=d.return;try{e=i,f.props=e.memoizedProps,f.state=e.memoizedState,f.componentWillUnmount()}catch(v){bi(i,n,v)}}break;case 5:qu(d,d.return);break;case 22:if(d.memoizedState!==null){bW(u);continue}}C!==null?(C.return=d,jt=C):bW(u)}g=g.sibling}e:for(g=null,u=t;;){if(u.tag===5){if(g===null){g=u;try{r=u.stateNode,c?(o=r.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(s=u.stateNode,l=u.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=s5("display",a))}catch(v){bi(t,t.return,v)}}}else if(u.tag===6){if(g===null)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(v){bi(t,t.return,v)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===t)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===t)break e;for(;u.sibling===null;){if(u.return===null||u.return===t)break e;g===u&&(g=null),u=u.return}g===u&&(g=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:xa(e,t),ls(t),i&4&&pW(t);break;case 21:break;default:xa(e,t),ls(t)}}function ls(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(NH(n)){var i=n;break e}n=n.return}throw Error(xt(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(_C(r,""),i.flags&=-33);var o=AW(t);o2(t,o,r);break;case 3:case 4:var a=i.stateNode.containerInfo,s=AW(t);r2(t,s,a);break;default:throw Error(xt(161))}}catch(l){bi(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Gk(t,e,n){jt=t,XH(t)}function XH(t,e,n){for(var i=(t.mode&1)!==0;jt!==null;){var r=jt,o=r.child;if(r.tag===22&&i){var a=r.memoizedState!==null||ym;if(!a){var s=r.alternate,l=s!==null&&s.memoizedState!==null||Nr;s=ym;var c=Nr;if(ym=a,(Nr=l)&&!c)for(jt=r;jt!==null;)a=jt,l=a.child,a.tag===22&&a.memoizedState!==null?yW(r):l!==null?(l.return=a,jt=l):yW(r);for(;o!==null;)jt=o,XH(o),o=o.sibling;jt=r,ym=s,Nr=c}vW(t)}else r.subtreeFlags&8772&&o!==null?(o.return=r,jt=o):vW(t)}}function vW(t){for(;jt!==null;){var e=jt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Nr||D0(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Nr)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Xa(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&rW(e,o,i);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}rW(e,a,n)}break;case 5:var s=e.stateNode;if(n===null&&e.flags&4){n=s;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var g=c.memoizedState;if(g!==null){var u=g.dehydrated;u!==null&&DC(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(xt(163))}Nr||e.flags&512&&i2(e)}catch(d){bi(e,e.return,d)}}if(e===t){jt=null;break}if(n=e.sibling,n!==null){n.return=e.return,jt=n;break}jt=e.return}}function bW(t){for(;jt!==null;){var e=jt;if(e===t){jt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,jt=n;break}jt=e.return}}function yW(t){for(;jt!==null;){var e=jt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{D0(4,e)}catch(l){bi(e,n,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){bi(e,r,l)}}var o=e.return;try{i2(e)}catch(l){bi(e,o,l)}break;case 5:var a=e.return;try{i2(e)}catch(l){bi(e,a,l)}}}catch(l){bi(e,e.return,l)}if(e===t){jt=null;break}var s=e.sibling;if(s!==null){s.return=e.return,jt=s;break}jt=e.return}}var Bk=Math.ceil,Ep=ul.ReactCurrentDispatcher,Vw=ul.ReactCurrentOwner,ha=ul.ReactCurrentBatchConfig,Nn=0,ar=null,Yi=null,dr=0,Eo=0,ed=Ic(0),ki=0,rh=null,Zg=0,O0=0,Mw=0,bC=null,ho=null,Nw=0,Rd=1/0,ks=null,Yp=!1,a2=null,nc=null,Gm=!1,Pl=null,zp=0,yC=0,s2=null,jA=-1,$A=0;function jr(){return Nn&6?xi():jA!==-1?jA:jA=xi()}function ic(t){return t.mode&1?Nn&2&&dr!==0?dr&-dr:sk.transition!==null?($A===0&&($A=v5()),$A):(t=_n,t!==0||(t=window.event,t=t===void 0?16:Z5(t.type)),t):1}function ka(t,e,n,i){if(50<yC)throw yC=0,s2=null,Error(xt(185));Lh(t,n,i),(!(Nn&2)||t!==ar)&&(t===ar&&(!(Nn&2)&&(O0|=n),ki===4&&Tl(t,dr)),po(t,i),n===1&&Nn===0&&!(e.mode&1)&&(Rd=xi()+500,k0&&Cc()))}function po(t,e){var n=t.callbackNode;s_(t,e);var i=yp(t,t===ar?dr:0);if(i===0)n!==null&&VR(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&VR(n),e===1)t.tag===0?ak(GW.bind(null,t)):U5(GW.bind(null,t)),nk(function(){!(Nn&6)&&Cc()}),n=null;else{switch(b5(i)){case 1:n=ow;break;case 4:n=A5;break;case 16:n=bp;break;case 536870912:n=p5;break;default:n=bp}n=kH(n,EH.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function EH(t,e){if(jA=-1,$A=0,Nn&6)throw Error(xt(327));var n=t.callbackNode;if(hd()&&t.callbackNode!==n)return null;var i=yp(t,t===ar?dr:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=Kp(t,i);else{e=i;var r=Nn;Nn|=2;var o=zH();(ar!==t||dr!==e)&&(ks=null,Rd=xi()+500,hg(t,e));do try{Zk();break}catch(s){YH(t,s)}while(!0);Aw(),Ep.current=o,Nn=r,Yi!==null?e=0:(ar=null,dr=0,e=ki)}if(e!==0){if(e===2&&(r=FB(t),r!==0&&(i=r,e=l2(t,r))),e===1)throw n=rh,hg(t,0),Tl(t,i),po(t,xi()),n;if(e===6)Tl(t,i);else{if(r=t.current.alternate,!(i&30)&&!Sk(r)&&(e=Kp(t,i),e===2&&(o=FB(t),o!==0&&(i=o,e=l2(t,o))),e===1))throw n=rh,hg(t,0),Tl(t,i),po(t,xi()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(xt(345));case 2:Dc(t,ho,ks);break;case 3:if(Tl(t,i),(i&130023424)===i&&(e=Nw+500-xi(),10<e)){if(yp(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){jr(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=TB(Dc.bind(null,t,ho,ks),e);break}Dc(t,ho,ks);break;case 4:if(Tl(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var a=31-_a(i);o=1<<a,a=e[a],a>r&&(r=a),i&=~o}if(i=r,i=xi()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Bk(i/1960))-i,10<i){t.timeoutHandle=TB(Dc.bind(null,t,ho,ks),i);break}Dc(t,ho,ks);break;case 5:Dc(t,ho,ks);break;default:throw Error(xt(329))}}}return po(t,xi()),t.callbackNode===n?EH.bind(null,t):null}function l2(t,e){var n=bC;return t.current.memoizedState.isDehydrated&&(hg(t,e).flags|=256),t=Kp(t,e),t!==2&&(e=ho,ho=n,e!==null&&c2(e)),t}function c2(t){ho===null?ho=t:ho.push.apply(ho,t)}function Sk(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],o=r.getSnapshot;r=r.value;try{if(!Ja(o(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Tl(t,e){for(e&=~Mw,e&=~O0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-_a(e),i=1<<n;t[n]=-1,e&=~i}}function GW(t){if(Nn&6)throw Error(xt(327));hd();var e=yp(t,0);if(!(e&1))return po(t,xi()),null;var n=Kp(t,e);if(t.tag!==0&&n===2){var i=FB(t);i!==0&&(e=i,n=l2(t,i))}if(n===1)throw n=rh,hg(t,0),Tl(t,e),po(t,xi()),n;if(n===6)throw Error(xt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Dc(t,ho,ks),po(t,xi()),null}function Fw(t,e){var n=Nn;Nn|=1;try{return t(e)}finally{Nn=n,Nn===0&&(Rd=xi()+500,k0&&Cc())}}function xg(t){Pl!==null&&Pl.tag===0&&!(Nn&6)&&hd();var e=Nn;Nn|=1;var n=ha.transition,i=_n;try{if(ha.transition=null,_n=1,t)return t()}finally{_n=i,ha.transition=n,Nn=e,!(Nn&6)&&Cc()}}function Hw(){Eo=ed.current,oi(ed)}function hg(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,tk(n)),Yi!==null)for(n=Yi.return;n!==null;){var i=n;switch(hw(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Zp();break;case 3:Zd(),oi(mo),oi(Hr),Bw();break;case 5:Gw(i);break;case 4:Zd();break;case 13:oi(Ii);break;case 19:oi(Ii);break;case 10:pw(i.type._context);break;case 22:case 23:Hw()}n=n.return}if(ar=t,Yi=t=rc(t.current,null),dr=Eo=e,ki=0,rh=null,Mw=O0=Zg=0,ho=bC=null,rg!==null){for(e=0;e<rg.length;e++)if(n=rg[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,o=n.pending;if(o!==null){var a=o.next;o.next=r,i.next=a}n.pending=i}rg=null}return t}function YH(t,e){do{var n=Yi;try{if(Aw(),OA.current=Xp,Hp){for(var i=fi.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Hp=!1}if(wg=0,ir=_i=fi=null,pC=!1,th=0,Vw.current=null,n===null||n.return===null){ki=1,rh=e,Yi=null;break}e:{var o=t,a=n.return,s=n,l=e;if(e=dr,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,g=s,u=g.tag;if(!(g.mode&1)&&(u===0||u===11||u===15)){var d=g.alternate;d?(g.updateQueue=d.updateQueue,g.memoizedState=d.memoizedState,g.lanes=d.lanes):(g.updateQueue=null,g.memoizedState=null)}var C=gW(a);if(C!==null){C.flags&=-257,uW(C,a,s,o,e),C.mode&1&&cW(o,c,e),e=C,l=c;var f=e.updateQueue;if(f===null){var v=new Set;v.add(l),e.updateQueue=v}else f.add(l);break e}else{if(!(e&1)){cW(o,c,e),Xw();break e}l=Error(xt(426))}}else if(li&&s.mode&1){var p=gW(a);if(p!==null){!(p.flags&65536)&&(p.flags|=256),uW(p,a,s,o,e),fw(xd(l,s));break e}}o=l=xd(l,s),ki!==4&&(ki=2),bC===null?bC=[o]:bC.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var m=bH(o,l,e);iW(o,m);break e;case 1:s=l;var A=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof A.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(nc===null||!nc.has(b)))){o.flags|=65536,e&=-e,o.lanes|=e;var G=yH(o,s,e);iW(o,G);break e}}o=o.return}while(o!==null)}LH(n)}catch(w){e=w,Yi===n&&n!==null&&(Yi=n=n.return);continue}break}while(!0)}function zH(){var t=Ep.current;return Ep.current=Xp,t===null?Xp:t}function Xw(){(ki===0||ki===3||ki===2)&&(ki=4),ar===null||!(Zg&268435455)&&!(O0&268435455)||Tl(ar,dr)}function Kp(t,e){var n=Nn;Nn|=2;var i=zH();(ar!==t||dr!==e)&&(ks=null,hg(t,e));do try{wk();break}catch(r){YH(t,r)}while(!0);if(Aw(),Nn=n,Ep.current=i,Yi!==null)throw Error(xt(261));return ar=null,dr=0,ki}function wk(){for(;Yi!==null;)KH(Yi)}function Zk(){for(;Yi!==null&&!$T();)KH(Yi)}function KH(t){var e=_H(t.alternate,t,Eo);t.memoizedProps=t.pendingProps,e===null?LH(t):Yi=e,Vw.current=null}function LH(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=vk(n,e),n!==null){n.flags&=32767,Yi=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ki=6,Yi=null;return}}else if(n=pk(n,e,Eo),n!==null){Yi=n;return}if(e=e.sibling,e!==null){Yi=e;return}Yi=e=t}while(e!==null);ki===0&&(ki=5)}function Dc(t,e,n){var i=_n,r=ha.transition;try{ha.transition=null,_n=1,xk(t,e,n,i)}finally{ha.transition=r,_n=i}return null}function xk(t,e,n,i){do hd();while(Pl!==null);if(Nn&6)throw Error(xt(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(xt(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(l_(t,o),t===ar&&(Yi=ar=null,dr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Gm||(Gm=!0,kH(bp,function(){return hd(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=ha.transition,ha.transition=null;var a=_n;_n=1;var s=Nn;Nn|=4,Vw.current=null,yk(t,n),HH(n,t),O_(KB),Gp=!!zB,KB=zB=null,t.current=n,Gk(n),qT(),Nn=s,_n=a,ha.transition=o}else t.current=n;if(Gm&&(Gm=!1,Pl=t,zp=r),o=t.pendingLanes,o===0&&(nc=null),n_(n.stateNode),po(t,xi()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Yp)throw Yp=!1,t=a2,a2=null,t;return zp&1&&t.tag!==0&&hd(),o=t.pendingLanes,o&1?t===s2?yC++:(yC=0,s2=t):yC=0,Cc(),null}function hd(){if(Pl!==null){var t=b5(zp),e=ha.transition,n=_n;try{if(ha.transition=null,_n=16>t?16:t,Pl===null)var i=!1;else{if(t=Pl,Pl=null,zp=0,Nn&6)throw Error(xt(331));var r=Nn;for(Nn|=4,jt=t.current;jt!==null;){var o=jt,a=o.child;if(jt.flags&16){var s=o.deletions;if(s!==null){for(var l=0;l<s.length;l++){var c=s[l];for(jt=c;jt!==null;){var g=jt;switch(g.tag){case 0:case 11:case 15:vC(8,g,o)}var u=g.child;if(u!==null)u.return=g,jt=u;else for(;jt!==null;){g=jt;var d=g.sibling,C=g.return;if(MH(g),g===c){jt=null;break}if(d!==null){d.return=C,jt=d;break}jt=C}}}var f=o.alternate;if(f!==null){var v=f.child;if(v!==null){f.child=null;do{var p=v.sibling;v.sibling=null,v=p}while(v!==null)}}jt=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,jt=a;else e:for(;jt!==null;){if(o=jt,o.flags&2048)switch(o.tag){case 0:case 11:case 15:vC(9,o,o.return)}var m=o.sibling;if(m!==null){m.return=o.return,jt=m;break e}jt=o.return}}var A=t.current;for(jt=A;jt!==null;){a=jt;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,jt=b;else e:for(a=A;jt!==null;){if(s=jt,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:D0(9,s)}}catch(w){bi(s,s.return,w)}if(s===a){jt=null;break e}var G=s.sibling;if(G!==null){G.return=s.return,jt=G;break e}jt=s.return}}if(Nn=r,Cc(),ps&&typeof ps.onPostCommitFiberRoot=="function")try{ps.onPostCommitFiberRoot(z0,t)}catch{}i=!0}return i}finally{_n=n,ha.transition=e}}return!1}function BW(t,e,n){e=xd(n,e),e=bH(t,e,1),t=tc(t,e,1),e=jr(),t!==null&&(Lh(t,1,e),po(t,e))}function bi(t,e,n){if(t.tag===3)BW(t,t,n);else for(;e!==null;){if(e.tag===3){BW(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(nc===null||!nc.has(i))){t=xd(n,t),t=yH(e,t,1),e=tc(e,t,1),t=jr(),e!==null&&(Lh(e,1,t),po(e,t));break}}e=e.return}}function Rk(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=jr(),t.pingedLanes|=t.suspendedLanes&n,ar===t&&(dr&n)===n&&(ki===4||ki===3&&(dr&130023424)===dr&&500>xi()-Nw?hg(t,0):Mw|=n),po(t,e)}function TH(t,e){e===0&&(t.mode&1?(e=Im,Im<<=1,!(Im&130023424)&&(Im=4194304)):e=1);var n=jr();t=al(t,e),t!==null&&(Lh(t,e,n),po(t,n))}function Wk(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),TH(t,n)}function Vk(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(xt(314))}i!==null&&i.delete(e),TH(t,n)}var _H;_H=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||mo.current)fo=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return fo=!1,Ak(t,e,n);fo=!!(t.flags&131072)}else fo=!1,li&&e.flags&1048576&&D5(e,Wp,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;QA(t,e),t=e.pendingProps;var r=Bd(e,Hr.current);Cd(e,n),r=ww(null,e,i,t,r,n);var o=Zw();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ao(i)?(o=!0,xp(e)):o=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,bw(e),r.updater=U0,e.stateNode=r,r._reactInternals=e,JB(e,i,t,n),e=$B(null,e,i,!0,o,n)):(e.tag=0,li&&o&&Cw(e),Ur(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(QA(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=Nk(i),t=Xa(i,t),r){case 0:e=jB(null,e,i,t,n);break e;case 1:e=CW(null,e,i,t,n);break e;case 11:e=dW(null,e,i,t,n);break e;case 14:e=IW(null,e,i,Xa(i.type,t),n);break e}throw Error(xt(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Xa(i,r),jB(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Xa(i,r),CW(t,e,i,r,n);case 3:e:{if(wH(e),t===null)throw Error(xt(387));i=e.pendingProps,o=e.memoizedState,r=o.element,q5(t,e),Np(e,i,null,n);var a=e.memoizedState;if(i=a.element,o.isDehydrated)if(o={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){r=xd(Error(xt(423)),e),e=hW(t,e,i,n,r);break e}else if(i!==r){r=xd(Error(xt(424)),e),e=hW(t,e,i,n,r);break e}else for(Ko=ec(e.stateNode.containerInfo.firstChild),To=e,li=!0,La=null,n=j5(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Sd(),i===r){e=sl(t,e,n);break e}Ur(t,e,i,n)}e=e.child}return e;case 5:return eH(e),t===null&&UB(e),i=e.type,r=e.pendingProps,o=t!==null?t.memoizedProps:null,a=r.children,LB(i,r)?a=null:o!==null&&LB(i,o)&&(e.flags|=32),SH(t,e),Ur(t,e,a,n),e.child;case 6:return t===null&&UB(e),null;case 13:return ZH(t,e,n);case 4:return yw(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=wd(e,null,i,n):Ur(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Xa(i,r),dW(t,e,i,r,n);case 7:return Ur(t,e,e.pendingProps,n),e.child;case 8:return Ur(t,e,e.pendingProps.children,n),e.child;case 12:return Ur(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,o=e.memoizedProps,a=r.value,ei(Vp,i._currentValue),i._currentValue=a,o!==null)if(Ja(o.value,a)){if(o.children===r.children&&!mo.current){e=sl(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var s=o.dependencies;if(s!==null){a=o.child;for(var l=s.firstContext;l!==null;){if(l.context===i){if(o.tag===1){l=tl(-1,n&-n),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var g=c.pending;g===null?l.next=l:(l.next=g.next,g.next=l),c.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),DB(o.return,n,e),s.lanes|=n;break}l=l.next}}else if(o.tag===10)a=o.type===e.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(xt(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),DB(a,n,e),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===e){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}Ur(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Cd(e,n),r=fa(r),i=i(r),e.flags|=1,Ur(t,e,i,n),e.child;case 14:return i=e.type,r=Xa(i,e.pendingProps),r=Xa(i.type,r),IW(t,e,i,r,n);case 15:return GH(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Xa(i,r),QA(t,e),e.tag=1,Ao(i)?(t=!0,xp(e)):t=!1,Cd(e,n),vH(e,i,r),JB(e,i,r,n),$B(null,e,i,!0,t,n);case 19:return xH(t,e,n);case 22:return BH(t,e,n)}throw Error(xt(156,e.tag))};function kH(t,e){return m5(t,e)}function Mk(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ca(t,e,n,i){return new Mk(t,e,n,i)}function Ew(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Nk(t){if(typeof t=="function")return Ew(t)?1:0;if(t!=null){if(t=t.$$typeof,t===nw)return 11;if(t===iw)return 14}return 2}function rc(t,e){var n=t.alternate;return n===null?(n=Ca(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function qA(t,e,n,i,r,o){var a=2;if(i=t,typeof t=="function")Ew(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case ku:return fg(n.children,r,o,e);case tw:a=8,r|=8;break;case pB:return t=Ca(12,n,e,r|2),t.elementType=pB,t.lanes=o,t;case vB:return t=Ca(13,n,e,r),t.elementType=vB,t.lanes=o,t;case bB:return t=Ca(19,n,e,r),t.elementType=bB,t.lanes=o,t;case e5:return J0(n,r,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case $3:a=10;break e;case q3:a=9;break e;case nw:a=11;break e;case iw:a=14;break e;case Yl:a=16,i=null;break e}throw Error(xt(130,t==null?t:typeof t,""))}return e=Ca(a,n,e,r),e.elementType=t,e.type=i,e.lanes=o,e}function fg(t,e,n,i){return t=Ca(7,t,i,e),t.lanes=n,t}function J0(t,e,n,i){return t=Ca(22,t,i,e),t.elementType=e5,t.lanes=n,t.stateNode={isHidden:!1},t}function Ry(t,e,n){return t=Ca(6,t,null,e),t.lanes=n,t}function Wy(t,e,n){return e=Ca(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Fk(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gy(0),this.expirationTimes=gy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gy(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Yw(t,e,n,i,r,o,a,s,l){return t=new Fk(t,e,n,s,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Ca(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},bw(o),t}function Hk(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_u,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function PH(t){if(!t)return ac;t=t._reactInternals;e:{if(Yg(t)!==t||t.tag!==1)throw Error(xt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ao(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(xt(171))}if(t.tag===1){var n=t.type;if(Ao(n))return P5(t,n,e)}return e}function UH(t,e,n,i,r,o,a,s,l){return t=Yw(n,i,!0,t,r,o,a,s,l),t.context=PH(null),n=t.current,i=jr(),r=ic(n),o=tl(i,r),o.callback=e??null,tc(n,o,r),t.current.lanes=r,Lh(t,r,i),po(t,i),t}function Q0(t,e,n,i){var r=e.current,o=jr(),a=ic(r);return n=PH(n),e.context===null?e.context=n:e.pendingContext=n,e=tl(o,a),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=tc(r,e,a),t!==null&&(ka(t,r,a,o),DA(t,r,a)),a}function Lp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function SW(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function zw(t,e){SW(t,e),(t=t.alternate)&&SW(t,e)}function Xk(){return null}var DH=typeof reportError=="function"?reportError:function(t){console.error(t)};function Kw(t){this._internalRoot=t}j0.prototype.render=Kw.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(xt(409));Q0(t,e,null,null)};j0.prototype.unmount=Kw.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;xg(function(){Q0(null,t,null,null)}),e[ol]=null}};function j0(t){this._internalRoot=t}j0.prototype.unstable_scheduleHydration=function(t){if(t){var e=B5();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ll.length&&e!==0&&e<Ll[n].priority;n++);Ll.splice(n,0,t),n===0&&w5(t)}};function Lw(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function $0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function wW(){}function Ek(t,e,n,i,r){if(r){if(typeof i=="function"){var o=i;i=function(){var c=Lp(a);o.call(c)}}var a=UH(e,i,t,0,null,!1,!1,"",wW);return t._reactRootContainer=a,t[ol]=a.current,QC(t.nodeType===8?t.parentNode:t),xg(),a}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var s=i;i=function(){var c=Lp(l);s.call(c)}}var l=Yw(t,0,!1,null,null,!1,!1,"",wW);return t._reactRootContainer=l,t[ol]=l.current,QC(t.nodeType===8?t.parentNode:t),xg(function(){Q0(e,l,n,i)}),l}function q0(t,e,n,i,r){var o=n._reactRootContainer;if(o){var a=o;if(typeof r=="function"){var s=r;r=function(){var l=Lp(a);s.call(l)}}Q0(e,a,t,r)}else a=Ek(n,e,t,r,i);return Lp(a)}y5=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=lC(e.pendingLanes);n!==0&&(aw(e,n|1),po(e,xi()),!(Nn&6)&&(Rd=xi()+500,Cc()))}break;case 13:xg(function(){var i=al(t,1);if(i!==null){var r=jr();ka(i,t,1,r)}}),zw(t,1)}};sw=function(t){if(t.tag===13){var e=al(t,134217728);if(e!==null){var n=jr();ka(e,t,134217728,n)}zw(t,134217728)}};G5=function(t){if(t.tag===13){var e=ic(t),n=al(t,e);if(n!==null){var i=jr();ka(n,t,e,i)}zw(t,e)}};B5=function(){return _n};S5=function(t,e){var n=_n;try{return _n=t,e()}finally{_n=n}};VB=function(t,e,n){switch(e){case"input":if(BB(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=_0(i);if(!r)throw Error(xt(90));n5(i),BB(i,r)}}}break;case"textarea":r5(t,n);break;case"select":e=n.value,e!=null&&gd(t,!!n.multiple,e,!1)}};u5=Fw;d5=xg;var Yk={usingClientEntryPoint:!1,Events:[_h,Ou,_0,c5,g5,Fw]},WI={findFiberByHostInstance:ig,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zk={bundleType:WI.bundleType,version:WI.version,rendererPackageName:WI.rendererPackageName,rendererConfig:WI.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ul.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=h5(t),t===null?null:t.stateNode},findFiberByHostInstance:WI.findFiberByHostInstance||Xk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bm.isDisabled&&Bm.supportsFiber)try{z0=Bm.inject(zk),ps=Bm}catch{}}Oo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yk;Oo.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lw(e))throw Error(xt(200));return Hk(t,e,null,n)};Oo.createRoot=function(t,e){if(!Lw(t))throw Error(xt(299));var n=!1,i="",r=DH;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Yw(t,1,!1,null,null,n,!1,i,r),t[ol]=e.current,QC(t.nodeType===8?t.parentNode:t),new Kw(e)};Oo.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(xt(188)):(t=Object.keys(t).join(","),Error(xt(268,t)));return t=h5(e),t=t===null?null:t.stateNode,t};Oo.flushSync=function(t){return xg(t)};Oo.hydrate=function(t,e,n){if(!$0(e))throw Error(xt(200));return q0(null,t,e,!0,n)};Oo.hydrateRoot=function(t,e,n){if(!Lw(t))throw Error(xt(405));var i=n!=null&&n.hydratedSources||null,r=!1,o="",a=DH;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=UH(e,null,t,1,n??null,r,!1,o,a),t[ol]=e.current,QC(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new j0(e)};Oo.render=function(t,e,n){if(!$0(e))throw Error(xt(200));return q0(null,t,e,!1,n)};Oo.unmountComponentAtNode=function(t){if(!$0(t))throw Error(xt(40));return t._reactRootContainer?(xg(function(){q0(null,null,t,!1,function(){t._reactRootContainer=null,t[ol]=null})}),!0):!1};Oo.unstable_batchedUpdates=Fw;Oo.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!$0(n))throw Error(xt(200));if(t==null||t._reactInternals===void 0)throw Error(xt(38));return q0(t,e,n,!1,i)};Oo.version="18.3.1-next-f1338f8080-20240426";function OH(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(OH)}catch(t){console.error(t)}}OH(),O3.exports=Oo;var sc=O3.exports;const g2=X0(sc),Kk=X3({__proto__:null,default:g2},[sc]);var JH,ZW=sc;JH=ZW.createRoot,ZW.hydrateRoot;var QH={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var o="",a=0;a<arguments.length;a++){var s=arguments[a];s&&(o=r(o,i(s)))}return o}function i(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return n.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var a="";for(var s in o)e.call(o,s)&&o[s]&&(a=r(a,s));return a}function r(o,a){return a?o?o+" "+a:o+a:o}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(QH);var Lk=QH.exports;const qe=X0(Lk);function Zt(){return Zt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Zt.apply(null,arguments)}var jH={exports:{}},kn={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tw=Symbol.for("react.element"),_w=Symbol.for("react.portal"),ev=Symbol.for("react.fragment"),tv=Symbol.for("react.strict_mode"),nv=Symbol.for("react.profiler"),iv=Symbol.for("react.provider"),rv=Symbol.for("react.context"),Tk=Symbol.for("react.server_context"),ov=Symbol.for("react.forward_ref"),av=Symbol.for("react.suspense"),sv=Symbol.for("react.suspense_list"),lv=Symbol.for("react.memo"),cv=Symbol.for("react.lazy"),_k=Symbol.for("react.offscreen"),$H;$H=Symbol.for("react.module.reference");function va(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case Tw:switch(t=t.type,t){case ev:case nv:case tv:case av:case sv:return t;default:switch(t=t&&t.$$typeof,t){case Tk:case rv:case ov:case cv:case lv:case iv:return t;default:return e}}case _w:return e}}}kn.ContextConsumer=rv;kn.ContextProvider=iv;kn.Element=Tw;kn.ForwardRef=ov;kn.Fragment=ev;kn.Lazy=cv;kn.Memo=lv;kn.Portal=_w;kn.Profiler=nv;kn.StrictMode=tv;kn.Suspense=av;kn.SuspenseList=sv;kn.isAsyncMode=function(){return!1};kn.isConcurrentMode=function(){return!1};kn.isContextConsumer=function(t){return va(t)===rv};kn.isContextProvider=function(t){return va(t)===iv};kn.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===Tw};kn.isForwardRef=function(t){return va(t)===ov};kn.isFragment=function(t){return va(t)===ev};kn.isLazy=function(t){return va(t)===cv};kn.isMemo=function(t){return va(t)===lv};kn.isPortal=function(t){return va(t)===_w};kn.isProfiler=function(t){return va(t)===nv};kn.isStrictMode=function(t){return va(t)===tv};kn.isSuspense=function(t){return va(t)===av};kn.isSuspenseList=function(t){return va(t)===sv};kn.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===ev||t===nv||t===tv||t===av||t===sv||t===_k||typeof t=="object"&&t!==null&&(t.$$typeof===cv||t.$$typeof===lv||t.$$typeof===iv||t.$$typeof===rv||t.$$typeof===ov||t.$$typeof===$H||t.getModuleId!==void 0)};kn.typeOf=va;jH.exports=kn;var GC=jH.exports;function Rg(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[];return ze.Children.forEach(t,function(i){i==null&&!e.keepEmpty||(Array.isArray(i)?n=n.concat(Rg(i)):GC.isFragment(i)&&i.props?n=n.concat(Rg(i.props.children,e)):n.push(i))}),n}var u2={},kk=function(e){};function Pk(t,e){}function Uk(t,e){}function Dk(){u2={}}function qH(t,e,n){!e&&!u2[n]&&(t(!1,n),u2[n]=!0)}function Fr(t,e){qH(Pk,t,e)}function Ok(t,e){qH(Uk,t,e)}Fr.preMessage=kk;Fr.resetWarned=Dk;Fr.noteOnce=Ok;function qt(t){"@babel/helpers - typeof";return qt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qt(t)}function Jk(t,e){if(qt(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(qt(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eX(t){var e=Jk(t,"string");return qt(e)=="symbol"?e:e+""}function we(t,e,n){return(e=eX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xW(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Re(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?xW(Object(n),!0).forEach(function(i){we(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xW(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function oh(t){return t instanceof HTMLElement||t instanceof SVGElement}function Qk(t){return t&&qt(t)==="object"&&oh(t.nativeElement)?t.nativeElement:oh(t)?t:null}function BC(t){var e=Qk(t);if(e)return e;if(t instanceof ze.Component){var n;return(n=g2.findDOMNode)===null||n===void 0?void 0:n.call(g2,t)}return null}function Ph(t,e,n){var i=y.useRef({});return(!("value"in i.current)||n(i.current.condition,e))&&(i.current.value=t(),i.current.condition=e),i.current.value}var kw=function(e,n){typeof e=="function"?e(n):qt(e)==="object"&&e&&"current"in e&&(e.current=n)},ja=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=n.filter(Boolean);return r.length<=1?r[0]:function(o){n.forEach(function(a){kw(a,o)})}},zg=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Ph(function(){return ja.apply(void 0,n)},n,function(r,o){return r.length!==o.length||r.every(function(a,s){return a!==o[s]})})},Kg=function(e){var n,i,r=GC.isMemo(e)?e.type.type:e.type;return!(typeof r=="function"&&!((n=r.prototype)!==null&&n!==void 0&&n.render)&&r.$$typeof!==GC.ForwardRef||typeof e=="function"&&!((i=e.prototype)!==null&&i!==void 0&&i.render)&&e.$$typeof!==GC.ForwardRef)};function RW(t){return y.isValidElement(t)&&!GC.isFragment(t)}Number(y.version.split(".")[0])>=19;var d2=y.createContext(null);function jk(t){var e=t.children,n=t.onBatchResize,i=y.useRef(0),r=y.useRef([]),o=y.useContext(d2),a=y.useCallback(function(s,l,c){i.current+=1;var g=i.current;r.current.push({size:s,element:l,data:c}),Promise.resolve().then(function(){g===i.current&&(n==null||n(r.current),r.current=[])}),o==null||o(s,l,c)},[n,o]);return y.createElement(d2.Provider,{value:a},e)}var tX=function(){if(typeof Map<"u")return Map;function t(e,n){var i=-1;return e.some(function(r,o){return r[0]===n?(i=o,!0):!1}),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(n){var i=t(this.__entries__,n),r=this.__entries__[i];return r&&r[1]},e.prototype.set=function(n,i){var r=t(this.__entries__,n);~r?this.__entries__[r][1]=i:this.__entries__.push([n,i])},e.prototype.delete=function(n){var i=this.__entries__,r=t(i,n);~r&&i.splice(r,1)},e.prototype.has=function(n){return!!~t(this.__entries__,n)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(n,i){i===void 0&&(i=null);for(var r=0,o=this.__entries__;r<o.length;r++){var a=o[r];n.call(i,a[1],a[0])}},e}()}(),I2=typeof window<"u"&&typeof document<"u"&&window.document===document,Tp=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),$k=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Tp):function(t){return setTimeout(function(){return t(Date.now())},1e3/60)}}(),qk=2;function eP(t,e){var n=!1,i=!1,r=0;function o(){n&&(n=!1,t()),i&&s()}function a(){$k(o)}function s(){var l=Date.now();if(n){if(l-r<qk)return;i=!0}else n=!0,i=!1,setTimeout(a,e);r=l}return s}var tP=20,nP=["top","right","bottom","left","width","height","size","weight"],iP=typeof MutationObserver<"u",rP=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=eP(this.refresh.bind(this),tP)}return t.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},t.prototype.removeObserver=function(e){var n=this.observers_,i=n.indexOf(e);~i&&n.splice(i,1),!n.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},t.prototype.updateObservers_=function(){var e=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return e.forEach(function(n){return n.broadcastActive()}),e.length>0},t.prototype.connect_=function(){!I2||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),iP?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){!I2||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(e){var n=e.propertyName,i=n===void 0?"":n,r=nP.some(function(o){return!!~i.indexOf(o)});r&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),nX=function(t,e){for(var n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];Object.defineProperty(t,r,{value:e[r],enumerable:!1,writable:!1,configurable:!0})}return t},Wd=function(t){var e=t&&t.ownerDocument&&t.ownerDocument.defaultView;return e||Tp},iX=gv(0,0,0,0);function _p(t){return parseFloat(t)||0}function WW(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce(function(i,r){var o=t["border-"+r+"-width"];return i+_p(o)},0)}function oP(t){for(var e=["top","right","bottom","left"],n={},i=0,r=e;i<r.length;i++){var o=r[i],a=t["padding-"+o];n[o]=_p(a)}return n}function aP(t){var e=t.getBBox();return gv(0,0,e.width,e.height)}function sP(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return iX;var i=Wd(t).getComputedStyle(t),r=oP(i),o=r.left+r.right,a=r.top+r.bottom,s=_p(i.width),l=_p(i.height);if(i.boxSizing==="border-box"&&(Math.round(s+o)!==e&&(s-=WW(i,"left","right")+o),Math.round(l+a)!==n&&(l-=WW(i,"top","bottom")+a)),!cP(t)){var c=Math.round(s+o)-e,g=Math.round(l+a)-n;Math.abs(c)!==1&&(s-=c),Math.abs(g)!==1&&(l-=g)}return gv(r.left,r.top,s,l)}var lP=function(){return typeof SVGGraphicsElement<"u"?function(t){return t instanceof Wd(t).SVGGraphicsElement}:function(t){return t instanceof Wd(t).SVGElement&&typeof t.getBBox=="function"}}();function cP(t){return t===Wd(t).document.documentElement}function gP(t){return I2?lP(t)?aP(t):sP(t):iX}function uP(t){var e=t.x,n=t.y,i=t.width,r=t.height,o=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,a=Object.create(o.prototype);return nX(a,{x:e,y:n,width:i,height:r,top:n,right:e+i,bottom:r+n,left:e}),a}function gv(t,e,n,i){return{x:t,y:e,width:n,height:i}}var dP=function(){function t(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=gv(0,0,0,0),this.target=e}return t.prototype.isActive=function(){var e=gP(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},t}(),IP=function(){function t(e,n){var i=uP(n);nX(this,{target:e,contentRect:i})}return t}(),CP=function(){function t(e,n,i){if(this.activeObservations_=[],this.observations_=new tX,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=n,this.callbackCtx_=i}return t.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof Wd(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(e)||(n.set(e,new dP(e)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof Wd(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(e)&&(n.delete(e),n.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&e.activeObservations_.push(n)})},t.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,n=this.activeObservations_.map(function(i){return new IP(i.target,i.broadcastRect())});this.callback_.call(e,n,e),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),rX=typeof WeakMap<"u"?new WeakMap:new tX,oX=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=rP.getInstance(),i=new CP(e,n,this);rX.set(this,i)}return t}();["observe","unobserve","disconnect"].forEach(function(t){oX.prototype[t]=function(){var e;return(e=rX.get(this))[t].apply(e,arguments)}});var hP=function(){return typeof Tp.ResizeObserver<"u"?Tp.ResizeObserver:oX}(),Ul=new Map;function fP(t){t.forEach(function(e){var n,i=e.target;(n=Ul.get(i))===null||n===void 0||n.forEach(function(r){return r(i)})})}var aX=new hP(fP);function mP(t,e){Ul.has(t)||(Ul.set(t,new Set),aX.observe(t)),Ul.get(t).add(e)}function AP(t,e){Ul.has(t)&&(Ul.get(t).delete(e),Ul.get(t).size||(aX.unobserve(t),Ul.delete(t)))}function Ki(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function VW(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,eX(i.key),i)}}function Li(t,e,n){return e&&VW(t.prototype,e),n&&VW(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ah(t,e){return ah=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ah(t,e)}function dl(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ah(t,e)}function sh(t){return sh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},sh(t)}function Pw(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Pw=function(){return!!t})()}function Zn(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pP(t,e){if(e&&(qt(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zn(t)}function Il(t){var e=Pw();return function(){var n,i=sh(t);if(e){var r=sh(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return pP(this,n)}}var vP=function(t){dl(n,t);var e=Il(n);function n(){return Ki(this,n),e.apply(this,arguments)}return Li(n,[{key:"render",value:function(){return this.props.children}}]),n}(y.Component);function bP(t,e){var n=t.children,i=t.disabled,r=y.useRef(null),o=y.useRef(null),a=y.useContext(d2),s=typeof n=="function",l=s?n(r):n,c=y.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),g=!s&&y.isValidElement(l)&&Kg(l),u=g?l.ref:null,d=zg(u,r),C=function(){var m;return BC(r.current)||(r.current&&qt(r.current)==="object"?BC((m=r.current)===null||m===void 0?void 0:m.nativeElement):null)||BC(o.current)};y.useImperativeHandle(e,function(){return C()});var f=y.useRef(t);f.current=t;var v=y.useCallback(function(p){var m=f.current,A=m.onResize,b=m.data,G=p.getBoundingClientRect(),w=G.width,S=G.height,Z=p.offsetWidth,x=p.offsetHeight,R=Math.floor(w),W=Math.floor(S);if(c.current.width!==R||c.current.height!==W||c.current.offsetWidth!==Z||c.current.offsetHeight!==x){var M={width:R,height:W,offsetWidth:Z,offsetHeight:x};c.current=M;var N=Z===Math.round(w)?w:Z,X=x===Math.round(S)?S:x,E=Re(Re({},M),{},{offsetWidth:N,offsetHeight:X});a==null||a(E,p,b),A&&Promise.resolve().then(function(){A(E,p)})}},[]);return y.useEffect(function(){var p=C();return p&&!i&&mP(p,v),function(){return AP(p,v)}},[r.current,i]),y.createElement(vP,{ref:o},g?y.cloneElement(l,{ref:d}):l)}var yP=y.forwardRef(bP),GP="rc-observer-key";function BP(t,e){var n=t.children,i=typeof n=="function"?[n]:Rg(n);return i.map(function(r,o){var a=(r==null?void 0:r.key)||"".concat(GP,"-").concat(o);return y.createElement(yP,Zt({},t,{key:a,ref:o===0?e:void 0}),r)})}var Pa=y.forwardRef(BP);Pa.Collection=jk;function $a(t,e){var n=Object.assign({},t);return Array.isArray(e)&&e.forEach(function(i){delete n[i]}),n}function C2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function SP(t){if(Array.isArray(t))return C2(t)}function sX(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Uw(t,e){if(t){if(typeof t=="string")return C2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C2(t,e):void 0}}function wP(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Et(t){return SP(t)||sX(t)||Uw(t)||wP()}var lX=function(e){return+setTimeout(e,16)},cX=function(e){return clearTimeout(e)};typeof window<"u"&&"requestAnimationFrame"in window&&(lX=function(e){return window.requestAnimationFrame(e)},cX=function(e){return window.cancelAnimationFrame(e)});var MW=0,Dw=new Map;function gX(t){Dw.delete(t)}var Ln=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;MW+=1;var i=MW;function r(o){if(o===0)gX(i),e();else{var a=lX(function(){r(o-1)});Dw.set(i,a)}}return r(n),i};Ln.cancel=function(t){var e=Dw.get(t);return gX(t),cX(e)};function uX(t){if(Array.isArray(t))return t}function ZP(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=o.call(n)).done)&&(s.push(i.value),s.length!==e);l=!0);}catch(g){c=!0,r=g}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return s}}function dX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function De(t,e){return uX(t)||ZP(t,e)||Uw(t,e)||dX()}function lh(t){for(var e=0,n,i=0,r=t.length;r>=4;++i,r-=4)n=t.charCodeAt(i)&255|(t.charCodeAt(++i)&255)<<8|(t.charCodeAt(++i)&255)<<16|(t.charCodeAt(++i)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(r){case 3:e^=(t.charCodeAt(i+2)&255)<<16;case 2:e^=(t.charCodeAt(i+1)&255)<<8;case 1:e^=t.charCodeAt(i)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}function eo(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function h2(t,e){if(!t)return!1;if(t.contains)return t.contains(e);for(var n=e;n;){if(n===t)return!0;n=n.parentNode}return!1}var NW="data-rc-order",FW="data-rc-priority",xP="rc-util-key",f2=new Map;function IX(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.mark;return e?e.startsWith("data-")?e:"data-".concat(e):xP}function uv(t){if(t.attachTo)return t.attachTo;var e=document.querySelector("head");return e||document.body}function RP(t){return t==="queue"?"prependQueue":t?"prepend":"append"}function Ow(t){return Array.from((f2.get(t)||t).children).filter(function(e){return e.tagName==="STYLE"})}function CX(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!eo())return null;var n=e.csp,i=e.prepend,r=e.priority,o=r===void 0?0:r,a=RP(i),s=a==="prependQueue",l=document.createElement("style");l.setAttribute(NW,a),s&&o&&l.setAttribute(FW,"".concat(o)),n!=null&&n.nonce&&(l.nonce=n==null?void 0:n.nonce),l.innerHTML=t;var c=uv(e),g=c.firstChild;if(i){if(s){var u=(e.styles||Ow(c)).filter(function(d){if(!["prepend","prependQueue"].includes(d.getAttribute(NW)))return!1;var C=Number(d.getAttribute(FW)||0);return o>=C});if(u.length)return c.insertBefore(l,u[u.length-1].nextSibling),l}c.insertBefore(l,g)}else c.appendChild(l);return l}function hX(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=uv(e);return(e.styles||Ow(n)).find(function(i){return i.getAttribute(IX(e))===t})}function ch(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=hX(t,e);if(n){var i=uv(e);i.removeChild(n)}}function WP(t,e){var n=f2.get(t);if(!n||!h2(document,n)){var i=CX("",e),r=i.parentNode;f2.set(t,r),t.removeChild(i)}}function nl(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=uv(n),r=Ow(i),o=Re(Re({},n),{},{styles:r});WP(i,o);var a=hX(e,o);if(a){var s,l;if((s=o.csp)!==null&&s!==void 0&&s.nonce&&a.nonce!==((l=o.csp)===null||l===void 0?void 0:l.nonce)){var c;a.nonce=(c=o.csp)===null||c===void 0?void 0:c.nonce}return a.innerHTML!==t&&(a.innerHTML=t),a}var g=CX(t,o);return g.setAttribute(IX(o),e),g}function VP(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function An(t,e){if(t==null)return{};var n,i,r=VP(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function gh(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=new Set;function r(o,a){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,l=i.has(o);if(Fr(!l,"Warning: There may be circular references"),l)return!1;if(o===a)return!0;if(n&&s>1)return!1;i.add(o);var c=s+1;if(Array.isArray(o)){if(!Array.isArray(a)||o.length!==a.length)return!1;for(var g=0;g<o.length;g++)if(!r(o[g],a[g],c))return!1;return!0}if(o&&a&&qt(o)==="object"&&qt(a)==="object"){var u=Object.keys(o);return u.length!==Object.keys(a).length?!1:u.every(function(d){return r(o[d],a[d],c)})}return!1}return r(t,e)}var MP="%";function m2(t){return t.join(MP)}var NP=function(){function t(e){Ki(this,t),we(this,"instanceId",void 0),we(this,"cache",new Map),this.instanceId=e}return Li(t,[{key:"get",value:function(n){return this.opGet(m2(n))}},{key:"opGet",value:function(n){return this.cache.get(n)||null}},{key:"update",value:function(n,i){return this.opUpdate(m2(n),i)}},{key:"opUpdate",value:function(n,i){var r=this.cache.get(n),o=i(r);o===null?this.cache.delete(n):this.cache.set(n,o)}}]),t}(),Vd="data-token-hash",Ua="data-css-hash",Dl="__cssinjs_instance__";function FP(){var t=Math.random().toString(12).slice(2);if(typeof document<"u"&&document.head&&document.body){var e=document.body.querySelectorAll("style[".concat(Ua,"]"))||[],n=document.head.firstChild;Array.from(e).forEach(function(r){r[Dl]=r[Dl]||t,r[Dl]===t&&document.head.insertBefore(r,n)});var i={};Array.from(document.querySelectorAll("style[".concat(Ua,"]"))).forEach(function(r){var o=r.getAttribute(Ua);if(i[o]){if(r[Dl]===t){var a;(a=r.parentNode)===null||a===void 0||a.removeChild(r)}}else i[o]=!0})}return new NP(t)}var dv=y.createContext({hashPriority:"low",cache:FP(),defaultCache:!0});function HP(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}var Jw=function(){function t(){Ki(this,t),we(this,"cache",void 0),we(this,"keys",void 0),we(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return Li(t,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(n){var i,r,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a={map:this.cache};return n.forEach(function(s){if(!a)a=void 0;else{var l;a=(l=a)===null||l===void 0||(l=l.map)===null||l===void 0?void 0:l.get(s)}}),(i=a)!==null&&i!==void 0&&i.value&&o&&(a.value[1]=this.cacheCallTimes++),(r=a)===null||r===void 0?void 0:r.value}},{key:"get",value:function(n){var i;return(i=this.internalGet(n,!0))===null||i===void 0?void 0:i[0]}},{key:"has",value:function(n){return!!this.internalGet(n)}},{key:"set",value:function(n,i){var r=this;if(!this.has(n)){if(this.size()+1>t.MAX_CACHE_SIZE+t.MAX_CACHE_OFFSET){var o=this.keys.reduce(function(c,g){var u=De(c,2),d=u[1];return r.internalGet(g)[1]<d?[g,r.internalGet(g)[1]]:c},[this.keys[0],this.cacheCallTimes]),a=De(o,1),s=a[0];this.delete(s)}this.keys.push(n)}var l=this.cache;n.forEach(function(c,g){if(g===n.length-1)l.set(c,{value:[i,r.cacheCallTimes++]});else{var u=l.get(c);u?u.map||(u.map=new Map):l.set(c,{map:new Map}),l=l.get(c).map}})}},{key:"deleteByPath",value:function(n,i){var r=n.get(i[0]);if(i.length===1){var o;return r.map?n.set(i[0],{map:r.map}):n.delete(i[0]),(o=r.value)===null||o===void 0?void 0:o[0]}var a=this.deleteByPath(r.map,i.slice(1));return(!r.map||r.map.size===0)&&!r.value&&n.delete(i[0]),a}},{key:"delete",value:function(n){if(this.has(n))return this.keys=this.keys.filter(function(i){return!HP(i,n)}),this.deleteByPath(this.cache,n)}}]),t}();we(Jw,"MAX_CACHE_SIZE",20);we(Jw,"MAX_CACHE_OFFSET",5);var HW=0,fX=function(){function t(e){Ki(this,t),we(this,"derivatives",void 0),we(this,"id",void 0),this.derivatives=Array.isArray(e)?e:[e],this.id=HW,e.length===0&&(e.length>0,void 0),HW+=1}return Li(t,[{key:"getDerivativeToken",value:function(n){return this.derivatives.reduce(function(i,r){return r(n,i)},void 0)}}]),t}(),Vy=new Jw;function A2(t){var e=Array.isArray(t)?t:[t];return Vy.has(e)||Vy.set(e,new fX(e)),Vy.get(e)}var XP=new WeakMap,My={};function EP(t,e){for(var n=XP,i=0;i<e.length;i+=1){var r=e[i];n.has(r)||n.set(r,new WeakMap),n=n.get(r)}return n.has(My)||n.set(My,t()),n.get(My)}var XW=new WeakMap;function SC(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=XW.get(t)||"";return n||(Object.keys(t).forEach(function(i){var r=t[i];n+=i,r instanceof fX?n+=r.id:r&&qt(r)==="object"?n+=SC(r,e):n+=r}),e&&(n=lh(n)),XW.set(t,n)),n}function EW(t,e){return lh("".concat(e,"_").concat(SC(t,!0)))}var p2=eo();function Je(t){return typeof t=="number"?"".concat(t,"px"):t}function kp(t,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(r)return t;var o=Re(Re({},i),{},we(we({},Vd,e),Ua,n)),a=Object.keys(o).map(function(s){var l=o[s];return l?"".concat(s,'="').concat(l,'"'):null}).filter(function(s){return s}).join(" ");return"<style ".concat(a,">").concat(t,"</style>")}var ep=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return"--".concat(n?"".concat(n,"-"):"").concat(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z]+)([A-Z][a-z0-9]+)/g,"$1-$2").replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase()},YP=function(e,n,i){return Object.keys(e).length?".".concat(n).concat(i!=null&&i.scope?".".concat(i.scope):"","{").concat(Object.entries(e).map(function(r){var o=De(r,2),a=o[0],s=o[1];return"".concat(a,":").concat(s,";")}).join(""),"}"):""},mX=function(e,n,i){var r={},o={};return Object.entries(e).forEach(function(a){var s,l,c=De(a,2),g=c[0],u=c[1];if(i!=null&&(s=i.preserve)!==null&&s!==void 0&&s[g])o[g]=u;else if((typeof u=="string"||typeof u=="number")&&!(i!=null&&(l=i.ignore)!==null&&l!==void 0&&l[g])){var d,C=ep(g,i==null?void 0:i.prefix);r[C]=typeof u=="number"&&!(i!=null&&(d=i.unitless)!==null&&d!==void 0&&d[g])?"".concat(u,"px"):String(u),o[g]="var(".concat(C,")")}}),[o,YP(r,n,{scope:i==null?void 0:i.scope})]},YW=eo()?y.useLayoutEffect:y.useEffect,qn=function(e,n){var i=y.useRef(!0);YW(function(){return e(i.current)},n),YW(function(){return i.current=!1,function(){i.current=!0}},[])},v2=function(e,n){qn(function(i){if(!i)return e()},n)},zP=Re({},Y0),zW=zP.useInsertionEffect,KP=function(e,n,i){y.useMemo(e,i),qn(function(){return n(!0)},i)},LP=zW?function(t,e,n){return zW(function(){return t(),e()},n)}:KP,TP=Re({},Y0),_P=TP.useInsertionEffect,kP=function(e){var n=[],i=!1;function r(o){i||n.push(o)}return y.useEffect(function(){return i=!1,function(){i=!0,n.length&&n.forEach(function(o){return o()})}},e),r},PP=function(){return function(e){e()}},UP=typeof _P<"u"?kP:PP;function Qw(t,e,n,i,r){var o=y.useContext(dv),a=o.cache,s=[t].concat(Et(e)),l=m2(s),c=UP([l]),g=function(f){a.opUpdate(l,function(v){var p=v||[void 0,void 0],m=De(p,2),A=m[0],b=A===void 0?0:A,G=m[1],w=G,S=w||n(),Z=[b,S];return f?f(Z):Z})};y.useMemo(function(){g()},[l]);var u=a.opGet(l),d=u[1];return LP(function(){r==null||r(d)},function(C){return g(function(f){var v=De(f,2),p=v[0],m=v[1];return C&&p===0&&(r==null||r(d)),[p+1,m]}),function(){a.opUpdate(l,function(f){var v=f||[],p=De(v,2),m=p[0],A=m===void 0?0:m,b=p[1],G=A-1;return G===0?(c(function(){(C||!a.opGet(l))&&(i==null||i(b,!1))}),null):[A-1,b]})}},[l]),d}var DP={},OP="css",$c=new Map;function JP(t){$c.set(t,($c.get(t)||0)+1)}function QP(t,e){if(typeof document<"u"){var n=document.querySelectorAll("style[".concat(Vd,'="').concat(t,'"]'));n.forEach(function(i){if(i[Dl]===e){var r;(r=i.parentNode)===null||r===void 0||r.removeChild(i)}})}}var jP=0;function $P(t,e){$c.set(t,($c.get(t)||0)-1);var n=Array.from($c.keys()),i=n.filter(function(r){var o=$c.get(r)||0;return o<=0});n.length-i.length>jP&&i.forEach(function(r){QP(r,e),$c.delete(r)})}var qP=function(e,n,i,r){var o=i.getDerivativeToken(e),a=Re(Re({},o),n);return r&&(a=r(a)),a},AX="token";function eU(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=y.useContext(dv),r=i.cache.instanceId,o=i.container,a=n.salt,s=a===void 0?"":a,l=n.override,c=l===void 0?DP:l,g=n.formatToken,u=n.getComputedToken,d=n.cssVar,C=EP(function(){return Object.assign.apply(Object,[{}].concat(Et(e)))},e),f=SC(C),v=SC(c),p=d?SC(d):"",m=Qw(AX,[s,t.id,f,v,p],function(){var A,b=u?u(C,c,t):qP(C,c,t,g),G=Re({},b),w="";if(d){var S=mX(b,d.key,{prefix:d.prefix,ignore:d.ignore,unitless:d.unitless,preserve:d.preserve}),Z=De(S,2);b=Z[0],w=Z[1]}var x=EW(b,s);b._tokenKey=x,G._tokenKey=EW(G,s);var R=(A=d==null?void 0:d.key)!==null&&A!==void 0?A:x;b._themeKey=R,JP(R);var W="".concat(OP,"-").concat(lh(x));return b._hashId=W,[b,W,G,w,(d==null?void 0:d.key)||""]},function(A){$P(A[0]._themeKey,r)},function(A){var b=De(A,4),G=b[0],w=b[3];if(d&&w){var S=nl(w,lh("css-variables-".concat(G._themeKey)),{mark:Ua,prepend:"queue",attachTo:o,priority:-999});S[Dl]=r,S.setAttribute(Vd,G._themeKey)}});return m}var tU=function(e,n,i){var r=De(e,5),o=r[2],a=r[3],s=r[4],l=i||{},c=l.plain;if(!a)return null;var g=o._tokenKey,u=-999,d={"data-rc-order":"prependQueue","data-rc-priority":"".concat(u)},C=kp(a,s,g,d,c);return[u,g,C]},nU={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},pX="comm",vX="rule",bX="decl",iU="@import",rU="@keyframes",oU="@layer",yX=Math.abs,jw=String.fromCharCode;function GX(t){return t.trim()}function tp(t,e,n){return t.replace(e,n)}function aU(t,e,n){return t.indexOf(e,n)}function uh(t,e){return t.charCodeAt(e)|0}function Md(t,e,n){return t.slice(e,n)}function Cs(t){return t.length}function sU(t){return t.length}function Sm(t,e){return e.push(t),t}var Iv=1,Nd=1,BX=0,Aa=0,Hi=0,Qd="";function $w(t,e,n,i,r,o,a,s){return{value:t,root:e,parent:n,type:i,props:r,children:o,line:Iv,column:Nd,length:a,return:"",siblings:s}}function lU(){return Hi}function cU(){return Hi=Aa>0?uh(Qd,--Aa):0,Nd--,Hi===10&&(Nd=1,Iv--),Hi}function Da(){return Hi=Aa<BX?uh(Qd,Aa++):0,Nd++,Hi===10&&(Nd=1,Iv++),Hi}function Ol(){return uh(Qd,Aa)}function np(){return Aa}function Cv(t,e){return Md(Qd,t,e)}function dh(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function gU(t){return Iv=Nd=1,BX=Cs(Qd=t),Aa=0,[]}function uU(t){return Qd="",t}function Ny(t){return GX(Cv(Aa-1,b2(t===91?t+2:t===40?t+1:t)))}function dU(t){for(;(Hi=Ol())&&Hi<33;)Da();return dh(t)>2||dh(Hi)>3?"":" "}function IU(t,e){for(;--e&&Da()&&!(Hi<48||Hi>102||Hi>57&&Hi<65||Hi>70&&Hi<97););return Cv(t,np()+(e<6&&Ol()==32&&Da()==32))}function b2(t){for(;Da();)switch(Hi){case t:return Aa;case 34:case 39:t!==34&&t!==39&&b2(Hi);break;case 40:t===41&&b2(t);break;case 92:Da();break}return Aa}function CU(t,e){for(;Da()&&t+Hi!==57;)if(t+Hi===84&&Ol()===47)break;return"/*"+Cv(e,Aa-1)+"*"+jw(t===47?t:Da())}function hU(t){for(;!dh(Ol());)Da();return Cv(t,Aa)}function fU(t){return uU(ip("",null,null,null,[""],t=gU(t),0,[0],t))}function ip(t,e,n,i,r,o,a,s,l){for(var c=0,g=0,u=a,d=0,C=0,f=0,v=1,p=1,m=1,A=0,b="",G=r,w=o,S=i,Z=b;p;)switch(f=A,A=Da()){case 40:if(f!=108&&uh(Z,u-1)==58){aU(Z+=tp(Ny(A),"&","&\f"),"&\f",yX(c?s[c-1]:0))!=-1&&(m=-1);break}case 34:case 39:case 91:Z+=Ny(A);break;case 9:case 10:case 13:case 32:Z+=dU(f);break;case 92:Z+=IU(np()-1,7);continue;case 47:switch(Ol()){case 42:case 47:Sm(mU(CU(Da(),np()),e,n,l),l),(dh(f||1)==5||dh(Ol()||1)==5)&&Cs(Z)&&Md(Z,-1,void 0)!==" "&&(Z+=" ");break;default:Z+="/"}break;case 123*v:s[c++]=Cs(Z)*m;case 125*v:case 59:case 0:switch(A){case 0:case 125:p=0;case 59+g:m==-1&&(Z=tp(Z,/\f/g,"")),C>0&&(Cs(Z)-u||v===0&&f===47)&&Sm(C>32?LW(Z+";",i,n,u-1,l):LW(tp(Z," ","")+";",i,n,u-2,l),l);break;case 59:Z+=";";default:if(Sm(S=KW(Z,e,n,c,g,r,s,b,G=[],w=[],u,o),o),A===123)if(g===0)ip(Z,e,S,S,G,o,u,s,w);else switch(d===99&&uh(Z,3)===110?100:d){case 100:case 108:case 109:case 115:ip(t,S,S,i&&Sm(KW(t,S,S,0,0,r,s,b,r,G=[],u,w),w),r,w,u,s,i?G:w);break;default:ip(Z,S,S,S,[""],w,0,s,w)}}c=g=C=0,v=m=1,b=Z="",u=a;break;case 58:u=1+Cs(Z),C=f;default:if(v<1){if(A==123)--v;else if(A==125&&v++==0&&cU()==125)continue}switch(Z+=jw(A),A*v){case 38:m=g>0?1:(Z+="\f",-1);break;case 44:s[c++]=(Cs(Z)-1)*m,m=1;break;case 64:Ol()===45&&(Z+=Ny(Da())),d=Ol(),g=u=Cs(b=Z+=hU(np())),A++;break;case 45:f===45&&Cs(Z)==2&&(v=0)}}return o}function KW(t,e,n,i,r,o,a,s,l,c,g,u){for(var d=r-1,C=r===0?o:[""],f=sU(C),v=0,p=0,m=0;v<i;++v)for(var A=0,b=Md(t,d+1,d=yX(p=a[v])),G=t;A<f;++A)(G=GX(p>0?C[A]+" "+b:tp(b,/&\f/g,C[A])))&&(l[m++]=G);return $w(t,e,n,r===0?vX:s,l,c,g,u)}function mU(t,e,n,i){return $w(t,e,n,pX,jw(lU()),Md(t,2,-2),0,i)}function LW(t,e,n,i,r){return $w(t,e,n,bX,Md(t,0,i),Md(t,i+1,-1),i,r)}function y2(t,e){for(var n="",i=0;i<t.length;i++)n+=e(t[i],i,t,e)||"";return n}function AU(t,e,n,i){switch(t.type){case oU:if(t.children.length)break;case iU:case bX:return t.return=t.return||t.value;case pX:return"";case rU:return t.return=t.value+"{"+y2(t.children,i)+"}";case vX:if(!Cs(t.value=t.props.join(",")))return""}return Cs(n=y2(t.children,i))?t.return=t.value+"{"+n+"}":""}var TW="data-ant-cssinjs-cache-path",SX="_FILE_STYLE__",mg,wX=!0;function pU(){if(!mg&&(mg={},eo())){var t=document.createElement("div");t.className=TW,t.style.position="fixed",t.style.visibility="hidden",t.style.top="-9999px",document.body.appendChild(t);var e=getComputedStyle(t).content||"";e=e.replace(/^"/,"").replace(/"$/,""),e.split(";").forEach(function(r){var o=r.split(":"),a=De(o,2),s=a[0],l=a[1];mg[s]=l});var n=document.querySelector("style[".concat(TW,"]"));if(n){var i;wX=!1,(i=n.parentNode)===null||i===void 0||i.removeChild(n)}document.body.removeChild(t)}}function vU(t){return pU(),!!mg[t]}function bU(t){var e=mg[t],n=null;if(e&&eo())if(wX)n=SX;else{var i=document.querySelector("style[".concat(Ua,'="').concat(mg[t],'"]'));i?n=i.innerHTML:delete mg[t]}return[n,e]}var yU="_skip_check_",ZX="_multi_value_";function rp(t){var e=y2(fU(t),AU);return e.replace(/\{%%%\:[^;];}/g,";")}function GU(t){return qt(t)==="object"&&t&&(yU in t||ZX in t)}function _W(t,e,n){if(!e)return t;var i=".".concat(e),r=n==="low"?":where(".concat(i,")"):i,o=t.split(",").map(function(a){var s,l=a.trim().split(/\s+/),c=l[0]||"",g=((s=c.match(/^\w+/))===null||s===void 0?void 0:s[0])||"";return c="".concat(g).concat(r).concat(c.slice(g.length)),[c].concat(Et(l.slice(1))).join(" ")});return o.join(",")}var BU=function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{root:!0,parentSelectors:[]},r=i.root,o=i.injectHash,a=i.parentSelectors,s=n.hashId,l=n.layer;n.path;var c=n.hashPriority,g=n.transformers,u=g===void 0?[]:g;n.linters;var d="",C={};function f(m){var A=m.getName(s);if(!C[A]){var b=t(m.style,n,{root:!1,parentSelectors:a}),G=De(b,1),w=G[0];C[A]="@keyframes ".concat(m.getName(s)).concat(w)}}function v(m){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return m.forEach(function(b){Array.isArray(b)?v(b,A):b&&A.push(b)}),A}var p=v(Array.isArray(e)?e:[e]);return p.forEach(function(m){var A=typeof m=="string"&&!r?{}:m;if(typeof A=="string")d+="".concat(A,`
`);else if(A._keyframe)f(A);else{var b=u.reduce(function(G,w){var S;return(w==null||(S=w.visit)===null||S===void 0?void 0:S.call(w,G))||G},A);Object.keys(b).forEach(function(G){var w=b[G];if(qt(w)==="object"&&w&&(G!=="animationName"||!w._keyframe)&&!GU(w)){var S=!1,Z=G.trim(),x=!1;(r||o)&&s?Z.startsWith("@")?S=!0:Z==="&"?Z=_W("",s,c):Z=_W(G,s,c):r&&!s&&(Z==="&"||Z==="")&&(Z="",x=!0);var R=t(w,n,{root:x,injectHash:S,parentSelectors:[].concat(Et(a),[Z])}),W=De(R,2),M=W[0],N=W[1];C=Re(Re({},C),N),d+="".concat(Z).concat(M)}else{let Q=function(k,J){var F=k.replace(/[A-Z]/g,function(z){return"-".concat(z.toLowerCase())}),L=J;!nU[k]&&typeof L=="number"&&L!==0&&(L="".concat(L,"px")),k==="animationName"&&J!==null&&J!==void 0&&J._keyframe&&(f(J),L=J.getName(s)),d+="".concat(F,":").concat(L,";")};var X,E=(X=w==null?void 0:w.value)!==null&&X!==void 0?X:w;qt(w)==="object"&&w!==null&&w!==void 0&&w[ZX]&&Array.isArray(E)?E.forEach(function(k){Q(G,k)}):Q(G,E)}})}}),r?l&&(d="@layer ".concat(l.name," {").concat(d,"}"),l.dependencies&&(C["@layer ".concat(l.name)]=l.dependencies.map(function(m){return"@layer ".concat(m,", ").concat(l.name,";")}).join(`
`))):d="{".concat(d,"}"),[d,C]};function xX(t,e){return lh("".concat(t.join("%")).concat(e))}function SU(){return null}var RX="style";function G2(t,e){var n=t.token,i=t.path,r=t.hashId,o=t.layer,a=t.nonce,s=t.clientOnly,l=t.order,c=l===void 0?0:l,g=y.useContext(dv),u=g.autoClear;g.mock;var d=g.defaultCache,C=g.hashPriority,f=g.container,v=g.ssrInline,p=g.transformers,m=g.linters,A=g.cache,b=g.layer,G=n._tokenKey,w=[G];b&&w.push("layer"),w.push.apply(w,Et(i));var S=p2,Z=Qw(RX,w,function(){var N=w.join("|");if(vU(N)){var X=bU(N),E=De(X,2),Q=E[0],k=E[1];if(Q)return[Q,G,k,{},s,c]}var J=e(),F=BU(J,{hashId:r,hashPriority:C,layer:b?o:void 0,path:i.join("-"),transformers:p,linters:m}),L=De(F,2),z=L[0],K=L[1],O=rp(z),j=xX(w,O);return[O,G,j,K,s,c]},function(N,X){var E=De(N,3),Q=E[2];(X||u)&&p2&&ch(Q,{mark:Ua})},function(N){var X=De(N,4),E=X[0];X[1];var Q=X[2],k=X[3];if(S&&E!==SX){var J={mark:Ua,prepend:b?!1:"queue",attachTo:f,priority:c},F=typeof a=="function"?a():a;F&&(J.csp={nonce:F});var L=[],z=[];Object.keys(k).forEach(function(O){O.startsWith("@layer")?L.push(O):z.push(O)}),L.forEach(function(O){nl(rp(k[O]),"_layer-".concat(O),Re(Re({},J),{},{prepend:!0}))});var K=nl(E,Q,J);K[Dl]=A.instanceId,K.setAttribute(Vd,G),z.forEach(function(O){nl(rp(k[O]),"_effect-".concat(O),J)})}}),x=De(Z,3),R=x[0],W=x[1],M=x[2];return function(N){var X;return!v||S||!d?X=y.createElement(SU,null):X=y.createElement("style",Zt({},we(we({},Vd,W),Ua,M),{dangerouslySetInnerHTML:{__html:R}})),y.createElement(y.Fragment,null,X,N)}}var wU=function(e,n,i){var r=De(e,6),o=r[0],a=r[1],s=r[2],l=r[3],c=r[4],g=r[5],u=i||{},d=u.plain;if(c)return null;var C=o,f={"data-rc-order":"prependQueue","data-rc-priority":"".concat(g)};return C=kp(o,a,s,f,d),l&&Object.keys(l).forEach(function(v){if(!n[v]){n[v]=!0;var p=rp(l[v]),m=kp(p,a,"_effect-".concat(v),f,d);v.startsWith("@layer")?C=m+C:C+=m}}),[g,s,C]},WX="cssVar",ZU=function(e,n){var i=e.key,r=e.prefix,o=e.unitless,a=e.ignore,s=e.token,l=e.scope,c=l===void 0?"":l,g=y.useContext(dv),u=g.cache.instanceId,d=g.container,C=s._tokenKey,f=[].concat(Et(e.path),[i,c,C]),v=Qw(WX,f,function(){var p=n(),m=mX(p,i,{prefix:r,unitless:o,ignore:a,scope:c}),A=De(m,2),b=A[0],G=A[1],w=xX(f,G);return[b,G,w,i]},function(p){var m=De(p,3),A=m[2];p2&&ch(A,{mark:Ua})},function(p){var m=De(p,3),A=m[1],b=m[2];if(A){var G=nl(A,b,{mark:Ua,prepend:"queue",attachTo:d,priority:-999});G[Dl]=u,G.setAttribute(Vd,i)}});return v},xU=function(e,n,i){var r=De(e,4),o=r[1],a=r[2],s=r[3],l=i||{},c=l.plain;if(!o)return null;var g=-999,u={"data-rc-order":"prependQueue","data-rc-priority":"".concat(g)},d=kp(o,s,a,u,c);return[g,a,d]};we(we(we({},RX,wU),AX,tU),WX,xU);var Fn=function(){function t(e,n){Ki(this,t),we(this,"name",void 0),we(this,"style",void 0),we(this,"_keyframe",!0),this.name=e,this.style=n}return Li(t,[{key:"getName",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return n?"".concat(n,"-").concat(this.name):this.name}}]),t}();function lu(t){return t.notSplit=!0,t}lu(["borderTop","borderBottom"]),lu(["borderTop"]),lu(["borderBottom"]),lu(["borderLeft","borderRight"]),lu(["borderLeft"]),lu(["borderRight"]);var qw=y.createContext({});function VX(t){return uX(t)||sX(t)||Uw(t)||dX()}function fs(t,e){for(var n=t,i=0;i<e.length;i+=1){if(n==null)return;n=n[e[i]]}return n}function MX(t,e,n,i){if(!e.length)return n;var r=VX(e),o=r[0],a=r.slice(1),s;return!t&&typeof o=="number"?s=[]:Array.isArray(t)?s=Et(t):s=Re({},t),i&&n===void 0&&a.length===1?delete s[o][a[0]]:s[o]=MX(s[o],a,n,i),s}function za(t,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return e.length&&i&&n===void 0&&!fs(t,e.slice(0,-1))?t:MX(t,e,n,i)}function RU(t){return qt(t)==="object"&&t!==null&&Object.getPrototypeOf(t)===Object.prototype}function kW(t){return Array.isArray(t)?[]:{}}var WU=typeof Reflect>"u"?Object.keys:Reflect.ownKeys;function td(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=kW(e[0]);return e.forEach(function(r){function o(a,s){var l=new Set(s),c=fs(r,a),g=Array.isArray(c);if(g||RU(c)){if(!l.has(c)){l.add(c);var u=fs(i,a);g?i=za(i,a,[]):(!u||qt(u)!=="object")&&(i=za(i,a,kW(c))),WU(c).forEach(function(d){o([].concat(Et(a),[d]),l)})}}else i=za(i,a,c)}o([])}),i}const VU=y.createContext({}),MU=y.createContext(void 0);var NX={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"},NU={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0},FU=Re(Re({},NU),{},{locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",dateFormat:"M/D/YYYY",dateTimeFormat:"M/D/YYYY HH:mm:ss",previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"});const FX={placeholder:"Select time",rangePlaceholder:["Start time","End time"]},PW={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},FU),timePickerLocale:Object.assign({},FX)},Vo="${label} is not a valid ${type}",Wg={locale:"en",Pagination:NX,DatePicker:PW,TimePicker:FX,Calendar:PW,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",deselectAll:"Deselect all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand",collapse:"Collapse"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:Vo,method:Vo,array:Vo,object:Vo,number:Vo,date:Vo,boolean:Vo,integer:Vo,float:Vo,regexp:Vo,email:Vo,url:Vo,hex:Vo},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh",scanned:"Scanned"},ColorPicker:{presetEmpty:"Empty",transparent:"Transparent",singleColor:"Single",gradientColor:"Gradient"}};let op=Object.assign({},Wg.Modal),ap=[];const UW=()=>ap.reduce((t,e)=>Object.assign(Object.assign({},t),e),Wg.Modal);function HU(t){if(t){const e=Object.assign({},t);return ap.push(e),op=UW(),()=>{ap=ap.filter(n=>n!==e),op=UW()}}op=Object.assign({},Wg.Modal)}function HX(){return op}const eZ=y.createContext(void 0),Uh=(t,e)=>{const n=y.useContext(eZ),i=y.useMemo(()=>{var o;const a=e||Wg[t],s=(o=n==null?void 0:n[t])!==null&&o!==void 0?o:{};return Object.assign(Object.assign({},typeof a=="function"?a():a),s||{})},[t,e,n]),r=y.useMemo(()=>{const o=n==null?void 0:n.locale;return n!=null&&n.exist&&!o?Wg.locale:o},[n]);return[i,r]},XU="internalMark",EU=t=>{const{locale:e={},children:n,_ANT_MARK__:i}=t;y.useEffect(()=>HU(e==null?void 0:e.Modal),[e]);const r=y.useMemo(()=>Object.assign(Object.assign({},e),{exist:!0}),[e]);return y.createElement(eZ.Provider,{value:r},n)};function Ir(t,e){YU(t)&&(t="100%");var n=zU(t);return t=e===360?t:Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:(e===360?t=(t<0?t%e+e:t%e)/parseFloat(String(e)):t=t%e/parseFloat(String(e)),t)}function wm(t){return Math.min(1,Math.max(0,t))}function YU(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function zU(t){return typeof t=="string"&&t.indexOf("%")!==-1}function XX(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Zm(t){return t<=1?"".concat(Number(t)*100,"%"):t}function ag(t){return t.length===1?"0"+t:String(t)}function KU(t,e,n){return{r:Ir(t,255)*255,g:Ir(e,255)*255,b:Ir(n,255)*255}}function DW(t,e,n){t=Ir(t,255),e=Ir(e,255),n=Ir(n,255);var i=Math.max(t,e,n),r=Math.min(t,e,n),o=0,a=0,s=(i+r)/2;if(i===r)a=0,o=0;else{var l=i-r;switch(a=s>.5?l/(2-i-r):l/(i+r),i){case t:o=(e-n)/l+(e<n?6:0);break;case e:o=(n-t)/l+2;break;case n:o=(t-e)/l+4;break}o/=6}return{h:o,s:a,l:s}}function Fy(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*(6*n):n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function LU(t,e,n){var i,r,o;if(t=Ir(t,360),e=Ir(e,100),n=Ir(n,100),e===0)r=n,o=n,i=n;else{var a=n<.5?n*(1+e):n+e-n*e,s=2*n-a;i=Fy(s,a,t+1/3),r=Fy(s,a,t),o=Fy(s,a,t-1/3)}return{r:i*255,g:r*255,b:o*255}}function B2(t,e,n){t=Ir(t,255),e=Ir(e,255),n=Ir(n,255);var i=Math.max(t,e,n),r=Math.min(t,e,n),o=0,a=i,s=i-r,l=i===0?0:s/i;if(i===r)o=0;else{switch(i){case t:o=(e-n)/s+(e<n?6:0);break;case e:o=(n-t)/s+2;break;case n:o=(t-e)/s+4;break}o/=6}return{h:o,s:l,v:a}}function TU(t,e,n){t=Ir(t,360)*6,e=Ir(e,100),n=Ir(n,100);var i=Math.floor(t),r=t-i,o=n*(1-e),a=n*(1-r*e),s=n*(1-(1-r)*e),l=i%6,c=[n,a,o,o,s,n][l],g=[s,n,n,a,o,o][l],u=[o,o,s,n,n,a][l];return{r:c*255,g:g*255,b:u*255}}function S2(t,e,n,i){var r=[ag(Math.round(t).toString(16)),ag(Math.round(e).toString(16)),ag(Math.round(n).toString(16))];return i&&r[0].startsWith(r[0].charAt(1))&&r[1].startsWith(r[1].charAt(1))&&r[2].startsWith(r[2].charAt(1))?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function _U(t,e,n,i,r){var o=[ag(Math.round(t).toString(16)),ag(Math.round(e).toString(16)),ag(Math.round(n).toString(16)),ag(kU(i))];return r&&o[0].startsWith(o[0].charAt(1))&&o[1].startsWith(o[1].charAt(1))&&o[2].startsWith(o[2].charAt(1))&&o[3].startsWith(o[3].charAt(1))?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}function kU(t){return Math.round(parseFloat(t)*255).toString(16)}function OW(t){return Xo(t)/255}function Xo(t){return parseInt(t,16)}function PU(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}var w2={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function zu(t){var e={r:0,g:0,b:0},n=1,i=null,r=null,o=null,a=!1,s=!1;return typeof t=="string"&&(t=OU(t)),typeof t=="object"&&(Es(t.r)&&Es(t.g)&&Es(t.b)?(e=KU(t.r,t.g,t.b),a=!0,s=String(t.r).substr(-1)==="%"?"prgb":"rgb"):Es(t.h)&&Es(t.s)&&Es(t.v)?(i=Zm(t.s),r=Zm(t.v),e=TU(t.h,i,r),a=!0,s="hsv"):Es(t.h)&&Es(t.s)&&Es(t.l)&&(i=Zm(t.s),o=Zm(t.l),e=LU(t.h,i,o),a=!0,s="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(n=t.a)),n=XX(n),{ok:a,format:t.format||s,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}var UU="[-\\+]?\\d+%?",DU="[-\\+]?\\d*\\.\\d+%?",Jl="(?:".concat(DU,")|(?:").concat(UU,")"),Hy="[\\s|\\(]+(".concat(Jl,")[,|\\s]+(").concat(Jl,")[,|\\s]+(").concat(Jl,")\\s*\\)?"),Xy="[\\s|\\(]+(".concat(Jl,")[,|\\s]+(").concat(Jl,")[,|\\s]+(").concat(Jl,")[,|\\s]+(").concat(Jl,")\\s*\\)?"),Ha={CSS_UNIT:new RegExp(Jl),rgb:new RegExp("rgb"+Hy),rgba:new RegExp("rgba"+Xy),hsl:new RegExp("hsl"+Hy),hsla:new RegExp("hsla"+Xy),hsv:new RegExp("hsv"+Hy),hsva:new RegExp("hsva"+Xy),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function OU(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;var e=!1;if(w2[t])t=w2[t],e=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n=Ha.rgb.exec(t);return n?{r:n[1],g:n[2],b:n[3]}:(n=Ha.rgba.exec(t),n?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=Ha.hsl.exec(t),n?{h:n[1],s:n[2],l:n[3]}:(n=Ha.hsla.exec(t),n?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=Ha.hsv.exec(t),n?{h:n[1],s:n[2],v:n[3]}:(n=Ha.hsva.exec(t),n?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=Ha.hex8.exec(t),n?{r:Xo(n[1]),g:Xo(n[2]),b:Xo(n[3]),a:OW(n[4]),format:e?"name":"hex8"}:(n=Ha.hex6.exec(t),n?{r:Xo(n[1]),g:Xo(n[2]),b:Xo(n[3]),format:e?"name":"hex"}:(n=Ha.hex4.exec(t),n?{r:Xo(n[1]+n[1]),g:Xo(n[2]+n[2]),b:Xo(n[3]+n[3]),a:OW(n[4]+n[4]),format:e?"name":"hex8"}:(n=Ha.hex3.exec(t),n?{r:Xo(n[1]+n[1]),g:Xo(n[2]+n[2]),b:Xo(n[3]+n[3]),format:e?"name":"hex"}:!1)))))))))}function Es(t){return!!Ha.CSS_UNIT.exec(String(t))}var Pi=function(){function t(e,n){e===void 0&&(e=""),n===void 0&&(n={});var i;if(e instanceof t)return e;typeof e=="number"&&(e=PU(e)),this.originalInput=e;var r=zu(e);this.originalInput=e,this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this.roundA=Math.round(100*this.a)/100,this.format=(i=n.format)!==null&&i!==void 0?i:r.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=r.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},t.prototype.getLuminance=function(){var e=this.toRgb(),n,i,r,o=e.r/255,a=e.g/255,s=e.b/255;return o<=.03928?n=o/12.92:n=Math.pow((o+.055)/1.055,2.4),a<=.03928?i=a/12.92:i=Math.pow((a+.055)/1.055,2.4),s<=.03928?r=s/12.92:r=Math.pow((s+.055)/1.055,2.4),.2126*n+.7152*i+.0722*r},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(e){return this.a=XX(e),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){var e=this.toHsl().s;return e===0},t.prototype.toHsv=function(){var e=B2(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}},t.prototype.toHsvString=function(){var e=B2(this.r,this.g,this.b),n=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.v*100);return this.a===1?"hsv(".concat(n,", ").concat(i,"%, ").concat(r,"%)"):"hsva(".concat(n,", ").concat(i,"%, ").concat(r,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var e=DW(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}},t.prototype.toHslString=function(){var e=DW(this.r,this.g,this.b),n=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.l*100);return this.a===1?"hsl(".concat(n,", ").concat(i,"%, ").concat(r,"%)"):"hsla(".concat(n,", ").concat(i,"%, ").concat(r,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(e){return e===void 0&&(e=!1),S2(this.r,this.g,this.b,e)},t.prototype.toHexString=function(e){return e===void 0&&(e=!1),"#"+this.toHex(e)},t.prototype.toHex8=function(e){return e===void 0&&(e=!1),_U(this.r,this.g,this.b,this.a,e)},t.prototype.toHex8String=function(e){return e===void 0&&(e=!1),"#"+this.toHex8(e)},t.prototype.toHexShortString=function(e){return e===void 0&&(e=!1),this.a===1?this.toHexString(e):this.toHex8String(e)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var e=Math.round(this.r),n=Math.round(this.g),i=Math.round(this.b);return this.a===1?"rgb(".concat(e,", ").concat(n,", ").concat(i,")"):"rgba(".concat(e,", ").concat(n,", ").concat(i,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var e=function(n){return"".concat(Math.round(Ir(n,255)*100),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var e=function(n){return Math.round(Ir(n,255)*100)};return this.a===1?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var e="#"+S2(this.r,this.g,this.b,!1),n=0,i=Object.entries(w2);n<i.length;n++){var r=i[n],o=r[0],a=r[1];if(e===a)return o}return!1},t.prototype.toString=function(e){var n=!!e;e=e??this.format;var i=!1,r=this.a<1&&this.a>=0,o=!n&&r&&(e.startsWith("hex")||e==="name");return o?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(i=this.toRgbString()),e==="prgb"&&(i=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(i=this.toHexString()),e==="hex3"&&(i=this.toHexString(!0)),e==="hex4"&&(i=this.toHex8String(!0)),e==="hex8"&&(i=this.toHex8String()),e==="name"&&(i=this.toName()),e==="hsl"&&(i=this.toHslString()),e==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.l+=e/100,n.l=wm(n.l),new t(n)},t.prototype.brighten=function(e){e===void 0&&(e=10);var n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),new t(n)},t.prototype.darken=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.l-=e/100,n.l=wm(n.l),new t(n)},t.prototype.tint=function(e){return e===void 0&&(e=10),this.mix("white",e)},t.prototype.shade=function(e){return e===void 0&&(e=10),this.mix("black",e)},t.prototype.desaturate=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.s-=e/100,n.s=wm(n.s),new t(n)},t.prototype.saturate=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.s+=e/100,n.s=wm(n.s),new t(n)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(e){var n=this.toHsl(),i=(n.h+e)%360;return n.h=i<0?360+i:i,new t(n)},t.prototype.mix=function(e,n){n===void 0&&(n=50);var i=this.toRgb(),r=new t(e).toRgb(),o=n/100,a={r:(r.r-i.r)*o+i.r,g:(r.g-i.g)*o+i.g,b:(r.b-i.b)*o+i.b,a:(r.a-i.a)*o+i.a};return new t(a)},t.prototype.analogous=function(e,n){e===void 0&&(e=6),n===void 0&&(n=30);var i=this.toHsl(),r=360/n,o=[this];for(i.h=(i.h-(r*e>>1)+720)%360;--e;)i.h=(i.h+r)%360,o.push(new t(i));return o},t.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new t(e)},t.prototype.monochromatic=function(e){e===void 0&&(e=6);for(var n=this.toHsv(),i=n.h,r=n.s,o=n.v,a=[],s=1/e;e--;)a.push(new t({h:i,s:r,v:o})),o=(o+s)%1;return a},t.prototype.splitcomplement=function(){var e=this.toHsl(),n=e.h;return[this,new t({h:(n+72)%360,s:e.s,l:e.l}),new t({h:(n+216)%360,s:e.s,l:e.l})]},t.prototype.onBackground=function(e){var n=this.toRgb(),i=new t(e).toRgb(),r=n.a+i.a*(1-n.a);return new t({r:(n.r*n.a+i.r*i.a*(1-n.a))/r,g:(n.g*n.a+i.g*i.a*(1-n.a))/r,b:(n.b*n.a+i.b*i.a*(1-n.a))/r,a:r})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(e){for(var n=this.toHsl(),i=n.h,r=[this],o=360/e,a=1;a<e;a++)r.push(new t({h:(i+a*o)%360,s:n.s,l:n.l}));return r},t.prototype.equals=function(e){return this.toRgbString()===new t(e).toRgbString()},t}(),xm=2,JW=.16,JU=.05,QU=.05,jU=.15,EX=5,YX=4,$U=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function QW(t){var e=t.r,n=t.g,i=t.b,r=B2(e,n,i);return{h:r.h*360,s:r.s,v:r.v}}function Rm(t){var e=t.r,n=t.g,i=t.b;return"#".concat(S2(e,n,i,!1))}function qU(t,e,n){var i=n/100,r={r:(e.r-t.r)*i+t.r,g:(e.g-t.g)*i+t.g,b:(e.b-t.b)*i+t.b};return r}function jW(t,e,n){var i;return Math.round(t.h)>=60&&Math.round(t.h)<=240?i=n?Math.round(t.h)-xm*e:Math.round(t.h)+xm*e:i=n?Math.round(t.h)+xm*e:Math.round(t.h)-xm*e,i<0?i+=360:i>=360&&(i-=360),i}function $W(t,e,n){if(t.h===0&&t.s===0)return t.s;var i;return n?i=t.s-JW*e:e===YX?i=t.s+JW:i=t.s+JU*e,i>1&&(i=1),n&&e===EX&&i>.1&&(i=.1),i<.06&&(i=.06),Number(i.toFixed(2))}function qW(t,e,n){var i;return n?i=t.v+QU*e:i=t.v-jU*e,i>1&&(i=1),Number(i.toFixed(2))}function Ih(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[],i=zu(t),r=EX;r>0;r-=1){var o=QW(i),a=Rm(zu({h:jW(o,r,!0),s:$W(o,r,!0),v:qW(o,r,!0)}));n.push(a)}n.push(Rm(i));for(var s=1;s<=YX;s+=1){var l=QW(i),c=Rm(zu({h:jW(l,s),s:$W(l,s),v:qW(l,s)}));n.push(c)}return e.theme==="dark"?$U.map(function(g){var u=g.index,d=g.opacity,C=Rm(qU(zu(e.backgroundColor||"#141414"),zu(n[u]),d*100));return C}):n}var Ey={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},Z2=["#fff1f0","#ffccc7","#ffa39e","#ff7875","#ff4d4f","#f5222d","#cf1322","#a8071a","#820014","#5c0011"];Z2.primary=Z2[5];var x2=["#fff2e8","#ffd8bf","#ffbb96","#ff9c6e","#ff7a45","#fa541c","#d4380d","#ad2102","#871400","#610b00"];x2.primary=x2[5];var R2=["#fff7e6","#ffe7ba","#ffd591","#ffc069","#ffa940","#fa8c16","#d46b08","#ad4e00","#873800","#612500"];R2.primary=R2[5];var W2=["#fffbe6","#fff1b8","#ffe58f","#ffd666","#ffc53d","#faad14","#d48806","#ad6800","#874d00","#613400"];W2.primary=W2[5];var V2=["#feffe6","#ffffb8","#fffb8f","#fff566","#ffec3d","#fadb14","#d4b106","#ad8b00","#876800","#614700"];V2.primary=V2[5];var M2=["#fcffe6","#f4ffb8","#eaff8f","#d3f261","#bae637","#a0d911","#7cb305","#5b8c00","#3f6600","#254000"];M2.primary=M2[5];var N2=["#f6ffed","#d9f7be","#b7eb8f","#95de64","#73d13d","#52c41a","#389e0d","#237804","#135200","#092b00"];N2.primary=N2[5];var F2=["#e6fffb","#b5f5ec","#87e8de","#5cdbd3","#36cfc9","#13c2c2","#08979c","#006d75","#00474f","#002329"];F2.primary=F2[5];var Pp=["#e6f4ff","#bae0ff","#91caff","#69b1ff","#4096ff","#1677ff","#0958d9","#003eb3","#002c8c","#001d66"];Pp.primary=Pp[5];var H2=["#f0f5ff","#d6e4ff","#adc6ff","#85a5ff","#597ef7","#2f54eb","#1d39c4","#10239e","#061178","#030852"];H2.primary=H2[5];var X2=["#f9f0ff","#efdbff","#d3adf7","#b37feb","#9254de","#722ed1","#531dab","#391085","#22075e","#120338"];X2.primary=X2[5];var E2=["#fff0f6","#ffd6e7","#ffadd2","#ff85c0","#f759ab","#eb2f96","#c41d7f","#9e1068","#780650","#520339"];E2.primary=E2[5];var Y2=["#a6a6a6","#999999","#8c8c8c","#808080","#737373","#666666","#404040","#1a1a1a","#000000","#000000"];Y2.primary=Y2[5];var Yy={red:Z2,volcano:x2,orange:R2,gold:W2,yellow:V2,lime:M2,green:N2,cyan:F2,blue:Pp,geekblue:H2,purple:X2,magenta:E2,grey:Y2};const zX={blue:"#1677FF",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#EB2F96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},Ch=Object.assign(Object.assign({},zX),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0});function eD(t,e){let{generateColorPalettes:n,generateNeutralColorPalettes:i}=e;const{colorSuccess:r,colorWarning:o,colorError:a,colorInfo:s,colorPrimary:l,colorBgBase:c,colorTextBase:g}=t,u=n(l),d=n(r),C=n(o),f=n(a),v=n(s),p=i(c,g),m=t.colorLink||t.colorInfo,A=n(m),b=new Pi(f[1]).mix(new Pi(f[3]),50).toHexString();return Object.assign(Object.assign({},p),{colorPrimaryBg:u[1],colorPrimaryBgHover:u[2],colorPrimaryBorder:u[3],colorPrimaryBorderHover:u[4],colorPrimaryHover:u[5],colorPrimary:u[6],colorPrimaryActive:u[7],colorPrimaryTextHover:u[8],colorPrimaryText:u[9],colorPrimaryTextActive:u[10],colorSuccessBg:d[1],colorSuccessBgHover:d[2],colorSuccessBorder:d[3],colorSuccessBorderHover:d[4],colorSuccessHover:d[4],colorSuccess:d[6],colorSuccessActive:d[7],colorSuccessTextHover:d[8],colorSuccessText:d[9],colorSuccessTextActive:d[10],colorErrorBg:f[1],colorErrorBgHover:f[2],colorErrorBgFilledHover:b,colorErrorBgActive:f[3],colorErrorBorder:f[3],colorErrorBorderHover:f[4],colorErrorHover:f[5],colorError:f[6],colorErrorActive:f[7],colorErrorTextHover:f[8],colorErrorText:f[9],colorErrorTextActive:f[10],colorWarningBg:C[1],colorWarningBgHover:C[2],colorWarningBorder:C[3],colorWarningBorderHover:C[4],colorWarningHover:C[4],colorWarning:C[6],colorWarningActive:C[7],colorWarningTextHover:C[8],colorWarningText:C[9],colorWarningTextActive:C[10],colorInfoBg:v[1],colorInfoBgHover:v[2],colorInfoBorder:v[3],colorInfoBorderHover:v[4],colorInfoHover:v[4],colorInfo:v[6],colorInfoActive:v[7],colorInfoTextHover:v[8],colorInfoText:v[9],colorInfoTextActive:v[10],colorLinkHover:A[4],colorLink:A[6],colorLinkActive:A[7],colorBgMask:new Pi("#000").setAlpha(.45).toRgbString(),colorWhite:"#fff"})}const tD=t=>{let e=t,n=t,i=t,r=t;return t<6&&t>=5?e=t+1:t<16&&t>=6?e=t+2:t>=16&&(e=16),t<7&&t>=5?n=4:t<8&&t>=7?n=5:t<14&&t>=8?n=6:t<16&&t>=14?n=7:t>=16&&(n=8),t<6&&t>=2?i=1:t>=6&&(i=2),t>4&&t<8?r=4:t>=8&&(r=6),{borderRadius:t,borderRadiusXS:i,borderRadiusSM:n,borderRadiusLG:e,borderRadiusOuter:r}};function nD(t){const{motionUnit:e,motionBase:n,borderRadius:i,lineWidth:r}=t;return Object.assign({motionDurationFast:`${(n+e).toFixed(1)}s`,motionDurationMid:`${(n+e*2).toFixed(1)}s`,motionDurationSlow:`${(n+e*3).toFixed(1)}s`,lineWidthBold:r+1},tD(i))}const iD=t=>{const{controlHeight:e}=t;return{controlHeightSM:e*.75,controlHeightXS:e*.5,controlHeightLG:e*1.25}};function sp(t){return(t+8)/t}function rD(t){const e=new Array(10).fill(null).map((n,i)=>{const r=i-1,o=t*Math.pow(Math.E,r/5),a=i>1?Math.floor(o):Math.ceil(o);return Math.floor(a/2)*2});return e[1]=t,e.map(n=>({size:n,lineHeight:sp(n)}))}const oD=t=>{const e=rD(t),n=e.map(g=>g.size),i=e.map(g=>g.lineHeight),r=n[1],o=n[0],a=n[2],s=i[1],l=i[0],c=i[2];return{fontSizeSM:o,fontSize:r,fontSizeLG:a,fontSizeXL:n[3],fontSizeHeading1:n[6],fontSizeHeading2:n[5],fontSizeHeading3:n[4],fontSizeHeading4:n[3],fontSizeHeading5:n[2],lineHeight:s,lineHeightLG:c,lineHeightSM:l,fontHeight:Math.round(s*r),fontHeightLG:Math.round(c*a),fontHeightSM:Math.round(l*o),lineHeightHeading1:i[6],lineHeightHeading2:i[5],lineHeightHeading3:i[4],lineHeightHeading4:i[3],lineHeightHeading5:i[2]}};function aD(t){const{sizeUnit:e,sizeStep:n}=t;return{sizeXXL:e*(n+8),sizeXL:e*(n+4),sizeLG:e*(n+2),sizeMD:e*(n+1),sizeMS:e*n,size:e*n,sizeSM:e*(n-1),sizeXS:e*(n-2),sizeXXS:e*(n-3)}}const sa=(t,e)=>new Pi(t).setAlpha(e).toRgbString(),VI=(t,e)=>new Pi(t).darken(e).toHexString(),sD=t=>{const e=Ih(t);return{1:e[0],2:e[1],3:e[2],4:e[3],5:e[4],6:e[5],7:e[6],8:e[4],9:e[5],10:e[6]}},lD=(t,e)=>{const n=t||"#fff",i=e||"#000";return{colorBgBase:n,colorTextBase:i,colorText:sa(i,.88),colorTextSecondary:sa(i,.65),colorTextTertiary:sa(i,.45),colorTextQuaternary:sa(i,.25),colorFill:sa(i,.15),colorFillSecondary:sa(i,.06),colorFillTertiary:sa(i,.04),colorFillQuaternary:sa(i,.02),colorBgSolid:sa(i,1),colorBgSolidHover:sa(i,.75),colorBgSolidActive:sa(i,.95),colorBgLayout:VI(n,4),colorBgContainer:VI(n,0),colorBgElevated:VI(n,0),colorBgSpotlight:sa(i,.85),colorBgBlur:"transparent",colorBorder:VI(n,15),colorBorderSecondary:VI(n,6)}};function cD(t){Ey.pink=Ey.magenta,Yy.pink=Yy.magenta;const e=Object.keys(zX).map(n=>{const i=t[n]===Ey[n]?Yy[n]:Ih(t[n]);return new Array(10).fill(1).reduce((r,o,a)=>(r[`${n}-${a+1}`]=i[a],r[`${n}${a+1}`]=i[a],r),{})}).reduce((n,i)=>(n=Object.assign(Object.assign({},n),i),n),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t),e),eD(t,{generateColorPalettes:sD,generateNeutralColorPalettes:lD})),oD(t.fontSize)),aD(t)),iD(t)),nD(t))}const KX=A2(cD),z2={token:Ch,override:{override:Ch},hashed:!0},LX=ze.createContext(z2),Up="ant",tZ="anticon",gD=["outlined","borderless","filled"],uD=(t,e)=>e||(t?`${Up}-${t}`:Up),yn=y.createContext({getPrefixCls:uD,iconPrefixCls:tZ}),dD=`-ant-${Date.now()}-${Math.random()}`;function ID(t,e){const n={},i=(a,s)=>{let l=a.clone();return l=(s==null?void 0:s(l))||l,l.toRgbString()},r=(a,s)=>{const l=new Pi(a),c=Ih(l.toRgbString());n[`${s}-color`]=i(l),n[`${s}-color-disabled`]=c[1],n[`${s}-color-hover`]=c[4],n[`${s}-color-active`]=c[6],n[`${s}-color-outline`]=l.clone().setAlpha(.2).toRgbString(),n[`${s}-color-deprecated-bg`]=c[0],n[`${s}-color-deprecated-border`]=c[2]};if(e.primaryColor){r(e.primaryColor,"primary");const a=new Pi(e.primaryColor),s=Ih(a.toRgbString());s.forEach((c,g)=>{n[`primary-${g+1}`]=c}),n["primary-color-deprecated-l-35"]=i(a,c=>c.lighten(35)),n["primary-color-deprecated-l-20"]=i(a,c=>c.lighten(20)),n["primary-color-deprecated-t-20"]=i(a,c=>c.tint(20)),n["primary-color-deprecated-t-50"]=i(a,c=>c.tint(50)),n["primary-color-deprecated-f-12"]=i(a,c=>c.setAlpha(c.getAlpha()*.12));const l=new Pi(s[0]);n["primary-color-active-deprecated-f-30"]=i(l,c=>c.setAlpha(c.getAlpha()*.3)),n["primary-color-active-deprecated-d-02"]=i(l,c=>c.darken(2))}return e.successColor&&r(e.successColor,"success"),e.warningColor&&r(e.warningColor,"warning"),e.errorColor&&r(e.errorColor,"error"),e.infoColor&&r(e.infoColor,"info"),`
  :root {
    ${Object.keys(n).map(a=>`--${t}-${a}: ${n[a]};`).join(`
`)}
  }
  `.trim()}function CD(t,e){const n=ID(t,e);eo()&&nl(n,`${dD}-dynamic-theme`)}const lc=y.createContext(!1),TX=t=>{let{children:e,disabled:n}=t;const i=y.useContext(lc);return y.createElement(lc.Provider,{value:n??i},e)},Fd=y.createContext(void 0),hD=t=>{let{children:e,size:n}=t;const i=y.useContext(Fd);return y.createElement(Fd.Provider,{value:n||i},e)};function fD(){const t=y.useContext(lc),e=y.useContext(Fd);return{componentDisabled:t,componentSize:e}}var _X=Li(function t(){Ki(this,t)}),kX="CALC_UNIT",mD=new RegExp(kX,"g");function zy(t){return typeof t=="number"?"".concat(t).concat(kX):t}var AD=function(t){dl(n,t);var e=Il(n);function n(i,r){var o;Ki(this,n),o=e.call(this),we(Zn(o),"result",""),we(Zn(o),"unitlessCssVar",void 0),we(Zn(o),"lowPriority",void 0);var a=qt(i);return o.unitlessCssVar=r,i instanceof n?o.result="(".concat(i.result,")"):a==="number"?o.result=zy(i):a==="string"&&(o.result=i),o}return Li(n,[{key:"add",value:function(r){return r instanceof n?this.result="".concat(this.result," + ").concat(r.getResult()):(typeof r=="number"||typeof r=="string")&&(this.result="".concat(this.result," + ").concat(zy(r))),this.lowPriority=!0,this}},{key:"sub",value:function(r){return r instanceof n?this.result="".concat(this.result," - ").concat(r.getResult()):(typeof r=="number"||typeof r=="string")&&(this.result="".concat(this.result," - ").concat(zy(r))),this.lowPriority=!0,this}},{key:"mul",value:function(r){return this.lowPriority&&(this.result="(".concat(this.result,")")),r instanceof n?this.result="".concat(this.result," * ").concat(r.getResult(!0)):(typeof r=="number"||typeof r=="string")&&(this.result="".concat(this.result," * ").concat(r)),this.lowPriority=!1,this}},{key:"div",value:function(r){return this.lowPriority&&(this.result="(".concat(this.result,")")),r instanceof n?this.result="".concat(this.result," / ").concat(r.getResult(!0)):(typeof r=="number"||typeof r=="string")&&(this.result="".concat(this.result," / ").concat(r)),this.lowPriority=!1,this}},{key:"getResult",value:function(r){return this.lowPriority||r?"(".concat(this.result,")"):this.result}},{key:"equal",value:function(r){var o=this,a=r||{},s=a.unit,l=!0;return typeof s=="boolean"?l=s:Array.from(this.unitlessCssVar).some(function(c){return o.result.includes(c)})&&(l=!1),this.result=this.result.replace(mD,l?"px":""),typeof this.lowPriority<"u"?"calc(".concat(this.result,")"):this.result}}]),n}(_X),pD=function(t){dl(n,t);var e=Il(n);function n(i){var r;return Ki(this,n),r=e.call(this),we(Zn(r),"result",0),i instanceof n?r.result=i.result:typeof i=="number"&&(r.result=i),r}return Li(n,[{key:"add",value:function(r){return r instanceof n?this.result+=r.result:typeof r=="number"&&(this.result+=r),this}},{key:"sub",value:function(r){return r instanceof n?this.result-=r.result:typeof r=="number"&&(this.result-=r),this}},{key:"mul",value:function(r){return r instanceof n?this.result*=r.result:typeof r=="number"&&(this.result*=r),this}},{key:"div",value:function(r){return r instanceof n?this.result/=r.result:typeof r=="number"&&(this.result/=r),this}},{key:"equal",value:function(){return this.result}}]),n}(_X),vD=function(e,n){var i=e==="css"?AD:pD;return function(r){return new i(r,n)}},eV=function(e,n){return"".concat([n,e.replace(/([A-Z]+)([A-Z][a-z]+)/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2")].filter(Boolean).join("-"))};function Xi(t){var e=y.useRef();e.current=t;var n=y.useCallback(function(){for(var i,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(i=e.current)===null||i===void 0?void 0:i.call.apply(i,[e].concat(o))},[]);return n}function Hd(t){var e=y.useRef(!1),n=y.useState(t),i=De(n,2),r=i[0],o=i[1];y.useEffect(function(){return e.current=!1,function(){e.current=!0}},[]);function a(s,l){l&&e.current||o(s)}return[r,a]}function Ky(t){return t!==void 0}function $r(t,e){var n=e||{},i=n.defaultValue,r=n.value,o=n.onChange,a=n.postState,s=Hd(function(){return Ky(r)?r:Ky(i)?typeof i=="function"?i():i:typeof t=="function"?t():t}),l=De(s,2),c=l[0],g=l[1],u=r!==void 0?r:c,d=a?a(u):u,C=Xi(o),f=Hd([u]),v=De(f,2),p=v[0],m=v[1];v2(function(){var b=p[0];c!==b&&C(c,b)},[p]),v2(function(){Ky(r)||g(r)},[r]);var A=Xi(function(b,G){g(b,G),m([u],G)});return[d,A]}function tV(t,e,n,i){var r=Re({},e[t]);if(i!=null&&i.deprecatedTokens){var o=i.deprecatedTokens;o.forEach(function(s){var l=De(s,2),c=l[0],g=l[1];if(r!=null&&r[c]||r!=null&&r[g]){var u;(u=r[g])!==null&&u!==void 0||(r[g]=r==null?void 0:r[c])}})}var a=Re(Re({},n),r);return Object.keys(a).forEach(function(s){a[s]===e[s]&&delete a[s]}),a}var PX=typeof CSSINJS_STATISTIC<"u",K2=!0;function ci(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(!PX)return Object.assign.apply(Object,[{}].concat(e));K2=!1;var i={};return e.forEach(function(r){if(qt(r)==="object"){var o=Object.keys(r);o.forEach(function(a){Object.defineProperty(i,a,{configurable:!0,enumerable:!0,get:function(){return r[a]}})})}}),K2=!0,i}var nV={};function bD(){}var yD=function(e){var n,i=e,r=bD;return PX&&typeof Proxy<"u"&&(n=new Set,i=new Proxy(e,{get:function(a,s){if(K2){var l;(l=n)===null||l===void 0||l.add(s)}return a[s]}}),r=function(a,s){var l;nV[a]={global:Array.from(n),component:Re(Re({},(l=nV[a])===null||l===void 0?void 0:l.component),s)}}),{token:i,keys:n,flush:r}};function iV(t,e,n){if(typeof n=="function"){var i;return n(ci(e,(i=e[t])!==null&&i!==void 0?i:{}))}return n??{}}function GD(t){return t==="js"?{max:Math.max,min:Math.min}:{max:function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return"max(".concat(i.map(function(o){return Je(o)}).join(","),")")},min:function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return"min(".concat(i.map(function(o){return Je(o)}).join(","),")")}}}var BD=1e3*60*10,SD=function(){function t(){Ki(this,t),we(this,"map",new Map),we(this,"objectIDMap",new WeakMap),we(this,"nextID",0),we(this,"lastAccessBeat",new Map),we(this,"accessBeat",0)}return Li(t,[{key:"set",value:function(n,i){this.clear();var r=this.getCompositeKey(n);this.map.set(r,i),this.lastAccessBeat.set(r,Date.now())}},{key:"get",value:function(n){var i=this.getCompositeKey(n),r=this.map.get(i);return this.lastAccessBeat.set(i,Date.now()),this.accessBeat+=1,r}},{key:"getCompositeKey",value:function(n){var i=this,r=n.map(function(o){return o&&qt(o)==="object"?"obj_".concat(i.getObjectID(o)):"".concat(qt(o),"_").concat(o)});return r.join("|")}},{key:"getObjectID",value:function(n){if(this.objectIDMap.has(n))return this.objectIDMap.get(n);var i=this.nextID;return this.objectIDMap.set(n,i),this.nextID+=1,i}},{key:"clear",value:function(){var n=this;if(this.accessBeat>1e4){var i=Date.now();this.lastAccessBeat.forEach(function(r,o){i-r>BD&&(n.map.delete(o),n.lastAccessBeat.delete(o))}),this.accessBeat=0}}}]),t}(),rV=new SD;function wD(t,e){return ze.useMemo(function(){var n=rV.get(e);if(n)return n;var i=t();return rV.set(e,i),i},e)}var ZD=function(){return{}};function xD(t){var e=t.useCSP,n=e===void 0?ZD:e,i=t.useToken,r=t.usePrefix,o=t.getResetStyles,a=t.getCommonStyle,s=t.getCompUnitless;function l(d,C,f,v){var p=Array.isArray(d)?d[0]:d;function m(x){return"".concat(String(p)).concat(x.slice(0,1).toUpperCase()).concat(x.slice(1))}var A=(v==null?void 0:v.unitless)||{},b=typeof s=="function"?s(d):{},G=Re(Re({},b),{},we({},m("zIndexPopup"),!0));Object.keys(A).forEach(function(x){G[m(x)]=A[x]});var w=Re(Re({},v),{},{unitless:G,prefixToken:m}),S=g(d,C,f,w),Z=c(p,f,w);return function(x){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:x,W=S(x,R),M=De(W,2),N=M[1],X=Z(R),E=De(X,2),Q=E[0],k=E[1];return[Q,N,k]}}function c(d,C,f){var v=f.unitless,p=f.injectStyle,m=p===void 0?!0:p,A=f.prefixToken,b=f.ignore,G=function(Z){var x=Z.rootCls,R=Z.cssVar,W=R===void 0?{}:R,M=i(),N=M.realToken;return ZU({path:[d],prefix:W.prefix,key:W.key,unitless:v,ignore:b,token:N,scope:x},function(){var X=iV(d,N,C),E=tV(d,N,X,{deprecatedTokens:f==null?void 0:f.deprecatedTokens});return Object.keys(X).forEach(function(Q){E[A(Q)]=E[Q],delete E[Q]}),E}),null},w=function(Z){var x=i(),R=x.cssVar;return[function(W){return m&&R?ze.createElement(ze.Fragment,null,ze.createElement(G,{rootCls:Z,cssVar:R,component:d}),W):W},R==null?void 0:R.key]};return w}function g(d,C,f){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},p=Array.isArray(d)?d:[d,d],m=De(p,1),A=m[0],b=p.join("-"),G=t.layer||{name:"antd"};return function(w){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w,Z=i(),x=Z.theme,R=Z.realToken,W=Z.hashId,M=Z.token,N=Z.cssVar,X=r(),E=X.rootPrefixCls,Q=X.iconPrefixCls,k=n(),J=N?"css":"js",F=wD(function(){var P=new Set;return N&&Object.keys(v.unitless||{}).forEach(function($){P.add(ep($,N.prefix)),P.add(ep($,eV(A,N.prefix)))}),vD(J,P)},[J,A,N==null?void 0:N.prefix]),L=GD(J),z=L.max,K=L.min,O={theme:x,token:M,hashId:W,nonce:function(){return k.nonce},clientOnly:v.clientOnly,layer:G,order:v.order||-999};G2(Re(Re({},O),{},{clientOnly:!1,path:["Shared",E]}),function(){return typeof o=="function"?o(M):[]});var j=G2(Re(Re({},O),{},{path:[b,w,Q]}),function(){if(v.injectStyle===!1)return[];var P=yD(M),$=P.token,oe=P.flush,ie=iV(A,R,f),de=".".concat(w),Ve=tV(A,R,ie,{deprecatedTokens:v.deprecatedTokens});N&&ie&&qt(ie)==="object"&&Object.keys(ie).forEach(function(Ge){ie[Ge]="var(".concat(ep(Ge,eV(A,N.prefix)),")")});var Se=ci($,{componentCls:de,prefixCls:w,iconCls:".".concat(Q),antCls:".".concat(E),calc:F,max:z,min:K},N?ie:Ve),me=C(Se,{hashId:W,prefixCls:w,rootPrefixCls:E,iconPrefixCls:Q});oe(A,Ve);var T=typeof a=="function"?a(Se,w,S,v.resetFont):null;return[v.resetStyle===!1?null:T,me]});return[j,W]}}function u(d,C,f){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},p=g(d,C,f,Re({resetStyle:!1,order:-998},v)),m=function(b){var G=b.prefixCls,w=b.rootCls,S=w===void 0?G:w;return p(G,S),null};return m}return{genStyleHooks:l,genSubStyleComponent:u,genComponentStyleHook:g}}const RD="5.21.3";function Ly(t){return t>=0&&t<=255}function Wm(t,e){const{r:n,g:i,b:r,a:o}=new Pi(t).toRgb();if(o<1)return t;const{r:a,g:s,b:l}=new Pi(e).toRgb();for(let c=.01;c<=1;c+=.01){const g=Math.round((n-a*(1-c))/c),u=Math.round((i-s*(1-c))/c),d=Math.round((r-l*(1-c))/c);if(Ly(g)&&Ly(u)&&Ly(d))return new Pi({r:g,g:u,b:d,a:Math.round(c*100)/100}).toRgbString()}return new Pi({r:n,g:i,b:r,a:1}).toRgbString()}var WD=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function UX(t){const{override:e}=t,n=WD(t,["override"]),i=Object.assign({},e);Object.keys(Ch).forEach(d=>{delete i[d]});const r=Object.assign(Object.assign({},n),i),o=480,a=576,s=768,l=992,c=1200,g=1600;if(r.motion===!1){const d="0s";r.motionDurationFast=d,r.motionDurationMid=d,r.motionDurationSlow=d}return Object.assign(Object.assign(Object.assign({},r),{colorFillContent:r.colorFillSecondary,colorFillContentHover:r.colorFill,colorFillAlter:r.colorFillQuaternary,colorBgContainerDisabled:r.colorFillTertiary,colorBorderBg:r.colorBgContainer,colorSplit:Wm(r.colorBorderSecondary,r.colorBgContainer),colorTextPlaceholder:r.colorTextQuaternary,colorTextDisabled:r.colorTextQuaternary,colorTextHeading:r.colorText,colorTextLabel:r.colorTextSecondary,colorTextDescription:r.colorTextTertiary,colorTextLightSolid:r.colorWhite,colorHighlight:r.colorError,colorBgTextHover:r.colorFillSecondary,colorBgTextActive:r.colorFill,colorIcon:r.colorTextTertiary,colorIconHover:r.colorText,colorErrorOutline:Wm(r.colorErrorBg,r.colorBgContainer),colorWarningOutline:Wm(r.colorWarningBg,r.colorBgContainer),fontSizeIcon:r.fontSizeSM,lineWidthFocus:r.lineWidth*3,lineWidth:r.lineWidth,controlOutlineWidth:r.lineWidth*2,controlInteractiveSize:r.controlHeight/2,controlItemBgHover:r.colorFillTertiary,controlItemBgActive:r.colorPrimaryBg,controlItemBgActiveHover:r.colorPrimaryBgHover,controlItemBgActiveDisabled:r.colorFill,controlTmpOutline:r.colorFillQuaternary,controlOutline:Wm(r.colorPrimaryBg,r.colorBgContainer),lineType:r.lineType,borderRadius:r.borderRadius,borderRadiusXS:r.borderRadiusXS,borderRadiusSM:r.borderRadiusSM,borderRadiusLG:r.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:r.sizeXXS,paddingXS:r.sizeXS,paddingSM:r.sizeSM,padding:r.size,paddingMD:r.sizeMD,paddingLG:r.sizeLG,paddingXL:r.sizeXL,paddingContentHorizontalLG:r.sizeLG,paddingContentVerticalLG:r.sizeMS,paddingContentHorizontal:r.sizeMS,paddingContentVertical:r.sizeSM,paddingContentHorizontalSM:r.size,paddingContentVerticalSM:r.sizeXS,marginXXS:r.sizeXXS,marginXS:r.sizeXS,marginSM:r.sizeSM,margin:r.size,marginMD:r.sizeMD,marginLG:r.sizeLG,marginXL:r.sizeXL,marginXXL:r.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:o,screenXSMin:o,screenXSMax:a-1,screenSM:a,screenSMMin:a,screenSMMax:s-1,screenMD:s,screenMDMin:s,screenMDMax:l-1,screenLG:l,screenLGMin:l,screenLGMax:c-1,screenXL:c,screenXLMin:c,screenXLMax:g-1,screenXXL:g,screenXXLMin:g,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new Pi("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new Pi("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new Pi("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),i)}var oV=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const DX={lineHeight:!0,lineHeightSM:!0,lineHeightLG:!0,lineHeightHeading1:!0,lineHeightHeading2:!0,lineHeightHeading3:!0,lineHeightHeading4:!0,lineHeightHeading5:!0,opacityLoading:!0,fontWeightStrong:!0,zIndexPopupBase:!0,zIndexBase:!0,opacityImage:!0},VD={size:!0,sizeSM:!0,sizeLG:!0,sizeMD:!0,sizeXS:!0,sizeXXS:!0,sizeMS:!0,sizeXL:!0,sizeXXL:!0,sizeUnit:!0,sizeStep:!0,motionBase:!0,motionUnit:!0},MD={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},OX=(t,e,n)=>{const i=n.getDerivativeToken(t),{override:r}=e,o=oV(e,["override"]);let a=Object.assign(Object.assign({},i),{override:r});return a=UX(a),o&&Object.entries(o).forEach(s=>{let[l,c]=s;const{theme:g}=c,u=oV(c,["theme"]);let d=u;g&&(d=OX(Object.assign(Object.assign({},a),u),{override:u},g)),a[l]=d}),a};function Qo(){const{token:t,hashed:e,theme:n,override:i,cssVar:r}=ze.useContext(LX),o=`${RD}-${e||""}`,a=n||KX,[s,l,c]=eU(a,[Ch,t],{salt:o,override:i,getComputedToken:OX,formatToken:UX,cssVar:r&&{prefix:r.prefix,key:r.key,unitless:DX,ignore:VD,preserve:MD}});return[a,c,e?l:"",s,r]}const Xd={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},ba=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return{boxSizing:"border-box",margin:0,padding:0,color:t.colorText,fontSize:t.fontSize,lineHeight:t.lineHeight,listStyle:"none",fontFamily:e?"inherit":t.fontFamily}},nZ=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),jd=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}}),ND=t=>({a:{color:t.colorLink,textDecoration:t.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${t.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:t.colorLinkHover},"&:active":{color:t.colorLinkActive},"&:active, &:hover":{textDecoration:t.linkHoverDecoration,outline:0},"&:focus":{textDecoration:t.linkFocusDecoration,outline:0},"&[disabled]":{color:t.colorTextDisabled,cursor:"not-allowed"}}}),FD=(t,e,n,i)=>{const r=`[class^="${e}"], [class*=" ${e}"]`,o=n?`.${n}`:r,a={boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}};let s={};return i!==!1&&(s={fontFamily:t.fontFamily,fontSize:t.fontSize}),{[o]:Object.assign(Object.assign(Object.assign({},s),a),{[r]:a})}},L2=t=>({outline:`${Je(t.lineWidthFocus)} solid ${t.colorPrimaryBorder}`,outlineOffset:1,transition:"outline-offset 0s, outline 0s"}),Dh=t=>({"&:focus-visible":Object.assign({},L2(t))}),JX=(t,e)=>{const[n,i]=Qo();return G2({theme:n,token:i,hashId:"",path:["ant-design-icons",t],nonce:()=>e==null?void 0:e.nonce,layer:{name:"antd"}},()=>[{[`.${t}`]:Object.assign(Object.assign({},nZ()),{[`.${t} .${t}-icon`]:{display:"block"}})}])},{genStyleHooks:yo,genComponentStyleHook:HD,genSubStyleComponent:iZ}=xD({usePrefix:()=>{const{getPrefixCls:t,iconPrefixCls:e}=y.useContext(yn);return{rootPrefixCls:t(),iconPrefixCls:e}},useToken:()=>{const[t,e,n,i,r]=Qo();return{theme:t,realToken:e,hashId:n,token:i,cssVar:r}},useCSP:()=>{const{csp:t,iconPrefixCls:e}=y.useContext(yn);return JX(e,t),t??{}},getResetStyles:t=>[{"&":ND(t)}],getCommonStyle:FD,getCompUnitless:()=>DX}),XD=Object.assign({},Y0),{useId:aV}=XD,ED=()=>"",YD=typeof aV>"u"?ED:aV;function zD(t,e,n){var i;const r=t||{},o=r.inherit===!1||!e?Object.assign(Object.assign({},z2),{hashed:(i=e==null?void 0:e.hashed)!==null&&i!==void 0?i:z2.hashed,cssVar:e==null?void 0:e.cssVar}):e,a=YD();return Ph(()=>{var s,l;if(!t)return e;const c=Object.assign({},o.components);Object.keys(t.components||{}).forEach(d=>{c[d]=Object.assign(Object.assign({},c[d]),t.components[d])});const g=`css-var-${a.replace(/:/g,"")}`,u=((s=r.cssVar)!==null&&s!==void 0?s:o.cssVar)&&Object.assign(Object.assign(Object.assign({prefix:n==null?void 0:n.prefixCls},typeof o.cssVar=="object"?o.cssVar:{}),typeof r.cssVar=="object"?r.cssVar:{}),{key:typeof r.cssVar=="object"&&((l=r.cssVar)===null||l===void 0?void 0:l.key)||g});return Object.assign(Object.assign(Object.assign({},o),r),{token:Object.assign(Object.assign({},o.token),r.token),components:c,cssVar:u})},[r,o],(s,l)=>s.some((c,g)=>{const u=l[g];return!gh(c,u,!0)}))}var KD=["children"],QX=y.createContext({});function LD(t){var e=t.children,n=An(t,KD);return y.createElement(QX.Provider,{value:n},e)}var TD=function(t){dl(n,t);var e=Il(n);function n(){return Ki(this,n),e.apply(this,arguments)}return Li(n,[{key:"render",value:function(){return this.props.children}}]),n}(y.Component);function _D(t){var e=y.useReducer(function(s){return s+1},0),n=De(e,2),i=n[1],r=y.useRef(t),o=Xi(function(){return r.current}),a=Xi(function(s){r.current=typeof s=="function"?s(r.current):s,i()});return[o,a]}var Xl="none",Vm="appear",Mm="enter",Nm="leave",sV="none",Ka="prepare",nd="start",id="active",rZ="end",jX="prepared";function lV(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit".concat(t)]="webkit".concat(e),n["Moz".concat(t)]="moz".concat(e),n["ms".concat(t)]="MS".concat(e),n["O".concat(t)]="o".concat(e.toLowerCase()),n}function kD(t,e){var n={animationend:lV("Animation","AnimationEnd"),transitionend:lV("Transition","TransitionEnd")};return t&&("AnimationEvent"in e||delete n.animationend.animation,"TransitionEvent"in e||delete n.transitionend.transition),n}var PD=kD(eo(),typeof window<"u"?window:{}),$X={};if(eo()){var UD=document.createElement("div");$X=UD.style}var Fm={};function qX(t){if(Fm[t])return Fm[t];var e=PD[t];if(e)for(var n=Object.keys(e),i=n.length,r=0;r<i;r+=1){var o=n[r];if(Object.prototype.hasOwnProperty.call(e,o)&&o in $X)return Fm[t]=e[o],Fm[t]}return""}var eE=qX("animationend"),tE=qX("transitionend"),nE=!!(eE&&tE),cV=eE||"animationend",gV=tE||"transitionend";function uV(t,e){if(!t)return null;if(qt(t)==="object"){var n=e.replace(/-\w/g,function(i){return i[1].toUpperCase()});return t[n]}return"".concat(t,"-").concat(e)}const DD=function(t){var e=y.useRef();function n(r){r&&(r.removeEventListener(gV,t),r.removeEventListener(cV,t))}function i(r){e.current&&e.current!==r&&n(e.current),r&&r!==e.current&&(r.addEventListener(gV,t),r.addEventListener(cV,t),e.current=r)}return y.useEffect(function(){return function(){n(e.current)}},[]),[i,n]};var iE=eo()?y.useLayoutEffect:y.useEffect;const OD=function(){var t=y.useRef(null);function e(){Ln.cancel(t.current)}function n(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;e();var o=Ln(function(){r<=1?i({isCanceled:function(){return o!==t.current}}):n(i,r-1)});t.current=o}return y.useEffect(function(){return function(){e()}},[]),[n,e]};var JD=[Ka,nd,id,rZ],QD=[Ka,jX],rE=!1,jD=!0;function oE(t){return t===id||t===rZ}const $D=function(t,e,n){var i=Hd(sV),r=De(i,2),o=r[0],a=r[1],s=OD(),l=De(s,2),c=l[0],g=l[1];function u(){a(Ka,!0)}var d=e?QD:JD;return iE(function(){if(o!==sV&&o!==rZ){var C=d.indexOf(o),f=d[C+1],v=n(o);v===rE?a(f,!0):f&&c(function(p){function m(){p.isCanceled()||a(f,!0)}v===!0?m():Promise.resolve(v).then(m)})}},[t,o]),y.useEffect(function(){return function(){g()}},[]),[u,o]};function qD(t,e,n,i){var r=i.motionEnter,o=r===void 0?!0:r,a=i.motionAppear,s=a===void 0?!0:a,l=i.motionLeave,c=l===void 0?!0:l,g=i.motionDeadline,u=i.motionLeaveImmediately,d=i.onAppearPrepare,C=i.onEnterPrepare,f=i.onLeavePrepare,v=i.onAppearStart,p=i.onEnterStart,m=i.onLeaveStart,A=i.onAppearActive,b=i.onEnterActive,G=i.onLeaveActive,w=i.onAppearEnd,S=i.onEnterEnd,Z=i.onLeaveEnd,x=i.onVisibleChanged,R=Hd(),W=De(R,2),M=W[0],N=W[1],X=_D(Xl),E=De(X,2),Q=E[0],k=E[1],J=Hd(null),F=De(J,2),L=F[0],z=F[1],K=Q(),O=y.useRef(!1),j=y.useRef(null);function P(){return n()}var $=y.useRef(!1);function oe(){k(Xl),z(null,!0)}var ie=Xi(function(q){var Y=Q();if(Y!==Xl){var Ce=P();if(!(q&&!q.deadline&&q.target!==Ce)){var se=$.current,fe;Y===Vm&&se?fe=w==null?void 0:w(Ce,q):Y===Mm&&se?fe=S==null?void 0:S(Ce,q):Y===Nm&&se&&(fe=Z==null?void 0:Z(Ce,q)),se&&fe!==!1&&oe()}}}),de=DD(ie),Ve=De(de,1),Se=Ve[0],me=function(Y){switch(Y){case Vm:return we(we(we({},Ka,d),nd,v),id,A);case Mm:return we(we(we({},Ka,C),nd,p),id,b);case Nm:return we(we(we({},Ka,f),nd,m),id,G);default:return{}}},T=y.useMemo(function(){return me(K)},[K]),Ge=$D(K,!t,function(q){if(q===Ka){var Y=T[Ka];return Y?Y(P()):rE}if(ae in T){var Ce;z(((Ce=T[ae])===null||Ce===void 0?void 0:Ce.call(T,P(),null))||null)}return ae===id&&K!==Xl&&(Se(P()),g>0&&(clearTimeout(j.current),j.current=setTimeout(function(){ie({deadline:!0})},g))),ae===jX&&oe(),jD}),ne=De(Ge,2),he=ne[0],ae=ne[1],He=oE(ae);$.current=He,iE(function(){N(e);var q=O.current;O.current=!0;var Y;!q&&e&&s&&(Y=Vm),q&&e&&o&&(Y=Mm),(q&&!e&&c||!q&&u&&!e&&c)&&(Y=Nm);var Ce=me(Y);Y&&(t||Ce[Ka])?(k(Y),he()):k(Xl)},[e]),y.useEffect(function(){(K===Vm&&!s||K===Mm&&!o||K===Nm&&!c)&&k(Xl)},[s,o,c]),y.useEffect(function(){return function(){O.current=!1,clearTimeout(j.current)}},[]);var ve=y.useRef(!1);y.useEffect(function(){M&&(ve.current=!0),M!==void 0&&K===Xl&&((ve.current||M)&&(x==null||x(M)),ve.current=!0)},[M,K]);var Me=L;return T[Ka]&&ae===nd&&(Me=Re({transition:"none"},Me)),[K,ae,Me,M??e]}function eO(t){var e=t;qt(t)==="object"&&(e=t.transitionSupport);function n(r,o){return!!(r.motionName&&e&&o!==!1)}var i=y.forwardRef(function(r,o){var a=r.visible,s=a===void 0?!0:a,l=r.removeOnLeave,c=l===void 0?!0:l,g=r.forceRender,u=r.children,d=r.motionName,C=r.leavedClassName,f=r.eventProps,v=y.useContext(QX),p=v.motion,m=n(r,p),A=y.useRef(),b=y.useRef();function G(){try{return A.current instanceof HTMLElement?A.current:BC(b.current)}catch{return null}}var w=qD(m,s,G,r),S=De(w,4),Z=S[0],x=S[1],R=S[2],W=S[3],M=y.useRef(W);W&&(M.current=!0);var N=y.useCallback(function(L){A.current=L,kw(o,L)},[o]),X,E=Re(Re({},f),{},{visible:s});if(!u)X=null;else if(Z===Xl)W?X=u(Re({},E),N):!c&&M.current&&C?X=u(Re(Re({},E),{},{className:C}),N):g||!c&&!C?X=u(Re(Re({},E),{},{style:{display:"none"}}),N):X=null;else{var Q;x===Ka?Q="prepare":oE(x)?Q="active":x===nd&&(Q="start");var k=uV(d,"".concat(Z,"-").concat(Q));X=u(Re(Re({},E),{},{className:qe(uV(d,Z),we(we({},k,k&&Q),d,typeof d=="string")),style:R}),N)}if(y.isValidElement(X)&&Kg(X)){var J=X,F=J.ref;F||(X=y.cloneElement(X,{ref:N}))}return y.createElement(TD,{ref:b},X)});return i.displayName="CSSMotion",i}const Cl=eO(nE);var T2="add",_2="keep",k2="remove",Ty="removed";function tO(t){var e;return t&&qt(t)==="object"&&"key"in t?e=t:e={key:t},Re(Re({},e),{},{key:String(e.key)})}function P2(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return t.map(tO)}function nO(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=[],i=0,r=e.length,o=P2(t),a=P2(e);o.forEach(function(c){for(var g=!1,u=i;u<r;u+=1){var d=a[u];if(d.key===c.key){i<u&&(n=n.concat(a.slice(i,u).map(function(C){return Re(Re({},C),{},{status:T2})})),i=u),n.push(Re(Re({},d),{},{status:_2})),i+=1,g=!0;break}}g||n.push(Re(Re({},c),{},{status:k2}))}),i<r&&(n=n.concat(a.slice(i).map(function(c){return Re(Re({},c),{},{status:T2})})));var s={};n.forEach(function(c){var g=c.key;s[g]=(s[g]||0)+1});var l=Object.keys(s).filter(function(c){return s[c]>1});return l.forEach(function(c){n=n.filter(function(g){var u=g.key,d=g.status;return u!==c||d!==k2}),n.forEach(function(g){g.key===c&&(g.status=_2)})}),n}var iO=["component","children","onVisibleChanged","onAllRemoved"],rO=["status"],oO=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function aO(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cl,n=function(i){dl(o,i);var r=Il(o);function o(){var a;Ki(this,o);for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];return a=r.call.apply(r,[this].concat(l)),we(Zn(a),"state",{keyEntities:[]}),we(Zn(a),"removeKey",function(g){a.setState(function(u){var d=u.keyEntities.map(function(C){return C.key!==g?C:Re(Re({},C),{},{status:Ty})});return{keyEntities:d}},function(){var u=a.state.keyEntities,d=u.filter(function(C){var f=C.status;return f!==Ty}).length;d===0&&a.props.onAllRemoved&&a.props.onAllRemoved()})}),a}return Li(o,[{key:"render",value:function(){var s=this,l=this.state.keyEntities,c=this.props,g=c.component,u=c.children,d=c.onVisibleChanged;c.onAllRemoved;var C=An(c,iO),f=g||y.Fragment,v={};return oO.forEach(function(p){v[p]=C[p],delete C[p]}),delete C.keys,y.createElement(f,C,l.map(function(p,m){var A=p.status,b=An(p,rO),G=A===T2||A===_2;return y.createElement(e,Zt({},v,{key:b.key,visible:G,eventProps:b,onVisibleChanged:function(S){d==null||d(S,{key:b.key}),S||s.removeKey(b.key)}}),function(w,S){return u(Re(Re({},w),{},{index:m}),S)})}))}}],[{key:"getDerivedStateFromProps",value:function(s,l){var c=s.keys,g=l.keyEntities,u=P2(c),d=nO(g,u);return{keyEntities:d.filter(function(C){var f=g.find(function(v){var p=v.key;return C.key===p});return!(f&&f.status===Ty&&C.status===k2)})}}}]),o}(y.Component);return we(n,"defaultProps",{component:"div"}),n}aO(nE);function sO(t){const{children:e}=t,[,n]=Qo(),{motion:i}=n,r=y.useRef(!1);return r.current=r.current||i===!1,r.current?y.createElement(LD,{motion:i},e):e}const lO=()=>null;var cO=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const gO=["getTargetContainer","getPopupContainer","renderEmpty","input","pagination","form","select","button"];let Dp,aE,sE,lE;function lp(){return Dp||Up}function uO(){return aE||tZ}function dO(t){return Object.keys(t).some(e=>e.endsWith("Color"))}const IO=t=>{const{prefixCls:e,iconPrefixCls:n,theme:i,holderRender:r}=t;e!==void 0&&(Dp=e),n!==void 0&&(aE=n),"holderRender"in t&&(lE=r),i&&(dO(i)?CD(lp(),i):sE=i)},CO=()=>({getPrefixCls:(t,e)=>e||(t?`${lp()}-${t}`:lp()),getIconPrefixCls:uO,getRootPrefixCls:()=>Dp||lp(),getTheme:()=>sE,holderRender:lE}),hO=t=>{const{children:e,csp:n,autoInsertSpaceInButton:i,alert:r,anchor:o,form:a,locale:s,componentSize:l,direction:c,space:g,splitter:u,virtual:d,dropdownMatchSelectWidth:C,popupMatchSelectWidth:f,popupOverflow:v,legacyLocale:p,parentContext:m,iconPrefixCls:A,theme:b,componentDisabled:G,segmented:w,statistic:S,spin:Z,calendar:x,carousel:R,cascader:W,collapse:M,typography:N,checkbox:X,descriptions:E,divider:Q,drawer:k,skeleton:J,steps:F,image:L,layout:z,list:K,mentions:O,modal:j,progress:P,result:$,slider:oe,breadcrumb:ie,menu:de,pagination:Ve,input:Se,textArea:me,empty:T,badge:Ge,radio:ne,rate:he,switch:ae,transfer:He,avatar:ve,message:Me,tag:q,table:Y,card:Ce,tabs:se,timeline:fe,timePicker:Ze,upload:Oe,notification:Fe,tree:Ee,colorPicker:Qe,datePicker:Ye,rangePicker:$e,flex:st,wave:Ue,dropdown:Ne,warning:je,tour:Ie,floatButtonGroup:Te,variant:ue,inputNumber:Pe,treeSelect:be}=t,Le=y.useCallback((ft,At)=>{const{prefixCls:Gt}=t;if(At)return At;const Bt=Gt||m.getPrefixCls("");return ft?`${Bt}-${ft}`:Bt},[m.getPrefixCls,t.prefixCls]),ct=A||m.iconPrefixCls||tZ,dt=n||m.csp;JX(ct,dt);const It=zD(b,m.theme,{prefixCls:Le("")}),Vt={csp:dt,autoInsertSpaceInButton:i,alert:r,anchor:o,locale:s||p,direction:c,space:g,splitter:u,virtual:d,popupMatchSelectWidth:f??C,popupOverflow:v,getPrefixCls:Le,iconPrefixCls:ct,theme:It,segmented:w,statistic:S,spin:Z,calendar:x,carousel:R,cascader:W,collapse:M,typography:N,checkbox:X,descriptions:E,divider:Q,drawer:k,skeleton:J,steps:F,image:L,input:Se,textArea:me,layout:z,list:K,mentions:O,modal:j,progress:P,result:$,slider:oe,breadcrumb:ie,menu:de,pagination:Ve,empty:T,badge:Ge,radio:ne,rate:he,switch:ae,transfer:He,avatar:ve,message:Me,tag:q,table:Y,card:Ce,tabs:se,timeline:fe,timePicker:Ze,upload:Oe,notification:Fe,tree:Ee,colorPicker:Qe,datePicker:Ye,rangePicker:$e,flex:st,wave:Ue,dropdown:Ne,warning:je,tour:Ie,floatButtonGroup:Te,variant:ue,inputNumber:Pe,treeSelect:be},vt=Object.assign({},m);Object.keys(Vt).forEach(ft=>{Vt[ft]!==void 0&&(vt[ft]=Vt[ft])}),gO.forEach(ft=>{const At=t[ft];At&&(vt[ft]=At)}),typeof i<"u"&&(vt.button=Object.assign({autoInsertSpace:i},vt.button));const et=Ph(()=>vt,vt,(ft,At)=>{const Gt=Object.keys(ft),Bt=Object.keys(At);return Gt.length!==Bt.length||Gt.some(Yt=>ft[Yt]!==At[Yt])}),rt=y.useMemo(()=>({prefixCls:ct,csp:dt}),[ct,dt]);let ut=y.createElement(y.Fragment,null,y.createElement(lO,{dropdownMatchSelectWidth:C}),e);const Tt=y.useMemo(()=>{var ft,At,Gt,Bt;return td(((ft=Wg.Form)===null||ft===void 0?void 0:ft.defaultValidateMessages)||{},((Gt=(At=et.locale)===null||At===void 0?void 0:At.Form)===null||Gt===void 0?void 0:Gt.defaultValidateMessages)||{},((Bt=et.form)===null||Bt===void 0?void 0:Bt.validateMessages)||{},(a==null?void 0:a.validateMessages)||{})},[et,a==null?void 0:a.validateMessages]);Object.keys(Tt).length>0&&(ut=y.createElement(MU.Provider,{value:Tt},ut)),s&&(ut=y.createElement(EU,{locale:s,_ANT_MARK__:XU},ut)),(ct||dt)&&(ut=y.createElement(qw.Provider,{value:rt},ut)),l&&(ut=y.createElement(hD,{size:l},ut)),ut=y.createElement(sO,null,ut);const Ft=y.useMemo(()=>{const ft=It||{},{algorithm:At,token:Gt,components:Bt,cssVar:Yt}=ft,St=cO(ft,["algorithm","token","components","cssVar"]),sn=At&&(!Array.isArray(At)||At.length>0)?A2(At):KX,Ot={};Object.entries(Bt||{}).forEach(ee=>{let[Be,_]=ee;const te=Object.assign({},_);"algorithm"in te&&(te.algorithm===!0?te.theme=sn:(Array.isArray(te.algorithm)||typeof te.algorithm=="function")&&(te.theme=A2(te.algorithm)),delete te.algorithm),Ot[Be]=te});const U=Object.assign(Object.assign({},Ch),Gt);return Object.assign(Object.assign({},St),{theme:sn,token:U,components:Ot,override:Object.assign({override:U},Ot),cssVar:Yt})},[It]);return b&&(ut=y.createElement(LX.Provider,{value:Ft},ut)),et.warning&&(ut=y.createElement(VU.Provider,{value:et.warning},ut)),G!==void 0&&(ut=y.createElement(TX,{disabled:G},ut)),y.createElement(yn.Provider,{value:et},ut)},hc=t=>{const e=y.useContext(yn),n=y.useContext(eZ);return y.createElement(hO,Object.assign({parentContext:e,legacyLocale:n},t))};hc.ConfigContext=yn;hc.SizeContext=Fd;hc.config=IO;hc.useConfig=fD;Object.defineProperty(hc,"SizeContext",{get:()=>Fd});var fO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"};function cE(t){var e;return t==null||(e=t.getRootNode)===null||e===void 0?void 0:e.call(t)}function mO(t){return cE(t)instanceof ShadowRoot}function Op(t){return mO(t)?cE(t):null}function AO(t){return t.replace(/-(.)/g,function(e,n){return n.toUpperCase()})}function pO(t,e){Fr(t,"[@ant-design/icons] ".concat(e))}function dV(t){return qt(t)==="object"&&typeof t.name=="string"&&typeof t.theme=="string"&&(qt(t.icon)==="object"||typeof t.icon=="function")}function IV(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(t).reduce(function(e,n){var i=t[n];switch(n){case"class":e.className=i,delete e.class;break;default:delete e[n],e[AO(n)]=i}return e},{})}function U2(t,e,n){return n?ze.createElement(t.tag,Re(Re({key:e},IV(t.attrs)),n),(t.children||[]).map(function(i,r){return U2(i,"".concat(e,"-").concat(t.tag,"-").concat(r))})):ze.createElement(t.tag,Re({key:e},IV(t.attrs)),(t.children||[]).map(function(i,r){return U2(i,"".concat(e,"-").concat(t.tag,"-").concat(r))}))}function gE(t){return Ih(t)[0]}function uE(t){return t?Array.isArray(t)?t:[t]:[]}var vO=`
.anticon {
  display: inline-flex;
  align-items: center;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,bO=function(e){var n=y.useContext(qw),i=n.csp,r=n.prefixCls,o=vO;r&&(o=o.replace(/anticon/g,r)),y.useEffect(function(){var a=e.current,s=Op(a);nl(o,"@ant-design-icons",{prepend:!0,csp:i,attachTo:s})},[])},yO=["icon","className","onClick","style","primaryColor","secondaryColor"],wC={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function GO(t){var e=t.primaryColor,n=t.secondaryColor;wC.primaryColor=e,wC.secondaryColor=n||gE(e),wC.calculated=!!n}function BO(){return Re({},wC)}var $d=function(e){var n=e.icon,i=e.className,r=e.onClick,o=e.style,a=e.primaryColor,s=e.secondaryColor,l=An(e,yO),c=y.useRef(),g=wC;if(a&&(g={primaryColor:a,secondaryColor:s||gE(a)}),bO(c),pO(dV(n),"icon should be icon definiton, but got ".concat(n)),!dV(n))return null;var u=n;return u&&typeof u.icon=="function"&&(u=Re(Re({},u),{},{icon:u.icon(g.primaryColor,g.secondaryColor)})),U2(u.icon,"svg-".concat(u.name),Re(Re({className:i,onClick:r,style:o,"data-icon":u.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},l),{},{ref:c}))};$d.displayName="IconReact";$d.getTwoToneColors=BO;$d.setTwoToneColors=GO;function dE(t){var e=uE(t),n=De(e,2),i=n[0],r=n[1];return $d.setTwoToneColors({primaryColor:i,secondaryColor:r})}function SO(){var t=$d.getTwoToneColors();return t.calculated?[t.primaryColor,t.secondaryColor]:t.primaryColor}var wO=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];dE(Pp.primary);var Ai=y.forwardRef(function(t,e){var n=t.className,i=t.icon,r=t.spin,o=t.rotate,a=t.tabIndex,s=t.onClick,l=t.twoToneColor,c=An(t,wO),g=y.useContext(qw),u=g.prefixCls,d=u===void 0?"anticon":u,C=g.rootClassName,f=qe(C,d,we(we({},"".concat(d,"-").concat(i.name),!!i.name),"".concat(d,"-spin"),!!r||i.name==="loading"),n),v=a;v===void 0&&s&&(v=-1);var p=o?{msTransform:"rotate(".concat(o,"deg)"),transform:"rotate(".concat(o,"deg)")}:void 0,m=uE(l),A=De(m,2),b=A[0],G=A[1];return y.createElement("span",Zt({role:"img","aria-label":i.name},c,{ref:e,tabIndex:v,onClick:s,className:f}),y.createElement($d,{icon:i,primaryColor:b,secondaryColor:G,style:p}))});Ai.displayName="AntdIcon";Ai.getTwoToneColor=SO;Ai.setTwoToneColor=dE;var ZO=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:fO}))},xO=y.forwardRef(ZO),RO={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"},WO=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:RO}))},oZ=y.forwardRef(WO),VO={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z"}}]},name:"close",theme:"outlined"},MO=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:VO}))},Oh=y.forwardRef(MO),NO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"},FO=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:NO}))},HO=y.forwardRef(FO),XO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"info-circle",theme:"filled"},EO=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:XO}))},YO=y.forwardRef(EO),zO=`accept acceptCharset accessKey action allowFullScreen allowTransparency
    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge
    charSet checked classID className colSpan cols content contentEditable contextMenu
    controls coords crossOrigin data dateTime default defer dir disabled download draggable
    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder
    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity
    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media
    mediaGroup method min minLength multiple muted name noValidate nonce open
    optimum pattern placeholder poster preload radioGroup readOnly rel required
    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected
    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style
    summary tabIndex target title type useMap value width wmode wrap`,KO=`onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown
    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick
    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown
    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel
    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough
    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata
    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError`,LO="".concat(zO," ").concat(KO).split(/[\s\n]+/),TO="aria-",_O="data-";function CV(t,e){return t.indexOf(e)===0}function ll(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n;e===!1?n={aria:!0,data:!0,attr:!0}:e===!0?n={aria:!0}:n=Re({},e);var i={};return Object.keys(t).forEach(function(r){(n.aria&&(r==="role"||CV(r,TO))||n.data&&CV(r,_O)||n.attr&&LO.includes(r))&&(i[r]=t[r])}),i}function kO(t){return t&&ze.isValidElement(t)&&t.type===ze.Fragment}const PO=(t,e,n)=>ze.isValidElement(t)?ze.cloneElement(t,typeof n=="function"?n(t.props||{}):n):e;function Ed(t,e){return PO(t,t,e)}const Lg=t=>{const[,,,,e]=Qo();return e?`${t}-css-var`:""};var Ct={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var n=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||n>=Ct.F1&&n<=Ct.F12)return!1;switch(n){case Ct.ALT:case Ct.CAPS_LOCK:case Ct.CONTEXT_MENU:case Ct.CTRL:case Ct.DOWN:case Ct.END:case Ct.ESC:case Ct.HOME:case Ct.INSERT:case Ct.LEFT:case Ct.MAC_FF_META:case Ct.META:case Ct.NUMLOCK:case Ct.NUM_CENTER:case Ct.PAGE_DOWN:case Ct.PAGE_UP:case Ct.PAUSE:case Ct.PRINT_SCREEN:case Ct.RIGHT:case Ct.SHIFT:case Ct.UP:case Ct.WIN_KEY:case Ct.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=Ct.ZERO&&e<=Ct.NINE||e>=Ct.NUM_ZERO&&e<=Ct.NUM_MULTIPLY||e>=Ct.A&&e<=Ct.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&e===0)return!0;switch(e){case Ct.SPACE:case Ct.QUESTION_MARK:case Ct.NUM_PLUS:case Ct.NUM_MINUS:case Ct.NUM_PERIOD:case Ct.NUM_DIVISION:case Ct.SEMICOLON:case Ct.DASH:case Ct.EQUALS:case Ct.COMMA:case Ct.PERIOD:case Ct.SLASH:case Ct.APOSTROPHE:case Ct.SINGLE_QUOTE:case Ct.OPEN_SQUARE_BRACKET:case Ct.BACKSLASH:case Ct.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},UO={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"},DO=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:UO}))},aZ=y.forwardRef(DO);const IE=ze.createContext(void 0),El=100,OO=10,JO=El*OO,CE={Modal:El,Drawer:El,Popover:El,Popconfirm:El,Tooltip:El,Tour:El,FloatButton:El},QO={SelectLike:50,Dropdown:50,DatePicker:50,Menu:50,ImagePreview:1};function jO(t){return t in CE}const hE=(t,e)=>{const[,n]=Qo(),i=ze.useContext(IE),r=jO(t);let o;if(e!==void 0)o=[e,e];else{let a=i??0;r?a+=(i?0:n.zIndexPopupBase)+CE[t]:a+=QO[t],o=[i===void 0?e:a,a]}return o};function $O(){const[t,e]=y.useState([]),n=y.useCallback(i=>(e(r=>[].concat(Et(r),[i])),()=>{e(r=>r.filter(o=>o!==i))}),[]);return[t,n]}function fE(t,e){this.v=t,this.k=e}function Rr(t,e,n,i){var r=Object.defineProperty;try{r({},"",{})}catch{r=0}Rr=function(a,s,l,c){function g(u,d){Rr(a,u,function(C){return this._invoke(u,d,C)})}s?r?r(a,s,{value:l,enumerable:!c,configurable:!c,writable:!c}):a[s]=l:(g("next",0),g("throw",1),g("return",2))},Rr(t,e,n,i)}function sZ(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n=typeof Symbol=="function"?Symbol:{},i=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(C,f,v,p){var m=f&&f.prototype instanceof s?f:s,A=Object.create(m.prototype);return Rr(A,"_invoke",function(b,G,w){var S,Z,x,R=0,W=w||[],M=!1,N={p:0,n:0,v:t,a:X,f:X.bind(t,4),d:function(Q,k){return S=Q,Z=0,x=t,N.n=k,a}};function X(E,Q){for(Z=E,x=Q,e=0;!M&&R&&!k&&e<W.length;e++){var k,J=W[e],F=N.p,L=J[2];E>3?(k=L===Q)&&(x=J[(Z=J[4])?5:(Z=3,3)],J[4]=J[5]=t):J[0]<=F&&((k=E<2&&F<J[1])?(Z=0,N.v=Q,N.n=J[1]):F<L&&(k=E<3||J[0]>Q||Q>L)&&(J[4]=E,J[5]=Q,N.n=L,Z=0))}if(k||E>1)return a;throw M=!0,Q}return function(E,Q,k){if(R>1)throw TypeError("Generator is already running");for(M&&Q===1&&X(Q,k),Z=Q,x=k;(e=Z<2?t:x)||!M;){S||(Z?Z<3?(Z>1&&(N.n=-1),X(Z,x)):N.n=x:N.v=x);try{if(R=2,S){if(Z||(E="next"),e=S[E]){if(!(e=e.call(S,x)))throw TypeError("iterator result is not an object");if(!e.done)return e;x=e.value,Z<2&&(Z=0)}else Z===1&&(e=S.return)&&e.call(S),Z<2&&(x=TypeError("The iterator does not provide a '"+E+"' method"),Z=1);S=t}else if((e=(M=N.n<0)?x:b.call(G,N))!==a)break}catch(J){S=t,Z=1,x=J}finally{R=1}}return{value:e,done:M}}}(C,v,p),!0),A}var a={};function s(){}function l(){}function c(){}e=Object.getPrototypeOf;var g=[][i]?e(e([][i]())):(Rr(e={},i,function(){return this}),e),u=c.prototype=s.prototype=Object.create(g);function d(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,c):(C.__proto__=c,Rr(C,r,"GeneratorFunction")),C.prototype=Object.create(u),C}return l.prototype=c,Rr(u,"constructor",c),Rr(c,"constructor",l),l.displayName="GeneratorFunction",Rr(c,r,"GeneratorFunction"),Rr(u),Rr(u,r,"Generator"),Rr(u,i,function(){return this}),Rr(u,"toString",function(){return"[object Generator]"}),(sZ=function(){return{w:o,m:d}})()}function Jp(t,e){function n(r,o,a,s){try{var l=t[r](o),c=l.value;return c instanceof fE?e.resolve(c.v).then(function(g){n("next",g,a,s)},function(g){n("throw",g,a,s)}):e.resolve(c).then(function(g){l.value=g,a(l)},function(g){return n("throw",g,a,s)})}catch(g){s(g)}}var i;this.next||(Rr(Jp.prototype),Rr(Jp.prototype,typeof Symbol=="function"&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),Rr(this,"_invoke",function(r,o,a){function s(){return new e(function(l,c){n(r,a,l,c)})}return i=i?i.then(s,s):s()},!0)}function mE(t,e,n,i,r){return new Jp(sZ().w(t,e,n,i),r||Promise)}function qO(t,e,n,i,r){var o=mE(t,e,n,i,r);return o.next().then(function(a){return a.done?a.value:o.next()})}function eJ(t){var e=Object(t),n=[];for(var i in e)n.unshift(i);return function r(){for(;n.length;)if((i=n.pop())in e)return r.value=i,r.done=!1,r;return r.done=!0,r}}function hV(t){if(t!=null){var e=t[typeof Symbol=="function"&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if(typeof t.next=="function")return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(qt(t)+" is not iterable")}function Xr(){var t=sZ(),e=t.m(Xr),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function i(a){var s=typeof a=="function"&&a.constructor;return!!s&&(s===n||(s.displayName||s.name)==="GeneratorFunction")}var r={throw:1,return:2,break:3,continue:3};function o(a){var s,l;return function(c){s||(s={stop:function(){return l(c.a,2)},catch:function(){return c.v},abrupt:function(u,d){return l(c.a,r[u],d)},delegateYield:function(u,d,C){return s.resultName=d,l(c.d,hV(u),C)},finish:function(u){return l(c.f,u)}},l=function(u,d,C){c.p=s.prev,c.n=s.next;try{return u(d,C)}finally{s.next=c.n}}),s.resultName&&(s[s.resultName]=c.v,s.resultName=void 0),s.sent=c.v,s.next=c.n;try{return a.call(this,s)}finally{c.p=s.prev,c.n=s.next}}}return(Xr=function(){return{wrap:function(l,c,g,u){return t.w(o(l),c,g,u&&u.reverse())},isGeneratorFunction:i,mark:t.m,awrap:function(l,c){return new fE(l,c)},AsyncIterator:Jp,async:function(l,c,g,u,d){return(i(c)?mE:qO)(o(l),c,g,u,d)},keys:eJ,values:hV}})()}function fV(t,e,n,i,r,o,a){try{var s=t[o](a),l=s.value}catch(c){return void n(c)}s.done?e(l):Promise.resolve(l).then(i,r)}function Tg(t){return function(){var e=this,n=arguments;return new Promise(function(i,r){var o=t.apply(e,n);function a(l){fV(o,i,r,a,s,"next",l)}function s(l){fV(o,i,r,a,s,"throw",l)}a(void 0)})}}var Jh=Re({},Kk),tJ=Jh.version,nJ=Jh.render,iJ=Jh.unmountComponentAtNode,hv;try{var rJ=Number((tJ||"").split(".")[0]);rJ>=18&&(hv=Jh.createRoot)}catch{}function mV(t){var e=Jh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;e&&qt(e)==="object"&&(e.usingClientEntryPoint=t)}var Qp="__rc_react_root__";function oJ(t,e){mV(!0);var n=e[Qp]||hv(e);mV(!1),n.render(t),e[Qp]=n}function aJ(t,e){nJ(t,e)}function AE(t,e){if(hv){oJ(t,e);return}aJ(t,e)}function sJ(t){return D2.apply(this,arguments)}function D2(){return D2=Tg(Xr().mark(function t(e){return Xr().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Promise.resolve().then(function(){var r;(r=e[Qp])===null||r===void 0||r.unmount(),delete e[Qp]}));case 1:case"end":return i.stop()}},t)})),D2.apply(this,arguments)}function lJ(t){iJ(t)}function pE(t){return O2.apply(this,arguments)}function O2(){return O2=Tg(Xr().mark(function t(e){return Xr().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(hv===void 0){i.next=2;break}return i.abrupt("return",sJ(e));case 2:lJ(e);case 3:case"end":return i.stop()}},t)})),O2.apply(this,arguments)}const Yd=(t,e,n)=>n!==void 0?n:`${t}-${e}`,lZ=function(t){if(!t)return!1;if(t instanceof Element){if(t.offsetParent)return!0;if(t.getBBox){var e=t.getBBox(),n=e.width,i=e.height;if(n||i)return!0}if(t.getBoundingClientRect){var r=t.getBoundingClientRect(),o=r.width,a=r.height;if(o||a)return!0}}return!1},cJ=t=>{const{componentCls:e,colorPrimary:n}=t;return{[e]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${n})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${t.motionEaseOutCirc}`,`opacity 2s ${t.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0},"&.wave-quick":{transition:[`box-shadow ${t.motionDurationSlow} ${t.motionEaseInOut}`,`opacity ${t.motionDurationSlow} ${t.motionEaseInOut}`].join(",")}}}}},gJ=HD("Wave",t=>[cJ(t)]),vE=`${Up}-wave-target`;function _y(t){return t&&t!=="#fff"&&t!=="#ffffff"&&t!=="rgb(255, 255, 255)"&&t!=="rgba(255, 255, 255, 1)"&&!/rgba\((?:\d*, ){3}0\)/.test(t)&&t!=="transparent"}function uJ(t){const{borderTopColor:e,borderColor:n,backgroundColor:i}=getComputedStyle(t);return _y(e)?e:_y(n)?n:_y(i)?i:null}function ky(t){return Number.isNaN(t)?0:t}const dJ=t=>{const{className:e,target:n,component:i}=t,r=y.useRef(null),[o,a]=y.useState(null),[s,l]=y.useState([]),[c,g]=y.useState(0),[u,d]=y.useState(0),[C,f]=y.useState(0),[v,p]=y.useState(0),[m,A]=y.useState(!1),b={left:c,top:u,width:C,height:v,borderRadius:s.map(S=>`${S}px`).join(" ")};o&&(b["--wave-color"]=o);function G(){const S=getComputedStyle(n);a(uJ(n));const Z=S.position==="static",{borderLeftWidth:x,borderTopWidth:R}=S;g(Z?n.offsetLeft:ky(-parseFloat(x))),d(Z?n.offsetTop:ky(-parseFloat(R))),f(n.offsetWidth),p(n.offsetHeight);const{borderTopLeftRadius:W,borderTopRightRadius:M,borderBottomLeftRadius:N,borderBottomRightRadius:X}=S;l([W,M,X,N].map(E=>ky(parseFloat(E))))}if(y.useEffect(()=>{if(n){const S=Ln(()=>{G(),A(!0)});let Z;return typeof ResizeObserver<"u"&&(Z=new ResizeObserver(G),Z.observe(n)),()=>{Ln.cancel(S),Z==null||Z.disconnect()}}},[]),!m)return null;const w=(i==="Checkbox"||i==="Radio")&&(n==null?void 0:n.classList.contains(vE));return y.createElement(Cl,{visible:!0,motionAppear:!0,motionName:"wave-motion",motionDeadline:5e3,onAppearEnd:(S,Z)=>{var x;if(Z.deadline||Z.propertyName==="opacity"){const R=(x=r.current)===null||x===void 0?void 0:x.parentElement;pE(R).then(()=>{R==null||R.remove()})}return!1}},(S,Z)=>{let{className:x}=S;return y.createElement("div",{ref:ja(r,Z),className:qe(e,x,{"wave-quick":w}),style:b})})},IJ=(t,e)=>{var n;const{component:i}=e;if(i==="Checkbox"&&!(!((n=t.querySelector("input"))===null||n===void 0)&&n.checked))return;const r=document.createElement("div");r.style.position="absolute",r.style.left="0px",r.style.top="0px",t==null||t.insertBefore(r,t==null?void 0:t.firstChild),AE(y.createElement(dJ,Object.assign({},e,{target:t})),r)},CJ=(t,e,n)=>{const{wave:i}=y.useContext(yn),[,r,o]=Qo(),a=Xi(c=>{const g=t.current;if(i!=null&&i.disabled||!g)return;const u=g.querySelector(`.${vE}`)||g,{showEffect:d}=i||{};(d||IJ)(u,{className:e,token:r,component:n,event:c,hashId:o})}),s=y.useRef();return c=>{Ln.cancel(s.current),s.current=Ln(()=>{a(c)})}},hJ=t=>{const{children:e,disabled:n,component:i}=t,{getPrefixCls:r}=y.useContext(yn),o=y.useRef(null),a=r("wave"),[,s]=gJ(a),l=CJ(o,qe(a,s),i);if(ze.useEffect(()=>{const g=o.current;if(!g||g.nodeType!==1||n)return;const u=d=>{!lZ(d.target)||!g.getAttribute||g.getAttribute("disabled")||g.disabled||g.className.includes("disabled")||g.className.includes("-leave")||l(d)};return g.addEventListener("click",u,!0),()=>{g.removeEventListener("click",u,!0)}},[n]),!ze.isValidElement(e))return e??null;const c=Kg(e)?ja(e.ref,o):o;return Ed(e,{ref:c})},Zs=t=>{const e=ze.useContext(Fd);return ze.useMemo(()=>t?typeof t=="string"?t??e:t instanceof Function?t(e):e:e,[t,e])},bE=y.createContext(null),fv=(t,e)=>{const n=y.useContext(bE),i=y.useMemo(()=>{if(!n)return"";const{compactDirection:r,isFirstItem:o,isLastItem:a}=n,s=r==="vertical"?"-vertical-":"-";return qe(`${t}-compact${s}item`,{[`${t}-compact${s}first-item`]:o,[`${t}-compact${s}last-item`]:a,[`${t}-compact${s}item-rtl`]:e==="rtl"})},[t,e,n]);return{compactSize:n==null?void 0:n.compactSize,compactDirection:n==null?void 0:n.compactDirection,compactItemClassnames:i}},fJ=t=>{let{children:e}=t;return y.createElement(bE.Provider,{value:null},e)};var mJ=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const yE=y.createContext(void 0),AJ=t=>{const{getPrefixCls:e,direction:n}=y.useContext(yn),{prefixCls:i,size:r,className:o}=t,a=mJ(t,["prefixCls","size","className"]),s=e("btn-group",i),[,,l]=Qo();let c="";switch(r){case"large":c="lg";break;case"small":c="sm";break}const g=qe(s,{[`${s}-${c}`]:c,[`${s}-rtl`]:n==="rtl"},o,l);return y.createElement(yE.Provider,{value:r},y.createElement("div",Object.assign({},a,{className:g})))},AV=/^[\u4E00-\u9FA5]{2}$/,J2=AV.test.bind(AV);function GE(t){return t==="danger"?{danger:!0}:{type:t}}function pV(t){return typeof t=="string"}function Py(t){return t==="text"||t==="link"}function pJ(t,e){if(t==null)return;const n=e?" ":"";return typeof t!="string"&&typeof t!="number"&&pV(t.type)&&J2(t.props.children)?Ed(t,{children:t.props.children.split("").join(n)}):pV(t)?J2(t)?ze.createElement("span",null,t.split("").join(n)):ze.createElement("span",null,t):kO(t)?ze.createElement("span",null,t):t}function vJ(t,e){let n=!1;const i=[];return ze.Children.forEach(t,r=>{const o=typeof r,a=o==="string"||o==="number";if(n&&a){const s=i.length-1,l=i[s];i[s]=`${l}${r}`}else i.push(r);n=a}),ze.Children.map(i,r=>pJ(r,e))}const BE=y.forwardRef((t,e)=>{const{className:n,style:i,children:r,prefixCls:o}=t,a=qe(`${o}-icon`,n);return ze.createElement("span",{ref:e,className:a,style:i},r)}),vV=y.forwardRef((t,e)=>{const{prefixCls:n,className:i,style:r,iconClassName:o}=t,a=qe(`${n}-loading-icon`,i);return ze.createElement(BE,{prefixCls:n,className:a,style:r,ref:e},ze.createElement(aZ,{className:o}))}),Uy=()=>({width:0,opacity:0,transform:"scale(0)"}),Dy=t=>({width:t.scrollWidth,opacity:1,transform:"scale(1)"}),bJ=t=>{const{prefixCls:e,loading:n,existIcon:i,className:r,style:o}=t,a=!!n;return i?ze.createElement(vV,{prefixCls:e,className:r,style:o}):ze.createElement(Cl,{visible:a,motionName:`${e}-loading-icon-motion`,motionLeave:a,removeOnLeave:!0,onAppearStart:Uy,onAppearActive:Dy,onEnterStart:Uy,onEnterActive:Dy,onLeaveStart:Dy,onLeaveActive:Uy},(s,l)=>{let{className:c,style:g}=s;return ze.createElement(vV,{prefixCls:e,className:r,style:Object.assign(Object.assign({},o),g),ref:l,iconClassName:c})})},bV=(t,e)=>({[`> span, > ${t}`]:{"&:not(:last-child)":{[`&, & > ${t}`]:{"&:not(:disabled)":{borderInlineEndColor:e}}},"&:not(:first-child)":{[`&, & > ${t}`]:{"&:not(:disabled)":{borderInlineStartColor:e}}}}}),yJ=t=>{const{componentCls:e,fontSize:n,lineWidth:i,groupBorderColor:r,colorErrorHover:o}=t;return{[`${e}-group`]:[{position:"relative",display:"inline-flex",[`> span, > ${e}`]:{"&:not(:last-child)":{[`&, & > ${e}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},"&:not(:first-child)":{marginInlineStart:t.calc(i).mul(-1).equal(),[`&, & > ${e}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}},[e]:{position:"relative",zIndex:1,"&:hover, &:focus, &:active":{zIndex:2},"&[disabled]":{zIndex:0}},[`${e}-icon-only`]:{fontSize:n}},bV(`${e}-primary`,r),bV(`${e}-danger`,o)]}},er=Math.round;function Oy(t,e){const n=t.replace(/^[^(]*\((.*)/,"$1").replace(/\).*/,"").match(/\d*\.?\d+%?/g)||[],i=n.map(r=>parseFloat(r));for(let r=0;r<3;r+=1)i[r]=e(i[r]||0,n[r]||"",r);return n[3]?i[3]=n[3].includes("%")?i[3]/100:i[3]:i[3]=1,i}const yV=(t,e,n)=>n===0?t:t/100;function MI(t,e){const n=e||255;return t>n?n:t<0?0:t}class mv{constructor(e){we(this,"isValid",!0),we(this,"r",0),we(this,"g",0),we(this,"b",0),we(this,"a",1),we(this,"_h",void 0),we(this,"_s",void 0),we(this,"_l",void 0),we(this,"_v",void 0),we(this,"_max",void 0),we(this,"_min",void 0),we(this,"_brightness",void 0);function n(r){return r[0]in e&&r[1]in e&&r[2]in e}if(e)if(typeof e=="string"){let o=function(a){return r.startsWith(a)};var i=o;const r=e.trim();/^#?[A-F\d]{3,8}$/i.test(r)?this.fromHexString(r):o("rgb")?this.fromRgbString(r):o("hsl")?this.fromHslString(r):(o("hsv")||o("hsb"))&&this.fromHsvString(r)}else if(e instanceof mv)this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this._h=e._h,this._s=e._s,this._l=e._l,this._v=e._v;else if(n("rgb"))this.r=MI(e.r),this.g=MI(e.g),this.b=MI(e.b),this.a=typeof e.a=="number"?MI(e.a,1):1;else if(n("hsl"))this.fromHsl(e);else if(n("hsv"))this.fromHsv(e);else throw new Error("@ant-design/fast-color: unsupported input "+JSON.stringify(e))}setR(e){return this._sc("r",e)}setG(e){return this._sc("g",e)}setB(e){return this._sc("b",e)}setA(e){return this._sc("a",e,1)}setHue(e){const n=this.toHsv();return n.h=e,this._c(n)}getLuminance(){function e(o){const a=o/255;return a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4)}const n=e(this.r),i=e(this.g),r=e(this.b);return .2126*n+.7152*i+.0722*r}getHue(){if(typeof this._h>"u"){const e=this.getMax()-this.getMin();e===0?this._h=0:this._h=er(60*(this.r===this.getMax()?(this.g-this.b)/e+(this.g<this.b?6:0):this.g===this.getMax()?(this.b-this.r)/e+2:(this.r-this.g)/e+4))}return this._h}getSaturation(){if(typeof this._s>"u"){const e=this.getMax()-this.getMin();e===0?this._s=0:this._s=e/this.getMax()}return this._s}getLightness(){return typeof this._l>"u"&&(this._l=(this.getMax()+this.getMin())/510),this._l}getValue(){return typeof this._v>"u"&&(this._v=this.getMax()/255),this._v}getBrightness(){return typeof this._brightness>"u"&&(this._brightness=(this.r*299+this.g*587+this.b*114)/1e3),this._brightness}darken(e=10){const n=this.getHue(),i=this.getSaturation();let r=this.getLightness()-e/100;return r<0&&(r=0),this._c({h:n,s:i,l:r,a:this.a})}lighten(e=10){const n=this.getHue(),i=this.getSaturation();let r=this.getLightness()+e/100;return r>1&&(r=1),this._c({h:n,s:i,l:r,a:this.a})}mix(e,n=50){const i=this._c(e),r=n/100,o=s=>(i[s]-this[s])*r+this[s],a={r:er(o("r")),g:er(o("g")),b:er(o("b")),a:er(o("a")*100)/100};return this._c(a)}tint(e=10){return this.mix({r:255,g:255,b:255,a:1},e)}shade(e=10){return this.mix({r:0,g:0,b:0,a:1},e)}onBackground(e){const n=this._c(e),i=this.a+n.a*(1-this.a),r=o=>er((this[o]*this.a+n[o]*n.a*(1-this.a))/i);return this._c({r:r("r"),g:r("g"),b:r("b"),a:i})}isDark(){return this.getBrightness()<128}isLight(){return this.getBrightness()>=128}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}clone(){return this._c(this)}toHexString(){let e="#";const n=(this.r||0).toString(16);e+=n.length===2?n:"0"+n;const i=(this.g||0).toString(16);e+=i.length===2?i:"0"+i;const r=(this.b||0).toString(16);if(e+=r.length===2?r:"0"+r,typeof this.a=="number"&&this.a>=0&&this.a<1){const o=er(this.a*255).toString(16);e+=o.length===2?o:"0"+o}return e}toHsl(){return{h:this.getHue(),s:this.getSaturation(),l:this.getLightness(),a:this.a}}toHslString(){const e=this.getHue(),n=er(this.getSaturation()*100),i=er(this.getLightness()*100);return this.a!==1?`hsla(${e},${n}%,${i}%,${this.a})`:`hsl(${e},${n}%,${i}%)`}toHsv(){return{h:this.getHue(),s:this.getSaturation(),v:this.getValue(),a:this.a}}toRgb(){return{r:this.r,g:this.g,b:this.b,a:this.a}}toRgbString(){return this.a!==1?`rgba(${this.r},${this.g},${this.b},${this.a})`:`rgb(${this.r},${this.g},${this.b})`}toString(){return this.toRgbString()}_sc(e,n,i){const r=this.clone();return r[e]=MI(n,i),r}_c(e){return new this.constructor(e)}getMax(){return typeof this._max>"u"&&(this._max=Math.max(this.r,this.g,this.b)),this._max}getMin(){return typeof this._min>"u"&&(this._min=Math.min(this.r,this.g,this.b)),this._min}fromHexString(e){const n=e.replace("#","");function i(r,o){return parseInt(n[r]+n[o||r],16)}n.length<6?(this.r=i(0),this.g=i(1),this.b=i(2),this.a=n[3]?i(3)/255:1):(this.r=i(0,1),this.g=i(2,3),this.b=i(4,5),this.a=n[6]?i(6,7)/255:1)}fromHsl({h:e,s:n,l:i,a:r}){if(this._h=e%360,this._s=n,this._l=i,this.a=typeof r=="number"?r:1,n<=0){const d=er(i*255);this.r=d,this.g=d,this.b=d}let o=0,a=0,s=0;const l=e/60,c=(1-Math.abs(2*i-1))*n,g=c*(1-Math.abs(l%2-1));l>=0&&l<1?(o=c,a=g):l>=1&&l<2?(o=g,a=c):l>=2&&l<3?(a=c,s=g):l>=3&&l<4?(a=g,s=c):l>=4&&l<5?(o=g,s=c):l>=5&&l<6&&(o=c,s=g);const u=i-c/2;this.r=er((o+u)*255),this.g=er((a+u)*255),this.b=er((s+u)*255)}fromHsv({h:e,s:n,v:i,a:r}){this._h=e%360,this._s=n,this._v=i,this.a=typeof r=="number"?r:1;const o=er(i*255);if(this.r=o,this.g=o,this.b=o,n<=0)return;const a=e/60,s=Math.floor(a),l=a-s,c=er(i*(1-n)*255),g=er(i*(1-n*l)*255),u=er(i*(1-n*(1-l))*255);switch(s){case 0:this.g=u,this.b=c;break;case 1:this.r=g,this.b=c;break;case 2:this.r=c,this.b=u;break;case 3:this.r=c,this.g=g;break;case 4:this.r=u,this.g=c;break;case 5:default:this.g=c,this.b=g;break}}fromHsvString(e){const n=Oy(e,yV);this.fromHsv({h:n[0],s:n[1],v:n[2],a:n[3]})}fromHslString(e){const n=Oy(e,yV);this.fromHsl({h:n[0],s:n[1],l:n[2],a:n[3]})}fromRgbString(e){const n=Oy(e,(i,r)=>r.includes("%")?er(i/100*255):i);this.r=n[0],this.g=n[1],this.b=n[2],this.a=n[3]}}var GJ=["b"],BJ=["v"],Jy=function(e){return Math.round(Number(e||0))},SJ=function(e){if(e instanceof mv)return e;if(e&&qt(e)==="object"&&"h"in e&&"b"in e){var n=e,i=n.b,r=An(n,GJ);return Re(Re({},r),{},{v:i})}return typeof e=="string"&&/hsb/.test(e)?e.replace(/hsb/,"hsv"):e},hh=function(t){dl(n,t);var e=Il(n);function n(i){return Ki(this,n),e.call(this,SJ(i))}return Li(n,[{key:"toHsbString",value:function(){var r=this.toHsb(),o=Jy(r.s*100),a=Jy(r.b*100),s=Jy(r.h),l=r.a,c="hsb(".concat(s,", ").concat(o,"%, ").concat(a,"%)"),g="hsba(".concat(s,", ").concat(o,"%, ").concat(a,"%, ").concat(l.toFixed(l===0?0:2),")");return l===1?c:g}},{key:"toHsb",value:function(){var r=this.toHsv(),o=r.v,a=An(r,BJ);return Re(Re({},a),{},{b:o,a:this.a})}}]),n}(mv),wJ=function(e){return e instanceof hh?e:new hh(e)};wJ("#1677ff");const ZJ=(t,e)=>(t==null?void 0:t.replace(/[^\w/]/g,"").slice(0,e?8:6))||"",xJ=(t,e)=>t?ZJ(t,e):"";let RJ=function(){function t(e){Ki(this,t);var n;if(this.cleared=!1,e instanceof t){this.metaColor=e.metaColor.clone(),this.colors=(n=e.colors)===null||n===void 0?void 0:n.map(r=>({color:new t(r.color),percent:r.percent})),this.cleared=e.cleared;return}const i=Array.isArray(e);i&&e.length?(this.colors=e.map(r=>{let{color:o,percent:a}=r;return{color:new t(o),percent:a}}),this.metaColor=new hh(this.colors[0].color.metaColor)):this.metaColor=new hh(i?"":e),(!e||i&&!this.colors)&&(this.metaColor=this.metaColor.setA(0),this.cleared=!0)}return Li(t,[{key:"toHsb",value:function(){return this.metaColor.toHsb()}},{key:"toHsbString",value:function(){return this.metaColor.toHsbString()}},{key:"toHex",value:function(){return xJ(this.toHexString(),this.metaColor.a<1)}},{key:"toHexString",value:function(){return this.metaColor.toHexString()}},{key:"toRgb",value:function(){return this.metaColor.toRgb()}},{key:"toRgbString",value:function(){return this.metaColor.toRgbString()}},{key:"isGradient",value:function(){return!!this.colors&&!this.cleared}},{key:"getColors",value:function(){return this.colors||[{color:this,percent:0}]}},{key:"toCssString",value:function(){const{colors:n}=this;return n?`linear-gradient(90deg, ${n.map(r=>`${r.color.toRgbString()} ${r.percent}%`).join(", ")})`:this.metaColor.toRgbString()}},{key:"equals",value:function(n){return!n||this.isGradient()!==n.isGradient()?!1:this.isGradient()?this.colors.length===n.colors.length&&this.colors.every((i,r)=>{const o=n.colors[r];return i.percent===o.percent&&i.color.equals(o.color)}):this.toHexString()===n.toHexString()}}])}();var WJ={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"},VJ=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:WJ}))},GV=y.forwardRef(VJ);const MJ=t=>({animationDuration:t,animationFillMode:"both"}),NJ=t=>({animationDuration:t,animationFillMode:"both"}),Av=function(t,e,n,i){const o=(arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1)?"&":"";return{[`
      ${o}${t}-enter,
      ${o}${t}-appear
    `]:Object.assign(Object.assign({},MJ(i)),{animationPlayState:"paused"}),[`${o}${t}-leave`]:Object.assign(Object.assign({},NJ(i)),{animationPlayState:"paused"}),[`
      ${o}${t}-enter${t}-enter-active,
      ${o}${t}-appear${t}-appear-active
    `]:{animationName:e,animationPlayState:"running"},[`${o}${t}-leave${t}-leave-active`]:{animationName:n,animationPlayState:"running",pointerEvents:"none"}}},FJ=new Fn("antFadeIn",{"0%":{opacity:0},"100%":{opacity:1}}),HJ=new Fn("antFadeOut",{"0%":{opacity:1},"100%":{opacity:0}}),XJ=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{antCls:n}=t,i=`${n}-fade`,r=e?"&":"";return[Av(i,FJ,HJ,t.motionDurationMid,e),{[`
        ${r}${i}-enter,
        ${r}${i}-appear
      `]:{opacity:0,animationTimingFunction:"linear"},[`${r}${i}-leave`]:{animationTimingFunction:"linear"}}]},EJ=new Fn("antMoveDownIn",{"0%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),YJ=new Fn("antMoveDownOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0}}),zJ=new Fn("antMoveLeftIn",{"0%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),KJ=new Fn("antMoveLeftOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),LJ=new Fn("antMoveRightIn",{"0%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),TJ=new Fn("antMoveRightOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),_J=new Fn("antMoveUpIn",{"0%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),kJ=new Fn("antMoveUpOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0}}),PJ={"move-up":{inKeyframes:_J,outKeyframes:kJ},"move-down":{inKeyframes:EJ,outKeyframes:YJ},"move-left":{inKeyframes:zJ,outKeyframes:KJ},"move-right":{inKeyframes:LJ,outKeyframes:TJ}},BV=(t,e)=>{const{antCls:n}=t,i=`${n}-${e}`,{inKeyframes:r,outKeyframes:o}=PJ[e];return[Av(i,r,o,t.motionDurationMid),{[`
        ${i}-enter,
        ${i}-appear
      `]:{opacity:0,animationTimingFunction:t.motionEaseOutCirc},[`${i}-leave`]:{animationTimingFunction:t.motionEaseInOutCirc}}]},SE=new Fn("antSlideUpIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1}}),wE=new Fn("antSlideUpOut",{"0%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0}}),ZE=new Fn("antSlideDownIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1}}),xE=new Fn("antSlideDownOut",{"0%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0}}),UJ=new Fn("antSlideLeftIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1}}),DJ=new Fn("antSlideLeftOut",{"0%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0}}),OJ=new Fn("antSlideRightIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1}}),JJ=new Fn("antSlideRightOut",{"0%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0}}),QJ={"slide-up":{inKeyframes:SE,outKeyframes:wE},"slide-down":{inKeyframes:ZE,outKeyframes:xE},"slide-left":{inKeyframes:UJ,outKeyframes:DJ},"slide-right":{inKeyframes:OJ,outKeyframes:JJ}},jp=(t,e)=>{const{antCls:n}=t,i=`${n}-${e}`,{inKeyframes:r,outKeyframes:o}=QJ[e];return[Av(i,r,o,t.motionDurationMid),{[`
      ${i}-enter,
      ${i}-appear
    `]:{transform:"scale(0)",transformOrigin:"0% 0%",opacity:0,animationTimingFunction:t.motionEaseOutQuint,"&-prepare":{transform:"scale(1)"}},[`${i}-leave`]:{animationTimingFunction:t.motionEaseInQuint}}]},jJ=new Fn("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),$J=new Fn("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),SV=new Fn("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),wV=new Fn("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),qJ=new Fn("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),e4=new Fn("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),t4=new Fn("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),n4=new Fn("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}}),i4=new Fn("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),r4=new Fn("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}}),o4=new Fn("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),a4=new Fn("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}}),s4={zoom:{inKeyframes:jJ,outKeyframes:$J},"zoom-big":{inKeyframes:SV,outKeyframes:wV},"zoom-big-fast":{inKeyframes:SV,outKeyframes:wV},"zoom-left":{inKeyframes:t4,outKeyframes:n4},"zoom-right":{inKeyframes:i4,outKeyframes:r4},"zoom-up":{inKeyframes:qJ,outKeyframes:e4},"zoom-down":{inKeyframes:o4,outKeyframes:a4}},l4=(t,e)=>{const{antCls:n}=t,i=`${n}-${e}`,{inKeyframes:r,outKeyframes:o}=s4[e];return[Av(i,r,o,t.motionDurationMid),{[`
        ${i}-enter,
        ${i}-appear
      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:t.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${i}-leave`]:{animationTimingFunction:t.motionEaseInOutCirc}}]},c4=(t,e)=>{const{r:n,g:i,b:r,a:o}=t.toRgb(),a=new hh(t.toRgbString()).onBackground(e).toHsv();return o<=.5?a.v>.5:n*.299+i*.587+r*.114>192},RE=t=>{const{paddingInline:e,onlyIconSize:n,paddingBlock:i}=t;return ci(t,{buttonPaddingHorizontal:e,buttonPaddingVertical:i,buttonIconOnlyFontSize:n})},WE=t=>{var e,n,i,r,o,a;const s=(e=t.contentFontSize)!==null&&e!==void 0?e:t.fontSize,l=(n=t.contentFontSizeSM)!==null&&n!==void 0?n:t.fontSize,c=(i=t.contentFontSizeLG)!==null&&i!==void 0?i:t.fontSizeLG,g=(r=t.contentLineHeight)!==null&&r!==void 0?r:sp(s),u=(o=t.contentLineHeightSM)!==null&&o!==void 0?o:sp(l),d=(a=t.contentLineHeightLG)!==null&&a!==void 0?a:sp(c),C=c4(new RJ(t.colorBgSolid),"#fff")?"#000":"#fff";return{fontWeight:400,defaultShadow:`0 ${t.controlOutlineWidth}px 0 ${t.controlTmpOutline}`,primaryShadow:`0 ${t.controlOutlineWidth}px 0 ${t.controlOutline}`,dangerShadow:`0 ${t.controlOutlineWidth}px 0 ${t.colorErrorOutline}`,primaryColor:t.colorTextLightSolid,dangerColor:t.colorTextLightSolid,borderColorDisabled:t.colorBorder,defaultGhostColor:t.colorBgContainer,ghostBg:"transparent",defaultGhostBorderColor:t.colorBgContainer,paddingInline:t.paddingContentHorizontal-t.lineWidth,paddingInlineLG:t.paddingContentHorizontal-t.lineWidth,paddingInlineSM:8-t.lineWidth,onlyIconSize:t.fontSizeLG,onlyIconSizeSM:t.fontSizeLG-2,onlyIconSizeLG:t.fontSizeLG+2,groupBorderColor:t.colorPrimaryHover,linkHoverBg:"transparent",textTextColor:t.colorText,textTextHoverColor:t.colorText,textTextActiveColor:t.colorText,textHoverBg:t.colorBgTextHover,defaultColor:t.colorText,defaultBg:t.colorBgContainer,defaultBorderColor:t.colorBorder,defaultBorderColorDisabled:t.colorBorder,defaultHoverBg:t.colorBgContainer,defaultHoverColor:t.colorPrimaryHover,defaultHoverBorderColor:t.colorPrimaryHover,defaultActiveBg:t.colorBgContainer,defaultActiveColor:t.colorPrimaryActive,defaultActiveBorderColor:t.colorPrimaryActive,solidTextColor:C,contentFontSize:s,contentFontSizeSM:l,contentFontSizeLG:c,contentLineHeight:g,contentLineHeightSM:u,contentLineHeightLG:d,paddingBlock:Math.max((t.controlHeight-s*g)/2-t.lineWidth,0),paddingBlockSM:Math.max((t.controlHeightSM-l*u)/2-t.lineWidth,0),paddingBlockLG:Math.max((t.controlHeightLG-c*d)/2-t.lineWidth,0)}},g4=t=>{const{componentCls:e,iconCls:n,fontWeight:i}=t;return{[e]:{outline:"none",position:"relative",display:"inline-flex",gap:t.marginXS,alignItems:"center",justifyContent:"center",fontWeight:i,whiteSpace:"nowrap",textAlign:"center",backgroundImage:"none",background:"transparent",border:`${Je(t.lineWidth)} ${t.lineType} transparent`,cursor:"pointer",transition:`all ${t.motionDurationMid} ${t.motionEaseInOut}`,userSelect:"none",touchAction:"manipulation",color:t.colorText,"&:disabled > *":{pointerEvents:"none"},"> span":{display:"inline-block"},[`${e}-icon`]:{lineHeight:1},"> a":{color:"currentColor"},"&:not(:disabled)":Object.assign({},Dh(t)),[`&${e}-two-chinese-chars::first-letter`]:{letterSpacing:"0.34em"},[`&${e}-two-chinese-chars > *:not(${n})`]:{marginInlineEnd:"-0.34em",letterSpacing:"0.34em"},"&-icon-end":{flexDirection:"row-reverse"}}}},VE=(t,e,n)=>({[`&:not(:disabled):not(${t}-disabled)`]:{"&:hover":e,"&:active":n}}),u4=t=>({minWidth:t.controlHeight,paddingInlineStart:0,paddingInlineEnd:0,borderRadius:"50%"}),d4=t=>({borderRadius:t.controlHeight,paddingInlineStart:t.calc(t.controlHeight).div(2).equal(),paddingInlineEnd:t.calc(t.controlHeight).div(2).equal()}),I4=t=>({cursor:"not-allowed",borderColor:t.borderColorDisabled,color:t.colorTextDisabled,background:t.colorBgContainerDisabled,boxShadow:"none"}),cZ=(t,e,n,i,r,o,a,s)=>({[`&${t}-background-ghost`]:Object.assign(Object.assign({color:n||void 0,background:e,borderColor:i||void 0,boxShadow:"none"},VE(t,Object.assign({background:e},a),Object.assign({background:e},s))),{"&:disabled":{cursor:"not-allowed",color:r||void 0,borderColor:o||void 0}})}),C4=t=>({[`&:disabled, &${t.componentCls}-disabled`]:Object.assign({},I4(t))}),h4=t=>({[`&:disabled, &${t.componentCls}-disabled`]:{cursor:"not-allowed",color:t.colorTextDisabled}}),pv=(t,e,n,i)=>{const o=i&&["link","text"].includes(i)?h4:C4;return Object.assign(Object.assign({},o(t)),VE(t.componentCls,e,n))},gZ=(t,e,n,i,r)=>({[`&${t.componentCls}-variant-solid`]:Object.assign({color:e,background:n},pv(t,i,r))}),uZ=(t,e,n,i,r)=>({[`&${t.componentCls}-variant-outlined, &${t.componentCls}-variant-dashed`]:Object.assign({borderColor:e,background:n},pv(t,i,r))}),dZ=t=>({[`&${t.componentCls}-variant-dashed`]:{borderStyle:"dashed"}}),IZ=(t,e,n,i)=>({[`&${t.componentCls}-variant-filled`]:Object.assign({boxShadow:"none",background:e},pv(t,n,i))}),zd=(t,e,n,i,r)=>({[`&${t.componentCls}-variant-${n}`]:Object.assign({color:e,boxShadow:"none"},pv(t,i,r,n))}),f4=t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:t.defaultColor,boxShadow:t.defaultShadow},gZ(t,t.solidTextColor,t.colorBgSolid,{background:t.colorBgSolidHover},{background:t.colorBgSolidActive})),dZ(t)),IZ(t,t.colorFillTertiary,{background:t.colorFillSecondary},{background:t.colorFill})),zd(t,t.textTextColor,"link",{color:t.colorLinkHover,background:t.linkHoverBg},{color:t.colorLinkActive})),cZ(t.componentCls,t.ghostBg,t.defaultGhostColor,t.defaultGhostBorderColor,t.colorTextDisabled,t.colorBorder)),m4=t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:t.colorPrimary,boxShadow:t.primaryShadow},uZ(t,t.colorPrimary,t.colorBgContainer,{color:t.colorPrimaryTextHover,borderColor:t.colorPrimaryHover,background:t.colorBgContainer},{color:t.colorPrimaryTextActive,borderColor:t.colorPrimaryActive,background:t.colorBgContainer})),dZ(t)),IZ(t,t.colorPrimaryBg,{background:t.colorPrimaryBgHover},{background:t.colorPrimaryBorder})),zd(t,t.colorLink,"text",{color:t.colorPrimaryTextHover,background:t.colorPrimaryBg},{color:t.colorPrimaryTextActive,background:t.colorPrimaryBorder})),cZ(t.componentCls,t.ghostBg,t.colorPrimary,t.colorPrimary,t.colorTextDisabled,t.colorBorder,{color:t.colorPrimaryHover,borderColor:t.colorPrimaryHover},{color:t.colorPrimaryActive,borderColor:t.colorPrimaryActive})),A4=t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:t.colorError,boxShadow:t.dangerShadow},gZ(t,t.dangerColor,t.colorError,{background:t.colorErrorHover},{background:t.colorErrorActive})),uZ(t,t.colorError,t.colorBgContainer,{color:t.colorErrorHover,borderColor:t.colorErrorBorderHover},{color:t.colorErrorActive,borderColor:t.colorErrorActive})),dZ(t)),IZ(t,t.colorErrorBg,{background:t.colorErrorBgFilledHover},{background:t.colorErrorBgActive})),zd(t,t.colorError,"text",{color:t.colorErrorHover,background:t.colorErrorBg},{color:t.colorErrorHover,background:t.colorErrorBgActive})),zd(t,t.colorError,"link",{color:t.colorErrorHover},{color:t.colorErrorActive})),cZ(t.componentCls,t.ghostBg,t.colorError,t.colorError,t.colorTextDisabled,t.colorBorder,{color:t.colorErrorHover,borderColor:t.colorErrorHover},{color:t.colorErrorActive,borderColor:t.colorErrorActive})),p4=t=>{const{componentCls:e}=t;return{[`${e}-color-default`]:f4(t),[`${e}-color-primary`]:m4(t),[`${e}-color-dangerous`]:A4(t)}},v4=t=>Object.assign(Object.assign(Object.assign(Object.assign({},uZ(t,t.defaultBorderColor,t.defaultBg,{color:t.defaultHoverColor,borderColor:t.defaultHoverBorderColor,background:t.defaultHoverBg},{color:t.defaultActiveColor,borderColor:t.defaultActiveBorderColor,background:t.defaultActiveBg})),zd(t,t.textTextColor,"text",{color:t.textTextHoverColor,background:t.textHoverBg},{color:t.textTextActiveColor,background:t.colorBgTextActive})),gZ(t,t.primaryColor,t.colorPrimary,{background:t.colorPrimaryHover,color:t.primaryColor},{background:t.colorPrimaryActive,color:t.primaryColor})),zd(t,t.colorLink,"link",{color:t.colorLinkHover,background:t.linkHoverBg},{color:t.colorLinkActive})),CZ=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const{componentCls:n,controlHeight:i,fontSize:r,lineHeight:o,borderRadius:a,buttonPaddingHorizontal:s,iconCls:l,buttonPaddingVertical:c}=t,g=`${n}-icon-only`;return[{[e]:{fontSize:r,lineHeight:o,height:i,padding:`${Je(c)} ${Je(s)}`,borderRadius:a,[`&${g}`]:{width:i,paddingInline:0,[`&${n}-compact-item`]:{flex:"none"},[`&${n}-round`]:{width:"auto"},[l]:{fontSize:t.buttonIconOnlyFontSize}},[`&${n}-loading`]:{opacity:t.opacityLoading,cursor:"default"},[`${n}-loading-icon`]:{transition:`width ${t.motionDurationSlow} ${t.motionEaseInOut}, opacity ${t.motionDurationSlow} ${t.motionEaseInOut}`}}},{[`${n}${n}-circle${e}`]:u4(t)},{[`${n}${n}-round${e}`]:d4(t)}]},b4=t=>{const e=ci(t,{fontSize:t.contentFontSize,lineHeight:t.contentLineHeight});return CZ(e,t.componentCls)},y4=t=>{const e=ci(t,{controlHeight:t.controlHeightSM,fontSize:t.contentFontSizeSM,lineHeight:t.contentLineHeightSM,padding:t.paddingXS,buttonPaddingHorizontal:t.paddingInlineSM,buttonPaddingVertical:t.paddingBlockSM,borderRadius:t.borderRadiusSM,buttonIconOnlyFontSize:t.onlyIconSizeSM});return CZ(e,`${t.componentCls}-sm`)},G4=t=>{const e=ci(t,{controlHeight:t.controlHeightLG,fontSize:t.contentFontSizeLG,lineHeight:t.contentLineHeightLG,buttonPaddingHorizontal:t.paddingInlineLG,buttonPaddingVertical:t.paddingBlockLG,borderRadius:t.borderRadiusLG,buttonIconOnlyFontSize:t.onlyIconSizeLG});return CZ(e,`${t.componentCls}-lg`)},B4=t=>{const{componentCls:e}=t;return{[e]:{[`&${e}-block`]:{width:"100%"}}}},S4=yo("Button",t=>{const e=RE(t);return[g4(e),b4(e),y4(e),G4(e),B4(e),p4(e),v4(e),yJ(e)]},WE,{unitless:{fontWeight:!0,contentLineHeight:!0,contentLineHeightSM:!0,contentLineHeightLG:!0}});function w4(t,e,n){const{focusElCls:i,focus:r,borderElCls:o}=n,a=o?"> *":"",s=["hover",r?"focus":null,"active"].filter(Boolean).map(l=>`&:${l} ${a}`).join(",");return{[`&-item:not(${e}-last-item)`]:{marginInlineEnd:t.calc(t.lineWidth).mul(-1).equal()},"&-item":Object.assign(Object.assign({[s]:{zIndex:2}},i?{[`&${i}`]:{zIndex:2}}:{}),{[`&[disabled] ${a}`]:{zIndex:0}})}}function Z4(t,e,n){const{borderElCls:i}=n,r=i?`> ${i}`:"";return{[`&-item:not(${e}-first-item):not(${e}-last-item) ${r}`]:{borderRadius:0},[`&-item:not(${e}-last-item)${e}-first-item`]:{[`& ${r}, &${t}-sm ${r}, &${t}-lg ${r}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${e}-first-item)${e}-last-item`]:{[`& ${r}, &${t}-sm ${r}, &${t}-lg ${r}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function hZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{focus:!0};const{componentCls:n}=t,i=`${n}-compact`;return{[i]:Object.assign(Object.assign({},w4(t,i,e)),Z4(n,i,e))}}function x4(t,e){return{[`&-item:not(${e}-last-item)`]:{marginBottom:t.calc(t.lineWidth).mul(-1).equal()},"&-item":{"&:hover,&:focus,&:active":{zIndex:2},"&[disabled]":{zIndex:0}}}}function R4(t,e){return{[`&-item:not(${e}-first-item):not(${e}-last-item)`]:{borderRadius:0},[`&-item${e}-first-item:not(${e}-last-item)`]:{[`&, &${t}-sm, &${t}-lg`]:{borderEndEndRadius:0,borderEndStartRadius:0}},[`&-item${e}-last-item:not(${e}-first-item)`]:{[`&, &${t}-sm, &${t}-lg`]:{borderStartStartRadius:0,borderStartEndRadius:0}}}}function W4(t){const e=`${t.componentCls}-compact-vertical`;return{[e]:Object.assign(Object.assign({},x4(t,e)),R4(t.componentCls,e))}}const V4=t=>{const{componentCls:e,calc:n}=t;return{[e]:{[`&-compact-item${e}-primary`]:{[`&:not([disabled]) + ${e}-compact-item${e}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:n(t.lineWidth).mul(-1).equal(),insetInlineStart:n(t.lineWidth).mul(-1).equal(),display:"inline-block",width:t.lineWidth,height:`calc(100% + ${Je(t.lineWidth)} * 2)`,backgroundColor:t.colorPrimaryHover,content:'""'}}},"&-compact-vertical-item":{[`&${e}-primary`]:{[`&:not([disabled]) + ${e}-compact-vertical-item${e}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:n(t.lineWidth).mul(-1).equal(),insetInlineStart:n(t.lineWidth).mul(-1).equal(),display:"inline-block",width:`calc(100% + ${Je(t.lineWidth)} * 2)`,height:t.lineWidth,backgroundColor:t.colorPrimaryHover,content:'""'}}}}}}},M4=iZ(["Button","compact"],t=>{const e=RE(t);return[hZ(e),W4(e),V4(e)]},WE);var N4=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function F4(t){if(typeof t=="object"&&t){let e=t==null?void 0:t.delay;return e=!Number.isNaN(e)&&typeof e=="number"?e:0,{loading:e<=0,delay:e}}return{loading:!!t,delay:0}}const H4={default:["default","outlined"],primary:["primary","solid"],dashed:["default","dashed"],link:["primary","link"],text:["default","text"]},X4=ze.forwardRef((t,e)=>{var n,i,r;const{loading:o=!1,prefixCls:a,color:s,variant:l,type:c,danger:g=!1,shape:u="default",size:d,styles:C,disabled:f,className:v,rootClassName:p,children:m,icon:A,iconPosition:b="start",ghost:G=!1,block:w=!1,htmlType:S="button",classNames:Z,style:x={},autoInsertSpace:R}=t,W=N4(t,["loading","prefixCls","color","variant","type","danger","shape","size","styles","disabled","className","rootClassName","children","icon","iconPosition","ghost","block","htmlType","classNames","style","autoInsertSpace"]),M=c||"default",[N,X]=y.useMemo(()=>{if(s&&l)return[s,l];const Ye=H4[M]||[];return g?["danger",Ye[1]]:Ye},[c,s,l,g]),Q=N==="danger"?"dangerous":N,{getPrefixCls:k,direction:J,button:F}=y.useContext(yn),L=(n=R??(F==null?void 0:F.autoInsertSpace))!==null&&n!==void 0?n:!0,z=k("btn",a),[K,O,j]=S4(z),P=y.useContext(lc),$=f??P,oe=y.useContext(yE),ie=y.useMemo(()=>F4(o),[o]),[de,Ve]=y.useState(ie.loading),[Se,me]=y.useState(!1),Ge=ja(e,y.createRef()),ne=y.Children.count(m)===1&&!A&&!Py(X);y.useEffect(()=>{let Ye=null;ie.delay>0?Ye=setTimeout(()=>{Ye=null,Ve(!0)},ie.delay):Ve(ie.loading);function $e(){Ye&&(clearTimeout(Ye),Ye=null)}return $e},[ie]),y.useEffect(()=>{if(!Ge||!Ge.current||!L)return;const Ye=Ge.current.textContent;ne&&J2(Ye)?Se||me(!0):Se&&me(!1)},[Ge]);const he=Ye=>{const{onClick:$e}=t;if(de||$){Ye.preventDefault();return}$e==null||$e(Ye)},{compactSize:ae,compactItemClassnames:He}=fv(z,J),ve={large:"lg",small:"sm",middle:void 0},Me=Zs(Ye=>{var $e,st;return(st=($e=d??ae)!==null&&$e!==void 0?$e:oe)!==null&&st!==void 0?st:Ye}),q=Me&&ve[Me]||"",Y=de?"loading":A,Ce=$a(W,["navigate"]),se=qe(z,O,j,{[`${z}-${u}`]:u!=="default"&&u,[`${z}-${M}`]:M,[`${z}-dangerous`]:g,[`${z}-color-${Q}`]:Q,[`${z}-variant-${X}`]:X,[`${z}-${q}`]:q,[`${z}-icon-only`]:!m&&m!==0&&!!Y,[`${z}-background-ghost`]:G&&!Py(X),[`${z}-loading`]:de,[`${z}-two-chinese-chars`]:Se&&L&&!de,[`${z}-block`]:w,[`${z}-rtl`]:J==="rtl",[`${z}-icon-end`]:b==="end"},He,v,p,F==null?void 0:F.className),fe=Object.assign(Object.assign({},F==null?void 0:F.style),x),Ze=qe(Z==null?void 0:Z.icon,(i=F==null?void 0:F.classNames)===null||i===void 0?void 0:i.icon),Oe=Object.assign(Object.assign({},(C==null?void 0:C.icon)||{}),((r=F==null?void 0:F.styles)===null||r===void 0?void 0:r.icon)||{}),Fe=A&&!de?ze.createElement(BE,{prefixCls:z,className:Ze,style:Oe},A):ze.createElement(bJ,{existIcon:!!A,prefixCls:z,loading:de}),Ee=m||m===0?vJ(m,ne&&L):null;if(Ce.href!==void 0)return K(ze.createElement("a",Object.assign({},Ce,{className:qe(se,{[`${z}-disabled`]:$}),href:$?void 0:Ce.href,style:fe,onClick:he,ref:Ge,tabIndex:$?-1:0}),Fe,Ee));let Qe=ze.createElement("button",Object.assign({},W,{type:S,className:se,style:fe,onClick:he,disabled:$,ref:Ge}),Fe,Ee,!!He&&ze.createElement(M4,{key:"compact",prefixCls:z}));return Py(X)||(Qe=ze.createElement(hJ,{component:"Button",disabled:de},Qe)),K(Qe)}),nr=X4;nr.Group=AJ;nr.__ANT_BUTTON=!0;function Qy(t){return!!(t!=null&&t.then)}const ME=t=>{const{type:e,children:n,prefixCls:i,buttonProps:r,close:o,autoFocus:a,emitEvent:s,isSilent:l,quitOnNullishReturnValue:c,actionFn:g}=t,u=y.useRef(!1),d=y.useRef(null),[C,f]=Hd(!1),v=function(){o==null||o.apply(void 0,arguments)};y.useEffect(()=>{let A=null;return a&&(A=setTimeout(()=>{var b;(b=d.current)===null||b===void 0||b.focus()})),()=>{A&&clearTimeout(A)}},[]);const p=A=>{Qy(A)&&(f(!0),A.then(function(){f(!1,!0),v.apply(void 0,arguments),u.current=!1},b=>{if(f(!1,!0),u.current=!1,!(l!=null&&l()))return Promise.reject(b)}))},m=A=>{if(u.current)return;if(u.current=!0,!g){v();return}let b;if(s){if(b=g(A),c&&!Qy(b)){u.current=!1,v(A);return}}else if(g.length)b=g(o),u.current=!1;else if(b=g(),!Qy(b)){v();return}p(b)};return y.createElement(nr,Object.assign({},GE(e),{onClick:m,loading:C,prefixCls:i},r,{ref:d}),n)},Qh=ze.createContext({}),{Provider:NE}=Qh,ZV=()=>{const{autoFocusButton:t,cancelButtonProps:e,cancelTextLocale:n,isSilent:i,mergedOkCancel:r,rootPrefixCls:o,close:a,onCancel:s,onConfirm:l}=y.useContext(Qh);return r?ze.createElement(ME,{isSilent:i,actionFn:s,close:function(){a==null||a.apply(void 0,arguments),l==null||l(!1)},autoFocus:t==="cancel",buttonProps:e,prefixCls:`${o}-btn`},n):null},xV=()=>{const{autoFocusButton:t,close:e,isSilent:n,okButtonProps:i,rootPrefixCls:r,okTextLocale:o,okType:a,onConfirm:s,onOk:l}=y.useContext(Qh);return ze.createElement(ME,{isSilent:n,type:a||"primary",actionFn:l,close:function(){e==null||e.apply(void 0,arguments),s==null||s(!0)},autoFocus:t==="ok",buttonProps:i,prefixCls:`${r}-btn`},o)};var FE=y.createContext(null),RV=[];function E4(t,e){var n=y.useState(function(){if(!eo())return null;var f=document.createElement("div");return f}),i=De(n,1),r=i[0],o=y.useRef(!1),a=y.useContext(FE),s=y.useState(RV),l=De(s,2),c=l[0],g=l[1],u=a||(o.current?void 0:function(f){g(function(v){var p=[f].concat(Et(v));return p})});function d(){r.parentElement||document.body.appendChild(r),o.current=!0}function C(){var f;(f=r.parentElement)===null||f===void 0||f.removeChild(r),o.current=!1}return qn(function(){return t?a?a(d):d():C(),C},[t]),qn(function(){c.length&&(c.forEach(function(f){return f()}),g(RV))},[c]),[r,u]}function Y4(t){var e="rc-scrollbar-measure-".concat(Math.random().toString(36).substring(7)),n=document.createElement("div");n.id=e;var i=n.style;i.position="absolute",i.left="0",i.top="0",i.width="100px",i.height="100px",i.overflow="scroll";var r,o;if(t){var a=getComputedStyle(t);i.scrollbarColor=a.scrollbarColor,i.scrollbarWidth=a.scrollbarWidth;var s=getComputedStyle(t,"::-webkit-scrollbar"),l=parseInt(s.width,10),c=parseInt(s.height,10);try{var g=l?"width: ".concat(s.width,";"):"",u=c?"height: ".concat(s.height,";"):"";nl(`
#`.concat(e,`::-webkit-scrollbar {
`).concat(g,`
`).concat(u,`
}`),e)}catch(f){console.error(f),r=l,o=c}}document.body.appendChild(n);var d=t&&r&&!isNaN(r)?r:n.offsetWidth-n.clientWidth,C=t&&o&&!isNaN(o)?o:n.offsetHeight-n.clientHeight;return document.body.removeChild(n),ch(e),{width:d,height:C}}function z4(t){return typeof document>"u"||!t||!(t instanceof Element)?{width:0,height:0}:Y4(t)}function K4(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth}var L4="rc-util-locker-".concat(Date.now()),WV=0;function T4(t){var e=!!t,n=y.useState(function(){return WV+=1,"".concat(L4,"_").concat(WV)}),i=De(n,1),r=i[0];qn(function(){if(e){var o=z4(document.body).width,a=K4();nl(`
html body {
  overflow-y: hidden;
  `.concat(a?"width: calc(100% - ".concat(o,"px);"):"",`
}`),r)}else ch(r);return function(){ch(r)}},[e,r])}var _4=!1;function k4(t){return _4}var VV=function(e){return e===!1?!1:!eo()||!e?null:typeof e=="string"?document.querySelector(e):typeof e=="function"?e():e},fZ=y.forwardRef(function(t,e){var n=t.open,i=t.autoLock,r=t.getContainer;t.debug;var o=t.autoDestroy,a=o===void 0?!0:o,s=t.children,l=y.useState(n),c=De(l,2),g=c[0],u=c[1],d=g||n;y.useEffect(function(){(a||n)&&u(n)},[n,a]);var C=y.useState(function(){return VV(r)}),f=De(C,2),v=f[0],p=f[1];y.useEffect(function(){var M=VV(r);p(M??null)});var m=E4(d&&!v),A=De(m,2),b=A[0],G=A[1],w=v??b;T4(i&&n&&eo()&&(w===b||w===document.body));var S=null;if(s&&Kg(s)&&e){var Z=s;S=Z.ref}var x=zg(S,e);if(!d||!eo()||v===void 0)return null;var R=w===!1||k4(),W=s;return e&&(W=y.cloneElement(s,{ref:x})),y.createElement(FE.Provider,{value:G},R?W:sc.createPortal(W,w))}),HE=y.createContext({});function P4(){var t=Re({},Y0);return t.useId}var MV=0,NV=P4();const XE=NV?function(e){var n=NV();return e||n}:function(e){var n=y.useState("ssr-id"),i=De(n,2),r=i[0],o=i[1];return y.useEffect(function(){var a=MV;MV+=1,o("rc_unique_".concat(a))},[]),e||r};function FV(t,e,n){var i=e;return!i&&n&&(i="".concat(t,"-").concat(n)),i}function HV(t,e){var n=t["page".concat(e?"Y":"X","Offset")],i="scroll".concat(e?"Top":"Left");if(typeof n!="number"){var r=t.document;n=r.documentElement[i],typeof n!="number"&&(n=r.body[i])}return n}function U4(t){var e=t.getBoundingClientRect(),n={left:e.left,top:e.top},i=t.ownerDocument,r=i.defaultView||i.parentWindow;return n.left+=HV(r),n.top+=HV(r,!0),n}const D4=y.memo(function(t){var e=t.children;return e},function(t,e){var n=e.shouldUpdate;return!n});var O4={width:0,height:0,overflow:"hidden",outline:"none"},J4={outline:"none"},EE=ze.forwardRef(function(t,e){var n=t.prefixCls,i=t.className,r=t.style,o=t.title,a=t.ariaId,s=t.footer,l=t.closable,c=t.closeIcon,g=t.onClose,u=t.children,d=t.bodyStyle,C=t.bodyProps,f=t.modalRender,v=t.onMouseDown,p=t.onMouseUp,m=t.holderRef,A=t.visible,b=t.forceRender,G=t.width,w=t.height,S=t.classNames,Z=t.styles,x=ze.useContext(HE),R=x.panel,W=zg(m,R),M=y.useRef(),N=y.useRef();ze.useImperativeHandle(e,function(){return{focus:function(){var O;(O=M.current)===null||O===void 0||O.focus({preventScroll:!0})},changeActive:function(O){var j=document,P=j.activeElement;O&&P===N.current?M.current.focus({preventScroll:!0}):!O&&P===M.current&&N.current.focus({preventScroll:!0})}}});var X={};G!==void 0&&(X.width=G),w!==void 0&&(X.height=w);var E=s?ze.createElement("div",{className:qe("".concat(n,"-footer"),S==null?void 0:S.footer),style:Re({},Z==null?void 0:Z.footer)},s):null,Q=o?ze.createElement("div",{className:qe("".concat(n,"-header"),S==null?void 0:S.header),style:Re({},Z==null?void 0:Z.header)},ze.createElement("div",{className:"".concat(n,"-title"),id:a},o)):null,k=y.useMemo(function(){return qt(l)==="object"&&l!==null?l:l?{closeIcon:c??ze.createElement("span",{className:"".concat(n,"-close-x")})}:{}},[l,c,n]),J=ll(k,!0),F=qt(l)==="object"&&l.disabled,L=l?ze.createElement("button",Zt({type:"button",onClick:g,"aria-label":"Close"},J,{className:"".concat(n,"-close"),disabled:F}),k.closeIcon):null,z=ze.createElement("div",{className:qe("".concat(n,"-content"),S==null?void 0:S.content),style:Z==null?void 0:Z.content},L,Q,ze.createElement("div",Zt({className:qe("".concat(n,"-body"),S==null?void 0:S.body),style:Re(Re({},d),Z==null?void 0:Z.body)},C),u),E);return ze.createElement("div",{key:"dialog-element",role:"dialog","aria-labelledby":o?a:null,"aria-modal":"true",ref:W,style:Re(Re({},r),X),className:qe(n,i),onMouseDown:v,onMouseUp:p},ze.createElement("div",{ref:M,tabIndex:0,style:J4},ze.createElement(D4,{shouldUpdate:A||b},f?f(z):z)),ze.createElement("div",{tabIndex:0,ref:N,style:O4}))}),YE=y.forwardRef(function(t,e){var n=t.prefixCls,i=t.title,r=t.style,o=t.className,a=t.visible,s=t.forceRender,l=t.destroyOnClose,c=t.motionName,g=t.ariaId,u=t.onVisibleChanged,d=t.mousePosition,C=y.useRef(),f=y.useState(),v=De(f,2),p=v[0],m=v[1],A={};p&&(A.transformOrigin=p);function b(){var G=U4(C.current);m(d&&(d.x||d.y)?"".concat(d.x-G.left,"px ").concat(d.y-G.top,"px"):"")}return y.createElement(Cl,{visible:a,onVisibleChanged:u,onAppearPrepare:b,onEnterPrepare:b,forceRender:s,motionName:c,removeOnLeave:l,ref:C},function(G,w){var S=G.className,Z=G.style;return y.createElement(EE,Zt({},t,{ref:e,title:i,ariaId:g,prefixCls:n,holderRef:w,style:Re(Re(Re({},Z),r),A),className:qe(o,S)}))})});YE.displayName="Content";var Q4=function(e){var n=e.prefixCls,i=e.style,r=e.visible,o=e.maskProps,a=e.motionName,s=e.className;return y.createElement(Cl,{key:"mask",visible:r,motionName:a,leavedClassName:"".concat(n,"-mask-hidden")},function(l,c){var g=l.className,u=l.style;return y.createElement("div",Zt({ref:c,style:Re(Re({},u),i),className:qe("".concat(n,"-mask"),g,s)},o))})},j4=function(e){var n=e.prefixCls,i=n===void 0?"rc-dialog":n,r=e.zIndex,o=e.visible,a=o===void 0?!1:o,s=e.keyboard,l=s===void 0?!0:s,c=e.focusTriggerAfterClose,g=c===void 0?!0:c,u=e.wrapStyle,d=e.wrapClassName,C=e.wrapProps,f=e.onClose,v=e.afterOpenChange,p=e.afterClose,m=e.transitionName,A=e.animation,b=e.closable,G=b===void 0?!0:b,w=e.mask,S=w===void 0?!0:w,Z=e.maskTransitionName,x=e.maskAnimation,R=e.maskClosable,W=R===void 0?!0:R,M=e.maskStyle,N=e.maskProps,X=e.rootClassName,E=e.classNames,Q=e.styles,k=y.useRef(),J=y.useRef(),F=y.useRef(),L=y.useState(a),z=De(L,2),K=z[0],O=z[1],j=XE();function P(){h2(J.current,document.activeElement)||(k.current=document.activeElement)}function $(){if(!h2(J.current,document.activeElement)){var he;(he=F.current)===null||he===void 0||he.focus()}}function oe(he){if(he)$();else{if(O(!1),S&&k.current&&g){try{k.current.focus({preventScroll:!0})}catch{}k.current=null}K&&(p==null||p())}v==null||v(he)}function ie(he){f==null||f(he)}var de=y.useRef(!1),Ve=y.useRef(),Se=function(){clearTimeout(Ve.current),de.current=!0},me=function(){Ve.current=setTimeout(function(){de.current=!1})},T=null;W&&(T=function(ae){de.current?de.current=!1:J.current===ae.target&&ie(ae)});function Ge(he){if(l&&he.keyCode===Ct.ESC){he.stopPropagation(),ie(he);return}a&&he.keyCode===Ct.TAB&&F.current.changeActive(!he.shiftKey)}y.useEffect(function(){a&&(O(!0),P())},[a]),y.useEffect(function(){return function(){clearTimeout(Ve.current)}},[]);var ne=Re(Re(Re({zIndex:r},u),Q==null?void 0:Q.wrapper),{},{display:K?null:"none"});return y.createElement("div",Zt({className:qe("".concat(i,"-root"),X)},ll(e,{data:!0})),y.createElement(Q4,{prefixCls:i,visible:S&&a,motionName:FV(i,Z,x),style:Re(Re({zIndex:r},M),Q==null?void 0:Q.mask),maskProps:N,className:E==null?void 0:E.mask}),y.createElement("div",Zt({tabIndex:-1,onKeyDown:Ge,className:qe("".concat(i,"-wrap"),d,E==null?void 0:E.wrapper),ref:J,onClick:T,style:ne},C),y.createElement(YE,Zt({},e,{onMouseDown:Se,onMouseUp:me,ref:F,closable:G,ariaId:j,prefixCls:i,visible:a&&K,onClose:ie,onVisibleChanged:oe,motionName:FV(i,m,A)}))))},zE=function(e){var n=e.visible,i=e.getContainer,r=e.forceRender,o=e.destroyOnClose,a=o===void 0?!1:o,s=e.afterClose,l=e.panelRef,c=y.useState(n),g=De(c,2),u=g[0],d=g[1],C=y.useMemo(function(){return{panel:l}},[l]);return y.useEffect(function(){n&&d(!0)},[n]),!r&&a&&!u?null:y.createElement(HE.Provider,{value:C},y.createElement(fZ,{open:n||r||u,autoDestroy:!1,getContainer:i,autoLock:n||u},y.createElement(j4,Zt({},e,{destroyOnClose:a,afterClose:function(){s==null||s(),d(!1)}}))))};zE.displayName="Dialog";var sg="RC_FORM_INTERNAL_HOOKS",Pn=function(){Fr(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},Kd=y.createContext({getFieldValue:Pn,getFieldsValue:Pn,getFieldError:Pn,getFieldWarning:Pn,getFieldsError:Pn,isFieldsTouched:Pn,isFieldTouched:Pn,isFieldValidating:Pn,isFieldsValidating:Pn,resetFields:Pn,setFields:Pn,setFieldValue:Pn,setFieldsValue:Pn,validateFields:Pn,submit:Pn,getInternalHooks:function(){return Pn(),{dispatch:Pn,initEntityValue:Pn,registerField:Pn,useSubscribe:Pn,setInitialValues:Pn,destroyForm:Pn,setCallbacks:Pn,registerWatch:Pn,getFields:Pn,setValidateMessages:Pn,setPreserve:Pn,getInitialValue:Pn}}}),$p=y.createContext(null);function Q2(t){return t==null?[]:Array.isArray(t)?t:[t]}function $4(t){return t&&!!t._init}function j2(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}var $2=j2();function q4(t){try{return Function.toString.call(t).indexOf("[native code]")!==-1}catch{return typeof t=="function"}}function eQ(t,e,n){if(Pw())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var r=new(t.bind.apply(t,i));return n&&ah(r,n.prototype),r}function q2(t){var e=typeof Map=="function"?new Map:void 0;return q2=function(i){if(i===null||!q4(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(i))return e.get(i);e.set(i,r)}function r(){return eQ(i,arguments,sh(this).constructor)}return r.prototype=Object.create(i.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),ah(r,i)},q2(t)}var tQ=/%[sdj%]/g,nQ=function(){};function eS(t){if(!t||!t.length)return null;var e={};return t.forEach(function(n){var i=n.field;e[i]=e[i]||[],e[i].push(n)}),e}function Lo(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var r=0,o=n.length;if(typeof t=="function")return t.apply(null,n);if(typeof t=="string"){var a=t.replace(tQ,function(s){if(s==="%%")return"%";if(r>=o)return s;switch(s){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch{return"[Circular]"}break;default:return s}});return a}return t}function iQ(t){return t==="string"||t==="url"||t==="hex"||t==="email"||t==="date"||t==="pattern"}function Ui(t,e){return!!(t==null||e==="array"&&Array.isArray(t)&&!t.length||iQ(e)&&typeof t=="string"&&!t)}function rQ(t,e,n){var i=[],r=0,o=t.length;function a(s){i.push.apply(i,Et(s||[])),r++,r===o&&n(i)}t.forEach(function(s){e(s,a)})}function XV(t,e,n){var i=0,r=t.length;function o(a){if(a&&a.length){n(a);return}var s=i;i=i+1,s<r?e(t[s],o):n([])}o([])}function oQ(t){var e=[];return Object.keys(t).forEach(function(n){e.push.apply(e,Et(t[n]||[]))}),e}var EV=function(t){dl(n,t);var e=Il(n);function n(i,r){var o;return Ki(this,n),o=e.call(this,"Async Validation Error"),we(Zn(o),"errors",void 0),we(Zn(o),"fields",void 0),o.errors=i,o.fields=r,o}return Li(n)}(q2(Error));function aQ(t,e,n,i,r){if(e.first){var o=new Promise(function(d,C){var f=function(m){return i(m),m.length?C(new EV(m,eS(m))):d(r)},v=oQ(t);XV(v,n,f)});return o.catch(function(d){return d}),o}var a=e.firstFields===!0?Object.keys(t):e.firstFields||[],s=Object.keys(t),l=s.length,c=0,g=[],u=new Promise(function(d,C){var f=function(p){if(g.push.apply(g,p),c++,c===l)return i(g),g.length?C(new EV(g,eS(g))):d(r)};s.length||(i(g),d(r)),s.forEach(function(v){var p=t[v];a.indexOf(v)!==-1?XV(p,n,f):rQ(p,n,f)})});return u.catch(function(d){return d}),u}function sQ(t){return!!(t&&t.message!==void 0)}function lQ(t,e){for(var n=t,i=0;i<e.length;i++){if(n==null)return n;n=n[e[i]]}return n}function YV(t,e){return function(n){var i;return t.fullFields?i=lQ(e,t.fullFields):i=e[n.field||t.fullField],sQ(n)?(n.field=n.field||t.fullField,n.fieldValue=i,n):{message:typeof n=="function"?n():n,fieldValue:i,field:n.field||t.fullField}}}function zV(t,e){if(e){for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];qt(i)==="object"&&qt(t[n])==="object"?t[n]=Re(Re({},t[n]),i):t[n]=i}}return t}var cu="enum",cQ=function(e,n,i,r,o){e[cu]=Array.isArray(e[cu])?e[cu]:[],e[cu].indexOf(n)===-1&&r.push(Lo(o.messages[cu],e.fullField,e[cu].join(", ")))},gQ=function(e,n,i,r,o){if(e.pattern){if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(n)||r.push(Lo(o.messages.pattern.mismatch,e.fullField,n,e.pattern));else if(typeof e.pattern=="string"){var a=new RegExp(e.pattern);a.test(n)||r.push(Lo(o.messages.pattern.mismatch,e.fullField,n,e.pattern))}}},uQ=function(e,n,i,r,o){var a=typeof e.len=="number",s=typeof e.min=="number",l=typeof e.max=="number",c=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,g=n,u=null,d=typeof n=="number",C=typeof n=="string",f=Array.isArray(n);if(d?u="number":C?u="string":f&&(u="array"),!u)return!1;f&&(g=n.length),C&&(g=n.replace(c,"_").length),a?g!==e.len&&r.push(Lo(o.messages[u].len,e.fullField,e.len)):s&&!l&&g<e.min?r.push(Lo(o.messages[u].min,e.fullField,e.min)):l&&!s&&g>e.max?r.push(Lo(o.messages[u].max,e.fullField,e.max)):s&&l&&(g<e.min||g>e.max)&&r.push(Lo(o.messages[u].range,e.fullField,e.min,e.max))},KE=function(e,n,i,r,o,a){e.required&&(!i.hasOwnProperty(e.field)||Ui(n,a||e.type))&&r.push(Lo(o.messages.required,e.fullField))},Hm;const dQ=function(){if(Hm)return Hm;var t="[a-fA-F\\d:]",e=function(S){return S&&S.includeBoundaries?"(?:(?<=\\s|^)(?=".concat(t,")|(?<=").concat(t,")(?=\\s|$))"):""},n="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",i="[a-fA-F\\d]{1,4}",r=["(?:".concat(i,":){7}(?:").concat(i,"|:)"),"(?:".concat(i,":){6}(?:").concat(n,"|:").concat(i,"|:)"),"(?:".concat(i,":){5}(?::").concat(n,"|(?::").concat(i,"){1,2}|:)"),"(?:".concat(i,":){4}(?:(?::").concat(i,"){0,1}:").concat(n,"|(?::").concat(i,"){1,3}|:)"),"(?:".concat(i,":){3}(?:(?::").concat(i,"){0,2}:").concat(n,"|(?::").concat(i,"){1,4}|:)"),"(?:".concat(i,":){2}(?:(?::").concat(i,"){0,3}:").concat(n,"|(?::").concat(i,"){1,5}|:)"),"(?:".concat(i,":){1}(?:(?::").concat(i,"){0,4}:").concat(n,"|(?::").concat(i,"){1,6}|:)"),"(?::(?:(?::".concat(i,"){0,5}:").concat(n,"|(?::").concat(i,"){1,7}|:))")],o="(?:%[0-9a-zA-Z]{1,})?",a="(?:".concat(r.join("|"),")").concat(o),s=new RegExp("(?:^".concat(n,"$)|(?:^").concat(a,"$)")),l=new RegExp("^".concat(n,"$")),c=new RegExp("^".concat(a,"$")),g=function(S){return S&&S.exact?s:new RegExp("(?:".concat(e(S)).concat(n).concat(e(S),")|(?:").concat(e(S)).concat(a).concat(e(S),")"),"g")};g.v4=function(w){return w&&w.exact?l:new RegExp("".concat(e(w)).concat(n).concat(e(w)),"g")},g.v6=function(w){return w&&w.exact?c:new RegExp("".concat(e(w)).concat(a).concat(e(w)),"g")};var u="(?:(?:[a-z]+:)?//)",d="(?:\\S+(?::\\S*)?@)?",C=g.v4().source,f=g.v6().source,v="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",p="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",m="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",A="(?::\\d{2,5})?",b='(?:[/?#][^\\s"]*)?',G="(?:".concat(u,"|www\\.)").concat(d,"(?:localhost|").concat(C,"|").concat(f,"|").concat(v).concat(p).concat(m,")").concat(A).concat(b);return Hm=new RegExp("(?:^".concat(G,"$)"),"i"),Hm};var KV={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},gC={integer:function(e){return gC.number(e)&&parseInt(e,10)===e},float:function(e){return gC.number(e)&&!gC.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch{return!1}},date:function(e){return typeof e.getTime=="function"&&typeof e.getMonth=="function"&&typeof e.getYear=="function"&&!isNaN(e.getTime())},number:function(e){return isNaN(e)?!1:typeof e=="number"},object:function(e){return qt(e)==="object"&&!gC.array(e)},method:function(e){return typeof e=="function"},email:function(e){return typeof e=="string"&&e.length<=320&&!!e.match(KV.email)},url:function(e){return typeof e=="string"&&e.length<=2048&&!!e.match(dQ())},hex:function(e){return typeof e=="string"&&!!e.match(KV.hex)}},IQ=function(e,n,i,r,o){if(e.required&&n===void 0){KE(e,n,i,r,o);return}var a=["integer","float","array","regexp","object","method","email","number","date","url","hex"],s=e.type;a.indexOf(s)>-1?gC[s](n)||r.push(Lo(o.messages.types[s],e.fullField,e.type)):s&&qt(n)!==e.type&&r.push(Lo(o.messages.types[s],e.fullField,e.type))},CQ=function(e,n,i,r,o){(/^\s+$/.test(n)||n==="")&&r.push(Lo(o.messages.whitespace,e.fullField))};const Wn={required:KE,whitespace:CQ,type:IQ,range:uQ,enum:cQ,pattern:gQ};var hQ=function(e,n,i,r,o){var a=[],s=e.required||!e.required&&r.hasOwnProperty(e.field);if(s){if(Ui(n)&&!e.required)return i();Wn.required(e,n,r,a,o)}i(a)},fQ=function(e,n,i,r,o){var a=[],s=e.required||!e.required&&r.hasOwnProperty(e.field);if(s){if(n==null&&!e.required)return i();Wn.required(e,n,r,a,o,"array"),n!=null&&(Wn.type(e,n,r,a,o),Wn.range(e,n,r,a,o))}i(a)},mQ=function(e,n,i,r,o){var a=[],s=e.required||!e.required&&r.hasOwnProperty(e.field);if(s){if(Ui(n)&&!e.required)return i();Wn.required(e,n,r,a,o),n!==void 0&&Wn.type(e,n,r,a,o)}i(a)},AQ=function(e,n,i,r,o){var a=[],s=e.required||!e.required&&r.hasOwnProperty(e.field);if(s){if(Ui(n,"date")&&!e.required)return i();if(Wn.required(e,n,r,a,o),!Ui(n,"date")){var l;n instanceof Date?l=n:l=new Date(n),Wn.type(e,l,r,a,o),l&&Wn.range(e,l.getTime(),r,a,o)}}i(a)},pQ="enum",vQ=function(e,n,i,r,o){var a=[],s=e.required||!e.required&&r.hasOwnProperty(e.field);if(s){if(Ui(n)&&!e.required)return i();Wn.required(e,n,r,a,o),n!==void 0&&Wn[pQ](e,n,r,a,o)}i(a)},bQ=function(e,n,i,r,o){var a=[],s=e.required||!e.required&&r.hasOwnProperty(e.field);if(s){if(Ui(n)&&!e.required)return i();Wn.required(e,n,r,a,o),n!==void 0&&(Wn.type(e,n,r,a,o),Wn.range(e,n,r,a,o))}i(a)},yQ=function(e,n,i,r,o){var a=[],s=e.required||!e.required&&r.hasOwnProperty(e.field);if(s){if(Ui(n)&&!e.required)return i();Wn.required(e,n,r,a,o),n!==void 0&&(Wn.type(e,n,r,a,o),Wn.range(e,n,r,a,o))}i(a)},GQ=function(e,n,i,r,o){var a=[],s=e.required||!e.required&&r.hasOwnProperty(e.field);if(s){if(Ui(n)&&!e.required)return i();Wn.required(e,n,r,a,o),n!==void 0&&Wn.type(e,n,r,a,o)}i(a)},BQ=function(e,n,i,r,o){var a=[],s=e.required||!e.required&&r.hasOwnProperty(e.field);if(s){if(n===""&&(n=void 0),Ui(n)&&!e.required)return i();Wn.required(e,n,r,a,o),n!==void 0&&(Wn.type(e,n,r,a,o),Wn.range(e,n,r,a,o))}i(a)},SQ=function(e,n,i,r,o){var a=[],s=e.required||!e.required&&r.hasOwnProperty(e.field);if(s){if(Ui(n)&&!e.required)return i();Wn.required(e,n,r,a,o),n!==void 0&&Wn.type(e,n,r,a,o)}i(a)},wQ=function(e,n,i,r,o){var a=[],s=e.required||!e.required&&r.hasOwnProperty(e.field);if(s){if(Ui(n,"string")&&!e.required)return i();Wn.required(e,n,r,a,o),Ui(n,"string")||Wn.pattern(e,n,r,a,o)}i(a)},ZQ=function(e,n,i,r,o){var a=[],s=e.required||!e.required&&r.hasOwnProperty(e.field);if(s){if(Ui(n)&&!e.required)return i();Wn.required(e,n,r,a,o),Ui(n)||Wn.type(e,n,r,a,o)}i(a)},xQ=function(e,n,i,r,o){var a=[],s=Array.isArray(n)?"array":qt(n);Wn.required(e,n,r,a,o,s),i(a)},RQ=function(e,n,i,r,o){var a=[],s=e.required||!e.required&&r.hasOwnProperty(e.field);if(s){if(Ui(n,"string")&&!e.required)return i();Wn.required(e,n,r,a,o,"string"),Ui(n,"string")||(Wn.type(e,n,r,a,o),Wn.range(e,n,r,a,o),Wn.pattern(e,n,r,a,o),e.whitespace===!0&&Wn.whitespace(e,n,r,a,o))}i(a)},jy=function(e,n,i,r,o){var a=e.type,s=[],l=e.required||!e.required&&r.hasOwnProperty(e.field);if(l){if(Ui(n,a)&&!e.required)return i();Wn.required(e,n,r,s,o,a),Ui(n,a)||Wn.type(e,n,r,s,o)}i(s)};const ZC={string:RQ,method:GQ,number:BQ,boolean:mQ,regexp:ZQ,integer:yQ,float:bQ,array:fQ,object:SQ,enum:vQ,pattern:wQ,date:AQ,url:jy,hex:jy,email:jy,required:xQ,any:hQ};var jh=function(){function t(e){Ki(this,t),we(this,"rules",null),we(this,"_messages",$2),this.define(e)}return Li(t,[{key:"define",value:function(n){var i=this;if(!n)throw new Error("Cannot configure a schema with no rules");if(qt(n)!=="object"||Array.isArray(n))throw new Error("Rules must be an object");this.rules={},Object.keys(n).forEach(function(r){var o=n[r];i.rules[r]=Array.isArray(o)?o:[o]})}},{key:"messages",value:function(n){return n&&(this._messages=zV(j2(),n)),this._messages}},{key:"validate",value:function(n){var i=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){},a=n,s=r,l=o;if(typeof s=="function"&&(l=s,s={}),!this.rules||Object.keys(this.rules).length===0)return l&&l(null,a),Promise.resolve(a);function c(f){var v=[],p={};function m(b){if(Array.isArray(b)){var G;v=(G=v).concat.apply(G,Et(b))}else v.push(b)}for(var A=0;A<f.length;A++)m(f[A]);v.length?(p=eS(v),l(v,p)):l(null,a)}if(s.messages){var g=this.messages();g===$2&&(g=j2()),zV(g,s.messages),s.messages=g}else s.messages=this.messages();var u={},d=s.keys||Object.keys(this.rules);d.forEach(function(f){var v=i.rules[f],p=a[f];v.forEach(function(m){var A=m;typeof A.transform=="function"&&(a===n&&(a=Re({},a)),p=a[f]=A.transform(p),p!=null&&(A.type=A.type||(Array.isArray(p)?"array":qt(p)))),typeof A=="function"?A={validator:A}:A=Re({},A),A.validator=i.getValidationMethod(A),A.validator&&(A.field=f,A.fullField=A.fullField||f,A.type=i.getType(A),u[f]=u[f]||[],u[f].push({rule:A,value:p,source:a,field:f}))})});var C={};return aQ(u,s,function(f,v){var p=f.rule,m=(p.type==="object"||p.type==="array")&&(qt(p.fields)==="object"||qt(p.defaultField)==="object");m=m&&(p.required||!p.required&&f.value),p.field=f.field;function A(Z,x){return Re(Re({},x),{},{fullField:"".concat(p.fullField,".").concat(Z),fullFields:p.fullFields?[].concat(Et(p.fullFields),[Z]):[Z]})}function b(){var Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],x=Array.isArray(Z)?Z:[Z];!s.suppressWarning&&x.length&&t.warning("async-validator:",x),x.length&&p.message!==void 0&&(x=[].concat(p.message));var R=x.map(YV(p,a));if(s.first&&R.length)return C[p.field]=1,v(R);if(!m)v(R);else{if(p.required&&!f.value)return p.message!==void 0?R=[].concat(p.message).map(YV(p,a)):s.error&&(R=[s.error(p,Lo(s.messages.required,p.field))]),v(R);var W={};p.defaultField&&Object.keys(f.value).map(function(X){W[X]=p.defaultField}),W=Re(Re({},W),f.rule.fields);var M={};Object.keys(W).forEach(function(X){var E=W[X],Q=Array.isArray(E)?E:[E];M[X]=Q.map(A.bind(null,X))});var N=new t(M);N.messages(s.messages),f.rule.options&&(f.rule.options.messages=s.messages,f.rule.options.error=s.error),N.validate(f.value,f.rule.options||s,function(X){var E=[];R&&R.length&&E.push.apply(E,Et(R)),X&&X.length&&E.push.apply(E,Et(X)),v(E.length?E:null)})}}var G;if(p.asyncValidator)G=p.asyncValidator(p,f.value,b,f.source,s);else if(p.validator){try{G=p.validator(p,f.value,b,f.source,s)}catch(Z){var w,S;(w=(S=console).error)===null||w===void 0||w.call(S,Z),s.suppressValidatorError||setTimeout(function(){throw Z},0),b(Z.message)}G===!0?b():G===!1?b(typeof p.message=="function"?p.message(p.fullField||p.field):p.message||"".concat(p.fullField||p.field," fails")):G instanceof Array?b(G):G instanceof Error&&b(G.message)}G&&G.then&&G.then(function(){return b()},function(Z){return b(Z)})},function(f){c(f)},a)}},{key:"getType",value:function(n){if(n.type===void 0&&n.pattern instanceof RegExp&&(n.type="pattern"),typeof n.validator!="function"&&n.type&&!ZC.hasOwnProperty(n.type))throw new Error(Lo("Unknown rule type %s",n.type));return n.type||"string"}},{key:"getValidationMethod",value:function(n){if(typeof n.validator=="function")return n.validator;var i=Object.keys(n),r=i.indexOf("message");return r!==-1&&i.splice(r,1),i.length===1&&i[0]==="required"?ZC.required:ZC[this.getType(n)]||void 0}}]),t}();we(jh,"register",function(e,n){if(typeof n!="function")throw new Error("Cannot register a validator by type, validator is not a function");ZC[e]=n});we(jh,"warning",nQ);we(jh,"messages",$2);we(jh,"validators",ZC);var Mo="'${name}' is not a valid ${type}",LE={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:Mo,method:Mo,array:Mo,object:Mo,number:Mo,date:Mo,boolean:Mo,integer:Mo,float:Mo,regexp:Mo,email:Mo,url:Mo,hex:Mo},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},LV=jh;function WQ(t,e){return t.replace(/\\?\$\{\w+\}/g,function(n){if(n.startsWith("\\"))return n.slice(1);var i=n.slice(2,-1);return e[i]})}var TV="CODE_LOGIC_ERROR";function tS(t,e,n,i,r){return nS.apply(this,arguments)}function nS(){return nS=Tg(Xr().mark(function t(e,n,i,r,o){var a,s,l,c,g,u,d,C,f;return Xr().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return a=Re({},i),delete a.ruleIndex,LV.warning=function(){},a.validator&&(s=a.validator,a.validator=function(){try{return s.apply(void 0,arguments)}catch(m){return console.error(m),Promise.reject(TV)}}),l=null,a&&a.type==="array"&&a.defaultField&&(l=a.defaultField,delete a.defaultField),c=new LV(we({},e,[a])),g=td(LE,r.validateMessages),c.messages(g),u=[],p.prev=10,p.next=13,Promise.resolve(c.validate(we({},e,n),Re({},r)));case 13:p.next=18;break;case 15:p.prev=15,p.t0=p.catch(10),p.t0.errors&&(u=p.t0.errors.map(function(m,A){var b=m.message,G=b===TV?g.default:b;return y.isValidElement(G)?y.cloneElement(G,{key:"error_".concat(A)}):G}));case 18:if(!(!u.length&&l)){p.next=23;break}return p.next=21,Promise.all(n.map(function(m,A){return tS("".concat(e,".").concat(A),m,l,r,o)}));case 21:return d=p.sent,p.abrupt("return",d.reduce(function(m,A){return[].concat(Et(m),Et(A))},[]));case 23:return C=Re(Re({},i),{},{name:e,enum:(i.enum||[]).join(", ")},o),f=u.map(function(m){return typeof m=="string"?WQ(m,C):m}),p.abrupt("return",f);case 26:case"end":return p.stop()}},t,null,[[10,15]])})),nS.apply(this,arguments)}function VQ(t,e,n,i,r,o){var a=t.join("."),s=n.map(function(g,u){var d=g.validator,C=Re(Re({},g),{},{ruleIndex:u});return d&&(C.validator=function(f,v,p){var m=!1,A=function(){for(var w=arguments.length,S=new Array(w),Z=0;Z<w;Z++)S[Z]=arguments[Z];Promise.resolve().then(function(){Fr(!m,"Your validator function has already return a promise. `callback` will be ignored."),m||p.apply(void 0,S)})},b=d(f,v,A);m=b&&typeof b.then=="function"&&typeof b.catch=="function",Fr(m,"`callback` is deprecated. Please return a promise instead."),m&&b.then(function(){p()}).catch(function(G){p(G||" ")})}),C}).sort(function(g,u){var d=g.warningOnly,C=g.ruleIndex,f=u.warningOnly,v=u.ruleIndex;return!!d==!!f?C-v:d?1:-1}),l;if(r===!0)l=new Promise(function(){var g=Tg(Xr().mark(function u(d,C){var f,v,p;return Xr().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:f=0;case 1:if(!(f<s.length)){A.next=12;break}return v=s[f],A.next=5,tS(a,e,v,i,o);case 5:if(p=A.sent,!p.length){A.next=9;break}return C([{errors:p,rule:v}]),A.abrupt("return");case 9:f+=1,A.next=1;break;case 12:d([]);case 13:case"end":return A.stop()}},u)}));return function(u,d){return g.apply(this,arguments)}}());else{var c=s.map(function(g){return tS(a,e,g,i,o).then(function(u){return{errors:u,rule:g}})});l=(r?NQ(c):MQ(c)).then(function(g){return Promise.reject(g)})}return l.catch(function(g){return g}),l}function MQ(t){return iS.apply(this,arguments)}function iS(){return iS=Tg(Xr().mark(function t(e){return Xr().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Promise.all(e).then(function(r){var o,a=(o=[]).concat.apply(o,Et(r));return a}));case 1:case"end":return i.stop()}},t)})),iS.apply(this,arguments)}function NQ(t){return rS.apply(this,arguments)}function rS(){return rS=Tg(Xr().mark(function t(e){var n;return Xr().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=0,r.abrupt("return",new Promise(function(o){e.forEach(function(a){a.then(function(s){s.errors.length&&o([s]),n+=1,n===e.length&&o([])})})}));case 2:case"end":return r.stop()}},t)})),rS.apply(this,arguments)}function Zi(t){return Q2(t)}function _V(t,e){var n={};return e.forEach(function(i){var r=fs(t,i);n=za(n,i,r)}),n}function fd(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return t&&t.some(function(i){return TE(e,i,n)})}function TE(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return!t||!e||!n&&t.length!==e.length?!1:e.every(function(i,r){return t[r]===i})}function FQ(t,e){if(t===e)return!0;if(!t&&e||t&&!e||!t||!e||qt(t)!=="object"||qt(e)!=="object")return!1;var n=Object.keys(t),i=Object.keys(e),r=new Set([].concat(n,i));return Et(r).every(function(o){var a=t[o],s=e[o];return typeof a=="function"&&typeof s=="function"?!0:a===s})}function HQ(t){var e=arguments.length<=1?void 0:arguments[1];return e&&e.target&&qt(e.target)==="object"&&t in e.target?e.target[t]:e}function kV(t,e,n){var i=t.length;if(e<0||e>=i||n<0||n>=i)return t;var r=t[e],o=e-n;return o>0?[].concat(Et(t.slice(0,n)),[r],Et(t.slice(n,e)),Et(t.slice(e+1,i))):o<0?[].concat(Et(t.slice(0,e)),Et(t.slice(e+1,n+1)),[r],Et(t.slice(n+1,i))):t}var XQ=["name"],la=[];function $y(t,e,n,i,r,o){return typeof t=="function"?t(e,n,"source"in o?{source:o.source}:{}):i!==r}var mZ=function(t){dl(n,t);var e=Il(n);function n(i){var r;if(Ki(this,n),r=e.call(this,i),we(Zn(r),"state",{resetCount:0}),we(Zn(r),"cancelRegisterFunc",null),we(Zn(r),"mounted",!1),we(Zn(r),"touched",!1),we(Zn(r),"dirty",!1),we(Zn(r),"validatePromise",void 0),we(Zn(r),"prevValidating",void 0),we(Zn(r),"errors",la),we(Zn(r),"warnings",la),we(Zn(r),"cancelRegister",function(){var l=r.props,c=l.preserve,g=l.isListField,u=l.name;r.cancelRegisterFunc&&r.cancelRegisterFunc(g,c,Zi(u)),r.cancelRegisterFunc=null}),we(Zn(r),"getNamePath",function(){var l=r.props,c=l.name,g=l.fieldContext,u=g.prefixName,d=u===void 0?[]:u;return c!==void 0?[].concat(Et(d),Et(c)):[]}),we(Zn(r),"getRules",function(){var l=r.props,c=l.rules,g=c===void 0?[]:c,u=l.fieldContext;return g.map(function(d){return typeof d=="function"?d(u):d})}),we(Zn(r),"refresh",function(){r.mounted&&r.setState(function(l){var c=l.resetCount;return{resetCount:c+1}})}),we(Zn(r),"metaCache",null),we(Zn(r),"triggerMetaEvent",function(l){var c=r.props.onMetaChange;if(c){var g=Re(Re({},r.getMeta()),{},{destroy:l});gh(r.metaCache,g)||c(g),r.metaCache=g}else r.metaCache=null}),we(Zn(r),"onStoreChange",function(l,c,g){var u=r.props,d=u.shouldUpdate,C=u.dependencies,f=C===void 0?[]:C,v=u.onReset,p=g.store,m=r.getNamePath(),A=r.getValue(l),b=r.getValue(p),G=c&&fd(c,m);switch(g.type==="valueUpdate"&&g.source==="external"&&!gh(A,b)&&(r.touched=!0,r.dirty=!0,r.validatePromise=null,r.errors=la,r.warnings=la,r.triggerMetaEvent()),g.type){case"reset":if(!c||G){r.touched=!1,r.dirty=!1,r.validatePromise=void 0,r.errors=la,r.warnings=la,r.triggerMetaEvent(),v==null||v(),r.refresh();return}break;case"remove":{if(d&&$y(d,l,p,A,b,g)){r.reRender();return}break}case"setField":{var w=g.data;if(G){"touched"in w&&(r.touched=w.touched),"validating"in w&&!("originRCField"in w)&&(r.validatePromise=w.validating?Promise.resolve([]):null),"errors"in w&&(r.errors=w.errors||la),"warnings"in w&&(r.warnings=w.warnings||la),r.dirty=!0,r.triggerMetaEvent(),r.reRender();return}else if("value"in w&&fd(c,m,!0)){r.reRender();return}if(d&&!m.length&&$y(d,l,p,A,b,g)){r.reRender();return}break}case"dependenciesUpdate":{var S=f.map(Zi);if(S.some(function(Z){return fd(g.relatedFields,Z)})){r.reRender();return}break}default:if(G||(!f.length||m.length||d)&&$y(d,l,p,A,b,g)){r.reRender();return}break}d===!0&&r.reRender()}),we(Zn(r),"validateRules",function(l){var c=r.getNamePath(),g=r.getValue(),u=l||{},d=u.triggerName,C=u.validateOnly,f=C===void 0?!1:C,v=Promise.resolve().then(Tg(Xr().mark(function p(){var m,A,b,G,w,S,Z;return Xr().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(r.mounted){R.next=2;break}return R.abrupt("return",[]);case 2:if(m=r.props,A=m.validateFirst,b=A===void 0?!1:A,G=m.messageVariables,w=m.validateDebounce,S=r.getRules(),d&&(S=S.filter(function(W){return W}).filter(function(W){var M=W.validateTrigger;if(!M)return!0;var N=Q2(M);return N.includes(d)})),!(w&&d)){R.next=10;break}return R.next=8,new Promise(function(W){setTimeout(W,w)});case 8:if(r.validatePromise===v){R.next=10;break}return R.abrupt("return",[]);case 10:return Z=VQ(c,g,S,l,b,G),Z.catch(function(W){return W}).then(function(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:la;if(r.validatePromise===v){var M;r.validatePromise=null;var N=[],X=[];(M=W.forEach)===null||M===void 0||M.call(W,function(E){var Q=E.rule.warningOnly,k=E.errors,J=k===void 0?la:k;Q?X.push.apply(X,Et(J)):N.push.apply(N,Et(J))}),r.errors=N,r.warnings=X,r.triggerMetaEvent(),r.reRender()}}),R.abrupt("return",Z);case 13:case"end":return R.stop()}},p)})));return f||(r.validatePromise=v,r.dirty=!0,r.errors=la,r.warnings=la,r.triggerMetaEvent(),r.reRender()),v}),we(Zn(r),"isFieldValidating",function(){return!!r.validatePromise}),we(Zn(r),"isFieldTouched",function(){return r.touched}),we(Zn(r),"isFieldDirty",function(){if(r.dirty||r.props.initialValue!==void 0)return!0;var l=r.props.fieldContext,c=l.getInternalHooks(sg),g=c.getInitialValue;return g(r.getNamePath())!==void 0}),we(Zn(r),"getErrors",function(){return r.errors}),we(Zn(r),"getWarnings",function(){return r.warnings}),we(Zn(r),"isListField",function(){return r.props.isListField}),we(Zn(r),"isList",function(){return r.props.isList}),we(Zn(r),"isPreserve",function(){return r.props.preserve}),we(Zn(r),"getMeta",function(){r.prevValidating=r.isFieldValidating();var l={touched:r.isFieldTouched(),validating:r.prevValidating,errors:r.errors,warnings:r.warnings,name:r.getNamePath(),validated:r.validatePromise===null};return l}),we(Zn(r),"getOnlyChild",function(l){if(typeof l=="function"){var c=r.getMeta();return Re(Re({},r.getOnlyChild(l(r.getControlled(),c,r.props.fieldContext))),{},{isFunction:!0})}var g=Rg(l);return g.length!==1||!y.isValidElement(g[0])?{child:g,isFunction:!1}:{child:g[0],isFunction:!1}}),we(Zn(r),"getValue",function(l){var c=r.props.fieldContext.getFieldsValue,g=r.getNamePath();return fs(l||c(!0),g)}),we(Zn(r),"getControlled",function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=r.props,g=c.name,u=c.trigger,d=c.validateTrigger,C=c.getValueFromEvent,f=c.normalize,v=c.valuePropName,p=c.getValueProps,m=c.fieldContext,A=d!==void 0?d:m.validateTrigger,b=r.getNamePath(),G=m.getInternalHooks,w=m.getFieldsValue,S=G(sg),Z=S.dispatch,x=r.getValue(),R=p||function(E){return we({},v,E)},W=l[u],M=g!==void 0?R(x):{},N=Re(Re({},l),M);N[u]=function(){r.touched=!0,r.dirty=!0,r.triggerMetaEvent();for(var E,Q=arguments.length,k=new Array(Q),J=0;J<Q;J++)k[J]=arguments[J];C?E=C.apply(void 0,k):E=HQ.apply(void 0,[v].concat(k)),f&&(E=f(E,x,w(!0))),Z({type:"updateValue",namePath:b,value:E}),W&&W.apply(void 0,k)};var X=Q2(A||[]);return X.forEach(function(E){var Q=N[E];N[E]=function(){Q&&Q.apply(void 0,arguments);var k=r.props.rules;k&&k.length&&Z({type:"validateField",namePath:b,triggerName:E})}}),N}),i.fieldContext){var o=i.fieldContext.getInternalHooks,a=o(sg),s=a.initEntityValue;s(Zn(r))}return r}return Li(n,[{key:"componentDidMount",value:function(){var r=this.props,o=r.shouldUpdate,a=r.fieldContext;if(this.mounted=!0,a){var s=a.getInternalHooks,l=s(sg),c=l.registerField;this.cancelRegisterFunc=c(this)}o===!0&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.triggerMetaEvent(!0),this.mounted=!1}},{key:"reRender",value:function(){this.mounted&&this.forceUpdate()}},{key:"render",value:function(){var r=this.state.resetCount,o=this.props.children,a=this.getOnlyChild(o),s=a.child,l=a.isFunction,c;return l?c=s:y.isValidElement(s)?c=y.cloneElement(s,this.getControlled(s.props)):(Fr(!s,"`children` of Field is not validate ReactElement."),c=s),y.createElement(y.Fragment,{key:r},c)}}]),n}(y.Component);we(mZ,"contextType",Kd);we(mZ,"defaultProps",{trigger:"onChange",valuePropName:"value"});function _E(t){var e=t.name,n=An(t,XQ),i=y.useContext(Kd),r=y.useContext($p),o=e!==void 0?Zi(e):void 0,a="keep";return n.isListField||(a="_".concat((o||[]).join("_"))),y.createElement(mZ,Zt({key:a,name:o,isListField:!!r},n,{fieldContext:i}))}function EQ(t){var e=t.name,n=t.initialValue,i=t.children,r=t.rules,o=t.validateTrigger,a=t.isListField,s=y.useContext(Kd),l=y.useContext($p),c=y.useRef({keys:[],id:0}),g=c.current,u=y.useMemo(function(){var v=Zi(s.prefixName)||[];return[].concat(Et(v),Et(Zi(e)))},[s.prefixName,e]),d=y.useMemo(function(){return Re(Re({},s),{},{prefixName:u})},[s,u]),C=y.useMemo(function(){return{getKey:function(p){var m=u.length,A=p[m];return[g.keys[A],p.slice(m+1)]}}},[u]);if(typeof i!="function")return Fr(!1,"Form.List only accepts function as children."),null;var f=function(p,m,A){var b=A.source;return b==="internal"?!1:p!==m};return y.createElement($p.Provider,{value:C},y.createElement(Kd.Provider,{value:d},y.createElement(_E,{name:[],shouldUpdate:f,rules:r,validateTrigger:o,initialValue:n,isList:!0,isListField:a??!!l},function(v,p){var m=v.value,A=m===void 0?[]:m,b=v.onChange,G=s.getFieldValue,w=function(){var R=G(u||[]);return R||[]},S={add:function(R,W){var M=w();W>=0&&W<=M.length?(g.keys=[].concat(Et(g.keys.slice(0,W)),[g.id],Et(g.keys.slice(W))),b([].concat(Et(M.slice(0,W)),[R],Et(M.slice(W))))):(g.keys=[].concat(Et(g.keys),[g.id]),b([].concat(Et(M),[R]))),g.id+=1},remove:function(R){var W=w(),M=new Set(Array.isArray(R)?R:[R]);M.size<=0||(g.keys=g.keys.filter(function(N,X){return!M.has(X)}),b(W.filter(function(N,X){return!M.has(X)})))},move:function(R,W){if(R!==W){var M=w();R<0||R>=M.length||W<0||W>=M.length||(g.keys=kV(g.keys,R,W),b(kV(M,R,W)))}}},Z=A||[];return Array.isArray(Z)||(Z=[]),i(Z.map(function(x,R){var W=g.keys[R];return W===void 0&&(g.keys[R]=g.id,W=g.keys[R],g.id+=1),{name:R,key:W,isListField:!0}}),S,p)})))}function YQ(t){var e=!1,n=t.length,i=[];return t.length?new Promise(function(r,o){t.forEach(function(a,s){a.catch(function(l){return e=!0,l}).then(function(l){n-=1,i[s]=l,!(n>0)&&(e&&o(i),r(i))})})}):Promise.resolve([])}var kE="__@field_split__";function qy(t){return t.map(function(e){return"".concat(qt(e),":").concat(e)}).join(kE)}var gu=function(){function t(){Ki(this,t),we(this,"kvs",new Map)}return Li(t,[{key:"set",value:function(n,i){this.kvs.set(qy(n),i)}},{key:"get",value:function(n){return this.kvs.get(qy(n))}},{key:"update",value:function(n,i){var r=this.get(n),o=i(r);o?this.set(n,o):this.delete(n)}},{key:"delete",value:function(n){this.kvs.delete(qy(n))}},{key:"map",value:function(n){return Et(this.kvs.entries()).map(function(i){var r=De(i,2),o=r[0],a=r[1],s=o.split(kE);return n({key:s.map(function(l){var c=l.match(/^([^:]*):(.*)$/),g=De(c,3),u=g[1],d=g[2];return u==="number"?Number(d):d}),value:a})})}},{key:"toJSON",value:function(){var n={};return this.map(function(i){var r=i.key,o=i.value;return n[r.join(".")]=o,null}),n}}]),t}(),zQ=["name"],KQ=Li(function t(e){var n=this;Ki(this,t),we(this,"formHooked",!1),we(this,"forceRootUpdate",void 0),we(this,"subscribable",!0),we(this,"store",{}),we(this,"fieldEntities",[]),we(this,"initialValues",{}),we(this,"callbacks",{}),we(this,"validateMessages",null),we(this,"preserve",null),we(this,"lastValidatePromise",null),we(this,"getForm",function(){return{getFieldValue:n.getFieldValue,getFieldsValue:n.getFieldsValue,getFieldError:n.getFieldError,getFieldWarning:n.getFieldWarning,getFieldsError:n.getFieldsError,isFieldsTouched:n.isFieldsTouched,isFieldTouched:n.isFieldTouched,isFieldValidating:n.isFieldValidating,isFieldsValidating:n.isFieldsValidating,resetFields:n.resetFields,setFields:n.setFields,setFieldValue:n.setFieldValue,setFieldsValue:n.setFieldsValue,validateFields:n.validateFields,submit:n.submit,_init:!0,getInternalHooks:n.getInternalHooks}}),we(this,"getInternalHooks",function(i){return i===sg?(n.formHooked=!0,{dispatch:n.dispatch,initEntityValue:n.initEntityValue,registerField:n.registerField,useSubscribe:n.useSubscribe,setInitialValues:n.setInitialValues,destroyForm:n.destroyForm,setCallbacks:n.setCallbacks,setValidateMessages:n.setValidateMessages,getFields:n.getFields,setPreserve:n.setPreserve,getInitialValue:n.getInitialValue,registerWatch:n.registerWatch}):(Fr(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)}),we(this,"useSubscribe",function(i){n.subscribable=i}),we(this,"prevWithoutPreserves",null),we(this,"setInitialValues",function(i,r){if(n.initialValues=i||{},r){var o,a=td(i,n.store);(o=n.prevWithoutPreserves)===null||o===void 0||o.map(function(s){var l=s.key;a=za(a,l,fs(i,l))}),n.prevWithoutPreserves=null,n.updateStore(a)}}),we(this,"destroyForm",function(i){if(i)n.updateStore({});else{var r=new gu;n.getFieldEntities(!0).forEach(function(o){n.isMergedPreserve(o.isPreserve())||r.set(o.getNamePath(),!0)}),n.prevWithoutPreserves=r}}),we(this,"getInitialValue",function(i){var r=fs(n.initialValues,i);return i.length?td(r):r}),we(this,"setCallbacks",function(i){n.callbacks=i}),we(this,"setValidateMessages",function(i){n.validateMessages=i}),we(this,"setPreserve",function(i){n.preserve=i}),we(this,"watchList",[]),we(this,"registerWatch",function(i){return n.watchList.push(i),function(){n.watchList=n.watchList.filter(function(r){return r!==i})}}),we(this,"notifyWatch",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(n.watchList.length){var r=n.getFieldsValue(),o=n.getFieldsValue(!0);n.watchList.forEach(function(a){a(r,o,i)})}}),we(this,"timeoutId",null),we(this,"warningUnhooked",function(){}),we(this,"updateStore",function(i){n.store=i}),we(this,"getFieldEntities",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return i?n.fieldEntities.filter(function(r){return r.getNamePath().length}):n.fieldEntities}),we(this,"getFieldsMap",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=new gu;return n.getFieldEntities(i).forEach(function(o){var a=o.getNamePath();r.set(a,o)}),r}),we(this,"getFieldEntitiesForNamePathList",function(i){if(!i)return n.getFieldEntities(!0);var r=n.getFieldsMap(!0);return i.map(function(o){var a=Zi(o);return r.get(a)||{INVALIDATE_NAME_PATH:Zi(o)}})}),we(this,"getFieldsValue",function(i,r){n.warningUnhooked();var o,a,s;if(i===!0||Array.isArray(i)?(o=i,a=r):i&&qt(i)==="object"&&(s=i.strict,a=i.filter),o===!0&&!a)return n.store;var l=n.getFieldEntitiesForNamePathList(Array.isArray(o)?o:null),c=[];return l.forEach(function(g){var u,d,C="INVALIDATE_NAME_PATH"in g?g.INVALIDATE_NAME_PATH:g.getNamePath();if(s){var f,v;if((f=(v=g).isList)!==null&&f!==void 0&&f.call(v))return}else if(!o&&(u=(d=g).isListField)!==null&&u!==void 0&&u.call(d))return;if(!a)c.push(C);else{var p="getMeta"in g?g.getMeta():null;a(p)&&c.push(C)}}),_V(n.store,c.map(Zi))}),we(this,"getFieldValue",function(i){n.warningUnhooked();var r=Zi(i);return fs(n.store,r)}),we(this,"getFieldsError",function(i){n.warningUnhooked();var r=n.getFieldEntitiesForNamePathList(i);return r.map(function(o,a){return o&&!("INVALIDATE_NAME_PATH"in o)?{name:o.getNamePath(),errors:o.getErrors(),warnings:o.getWarnings()}:{name:Zi(i[a]),errors:[],warnings:[]}})}),we(this,"getFieldError",function(i){n.warningUnhooked();var r=Zi(i),o=n.getFieldsError([r])[0];return o.errors}),we(this,"getFieldWarning",function(i){n.warningUnhooked();var r=Zi(i),o=n.getFieldsError([r])[0];return o.warnings}),we(this,"isFieldsTouched",function(){n.warningUnhooked();for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];var a=r[0],s=r[1],l,c=!1;r.length===0?l=null:r.length===1?Array.isArray(a)?(l=a.map(Zi),c=!1):(l=null,c=a):(l=a.map(Zi),c=s);var g=n.getFieldEntities(!0),u=function(p){return p.isFieldTouched()};if(!l)return c?g.every(function(v){return u(v)||v.isList()}):g.some(u);var d=new gu;l.forEach(function(v){d.set(v,[])}),g.forEach(function(v){var p=v.getNamePath();l.forEach(function(m){m.every(function(A,b){return p[b]===A})&&d.update(m,function(A){return[].concat(Et(A),[v])})})});var C=function(p){return p.some(u)},f=d.map(function(v){var p=v.value;return p});return c?f.every(C):f.some(C)}),we(this,"isFieldTouched",function(i){return n.warningUnhooked(),n.isFieldsTouched([i])}),we(this,"isFieldsValidating",function(i){n.warningUnhooked();var r=n.getFieldEntities();if(!i)return r.some(function(a){return a.isFieldValidating()});var o=i.map(Zi);return r.some(function(a){var s=a.getNamePath();return fd(o,s)&&a.isFieldValidating()})}),we(this,"isFieldValidating",function(i){return n.warningUnhooked(),n.isFieldsValidating([i])}),we(this,"resetWithFieldInitialValue",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=new gu,o=n.getFieldEntities(!0);o.forEach(function(l){var c=l.props.initialValue,g=l.getNamePath();if(c!==void 0){var u=r.get(g)||new Set;u.add({entity:l,value:c}),r.set(g,u)}});var a=function(c){c.forEach(function(g){var u=g.props.initialValue;if(u!==void 0){var d=g.getNamePath(),C=n.getInitialValue(d);if(C!==void 0)Fr(!1,"Form already set 'initialValues' with path '".concat(d.join("."),"'. Field can not overwrite it."));else{var f=r.get(d);if(f&&f.size>1)Fr(!1,"Multiple Field with path '".concat(d.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(f){var v=n.getFieldValue(d),p=g.isListField();!p&&(!i.skipExist||v===void 0)&&n.updateStore(za(n.store,d,Et(f)[0].value))}}}})},s;i.entities?s=i.entities:i.namePathList?(s=[],i.namePathList.forEach(function(l){var c=r.get(l);if(c){var g;(g=s).push.apply(g,Et(Et(c).map(function(u){return u.entity})))}})):s=o,a(s)}),we(this,"resetFields",function(i){n.warningUnhooked();var r=n.store;if(!i){n.updateStore(td(n.initialValues)),n.resetWithFieldInitialValue(),n.notifyObservers(r,null,{type:"reset"}),n.notifyWatch();return}var o=i.map(Zi);o.forEach(function(a){var s=n.getInitialValue(a);n.updateStore(za(n.store,a,s))}),n.resetWithFieldInitialValue({namePathList:o}),n.notifyObservers(r,o,{type:"reset"}),n.notifyWatch(o)}),we(this,"setFields",function(i){n.warningUnhooked();var r=n.store,o=[];i.forEach(function(a){var s=a.name,l=An(a,zQ),c=Zi(s);o.push(c),"value"in l&&n.updateStore(za(n.store,c,l.value)),n.notifyObservers(r,[c],{type:"setField",data:a})}),n.notifyWatch(o)}),we(this,"getFields",function(){var i=n.getFieldEntities(!0),r=i.map(function(o){var a=o.getNamePath(),s=o.getMeta(),l=Re(Re({},s),{},{name:a,value:n.getFieldValue(a)});return Object.defineProperty(l,"originRCField",{value:!0}),l});return r}),we(this,"initEntityValue",function(i){var r=i.props.initialValue;if(r!==void 0){var o=i.getNamePath(),a=fs(n.store,o);a===void 0&&n.updateStore(za(n.store,o,r))}}),we(this,"isMergedPreserve",function(i){var r=i!==void 0?i:n.preserve;return r??!0}),we(this,"registerField",function(i){n.fieldEntities.push(i);var r=i.getNamePath();if(n.notifyWatch([r]),i.props.initialValue!==void 0){var o=n.store;n.resetWithFieldInitialValue({entities:[i],skipExist:!0}),n.notifyObservers(o,[i.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(a,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(n.fieldEntities=n.fieldEntities.filter(function(u){return u!==i}),!n.isMergedPreserve(s)&&(!a||l.length>1)){var c=a?void 0:n.getInitialValue(r);if(r.length&&n.getFieldValue(r)!==c&&n.fieldEntities.every(function(u){return!TE(u.getNamePath(),r)})){var g=n.store;n.updateStore(za(g,r,c,!0)),n.notifyObservers(g,[r],{type:"remove"}),n.triggerDependenciesUpdate(g,r)}}n.notifyWatch([r])}}),we(this,"dispatch",function(i){switch(i.type){case"updateValue":{var r=i.namePath,o=i.value;n.updateValue(r,o);break}case"validateField":{var a=i.namePath,s=i.triggerName;n.validateFields([a],{triggerName:s});break}}}),we(this,"notifyObservers",function(i,r,o){if(n.subscribable){var a=Re(Re({},o),{},{store:n.getFieldsValue(!0)});n.getFieldEntities().forEach(function(s){var l=s.onStoreChange;l(i,r,a)})}else n.forceRootUpdate()}),we(this,"triggerDependenciesUpdate",function(i,r){var o=n.getDependencyChildrenFields(r);return o.length&&n.validateFields(o),n.notifyObservers(i,o,{type:"dependenciesUpdate",relatedFields:[r].concat(Et(o))}),o}),we(this,"updateValue",function(i,r){var o=Zi(i),a=n.store;n.updateStore(za(n.store,o,r)),n.notifyObservers(a,[o],{type:"valueUpdate",source:"internal"}),n.notifyWatch([o]);var s=n.triggerDependenciesUpdate(a,o),l=n.callbacks.onValuesChange;if(l){var c=_V(n.store,[o]);l(c,n.getFieldsValue())}n.triggerOnFieldsChange([o].concat(Et(s)))}),we(this,"setFieldsValue",function(i){n.warningUnhooked();var r=n.store;if(i){var o=td(n.store,i);n.updateStore(o)}n.notifyObservers(r,null,{type:"valueUpdate",source:"external"}),n.notifyWatch()}),we(this,"setFieldValue",function(i,r){n.setFields([{name:i,value:r}])}),we(this,"getDependencyChildrenFields",function(i){var r=new Set,o=[],a=new gu;n.getFieldEntities().forEach(function(l){var c=l.props.dependencies;(c||[]).forEach(function(g){var u=Zi(g);a.update(u,function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Set;return d.add(l),d})})});var s=function l(c){var g=a.get(c)||new Set;g.forEach(function(u){if(!r.has(u)){r.add(u);var d=u.getNamePath();u.isFieldDirty()&&d.length&&(o.push(d),l(d))}})};return s(i),o}),we(this,"triggerOnFieldsChange",function(i,r){var o=n.callbacks.onFieldsChange;if(o){var a=n.getFields();if(r){var s=new gu;r.forEach(function(c){var g=c.name,u=c.errors;s.set(g,u)}),a.forEach(function(c){c.errors=s.get(c.name)||c.errors})}var l=a.filter(function(c){var g=c.name;return fd(i,g)});l.length&&o(l,a)}}),we(this,"validateFields",function(i,r){n.warningUnhooked();var o,a;Array.isArray(i)||typeof i=="string"||typeof r=="string"?(o=i,a=r):a=i;var s=!!o,l=s?o.map(Zi):[],c=[],g=String(Date.now()),u=new Set,d=a||{},C=d.recursive,f=d.dirty;n.getFieldEntities(!0).forEach(function(A){if(s||l.push(A.getNamePath()),!(!A.props.rules||!A.props.rules.length)&&!(f&&!A.isFieldDirty())){var b=A.getNamePath();if(u.add(b.join(g)),!s||fd(l,b,C)){var G=A.validateRules(Re({validateMessages:Re(Re({},LE),n.validateMessages)},a));c.push(G.then(function(){return{name:b,errors:[],warnings:[]}}).catch(function(w){var S,Z=[],x=[];return(S=w.forEach)===null||S===void 0||S.call(w,function(R){var W=R.rule.warningOnly,M=R.errors;W?x.push.apply(x,Et(M)):Z.push.apply(Z,Et(M))}),Z.length?Promise.reject({name:b,errors:Z,warnings:x}):{name:b,errors:Z,warnings:x}}))}}});var v=YQ(c);n.lastValidatePromise=v,v.catch(function(A){return A}).then(function(A){var b=A.map(function(G){var w=G.name;return w});n.notifyObservers(n.store,b,{type:"validateFinish"}),n.triggerOnFieldsChange(b,A)});var p=v.then(function(){return n.lastValidatePromise===v?Promise.resolve(n.getFieldsValue(l)):Promise.reject([])}).catch(function(A){var b=A.filter(function(G){return G&&G.errors.length});return Promise.reject({values:n.getFieldsValue(l),errorFields:b,outOfDate:n.lastValidatePromise!==v})});p.catch(function(A){return A});var m=l.filter(function(A){return u.has(A.join(g))});return n.triggerOnFieldsChange(m),p}),we(this,"submit",function(){n.warningUnhooked(),n.validateFields().then(function(i){var r=n.callbacks.onFinish;if(r)try{r(i)}catch(o){console.error(o)}}).catch(function(i){var r=n.callbacks.onFinishFailed;r&&r(i)})}),this.forceRootUpdate=e});function PE(t){var e=y.useRef(),n=y.useState({}),i=De(n,2),r=i[1];if(!e.current)if(t)e.current=t;else{var o=function(){r({})},a=new KQ(o);e.current=a.getForm()}return[e.current]}var oS=y.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),LQ=function(e){var n=e.validateMessages,i=e.onFormChange,r=e.onFormFinish,o=e.children,a=y.useContext(oS),s=y.useRef({});return y.createElement(oS.Provider,{value:Re(Re({},a),{},{validateMessages:Re(Re({},a.validateMessages),n),triggerFormChange:function(c,g){i&&i(c,{changedFields:g,forms:s.current}),a.triggerFormChange(c,g)},triggerFormFinish:function(c,g){r&&r(c,{values:g,forms:s.current}),a.triggerFormFinish(c,g)},registerForm:function(c,g){c&&(s.current=Re(Re({},s.current),{},we({},c,g))),a.registerForm(c,g)},unregisterForm:function(c){var g=Re({},s.current);delete g[c],s.current=g,a.unregisterForm(c)}})},o)},TQ=["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed","clearOnDestroy"],_Q=function(e,n){var i=e.name,r=e.initialValues,o=e.fields,a=e.form,s=e.preserve,l=e.children,c=e.component,g=c===void 0?"form":c,u=e.validateMessages,d=e.validateTrigger,C=d===void 0?"onChange":d,f=e.onValuesChange,v=e.onFieldsChange,p=e.onFinish,m=e.onFinishFailed,A=e.clearOnDestroy,b=An(e,TQ),G=y.useRef(null),w=y.useContext(oS),S=PE(a),Z=De(S,1),x=Z[0],R=x.getInternalHooks(sg),W=R.useSubscribe,M=R.setInitialValues,N=R.setCallbacks,X=R.setValidateMessages,E=R.setPreserve,Q=R.destroyForm;y.useImperativeHandle(n,function(){return Re(Re({},x),{},{nativeElement:G.current})}),y.useEffect(function(){return w.registerForm(i,x),function(){w.unregisterForm(i)}},[w,x,i]),X(Re(Re({},w.validateMessages),u)),N({onValuesChange:f,onFieldsChange:function(P){if(w.triggerFormChange(i,P),v){for(var $=arguments.length,oe=new Array($>1?$-1:0),ie=1;ie<$;ie++)oe[ie-1]=arguments[ie];v.apply(void 0,[P].concat(oe))}},onFinish:function(P){w.triggerFormFinish(i,P),p&&p(P)},onFinishFailed:m}),E(s);var k=y.useRef(null);M(r,!k.current),k.current||(k.current=!0),y.useEffect(function(){return function(){return Q(A)}},[]);var J,F=typeof l=="function";if(F){var L=x.getFieldsValue(!0);J=l(L,x)}else J=l;W(!F);var z=y.useRef();y.useEffect(function(){FQ(z.current||[],o||[])||x.setFields(o||[]),z.current=o},[o,x]);var K=y.useMemo(function(){return Re(Re({},x),{},{validateTrigger:C})},[x,C]),O=y.createElement($p.Provider,{value:null},y.createElement(Kd.Provider,{value:K},J));return g===!1?O:y.createElement(g,Zt({},b,{ref:G,onSubmit:function(P){P.preventDefault(),P.stopPropagation(),x.submit()},onReset:function(P){var $;P.preventDefault(),x.resetFields(),($=b.onReset)===null||$===void 0||$.call(b,P)}}),O)};function PV(t){try{return JSON.stringify(t)}catch{return Math.random()}}function kQ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=e[0],r=e[1],o=r===void 0?{}:r,a=$4(o)?{form:o}:o,s=a.form,l=y.useState(),c=De(l,2),g=c[0],u=c[1],d=y.useMemo(function(){return PV(g)},[g]),C=y.useRef(d);C.current=d;var f=y.useContext(Kd),v=s||f,p=v&&v._init,m=Zi(i),A=y.useRef(m);return A.current=m,y.useEffect(function(){if(p){var b=v.getFieldsValue,G=v.getInternalHooks,w=G(sg),S=w.registerWatch,Z=function(M,N){var X=a.preserve?N:M;return typeof i=="function"?i(X):fs(X,A.current)},x=S(function(W,M){var N=Z(W,M),X=PV(N);C.current!==X&&(C.current=X,u(N))}),R=Z(b(),b(!0));return g!==R&&u(R),x}},[p]),g}var PQ=y.forwardRef(_Q),$h=PQ;$h.FormProvider=LQ;$h.Field=_E;$h.List=EQ;$h.useForm=PE;$h.useWatch=kQ;const cl=y.createContext({}),UQ=t=>{let{children:e,status:n,override:i}=t;const r=y.useContext(cl),o=y.useMemo(()=>{const a=Object.assign({},r);return i&&delete a.isFormItemInput,n&&(delete a.status,delete a.hasFeedback,delete a.feedbackIcon),a},[n,i,r]);return y.createElement(cl.Provider,{value:o},e)},DQ=y.createContext(void 0),aS=t=>{const{space:e,form:n,children:i}=t;if(i==null)return null;let r=i;return n&&(r=ze.createElement(UQ,{override:!0,status:!0},r)),e&&(r=ze.createElement(fJ,null,r)),r};function UV(t){if(t)return{closable:t.closable,closeIcon:t.closeIcon}}function DV(t){const{closable:e,closeIcon:n}=t||{};return ze.useMemo(()=>{if(!e&&(e===!1||n===!1||n===null))return!1;if(e===void 0&&n===void 0)return null;let i={closeIcon:typeof n!="boolean"&&n!==null?n:void 0};return e&&typeof e=="object"&&(i=Object.assign(Object.assign({},i),e)),i},[e,n])}function OV(){const t={};for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return n.forEach(r=>{r&&Object.keys(r).forEach(o=>{r[o]!==void 0&&(t[o]=r[o])})}),t}const OQ={};function JQ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:OQ;const i=DV(t),r=DV(e),o=typeof i!="boolean"?!!(i!=null&&i.disabled):!1,a=ze.useMemo(()=>Object.assign({closeIcon:ze.createElement(Oh,null)},n),[n]),s=ze.useMemo(()=>i===!1?!1:i?OV(a,r,i):r===!1?!1:r?OV(a,r):a.closable?a:!1,[i,r,a]);return ze.useMemo(()=>{if(s===!1)return[!1,null,o];const{closeIconRender:l}=a,{closeIcon:c}=s;let g=c;if(g!=null){l&&(g=l(c));const u=ll(s,!0);Object.keys(u).length&&(g=ze.isValidElement(g)?ze.cloneElement(g,u):ze.createElement("span",Object.assign({},u),g))}return[!0,g,o]},[s,a])}const QQ=()=>eo()&&window.document.documentElement,vv=t=>{const{prefixCls:e,className:n,style:i,size:r,shape:o}=t,a=qe({[`${e}-lg`]:r==="large",[`${e}-sm`]:r==="small"}),s=qe({[`${e}-circle`]:o==="circle",[`${e}-square`]:o==="square",[`${e}-round`]:o==="round"}),l=y.useMemo(()=>typeof r=="number"?{width:r,height:r,lineHeight:`${r}px`}:{},[r]);return y.createElement("span",{className:qe(e,a,s,n),style:Object.assign(Object.assign({},l),i)})},jQ=new Fn("ant-skeleton-loading",{"0%":{backgroundPosition:"100% 50%"},"100%":{backgroundPosition:"0 50%"}}),bv=t=>({height:t,lineHeight:Je(t)}),md=t=>Object.assign({width:t},bv(t)),$Q=t=>({background:t.skeletonLoadingBackground,backgroundSize:"400% 100%",animationName:jQ,animationDuration:t.skeletonLoadingMotionDuration,animationTimingFunction:"ease",animationIterationCount:"infinite"}),eG=(t,e)=>Object.assign({width:e(t).mul(5).equal(),minWidth:e(t).mul(5).equal()},bv(t)),qQ=t=>{const{skeletonAvatarCls:e,gradientFromColor:n,controlHeight:i,controlHeightLG:r,controlHeightSM:o}=t;return{[e]:Object.assign({display:"inline-block",verticalAlign:"top",background:n},md(i)),[`${e}${e}-circle`]:{borderRadius:"50%"},[`${e}${e}-lg`]:Object.assign({},md(r)),[`${e}${e}-sm`]:Object.assign({},md(o))}},ej=t=>{const{controlHeight:e,borderRadiusSM:n,skeletonInputCls:i,controlHeightLG:r,controlHeightSM:o,gradientFromColor:a,calc:s}=t;return{[i]:Object.assign({display:"inline-block",verticalAlign:"top",background:a,borderRadius:n},eG(e,s)),[`${i}-lg`]:Object.assign({},eG(r,s)),[`${i}-sm`]:Object.assign({},eG(o,s))}},JV=t=>Object.assign({width:t},bv(t)),tj=t=>{const{skeletonImageCls:e,imageSizeBase:n,gradientFromColor:i,borderRadiusSM:r,calc:o}=t;return{[e]:Object.assign(Object.assign({display:"inline-flex",alignItems:"center",justifyContent:"center",verticalAlign:"middle",background:i,borderRadius:r},JV(o(n).mul(2).equal())),{[`${e}-path`]:{fill:"#bfbfbf"},[`${e}-svg`]:Object.assign(Object.assign({},JV(n)),{maxWidth:o(n).mul(4).equal(),maxHeight:o(n).mul(4).equal()}),[`${e}-svg${e}-svg-circle`]:{borderRadius:"50%"}}),[`${e}${e}-circle`]:{borderRadius:"50%"}}},tG=(t,e,n)=>{const{skeletonButtonCls:i}=t;return{[`${n}${i}-circle`]:{width:e,minWidth:e,borderRadius:"50%"},[`${n}${i}-round`]:{borderRadius:e}}},nG=(t,e)=>Object.assign({width:e(t).mul(2).equal(),minWidth:e(t).mul(2).equal()},bv(t)),nj=t=>{const{borderRadiusSM:e,skeletonButtonCls:n,controlHeight:i,controlHeightLG:r,controlHeightSM:o,gradientFromColor:a,calc:s}=t;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({[n]:Object.assign({display:"inline-block",verticalAlign:"top",background:a,borderRadius:e,width:s(i).mul(2).equal(),minWidth:s(i).mul(2).equal()},nG(i,s))},tG(t,i,n)),{[`${n}-lg`]:Object.assign({},nG(r,s))}),tG(t,r,`${n}-lg`)),{[`${n}-sm`]:Object.assign({},nG(o,s))}),tG(t,o,`${n}-sm`))},ij=t=>{const{componentCls:e,skeletonAvatarCls:n,skeletonTitleCls:i,skeletonParagraphCls:r,skeletonButtonCls:o,skeletonInputCls:a,skeletonImageCls:s,controlHeight:l,controlHeightLG:c,controlHeightSM:g,gradientFromColor:u,padding:d,marginSM:C,borderRadius:f,titleHeight:v,blockRadius:p,paragraphLiHeight:m,controlHeightXS:A,paragraphMarginTop:b}=t;return{[e]:{display:"table",width:"100%",[`${e}-header`]:{display:"table-cell",paddingInlineEnd:d,verticalAlign:"top",[n]:Object.assign({display:"inline-block",verticalAlign:"top",background:u},md(l)),[`${n}-circle`]:{borderRadius:"50%"},[`${n}-lg`]:Object.assign({},md(c)),[`${n}-sm`]:Object.assign({},md(g))},[`${e}-content`]:{display:"table-cell",width:"100%",verticalAlign:"top",[i]:{width:"100%",height:v,background:u,borderRadius:p,[`+ ${r}`]:{marginBlockStart:g}},[r]:{padding:0,"> li":{width:"100%",height:m,listStyle:"none",background:u,borderRadius:p,"+ li":{marginBlockStart:A}}},[`${r}> li:last-child:not(:first-child):not(:nth-child(2))`]:{width:"61%"}},[`&-round ${e}-content`]:{[`${i}, ${r} > li`]:{borderRadius:f}}},[`${e}-with-avatar ${e}-content`]:{[i]:{marginBlockStart:C,[`+ ${r}`]:{marginBlockStart:b}}},[`${e}${e}-element`]:Object.assign(Object.assign(Object.assign(Object.assign({display:"inline-block",width:"auto"},nj(t)),qQ(t)),ej(t)),tj(t)),[`${e}${e}-block`]:{width:"100%",[o]:{width:"100%"},[a]:{width:"100%"}},[`${e}${e}-active`]:{[`
        ${i},
        ${r} > li,
        ${n},
        ${o},
        ${a},
        ${s}
      `]:Object.assign({},$Q(t))}}},rj=t=>{const{colorFillContent:e,colorFill:n}=t,i=e,r=n;return{color:i,colorGradientEnd:r,gradientFromColor:i,gradientToColor:r,titleHeight:t.controlHeight/2,blockRadius:t.borderRadiusSM,paragraphMarginTop:t.marginLG+t.marginXXS,paragraphLiHeight:t.controlHeight/2}},qd=yo("Skeleton",t=>{const{componentCls:e,calc:n}=t,i=ci(t,{skeletonAvatarCls:`${e}-avatar`,skeletonTitleCls:`${e}-title`,skeletonParagraphCls:`${e}-paragraph`,skeletonButtonCls:`${e}-button`,skeletonInputCls:`${e}-input`,skeletonImageCls:`${e}-image`,imageSizeBase:n(t.controlHeight).mul(1.5).equal(),borderRadius:100,skeletonLoadingBackground:`linear-gradient(90deg, ${t.gradientFromColor} 25%, ${t.gradientToColor} 37%, ${t.gradientFromColor} 63%)`,skeletonLoadingMotionDuration:"1.4s"});return[ij(i)]},rj,{deprecatedTokens:[["color","gradientFromColor"],["colorGradientEnd","gradientToColor"]]}),oj=t=>{const{prefixCls:e,className:n,rootClassName:i,active:r,shape:o="circle",size:a="default"}=t,{getPrefixCls:s}=y.useContext(yn),l=s("skeleton",e),[c,g,u]=qd(l),d=$a(t,["prefixCls","className"]),C=qe(l,`${l}-element`,{[`${l}-active`]:r},n,i,g,u);return c(y.createElement("div",{className:C},y.createElement(vv,Object.assign({prefixCls:`${l}-avatar`,shape:o,size:a},d))))},aj=t=>{const{prefixCls:e,className:n,rootClassName:i,active:r,block:o=!1,size:a="default"}=t,{getPrefixCls:s}=y.useContext(yn),l=s("skeleton",e),[c,g,u]=qd(l),d=$a(t,["prefixCls"]),C=qe(l,`${l}-element`,{[`${l}-active`]:r,[`${l}-block`]:o},n,i,g,u);return c(y.createElement("div",{className:C},y.createElement(vv,Object.assign({prefixCls:`${l}-button`,size:a},d))))},sj="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",lj=t=>{const{prefixCls:e,className:n,rootClassName:i,style:r,active:o}=t,{getPrefixCls:a}=y.useContext(yn),s=a("skeleton",e),[l,c,g]=qd(s),u=qe(s,`${s}-element`,{[`${s}-active`]:o},n,i,c,g);return l(y.createElement("div",{className:u},y.createElement("div",{className:qe(`${s}-image`,n),style:r},y.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:`${s}-image-svg`},y.createElement("title",null,"Image placeholder"),y.createElement("path",{d:sj,className:`${s}-image-path`})))))},cj=t=>{const{prefixCls:e,className:n,rootClassName:i,active:r,block:o,size:a="default"}=t,{getPrefixCls:s}=y.useContext(yn),l=s("skeleton",e),[c,g,u]=qd(l),d=$a(t,["prefixCls"]),C=qe(l,`${l}-element`,{[`${l}-active`]:r,[`${l}-block`]:o},n,i,g,u);return c(y.createElement("div",{className:C},y.createElement(vv,Object.assign({prefixCls:`${l}-input`,size:a},d))))},gj=t=>{const{prefixCls:e,className:n,rootClassName:i,style:r,active:o,children:a}=t,{getPrefixCls:s}=y.useContext(yn),l=s("skeleton",e),[c,g,u]=qd(l),d=qe(l,`${l}-element`,{[`${l}-active`]:o},g,n,i,u);return c(y.createElement("div",{className:d},y.createElement("div",{className:qe(`${l}-image`,n),style:r},a)))},uj=(t,e)=>{const{width:n,rows:i=2}=e;if(Array.isArray(n))return n[t];if(i-1===t)return n},dj=t=>{const{prefixCls:e,className:n,style:i,rows:r}=t,o=Et(new Array(r)).map((a,s)=>y.createElement("li",{key:s,style:{width:uj(s,t)}}));return y.createElement("ul",{className:qe(e,n),style:i},o)},Ij=t=>{let{prefixCls:e,className:n,width:i,style:r}=t;return y.createElement("h3",{className:qe(e,n),style:Object.assign({width:i},r)})};function iG(t){return t&&typeof t=="object"?t:{}}function Cj(t,e){return t&&!e?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function hj(t,e){return!t&&e?{width:"38%"}:t&&e?{width:"50%"}:{}}function fj(t,e){const n={};return(!t||!e)&&(n.width="61%"),!t&&e?n.rows=3:n.rows=2,n}const _g=t=>{const{prefixCls:e,loading:n,className:i,rootClassName:r,style:o,children:a,avatar:s=!1,title:l=!0,paragraph:c=!0,active:g,round:u}=t,{getPrefixCls:d,direction:C,skeleton:f}=y.useContext(yn),v=d("skeleton",e),[p,m,A]=qd(v);if(n||!("loading"in t)){const b=!!s,G=!!l,w=!!c;let S;if(b){const R=Object.assign(Object.assign({prefixCls:`${v}-avatar`},Cj(G,w)),iG(s));S=y.createElement("div",{className:`${v}-header`},y.createElement(vv,Object.assign({},R)))}let Z;if(G||w){let R;if(G){const M=Object.assign(Object.assign({prefixCls:`${v}-title`},hj(b,w)),iG(l));R=y.createElement(Ij,Object.assign({},M))}let W;if(w){const M=Object.assign(Object.assign({prefixCls:`${v}-paragraph`},fj(b,G)),iG(c));W=y.createElement(dj,Object.assign({},M))}Z=y.createElement("div",{className:`${v}-content`},R,W)}const x=qe(v,{[`${v}-with-avatar`]:b,[`${v}-active`]:g,[`${v}-rtl`]:C==="rtl",[`${v}-round`]:u},f==null?void 0:f.className,i,r,m,A);return p(y.createElement("div",{className:x,style:Object.assign(Object.assign({},f==null?void 0:f.style),o)},S,Z))}return a??null};_g.Button=aj;_g.Avatar=oj;_g.Input=cj;_g.Image=lj;_g.Node=gj;function QV(){}const mj=y.createContext({add:QV,remove:QV});function Aj(t){const e=y.useContext(mj),n=y.useRef();return Xi(r=>{if(r){const o=t?r.querySelector(t):r;e.add(o),n.current=o}else e.remove(n.current)})}const jV=()=>{const{cancelButtonProps:t,cancelTextLocale:e,onCancel:n}=y.useContext(Qh);return ze.createElement(nr,Object.assign({onClick:n},t),e)},$V=()=>{const{confirmLoading:t,okButtonProps:e,okType:n,okTextLocale:i,onOk:r}=y.useContext(Qh);return ze.createElement(nr,Object.assign({},GE(n),{loading:t,onClick:r},e),i)};function UE(t,e){return ze.createElement("span",{className:`${t}-close-x`},e||ze.createElement(Oh,{className:`${t}-close-icon`}))}const DE=t=>{const{okText:e,okType:n="primary",cancelText:i,confirmLoading:r,onOk:o,onCancel:a,okButtonProps:s,cancelButtonProps:l,footer:c}=t,[g]=Uh("Modal",HX()),u=e||(g==null?void 0:g.okText),d=i||(g==null?void 0:g.cancelText),C={confirmLoading:r,okButtonProps:s,cancelButtonProps:l,okTextLocale:u,cancelTextLocale:d,okType:n,onOk:o,onCancel:a},f=ze.useMemo(()=>C,Et(Object.values(C)));let v;return typeof c=="function"||typeof c>"u"?(v=ze.createElement(ze.Fragment,null,ze.createElement(jV,null),ze.createElement($V,null)),typeof c=="function"&&(v=c(v,{OkBtn:$V,CancelBtn:jV})),v=ze.createElement(NE,{value:f},v)):v=c,ze.createElement(TX,{disabled:!1},v)};function qV(t){return{position:t,inset:0}}const pj=t=>{const{componentCls:e,antCls:n}=t;return[{[`${e}-root`]:{[`${e}${n}-zoom-enter, ${e}${n}-zoom-appear`]:{transform:"none",opacity:0,animationDuration:t.motionDurationSlow,userSelect:"none"},[`${e}${n}-zoom-leave ${e}-content`]:{pointerEvents:"none"},[`${e}-mask`]:Object.assign(Object.assign({},qV("fixed")),{zIndex:t.zIndexPopupBase,height:"100%",backgroundColor:t.colorBgMask,pointerEvents:"none",[`${e}-hidden`]:{display:"none"}}),[`${e}-wrap`]:Object.assign(Object.assign({},qV("fixed")),{zIndex:t.zIndexPopupBase,overflow:"auto",outline:0,WebkitOverflowScrolling:"touch"})}},{[`${e}-root`]:XJ(t)}]},vj=t=>{const{componentCls:e}=t;return[{[`${e}-root`]:{[`${e}-wrap-rtl`]:{direction:"rtl"},[`${e}-centered`]:{textAlign:"center","&::before":{display:"inline-block",width:0,height:"100%",verticalAlign:"middle",content:'""'},[e]:{top:0,display:"inline-block",paddingBottom:0,textAlign:"start",verticalAlign:"middle"}},[`@media (max-width: ${t.screenSMMax}px)`]:{[e]:{maxWidth:"calc(100vw - 16px)",margin:`${Je(t.marginXS)} auto`},[`${e}-centered`]:{[e]:{flex:1}}}}},{[e]:Object.assign(Object.assign({},ba(t)),{pointerEvents:"none",position:"relative",top:100,width:"auto",maxWidth:`calc(100vw - ${Je(t.calc(t.margin).mul(2).equal())})`,margin:"0 auto",paddingBottom:t.paddingLG,[`${e}-title`]:{margin:0,color:t.titleColor,fontWeight:t.fontWeightStrong,fontSize:t.titleFontSize,lineHeight:t.titleLineHeight,wordWrap:"break-word"},[`${e}-content`]:{position:"relative",backgroundColor:t.contentBg,backgroundClip:"padding-box",border:0,borderRadius:t.borderRadiusLG,boxShadow:t.boxShadow,pointerEvents:"auto",padding:t.contentPadding},[`${e}-close`]:Object.assign({position:"absolute",top:t.calc(t.modalHeaderHeight).sub(t.modalCloseBtnSize).div(2).equal(),insetInlineEnd:t.calc(t.modalHeaderHeight).sub(t.modalCloseBtnSize).div(2).equal(),zIndex:t.calc(t.zIndexPopupBase).add(10).equal(),padding:0,color:t.modalCloseIconColor,fontWeight:t.fontWeightStrong,lineHeight:1,textDecoration:"none",background:"transparent",borderRadius:t.borderRadiusSM,width:t.modalCloseBtnSize,height:t.modalCloseBtnSize,border:0,outline:0,cursor:"pointer",transition:`color ${t.motionDurationMid}, background-color ${t.motionDurationMid}`,"&-x":{display:"flex",fontSize:t.fontSizeLG,fontStyle:"normal",lineHeight:Je(t.modalCloseBtnSize),justifyContent:"center",textTransform:"none",textRendering:"auto"},"&:disabled":{pointerEvents:"none"},"&:hover":{color:t.modalCloseIconHoverColor,backgroundColor:t.colorBgTextHover,textDecoration:"none"},"&:active":{backgroundColor:t.colorBgTextActive}},Dh(t)),[`${e}-header`]:{color:t.colorText,background:t.headerBg,borderRadius:`${Je(t.borderRadiusLG)} ${Je(t.borderRadiusLG)} 0 0`,marginBottom:t.headerMarginBottom,padding:t.headerPadding,borderBottom:t.headerBorderBottom},[`${e}-body`]:{fontSize:t.fontSize,lineHeight:t.lineHeight,wordWrap:"break-word",padding:t.bodyPadding,[`${e}-body-skeleton`]:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",margin:`${Je(t.margin)} auto`}},[`${e}-footer`]:{textAlign:"end",background:t.footerBg,marginTop:t.footerMarginTop,padding:t.footerPadding,borderTop:t.footerBorderTop,borderRadius:t.footerBorderRadius,[`> ${t.antCls}-btn + ${t.antCls}-btn`]:{marginInlineStart:t.marginXS}},[`${e}-open`]:{overflow:"hidden"}})},{[`${e}-pure-panel`]:{top:"auto",padding:0,display:"flex",flexDirection:"column",[`${e}-content,
          ${e}-body,
          ${e}-confirm-body-wrapper`]:{display:"flex",flexDirection:"column",flex:"auto"},[`${e}-confirm-body`]:{marginBottom:"auto"}}}]},bj=t=>{const{componentCls:e}=t;return{[`${e}-root`]:{[`${e}-wrap-rtl`]:{direction:"rtl",[`${e}-confirm-body`]:{direction:"rtl"}}}}},OE=t=>{const e=t.padding,n=t.fontSizeHeading5,i=t.lineHeightHeading5;return ci(t,{modalHeaderHeight:t.calc(t.calc(i).mul(n).equal()).add(t.calc(e).mul(2).equal()).equal(),modalFooterBorderColorSplit:t.colorSplit,modalFooterBorderStyle:t.lineType,modalFooterBorderWidth:t.lineWidth,modalCloseIconColor:t.colorIcon,modalCloseIconHoverColor:t.colorIconHover,modalCloseBtnSize:t.controlHeight,modalConfirmIconSize:t.fontHeight,modalTitleHeight:t.calc(t.titleFontSize).mul(t.titleLineHeight).equal()})},JE=t=>({footerBg:"transparent",headerBg:t.colorBgElevated,titleLineHeight:t.lineHeightHeading5,titleFontSize:t.fontSizeHeading5,contentBg:t.colorBgElevated,titleColor:t.colorTextHeading,contentPadding:t.wireframe?0:`${Je(t.paddingMD)} ${Je(t.paddingContentHorizontalLG)}`,headerPadding:t.wireframe?`${Je(t.padding)} ${Je(t.paddingLG)}`:0,headerBorderBottom:t.wireframe?`${Je(t.lineWidth)} ${t.lineType} ${t.colorSplit}`:"none",headerMarginBottom:t.wireframe?0:t.marginXS,bodyPadding:t.wireframe?t.paddingLG:0,footerPadding:t.wireframe?`${Je(t.paddingXS)} ${Je(t.padding)}`:0,footerBorderTop:t.wireframe?`${Je(t.lineWidth)} ${t.lineType} ${t.colorSplit}`:"none",footerBorderRadius:t.wireframe?`0 0 ${Je(t.borderRadiusLG)} ${Je(t.borderRadiusLG)}`:0,footerMarginTop:t.wireframe?0:t.marginSM,confirmBodyPadding:t.wireframe?`${Je(t.padding*2)} ${Je(t.padding*2)} ${Je(t.paddingLG)}`:0,confirmIconMarginInlineEnd:t.wireframe?t.margin:t.marginSM,confirmBtnsMarginTop:t.wireframe?t.marginLG:t.marginSM}),QE=yo("Modal",t=>{const e=OE(t);return[vj(e),bj(e),pj(e),l4(e,"zoom")]},JE,{unitless:{titleLineHeight:!0}});var yj=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};let sS;const Gj=t=>{sS={x:t.pageX,y:t.pageY},setTimeout(()=>{sS=null},100)};QQ()&&document.documentElement.addEventListener("click",Gj,!0);const jE=t=>{var e;const{getPopupContainer:n,getPrefixCls:i,direction:r,modal:o}=y.useContext(yn),a=j=>{const{onCancel:P}=t;P==null||P(j)},s=j=>{const{onOk:P}=t;P==null||P(j)},{prefixCls:l,className:c,rootClassName:g,open:u,wrapClassName:d,centered:C,getContainer:f,focusTriggerAfterClose:v=!0,style:p,visible:m,width:A=520,footer:b,classNames:G,styles:w,children:S,loading:Z}=t,x=yj(t,["prefixCls","className","rootClassName","open","wrapClassName","centered","getContainer","focusTriggerAfterClose","style","visible","width","footer","classNames","styles","children","loading"]),R=i("modal",l),W=i(),M=Lg(R),[N,X,E]=QE(R,M),Q=qe(d,{[`${R}-centered`]:!!C,[`${R}-wrap-rtl`]:r==="rtl"}),k=b!==null&&!Z?y.createElement(DE,Object.assign({},t,{onOk:s,onCancel:a})):null,[J,F,L]=JQ(UV(t),UV(o),{closable:!0,closeIcon:y.createElement(Oh,{className:`${R}-close-icon`}),closeIconRender:j=>UE(R,j)}),z=Aj(`.${R}-content`),[K,O]=hE("Modal",x.zIndex);return N(y.createElement(aS,{form:!0,space:!0},y.createElement(IE.Provider,{value:O},y.createElement(zE,Object.assign({width:A},x,{zIndex:K,getContainer:f===void 0?n:f,prefixCls:R,rootClassName:qe(X,g,E,M),footer:k,visible:u??m,mousePosition:(e=x.mousePosition)!==null&&e!==void 0?e:sS,onClose:a,closable:J&&{disabled:L,closeIcon:F},closeIcon:F,focusTriggerAfterClose:v,transitionName:Yd(W,"zoom",t.transitionName),maskTransitionName:Yd(W,"fade",t.maskTransitionName),className:qe(X,c,o==null?void 0:o.className),style:Object.assign(Object.assign({},o==null?void 0:o.style),p),classNames:Object.assign(Object.assign(Object.assign({},o==null?void 0:o.classNames),G),{wrapper:qe(Q,G==null?void 0:G.wrapper)}),styles:Object.assign(Object.assign({},o==null?void 0:o.styles),w),panelRef:z}),Z?y.createElement(_g,{active:!0,title:!1,paragraph:{rows:4},className:`${R}-body-skeleton`}):S))))},Bj=t=>{const{componentCls:e,titleFontSize:n,titleLineHeight:i,modalConfirmIconSize:r,fontSize:o,lineHeight:a,modalTitleHeight:s,fontHeight:l,confirmBodyPadding:c}=t,g=`${e}-confirm`;return{[g]:{"&-rtl":{direction:"rtl"},[`${t.antCls}-modal-header`]:{display:"none"},[`${g}-body-wrapper`]:Object.assign({},jd()),[`&${e} ${e}-body`]:{padding:c},[`${g}-body`]:{display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${t.iconCls}`]:{flex:"none",fontSize:r,marginInlineEnd:t.confirmIconMarginInlineEnd,marginTop:t.calc(t.calc(l).sub(r).equal()).div(2).equal()},[`&-has-title > ${t.iconCls}`]:{marginTop:t.calc(t.calc(s).sub(r).equal()).div(2).equal()}},[`${g}-paragraph`]:{display:"flex",flexDirection:"column",flex:"auto",rowGap:t.marginXS},[`${t.iconCls} + ${g}-paragraph`]:{maxWidth:`calc(100% - ${Je(t.calc(t.modalConfirmIconSize).add(t.marginSM).equal())})`},[`${g}-title`]:{color:t.colorTextHeading,fontWeight:t.fontWeightStrong,fontSize:n,lineHeight:i},[`${g}-content`]:{color:t.colorText,fontSize:o,lineHeight:a},[`${g}-btns`]:{textAlign:"end",marginTop:t.confirmBtnsMarginTop,[`${t.antCls}-btn + ${t.antCls}-btn`]:{marginBottom:0,marginInlineStart:t.marginXS}}},[`${g}-error ${g}-body > ${t.iconCls}`]:{color:t.colorError},[`${g}-warning ${g}-body > ${t.iconCls},
        ${g}-confirm ${g}-body > ${t.iconCls}`]:{color:t.colorWarning},[`${g}-info ${g}-body > ${t.iconCls}`]:{color:t.colorInfo},[`${g}-success ${g}-body > ${t.iconCls}`]:{color:t.colorSuccess}}},Sj=iZ(["Modal","confirm"],t=>{const e=OE(t);return[Bj(e)]},JE,{order:-1e3});var wj=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function $E(t){const{prefixCls:e,icon:n,okText:i,cancelText:r,confirmPrefixCls:o,type:a,okCancel:s,footer:l,locale:c}=t,g=wj(t,["prefixCls","icon","okText","cancelText","confirmPrefixCls","type","okCancel","footer","locale"]);let u=n;if(!n&&n!==null)switch(a){case"info":u=y.createElement(YO,null);break;case"success":u=y.createElement(xO,null);break;case"error":u=y.createElement(oZ,null);break;default:u=y.createElement(HO,null)}const d=s??a==="confirm",C=t.autoFocusButton===null?!1:t.autoFocusButton||"ok",[f]=Uh("Modal"),v=c||f,p=i||(d?v==null?void 0:v.okText:v==null?void 0:v.justOkText),m=r||(v==null?void 0:v.cancelText),A=Object.assign({autoFocusButton:C,cancelTextLocale:m,okTextLocale:p,mergedOkCancel:d},g),b=y.useMemo(()=>A,Et(Object.values(A))),G=y.createElement(y.Fragment,null,y.createElement(ZV,null),y.createElement(xV,null)),w=t.title!==void 0&&t.title!==null,S=`${o}-body`;return y.createElement("div",{className:`${o}-body-wrapper`},y.createElement("div",{className:qe(S,{[`${S}-has-title`]:w})},u,y.createElement("div",{className:`${o}-paragraph`},w&&y.createElement("span",{className:`${o}-title`},t.title),y.createElement("div",{className:`${o}-content`},t.content))),l===void 0||typeof l=="function"?y.createElement(NE,{value:b},y.createElement("div",{className:`${o}-btns`},typeof l=="function"?l(G,{OkBtn:xV,CancelBtn:ZV}):G)):l,y.createElement(Sj,{prefixCls:e}))}const Zj=t=>{const{close:e,zIndex:n,afterClose:i,open:r,keyboard:o,centered:a,getContainer:s,maskStyle:l,direction:c,prefixCls:g,wrapClassName:u,rootPrefixCls:d,bodyStyle:C,closable:f=!1,closeIcon:v,modalRender:p,focusTriggerAfterClose:m,onConfirm:A,styles:b}=t,G=`${g}-confirm`,w=t.width||416,S=t.style||{},Z=t.mask===void 0?!0:t.mask,x=t.maskClosable===void 0?!1:t.maskClosable,R=qe(G,`${G}-${t.type}`,{[`${G}-rtl`]:c==="rtl"},t.className),[,W]=Qo(),M=y.useMemo(()=>n!==void 0?n:W.zIndexPopupBase+JO,[n,W]);return y.createElement(jE,{prefixCls:g,className:R,wrapClassName:qe({[`${G}-centered`]:!!t.centered},u),onCancel:()=>{e==null||e({triggerCancel:!0}),A==null||A(!1)},open:r,title:"",footer:null,transitionName:Yd(d||"","zoom",t.transitionName),maskTransitionName:Yd(d||"","fade",t.maskTransitionName),mask:Z,maskClosable:x,style:S,styles:Object.assign({body:C,mask:l},b),width:w,zIndex:M,afterClose:i,keyboard:o,centered:a,getContainer:s,closable:f,closeIcon:v,modalRender:p,focusTriggerAfterClose:m},y.createElement($E,Object.assign({},t,{confirmPrefixCls:G})))},qE=t=>{const{rootPrefixCls:e,iconPrefixCls:n,direction:i,theme:r}=t;return y.createElement(hc,{prefixCls:e,iconPrefixCls:n,direction:i,theme:r},y.createElement(Zj,Object.assign({},t)))},lg=[];let eY="";function tY(){return eY}const xj=t=>{var e,n;const{prefixCls:i,getContainer:r,direction:o}=t,a=HX(),s=y.useContext(yn),l=tY()||s.getPrefixCls(),c=i||`${l}-modal`;let g=r;return g===!1&&(g=void 0),ze.createElement(qE,Object.assign({},t,{rootPrefixCls:l,prefixCls:c,iconPrefixCls:s.iconPrefixCls,theme:s.theme,direction:o??s.direction,locale:(n=(e=s.locale)===null||e===void 0?void 0:e.Modal)!==null&&n!==void 0?n:a,getContainer:g}))};function qh(t){const e=CO(),n=document.createDocumentFragment();let i=Object.assign(Object.assign({},t),{close:s,open:!0}),r;function o(){for(var c,g=arguments.length,u=new Array(g),d=0;d<g;d++)u[d]=arguments[d];if(u.some(v=>v==null?void 0:v.triggerCancel)){var f;(c=t.onCancel)===null||c===void 0||(f=c).call.apply(f,[t,()=>{}].concat(Et(u.slice(1))))}for(let v=0;v<lg.length;v++)if(lg[v]===s){lg.splice(v,1);break}pE(n)}function a(c){clearTimeout(r),r=setTimeout(()=>{const g=e.getPrefixCls(void 0,tY()),u=e.getIconPrefixCls(),d=e.getTheme(),C=ze.createElement(xj,Object.assign({},c));AE(ze.createElement(hc,{prefixCls:g,iconPrefixCls:u,theme:d},e.holderRender?e.holderRender(C):C),n)})}function s(){for(var c=arguments.length,g=new Array(c),u=0;u<c;u++)g[u]=arguments[u];i=Object.assign(Object.assign({},i),{open:!1,afterClose:()=>{typeof t.afterClose=="function"&&t.afterClose(),o.apply(this,g)}}),i.visible&&delete i.visible,a(i)}function l(c){typeof c=="function"?i=c(i):i=Object.assign(Object.assign({},i),c),a(i)}return a(i),lg.push(s),{destroy:s,update:l}}function nY(t){return Object.assign(Object.assign({},t),{type:"warning"})}function iY(t){return Object.assign(Object.assign({},t),{type:"info"})}function rY(t){return Object.assign(Object.assign({},t),{type:"success"})}function oY(t){return Object.assign(Object.assign({},t),{type:"error"})}function aY(t){return Object.assign(Object.assign({},t),{type:"confirm"})}function Rj(t){let{rootPrefixCls:e}=t;eY=e}var Wj=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const Vj=(t,e)=>{var n,{afterClose:i,config:r}=t,o=Wj(t,["afterClose","config"]);const[a,s]=y.useState(!0),[l,c]=y.useState(r),{direction:g,getPrefixCls:u}=y.useContext(yn),d=u("modal"),C=u(),f=()=>{var A;i(),(A=l.afterClose)===null||A===void 0||A.call(l)},v=function(){var A;s(!1);for(var b=arguments.length,G=new Array(b),w=0;w<b;w++)G[w]=arguments[w];if(G.some(x=>x==null?void 0:x.triggerCancel)){var Z;(A=l.onCancel)===null||A===void 0||(Z=A).call.apply(Z,[l,()=>{}].concat(Et(G.slice(1))))}};y.useImperativeHandle(e,()=>({destroy:v,update:A=>{c(b=>Object.assign(Object.assign({},b),A))}}));const p=(n=l.okCancel)!==null&&n!==void 0?n:l.type==="confirm",[m]=Uh("Modal",Wg.Modal);return y.createElement(qE,Object.assign({prefixCls:d,rootPrefixCls:C},l,{close:v,open:a,afterClose:f,okText:l.okText||(p?m==null?void 0:m.okText:m==null?void 0:m.justOkText),direction:l.direction||g,cancelText:l.cancelText||(m==null?void 0:m.cancelText)},o))},Mj=y.forwardRef(Vj);let eM=0;const Nj=y.memo(y.forwardRef((t,e)=>{const[n,i]=$O();return y.useImperativeHandle(e,()=>({patchElement:i}),[]),y.createElement(y.Fragment,null,n)}));function Fj(){const t=y.useRef(null),[e,n]=y.useState([]);y.useEffect(()=>{e.length&&(Et(e).forEach(a=>{a()}),n([]))},[e]);const i=y.useCallback(o=>function(s){var l;eM+=1;const c=y.createRef();let g;const u=new Promise(p=>{g=p});let d=!1,C;const f=y.createElement(Mj,{key:`modal-${eM}`,config:o(s),ref:c,afterClose:()=>{C==null||C()},isSilent:()=>d,onConfirm:p=>{g(p)}});return C=(l=t.current)===null||l===void 0?void 0:l.patchElement(f),C&&lg.push(C),{destroy:()=>{function p(){var m;(m=c.current)===null||m===void 0||m.destroy()}c.current?p():n(m=>[].concat(Et(m),[p]))},update:p=>{function m(){var A;(A=c.current)===null||A===void 0||A.update(p)}c.current?m():n(A=>[].concat(Et(A),[m]))},then:p=>(d=!0,u.then(p))}},[]);return[y.useMemo(()=>({info:i(iY),success:i(rY),error:i(oY),warning:i(nY),confirm:i(aY)}),[]),y.createElement(Nj,{key:"modal-holder",ref:t})]}function sY(t){return e=>y.createElement(hc,{theme:{token:{motion:!1,zIndexPopupBase:0}}},y.createElement(t,Object.assign({},e)))}const Hj=(t,e,n,i)=>sY(o=>{const{prefixCls:a,style:s}=o,l=y.useRef(null),[c,g]=y.useState(0),[u,d]=y.useState(0),[C,f]=$r(!1,{value:o.open}),{getPrefixCls:v}=y.useContext(yn),p=v("select",a);y.useEffect(()=>{if(f(!0),typeof ResizeObserver<"u"){const b=new ResizeObserver(w=>{const S=w[0].target;g(S.offsetHeight+8),d(S.offsetWidth)}),G=setInterval(()=>{var w;const S=`.${p}-dropdown`,Z=(w=l.current)===null||w===void 0?void 0:w.querySelector(S);Z&&(clearInterval(G),b.observe(Z))},10);return()=>{clearInterval(G),b.disconnect()}}},[]);let m=Object.assign(Object.assign({},o),{style:Object.assign(Object.assign({},s),{margin:0}),open:C,visible:C,getPopupContainer:()=>l.current});const A={paddingBottom:c,position:"relative",minWidth:u};return y.createElement("div",{ref:l,style:A},y.createElement(t,Object.assign({},m)))}),AZ=function(){if(typeof navigator>"u"||typeof window>"u")return!1;var t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(t==null?void 0:t.substr(0,4))};var yv=function(e){var n=e.className,i=e.customizeIcon,r=e.customizeIconProps,o=e.children,a=e.onMouseDown,s=e.onClick,l=typeof i=="function"?i(r):i;return y.createElement("span",{className:n,onMouseDown:function(g){g.preventDefault(),a==null||a(g)},style:{userSelect:"none",WebkitUserSelect:"none"},unselectable:"on",onClick:s,"aria-hidden":!0},l!==void 0?l:y.createElement("span",{className:qe(n.split(/\s+/).map(function(c){return"".concat(c,"-icon")}))},o))},Xj=function(e,n,i,r,o){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,s=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,c=ze.useMemo(function(){if(qt(r)==="object")return r.clearIcon;if(o)return o},[r,o]),g=ze.useMemo(function(){return!!(!a&&r&&(i.length||s)&&!(l==="combobox"&&s===""))},[r,a,i.length,s,l]);return{allowClear:g,clearIcon:ze.createElement(yv,{className:"".concat(e,"-clear"),onMouseDown:n,customizeIcon:c},"")}},lY=y.createContext(null);function Ej(){return y.useContext(lY)}function Yj(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10,e=y.useState(!1),n=De(e,2),i=n[0],r=n[1],o=y.useRef(null),a=function(){window.clearTimeout(o.current)};y.useEffect(function(){return a},[]);var s=function(c,g){a(),o.current=window.setTimeout(function(){r(c),g&&g()},t)};return[i,s,a]}function cY(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:250,e=y.useRef(null),n=y.useRef(null);y.useEffect(function(){return function(){window.clearTimeout(n.current)}},[]);function i(r){(r||e.current===null)&&(e.current=r),window.clearTimeout(n.current),n.current=window.setTimeout(function(){e.current=null},t)}return[function(){return e.current},i]}function zj(t,e,n,i){var r=y.useRef(null);r.current={open:e,triggerOpen:n,customizedTrigger:i},y.useEffect(function(){function o(a){var s;if(!((s=r.current)!==null&&s!==void 0&&s.customizedTrigger)){var l=a.target;l.shadowRoot&&a.composed&&(l=a.composedPath()[0]||l),r.current.open&&t().filter(function(c){return c}).every(function(c){return!c.contains(l)&&c!==l})&&r.current.triggerOpen(!1)}}return window.addEventListener("mousedown",o),function(){return window.removeEventListener("mousedown",o)}},[])}function Kj(t){return![Ct.ESC,Ct.SHIFT,Ct.BACKSPACE,Ct.TAB,Ct.WIN_KEY,Ct.ALT,Ct.META,Ct.WIN_KEY_RIGHT,Ct.CTRL,Ct.SEMICOLON,Ct.EQUALS,Ct.CAPS_LOCK,Ct.CONTEXT_MENU,Ct.F1,Ct.F2,Ct.F3,Ct.F4,Ct.F5,Ct.F6,Ct.F7,Ct.F8,Ct.F9,Ct.F10,Ct.F11,Ct.F12].includes(t)}var Lj=["prefixCls","invalidate","item","renderItem","responsive","responsiveDisabled","registerSize","itemKey","className","style","children","display","order","component"],uu=void 0;function Tj(t,e){var n=t.prefixCls,i=t.invalidate,r=t.item,o=t.renderItem,a=t.responsive,s=t.responsiveDisabled,l=t.registerSize,c=t.itemKey,g=t.className,u=t.style,d=t.children,C=t.display,f=t.order,v=t.component,p=v===void 0?"div":v,m=An(t,Lj),A=a&&!C;function b(x){l(c,x)}y.useEffect(function(){return function(){b(null)}},[]);var G=o&&r!==uu?o(r):d,w;i||(w={opacity:A?0:1,height:A?0:uu,overflowY:A?"hidden":uu,order:a?f:uu,pointerEvents:A?"none":uu,position:A?"absolute":uu});var S={};A&&(S["aria-hidden"]=!0);var Z=y.createElement(p,Zt({className:qe(!i&&n,g),style:Re(Re({},w),u)},S,m,{ref:e}),G);return a&&(Z=y.createElement(Pa,{onResize:function(R){var W=R.offsetWidth;b(W)},disabled:s},Z)),Z}var xC=y.forwardRef(Tj);xC.displayName="Item";function _j(t){if(typeof MessageChannel>"u")Ln(t);else{var e=new MessageChannel;e.port1.onmessage=function(){return t()},e.port2.postMessage(void 0)}}function kj(){var t=y.useRef(null),e=function(i){t.current||(t.current=[],_j(function(){sc.unstable_batchedUpdates(function(){t.current.forEach(function(r){r()}),t.current=null})})),t.current.push(i)};return e}function NI(t,e){var n=y.useState(e),i=De(n,2),r=i[0],o=i[1],a=Xi(function(s){t(function(){o(s)})});return[r,a]}var qp=ze.createContext(null),Pj=["component"],Uj=["className"],Dj=["className"],Oj=function(e,n){var i=y.useContext(qp);if(!i){var r=e.component,o=r===void 0?"div":r,a=An(e,Pj);return y.createElement(o,Zt({},a,{ref:n}))}var s=i.className,l=An(i,Uj),c=e.className,g=An(e,Dj);return y.createElement(qp.Provider,{value:null},y.createElement(xC,Zt({ref:n,className:qe(s,c)},l,g)))},gY=y.forwardRef(Oj);gY.displayName="RawItem";var Jj=["prefixCls","data","renderItem","renderRawItem","itemKey","itemWidth","ssr","style","className","maxCount","renderRest","renderRawRest","suffix","component","itemComponent","onVisibleChange"],uY="responsive",dY="invalidate";function Qj(t){return"+ ".concat(t.length," ...")}function jj(t,e){var n=t.prefixCls,i=n===void 0?"rc-overflow":n,r=t.data,o=r===void 0?[]:r,a=t.renderItem,s=t.renderRawItem,l=t.itemKey,c=t.itemWidth,g=c===void 0?10:c,u=t.ssr,d=t.style,C=t.className,f=t.maxCount,v=t.renderRest,p=t.renderRawRest,m=t.suffix,A=t.component,b=A===void 0?"div":A,G=t.itemComponent,w=t.onVisibleChange,S=An(t,Jj),Z=u==="full",x=kj(),R=NI(x,null),W=De(R,2),M=W[0],N=W[1],X=M||0,E=NI(x,new Map),Q=De(E,2),k=Q[0],J=Q[1],F=NI(x,0),L=De(F,2),z=L[0],K=L[1],O=NI(x,0),j=De(O,2),P=j[0],$=j[1],oe=NI(x,0),ie=De(oe,2),de=ie[0],Ve=ie[1],Se=y.useState(null),me=De(Se,2),T=me[0],Ge=me[1],ne=y.useState(null),he=De(ne,2),ae=he[0],He=he[1],ve=y.useMemo(function(){return ae===null&&Z?Number.MAX_SAFE_INTEGER:ae||0},[ae,M]),Me=y.useState(!1),q=De(Me,2),Y=q[0],Ce=q[1],se="".concat(i,"-item"),fe=Math.max(z,P),Ze=f===uY,Oe=o.length&&Ze,Fe=f===dY,Ee=Oe||typeof f=="number"&&o.length>f,Qe=y.useMemo(function(){var et=o;return Oe?M===null&&Z?et=o:et=o.slice(0,Math.min(o.length,X/g)):typeof f=="number"&&(et=o.slice(0,f)),et},[o,g,M,f,Oe]),Ye=y.useMemo(function(){return Oe?o.slice(ve+1):o.slice(Qe.length)},[o,Qe,Oe,ve]),$e=y.useCallback(function(et,rt){var ut;return typeof l=="function"?l(et):(ut=l&&(et==null?void 0:et[l]))!==null&&ut!==void 0?ut:rt},[l]),st=y.useCallback(a||function(et){return et},[a]);function Ue(et,rt,ut){ae===et&&(rt===void 0||rt===T)||(He(et),ut||(Ce(et<o.length-1),w==null||w(et)),rt!==void 0&&Ge(rt))}function Ne(et,rt){N(rt.clientWidth)}function je(et,rt){J(function(ut){var Tt=new Map(ut);return rt===null?Tt.delete(et):Tt.set(et,rt),Tt})}function Ie(et,rt){$(rt),K(P)}function Te(et,rt){Ve(rt)}function ue(et){return k.get($e(Qe[et],et))}qn(function(){if(X&&typeof fe=="number"&&Qe){var et=de,rt=Qe.length,ut=rt-1;if(!rt){Ue(0,null);return}for(var Tt=0;Tt<rt;Tt+=1){var Ft=ue(Tt);if(Z&&(Ft=Ft||0),Ft===void 0){Ue(Tt-1,void 0,!0);break}if(et+=Ft,ut===0&&et<=X||Tt===ut-1&&et+ue(ut)<=X){Ue(ut,null);break}else if(et+fe>X){Ue(Tt-1,et-Ft-de+P);break}}m&&ue(0)+de>X&&Ge(null)}},[X,k,P,de,$e,Qe]);var Pe=Y&&!!Ye.length,be={};T!==null&&Oe&&(be={position:"absolute",left:T,top:0});var Le={prefixCls:se,responsive:Oe,component:G,invalidate:Fe},ct=s?function(et,rt){var ut=$e(et,rt);return y.createElement(qp.Provider,{key:ut,value:Re(Re({},Le),{},{order:rt,item:et,itemKey:ut,registerSize:je,display:rt<=ve})},s(et,rt))}:function(et,rt){var ut=$e(et,rt);return y.createElement(xC,Zt({},Le,{order:rt,key:ut,item:et,renderItem:st,itemKey:ut,registerSize:je,display:rt<=ve}))},dt,It={order:Pe?ve:Number.MAX_SAFE_INTEGER,className:"".concat(se,"-rest"),registerSize:Ie,display:Pe};if(p)p&&(dt=y.createElement(qp.Provider,{value:Re(Re({},Le),It)},p(Ye)));else{var Vt=v||Qj;dt=y.createElement(xC,Zt({},Le,It),typeof Vt=="function"?Vt(Ye):Vt)}var vt=y.createElement(b,Zt({className:qe(!Fe&&i,C),style:d,ref:e},S),Qe.map(ct),Ee?dt:null,m&&y.createElement(xC,Zt({},Le,{responsive:Ze,responsiveDisabled:!Oe,order:ve,className:"".concat(se,"-suffix"),registerSize:Te,display:!0,style:be}),m));return Ze&&(vt=y.createElement(Pa,{onResize:Ne,disabled:!Oe},vt)),vt}var bs=y.forwardRef(jj);bs.displayName="Overflow";bs.Item=gY;bs.RESPONSIVE=uY;bs.INVALIDATE=dY;var $j=function(e,n){var i,r=e.prefixCls,o=e.id,a=e.inputElement,s=e.disabled,l=e.tabIndex,c=e.autoFocus,g=e.autoComplete,u=e.editable,d=e.activeDescendantId,C=e.value,f=e.maxLength,v=e.onKeyDown,p=e.onMouseDown,m=e.onChange,A=e.onPaste,b=e.onCompositionStart,G=e.onCompositionEnd,w=e.open,S=e.attrs,Z=a||y.createElement("input",null),x=Z,R=x.ref,W=x.props,M=W.onKeyDown,N=W.onChange,X=W.onMouseDown,E=W.onCompositionStart,Q=W.onCompositionEnd,k=W.style;return"maxLength"in Z.props,Z=y.cloneElement(Z,Re(Re(Re({type:"search"},W),{},{id:o,ref:ja(n,R),disabled:s,tabIndex:l,autoComplete:g||"off",autoFocus:c,className:qe("".concat(r,"-selection-search-input"),(i=Z)===null||i===void 0||(i=i.props)===null||i===void 0?void 0:i.className),role:"combobox","aria-expanded":w||!1,"aria-haspopup":"listbox","aria-owns":"".concat(o,"_list"),"aria-autocomplete":"list","aria-controls":"".concat(o,"_list"),"aria-activedescendant":w?d:void 0},S),{},{value:u?C:"",maxLength:f,readOnly:!u,unselectable:u?null:"on",style:Re(Re({},k),{},{opacity:u?null:0}),onKeyDown:function(F){v(F),M&&M(F)},onMouseDown:function(F){p(F),X&&X(F)},onChange:function(F){m(F),N&&N(F)},onCompositionStart:function(F){b(F),E&&E(F)},onCompositionEnd:function(F){G(F),Q&&Q(F)},onPaste:A})),Z},IY=y.forwardRef($j);function CY(t){return Array.isArray(t)?t:t!==void 0?[t]:[]}var qj=typeof window<"u"&&window.document&&window.document.documentElement,e7=qj;function t7(t){return t!=null}function n7(t){return!t&&t!==0}function tM(t){return["string","number"].includes(qt(t))}function hY(t){var e=void 0;return t&&(tM(t.title)?e=t.title.toString():tM(t.label)&&(e=t.label.toString())),e}function i7(t,e){e7?y.useLayoutEffect(t,e):y.useEffect(t,e)}function r7(t){var e;return(e=t.key)!==null&&e!==void 0?e:t.value}var nM=function(e){e.preventDefault(),e.stopPropagation()},o7=function(e){var n=e.id,i=e.prefixCls,r=e.values,o=e.open,a=e.searchValue,s=e.autoClearSearchValue,l=e.inputRef,c=e.placeholder,g=e.disabled,u=e.mode,d=e.showSearch,C=e.autoFocus,f=e.autoComplete,v=e.activeDescendantId,p=e.tabIndex,m=e.removeIcon,A=e.maxTagCount,b=e.maxTagTextLength,G=e.maxTagPlaceholder,w=G===void 0?function(Ge){return"+ ".concat(Ge.length," ...")}:G,S=e.tagRender,Z=e.onToggleOpen,x=e.onRemove,R=e.onInputChange,W=e.onInputPaste,M=e.onInputKeyDown,N=e.onInputMouseDown,X=e.onInputCompositionStart,E=e.onInputCompositionEnd,Q=y.useRef(null),k=y.useState(0),J=De(k,2),F=J[0],L=J[1],z=y.useState(!1),K=De(z,2),O=K[0],j=K[1],P="".concat(i,"-selection"),$=o||u==="multiple"&&s===!1||u==="tags"?a:"",oe=u==="tags"||u==="multiple"&&s===!1||d&&(o||O);i7(function(){L(Q.current.scrollWidth)},[$]);var ie=function(ne,he,ae,He,ve){return y.createElement("span",{title:hY(ne),className:qe("".concat(P,"-item"),we({},"".concat(P,"-item-disabled"),ae))},y.createElement("span",{className:"".concat(P,"-item-content")},he),He&&y.createElement(yv,{className:"".concat(P,"-item-remove"),onMouseDown:nM,onClick:ve,customizeIcon:m},""))},de=function(ne,he,ae,He,ve,Me){var q=function(Ce){nM(Ce),Z(!o)};return y.createElement("span",{onMouseDown:q},S({label:he,value:ne,disabled:ae,closable:He,onClose:ve,isMaxTag:!!Me}))},Ve=function(ne){var he=ne.disabled,ae=ne.label,He=ne.value,ve=!g&&!he,Me=ae;if(typeof b=="number"&&(typeof ae=="string"||typeof ae=="number")){var q=String(Me);q.length>b&&(Me="".concat(q.slice(0,b),"..."))}var Y=function(se){se&&se.stopPropagation(),x(ne)};return typeof S=="function"?de(He,Me,he,ve,Y):ie(ne,Me,he,ve,Y)},Se=function(ne){var he=typeof w=="function"?w(ne):w;return typeof S=="function"?de(void 0,he,!1,!1,void 0,!0):ie({title:he},he,!1)},me=y.createElement("div",{className:"".concat(P,"-search"),style:{width:F},onFocus:function(){j(!0)},onBlur:function(){j(!1)}},y.createElement(IY,{ref:l,open:o,prefixCls:i,id:n,inputElement:null,disabled:g,autoFocus:C,autoComplete:f,editable:oe,activeDescendantId:v,value:$,onKeyDown:M,onMouseDown:N,onChange:R,onPaste:W,onCompositionStart:X,onCompositionEnd:E,tabIndex:p,attrs:ll(e,!0)}),y.createElement("span",{ref:Q,className:"".concat(P,"-search-mirror"),"aria-hidden":!0},$,"")),T=y.createElement(bs,{prefixCls:"".concat(P,"-overflow"),data:r,renderItem:Ve,renderRest:Se,suffix:me,itemKey:r7,maxCount:A});return y.createElement(y.Fragment,null,T,!r.length&&!$&&y.createElement("span",{className:"".concat(P,"-placeholder")},c))},a7=function(e){var n=e.inputElement,i=e.prefixCls,r=e.id,o=e.inputRef,a=e.disabled,s=e.autoFocus,l=e.autoComplete,c=e.activeDescendantId,g=e.mode,u=e.open,d=e.values,C=e.placeholder,f=e.tabIndex,v=e.showSearch,p=e.searchValue,m=e.activeValue,A=e.maxLength,b=e.onInputKeyDown,G=e.onInputMouseDown,w=e.onInputChange,S=e.onInputPaste,Z=e.onInputCompositionStart,x=e.onInputCompositionEnd,R=e.title,W=y.useState(!1),M=De(W,2),N=M[0],X=M[1],E=g==="combobox",Q=E||v,k=d[0],J=p||"";E&&m&&!N&&(J=m),y.useEffect(function(){E&&X(!1)},[E,m]);var F=g!=="combobox"&&!u&&!v?!1:!!J,L=R===void 0?hY(k):R,z=y.useMemo(function(){return k?null:y.createElement("span",{className:"".concat(i,"-selection-placeholder"),style:F?{visibility:"hidden"}:void 0},C)},[k,F,C,i]);return y.createElement(y.Fragment,null,y.createElement("span",{className:"".concat(i,"-selection-search")},y.createElement(IY,{ref:o,prefixCls:i,id:r,open:u,inputElement:n,disabled:a,autoFocus:s,autoComplete:l,editable:Q,activeDescendantId:c,value:J,onKeyDown:b,onMouseDown:G,onChange:function(O){X(!0),w(O)},onPaste:S,onCompositionStart:Z,onCompositionEnd:x,tabIndex:f,attrs:ll(e,!0),maxLength:E?A:void 0})),!E&&k?y.createElement("span",{className:"".concat(i,"-selection-item"),title:L,style:F?{visibility:"hidden"}:void 0},k.label):null,z)},s7=function(e,n){var i=y.useRef(null),r=y.useRef(!1),o=e.prefixCls,a=e.open,s=e.mode,l=e.showSearch,c=e.tokenWithEnter,g=e.disabled,u=e.autoClearSearchValue,d=e.onSearch,C=e.onSearchSubmit,f=e.onToggleOpen,v=e.onInputKeyDown,p=e.domRef;y.useImperativeHandle(n,function(){return{focus:function(F){i.current.focus(F)},blur:function(){i.current.blur()}}});var m=cY(0),A=De(m,2),b=A[0],G=A[1],w=function(F){var L=F.which;(L===Ct.UP||L===Ct.DOWN)&&F.preventDefault(),v&&v(F),L===Ct.ENTER&&s==="tags"&&!r.current&&!a&&(C==null||C(F.target.value)),Kj(L)&&f(!0)},S=function(){G(!0)},Z=y.useRef(null),x=function(F){d(F,!0,r.current)!==!1&&f(!0)},R=function(){r.current=!0},W=function(F){r.current=!1,s!=="combobox"&&x(F.target.value)},M=function(F){var L=F.target.value;if(c&&Z.current&&/[\r\n]/.test(Z.current)){var z=Z.current.replace(/[\r\n]+$/,"").replace(/\r\n/g," ").replace(/[\r\n]/g," ");L=L.replace(z,Z.current)}Z.current=null,x(L)},N=function(F){var L=F.clipboardData,z=L==null?void 0:L.getData("text");Z.current=z||""},X=function(F){var L=F.target;if(L!==i.current){var z=document.body.style.msTouchAction!==void 0;z?setTimeout(function(){i.current.focus()}):i.current.focus()}},E=function(F){var L=b();F.target!==i.current&&!L&&!(s==="combobox"&&g)&&F.preventDefault(),(s!=="combobox"&&(!l||!L)||!a)&&(a&&u!==!1&&d("",!0,!1),f())},Q={inputRef:i,onInputKeyDown:w,onInputMouseDown:S,onInputChange:M,onInputPaste:N,onInputCompositionStart:R,onInputCompositionEnd:W},k=s==="multiple"||s==="tags"?y.createElement(o7,Zt({},e,Q)):y.createElement(a7,Zt({},e,Q));return y.createElement("div",{ref:p,className:"".concat(o,"-selector"),onClick:X,onMouseDown:E},k)},l7=y.forwardRef(s7);function c7(t){var e=t.prefixCls,n=t.align,i=t.arrow,r=t.arrowPos,o=i||{},a=o.className,s=o.content,l=r.x,c=l===void 0?0:l,g=r.y,u=g===void 0?0:g,d=y.useRef();if(!n||!n.points)return null;var C={position:"absolute"};if(n.autoArrow!==!1){var f=n.points[0],v=n.points[1],p=f[0],m=f[1],A=v[0],b=v[1];p===A||!["t","b"].includes(p)?C.top=u:p==="t"?C.top=0:C.bottom=0,m===b||!["l","r"].includes(m)?C.left=c:m==="l"?C.left=0:C.right=0}return y.createElement("div",{ref:d,className:qe("".concat(e,"-arrow"),a),style:C},s)}function g7(t){var e=t.prefixCls,n=t.open,i=t.zIndex,r=t.mask,o=t.motion;return r?y.createElement(Cl,Zt({},o,{motionAppear:!0,visible:n,removeOnLeave:!0}),function(a){var s=a.className;return y.createElement("div",{style:{zIndex:i},className:qe("".concat(e,"-mask"),s)})}):null}var u7=y.memo(function(t){var e=t.children;return e},function(t,e){return e.cache}),d7=y.forwardRef(function(t,e){var n=t.popup,i=t.className,r=t.prefixCls,o=t.style,a=t.target,s=t.onVisibleChanged,l=t.open,c=t.keepDom,g=t.fresh,u=t.onClick,d=t.mask,C=t.arrow,f=t.arrowPos,v=t.align,p=t.motion,m=t.maskMotion,A=t.forceRender,b=t.getPopupContainer,G=t.autoDestroy,w=t.portal,S=t.zIndex,Z=t.onMouseEnter,x=t.onMouseLeave,R=t.onPointerEnter,W=t.ready,M=t.offsetX,N=t.offsetY,X=t.offsetR,E=t.offsetB,Q=t.onAlign,k=t.onPrepare,J=t.stretch,F=t.targetWidth,L=t.targetHeight,z=typeof n=="function"?n():n,K=l||c,O=(b==null?void 0:b.length)>0,j=y.useState(!b||!O),P=De(j,2),$=P[0],oe=P[1];if(qn(function(){!$&&O&&a&&oe(!0)},[$,O,a]),!$)return null;var ie="auto",de={left:"-1000vw",top:"-1000vh",right:ie,bottom:ie};if(W||!l){var Ve,Se=v.points,me=v.dynamicInset||((Ve=v._experimental)===null||Ve===void 0?void 0:Ve.dynamicInset),T=me&&Se[0][1]==="r",Ge=me&&Se[0][0]==="b";T?(de.right=X,de.left=ie):(de.left=M,de.right=ie),Ge?(de.bottom=E,de.top=ie):(de.top=N,de.bottom=ie)}var ne={};return J&&(J.includes("height")&&L?ne.height=L:J.includes("minHeight")&&L&&(ne.minHeight=L),J.includes("width")&&F?ne.width=F:J.includes("minWidth")&&F&&(ne.minWidth=F)),l||(ne.pointerEvents="none"),y.createElement(w,{open:A||K,getContainer:b&&function(){return b(a)},autoDestroy:G},y.createElement(g7,{prefixCls:r,open:l,zIndex:S,mask:d,motion:m}),y.createElement(Pa,{onResize:Q,disabled:!l},function(he){return y.createElement(Cl,Zt({motionAppear:!0,motionEnter:!0,motionLeave:!0,removeOnLeave:!1,forceRender:A,leavedClassName:"".concat(r,"-hidden")},p,{onAppearPrepare:k,onEnterPrepare:k,visible:l,onVisibleChanged:function(He){var ve;p==null||(ve=p.onVisibleChanged)===null||ve===void 0||ve.call(p,He),s(He)}}),function(ae,He){var ve=ae.className,Me=ae.style,q=qe(r,ve,i);return y.createElement("div",{ref:ja(he,e,He),className:q,style:Re(Re(Re(Re({"--arrow-x":"".concat(f.x||0,"px"),"--arrow-y":"".concat(f.y||0,"px")},de),ne),Me),{},{boxSizing:"border-box",zIndex:S},o),onMouseEnter:Z,onMouseLeave:x,onPointerEnter:R,onClick:u},C&&y.createElement(c7,{prefixCls:r,arrow:C,arrowPos:f,align:v}),y.createElement(u7,{cache:!l&&!g},z))})}))}),I7=y.forwardRef(function(t,e){var n=t.children,i=t.getTriggerDOMNode,r=Kg(n),o=y.useCallback(function(s){kw(e,i?i(s):s)},[i]),a=zg(o,n.ref);return r?y.cloneElement(n,{ref:a}):n}),iM=y.createContext(null);function rM(t){return t?Array.isArray(t)?t:[t]:[]}function C7(t,e,n,i){return y.useMemo(function(){var r=rM(n??e),o=rM(i??e),a=new Set(r),s=new Set(o);return t&&(a.has("hover")&&(a.delete("hover"),a.add("click")),s.has("hover")&&(s.delete("hover"),s.add("click"))),[a,s]},[t,e,n,i])}function h7(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;return n?t[0]===e[0]:t[0]===e[0]&&t[1]===e[1]}function f7(t,e,n,i){for(var r=n.points,o=Object.keys(t),a=0;a<o.length;a+=1){var s,l=o[a];if(h7((s=t[l])===null||s===void 0?void 0:s.points,r,i))return"".concat(e,"-placement-").concat(l)}return""}function oM(t,e,n,i){return e||(n?{motionName:"".concat(t,"-").concat(n)}:i?{motionName:i}:null)}function ef(t){return t.ownerDocument.defaultView}function lS(t){for(var e=[],n=t==null?void 0:t.parentElement,i=["hidden","scroll","clip","auto"];n;){var r=ef(n).getComputedStyle(n),o=r.overflowX,a=r.overflowY,s=r.overflow;[o,a,s].some(function(l){return i.includes(l)})&&e.push(n),n=n.parentElement}return e}function fh(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return Number.isNaN(t)?e:t}function FI(t){return fh(parseFloat(t),0)}function aM(t,e){var n=Re({},t);return(e||[]).forEach(function(i){if(!(i instanceof HTMLBodyElement||i instanceof HTMLHtmlElement)){var r=ef(i).getComputedStyle(i),o=r.overflow,a=r.overflowClipMargin,s=r.borderTopWidth,l=r.borderBottomWidth,c=r.borderLeftWidth,g=r.borderRightWidth,u=i.getBoundingClientRect(),d=i.offsetHeight,C=i.clientHeight,f=i.offsetWidth,v=i.clientWidth,p=FI(s),m=FI(l),A=FI(c),b=FI(g),G=fh(Math.round(u.width/f*1e3)/1e3),w=fh(Math.round(u.height/d*1e3)/1e3),S=(f-v-A-b)*G,Z=(d-C-p-m)*w,x=p*w,R=m*w,W=A*G,M=b*G,N=0,X=0;if(o==="clip"){var E=FI(a);N=E*G,X=E*w}var Q=u.x+W-N,k=u.y+x-X,J=Q+u.width+2*N-W-M-S,F=k+u.height+2*X-x-R-Z;n.left=Math.max(n.left,Q),n.top=Math.max(n.top,k),n.right=Math.min(n.right,J),n.bottom=Math.min(n.bottom,F)}}),n}function sM(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n="".concat(e),i=n.match(/^(.*)\%$/);return i?t*(parseFloat(i[1])/100):parseFloat(n)}function lM(t,e){var n=e||[],i=De(n,2),r=i[0],o=i[1];return[sM(t.width,r),sM(t.height,o)]}function cM(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return[t[0],t[1]]}function du(t,e){var n=e[0],i=e[1],r,o;return n==="t"?o=t.y:n==="b"?o=t.y+t.height:o=t.y+t.height/2,i==="l"?r=t.x:i==="r"?r=t.x+t.width:r=t.x+t.width/2,{x:r,y:o}}function wl(t,e){var n={t:"b",b:"t",l:"r",r:"l"};return t.map(function(i,r){return r===e?n[i]||"c":i}).join("")}function m7(t,e,n,i,r,o,a){var s=y.useState({ready:!1,offsetX:0,offsetY:0,offsetR:0,offsetB:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:r[i]||{}}),l=De(s,2),c=l[0],g=l[1],u=y.useRef(0),d=y.useMemo(function(){return e?lS(e):[]},[e]),C=y.useRef({}),f=function(){C.current={}};t||f();var v=Xi(function(){if(e&&n&&t){let ui=function(Cn,Bo){var Ar=arguments.length>2&&arguments[2]!==void 0?arguments[2]:fe,Ba=P.x+Cn,ns=P.y+Bo,Jt=Ba+Ge,Ut=ns+T,Hn=Math.max(Ba,Ar.left),Qn=Math.max(ns,Ar.top),Gn=Math.min(Jt,Ar.right),$o=Math.min(Ut,Ar.bottom);return Math.max(0,(Gn-Hn)*($o-Qn))},Ji=function(){Be=P.y+ut,_=Be+T,te=P.x+rt,ce=te+Ge};var Vs=ui,Yr=Ji,A,b,G,w,S=e,Z=S.ownerDocument,x=ef(S),R=x.getComputedStyle(S),W=R.width,M=R.height,N=R.position,X=S.style.left,E=S.style.top,Q=S.style.right,k=S.style.bottom,J=S.style.overflow,F=Re(Re({},r[i]),o),L=Z.createElement("div");(A=S.parentElement)===null||A===void 0||A.appendChild(L),L.style.left="".concat(S.offsetLeft,"px"),L.style.top="".concat(S.offsetTop,"px"),L.style.position=N,L.style.height="".concat(S.offsetHeight,"px"),L.style.width="".concat(S.offsetWidth,"px"),S.style.left="0",S.style.top="0",S.style.right="auto",S.style.bottom="auto",S.style.overflow="hidden";var z;if(Array.isArray(n))z={x:n[0],y:n[1],width:0,height:0};else{var K,O,j=n.getBoundingClientRect();j.x=(K=j.x)!==null&&K!==void 0?K:j.left,j.y=(O=j.y)!==null&&O!==void 0?O:j.top,z={x:j.x,y:j.y,width:j.width,height:j.height}}var P=S.getBoundingClientRect();P.x=(b=P.x)!==null&&b!==void 0?b:P.left,P.y=(G=P.y)!==null&&G!==void 0?G:P.top;var $=Z.documentElement,oe=$.clientWidth,ie=$.clientHeight,de=$.scrollWidth,Ve=$.scrollHeight,Se=$.scrollTop,me=$.scrollLeft,T=P.height,Ge=P.width,ne=z.height,he=z.width,ae={left:0,top:0,right:oe,bottom:ie},He={left:-me,top:-Se,right:de-me,bottom:Ve-Se},ve=F.htmlRegion,Me="visible",q="visibleFirst";ve!=="scroll"&&ve!==q&&(ve=Me);var Y=ve===q,Ce=aM(He,d),se=aM(ae,d),fe=ve===Me?se:Ce,Ze=Y?se:fe;S.style.left="auto",S.style.top="auto",S.style.right="0",S.style.bottom="0";var Oe=S.getBoundingClientRect();S.style.left=X,S.style.top=E,S.style.right=Q,S.style.bottom=k,S.style.overflow=J,(w=S.parentElement)===null||w===void 0||w.removeChild(L);var Fe=fh(Math.round(Ge/parseFloat(W)*1e3)/1e3),Ee=fh(Math.round(T/parseFloat(M)*1e3)/1e3);if(Fe===0||Ee===0||oh(n)&&!lZ(n))return;var Qe=F.offset,Ye=F.targetOffset,$e=lM(P,Qe),st=De($e,2),Ue=st[0],Ne=st[1],je=lM(z,Ye),Ie=De(je,2),Te=Ie[0],ue=Ie[1];z.x-=Te,z.y-=ue;var Pe=F.points||[],be=De(Pe,2),Le=be[0],ct=be[1],dt=cM(ct),It=cM(Le),Vt=du(z,dt),vt=du(P,It),et=Re({},F),rt=Vt.x-vt.x+Ue,ut=Vt.y-vt.y+Ne,Tt=ui(rt,ut),Ft=ui(rt,ut,se),ft=du(z,["t","l"]),At=du(P,["t","l"]),Gt=du(z,["b","r"]),Bt=du(P,["b","r"]),Yt=F.overflow||{},St=Yt.adjustX,sn=Yt.adjustY,Ot=Yt.shiftX,U=Yt.shiftY,ee=function(Bo){return typeof Bo=="boolean"?Bo:Bo>=0},Be,_,te,ce;Ji();var le=ee(sn),re=It[0]===dt[0];if(le&&It[0]==="t"&&(_>Ze.bottom||C.current.bt)){var xe=ut;re?xe-=T-ne:xe=ft.y-Bt.y-Ne;var Xe=ui(rt,xe),_e=ui(rt,xe,se);Xe>Tt||Xe===Tt&&(!Y||_e>=Ft)?(C.current.bt=!0,ut=xe,Ne=-Ne,et.points=[wl(It,0),wl(dt,0)]):C.current.bt=!1}if(le&&It[0]==="b"&&(Be<Ze.top||C.current.tb)){var We=ut;re?We+=T-ne:We=Gt.y-At.y-Ne;var pt=ui(rt,We),lt=ui(rt,We,se);pt>Tt||pt===Tt&&(!Y||lt>=Ft)?(C.current.tb=!0,ut=We,Ne=-Ne,et.points=[wl(It,0),wl(dt,0)]):C.current.tb=!1}var nt=ee(St),wt=It[1]===dt[1];if(nt&&It[1]==="l"&&(ce>Ze.right||C.current.rl)){var ot=rt;wt?ot-=Ge-he:ot=ft.x-Bt.x-Ue;var bt=ui(ot,ut),Wt=ui(ot,ut,se);bt>Tt||bt===Tt&&(!Y||Wt>=Ft)?(C.current.rl=!0,rt=ot,Ue=-Ue,et.points=[wl(It,1),wl(dt,1)]):C.current.rl=!1}if(nt&&It[1]==="r"&&(te<Ze.left||C.current.lr)){var yt=rt;wt?yt+=Ge-he:yt=Gt.x-At.x-Ue;var ht=ui(yt,ut),Qt=ui(yt,ut,se);ht>Tt||ht===Tt&&(!Y||Qt>=Ft)?(C.current.lr=!0,rt=yt,Ue=-Ue,et.points=[wl(It,1),wl(dt,1)]):C.current.lr=!1}Ji();var zt=Ot===!0?0:Ot;typeof zt=="number"&&(te<se.left&&(rt-=te-se.left-Ue,z.x+he<se.left+zt&&(rt+=z.x-se.left+he-zt)),ce>se.right&&(rt-=ce-se.right-Ue,z.x>se.right-zt&&(rt+=z.x-se.right+zt)));var Pt=U===!0?0:U;typeof Pt=="number"&&(Be<se.top&&(ut-=Be-se.top-Ne,z.y+ne<se.top+Pt&&(ut+=z.y-se.top+ne-Pt)),_>se.bottom&&(ut-=_-se.bottom-Ne,z.y>se.bottom-Pt&&(ut+=z.y-se.bottom+Pt)));var dn=P.x+rt,un=dn+Ge,In=P.y+ut,Ht=In+T,mt=z.x,Lt=mt+he,Rt=z.y,Xt=Rt+ne,en=Math.max(dn,mt),Rn=Math.min(un,Lt),bn=(en+Rn)/2,On=bn-dn,gi=Math.max(In,Rt),ni=Math.min(Ht,Xt),ai=(gi+ni)/2,Vi=ai-In;a==null||a(e,et);var jo=Oe.right-P.x-(rt+P.width),mr=Oe.bottom-P.y-(ut+P.height);Fe===1&&(rt=Math.round(rt),jo=Math.round(jo)),Ee===1&&(ut=Math.round(ut),mr=Math.round(mr));var Go={ready:!0,offsetX:rt/Fe,offsetY:ut/Ee,offsetR:jo/Fe,offsetB:mr/Ee,arrowX:On/Fe,arrowY:Vi/Ee,scaleX:Fe,scaleY:Ee,align:et};g(Go)}}),p=function(){u.current+=1;var b=u.current;Promise.resolve().then(function(){u.current===b&&v()})},m=function(){g(function(b){return Re(Re({},b),{},{ready:!1})})};return qn(m,[i]),qn(function(){t||m()},[t]),[c.ready,c.offsetX,c.offsetY,c.offsetR,c.offsetB,c.arrowX,c.arrowY,c.scaleX,c.scaleY,c.align,p]}function A7(t,e,n,i,r){qn(function(){if(t&&e&&n){let d=function(){i(),r()};var u=d,o=e,a=n,s=lS(o),l=lS(a),c=ef(a),g=new Set([c].concat(Et(s),Et(l)));return g.forEach(function(C){C.addEventListener("scroll",d,{passive:!0})}),c.addEventListener("resize",d,{passive:!0}),i(),function(){g.forEach(function(C){C.removeEventListener("scroll",d),c.removeEventListener("resize",d)})}}},[t,e,n])}function p7(t,e,n,i,r,o,a,s){var l=y.useRef(t);l.current=t,y.useEffect(function(){if(e&&i&&(!r||o)){var c=function(C){var f;l.current&&!a(((f=C.composedPath)===null||f===void 0||(f=f.call(C))===null||f===void 0?void 0:f[0])||C.target)&&s(!1)},g=ef(i);g.addEventListener("mousedown",c,!0),g.addEventListener("contextmenu",c,!0);var u=Op(n);return u&&(u.addEventListener("mousedown",c,!0),u.addEventListener("contextmenu",c,!0)),function(){g.removeEventListener("mousedown",c,!0),g.removeEventListener("contextmenu",c,!0),u&&(u.removeEventListener("mousedown",c,!0),u.removeEventListener("contextmenu",c,!0))}}},[e,n,i,r,o])}var v7=["prefixCls","children","action","showAction","hideAction","popupVisible","defaultPopupVisible","onPopupVisibleChange","afterPopupVisibleChange","mouseEnterDelay","mouseLeaveDelay","focusDelay","blurDelay","mask","maskClosable","getPopupContainer","forceRender","autoDestroy","destroyPopupOnHide","popup","popupClassName","popupStyle","popupPlacement","builtinPlacements","popupAlign","zIndex","stretch","getPopupClassNameFromAlign","fresh","alignPoint","onPopupClick","onPopupAlign","arrow","popupMotion","maskMotion","popupTransitionName","popupAnimation","maskTransitionName","maskAnimation","className","getTriggerDOMNode"];function b7(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:fZ,e=y.forwardRef(function(n,i){var r=n.prefixCls,o=r===void 0?"rc-trigger-popup":r,a=n.children,s=n.action,l=s===void 0?"hover":s,c=n.showAction,g=n.hideAction,u=n.popupVisible,d=n.defaultPopupVisible,C=n.onPopupVisibleChange,f=n.afterPopupVisibleChange,v=n.mouseEnterDelay,p=n.mouseLeaveDelay,m=p===void 0?.1:p,A=n.focusDelay,b=n.blurDelay,G=n.mask,w=n.maskClosable,S=w===void 0?!0:w,Z=n.getPopupContainer,x=n.forceRender,R=n.autoDestroy,W=n.destroyPopupOnHide,M=n.popup,N=n.popupClassName,X=n.popupStyle,E=n.popupPlacement,Q=n.builtinPlacements,k=Q===void 0?{}:Q,J=n.popupAlign,F=n.zIndex,L=n.stretch,z=n.getPopupClassNameFromAlign,K=n.fresh,O=n.alignPoint,j=n.onPopupClick,P=n.onPopupAlign,$=n.arrow,oe=n.popupMotion,ie=n.maskMotion,de=n.popupTransitionName,Ve=n.popupAnimation,Se=n.maskTransitionName,me=n.maskAnimation,T=n.className,Ge=n.getTriggerDOMNode,ne=An(n,v7),he=R||W||!1,ae=y.useState(!1),He=De(ae,2),ve=He[0],Me=He[1];qn(function(){Me(AZ())},[]);var q=y.useRef({}),Y=y.useContext(iM),Ce=y.useMemo(function(){return{registerSubPopup:function(Ut,Hn){q.current[Ut]=Hn,Y==null||Y.registerSubPopup(Ut,Hn)}}},[Y]),se=XE(),fe=y.useState(null),Ze=De(fe,2),Oe=Ze[0],Fe=Ze[1],Ee=y.useRef(null),Qe=Xi(function(Jt){Ee.current=Jt,oh(Jt)&&Oe!==Jt&&Fe(Jt),Y==null||Y.registerSubPopup(se,Jt)}),Ye=y.useState(null),$e=De(Ye,2),st=$e[0],Ue=$e[1],Ne=y.useRef(null),je=Xi(function(Jt){oh(Jt)&&st!==Jt&&(Ue(Jt),Ne.current=Jt)}),Ie=y.Children.only(a),Te=(Ie==null?void 0:Ie.props)||{},ue={},Pe=Xi(function(Jt){var Ut,Hn,Qn=st;return(Qn==null?void 0:Qn.contains(Jt))||((Ut=Op(Qn))===null||Ut===void 0?void 0:Ut.host)===Jt||Jt===Qn||(Oe==null?void 0:Oe.contains(Jt))||((Hn=Op(Oe))===null||Hn===void 0?void 0:Hn.host)===Jt||Jt===Oe||Object.values(q.current).some(function(Gn){return(Gn==null?void 0:Gn.contains(Jt))||Jt===Gn})}),be=oM(o,oe,Ve,de),Le=oM(o,ie,me,Se),ct=y.useState(d||!1),dt=De(ct,2),It=dt[0],Vt=dt[1],vt=u??It,et=Xi(function(Jt){u===void 0&&Vt(Jt)});qn(function(){Vt(u||!1)},[u]);var rt=y.useRef(vt);rt.current=vt;var ut=y.useRef([]);ut.current=[];var Tt=Xi(function(Jt){var Ut;et(Jt),((Ut=ut.current[ut.current.length-1])!==null&&Ut!==void 0?Ut:vt)!==Jt&&(ut.current.push(Jt),C==null||C(Jt))}),Ft=y.useRef(),ft=function(){clearTimeout(Ft.current)},At=function(Ut){var Hn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;ft(),Hn===0?Tt(Ut):Ft.current=setTimeout(function(){Tt(Ut)},Hn*1e3)};y.useEffect(function(){return ft},[]);var Gt=y.useState(!1),Bt=De(Gt,2),Yt=Bt[0],St=Bt[1];qn(function(Jt){(!Jt||vt)&&St(!0)},[vt]);var sn=y.useState(null),Ot=De(sn,2),U=Ot[0],ee=Ot[1],Be=y.useState(null),_=De(Be,2),te=_[0],ce=_[1],le=function(Ut){ce([Ut.clientX,Ut.clientY])},re=m7(vt,Oe,O&&te!==null?te:st,E,k,J,P),xe=De(re,11),Xe=xe[0],_e=xe[1],We=xe[2],pt=xe[3],lt=xe[4],nt=xe[5],wt=xe[6],ot=xe[7],bt=xe[8],Wt=xe[9],yt=xe[10],ht=C7(ve,l,c,g),Qt=De(ht,2),zt=Qt[0],Pt=Qt[1],dn=zt.has("click"),un=Pt.has("click")||Pt.has("contextMenu"),In=Xi(function(){Yt||yt()}),Ht=function(){rt.current&&O&&un&&At(!1)};A7(vt,st,Oe,In,Ht),qn(function(){In()},[te,E]),qn(function(){vt&&!(k!=null&&k[E])&&In()},[JSON.stringify(J)]);var mt=y.useMemo(function(){var Jt=f7(k,o,Wt,O);return qe(Jt,z==null?void 0:z(Wt))},[Wt,z,k,o,O]);y.useImperativeHandle(i,function(){return{nativeElement:Ne.current,popupElement:Ee.current,forceAlign:In}});var Lt=y.useState(0),Rt=De(Lt,2),Xt=Rt[0],en=Rt[1],Rn=y.useState(0),bn=De(Rn,2),On=bn[0],gi=bn[1],ni=function(){if(L&&st){var Ut=st.getBoundingClientRect();en(Ut.width),gi(Ut.height)}},ai=function(){ni(),In()},Vi=function(Ut){St(!1),yt(),f==null||f(Ut)},jo=function(){return new Promise(function(Ut){ni(),ee(function(){return Ut})})};qn(function(){U&&(yt(),U(),ee(null))},[U]);function mr(Jt,Ut,Hn,Qn){ue[Jt]=function(Gn){var $o;Qn==null||Qn(Gn),At(Ut,Hn);for(var Sa=arguments.length,pr=new Array(Sa>1?Sa-1:0),is=1;is<Sa;is++)pr[is-1]=arguments[is];($o=Te[Jt])===null||$o===void 0||$o.call.apply($o,[Te,Gn].concat(pr))}}(dn||un)&&(ue.onClick=function(Jt){var Ut;rt.current&&un?At(!1):!rt.current&&dn&&(le(Jt),At(!0));for(var Hn=arguments.length,Qn=new Array(Hn>1?Hn-1:0),Gn=1;Gn<Hn;Gn++)Qn[Gn-1]=arguments[Gn];(Ut=Te.onClick)===null||Ut===void 0||Ut.call.apply(Ut,[Te,Jt].concat(Qn))}),p7(vt,un,st,Oe,G,S,Pe,At);var Go=zt.has("hover"),Vs=Pt.has("hover"),Yr,ui;Go&&(mr("onMouseEnter",!0,v,function(Jt){le(Jt)}),mr("onPointerEnter",!0,v,function(Jt){le(Jt)}),Yr=function(Ut){(vt||Yt)&&Oe!==null&&Oe!==void 0&&Oe.contains(Ut.target)&&At(!0,v)},O&&(ue.onMouseMove=function(Jt){var Ut;(Ut=Te.onMouseMove)===null||Ut===void 0||Ut.call(Te,Jt)})),Vs&&(mr("onMouseLeave",!1,m),mr("onPointerLeave",!1,m),ui=function(){At(!1,m)}),zt.has("focus")&&mr("onFocus",!0,A),Pt.has("focus")&&mr("onBlur",!1,b),zt.has("contextMenu")&&(ue.onContextMenu=function(Jt){var Ut;rt.current&&Pt.has("contextMenu")?At(!1):(le(Jt),At(!0)),Jt.preventDefault();for(var Hn=arguments.length,Qn=new Array(Hn>1?Hn-1:0),Gn=1;Gn<Hn;Gn++)Qn[Gn-1]=arguments[Gn];(Ut=Te.onContextMenu)===null||Ut===void 0||Ut.call.apply(Ut,[Te,Jt].concat(Qn))}),T&&(ue.className=qe(Te.className,T));var Ji=Re(Re({},Te),ue),Cn={},Bo=["onContextMenu","onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"];Bo.forEach(function(Jt){ne[Jt]&&(Cn[Jt]=function(){for(var Ut,Hn=arguments.length,Qn=new Array(Hn),Gn=0;Gn<Hn;Gn++)Qn[Gn]=arguments[Gn];(Ut=Ji[Jt])===null||Ut===void 0||Ut.call.apply(Ut,[Ji].concat(Qn)),ne[Jt].apply(ne,Qn)})});var Ar=y.cloneElement(Ie,Re(Re({},Ji),Cn)),Ba={x:nt,y:wt},ns=$?Re({},$!==!0?$:{}):null;return y.createElement(y.Fragment,null,y.createElement(Pa,{disabled:!vt,ref:je,onResize:ai},y.createElement(I7,{getTriggerDOMNode:Ge},Ar)),y.createElement(iM.Provider,{value:Ce},y.createElement(d7,{portal:t,ref:Qe,prefixCls:o,popup:M,className:qe(N,mt),style:X,target:st,onMouseEnter:Yr,onMouseLeave:ui,onPointerEnter:Yr,zIndex:F,open:vt,keepDom:Yt,fresh:K,onClick:j,mask:G,motion:be,maskMotion:Le,onVisibleChanged:Vi,onPrepare:jo,forceRender:x,autoDestroy:he,getPopupContainer:Z,align:Wt,arrow:ns,arrowPos:Ba,ready:Xe,offsetX:_e,offsetY:We,offsetR:pt,offsetB:lt,onAlign:In,stretch:L,targetWidth:Xt/ot,targetHeight:On/bt})))});return e}const pZ=b7(fZ);var y7=["prefixCls","disabled","visible","children","popupElement","animation","transitionName","dropdownStyle","dropdownClassName","direction","placement","builtinPlacements","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","getPopupContainer","empty","getTriggerDOMNode","onPopupVisibleChange","onPopupMouseEnter"],G7=function(e){var n=e===!0?0:1;return{bottomLeft:{points:["tl","bl"],offset:[0,4],overflow:{adjustX:n,adjustY:1},htmlRegion:"scroll"},bottomRight:{points:["tr","br"],offset:[0,4],overflow:{adjustX:n,adjustY:1},htmlRegion:"scroll"},topLeft:{points:["bl","tl"],offset:[0,-4],overflow:{adjustX:n,adjustY:1},htmlRegion:"scroll"},topRight:{points:["br","tr"],offset:[0,-4],overflow:{adjustX:n,adjustY:1},htmlRegion:"scroll"}}},B7=function(e,n){var i=e.prefixCls;e.disabled;var r=e.visible,o=e.children,a=e.popupElement,s=e.animation,l=e.transitionName,c=e.dropdownStyle,g=e.dropdownClassName,u=e.direction,d=u===void 0?"ltr":u,C=e.placement,f=e.builtinPlacements,v=e.dropdownMatchSelectWidth,p=e.dropdownRender,m=e.dropdownAlign,A=e.getPopupContainer,b=e.empty,G=e.getTriggerDOMNode,w=e.onPopupVisibleChange,S=e.onPopupMouseEnter,Z=An(e,y7),x="".concat(i,"-dropdown"),R=a;p&&(R=p(a));var W=y.useMemo(function(){return f||G7(v)},[f,v]),M=s?"".concat(x,"-").concat(s):l,N=typeof v=="number",X=y.useMemo(function(){return N?null:v===!1?"minWidth":"width"},[v,N]),E=c;N&&(E=Re(Re({},E),{},{width:v}));var Q=y.useRef(null);return y.useImperativeHandle(n,function(){return{getPopupElement:function(){var J;return(J=Q.current)===null||J===void 0?void 0:J.popupElement}}}),y.createElement(pZ,Zt({},Z,{showAction:w?["click"]:[],hideAction:w?["click"]:[],popupPlacement:C||(d==="rtl"?"bottomRight":"bottomLeft"),builtinPlacements:W,prefixCls:x,popupTransitionName:M,popup:y.createElement("div",{onMouseEnter:S},R),ref:Q,stretch:X,popupAlign:m,popupVisible:r,getPopupContainer:A,popupClassName:qe(g,we({},"".concat(x,"-empty"),b)),popupStyle:E,getTriggerDOMNode:G,onPopupVisibleChange:w}),o)},S7=y.forwardRef(B7);function gM(t,e){var n=t.key,i;return"value"in t&&(i=t.value),n??(i!==void 0?i:"rc-index-key-".concat(e))}function cS(t){return typeof t<"u"&&!Number.isNaN(t)}function fY(t,e){var n=t||{},i=n.label,r=n.value,o=n.options,a=n.groupLabel,s=i||(e?"children":"label");return{label:s,value:r||"value",options:o||"options",groupLabel:a||s}}function w7(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.fieldNames,i=e.childrenAsData,r=[],o=fY(n,!1),a=o.label,s=o.value,l=o.options,c=o.groupLabel;function g(u,d){Array.isArray(u)&&u.forEach(function(C){if(d||!(l in C)){var f=C[s];r.push({key:gM(C,r.length),groupOption:d,data:C,label:C[a],value:f})}else{var v=C[c];v===void 0&&i&&(v=C.label),r.push({key:gM(C,r.length),group:!0,data:C,label:v}),g(C[l],!0)}})}return g(t,!1),r}function gS(t){var e=Re({},t);return"props"in e||Object.defineProperty(e,"props",{get:function(){return Fr(!1,"Return type is option instead of Option instance. Please read value directly instead of reading from `props`."),e}}),e}var Z7=function(e,n,i){if(!n||!n.length)return null;var r=!1,o=function s(l,c){var g=VX(c),u=g[0],d=g.slice(1);if(!u)return[l];var C=l.split(u);return r=r||C.length>1,C.reduce(function(f,v){return[].concat(Et(f),Et(s(v,d)))},[]).filter(Boolean)},a=o(e,n);return r?typeof i<"u"?a.slice(0,i):a:null},vZ=y.createContext(null);function x7(t){var e=t.visible,n=t.values;if(!e)return null;var i=50;return y.createElement("span",{"aria-live":"polite",style:{width:0,height:0,position:"absolute",overflow:"hidden",opacity:0}},"".concat(n.slice(0,i).map(function(r){var o=r.label,a=r.value;return["number","string"].includes(qt(o))?o:a}).join(", ")),n.length>i?", ...":null)}var R7=["id","prefixCls","className","showSearch","tagRender","direction","omitDomProps","displayValues","onDisplayValuesChange","emptyOptions","notFoundContent","onClear","mode","disabled","loading","getInputElement","getRawInputElement","open","defaultOpen","onDropdownVisibleChange","activeValue","onActiveValueChange","activeDescendantId","searchValue","autoClearSearchValue","onSearch","onSearchSplit","tokenSeparators","allowClear","suffixIcon","clearIcon","OptionList","animation","transitionName","dropdownStyle","dropdownClassName","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","placement","builtinPlacements","getPopupContainer","showAction","onFocus","onBlur","onKeyUp","onKeyDown","onMouseDown"],W7=["value","onChange","removeIcon","placeholder","autoFocus","maxTagCount","maxTagTextLength","maxTagPlaceholder","choiceTransitionName","onInputKeyDown","onPopupScroll","tabIndex"],uS=function(e){return e==="tags"||e==="multiple"},V7=y.forwardRef(function(t,e){var n,i=t.id,r=t.prefixCls,o=t.className,a=t.showSearch,s=t.tagRender,l=t.direction,c=t.omitDomProps,g=t.displayValues,u=t.onDisplayValuesChange,d=t.emptyOptions,C=t.notFoundContent,f=C===void 0?"Not Found":C,v=t.onClear,p=t.mode,m=t.disabled,A=t.loading,b=t.getInputElement,G=t.getRawInputElement,w=t.open,S=t.defaultOpen,Z=t.onDropdownVisibleChange,x=t.activeValue,R=t.onActiveValueChange,W=t.activeDescendantId,M=t.searchValue,N=t.autoClearSearchValue,X=t.onSearch,E=t.onSearchSplit,Q=t.tokenSeparators,k=t.allowClear,J=t.suffixIcon,F=t.clearIcon,L=t.OptionList,z=t.animation,K=t.transitionName,O=t.dropdownStyle,j=t.dropdownClassName,P=t.dropdownMatchSelectWidth,$=t.dropdownRender,oe=t.dropdownAlign,ie=t.placement,de=t.builtinPlacements,Ve=t.getPopupContainer,Se=t.showAction,me=Se===void 0?[]:Se,T=t.onFocus,Ge=t.onBlur,ne=t.onKeyUp,he=t.onKeyDown,ae=t.onMouseDown,He=An(t,R7),ve=uS(p),Me=(a!==void 0?a:ve)||p==="combobox",q=Re({},He);W7.forEach(function(Ht){delete q[Ht]}),c==null||c.forEach(function(Ht){delete q[Ht]});var Y=y.useState(!1),Ce=De(Y,2),se=Ce[0],fe=Ce[1];y.useEffect(function(){fe(AZ())},[]);var Ze=y.useRef(null),Oe=y.useRef(null),Fe=y.useRef(null),Ee=y.useRef(null),Qe=y.useRef(null),Ye=y.useRef(!1),$e=Yj(),st=De($e,3),Ue=st[0],Ne=st[1],je=st[2];y.useImperativeHandle(e,function(){var Ht,mt;return{focus:(Ht=Ee.current)===null||Ht===void 0?void 0:Ht.focus,blur:(mt=Ee.current)===null||mt===void 0?void 0:mt.blur,scrollTo:function(Rt){var Xt;return(Xt=Qe.current)===null||Xt===void 0?void 0:Xt.scrollTo(Rt)},nativeElement:Ze.current||Oe.current}});var Ie=y.useMemo(function(){var Ht;if(p!=="combobox")return M;var mt=(Ht=g[0])===null||Ht===void 0?void 0:Ht.value;return typeof mt=="string"||typeof mt=="number"?String(mt):""},[M,p,g]),Te=p==="combobox"&&typeof b=="function"&&b()||null,ue=typeof G=="function"&&G(),Pe=zg(Oe,ue==null||(n=ue.props)===null||n===void 0?void 0:n.ref),be=y.useState(!1),Le=De(be,2),ct=Le[0],dt=Le[1];qn(function(){dt(!0)},[]);var It=$r(!1,{defaultValue:S,value:w}),Vt=De(It,2),vt=Vt[0],et=Vt[1],rt=ct?vt:!1,ut=!f&&d;(m||ut&&rt&&p==="combobox")&&(rt=!1);var Tt=ut?!1:rt,Ft=y.useCallback(function(Ht){var mt=Ht!==void 0?Ht:!rt;m||(et(mt),rt!==mt&&(Z==null||Z(mt)))},[m,rt,et,Z]),ft=y.useMemo(function(){return(Q||[]).some(function(Ht){return[`
`,`\r
`].includes(Ht)})},[Q]),At=y.useContext(vZ)||{},Gt=At.maxCount,Bt=At.rawValues,Yt=function(mt,Lt,Rt){if(!(ve&&cS(Gt)&&(Bt==null?void 0:Bt.size)>=Gt)){var Xt=!0,en=mt;R==null||R(null);var Rn=Z7(mt,Q,cS(Gt)?Gt-Bt.size:void 0),bn=Rt?null:Rn;return p!=="combobox"&&bn&&(en="",E==null||E(bn),Ft(!1),Xt=!1),X&&Ie!==en&&X(en,{source:Lt?"typing":"effect"}),Xt}},St=function(mt){!mt||!mt.trim()||X(mt,{source:"submit"})};y.useEffect(function(){!rt&&!ve&&p!=="combobox"&&Yt("",!1,!1)},[rt]),y.useEffect(function(){vt&&m&&et(!1),m&&!Ye.current&&Ne(!1)},[m]);var sn=cY(),Ot=De(sn,2),U=Ot[0],ee=Ot[1],Be=y.useRef(!1),_=function(mt){var Lt=U(),Rt=mt.key,Xt=Rt==="Enter";if(Xt&&(p!=="combobox"&&mt.preventDefault(),rt||Ft(!0)),ee(!!Ie),Rt==="Backspace"&&!Lt&&ve&&!Ie&&g.length){for(var en=Et(g),Rn=null,bn=en.length-1;bn>=0;bn-=1){var On=en[bn];if(!On.disabled){en.splice(bn,1),Rn=On;break}}Rn&&u(en,{type:"remove",values:[Rn]})}for(var gi=arguments.length,ni=new Array(gi>1?gi-1:0),ai=1;ai<gi;ai++)ni[ai-1]=arguments[ai];if(rt&&(!Xt||!Be.current)){var Vi;(Vi=Qe.current)===null||Vi===void 0||Vi.onKeyDown.apply(Vi,[mt].concat(ni))}Xt&&(Be.current=!0),he==null||he.apply(void 0,[mt].concat(ni))},te=function(mt){for(var Lt=arguments.length,Rt=new Array(Lt>1?Lt-1:0),Xt=1;Xt<Lt;Xt++)Rt[Xt-1]=arguments[Xt];if(rt){var en;(en=Qe.current)===null||en===void 0||en.onKeyUp.apply(en,[mt].concat(Rt))}mt.key==="Enter"&&(Be.current=!1),ne==null||ne.apply(void 0,[mt].concat(Rt))},ce=function(mt){var Lt=g.filter(function(Rt){return Rt!==mt});u(Lt,{type:"remove",values:[mt]})},le=y.useRef(!1),re=function(){Ne(!0),m||(T&&!le.current&&T.apply(void 0,arguments),me.includes("focus")&&Ft(!0)),le.current=!0},xe=function(){Ye.current=!0,Ne(!1,function(){le.current=!1,Ye.current=!1,Ft(!1)}),!m&&(Ie&&(p==="tags"?X(Ie,{source:"submit"}):p==="multiple"&&X("",{source:"blur"})),Ge&&Ge.apply(void 0,arguments))},Xe=[];y.useEffect(function(){return function(){Xe.forEach(function(Ht){return clearTimeout(Ht)}),Xe.splice(0,Xe.length)}},[]);var _e=function(mt){var Lt,Rt=mt.target,Xt=(Lt=Fe.current)===null||Lt===void 0?void 0:Lt.getPopupElement();if(Xt&&Xt.contains(Rt)){var en=setTimeout(function(){var gi=Xe.indexOf(en);if(gi!==-1&&Xe.splice(gi,1),je(),!se&&!Xt.contains(document.activeElement)){var ni;(ni=Ee.current)===null||ni===void 0||ni.focus()}});Xe.push(en)}for(var Rn=arguments.length,bn=new Array(Rn>1?Rn-1:0),On=1;On<Rn;On++)bn[On-1]=arguments[On];ae==null||ae.apply(void 0,[mt].concat(bn))},We=y.useState({}),pt=De(We,2),lt=pt[1];function nt(){lt({})}var wt;ue&&(wt=function(mt){Ft(mt)}),zj(function(){var Ht;return[Ze.current,(Ht=Fe.current)===null||Ht===void 0?void 0:Ht.getPopupElement()]},Tt,Ft,!!ue);var ot=y.useMemo(function(){return Re(Re({},t),{},{notFoundContent:f,open:rt,triggerOpen:Tt,id:i,showSearch:Me,multiple:ve,toggleOpen:Ft})},[t,f,Tt,rt,i,Me,ve,Ft]),bt=!!J||A,Wt;bt&&(Wt=y.createElement(yv,{className:qe("".concat(r,"-arrow"),we({},"".concat(r,"-arrow-loading"),A)),customizeIcon:J,customizeIconProps:{loading:A,searchValue:Ie,open:rt,focused:Ue,showSearch:Me}}));var yt=function(){var mt;v==null||v(),(mt=Ee.current)===null||mt===void 0||mt.focus(),u([],{type:"clear",values:g}),Yt("",!1,!1)},ht=Xj(r,yt,g,k,F,m,Ie,p),Qt=ht.allowClear,zt=ht.clearIcon,Pt=y.createElement(L,{ref:Qe}),dn=qe(r,o,we(we(we(we(we(we(we(we(we(we({},"".concat(r,"-focused"),Ue),"".concat(r,"-multiple"),ve),"".concat(r,"-single"),!ve),"".concat(r,"-allow-clear"),k),"".concat(r,"-show-arrow"),bt),"".concat(r,"-disabled"),m),"".concat(r,"-loading"),A),"".concat(r,"-open"),rt),"".concat(r,"-customize-input"),Te),"".concat(r,"-show-search"),Me)),un=y.createElement(S7,{ref:Fe,disabled:m,prefixCls:r,visible:Tt,popupElement:Pt,animation:z,transitionName:K,dropdownStyle:O,dropdownClassName:j,direction:l,dropdownMatchSelectWidth:P,dropdownRender:$,dropdownAlign:oe,placement:ie,builtinPlacements:de,getPopupContainer:Ve,empty:d,getTriggerDOMNode:function(mt){return Oe.current||mt},onPopupVisibleChange:wt,onPopupMouseEnter:nt},ue?y.cloneElement(ue,{ref:Pe}):y.createElement(l7,Zt({},t,{domRef:Oe,prefixCls:r,inputElement:Te,ref:Ee,id:i,showSearch:Me,autoClearSearchValue:N,mode:p,activeDescendantId:W,tagRender:s,values:g,open:rt,onToggleOpen:Ft,activeValue:x,searchValue:Ie,onSearch:Yt,onSearchSubmit:St,onRemove:ce,tokenWithEnter:ft}))),In;return ue?In=un:In=y.createElement("div",Zt({className:dn},q,{ref:Ze,onMouseDown:_e,onKeyDown:_,onKeyUp:te,onFocus:re,onBlur:xe}),y.createElement(x7,{visible:Ue&&!rt,values:g}),un,Wt,Qt&&zt),y.createElement(lY.Provider,{value:ot},In)}),bZ=function(){return null};bZ.isSelectOptGroup=!0;var yZ=function(){return null};yZ.isSelectOption=!0;var mY=y.forwardRef(function(t,e){var n=t.height,i=t.offsetY,r=t.offsetX,o=t.children,a=t.prefixCls,s=t.onInnerResize,l=t.innerProps,c=t.rtl,g=t.extra,u={},d={display:"flex",flexDirection:"column"};return i!==void 0&&(u={height:n,position:"relative",overflow:"hidden"},d=Re(Re({},d),{},we(we(we(we(we({transform:"translateY(".concat(i,"px)")},c?"marginRight":"marginLeft",-r),"position","absolute"),"left",0),"right",0),"top",0))),y.createElement("div",{style:u},y.createElement(Pa,{onResize:function(f){var v=f.offsetHeight;v&&s&&s()}},y.createElement("div",Zt({style:d,className:qe(we({},"".concat(a,"-holder-inner"),a)),ref:e},l),o,g)))});mY.displayName="Filler";function M7(t){var e=t.children,n=t.setRef,i=y.useCallback(function(r){n(r)},[]);return y.cloneElement(e,{ref:i})}function N7(t,e,n,i,r,o,a,s){var l=s.getKey;return t.slice(e,n+1).map(function(c,g){var u=e+g,d=a(c,u,{style:{width:i},offsetX:r}),C=l(c);return y.createElement(M7,{key:C,setRef:function(v){return o(c,v)}},d)})}function F7(t,e,n){var i=t.length,r=e.length,o,a;if(i===0&&r===0)return null;i<r?(o=t,a=e):(o=e,a=t);var s={__EMPTY_ITEM__:!0};function l(f){return f!==void 0?n(f):s}for(var c=null,g=Math.abs(i-r)!==1,u=0;u<a.length;u+=1){var d=l(o[u]),C=l(a[u]);if(d!==C){c=u,g=g||d!==l(a[u+1]);break}}return c===null?null:{index:c,multiple:g}}function H7(t,e,n){var i=y.useState(t),r=De(i,2),o=r[0],a=r[1],s=y.useState(null),l=De(s,2),c=l[0],g=l[1];return y.useEffect(function(){var u=F7(o||[],t||[],e);(u==null?void 0:u.index)!==void 0&&g(t[u.index]),a(t)},[t]),[c]}var uM=(typeof navigator>"u"?"undefined":qt(navigator))==="object"&&/Firefox/i.test(navigator.userAgent);const AY=function(t,e,n,i){var r=y.useRef(!1),o=y.useRef(null);function a(){clearTimeout(o.current),r.current=!0,o.current=setTimeout(function(){r.current=!1},50)}var s=y.useRef({top:t,bottom:e,left:n,right:i});return s.current.top=t,s.current.bottom=e,s.current.left=n,s.current.right=i,function(l,c){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,u=l?c<0&&s.current.left||c>0&&s.current.right:c<0&&s.current.top||c>0&&s.current.bottom;return g&&u?(clearTimeout(o.current),r.current=!1):(!u||r.current)&&a(),!r.current&&u}};function X7(t,e,n,i,r,o,a){var s=y.useRef(0),l=y.useRef(null),c=y.useRef(null),g=y.useRef(!1),u=AY(e,n,i,r);function d(A,b){if(Ln.cancel(l.current),!u(!1,b)){var G=A;if(!G._virtualHandled)G._virtualHandled=!0;else return;s.current+=b,c.current=b,uM||G.preventDefault(),l.current=Ln(function(){var w=g.current?10:1;a(s.current*w,!1),s.current=0})}}function C(A,b){a(b,!0),uM||A.preventDefault()}var f=y.useRef(null),v=y.useRef(null);function p(A){if(t){Ln.cancel(v.current),v.current=Ln(function(){f.current=null},2);var b=A.deltaX,G=A.deltaY,w=A.shiftKey,S=b,Z=G;(f.current==="sx"||!f.current&&w&&G&&!b)&&(S=G,Z=0,f.current="sx");var x=Math.abs(S),R=Math.abs(Z);f.current===null&&(f.current=o&&x>R?"x":"y"),f.current==="y"?d(A,Z):C(A,S)}}function m(A){t&&(g.current=A.detail===c.current)}return[p,m]}function E7(t,e,n,i){var r=y.useMemo(function(){return[new Map,[]]},[t,n.id,i]),o=De(r,2),a=o[0],s=o[1],l=function(g){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,d=a.get(g),C=a.get(u);if(d===void 0||C===void 0)for(var f=t.length,v=s.length;v<f;v+=1){var p,m=t[v],A=e(m);a.set(A,v);var b=(p=n.get(A))!==null&&p!==void 0?p:i;if(s[v]=(s[v-1]||0)+b,A===g&&(d=v),A===u&&(C=v),d!==void 0&&C!==void 0)break}return{top:s[d-1]||0,bottom:s[C]}};return l}var Y7=function(){function t(){Ki(this,t),we(this,"maps",void 0),we(this,"id",0),this.maps=Object.create(null)}return Li(t,[{key:"set",value:function(n,i){this.maps[n]=i,this.id+=1}},{key:"get",value:function(n){return this.maps[n]}}]),t}();function z7(t,e,n){var i=y.useState(0),r=De(i,2),o=r[0],a=r[1],s=y.useRef(new Map),l=y.useRef(new Y7),c=y.useRef();function g(){Ln.cancel(c.current)}function u(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;g();var f=function(){s.current.forEach(function(p,m){if(p&&p.offsetParent){var A=BC(p),b=A.offsetHeight;l.current.get(m)!==b&&l.current.set(m,A.offsetHeight)}}),a(function(p){return p+1})};C?f():c.current=Ln(f)}function d(C,f){var v=t(C);s.current.get(v),f?(s.current.set(v,f),u()):s.current.delete(v)}return y.useEffect(function(){return g},[]),[d,u,l.current,o]}var dM=14/15;function K7(t,e,n){var i=y.useRef(!1),r=y.useRef(0),o=y.useRef(0),a=y.useRef(null),s=y.useRef(null),l,c=function(C){if(i.current){var f=Math.ceil(C.touches[0].pageX),v=Math.ceil(C.touches[0].pageY),p=r.current-f,m=o.current-v,A=Math.abs(p)>Math.abs(m);A?r.current=f:o.current=v;var b=n(A,A?p:m,!1,C);b&&C.preventDefault(),clearInterval(s.current),b&&(s.current=setInterval(function(){A?p*=dM:m*=dM;var G=Math.floor(A?p:m);(!n(A,G,!0)||Math.abs(G)<=.1)&&clearInterval(s.current)},16))}},g=function(){i.current=!1,l()},u=function(C){l(),C.touches.length===1&&!i.current&&(i.current=!0,r.current=Math.ceil(C.touches[0].pageX),o.current=Math.ceil(C.touches[0].pageY),a.current=C.target,a.current.addEventListener("touchmove",c,{passive:!1}),a.current.addEventListener("touchend",g,{passive:!0}))};l=function(){a.current&&(a.current.removeEventListener("touchmove",c),a.current.removeEventListener("touchend",g))},qn(function(){return t&&e.current.addEventListener("touchstart",u,{passive:!0}),function(){var d;(d=e.current)===null||d===void 0||d.removeEventListener("touchstart",u),l(),clearInterval(s.current)}},[t])}var L7=10;function T7(t,e,n,i,r,o,a,s){var l=y.useRef(),c=y.useState(null),g=De(c,2),u=g[0],d=g[1];return qn(function(){if(u&&u.times<L7){if(!t.current){d(function(L){return Re({},L)});return}o();var C=u.targetAlign,f=u.originAlign,v=u.index,p=u.offset,m=t.current.clientHeight,A=!1,b=C,G=null;if(m){for(var w=C||f,S=0,Z=0,x=0,R=Math.min(e.length-1,v),W=0;W<=R;W+=1){var M=r(e[W]);Z=S;var N=n.get(M);x=Z+(N===void 0?i:N),S=x}for(var X=w==="top"?p:m-p,E=R;E>=0;E-=1){var Q=r(e[E]),k=n.get(Q);if(k===void 0){A=!0;break}if(X-=k,X<=0)break}switch(w){case"top":G=Z-p;break;case"bottom":G=x-m+p;break;default:{var J=t.current.scrollTop,F=J+m;Z<J?b="top":x>F&&(b="bottom")}}G!==null&&a(G),G!==u.lastTop&&(A=!0)}A&&d(Re(Re({},u),{},{times:u.times+1,targetAlign:b,lastTop:G}))}},[u,t.current]),function(C){if(C==null){s();return}if(Ln.cancel(l.current),typeof C=="number")a(C);else if(C&&qt(C)==="object"){var f,v=C.align;"index"in C?f=C.index:f=e.findIndex(function(A){return r(A)===C.key});var p=C.offset,m=p===void 0?0:p;d({times:0,index:f,offset:m,originAlign:v})}}}function IM(t,e){var n="touches"in t?t.touches[0]:t;return n[e?"pageX":"pageY"]}var CM=y.forwardRef(function(t,e){var n=t.prefixCls,i=t.rtl,r=t.scrollOffset,o=t.scrollRange,a=t.onStartMove,s=t.onStopMove,l=t.onScroll,c=t.horizontal,g=t.spinSize,u=t.containerSize,d=t.style,C=t.thumbStyle,f=y.useState(!1),v=De(f,2),p=v[0],m=v[1],A=y.useState(null),b=De(A,2),G=b[0],w=b[1],S=y.useState(null),Z=De(S,2),x=Z[0],R=Z[1],W=!i,M=y.useRef(),N=y.useRef(),X=y.useState(!1),E=De(X,2),Q=E[0],k=E[1],J=y.useRef(),F=function(){clearTimeout(J.current),k(!0),J.current=setTimeout(function(){k(!1)},3e3)},L=o-u||0,z=u-g||0,K=y.useMemo(function(){if(r===0||L===0)return 0;var Se=r/L;return Se*z},[r,L,z]),O=function(me){me.stopPropagation(),me.preventDefault()},j=y.useRef({top:K,dragging:p,pageY:G,startTop:x});j.current={top:K,dragging:p,pageY:G,startTop:x};var P=function(me){m(!0),w(IM(me,c)),R(j.current.top),a(),me.stopPropagation(),me.preventDefault()};y.useEffect(function(){var Se=function(ne){ne.preventDefault()},me=M.current,T=N.current;return me.addEventListener("touchstart",Se,{passive:!1}),T.addEventListener("touchstart",P,{passive:!1}),function(){me.removeEventListener("touchstart",Se),T.removeEventListener("touchstart",P)}},[]);var $=y.useRef();$.current=L;var oe=y.useRef();oe.current=z,y.useEffect(function(){if(p){var Se,me=function(ne){var he=j.current,ae=he.dragging,He=he.pageY,ve=he.startTop;Ln.cancel(Se);var Me=M.current.getBoundingClientRect(),q=u/(c?Me.width:Me.height);if(ae){var Y=(IM(ne,c)-He)*q,Ce=ve;!W&&c?Ce-=Y:Ce+=Y;var se=$.current,fe=oe.current,Ze=fe?Ce/fe:0,Oe=Math.ceil(Ze*se);Oe=Math.max(Oe,0),Oe=Math.min(Oe,se),Se=Ln(function(){l(Oe,c)})}},T=function(){m(!1),s()};return window.addEventListener("mousemove",me,{passive:!0}),window.addEventListener("touchmove",me,{passive:!0}),window.addEventListener("mouseup",T,{passive:!0}),window.addEventListener("touchend",T,{passive:!0}),function(){window.removeEventListener("mousemove",me),window.removeEventListener("touchmove",me),window.removeEventListener("mouseup",T),window.removeEventListener("touchend",T),Ln.cancel(Se)}}},[p]),y.useEffect(function(){return F(),function(){clearTimeout(J.current)}},[r]),y.useImperativeHandle(e,function(){return{delayHidden:F}});var ie="".concat(n,"-scrollbar"),de={position:"absolute",visibility:Q?null:"hidden"},Ve={position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:99,cursor:"pointer",userSelect:"none"};return c?(de.height=8,de.left=0,de.right=0,de.bottom=0,Ve.height="100%",Ve.width=g,W?Ve.left=K:Ve.right=K):(de.width=8,de.top=0,de.bottom=0,W?de.right=0:de.left=0,Ve.width="100%",Ve.height=g,Ve.top=K),y.createElement("div",{ref:M,className:qe(ie,we(we(we({},"".concat(ie,"-horizontal"),c),"".concat(ie,"-vertical"),!c),"".concat(ie,"-visible"),Q)),style:Re(Re({},de),d),onMouseDown:O,onMouseMove:F},y.createElement("div",{ref:N,className:qe("".concat(ie,"-thumb"),we({},"".concat(ie,"-thumb-moving"),p)),style:Re(Re({},Ve),C),onMouseDown:P}))}),_7=20;function hM(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t/e*t;return isNaN(n)&&(n=0),n=Math.max(n,_7),Math.floor(n)}var k7=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","direction","scrollWidth","component","onScroll","onVirtualScroll","onVisibleChange","innerProps","extraRender","styles"],P7=[],U7={overflowY:"auto",overflowAnchor:"none"};function D7(t,e){var n=t.prefixCls,i=n===void 0?"rc-virtual-list":n,r=t.className,o=t.height,a=t.itemHeight,s=t.fullHeight,l=s===void 0?!0:s,c=t.style,g=t.data,u=t.children,d=t.itemKey,C=t.virtual,f=t.direction,v=t.scrollWidth,p=t.component,m=p===void 0?"div":p,A=t.onScroll,b=t.onVirtualScroll,G=t.onVisibleChange,w=t.innerProps,S=t.extraRender,Z=t.styles,x=An(t,k7),R=y.useCallback(function(le){return typeof d=="function"?d(le):le==null?void 0:le[d]},[d]),W=z7(R),M=De(W,4),N=M[0],X=M[1],E=M[2],Q=M[3],k=!!(C!==!1&&o&&a),J=y.useMemo(function(){return Object.values(E.maps).reduce(function(le,re){return le+re},0)},[E.id,E.maps]),F=k&&g&&(Math.max(a*g.length,J)>o||!!v),L=f==="rtl",z=qe(i,we({},"".concat(i,"-rtl"),L),r),K=g||P7,O=y.useRef(),j=y.useRef(),P=y.useRef(),$=y.useState(0),oe=De($,2),ie=oe[0],de=oe[1],Ve=y.useState(0),Se=De(Ve,2),me=Se[0],T=Se[1],Ge=y.useState(!1),ne=De(Ge,2),he=ne[0],ae=ne[1],He=function(){ae(!0)},ve=function(){ae(!1)},Me={getKey:R};function q(le){de(function(re){var xe;typeof le=="function"?xe=le(re):xe=le;var Xe=ct(xe);return O.current.scrollTop=Xe,Xe})}var Y=y.useRef({start:0,end:K.length}),Ce=y.useRef(),se=H7(K,R),fe=De(se,1),Ze=fe[0];Ce.current=Ze;var Oe=y.useMemo(function(){if(!k)return{scrollHeight:void 0,start:0,end:K.length-1,offset:void 0};if(!F){var le;return{scrollHeight:((le=j.current)===null||le===void 0?void 0:le.offsetHeight)||0,start:0,end:K.length-1,offset:void 0}}for(var re=0,xe,Xe,_e,We=K.length,pt=0;pt<We;pt+=1){var lt=K[pt],nt=R(lt),wt=E.get(nt),ot=re+(wt===void 0?a:wt);ot>=ie&&xe===void 0&&(xe=pt,Xe=re),ot>ie+o&&_e===void 0&&(_e=pt),re=ot}return xe===void 0&&(xe=0,Xe=0,_e=Math.ceil(o/a)),_e===void 0&&(_e=K.length-1),_e=Math.min(_e+1,K.length-1),{scrollHeight:re,start:xe,end:_e,offset:Xe}},[F,k,ie,K,Q,o]),Fe=Oe.scrollHeight,Ee=Oe.start,Qe=Oe.end,Ye=Oe.offset;Y.current.start=Ee,Y.current.end=Qe;var $e=y.useState({width:0,height:o}),st=De($e,2),Ue=st[0],Ne=st[1],je=function(re){Ne({width:re.offsetWidth,height:re.offsetHeight})},Ie=y.useRef(),Te=y.useRef(),ue=y.useMemo(function(){return hM(Ue.width,v)},[Ue.width,v]),Pe=y.useMemo(function(){return hM(Ue.height,Fe)},[Ue.height,Fe]),be=Fe-o,Le=y.useRef(be);Le.current=be;function ct(le){var re=le;return Number.isNaN(Le.current)||(re=Math.min(re,Le.current)),re=Math.max(re,0),re}var dt=ie<=0,It=ie>=be,Vt=me<=0,vt=me>=v,et=AY(dt,It,Vt,vt),rt=function(){return{x:L?-me:me,y:ie}},ut=y.useRef(rt()),Tt=Xi(function(le){if(b){var re=Re(Re({},rt()),le);(ut.current.x!==re.x||ut.current.y!==re.y)&&(b(re),ut.current=re)}});function Ft(le,re){var xe=le;re?(sc.flushSync(function(){T(xe)}),Tt()):q(xe)}function ft(le){var re=le.currentTarget.scrollTop;re!==ie&&q(re),A==null||A(le),Tt()}var At=function(re){var xe=re,Xe=v?v-Ue.width:0;return xe=Math.max(xe,0),xe=Math.min(xe,Xe),xe},Gt=Xi(function(le,re){re?(sc.flushSync(function(){T(function(xe){var Xe=xe+(L?-le:le);return At(Xe)})}),Tt()):q(function(xe){var Xe=xe+le;return Xe})}),Bt=X7(k,dt,It,Vt,vt,!!v,Gt),Yt=De(Bt,2),St=Yt[0],sn=Yt[1];K7(k,O,function(le,re,xe,Xe){var _e=Xe;return et(le,re,xe)?!1:!_e||!_e._virtualHandled?(_e&&(_e._virtualHandled=!0),St({preventDefault:function(){},deltaX:le?re:0,deltaY:le?0:re}),!0):!1}),qn(function(){function le(xe){var Xe=dt&&xe.detail<0,_e=It&&xe.detail>0;k&&!Xe&&!_e&&xe.preventDefault()}var re=O.current;return re.addEventListener("wheel",St,{passive:!1}),re.addEventListener("DOMMouseScroll",sn,{passive:!0}),re.addEventListener("MozMousePixelScroll",le,{passive:!1}),function(){re.removeEventListener("wheel",St),re.removeEventListener("DOMMouseScroll",sn),re.removeEventListener("MozMousePixelScroll",le)}},[k,dt,It]),qn(function(){if(v){var le=At(me);T(le),Tt({x:le})}},[Ue.width,v]);var Ot=function(){var re,xe;(re=Ie.current)===null||re===void 0||re.delayHidden(),(xe=Te.current)===null||xe===void 0||xe.delayHidden()},U=T7(O,K,E,a,R,function(){return X(!0)},q,Ot);y.useImperativeHandle(e,function(){return{nativeElement:P.current,getScrollInfo:rt,scrollTo:function(re){function xe(Xe){return Xe&&qt(Xe)==="object"&&("left"in Xe||"top"in Xe)}xe(re)?(re.left!==void 0&&T(At(re.left)),U(re.top)):U(re)}}}),qn(function(){if(G){var le=K.slice(Ee,Qe+1);G(le,K)}},[Ee,Qe,K]);var ee=E7(K,R,E,a),Be=S==null?void 0:S({start:Ee,end:Qe,virtual:F,offsetX:me,offsetY:Ye,rtl:L,getSize:ee}),_=N7(K,Ee,Qe,v,me,N,u,Me),te=null;o&&(te=Re(we({},l?"height":"maxHeight",o),U7),k&&(te.overflowY="hidden",v&&(te.overflowX="hidden"),he&&(te.pointerEvents="none")));var ce={};return L&&(ce.dir="rtl"),y.createElement("div",Zt({ref:P,style:Re(Re({},c),{},{position:"relative"}),className:z},ce,x),y.createElement(Pa,{onResize:je},y.createElement(m,{className:"".concat(i,"-holder"),style:te,ref:O,onScroll:ft,onMouseEnter:Ot},y.createElement(mY,{prefixCls:i,height:Fe,offsetX:me,offsetY:Ye,scrollWidth:v,onInnerResize:X,ref:j,innerProps:w,rtl:L,extra:Be},_))),F&&Fe>o&&y.createElement(CM,{ref:Ie,prefixCls:i,scrollOffset:ie,scrollRange:Fe,rtl:L,onScroll:Ft,onStartMove:He,onStopMove:ve,spinSize:Pe,containerSize:Ue.height,style:Z==null?void 0:Z.verticalScrollBar,thumbStyle:Z==null?void 0:Z.verticalScrollBarThumb}),F&&v>Ue.width&&y.createElement(CM,{ref:Te,prefixCls:i,scrollOffset:me,scrollRange:v,rtl:L,onScroll:Ft,onStartMove:He,onStopMove:ve,spinSize:ue,containerSize:Ue.width,horizontal:!0,style:Z==null?void 0:Z.horizontalScrollBar,thumbStyle:Z==null?void 0:Z.horizontalScrollBarThumb}))}var pY=y.forwardRef(D7);pY.displayName="List";function O7(){return/(mac\sos|macintosh)/i.test(navigator.appVersion)}var J7=["disabled","title","children","style","className"];function fM(t){return typeof t=="string"||typeof t=="number"}var Q7=function(e,n){var i=Ej(),r=i.prefixCls,o=i.id,a=i.open,s=i.multiple,l=i.mode,c=i.searchValue,g=i.toggleOpen,u=i.notFoundContent,d=i.onPopupScroll,C=y.useContext(vZ),f=C.maxCount,v=C.flattenOptions,p=C.onActiveValue,m=C.defaultActiveFirstOption,A=C.onSelect,b=C.menuItemSelectedIcon,G=C.rawValues,w=C.fieldNames,S=C.virtual,Z=C.direction,x=C.listHeight,R=C.listItemHeight,W=C.optionRender,M="".concat(r,"-item"),N=Ph(function(){return v},[a,v],function(Se,me){return me[0]&&Se[1]!==me[1]}),X=y.useRef(null),E=y.useMemo(function(){return s&&cS(f)&&(G==null?void 0:G.size)>=f},[s,f,G==null?void 0:G.size]),Q=function(me){me.preventDefault()},k=function(me){var T;(T=X.current)===null||T===void 0||T.scrollTo(typeof me=="number"?{index:me}:me)},J=function(me){for(var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,Ge=N.length,ne=0;ne<Ge;ne+=1){var he=(me+ne*T+Ge)%Ge,ae=N[he]||{},He=ae.group,ve=ae.data;if(!He&&!(ve!=null&&ve.disabled)&&!E)return he}return-1},F=y.useState(function(){return J(0)}),L=De(F,2),z=L[0],K=L[1],O=function(me){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;K(me);var Ge={source:T?"keyboard":"mouse"},ne=N[me];if(!ne){p(null,-1,Ge);return}p(ne.value,me,Ge)};y.useEffect(function(){O(m!==!1?J(0):-1)},[N.length,c]);var j=y.useCallback(function(Se){return G.has(Se)&&l!=="combobox"},[l,Et(G).toString(),G.size]);y.useEffect(function(){var Se=setTimeout(function(){if(!s&&a&&G.size===1){var T=Array.from(G)[0],Ge=N.findIndex(function(ne){var he=ne.data;return he.value===T});Ge!==-1&&(O(Ge),k(Ge))}});if(a){var me;(me=X.current)===null||me===void 0||me.scrollTo(void 0)}return function(){return clearTimeout(Se)}},[a,c]);var P=function(me){me!==void 0&&A(me,{selected:!G.has(me)}),s||g(!1)};if(y.useImperativeHandle(n,function(){return{onKeyDown:function(me){var T=me.which,Ge=me.ctrlKey;switch(T){case Ct.N:case Ct.P:case Ct.UP:case Ct.DOWN:{var ne=0;if(T===Ct.UP?ne=-1:T===Ct.DOWN?ne=1:O7()&&Ge&&(T===Ct.N?ne=1:T===Ct.P&&(ne=-1)),ne!==0){var he=J(z+ne,ne);k(he),O(he,!0)}break}case Ct.ENTER:{var ae,He=N[z];He&&!(He!=null&&(ae=He.data)!==null&&ae!==void 0&&ae.disabled)&&!E?P(He.value):P(void 0),a&&me.preventDefault();break}case Ct.ESC:g(!1),a&&me.stopPropagation()}},onKeyUp:function(){},scrollTo:function(me){k(me)}}}),N.length===0)return y.createElement("div",{role:"listbox",id:"".concat(o,"_list"),className:"".concat(M,"-empty"),onMouseDown:Q},u);var $=Object.keys(w).map(function(Se){return w[Se]}),oe=function(me){return me.label};function ie(Se,me){var T=Se.group;return{role:T?"presentation":"option",id:"".concat(o,"_list_").concat(me)}}var de=function(me){var T=N[me];if(!T)return null;var Ge=T.data||{},ne=Ge.value,he=T.group,ae=ll(Ge,!0),He=oe(T);return T?y.createElement("div",Zt({"aria-label":typeof He=="string"&&!he?He:null},ae,{key:me},ie(T,me),{"aria-selected":j(ne)}),ne):null},Ve={role:"listbox",id:"".concat(o,"_list")};return y.createElement(y.Fragment,null,S&&y.createElement("div",Zt({},Ve,{style:{height:0,width:0,overflow:"hidden"}}),de(z-1),de(z),de(z+1)),y.createElement(pY,{itemKey:"key",ref:X,data:N,height:x,itemHeight:R,fullHeight:!1,onMouseDown:Q,onScroll:d,virtual:S,direction:Z,innerProps:S?null:Ve},function(Se,me){var T=Se.group,Ge=Se.groupOption,ne=Se.data,he=Se.label,ae=Se.value,He=ne.key;if(T){var ve,Me=(ve=ne.title)!==null&&ve!==void 0?ve:fM(he)?he.toString():void 0;return y.createElement("div",{className:qe(M,"".concat(M,"-group"),ne.className),title:Me},he!==void 0?he:He)}var q=ne.disabled,Y=ne.title;ne.children;var Ce=ne.style,se=ne.className,fe=An(ne,J7),Ze=$a(fe,$),Oe=j(ae),Fe=q||!Oe&&E,Ee="".concat(M,"-option"),Qe=qe(M,Ee,se,we(we(we(we({},"".concat(Ee,"-grouped"),Ge),"".concat(Ee,"-active"),z===me&&!Fe),"".concat(Ee,"-disabled"),Fe),"".concat(Ee,"-selected"),Oe)),Ye=oe(Se),$e=!b||typeof b=="function"||Oe,st=typeof Ye=="number"?Ye:Ye||ae,Ue=fM(st)?st.toString():void 0;return Y!==void 0&&(Ue=Y),y.createElement("div",Zt({},ll(Ze),S?{}:ie(Se,me),{"aria-selected":Oe,className:Qe,title:Ue,onMouseMove:function(){z===me||Fe||O(me)},onClick:function(){Fe||P(ae)},style:Ce}),y.createElement("div",{className:"".concat(Ee,"-content")},typeof W=="function"?W(Se,{index:me}):st),y.isValidElement(b)||Oe,$e&&y.createElement(yv,{className:"".concat(M,"-option-state"),customizeIcon:b,customizeIconProps:{value:ae,disabled:Fe,isSelected:Oe}},Oe?"":null))}))},j7=y.forwardRef(Q7);const $7=function(t,e){var n=y.useRef({values:new Map,options:new Map}),i=y.useMemo(function(){var o=n.current,a=o.values,s=o.options,l=t.map(function(u){if(u.label===void 0){var d;return Re(Re({},u),{},{label:(d=a.get(u.value))===null||d===void 0?void 0:d.label})}return u}),c=new Map,g=new Map;return l.forEach(function(u){c.set(u.value,u),g.set(u.value,e.get(u.value)||s.get(u.value))}),n.current.values=c,n.current.options=g,l},[t,e]),r=y.useCallback(function(o){return e.get(o)||n.current.options.get(o)},[e]);return[i,r]};function rG(t,e){return CY(t).join("").toUpperCase().includes(e)}const q7=function(t,e,n,i,r){return y.useMemo(function(){if(!n||i===!1)return t;var o=e.options,a=e.label,s=e.value,l=[],c=typeof i=="function",g=n.toUpperCase(),u=c?i:function(C,f){return r?rG(f[r],g):f[o]?rG(f[a!=="children"?a:"label"],g):rG(f[s],g)},d=c?function(C){return gS(C)}:function(C){return C};return t.forEach(function(C){if(C[o]){var f=u(n,d(C));if(f)l.push(C);else{var v=C[o].filter(function(p){return u(n,d(p))});v.length&&l.push(Re(Re({},C),{},we({},o,v)))}return}u(n,d(C))&&l.push(C)}),l},[t,i,r,n,e])};var mM=0,e8=eo();function t8(){var t;return e8?(t=mM,mM+=1):t="TEST_OR_SSR",t}function n8(t){var e=y.useState(),n=De(e,2),i=n[0],r=n[1];return y.useEffect(function(){r("rc_select_".concat(t8()))},[]),t||i}var i8=["children","value"],r8=["children"];function o8(t){var e=t,n=e.key,i=e.props,r=i.children,o=i.value,a=An(i,i8);return Re({key:n,value:o!==void 0?o:n,children:r},a)}function vY(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return Rg(t).map(function(n,i){if(!y.isValidElement(n)||!n.type)return null;var r=n,o=r.type.isSelectOptGroup,a=r.key,s=r.props,l=s.children,c=An(s,r8);return e||!o?o8(n):Re(Re({key:"__RC_SELECT_GRP__".concat(a===null?i:a,"__"),label:a},c),{},{options:vY(l)})}).filter(function(n){return n})}var a8=function(e,n,i,r,o){return y.useMemo(function(){var a=e,s=!e;s&&(a=vY(n));var l=new Map,c=new Map,g=function(C,f,v){v&&typeof v=="string"&&C.set(f[v],f)},u=function d(C){for(var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,v=0;v<C.length;v+=1){var p=C[v];!p[i.options]||f?(l.set(p[i.value],p),g(c,p,i.label),g(c,p,r),g(c,p,o)):d(p[i.options],!0)}};return u(a),{options:a,valueOptions:l,labelOptions:c}},[e,n,i,r,o])};function AM(t){var e=y.useRef();e.current=t;var n=y.useCallback(function(){return e.current.apply(e,arguments)},[]);return n}var s8=["id","mode","prefixCls","backfill","fieldNames","inputValue","searchValue","onSearch","autoClearSearchValue","onSelect","onDeselect","dropdownMatchSelectWidth","filterOption","filterSort","optionFilterProp","optionLabelProp","options","optionRender","children","defaultActiveFirstOption","menuItemSelectedIcon","virtual","direction","listHeight","listItemHeight","labelRender","value","defaultValue","labelInValue","onChange","maxCount"],l8=["inputValue"];function c8(t){return!t||qt(t)!=="object"}var g8=y.forwardRef(function(t,e){var n=t.id,i=t.mode,r=t.prefixCls,o=r===void 0?"rc-select":r,a=t.backfill,s=t.fieldNames,l=t.inputValue,c=t.searchValue,g=t.onSearch,u=t.autoClearSearchValue,d=u===void 0?!0:u,C=t.onSelect,f=t.onDeselect,v=t.dropdownMatchSelectWidth,p=v===void 0?!0:v,m=t.filterOption,A=t.filterSort,b=t.optionFilterProp,G=t.optionLabelProp,w=t.options,S=t.optionRender,Z=t.children,x=t.defaultActiveFirstOption,R=t.menuItemSelectedIcon,W=t.virtual,M=t.direction,N=t.listHeight,X=N===void 0?200:N,E=t.listItemHeight,Q=E===void 0?20:E,k=t.labelRender,J=t.value,F=t.defaultValue,L=t.labelInValue,z=t.onChange,K=t.maxCount,O=An(t,s8),j=n8(n),P=uS(i),$=!!(!w&&Z),oe=y.useMemo(function(){return m===void 0&&i==="combobox"?!1:m},[m,i]),ie=y.useMemo(function(){return fY(s,$)},[JSON.stringify(s),$]),de=$r("",{value:c!==void 0?c:l,postState:function(At){return At||""}}),Ve=De(de,2),Se=Ve[0],me=Ve[1],T=a8(w,Z,ie,b,G),Ge=T.valueOptions,ne=T.labelOptions,he=T.options,ae=y.useCallback(function(ft){var At=CY(ft);return At.map(function(Gt){var Bt,Yt,St,sn,Ot;if(c8(Gt))Bt=Gt;else{var U;St=Gt.key,Yt=Gt.label,Bt=(U=Gt.value)!==null&&U!==void 0?U:St}var ee=Ge.get(Bt);if(ee){var Be;Yt===void 0&&(Yt=ee==null?void 0:ee[G||ie.label]),St===void 0&&(St=(Be=ee==null?void 0:ee.key)!==null&&Be!==void 0?Be:Bt),sn=ee==null?void 0:ee.disabled,Ot=ee==null?void 0:ee.title}return{label:Yt,value:Bt,key:St,disabled:sn,title:Ot}})},[ie,G,Ge]),He=$r(F,{value:J}),ve=De(He,2),Me=ve[0],q=ve[1],Y=y.useMemo(function(){var ft,At=P&&Me===null?[]:Me,Gt=ae(At);return i==="combobox"&&n7((ft=Gt[0])===null||ft===void 0?void 0:ft.value)?[]:Gt},[Me,ae,i,P]),Ce=$7(Y,Ge),se=De(Ce,2),fe=se[0],Ze=se[1],Oe=y.useMemo(function(){if(!i&&fe.length===1){var ft=fe[0];if(ft.value===null&&(ft.label===null||ft.label===void 0))return[]}return fe.map(function(At){var Gt;return Re(Re({},At),{},{label:(Gt=typeof k=="function"?k(At):At.label)!==null&&Gt!==void 0?Gt:At.value})})},[i,fe,k]),Fe=y.useMemo(function(){return new Set(fe.map(function(ft){return ft.value}))},[fe]);y.useEffect(function(){if(i==="combobox"){var ft,At=(ft=fe[0])===null||ft===void 0?void 0:ft.value;me(t7(At)?String(At):"")}},[fe]);var Ee=AM(function(ft,At){var Gt=At??ft;return we(we({},ie.value,ft),ie.label,Gt)}),Qe=y.useMemo(function(){if(i!=="tags")return he;var ft=Et(he),At=function(Bt){return Ge.has(Bt)};return Et(fe).sort(function(Gt,Bt){return Gt.value<Bt.value?-1:1}).forEach(function(Gt){var Bt=Gt.value;At(Bt)||ft.push(Ee(Bt,Gt.label))}),ft},[Ee,he,Ge,fe,i]),Ye=q7(Qe,ie,Se,oe,b),$e=y.useMemo(function(){return i!=="tags"||!Se||Ye.some(function(ft){return ft[b||"value"]===Se})||Ye.some(function(ft){return ft[ie.value]===Se})?Ye:[Ee(Se)].concat(Et(Ye))},[Ee,b,i,Ye,Se,ie]),st=function ft(At){var Gt=Et(At).sort(function(Bt,Yt){return A(Bt,Yt,{searchValue:Se})});return Gt.map(function(Bt){return Array.isArray(Bt.options)?Re(Re({},Bt),{},{options:Bt.options.length>0?ft(Bt.options):Bt.options}):Bt})},Ue=y.useMemo(function(){return A?st($e):$e},[$e,A,Se]),Ne=y.useMemo(function(){return w7(Ue,{fieldNames:ie,childrenAsData:$})},[Ue,ie,$]),je=function(At){var Gt=ae(At);if(q(Gt),z&&(Gt.length!==fe.length||Gt.some(function(St,sn){var Ot;return((Ot=fe[sn])===null||Ot===void 0?void 0:Ot.value)!==(St==null?void 0:St.value)}))){var Bt=L?Gt:Gt.map(function(St){return St.value}),Yt=Gt.map(function(St){return gS(Ze(St.value))});z(P?Bt:Bt[0],P?Yt:Yt[0])}},Ie=y.useState(null),Te=De(Ie,2),ue=Te[0],Pe=Te[1],be=y.useState(0),Le=De(be,2),ct=Le[0],dt=Le[1],It=x!==void 0?x:i!=="combobox",Vt=y.useCallback(function(ft,At){var Gt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Bt=Gt.source,Yt=Bt===void 0?"keyboard":Bt;dt(At),a&&i==="combobox"&&ft!==null&&Yt==="keyboard"&&Pe(String(ft))},[a,i]),vt=function(At,Gt,Bt){var Yt=function(){var le,re=Ze(At);return[L?{label:re==null?void 0:re[ie.label],value:At,key:(le=re==null?void 0:re.key)!==null&&le!==void 0?le:At}:At,gS(re)]};if(Gt&&C){var St=Yt(),sn=De(St,2),Ot=sn[0],U=sn[1];C(Ot,U)}else if(!Gt&&f&&Bt!=="clear"){var ee=Yt(),Be=De(ee,2),_=Be[0],te=Be[1];f(_,te)}},et=AM(function(ft,At){var Gt,Bt=P?At.selected:!0;Bt?Gt=P?[].concat(Et(fe),[ft]):[ft]:Gt=fe.filter(function(Yt){return Yt.value!==ft}),je(Gt),vt(ft,Bt),i==="combobox"?Pe(""):(!uS||d)&&(me(""),Pe(""))}),rt=function(At,Gt){je(At);var Bt=Gt.type,Yt=Gt.values;(Bt==="remove"||Bt==="clear")&&Yt.forEach(function(St){vt(St.value,!1,Bt)})},ut=function(At,Gt){if(me(At),Pe(null),Gt.source==="submit"){var Bt=(At||"").trim();if(Bt){var Yt=Array.from(new Set([].concat(Et(Fe),[Bt])));je(Yt),vt(Bt,!0),me("")}return}Gt.source!=="blur"&&(i==="combobox"&&je(At),g==null||g(At))},Tt=function(At){var Gt=At;i!=="tags"&&(Gt=At.map(function(Yt){var St=ne.get(Yt);return St==null?void 0:St.value}).filter(function(Yt){return Yt!==void 0}));var Bt=Array.from(new Set([].concat(Et(Fe),Et(Gt))));je(Bt),Bt.forEach(function(Yt){vt(Yt,!0)})},Ft=y.useMemo(function(){var ft=W!==!1&&p!==!1;return Re(Re({},T),{},{flattenOptions:Ne,onActiveValue:Vt,defaultActiveFirstOption:It,onSelect:et,menuItemSelectedIcon:R,rawValues:Fe,fieldNames:ie,virtual:ft,direction:M,listHeight:X,listItemHeight:Q,childrenAsData:$,maxCount:K,optionRender:S})},[K,T,Ne,Vt,It,et,R,Fe,ie,W,p,M,X,Q,$,S]);return y.createElement(vZ.Provider,{value:Ft},y.createElement(V7,Zt({},O,{id:j,prefixCls:o,ref:e,omitDomProps:l8,mode:i,displayValues:Oe,onDisplayValuesChange:rt,direction:M,searchValue:Se,onSearch:ut,autoClearSearchValue:d,onSearchSplit:Tt,dropdownMatchSelectWidth:p,OptionList:j7,emptyOptions:!Ne.length,activeValue:ue,activeDescendantId:"".concat(j,"_list_").concat(ct)})))}),GZ=g8;GZ.Option=yZ;GZ.OptGroup=bZ;function e0(t,e,n){return qe({[`${t}-status-success`]:e==="success",[`${t}-status-warning`]:e==="warning",[`${t}-status-error`]:e==="error",[`${t}-status-validating`]:e==="validating",[`${t}-has-feedback`]:n})}const Gv=(t,e)=>e||t,u8=()=>{const[,t]=Qo(),n=new Pi(t.colorBgBase).toHsl().l<.5?{opacity:.65}:{};return y.createElement("svg",{style:n,width:"184",height:"152",viewBox:"0 0 184 152",xmlns:"http://www.w3.org/2000/svg"},y.createElement("title",null,"empty image"),y.createElement("g",{fill:"none",fillRule:"evenodd"},y.createElement("g",{transform:"translate(24 31.67)"},y.createElement("ellipse",{fillOpacity:".8",fill:"#F5F5F7",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"}),y.createElement("path",{d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z",fill:"#AEB8C2"}),y.createElement("path",{d:"M101.537 86.214L80.63 61.102c-1.001-1.207-2.507-1.867-4.048-1.867H31.724c-1.54 0-3.047.66-4.048 1.867L6.769 86.214v13.792h94.768V86.214z",fill:"url(#linearGradient-1)",transform:"translate(13.56)"}),y.createElement("path",{d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z",fill:"#F5F5F7"}),y.createElement("path",{d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z",fill:"#DCE0E6"})),y.createElement("path",{d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z",fill:"#DCE0E6"}),y.createElement("g",{transform:"translate(149.65 15.383)",fill:"#FFF"},y.createElement("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"}),y.createElement("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"}))))},d8=()=>{const[,t]=Qo(),{colorFill:e,colorFillTertiary:n,colorFillQuaternary:i,colorBgContainer:r}=t,{borderColor:o,shadowColor:a,contentColor:s}=y.useMemo(()=>({borderColor:new Pi(e).onBackground(r).toHexShortString(),shadowColor:new Pi(n).onBackground(r).toHexShortString(),contentColor:new Pi(i).onBackground(r).toHexShortString()}),[e,n,i,r]);return y.createElement("svg",{width:"64",height:"41",viewBox:"0 0 64 41",xmlns:"http://www.w3.org/2000/svg"},y.createElement("title",null,"Simple Empty"),y.createElement("g",{transform:"translate(0 1)",fill:"none",fillRule:"evenodd"},y.createElement("ellipse",{fill:a,cx:"32",cy:"33",rx:"32",ry:"7"}),y.createElement("g",{fillRule:"nonzero",stroke:o},y.createElement("path",{d:"M55 12.76L44.854 1.258C44.367.474 43.656 0 42.907 0H21.093c-.749 0-1.46.474-1.947 1.257L9 12.761V22h46v-9.24z"}),y.createElement("path",{d:"M41.613 15.931c0-1.605.994-2.93 2.227-2.931H55v18.137C55 33.26 53.68 35 52.05 35h-40.1C10.32 35 9 33.259 9 31.137V13h11.16c1.233 0 2.227 1.323 2.227 2.928v.022c0 1.605 1.005 2.901 2.237 2.901h14.752c1.232 0 2.237-1.308 2.237-2.913v-.007z",fill:s}))))},I8=t=>{const{componentCls:e,margin:n,marginXS:i,marginXL:r,fontSize:o,lineHeight:a}=t;return{[e]:{marginInline:i,fontSize:o,lineHeight:a,textAlign:"center",[`${e}-image`]:{height:t.emptyImgHeight,marginBottom:i,opacity:t.opacityImage,img:{height:"100%"},svg:{maxWidth:"100%",height:"100%",margin:"auto"}},[`${e}-description`]:{color:t.colorTextDescription},[`${e}-footer`]:{marginTop:n},"&-normal":{marginBlock:r,color:t.colorTextDescription,[`${e}-description`]:{color:t.colorTextDescription},[`${e}-image`]:{height:t.emptyImgHeightMD}},"&-small":{marginBlock:i,color:t.colorTextDescription,[`${e}-image`]:{height:t.emptyImgHeightSM}}}}},C8=yo("Empty",t=>{const{componentCls:e,controlHeightLG:n,calc:i}=t,r=ci(t,{emptyImgCls:`${e}-img`,emptyImgHeight:i(n).mul(2.5).equal(),emptyImgHeightMD:n,emptyImgHeightSM:i(n).mul(.875).equal()});return[I8(r)]});var h8=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const bY=y.createElement(u8,null),yY=y.createElement(d8,null),qc=t=>{var{className:e,rootClassName:n,prefixCls:i,image:r=bY,description:o,children:a,imageStyle:s,style:l}=t,c=h8(t,["className","rootClassName","prefixCls","image","description","children","imageStyle","style"]);const{getPrefixCls:g,direction:u,empty:d}=y.useContext(yn),C=g("empty",i),[f,v,p]=C8(C),[m]=Uh("Empty"),A=typeof o<"u"?o:m==null?void 0:m.description,b=typeof A=="string"?A:"empty";let G=null;return typeof r=="string"?G=y.createElement("img",{alt:b,src:r}):G=r,f(y.createElement("div",Object.assign({className:qe(v,p,C,d==null?void 0:d.className,{[`${C}-normal`]:r===yY,[`${C}-rtl`]:u==="rtl"},e,n),style:Object.assign(Object.assign({},d==null?void 0:d.style),l)},c),y.createElement("div",{className:`${C}-image`,style:s},G),A&&y.createElement("div",{className:`${C}-description`},A),a&&y.createElement("div",{className:`${C}-footer`},a)))};qc.PRESENTED_IMAGE_DEFAULT=bY;qc.PRESENTED_IMAGE_SIMPLE=yY;const GY=t=>{const{componentName:e}=t,{getPrefixCls:n}=y.useContext(yn),i=n("empty");switch(e){case"Table":case"List":return ze.createElement(qc,{image:qc.PRESENTED_IMAGE_SIMPLE});case"Select":case"TreeSelect":case"Cascader":case"Transfer":case"Mentions":return ze.createElement(qc,{image:qc.PRESENTED_IMAGE_SIMPLE,className:`${i}-small`});case"Table.filter":return null;default:return ze.createElement(qc,null)}},BZ=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;var i,r;const{variant:o,[t]:a}=y.useContext(yn),s=y.useContext(DQ),l=a==null?void 0:a.variant;let c;typeof e<"u"?c=e:n===!1?c="borderless":c=(r=(i=s??l)!==null&&i!==void 0?i:o)!==null&&r!==void 0?r:"outlined";const g=gD.includes(c);return[c,g]},f8=t=>{const n={overflow:{adjustX:!0,adjustY:!0,shiftY:!0},htmlRegion:t==="scroll"?"scroll":"visible",dynamicInset:!0};return{bottomLeft:Object.assign(Object.assign({},n),{points:["tl","bl"],offset:[0,4]}),bottomRight:Object.assign(Object.assign({},n),{points:["tr","br"],offset:[0,4]}),topLeft:Object.assign(Object.assign({},n),{points:["bl","tl"],offset:[0,-4]}),topRight:Object.assign(Object.assign({},n),{points:["br","tr"],offset:[0,-4]})}};function m8(t,e){return t||f8(e)}const pM=t=>{const{optionHeight:e,optionFontSize:n,optionLineHeight:i,optionPadding:r}=t;return{position:"relative",display:"block",minHeight:e,padding:r,color:t.colorText,fontWeight:"normal",fontSize:n,lineHeight:i,boxSizing:"border-box"}},A8=t=>{const{antCls:e,componentCls:n}=t,i=`${n}-item`,r=`&${e}-slide-up-enter${e}-slide-up-enter-active`,o=`&${e}-slide-up-appear${e}-slide-up-appear-active`,a=`&${e}-slide-up-leave${e}-slide-up-leave-active`,s=`${n}-dropdown-placement-`;return[{[`${n}-dropdown`]:Object.assign(Object.assign({},ba(t)),{position:"absolute",top:-9999,zIndex:t.zIndexPopup,boxSizing:"border-box",padding:t.paddingXXS,overflow:"hidden",fontSize:t.fontSize,fontVariant:"initial",backgroundColor:t.colorBgElevated,borderRadius:t.borderRadiusLG,outline:"none",boxShadow:t.boxShadowSecondary,[`
          ${r}${s}bottomLeft,
          ${o}${s}bottomLeft
        `]:{animationName:SE},[`
          ${r}${s}topLeft,
          ${o}${s}topLeft,
          ${r}${s}topRight,
          ${o}${s}topRight
        `]:{animationName:ZE},[`${a}${s}bottomLeft`]:{animationName:wE},[`
          ${a}${s}topLeft,
          ${a}${s}topRight
        `]:{animationName:xE},"&-hidden":{display:"none"},[i]:Object.assign(Object.assign({},pM(t)),{cursor:"pointer",transition:`background ${t.motionDurationSlow} ease`,borderRadius:t.borderRadiusSM,"&-group":{color:t.colorTextDescription,fontSize:t.fontSizeSM,cursor:"default"},"&-option":{display:"flex","&-content":Object.assign({flex:"auto"},Xd),"&-state":{flex:"none",display:"flex",alignItems:"center"},[`&-active:not(${i}-option-disabled)`]:{backgroundColor:t.optionActiveBg},[`&-selected:not(${i}-option-disabled)`]:{color:t.optionSelectedColor,fontWeight:t.optionSelectedFontWeight,backgroundColor:t.optionSelectedBg,[`${i}-option-state`]:{color:t.colorPrimary},[`&:has(+ ${i}-option-selected:not(${i}-option-disabled))`]:{borderEndStartRadius:0,borderEndEndRadius:0,[`& + ${i}-option-selected:not(${i}-option-disabled)`]:{borderStartStartRadius:0,borderStartEndRadius:0}}},"&-disabled":{[`&${i}-option-selected`]:{backgroundColor:t.colorBgContainerDisabled},color:t.colorTextDisabled,cursor:"not-allowed"},"&-grouped":{paddingInlineStart:t.calc(t.controlPaddingHorizontal).mul(2).equal()}},"&-empty":Object.assign(Object.assign({},pM(t)),{color:t.colorTextDisabled})}),"&-rtl":{direction:"rtl"}})},jp(t,"slide-up"),jp(t,"slide-down"),BV(t,"move-up"),BV(t,"move-down")]},p8=t=>{const{multipleSelectItemHeight:e,paddingXXS:n,lineWidth:i,INTERNAL_FIXED_ITEM_MARGIN:r}=t,o=t.max(t.calc(n).sub(i).equal(),0),a=t.max(t.calc(o).sub(r).equal(),0);return{basePadding:o,containerPadding:a,itemHeight:Je(e),itemLineHeight:Je(t.calc(e).sub(t.calc(t.lineWidth).mul(2)).equal())}},v8=t=>{const{multipleSelectItemHeight:e,selectHeight:n,lineWidth:i}=t;return t.calc(n).sub(e).div(2).sub(i).equal()},b8=t=>{const{componentCls:e,iconCls:n,borderRadiusSM:i,motionDurationSlow:r,paddingXS:o,multipleItemColorDisabled:a,multipleItemBorderColorDisabled:s,colorIcon:l,colorIconHover:c,INTERNAL_FIXED_ITEM_MARGIN:g}=t;return{[`${e}-selection-overflow`]:{position:"relative",display:"flex",flex:"auto",flexWrap:"wrap",maxWidth:"100%","&-item":{flex:"none",alignSelf:"center",maxWidth:"100%",display:"inline-flex"},[`${e}-selection-item`]:{display:"flex",alignSelf:"center",flex:"none",boxSizing:"border-box",maxWidth:"100%",marginBlock:g,borderRadius:i,cursor:"default",transition:`font-size ${r}, line-height ${r}, height ${r}`,marginInlineEnd:t.calc(g).mul(2).equal(),paddingInlineStart:o,paddingInlineEnd:t.calc(o).div(2).equal(),[`${e}-disabled&`]:{color:a,borderColor:s,cursor:"not-allowed"},"&-content":{display:"inline-block",marginInlineEnd:t.calc(o).div(2).equal(),overflow:"hidden",whiteSpace:"pre",textOverflow:"ellipsis"},"&-remove":Object.assign(Object.assign({},nZ()),{display:"inline-flex",alignItems:"center",color:l,fontWeight:"bold",fontSize:10,lineHeight:"inherit",cursor:"pointer",[`> ${n}`]:{verticalAlign:"-0.2em"},"&:hover":{color:c}})}}}},y8=(t,e)=>{const{componentCls:n,INTERNAL_FIXED_ITEM_MARGIN:i}=t,r=`${n}-selection-overflow`,o=t.multipleSelectItemHeight,a=v8(t),s=e?`${n}-${e}`:"",l=p8(t);return{[`${n}-multiple${s}`]:Object.assign(Object.assign({},b8(t)),{[`${n}-selector`]:{display:"flex",flexWrap:"wrap",alignItems:"center",height:"100%",paddingInline:l.basePadding,paddingBlock:l.containerPadding,borderRadius:t.borderRadius,[`${n}-disabled&`]:{background:t.multipleSelectorBgDisabled,cursor:"not-allowed"},"&:after":{display:"inline-block",width:0,margin:`${Je(i)} 0`,lineHeight:Je(o),visibility:"hidden",content:'"\\a0"'}},[`${n}-selection-item`]:{height:l.itemHeight,lineHeight:Je(l.itemLineHeight)},[`${r}-item + ${r}-item`]:{[`${n}-selection-search`]:{marginInlineStart:0}},[`${r}-item-suffix`]:{height:"100%"},[`${n}-selection-search`]:{display:"inline-flex",position:"relative",maxWidth:"100%",marginInlineStart:t.calc(t.inputPaddingHorizontalBase).sub(a).equal(),"\n          &-input,\n          &-mirror\n        ":{height:o,fontFamily:t.fontFamily,lineHeight:Je(o),transition:`all ${t.motionDurationSlow}`},"&-input":{width:"100%",minWidth:4.1},"&-mirror":{position:"absolute",top:0,insetInlineStart:0,insetInlineEnd:"auto",zIndex:999,whiteSpace:"pre",visibility:"hidden"}},[`${n}-selection-placeholder`]:{position:"absolute",top:"50%",insetInlineStart:t.inputPaddingHorizontalBase,insetInlineEnd:t.inputPaddingHorizontalBase,transform:"translateY(-50%)",transition:`all ${t.motionDurationSlow}`}})}};function oG(t,e){const{componentCls:n}=t,i=e?`${n}-${e}`:"",r={[`${n}-multiple${i}`]:{fontSize:t.fontSize,[`${n}-selector`]:{[`${n}-show-search&`]:{cursor:"text"}},[`
        &${n}-show-arrow ${n}-selector,
        &${n}-allow-clear ${n}-selector
      `]:{paddingInlineEnd:t.calc(t.fontSizeIcon).add(t.controlPaddingHorizontal).equal()}}};return[y8(t,e),r]}const G8=t=>{const{componentCls:e}=t,n=ci(t,{selectHeight:t.controlHeightSM,multipleSelectItemHeight:t.multipleItemHeightSM,borderRadius:t.borderRadiusSM,borderRadiusSM:t.borderRadiusXS}),i=ci(t,{fontSize:t.fontSizeLG,selectHeight:t.controlHeightLG,multipleSelectItemHeight:t.multipleItemHeightLG,borderRadius:t.borderRadiusLG,borderRadiusSM:t.borderRadius});return[oG(t),oG(n,"sm"),{[`${e}-multiple${e}-sm`]:{[`${e}-selection-placeholder`]:{insetInline:t.calc(t.controlPaddingHorizontalSM).sub(t.lineWidth).equal()},[`${e}-selection-search`]:{marginInlineStart:2}}},oG(i,"lg")]};function aG(t,e){const{componentCls:n,inputPaddingHorizontalBase:i,borderRadius:r,fontSizeIcon:o}=t,a=t.calc(t.controlHeight).sub(t.calc(t.lineWidth).mul(2)).equal(),s=t.calc(i).add(o).equal(),l=e?`${n}-${e}`:"";return{[`${n}-single${l}`]:{fontSize:t.fontSize,height:t.controlHeight,[`${n}-selector`]:Object.assign(Object.assign({},ba(t,!0)),{display:"flex",borderRadius:r,[`${n}-selection-search`]:{position:"absolute",top:0,insetInlineStart:i,insetInlineEnd:Je(s),bottom:0,"&-input":{width:"100%",WebkitAppearance:"textfield"}},[`
          ${n}-selection-item,
          ${n}-selection-placeholder
        `]:{padding:0,lineHeight:Je(a),transition:`all ${t.motionDurationSlow}, visibility 0s`,alignSelf:"center"},[`${n}-selection-placeholder`]:{transition:"none",pointerEvents:"none"},[["&:after",`${n}-selection-item:empty:after`,`${n}-selection-placeholder:empty:after`].join(",")]:{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'}}),[`
        &${n}-show-arrow ${n}-selection-item,
        &${n}-show-arrow ${n}-selection-placeholder
      `]:{paddingInlineEnd:t.showArrowPaddingInlineEnd},[`&${n}-open ${n}-selection-item`]:{color:t.colorTextPlaceholder},[`&:not(${n}-customize-input)`]:{[`${n}-selector`]:{width:"100%",height:"100%",padding:`0 ${Je(i)}`,[`${n}-selection-search-input`]:{height:a},"&:after":{lineHeight:Je(a)}}},[`&${n}-customize-input`]:{[`${n}-selector`]:{"&:after":{display:"none"},[`${n}-selection-search`]:{position:"static",width:"100%"},[`${n}-selection-placeholder`]:{position:"absolute",insetInlineStart:0,insetInlineEnd:0,padding:`0 ${Je(i)}`,"&:after":{display:"none"}}}}}}}function B8(t){const{componentCls:e}=t,n=t.calc(t.controlPaddingHorizontalSM).sub(t.lineWidth).equal();return[aG(t),aG(ci(t,{controlHeight:t.controlHeightSM,borderRadius:t.borderRadiusSM}),"sm"),{[`${e}-single${e}-sm`]:{[`&:not(${e}-customize-input)`]:{[`${e}-selection-search`]:{insetInlineStart:n,insetInlineEnd:n},[`${e}-selector`]:{padding:`0 ${Je(n)}`},[`&${e}-show-arrow ${e}-selection-search`]:{insetInlineEnd:t.calc(n).add(t.calc(t.fontSize).mul(1.5)).equal()},[`
            &${e}-show-arrow ${e}-selection-item,
            &${e}-show-arrow ${e}-selection-placeholder
          `]:{paddingInlineEnd:t.calc(t.fontSize).mul(1.5).equal()}}}},aG(ci(t,{controlHeight:t.singleItemHeightLG,fontSize:t.fontSizeLG,borderRadius:t.borderRadiusLG}),"lg")]}const S8=t=>{const{fontSize:e,lineHeight:n,lineWidth:i,controlHeight:r,controlHeightSM:o,controlHeightLG:a,paddingXXS:s,controlPaddingHorizontal:l,zIndexPopupBase:c,colorText:g,fontWeightStrong:u,controlItemBgActive:d,controlItemBgHover:C,colorBgContainer:f,colorFillSecondary:v,colorBgContainerDisabled:p,colorTextDisabled:m,colorPrimaryHover:A,colorPrimary:b,controlOutline:G}=t,w=s*2,S=i*2,Z=Math.min(r-w,r-S),x=Math.min(o-w,o-S),R=Math.min(a-w,a-S);return{INTERNAL_FIXED_ITEM_MARGIN:Math.floor(s/2),zIndexPopup:c+50,optionSelectedColor:g,optionSelectedFontWeight:u,optionSelectedBg:d,optionActiveBg:C,optionPadding:`${(r-e*n)/2}px ${l}px`,optionFontSize:e,optionLineHeight:n,optionHeight:r,selectorBg:f,clearBg:f,singleItemHeightLG:a,multipleItemBg:v,multipleItemBorderColor:"transparent",multipleItemHeight:Z,multipleItemHeightSM:x,multipleItemHeightLG:R,multipleSelectorBgDisabled:p,multipleItemColorDisabled:m,multipleItemBorderColorDisabled:"transparent",showArrowPaddingInlineEnd:Math.ceil(t.fontSize*1.25),hoverBorderColor:A,activeBorderColor:b,activeOutlineColor:G}},BY=(t,e)=>{const{componentCls:n,antCls:i,controlOutlineWidth:r}=t;return{[`&:not(${n}-customize-input) ${n}-selector`]:{border:`${Je(t.lineWidth)} ${t.lineType} ${e.borderColor}`,background:t.selectorBg},[`&:not(${n}-disabled):not(${n}-customize-input):not(${i}-pagination-size-changer)`]:{[`&:hover ${n}-selector`]:{borderColor:e.hoverBorderHover},[`${n}-focused& ${n}-selector`]:{borderColor:e.activeBorderColor,boxShadow:`0 0 0 ${Je(r)} ${e.activeOutlineColor}`,outline:0}}}},vM=(t,e)=>({[`&${t.componentCls}-status-${e.status}`]:Object.assign({},BY(t,e))}),w8=t=>({"&-outlined":Object.assign(Object.assign(Object.assign(Object.assign({},BY(t,{borderColor:t.colorBorder,hoverBorderHover:t.hoverBorderColor,activeBorderColor:t.activeBorderColor,activeOutlineColor:t.activeOutlineColor})),vM(t,{status:"error",borderColor:t.colorError,hoverBorderHover:t.colorErrorHover,activeBorderColor:t.colorError,activeOutlineColor:t.colorErrorOutline})),vM(t,{status:"warning",borderColor:t.colorWarning,hoverBorderHover:t.colorWarningHover,activeBorderColor:t.colorWarning,activeOutlineColor:t.colorWarningOutline})),{[`&${t.componentCls}-disabled`]:{[`&:not(${t.componentCls}-customize-input) ${t.componentCls}-selector`]:{background:t.colorBgContainerDisabled,color:t.colorTextDisabled}},[`&${t.componentCls}-multiple ${t.componentCls}-selection-item`]:{background:t.multipleItemBg,border:`${Je(t.lineWidth)} ${t.lineType} ${t.multipleItemBorderColor}`}})}),SY=(t,e)=>{const{componentCls:n,antCls:i}=t;return{[`&:not(${n}-customize-input) ${n}-selector`]:{background:e.bg,border:`${Je(t.lineWidth)} ${t.lineType} transparent`,color:e.color},[`&:not(${n}-disabled):not(${n}-customize-input):not(${i}-pagination-size-changer)`]:{[`&:hover ${n}-selector`]:{background:e.hoverBg},[`${n}-focused& ${n}-selector`]:{background:t.selectorBg,borderColor:e.activeBorderColor,outline:0}}}},bM=(t,e)=>({[`&${t.componentCls}-status-${e.status}`]:Object.assign({},SY(t,e))}),Z8=t=>({"&-filled":Object.assign(Object.assign(Object.assign(Object.assign({},SY(t,{bg:t.colorFillTertiary,hoverBg:t.colorFillSecondary,activeBorderColor:t.activeBorderColor,color:t.colorText})),bM(t,{status:"error",bg:t.colorErrorBg,hoverBg:t.colorErrorBgHover,activeBorderColor:t.colorError,color:t.colorError})),bM(t,{status:"warning",bg:t.colorWarningBg,hoverBg:t.colorWarningBgHover,activeBorderColor:t.colorWarning,color:t.colorWarning})),{[`&${t.componentCls}-disabled`]:{[`&:not(${t.componentCls}-customize-input) ${t.componentCls}-selector`]:{borderColor:t.colorBorder,background:t.colorBgContainerDisabled,color:t.colorTextDisabled}},[`&${t.componentCls}-multiple ${t.componentCls}-selection-item`]:{background:t.colorBgContainer,border:`${Je(t.lineWidth)} ${t.lineType} ${t.colorSplit}`}})}),x8=t=>({"&-borderless":{[`${t.componentCls}-selector`]:{background:"transparent",borderColor:"transparent"},[`&${t.componentCls}-disabled`]:{[`&:not(${t.componentCls}-customize-input) ${t.componentCls}-selector`]:{color:t.colorTextDisabled}},[`&${t.componentCls}-multiple ${t.componentCls}-selection-item`]:{background:t.multipleItemBg,border:`${Je(t.lineWidth)} ${t.lineType} ${t.multipleItemBorderColor}`},[`&${t.componentCls}-status-error`]:{[`${t.componentCls}-selection-item`]:{color:t.colorError}},[`&${t.componentCls}-status-warning`]:{[`${t.componentCls}-selection-item`]:{color:t.colorWarning}}}}),R8=t=>({[t.componentCls]:Object.assign(Object.assign(Object.assign({},w8(t)),Z8(t)),x8(t))}),W8=t=>{const{componentCls:e}=t;return{position:"relative",transition:`all ${t.motionDurationMid} ${t.motionEaseInOut}`,input:{cursor:"pointer"},[`${e}-show-search&`]:{cursor:"text",input:{cursor:"auto",color:"inherit",height:"100%"}},[`${e}-disabled&`]:{cursor:"not-allowed",input:{cursor:"not-allowed"}}}},V8=t=>{const{componentCls:e}=t;return{[`${e}-selection-search-input`]:{margin:0,padding:0,background:"transparent",border:"none",outline:"none",appearance:"none",fontFamily:"inherit","&::-webkit-search-cancel-button":{display:"none","-webkit-appearance":"none"}}}},M8=t=>{const{antCls:e,componentCls:n,inputPaddingHorizontalBase:i,iconCls:r}=t;return{[n]:Object.assign(Object.assign({},ba(t)),{position:"relative",display:"inline-block",cursor:"pointer",[`&:not(${n}-customize-input) ${n}-selector`]:Object.assign(Object.assign({},W8(t)),V8(t)),[`${n}-selection-item`]:Object.assign(Object.assign({flex:1,fontWeight:"normal",position:"relative",userSelect:"none"},Xd),{[`> ${e}-typography`]:{display:"inline"}}),[`${n}-selection-placeholder`]:Object.assign(Object.assign({},Xd),{flex:1,color:t.colorTextPlaceholder,pointerEvents:"none"}),[`${n}-arrow`]:Object.assign(Object.assign({},nZ()),{position:"absolute",top:"50%",insetInlineStart:"auto",insetInlineEnd:i,height:t.fontSizeIcon,marginTop:t.calc(t.fontSizeIcon).mul(-1).div(2).equal(),color:t.colorTextQuaternary,fontSize:t.fontSizeIcon,lineHeight:1,textAlign:"center",pointerEvents:"none",display:"flex",alignItems:"center",transition:`opacity ${t.motionDurationSlow} ease`,[r]:{verticalAlign:"top",transition:`transform ${t.motionDurationSlow}`,"> svg":{verticalAlign:"top"},[`&:not(${n}-suffix)`]:{pointerEvents:"auto"}},[`${n}-disabled &`]:{cursor:"not-allowed"},"> *:not(:last-child)":{marginInlineEnd:8}}),[`${n}-clear`]:{position:"absolute",top:"50%",insetInlineStart:"auto",insetInlineEnd:i,zIndex:1,display:"inline-block",width:t.fontSizeIcon,height:t.fontSizeIcon,marginTop:t.calc(t.fontSizeIcon).mul(-1).div(2).equal(),color:t.colorTextQuaternary,fontSize:t.fontSizeIcon,fontStyle:"normal",lineHeight:1,textAlign:"center",textTransform:"none",cursor:"pointer",opacity:0,transition:`color ${t.motionDurationMid} ease, opacity ${t.motionDurationSlow} ease`,textRendering:"auto","&:before":{display:"block"},"&:hover":{color:t.colorTextTertiary}},[`&:hover ${n}-clear`]:{opacity:1,background:t.colorBgBase,borderRadius:"50%"}}),[`${n}-has-feedback`]:{[`${n}-clear`]:{insetInlineEnd:t.calc(i).add(t.fontSize).add(t.paddingXS).equal()}}}},N8=t=>{const{componentCls:e}=t;return[{[e]:{[`&${e}-in-form-item`]:{width:"100%"}}},M8(t),B8(t),G8(t),A8(t),{[`${e}-rtl`]:{direction:"rtl"}},hZ(t,{borderElCls:`${e}-selector`,focusElCls:`${e}-focused`})]},F8=yo("Select",(t,e)=>{let{rootPrefixCls:n}=e;const i=ci(t,{rootPrefixCls:n,inputPaddingHorizontalBase:t.calc(t.paddingSM).sub(1).equal(),multipleSelectItemHeight:t.multipleItemHeight,selectHeight:t.controlHeight});return[N8(i),R8(i)]},S8,{unitless:{optionLineHeight:!0,optionSelectedFontWeight:!0}});var H8={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"},X8=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:H8}))},E8=y.forwardRef(X8),Y8={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"}}]},name:"down",theme:"outlined"},z8=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:Y8}))},K8=y.forwardRef(z8),L8={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"},T8=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:L8}))},wY=y.forwardRef(T8);function _8(t){let{suffixIcon:e,clearIcon:n,menuItemSelectedIcon:i,removeIcon:r,loading:o,multiple:a,hasFeedback:s,prefixCls:l,showSuffixIcon:c,feedbackIcon:g,showArrow:u,componentName:d}=t;const C=n??y.createElement(oZ,null),f=A=>e===null&&!s&&!u?null:y.createElement(y.Fragment,null,c!==!1&&A,s&&g);let v=null;if(e!==void 0)v=f(e);else if(o)v=f(y.createElement(aZ,{spin:!0}));else{const A=`${l}-suffix`;v=b=>{let{open:G,showSearch:w}=b;return f(G&&w?y.createElement(wY,{className:A}):y.createElement(K8,{className:A}))}}let p=null;i!==void 0?p=i:a?p=y.createElement(E8,null):p=null;let m=null;return r!==void 0?m=r:m=y.createElement(Oh,null),{clearIcon:C,suffixIcon:v,itemIcon:p,removeIcon:m}}function k8(t,e){return e!==void 0?e:t!==null}var P8=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const ZY="SECRET_COMBOBOX_MODE_DO_NOT_USE",U8=(t,e)=>{var n;const{prefixCls:i,bordered:r,className:o,rootClassName:a,getPopupContainer:s,popupClassName:l,dropdownClassName:c,listHeight:g=256,placement:u,listItemHeight:d,size:C,disabled:f,notFoundContent:v,status:p,builtinPlacements:m,dropdownMatchSelectWidth:A,popupMatchSelectWidth:b,direction:G,style:w,allowClear:S,variant:Z,dropdownStyle:x,transitionName:R,tagRender:W,maxCount:M}=t,N=P8(t,["prefixCls","bordered","className","rootClassName","getPopupContainer","popupClassName","dropdownClassName","listHeight","placement","listItemHeight","size","disabled","notFoundContent","status","builtinPlacements","dropdownMatchSelectWidth","popupMatchSelectWidth","direction","style","allowClear","variant","dropdownStyle","transitionName","tagRender","maxCount"]),{getPopupContainer:X,getPrefixCls:E,renderEmpty:Q,direction:k,virtual:J,popupMatchSelectWidth:F,popupOverflow:L,select:z}=y.useContext(yn),[,K]=Qo(),O=d??(K==null?void 0:K.controlHeight),j=E("select",i),P=E(),$=G??k,{compactSize:oe,compactItemClassnames:ie}=fv(j,$),[de,Ve]=BZ("select",Z,r),Se=Lg(j),[me,T,Ge]=F8(j,Se),ne=y.useMemo(()=>{const{mode:Te}=t;if(Te!=="combobox")return Te===ZY?"combobox":Te},[t.mode]),he=ne==="multiple"||ne==="tags",ae=k8(t.suffixIcon,t.showArrow),He=(n=b??A)!==null&&n!==void 0?n:F,{status:ve,hasFeedback:Me,isFormItemInput:q,feedbackIcon:Y}=y.useContext(cl),Ce=Gv(ve,p);let se;v!==void 0?se=v:ne==="combobox"?se=null:se=(Q==null?void 0:Q("Select"))||y.createElement(GY,{componentName:"Select"});const{suffixIcon:fe,itemIcon:Ze,removeIcon:Oe,clearIcon:Fe}=_8(Object.assign(Object.assign({},N),{multiple:he,hasFeedback:Me,feedbackIcon:Y,showSuffixIcon:ae,prefixCls:j,componentName:"Select"})),Ee=S===!0?{clearIcon:Fe}:S,Qe=$a(N,["suffixIcon","itemIcon"]),Ye=qe(l||c,{[`${j}-dropdown-${$}`]:$==="rtl"},a,Ge,Se,T),$e=Zs(Te=>{var ue;return(ue=C??oe)!==null&&ue!==void 0?ue:Te}),st=y.useContext(lc),Ue=f??st,Ne=qe({[`${j}-lg`]:$e==="large",[`${j}-sm`]:$e==="small",[`${j}-rtl`]:$==="rtl",[`${j}-${de}`]:Ve,[`${j}-in-form-item`]:q},e0(j,Ce,Me),ie,z==null?void 0:z.className,o,a,Ge,Se,T),je=y.useMemo(()=>u!==void 0?u:$==="rtl"?"bottomRight":"bottomLeft",[u,$]),[Ie]=hE("SelectLike",x==null?void 0:x.zIndex);return me(y.createElement(GZ,Object.assign({ref:e,virtual:J,showSearch:z==null?void 0:z.showSearch},Qe,{style:Object.assign(Object.assign({},z==null?void 0:z.style),w),dropdownMatchSelectWidth:He,transitionName:Yd(P,"slide-up",R),builtinPlacements:m8(m,L),listHeight:g,listItemHeight:O,mode:ne,prefixCls:j,placement:je,direction:$,suffixIcon:fe,menuItemSelectedIcon:Ze,removeIcon:Oe,allowClear:Ee,notFoundContent:se,className:Ne,getPopupContainer:s||X,dropdownClassName:Ye,disabled:Ue,dropdownStyle:Object.assign(Object.assign({},x),{zIndex:Ie}),maxCount:he?M:void 0,tagRender:he?W:void 0})))},hl=y.forwardRef(U8),D8=Hj(hl);hl.SECRET_COMBOBOX_MODE_DO_NOT_USE=ZY;hl.Option=yZ;hl.OptGroup=bZ;hl._InternalPanelDoNotUseOrYouWillBeFired=D8;const Vg=["xxl","xl","lg","md","sm","xs"],O8=t=>({xs:`(max-width: ${t.screenXSMax}px)`,sm:`(min-width: ${t.screenSM}px)`,md:`(min-width: ${t.screenMD}px)`,lg:`(min-width: ${t.screenLG}px)`,xl:`(min-width: ${t.screenXL}px)`,xxl:`(min-width: ${t.screenXXL}px)`}),J8=t=>{const e=t,n=[].concat(Vg).reverse();return n.forEach((i,r)=>{const o=i.toUpperCase(),a=`screen${o}Min`,s=`screen${o}`;if(!(e[a]<=e[s]))throw new Error(`${a}<=${s} fails : !(${e[a]}<=${e[s]})`);if(r<n.length-1){const l=`screen${o}Max`;if(!(e[s]<=e[l]))throw new Error(`${s}<=${l} fails : !(${e[s]}<=${e[l]})`);const g=`screen${n[r+1].toUpperCase()}Min`;if(!(e[l]<=e[g]))throw new Error(`${l}<=${g} fails : !(${e[l]}<=${e[g]})`)}}),t};function xY(){const[,t]=Qo(),e=O8(J8(t));return ze.useMemo(()=>{const n=new Map;let i=-1,r={};return{matchHandlers:{},dispatch(o){return r=o,n.forEach(a=>a(r)),n.size>=1},subscribe(o){return n.size||this.register(),i+=1,n.set(i,o),o(r),i},unsubscribe(o){n.delete(o),n.size||this.unregister()},unregister(){Object.keys(e).forEach(o=>{const a=e[o],s=this.matchHandlers[a];s==null||s.mql.removeListener(s==null?void 0:s.listener)}),n.clear()},register(){Object.keys(e).forEach(o=>{const a=e[o],s=c=>{let{matches:g}=c;this.dispatch(Object.assign(Object.assign({},r),{[o]:g}))},l=window.matchMedia(a);l.addListener(s),this.matchHandlers[a]={mql:l,listener:s},s(l)})},responsiveMap:e}},[t])}function Q8(){const[,t]=y.useReducer(e=>e+1,0);return t}function RY(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const e=y.useRef({}),n=Q8(),i=xY();return qn(()=>{const r=i.subscribe(o=>{e.current=o,t&&n()});return()=>i.unsubscribe(r)},[]),e.current}var j8=Ct.ESC,$8=Ct.TAB;function q8(t){var e=t.visible,n=t.triggerRef,i=t.onVisibleChange,r=t.autoFocus,o=t.overlayRef,a=y.useRef(!1),s=function(){if(e){var u,d;(u=n.current)===null||u===void 0||(d=u.focus)===null||d===void 0||d.call(u),i==null||i(!1)}},l=function(){var u;return(u=o.current)!==null&&u!==void 0&&u.focus?(o.current.focus(),a.current=!0,!0):!1},c=function(u){switch(u.keyCode){case j8:s();break;case $8:{var d=!1;a.current||(d=l()),d?u.preventDefault():s();break}}};y.useEffect(function(){return e?(window.addEventListener("keydown",c),r&&Ln(l,3),function(){window.removeEventListener("keydown",c),a.current=!1}):function(){a.current=!1}},[e])}var e6=y.forwardRef(function(t,e){var n=t.overlay,i=t.arrow,r=t.prefixCls,o=y.useMemo(function(){var s;return typeof n=="function"?s=n():s=n,s},[n]),a=ja(e,o==null?void 0:o.ref);return ze.createElement(ze.Fragment,null,i&&ze.createElement("div",{className:"".concat(r,"-arrow")}),ze.cloneElement(o,{ref:Kg(o)?a:void 0}))}),Iu={adjustX:1,adjustY:1},Cu=[0,0],t6={topLeft:{points:["bl","tl"],overflow:Iu,offset:[0,-4],targetOffset:Cu},top:{points:["bc","tc"],overflow:Iu,offset:[0,-4],targetOffset:Cu},topRight:{points:["br","tr"],overflow:Iu,offset:[0,-4],targetOffset:Cu},bottomLeft:{points:["tl","bl"],overflow:Iu,offset:[0,4],targetOffset:Cu},bottom:{points:["tc","bc"],overflow:Iu,offset:[0,4],targetOffset:Cu},bottomRight:{points:["tr","br"],overflow:Iu,offset:[0,4],targetOffset:Cu}},n6=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus","overlay","children","onVisibleChange"];function i6(t,e){var n,i=t.arrow,r=i===void 0?!1:i,o=t.prefixCls,a=o===void 0?"rc-dropdown":o,s=t.transitionName,l=t.animation,c=t.align,g=t.placement,u=g===void 0?"bottomLeft":g,d=t.placements,C=d===void 0?t6:d,f=t.getPopupContainer,v=t.showAction,p=t.hideAction,m=t.overlayClassName,A=t.overlayStyle,b=t.visible,G=t.trigger,w=G===void 0?["hover"]:G,S=t.autoFocus,Z=t.overlay,x=t.children,R=t.onVisibleChange,W=An(t,n6),M=ze.useState(),N=De(M,2),X=N[0],E=N[1],Q="visible"in t?b:X,k=ze.useRef(null),J=ze.useRef(null),F=ze.useRef(null);ze.useImperativeHandle(e,function(){return k.current});var L=function(de){E(de),R==null||R(de)};q8({visible:Q,triggerRef:F,onVisibleChange:L,autoFocus:S,overlayRef:J});var z=function(de){var Ve=t.onOverlayClick;E(!1),Ve&&Ve(de)},K=function(){return ze.createElement(e6,{ref:J,overlay:Z,prefixCls:a,arrow:r})},O=function(){return typeof Z=="function"?K:K()},j=function(){var de=t.minOverlayWidthMatchTrigger,Ve=t.alignPoint;return"minOverlayWidthMatchTrigger"in t?de:!Ve},P=function(){var de=t.openClassName;return de!==void 0?de:"".concat(a,"-open")},$=ze.cloneElement(x,{className:qe((n=x.props)===null||n===void 0?void 0:n.className,Q&&P()),ref:Kg(x)?ja(F,x.ref):void 0}),oe=p;return!oe&&w.indexOf("contextMenu")!==-1&&(oe=["click"]),ze.createElement(pZ,Zt({builtinPlacements:C},W,{prefixCls:a,ref:k,popupClassName:qe(m,we({},"".concat(a,"-show-arrow"),r)),popupStyle:A,action:w,showAction:v,hideAction:oe,popupPlacement:u,popupAlign:c,popupTransitionName:s,popupAnimation:l,popupVisible:Q,stretch:j()?"minWidth":"",popup:O(),onPopupVisibleChange:L,onPopupClick:z,getPopupContainer:f}),$)}const r6=ze.forwardRef(i6);var WY=y.createContext(null);function VY(t,e){return t===void 0?null:"".concat(t,"-").concat(e)}function MY(t){var e=y.useContext(WY);return VY(e,t)}var o6=["children","locked"],Qa=y.createContext(null);function a6(t,e){var n=Re({},t);return Object.keys(e).forEach(function(i){var r=e[i];r!==void 0&&(n[i]=r)}),n}function mh(t){var e=t.children,n=t.locked,i=An(t,o6),r=y.useContext(Qa),o=Ph(function(){return a6(r,i)},[r,i],function(a,s){return!n&&(a[0]!==s[0]||!gh(a[1],s[1],!0))});return y.createElement(Qa.Provider,{value:o},e)}var s6=[],NY=y.createContext(null);function Bv(){return y.useContext(NY)}var FY=y.createContext(s6);function tf(t){var e=y.useContext(FY);return y.useMemo(function(){return t!==void 0?[].concat(Et(e),[t]):e},[e,t])}var HY=y.createContext(null),SZ=y.createContext({});function yM(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(lZ(t)){var n=t.nodeName.toLowerCase(),i=["input","select","textarea","button"].includes(n)||t.isContentEditable||n==="a"&&!!t.getAttribute("href"),r=t.getAttribute("tabindex"),o=Number(r),a=null;return r&&!Number.isNaN(o)?a=o:i&&a===null&&(a=0),i&&t.disabled&&(a=null),a!==null&&(a>=0||e&&a<0)}return!1}function l6(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=Et(t.querySelectorAll("*")).filter(function(i){return yM(i,e)});return yM(t,e)&&n.unshift(t),n}var dS=Ct.LEFT,IS=Ct.RIGHT,CS=Ct.UP,cp=Ct.DOWN,gp=Ct.ENTER,XY=Ct.ESC,HI=Ct.HOME,XI=Ct.END,GM=[CS,cp,dS,IS];function c6(t,e,n,i){var r,o="prev",a="next",s="children",l="parent";if(t==="inline"&&i===gp)return{inlineTrigger:!0};var c=we(we({},CS,o),cp,a),g=we(we(we(we({},dS,n?a:o),IS,n?o:a),cp,s),gp,s),u=we(we(we(we(we(we({},CS,o),cp,a),gp,s),XY,l),dS,n?s:l),IS,n?l:s),d={inline:c,horizontal:g,vertical:u,inlineSub:c,horizontalSub:u,verticalSub:u},C=(r=d["".concat(t).concat(e?"":"Sub")])===null||r===void 0?void 0:r[i];switch(C){case o:return{offset:-1,sibling:!0};case a:return{offset:1,sibling:!0};case l:return{offset:-1,sibling:!1};case s:return{offset:1,sibling:!1};default:return null}}function g6(t){for(var e=t;e;){if(e.getAttribute("data-menu-list"))return e;e=e.parentElement}return null}function u6(t,e){for(var n=t||document.activeElement;n;){if(e.has(n))return n;n=n.parentElement}return null}function wZ(t,e){var n=l6(t,!0);return n.filter(function(i){return e.has(i)})}function BM(t,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;if(!t)return null;var r=wZ(t,e),o=r.length,a=r.findIndex(function(s){return n===s});return i<0?a===-1?a=o-1:a-=1:i>0&&(a+=1),a=(a+o)%o,r[a]}var hS=function(e,n){var i=new Set,r=new Map,o=new Map;return e.forEach(function(a){var s=document.querySelector("[data-menu-id='".concat(VY(n,a),"']"));s&&(i.add(s),o.set(s,a),r.set(a,s))}),{elements:i,key2element:r,element2key:o}};function d6(t,e,n,i,r,o,a,s,l,c){var g=y.useRef(),u=y.useRef();u.current=e;var d=function(){Ln.cancel(g.current)};return y.useEffect(function(){return function(){d()}},[]),function(C){var f=C.which;if([].concat(GM,[gp,XY,HI,XI]).includes(f)){var v=o(),p=hS(v,i),m=p,A=m.elements,b=m.key2element,G=m.element2key,w=b.get(e),S=u6(w,A),Z=G.get(S),x=c6(t,a(Z,!0).length===1,n,f);if(!x&&f!==HI&&f!==XI)return;(GM.includes(f)||[HI,XI].includes(f))&&C.preventDefault();var R=function(J){if(J){var F=J,L=J.querySelector("a");L!=null&&L.getAttribute("href")&&(F=L);var z=G.get(J);s(z),d(),g.current=Ln(function(){u.current===z&&F.focus()})}};if([HI,XI].includes(f)||x.sibling||!S){var W;!S||t==="inline"?W=r.current:W=g6(S);var M,N=wZ(W,A);f===HI?M=N[0]:f===XI?M=N[N.length-1]:M=BM(W,A,S,x.offset),R(M)}else if(x.inlineTrigger)l(Z);else if(x.offset>0)l(Z,!0),d(),g.current=Ln(function(){p=hS(v,i);var k=S.getAttribute("aria-controls"),J=document.getElementById(k),F=BM(J,p.elements);R(F)},5);else if(x.offset<0){var X=a(Z,!0),E=X[X.length-2],Q=b.get(E);l(E,!1),R(Q)}}c==null||c(C)}}function I6(t){Promise.resolve().then(t)}var ZZ="__RC_UTIL_PATH_SPLIT__",SM=function(e){return e.join(ZZ)},C6=function(e){return e.split(ZZ)},fS="rc-menu-more";function h6(){var t=y.useState({}),e=De(t,2),n=e[1],i=y.useRef(new Map),r=y.useRef(new Map),o=y.useState([]),a=De(o,2),s=a[0],l=a[1],c=y.useRef(0),g=y.useRef(!1),u=function(){g.current||n({})},d=y.useCallback(function(b,G){var w=SM(G);r.current.set(w,b),i.current.set(b,w),c.current+=1;var S=c.current;I6(function(){S===c.current&&u()})},[]),C=y.useCallback(function(b,G){var w=SM(G);r.current.delete(w),i.current.delete(b)},[]),f=y.useCallback(function(b){l(b)},[]),v=y.useCallback(function(b,G){var w=i.current.get(b)||"",S=C6(w);return G&&s.includes(S[0])&&S.unshift(fS),S},[s]),p=y.useCallback(function(b,G){return b.filter(function(w){return w!==void 0}).some(function(w){var S=v(w,!0);return S.includes(G)})},[v]),m=function(){var G=Et(i.current.keys());return s.length&&G.push(fS),G},A=y.useCallback(function(b){var G="".concat(i.current.get(b)).concat(ZZ),w=new Set;return Et(r.current.keys()).forEach(function(S){S.startsWith(G)&&w.add(r.current.get(S))}),w},[]);return y.useEffect(function(){return function(){g.current=!0}},[]),{registerPath:d,unregisterPath:C,refreshOverflowKeys:f,isSubPathKey:p,getKeyPath:v,getKeys:m,getSubPathKeys:A}}function uC(t){var e=y.useRef(t);e.current=t;var n=y.useCallback(function(){for(var i,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(i=e.current)===null||i===void 0?void 0:i.call.apply(i,[e].concat(o))},[]);return t?n:void 0}var f6=Math.random().toFixed(5).toString().slice(2),wM=0;function m6(t){var e=$r(t,{value:t}),n=De(e,2),i=n[0],r=n[1];return y.useEffect(function(){wM+=1;var o="".concat(f6,"-").concat(wM);r("rc-menu-uuid-".concat(o))},[]),i}function EY(t,e,n,i){var r=y.useContext(Qa),o=r.activeKey,a=r.onActive,s=r.onInactive,l={active:o===t};return e||(l.onMouseEnter=function(c){n==null||n({key:t,domEvent:c}),a(t)},l.onMouseLeave=function(c){i==null||i({key:t,domEvent:c}),s(t)}),l}function YY(t){var e=y.useContext(Qa),n=e.mode,i=e.rtl,r=e.inlineIndent;if(n!=="inline")return null;var o=t;return i?{paddingRight:o*r}:{paddingLeft:o*r}}function zY(t){var e=t.icon,n=t.props,i=t.children,r;return e===null||e===!1?null:(typeof e=="function"?r=y.createElement(e,Re({},n)):typeof e!="boolean"&&(r=e),r||i||null)}var A6=["item"];function t0(t){var e=t.item,n=An(t,A6);return Object.defineProperty(n,"item",{get:function(){return Fr(!1,"`info.item` is deprecated since we will move to function component that not provides React Node instance in future."),e}}),n}var p6=["title","attribute","elementRef"],v6=["style","className","eventKey","warnKey","disabled","itemIcon","children","role","onMouseEnter","onMouseLeave","onClick","onKeyDown","onFocus"],b6=["active"],y6=function(t){dl(n,t);var e=Il(n);function n(){return Ki(this,n),e.apply(this,arguments)}return Li(n,[{key:"render",value:function(){var r=this.props,o=r.title,a=r.attribute,s=r.elementRef,l=An(r,p6),c=$a(l,["eventKey","popupClassName","popupOffset","onTitleClick"]);return Fr(!a,"`attribute` of Menu.Item is deprecated. Please pass attribute directly."),y.createElement(bs.Item,Zt({},a,{title:typeof o=="string"?o:void 0},c,{ref:s}))}}]),n}(y.Component),G6=y.forwardRef(function(t,e){var n=t.style,i=t.className,r=t.eventKey;t.warnKey;var o=t.disabled,a=t.itemIcon,s=t.children,l=t.role,c=t.onMouseEnter,g=t.onMouseLeave,u=t.onClick,d=t.onKeyDown,C=t.onFocus,f=An(t,v6),v=MY(r),p=y.useContext(Qa),m=p.prefixCls,A=p.onItemClick,b=p.disabled,G=p.overflowDisabled,w=p.itemIcon,S=p.selectedKeys,Z=p.onActive,x=y.useContext(SZ),R=x._internalRenderMenuItem,W="".concat(m,"-item"),M=y.useRef(),N=y.useRef(),X=b||o,E=zg(e,N),Q=tf(r),k=function(Ve){return{key:r,keyPath:Et(Q).reverse(),item:M.current,domEvent:Ve}},J=a||w,F=EY(r,X,c,g),L=F.active,z=An(F,b6),K=S.includes(r),O=YY(Q.length),j=function(Ve){if(!X){var Se=k(Ve);u==null||u(t0(Se)),A(Se)}},P=function(Ve){if(d==null||d(Ve),Ve.which===Ct.ENTER){var Se=k(Ve);u==null||u(t0(Se)),A(Se)}},$=function(Ve){Z(r),C==null||C(Ve)},oe={};t.role==="option"&&(oe["aria-selected"]=K);var ie=y.createElement(y6,Zt({ref:M,elementRef:E,role:l===null?"none":l||"menuitem",tabIndex:o?null:-1,"data-menu-id":G&&v?null:v},f,z,oe,{component:"li","aria-disabled":o,style:Re(Re({},O),n),className:qe(W,we(we(we({},"".concat(W,"-active"),L),"".concat(W,"-selected"),K),"".concat(W,"-disabled"),X),i),onClick:j,onKeyDown:P,onFocus:$}),s,y.createElement(zY,{props:Re(Re({},t),{},{isSelected:K}),icon:J}));return R&&(ie=R(ie,t,{selected:K})),ie});function B6(t,e){var n=t.eventKey,i=Bv(),r=tf(n);return y.useEffect(function(){if(i)return i.registerPath(n,r),function(){i.unregisterPath(n,r)}},[r]),i?null:y.createElement(G6,Zt({},t,{ref:e}))}const Sv=y.forwardRef(B6);var S6=["className","children"],w6=function(e,n){var i=e.className,r=e.children,o=An(e,S6),a=y.useContext(Qa),s=a.prefixCls,l=a.mode,c=a.rtl;return y.createElement("ul",Zt({className:qe(s,c&&"".concat(s,"-rtl"),"".concat(s,"-sub"),"".concat(s,"-").concat(l==="inline"?"inline":"vertical"),i),role:"menu"},o,{"data-menu-list":!0,ref:n}),r)},xZ=y.forwardRef(w6);xZ.displayName="SubMenuList";function RZ(t,e){return Rg(t).map(function(n,i){if(y.isValidElement(n)){var r,o,a=n.key,s=(r=(o=n.props)===null||o===void 0?void 0:o.eventKey)!==null&&r!==void 0?r:a,l=s==null;l&&(s="tmp_key-".concat([].concat(Et(e),[i]).join("-")));var c={key:s,eventKey:s};return y.cloneElement(n,c)}return n})}var Mr={adjustX:1,adjustY:1},Z6={topLeft:{points:["bl","tl"],overflow:Mr},topRight:{points:["br","tr"],overflow:Mr},bottomLeft:{points:["tl","bl"],overflow:Mr},bottomRight:{points:["tr","br"],overflow:Mr},leftTop:{points:["tr","tl"],overflow:Mr},leftBottom:{points:["br","bl"],overflow:Mr},rightTop:{points:["tl","tr"],overflow:Mr},rightBottom:{points:["bl","br"],overflow:Mr}},x6={topLeft:{points:["bl","tl"],overflow:Mr},topRight:{points:["br","tr"],overflow:Mr},bottomLeft:{points:["tl","bl"],overflow:Mr},bottomRight:{points:["tr","br"],overflow:Mr},rightTop:{points:["tr","tl"],overflow:Mr},rightBottom:{points:["br","bl"],overflow:Mr},leftTop:{points:["tl","tr"],overflow:Mr},leftBottom:{points:["bl","br"],overflow:Mr}};function KY(t,e,n){if(e)return e;if(n)return n[t]||n.other}var R6={horizontal:"bottomLeft",vertical:"rightTop","vertical-left":"rightTop","vertical-right":"leftTop"};function W6(t){var e=t.prefixCls,n=t.visible,i=t.children,r=t.popup,o=t.popupStyle,a=t.popupClassName,s=t.popupOffset,l=t.disabled,c=t.mode,g=t.onVisibleChange,u=y.useContext(Qa),d=u.getPopupContainer,C=u.rtl,f=u.subMenuOpenDelay,v=u.subMenuCloseDelay,p=u.builtinPlacements,m=u.triggerSubMenuAction,A=u.forceSubMenuRender,b=u.rootClassName,G=u.motion,w=u.defaultMotions,S=y.useState(!1),Z=De(S,2),x=Z[0],R=Z[1],W=Re(C?Re({},x6):Re({},Z6),p),M=R6[c],N=KY(c,G,w),X=y.useRef(N);c!=="inline"&&(X.current=N);var E=Re(Re({},X.current),{},{leavedClassName:"".concat(e,"-hidden"),removeOnLeave:!1,motionAppear:!0}),Q=y.useRef();return y.useEffect(function(){return Q.current=Ln(function(){R(n)}),function(){Ln.cancel(Q.current)}},[n]),y.createElement(pZ,{prefixCls:e,popupClassName:qe("".concat(e,"-popup"),we({},"".concat(e,"-rtl"),C),a,b),stretch:c==="horizontal"?"minWidth":null,getPopupContainer:d,builtinPlacements:W,popupPlacement:M,popupVisible:x,popup:r,popupStyle:o,popupAlign:s&&{offset:s},action:l?[]:[m],mouseEnterDelay:f,mouseLeaveDelay:v,onPopupVisibleChange:g,forceRender:A,popupMotion:E,fresh:!0},i)}function V6(t){var e=t.id,n=t.open,i=t.keyPath,r=t.children,o="inline",a=y.useContext(Qa),s=a.prefixCls,l=a.forceSubMenuRender,c=a.motion,g=a.defaultMotions,u=a.mode,d=y.useRef(!1);d.current=u===o;var C=y.useState(!d.current),f=De(C,2),v=f[0],p=f[1],m=d.current?n:!1;y.useEffect(function(){d.current&&p(!1)},[u]);var A=Re({},KY(o,c,g));i.length>1&&(A.motionAppear=!1);var b=A.onVisibleChanged;return A.onVisibleChanged=function(G){return!d.current&&!G&&p(!0),b==null?void 0:b(G)},v?null:y.createElement(mh,{mode:o,locked:!d.current},y.createElement(Cl,Zt({visible:m},A,{forceRender:l,removeOnLeave:!1,leavedClassName:"".concat(s,"-hidden")}),function(G){var w=G.className,S=G.style;return y.createElement(xZ,{id:e,className:w,style:S},r)}))}var M6=["style","className","title","eventKey","warnKey","disabled","internalPopupClose","children","itemIcon","expandIcon","popupClassName","popupOffset","popupStyle","onClick","onMouseEnter","onMouseLeave","onTitleClick","onTitleMouseEnter","onTitleMouseLeave"],N6=["active"],F6=y.forwardRef(function(t,e){var n=t.style,i=t.className,r=t.title,o=t.eventKey;t.warnKey;var a=t.disabled,s=t.internalPopupClose,l=t.children,c=t.itemIcon,g=t.expandIcon,u=t.popupClassName,d=t.popupOffset,C=t.popupStyle,f=t.onClick,v=t.onMouseEnter,p=t.onMouseLeave,m=t.onTitleClick,A=t.onTitleMouseEnter,b=t.onTitleMouseLeave,G=An(t,M6),w=MY(o),S=y.useContext(Qa),Z=S.prefixCls,x=S.mode,R=S.openKeys,W=S.disabled,M=S.overflowDisabled,N=S.activeKey,X=S.selectedKeys,E=S.itemIcon,Q=S.expandIcon,k=S.onItemClick,J=S.onOpenChange,F=S.onActive,L=y.useContext(SZ),z=L._internalRenderSubMenuItem,K=y.useContext(HY),O=K.isSubPathKey,j=tf(),P="".concat(Z,"-submenu"),$=W||a,oe=y.useRef(),ie=y.useRef(),de=c??E,Ve=g??Q,Se=R.includes(o),me=!M&&Se,T=O(X,o),Ge=EY(o,$,A,b),ne=Ge.active,he=An(Ge,N6),ae=y.useState(!1),He=De(ae,2),ve=He[0],Me=He[1],q=function(je){$||Me(je)},Y=function(je){q(!0),v==null||v({key:o,domEvent:je})},Ce=function(je){q(!1),p==null||p({key:o,domEvent:je})},se=y.useMemo(function(){return ne||(x!=="inline"?ve||O([N],o):!1)},[x,ne,N,ve,o,O]),fe=YY(j.length),Ze=function(je){$||(m==null||m({key:o,domEvent:je}),x==="inline"&&J(o,!Se))},Oe=uC(function(Ne){f==null||f(t0(Ne)),k(Ne)}),Fe=function(je){x!=="inline"&&J(o,je)},Ee=function(){F(o)},Qe=w&&"".concat(w,"-popup"),Ye=y.createElement("div",Zt({role:"menuitem",style:fe,className:"".concat(P,"-title"),tabIndex:$?null:-1,ref:oe,title:typeof r=="string"?r:null,"data-menu-id":M&&w?null:w,"aria-expanded":me,"aria-haspopup":!0,"aria-controls":Qe,"aria-disabled":$,onClick:Ze,onFocus:Ee},he),r,y.createElement(zY,{icon:x!=="horizontal"?Ve:void 0,props:Re(Re({},t),{},{isOpen:me,isSubMenu:!0})},y.createElement("i",{className:"".concat(P,"-arrow")}))),$e=y.useRef(x);if(x!=="inline"&&j.length>1?$e.current="vertical":$e.current=x,!M){var st=$e.current;Ye=y.createElement(W6,{mode:st,prefixCls:P,visible:!s&&me&&x!=="inline",popupClassName:u,popupOffset:d,popupStyle:C,popup:y.createElement(mh,{mode:st==="horizontal"?"vertical":st},y.createElement(xZ,{id:Qe,ref:ie},l)),disabled:$,onVisibleChange:Fe},Ye)}var Ue=y.createElement(bs.Item,Zt({ref:e,role:"none"},G,{component:"li",style:n,className:qe(P,"".concat(P,"-").concat(x),i,we(we(we(we({},"".concat(P,"-open"),me),"".concat(P,"-active"),se),"".concat(P,"-selected"),T),"".concat(P,"-disabled"),$)),onMouseEnter:Y,onMouseLeave:Ce}),Ye,!M&&y.createElement(V6,{id:Qe,open:me,keyPath:j},l));return z&&(Ue=z(Ue,t,{selected:T,active:se,open:me,disabled:$})),y.createElement(mh,{onItemClick:Oe,mode:x==="horizontal"?"vertical":x,itemIcon:de,expandIcon:Ve},Ue)}),WZ=y.forwardRef(function(t,e){var n=t.eventKey,i=t.children,r=tf(n),o=RZ(i,r),a=Bv();y.useEffect(function(){if(a)return a.registerPath(n,r),function(){a.unregisterPath(n,r)}},[r]);var s;return a?s=o:s=y.createElement(F6,Zt({ref:e},t),o),y.createElement(FY.Provider,{value:r},s)});function LY(t){var e=t.className,n=t.style,i=y.useContext(Qa),r=i.prefixCls,o=Bv();return o?null:y.createElement("li",{role:"separator",className:qe("".concat(r,"-item-divider"),e),style:n})}var H6=["className","title","eventKey","children"],X6=y.forwardRef(function(t,e){var n=t.className,i=t.title;t.eventKey;var r=t.children,o=An(t,H6),a=y.useContext(Qa),s=a.prefixCls,l="".concat(s,"-item-group");return y.createElement("li",Zt({ref:e,role:"presentation"},o,{onClick:function(g){return g.stopPropagation()},className:qe(l,n)}),y.createElement("div",{role:"presentation",className:"".concat(l,"-title"),title:typeof i=="string"?i:void 0},i),y.createElement("ul",{role:"group",className:"".concat(l,"-list")},r))}),TY=y.forwardRef(function(t,e){var n=t.eventKey,i=t.children,r=tf(n),o=RZ(i,r),a=Bv();return a?o:y.createElement(X6,Zt({ref:e},$a(t,["warnKey"])),o)}),E6=["label","children","key","type","extra"];function mS(t,e,n){var i=e.item,r=e.group,o=e.submenu,a=e.divider;return(t||[]).map(function(s,l){if(s&&qt(s)==="object"){var c=s,g=c.label,u=c.children,d=c.key,C=c.type,f=c.extra,v=An(c,E6),p=d??"tmp-".concat(l);return u||C==="group"?C==="group"?y.createElement(r,Zt({key:p},v,{title:g}),mS(u,e,n)):y.createElement(o,Zt({key:p},v,{title:g}),mS(u,e,n)):C==="divider"?y.createElement(a,Zt({key:p},v)):y.createElement(i,Zt({key:p},v),g,(!!f||f===0)&&y.createElement("span",{className:"".concat(n,"-item-extra")},f))}return null}).filter(function(s){return s})}function ZM(t,e,n,i,r){var o=t,a=Re({divider:LY,item:Sv,group:TY,submenu:WZ},i);return e&&(o=mS(e,a,r)),RZ(o,n)}var Y6=["prefixCls","rootClassName","style","className","tabIndex","items","children","direction","id","mode","inlineCollapsed","disabled","disabledOverflow","subMenuOpenDelay","subMenuCloseDelay","forceSubMenuRender","defaultOpenKeys","openKeys","activeKey","defaultActiveFirst","selectable","multiple","defaultSelectedKeys","selectedKeys","onSelect","onDeselect","inlineIndent","motion","defaultMotions","triggerSubMenuAction","builtinPlacements","itemIcon","expandIcon","overflowedIndicator","overflowedIndicatorPopupClassName","getPopupContainer","onClick","onOpenChange","onKeyDown","openAnimation","openTransitionName","_internalRenderMenuItem","_internalRenderSubMenuItem","_internalComponents"],Vc=[],z6=y.forwardRef(function(t,e){var n,i=t,r=i.prefixCls,o=r===void 0?"rc-menu":r,a=i.rootClassName,s=i.style,l=i.className,c=i.tabIndex,g=c===void 0?0:c,u=i.items,d=i.children,C=i.direction,f=i.id,v=i.mode,p=v===void 0?"vertical":v,m=i.inlineCollapsed,A=i.disabled,b=i.disabledOverflow,G=i.subMenuOpenDelay,w=G===void 0?.1:G,S=i.subMenuCloseDelay,Z=S===void 0?.1:S,x=i.forceSubMenuRender,R=i.defaultOpenKeys,W=i.openKeys,M=i.activeKey,N=i.defaultActiveFirst,X=i.selectable,E=X===void 0?!0:X,Q=i.multiple,k=Q===void 0?!1:Q,J=i.defaultSelectedKeys,F=i.selectedKeys,L=i.onSelect,z=i.onDeselect,K=i.inlineIndent,O=K===void 0?24:K,j=i.motion,P=i.defaultMotions,$=i.triggerSubMenuAction,oe=$===void 0?"hover":$,ie=i.builtinPlacements,de=i.itemIcon,Ve=i.expandIcon,Se=i.overflowedIndicator,me=Se===void 0?"...":Se,T=i.overflowedIndicatorPopupClassName,Ge=i.getPopupContainer,ne=i.onClick,he=i.onOpenChange,ae=i.onKeyDown;i.openAnimation,i.openTransitionName;var He=i._internalRenderMenuItem,ve=i._internalRenderSubMenuItem,Me=i._internalComponents,q=An(i,Y6),Y=y.useMemo(function(){return[ZM(d,u,Vc,Me,o),ZM(d,u,Vc,{},o)]},[d,u,Me]),Ce=De(Y,2),se=Ce[0],fe=Ce[1],Ze=y.useState(!1),Oe=De(Ze,2),Fe=Oe[0],Ee=Oe[1],Qe=y.useRef(),Ye=m6(f),$e=C==="rtl",st=$r(R,{value:W,postState:function(Lt){return Lt||Vc}}),Ue=De(st,2),Ne=Ue[0],je=Ue[1],Ie=function(Lt){var Rt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;function Xt(){je(Lt),he==null||he(Lt)}Rt?sc.flushSync(Xt):Xt()},Te=y.useState(Ne),ue=De(Te,2),Pe=ue[0],be=ue[1],Le=y.useRef(!1),ct=y.useMemo(function(){return(p==="inline"||p==="vertical")&&m?["vertical",m]:[p,!1]},[p,m]),dt=De(ct,2),It=dt[0],Vt=dt[1],vt=It==="inline",et=y.useState(It),rt=De(et,2),ut=rt[0],Tt=rt[1],Ft=y.useState(Vt),ft=De(Ft,2),At=ft[0],Gt=ft[1];y.useEffect(function(){Tt(It),Gt(Vt),Le.current&&(vt?je(Pe):Ie(Vc))},[It,Vt]);var Bt=y.useState(0),Yt=De(Bt,2),St=Yt[0],sn=Yt[1],Ot=St>=se.length-1||ut!=="horizontal"||b;y.useEffect(function(){vt&&be(Ne)},[Ne]),y.useEffect(function(){return Le.current=!0,function(){Le.current=!1}},[]);var U=h6(),ee=U.registerPath,Be=U.unregisterPath,_=U.refreshOverflowKeys,te=U.isSubPathKey,ce=U.getKeyPath,le=U.getKeys,re=U.getSubPathKeys,xe=y.useMemo(function(){return{registerPath:ee,unregisterPath:Be}},[ee,Be]),Xe=y.useMemo(function(){return{isSubPathKey:te}},[te]);y.useEffect(function(){_(Ot?Vc:se.slice(St+1).map(function(mt){return mt.key}))},[St,Ot]);var _e=$r(M||N&&((n=se[0])===null||n===void 0?void 0:n.key),{value:M}),We=De(_e,2),pt=We[0],lt=We[1],nt=uC(function(mt){lt(mt)}),wt=uC(function(){lt(void 0)});y.useImperativeHandle(e,function(){return{list:Qe.current,focus:function(Lt){var Rt,Xt=le(),en=hS(Xt,Ye),Rn=en.elements,bn=en.key2element,On=en.element2key,gi=wZ(Qe.current,Rn),ni=pt??(gi[0]?On.get(gi[0]):(Rt=se.find(function(jo){return!jo.props.disabled}))===null||Rt===void 0?void 0:Rt.key),ai=bn.get(ni);if(ni&&ai){var Vi;ai==null||(Vi=ai.focus)===null||Vi===void 0||Vi.call(ai,Lt)}}}});var ot=$r(J||[],{value:F,postState:function(Lt){return Array.isArray(Lt)?Lt:Lt==null?Vc:[Lt]}}),bt=De(ot,2),Wt=bt[0],yt=bt[1],ht=function(Lt){if(E){var Rt=Lt.key,Xt=Wt.includes(Rt),en;k?Xt?en=Wt.filter(function(bn){return bn!==Rt}):en=[].concat(Et(Wt),[Rt]):en=[Rt],yt(en);var Rn=Re(Re({},Lt),{},{selectedKeys:en});Xt?z==null||z(Rn):L==null||L(Rn)}!k&&Ne.length&&ut!=="inline"&&Ie(Vc)},Qt=uC(function(mt){ne==null||ne(t0(mt)),ht(mt)}),zt=uC(function(mt,Lt){var Rt=Ne.filter(function(en){return en!==mt});if(Lt)Rt.push(mt);else if(ut!=="inline"){var Xt=re(mt);Rt=Rt.filter(function(en){return!Xt.has(en)})}gh(Ne,Rt,!0)||Ie(Rt,!0)}),Pt=function(Lt,Rt){var Xt=Rt??!Ne.includes(Lt);zt(Lt,Xt)},dn=d6(ut,pt,$e,Ye,Qe,le,ce,lt,Pt,ae);y.useEffect(function(){Ee(!0)},[]);var un=y.useMemo(function(){return{_internalRenderMenuItem:He,_internalRenderSubMenuItem:ve}},[He,ve]),In=ut!=="horizontal"||b?se:se.map(function(mt,Lt){return y.createElement(mh,{key:mt.key,overflowDisabled:Lt>St},mt)}),Ht=y.createElement(bs,Zt({id:f,ref:Qe,prefixCls:"".concat(o,"-overflow"),component:"ul",itemComponent:Sv,className:qe(o,"".concat(o,"-root"),"".concat(o,"-").concat(ut),l,we(we({},"".concat(o,"-inline-collapsed"),At),"".concat(o,"-rtl"),$e),a),dir:C,style:s,role:"menu",tabIndex:g,data:In,renderRawItem:function(Lt){return Lt},renderRawRest:function(Lt){var Rt=Lt.length,Xt=Rt?se.slice(-Rt):null;return y.createElement(WZ,{eventKey:fS,title:me,disabled:Ot,internalPopupClose:Rt===0,popupClassName:T},Xt)},maxCount:ut!=="horizontal"||b?bs.INVALIDATE:bs.RESPONSIVE,ssr:"full","data-menu-list":!0,onVisibleChange:function(Lt){sn(Lt)},onKeyDown:dn},q));return y.createElement(SZ.Provider,{value:un},y.createElement(WY.Provider,{value:Ye},y.createElement(mh,{prefixCls:o,rootClassName:a,mode:ut,openKeys:Ne,rtl:$e,disabled:A,motion:Fe?j:null,defaultMotions:Fe?P:null,activeKey:pt,onActive:nt,onInactive:wt,selectedKeys:Wt,inlineIndent:O,subMenuOpenDelay:w,subMenuCloseDelay:Z,forceSubMenuRender:x,builtinPlacements:ie,triggerSubMenuAction:oe,getPopupContainer:Ge,itemIcon:de,expandIcon:Ve,onItemClick:Qt,onOpenChange:zt},y.createElement(HY.Provider,{value:Xe},Ht),y.createElement("div",{style:{display:"none"},"aria-hidden":!0},y.createElement(NY.Provider,{value:xe},fe)))))}),nf=z6;nf.Item=Sv;nf.SubMenu=WZ;nf.ItemGroup=TY;nf.Divider=LY;var K6={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}}]},name:"left",theme:"outlined"},L6=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:K6}))},xM=y.forwardRef(L6),T6={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"ellipsis",theme:"outlined"},_6=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:T6}))},k6=y.forwardRef(_6);function VZ(t){return ci(t,{inputAffixPadding:t.paddingXXS})}const MZ=t=>{const{controlHeight:e,fontSize:n,lineHeight:i,lineWidth:r,controlHeightSM:o,controlHeightLG:a,fontSizeLG:s,lineHeightLG:l,paddingSM:c,controlPaddingHorizontalSM:g,controlPaddingHorizontal:u,colorFillAlter:d,colorPrimaryHover:C,colorPrimary:f,controlOutlineWidth:v,controlOutline:p,colorErrorOutline:m,colorWarningOutline:A,colorBgContainer:b}=t;return{paddingBlock:Math.max(Math.round((e-n*i)/2*10)/10-r,0),paddingBlockSM:Math.max(Math.round((o-n*i)/2*10)/10-r,0),paddingBlockLG:Math.ceil((a-s*l)/2*10)/10-r,paddingInline:c-r,paddingInlineSM:g-r,paddingInlineLG:u-r,addonBg:d,activeBorderColor:f,hoverBorderColor:C,activeShadow:`0 0 0 ${v}px ${p}`,errorActiveShadow:`0 0 0 ${v}px ${m}`,warningActiveShadow:`0 0 0 ${v}px ${A}`,hoverBg:b,activeBg:b,inputFontSize:n,inputFontSizeLG:s,inputFontSizeSM:n}},P6=t=>({borderColor:t.hoverBorderColor,backgroundColor:t.hoverBg}),wv=t=>({color:t.colorTextDisabled,backgroundColor:t.colorBgContainerDisabled,borderColor:t.colorBorder,boxShadow:"none",cursor:"not-allowed",opacity:1,"input[disabled], textarea[disabled]":{cursor:"not-allowed"},"&:hover:not([disabled])":Object.assign({},P6(ci(t,{hoverBorderColor:t.colorBorder,hoverBg:t.colorBgContainerDisabled})))}),NZ=(t,e)=>({background:t.colorBgContainer,borderWidth:t.lineWidth,borderStyle:t.lineType,borderColor:e.borderColor,"&:hover":{borderColor:e.hoverBorderColor,backgroundColor:t.hoverBg},"&:focus, &:focus-within":{borderColor:e.activeBorderColor,boxShadow:e.activeShadow,outline:0,backgroundColor:t.activeBg}}),RM=(t,e)=>({[`&${t.componentCls}-status-${e.status}:not(${t.componentCls}-disabled)`]:Object.assign(Object.assign({},NZ(t,e)),{[`${t.componentCls}-prefix, ${t.componentCls}-suffix`]:{color:e.affixColor}}),[`&${t.componentCls}-status-${e.status}${t.componentCls}-disabled`]:{borderColor:e.borderColor}}),U6=(t,e)=>({"&-outlined":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},NZ(t,{borderColor:t.colorBorder,hoverBorderColor:t.hoverBorderColor,activeBorderColor:t.activeBorderColor,activeShadow:t.activeShadow})),{[`&${t.componentCls}-disabled, &[disabled]`]:Object.assign({},wv(t))}),RM(t,{status:"error",borderColor:t.colorError,hoverBorderColor:t.colorErrorBorderHover,activeBorderColor:t.colorError,activeShadow:t.errorActiveShadow,affixColor:t.colorError})),RM(t,{status:"warning",borderColor:t.colorWarning,hoverBorderColor:t.colorWarningBorderHover,activeBorderColor:t.colorWarning,activeShadow:t.warningActiveShadow,affixColor:t.colorWarning})),e)}),WM=(t,e)=>({[`&${t.componentCls}-group-wrapper-status-${e.status}`]:{[`${t.componentCls}-group-addon`]:{borderColor:e.addonBorderColor,color:e.addonColor}}}),D6=t=>({"&-outlined":Object.assign(Object.assign(Object.assign({[`${t.componentCls}-group`]:{"&-addon":{background:t.addonBg,border:`${Je(t.lineWidth)} ${t.lineType} ${t.colorBorder}`},"&-addon:first-child":{borderInlineEnd:0},"&-addon:last-child":{borderInlineStart:0}}},WM(t,{status:"error",addonBorderColor:t.colorError,addonColor:t.colorErrorText})),WM(t,{status:"warning",addonBorderColor:t.colorWarning,addonColor:t.colorWarningText})),{[`&${t.componentCls}-group-wrapper-disabled`]:{[`${t.componentCls}-group-addon`]:Object.assign({},wv(t))}})}),O6=(t,e)=>{const{componentCls:n}=t;return{"&-borderless":Object.assign({background:"transparent",border:"none","&:focus, &:focus-within":{outline:"none"},[`&${n}-disabled, &[disabled]`]:{color:t.colorTextDisabled},[`&${n}-status-error`]:{"&, & input, & textarea":{color:t.colorError}},[`&${n}-status-warning`]:{"&, & input, & textarea":{color:t.colorWarning}}},e)}},_Y=(t,e)=>({background:e.bg,borderWidth:t.lineWidth,borderStyle:t.lineType,borderColor:"transparent","input&, & input, textarea&, & textarea":{color:e==null?void 0:e.inputColor},"&:hover":{background:e.hoverBg},"&:focus, &:focus-within":{outline:0,borderColor:e.activeBorderColor,backgroundColor:t.activeBg}}),VM=(t,e)=>({[`&${t.componentCls}-status-${e.status}:not(${t.componentCls}-disabled)`]:Object.assign(Object.assign({},_Y(t,e)),{[`${t.componentCls}-prefix, ${t.componentCls}-suffix`]:{color:e.affixColor}})}),J6=(t,e)=>({"&-filled":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},_Y(t,{bg:t.colorFillTertiary,hoverBg:t.colorFillSecondary,activeBorderColor:t.activeBorderColor})),{[`&${t.componentCls}-disabled, &[disabled]`]:Object.assign({},wv(t))}),VM(t,{status:"error",bg:t.colorErrorBg,hoverBg:t.colorErrorBgHover,activeBorderColor:t.colorError,inputColor:t.colorErrorText,affixColor:t.colorError})),VM(t,{status:"warning",bg:t.colorWarningBg,hoverBg:t.colorWarningBgHover,activeBorderColor:t.colorWarning,inputColor:t.colorWarningText,affixColor:t.colorWarning})),e)}),MM=(t,e)=>({[`&${t.componentCls}-group-wrapper-status-${e.status}`]:{[`${t.componentCls}-group-addon`]:{background:e.addonBg,color:e.addonColor}}}),Q6=t=>({"&-filled":Object.assign(Object.assign(Object.assign({[`${t.componentCls}-group`]:{"&-addon":{background:t.colorFillTertiary},[`${t.componentCls}-filled:not(:focus):not(:focus-within)`]:{"&:not(:first-child)":{borderInlineStart:`${Je(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},"&:not(:last-child)":{borderInlineEnd:`${Je(t.lineWidth)} ${t.lineType} ${t.colorSplit}`}}}},MM(t,{status:"error",addonBg:t.colorErrorBg,addonColor:t.colorErrorText})),MM(t,{status:"warning",addonBg:t.colorWarningBg,addonColor:t.colorWarningText})),{[`&${t.componentCls}-group-wrapper-disabled`]:{[`${t.componentCls}-group`]:{"&-addon":{background:t.colorFillTertiary,color:t.colorTextDisabled},"&-addon:first-child":{borderInlineStart:`${Je(t.lineWidth)} ${t.lineType} ${t.colorBorder}`,borderTop:`${Je(t.lineWidth)} ${t.lineType} ${t.colorBorder}`,borderBottom:`${Je(t.lineWidth)} ${t.lineType} ${t.colorBorder}`},"&-addon:last-child":{borderInlineEnd:`${Je(t.lineWidth)} ${t.lineType} ${t.colorBorder}`,borderTop:`${Je(t.lineWidth)} ${t.lineType} ${t.colorBorder}`,borderBottom:`${Je(t.lineWidth)} ${t.lineType} ${t.colorBorder}`}}}})}),j6=t=>({"&::-moz-placeholder":{opacity:1},"&::placeholder":{color:t,userSelect:"none"},"&:placeholder-shown":{textOverflow:"ellipsis"}}),kY=t=>{const{paddingBlockLG:e,lineHeightLG:n,borderRadiusLG:i,paddingInlineLG:r}=t;return{padding:`${Je(e)} ${Je(r)}`,fontSize:t.inputFontSizeLG,lineHeight:n,borderRadius:i}},FZ=t=>({padding:`${Je(t.paddingBlockSM)} ${Je(t.paddingInlineSM)}`,fontSize:t.inputFontSizeSM,borderRadius:t.borderRadiusSM}),HZ=t=>Object.assign(Object.assign({position:"relative",display:"inline-block",width:"100%",minWidth:0,padding:`${Je(t.paddingBlock)} ${Je(t.paddingInline)}`,color:t.colorText,fontSize:t.inputFontSize,lineHeight:t.lineHeight,borderRadius:t.borderRadius,transition:`all ${t.motionDurationMid}`},j6(t.colorTextPlaceholder)),{"textarea&":{maxWidth:"100%",height:"auto",minHeight:t.controlHeight,lineHeight:t.lineHeight,verticalAlign:"bottom",transition:`all ${t.motionDurationSlow}, height 0s`,resize:"vertical"},"&-lg":Object.assign({},kY(t)),"&-sm":Object.assign({},FZ(t)),"&-rtl, &-textarea-rtl":{direction:"rtl"}}),$6=t=>{const{componentCls:e,antCls:n}=t;return{position:"relative",display:"table",width:"100%",borderCollapse:"separate",borderSpacing:0,"&[class*='col-']":{paddingInlineEnd:t.paddingXS,"&:last-child":{paddingInlineEnd:0}},[`&-lg ${e}, &-lg > ${e}-group-addon`]:Object.assign({},kY(t)),[`&-sm ${e}, &-sm > ${e}-group-addon`]:Object.assign({},FZ(t)),[`&-lg ${n}-select-single ${n}-select-selector`]:{height:t.controlHeightLG},[`&-sm ${n}-select-single ${n}-select-selector`]:{height:t.controlHeightSM},[`> ${e}`]:{display:"table-cell","&:not(:first-child):not(:last-child)":{borderRadius:0}},[`${e}-group`]:{"&-addon, &-wrap":{display:"table-cell",width:1,whiteSpace:"nowrap",verticalAlign:"middle","&:not(:first-child):not(:last-child)":{borderRadius:0}},"&-wrap > *":{display:"block !important"},"&-addon":{position:"relative",padding:`0 ${Je(t.paddingInline)}`,color:t.colorText,fontWeight:"normal",fontSize:t.inputFontSize,textAlign:"center",borderRadius:t.borderRadius,transition:`all ${t.motionDurationSlow}`,lineHeight:1,[`${n}-select`]:{margin:`${Je(t.calc(t.paddingBlock).add(1).mul(-1).equal())} ${Je(t.calc(t.paddingInline).mul(-1).equal())}`,[`&${n}-select-single:not(${n}-select-customize-input):not(${n}-pagination-size-changer)`]:{[`${n}-select-selector`]:{backgroundColor:"inherit",border:`${Je(t.lineWidth)} ${t.lineType} transparent`,boxShadow:"none"}}},[`${n}-cascader-picker`]:{margin:`-9px ${Je(t.calc(t.paddingInline).mul(-1).equal())}`,backgroundColor:"transparent",[`${n}-cascader-input`]:{textAlign:"start",border:0,boxShadow:"none"}}}},[e]:{width:"100%",marginBottom:0,textAlign:"inherit","&:focus":{zIndex:1,borderInlineEndWidth:1},"&:hover":{zIndex:1,borderInlineEndWidth:1,[`${e}-search-with-button &`]:{zIndex:0}}},[`> ${e}:first-child, ${e}-group-addon:first-child`]:{borderStartEndRadius:0,borderEndEndRadius:0,[`${n}-select ${n}-select-selector`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${e}-affix-wrapper`]:{[`&:not(:first-child) ${e}`]:{borderStartStartRadius:0,borderEndStartRadius:0},[`&:not(:last-child) ${e}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${e}:last-child, ${e}-group-addon:last-child`]:{borderStartStartRadius:0,borderEndStartRadius:0,[`${n}-select ${n}-select-selector`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`${e}-affix-wrapper`]:{"&:not(:last-child)":{borderStartEndRadius:0,borderEndEndRadius:0,[`${e}-search &`]:{borderStartStartRadius:t.borderRadius,borderEndStartRadius:t.borderRadius}},[`&:not(:first-child), ${e}-search &:not(:first-child)`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&${e}-group-compact`]:Object.assign(Object.assign({display:"block"},jd()),{[`${e}-group-addon, ${e}-group-wrap, > ${e}`]:{"&:not(:first-child):not(:last-child)":{borderInlineEndWidth:t.lineWidth,"&:hover, &:focus":{zIndex:1}}},"& > *":{display:"inline-flex",float:"none",verticalAlign:"top",borderRadius:0},[`
        & > ${e}-affix-wrapper,
        & > ${e}-number-affix-wrapper,
        & > ${n}-picker-range
      `]:{display:"inline-flex"},"& > *:not(:last-child)":{marginInlineEnd:t.calc(t.lineWidth).mul(-1).equal(),borderInlineEndWidth:t.lineWidth},[e]:{float:"none"},[`& > ${n}-select > ${n}-select-selector,
      & > ${n}-select-auto-complete ${e},
      & > ${n}-cascader-picker ${e},
      & > ${e}-group-wrapper ${e}`]:{borderInlineEndWidth:t.lineWidth,borderRadius:0,"&:hover, &:focus":{zIndex:1}},[`& > ${n}-select-focused`]:{zIndex:1},[`& > ${n}-select > ${n}-select-arrow`]:{zIndex:1},[`& > *:first-child,
      & > ${n}-select:first-child > ${n}-select-selector,
      & > ${n}-select-auto-complete:first-child ${e},
      & > ${n}-cascader-picker:first-child ${e}`]:{borderStartStartRadius:t.borderRadius,borderEndStartRadius:t.borderRadius},[`& > *:last-child,
      & > ${n}-select:last-child > ${n}-select-selector,
      & > ${n}-cascader-picker:last-child ${e},
      & > ${n}-cascader-picker-focused:last-child ${e}`]:{borderInlineEndWidth:t.lineWidth,borderStartEndRadius:t.borderRadius,borderEndEndRadius:t.borderRadius},[`& > ${n}-select-auto-complete ${e}`]:{verticalAlign:"top"},[`${e}-group-wrapper + ${e}-group-wrapper`]:{marginInlineStart:t.calc(t.lineWidth).mul(-1).equal(),[`${e}-affix-wrapper`]:{borderRadius:0}},[`${e}-group-wrapper:not(:last-child)`]:{[`&${e}-search > ${e}-group`]:{[`& > ${e}-group-addon > ${e}-search-button`]:{borderRadius:0},[`& > ${e}`]:{borderStartStartRadius:t.borderRadius,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:t.borderRadius}}}})}},q6=t=>{const{componentCls:e,controlHeightSM:n,lineWidth:i,calc:r}=t,a=r(n).sub(r(i).mul(2)).sub(16).div(2).equal();return{[e]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ba(t)),HZ(t)),U6(t)),J6(t)),O6(t)),{'&[type="color"]':{height:t.controlHeight,[`&${e}-lg`]:{height:t.controlHeightLG},[`&${e}-sm`]:{height:n,paddingTop:a,paddingBottom:a}},'&[type="search"]::-webkit-search-cancel-button, &[type="search"]::-webkit-search-decoration':{"-webkit-appearance":"none"}})}},e$=t=>{const{componentCls:e}=t;return{[`${e}-clear-icon`]:{margin:0,color:t.colorTextQuaternary,fontSize:t.fontSizeIcon,verticalAlign:-1,cursor:"pointer",transition:`color ${t.motionDurationSlow}`,"&:hover":{color:t.colorTextTertiary},"&:active":{color:t.colorText},"&-hidden":{visibility:"hidden"},"&-has-suffix":{margin:`0 ${Je(t.inputAffixPadding)}`}}}},t$=t=>{const{componentCls:e,inputAffixPadding:n,colorTextDescription:i,motionDurationSlow:r,colorIcon:o,colorIconHover:a,iconCls:s}=t,l=`${e}-affix-wrapper`,c=`${e}-affix-wrapper-disabled`;return{[l]:Object.assign(Object.assign(Object.assign(Object.assign({},HZ(t)),{display:"inline-flex",[`&:not(${e}-disabled):hover`]:{zIndex:1,[`${e}-search-with-button &`]:{zIndex:0}},"&-focused, &:focus":{zIndex:1},[`> input${e}`]:{padding:0},[`> input${e}, > textarea${e}`]:{fontSize:"inherit",border:"none",borderRadius:0,outline:"none",background:"transparent",color:"inherit","&::-ms-reveal":{display:"none"},"&:focus":{boxShadow:"none !important"}},"&::before":{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'},[e]:{"&-prefix, &-suffix":{display:"flex",flex:"none",alignItems:"center","> *:not(:last-child)":{marginInlineEnd:t.paddingXS}},"&-show-count-suffix":{color:i},"&-show-count-has-suffix":{marginInlineEnd:t.paddingXXS},"&-prefix":{marginInlineEnd:n},"&-suffix":{marginInlineStart:n}}}),e$(t)),{[`${s}${e}-password-icon`]:{color:o,cursor:"pointer",transition:`all ${r}`,"&:hover":{color:a}}}),[c]:{[`${s}${e}-password-icon`]:{color:o,cursor:"not-allowed","&:hover":{color:o}}}}},n$=t=>{const{componentCls:e,borderRadiusLG:n,borderRadiusSM:i}=t;return{[`${e}-group`]:Object.assign(Object.assign(Object.assign({},ba(t)),$6(t)),{"&-rtl":{direction:"rtl"},"&-wrapper":Object.assign(Object.assign(Object.assign({display:"inline-block",width:"100%",textAlign:"start",verticalAlign:"top","&-rtl":{direction:"rtl"},"&-lg":{[`${e}-group-addon`]:{borderRadius:n,fontSize:t.inputFontSizeLG}},"&-sm":{[`${e}-group-addon`]:{borderRadius:i}}},D6(t)),Q6(t)),{[`&:not(${e}-compact-first-item):not(${e}-compact-last-item)${e}-compact-item`]:{[`${e}, ${e}-group-addon`]:{borderRadius:0}},[`&:not(${e}-compact-last-item)${e}-compact-first-item`]:{[`${e}, ${e}-group-addon`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&:not(${e}-compact-first-item)${e}-compact-last-item`]:{[`${e}, ${e}-group-addon`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&:not(${e}-compact-last-item)${e}-compact-item`]:{[`${e}-affix-wrapper`]:{borderStartEndRadius:0,borderEndEndRadius:0}}})})}},i$=t=>{const{componentCls:e,antCls:n}=t,i=`${e}-search`;return{[i]:{[e]:{"&:hover, &:focus":{borderColor:t.colorPrimaryHover,[`+ ${e}-group-addon ${i}-button:not(${n}-btn-primary)`]:{borderInlineStartColor:t.colorPrimaryHover}}},[`${e}-affix-wrapper`]:{height:t.controlHeight,borderRadius:0},[`${e}-lg`]:{lineHeight:t.calc(t.lineHeightLG).sub(2e-4).equal()},[`> ${e}-group`]:{[`> ${e}-group-addon:last-child`]:{insetInlineStart:-1,padding:0,border:0,[`${i}-button`]:{marginInlineEnd:-1,paddingTop:0,paddingBottom:0,borderStartStartRadius:0,borderEndStartRadius:0,boxShadow:"none"},[`${i}-button:not(${n}-btn-primary)`]:{color:t.colorTextDescription,"&:hover":{color:t.colorPrimaryHover},"&:active":{color:t.colorPrimaryActive},[`&${n}-btn-loading::before`]:{insetInlineStart:0,insetInlineEnd:0,insetBlockStart:0,insetBlockEnd:0}}}},[`${i}-button`]:{height:t.controlHeight,"&:hover, &:focus":{zIndex:1}},"&-large":{[`${e}-affix-wrapper, ${i}-button`]:{height:t.controlHeightLG}},"&-small":{[`${e}-affix-wrapper, ${i}-button`]:{height:t.controlHeightSM}},"&-rtl":{direction:"rtl"},[`&${e}-compact-item`]:{[`&:not(${e}-compact-last-item)`]:{[`${e}-group-addon`]:{[`${e}-search-button`]:{marginInlineEnd:t.calc(t.lineWidth).mul(-1).equal(),borderRadius:0}}},[`&:not(${e}-compact-first-item)`]:{[`${e},${e}-affix-wrapper`]:{borderRadius:0}},[`> ${e}-group-addon ${e}-search-button,
        > ${e},
        ${e}-affix-wrapper`]:{"&:hover, &:focus, &:active":{zIndex:2}},[`> ${e}-affix-wrapper-focused`]:{zIndex:2}}}}},r$=t=>{const{componentCls:e,paddingLG:n}=t,i=`${e}-textarea`;return{[i]:{position:"relative","&-show-count":{[`> ${e}`]:{height:"100%"},[`${e}-data-count`]:{position:"absolute",bottom:t.calc(t.fontSize).mul(t.lineHeight).mul(-1).equal(),insetInlineEnd:0,color:t.colorTextDescription,whiteSpace:"nowrap",pointerEvents:"none"}},[`
        &-allow-clear > ${e},
        &-affix-wrapper${i}-has-feedback ${e}
      `]:{paddingInlineEnd:n},[`&-affix-wrapper${e}-affix-wrapper`]:{padding:0,[`> textarea${e}`]:{fontSize:"inherit",border:"none",outline:"none",background:"transparent","&:focus":{boxShadow:"none !important"}},[`${e}-suffix`]:{margin:0,"> *:not(:last-child)":{marginInline:0},[`${e}-clear-icon`]:{position:"absolute",insetInlineEnd:t.paddingInline,insetBlockStart:t.paddingXS},[`${i}-suffix`]:{position:"absolute",top:0,insetInlineEnd:t.paddingInline,bottom:0,zIndex:1,display:"inline-flex",alignItems:"center",margin:"auto",pointerEvents:"none"}}},[`&-affix-wrapper${e}-affix-wrapper-sm`]:{[`${e}-suffix`]:{[`${e}-clear-icon`]:{insetInlineEnd:t.paddingInlineSM}}}}}},o$=t=>{const{componentCls:e}=t;return{[`${e}-out-of-range`]:{[`&, & input, & textarea, ${e}-show-count-suffix, ${e}-data-count`]:{color:t.colorError}}}},XZ=yo("Input",t=>{const e=ci(t,VZ(t));return[q6(e),r$(e),t$(e),n$(e),i$(e),o$(e),hZ(e)]},MZ,{resetFont:!1});var a$={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},s$=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:a$}))},PY=y.forwardRef(s$);const Zv=y.createContext(null);var l$=function(e){var n=e.activeTabOffset,i=e.horizontal,r=e.rtl,o=e.indicator,a=o===void 0?{}:o,s=a.size,l=a.align,c=l===void 0?"center":l,g=y.useState(),u=De(g,2),d=u[0],C=u[1],f=y.useRef(),v=ze.useCallback(function(m){return typeof s=="function"?s(m):typeof s=="number"?s:m},[s]);function p(){Ln.cancel(f.current)}return y.useEffect(function(){var m={};if(n)if(i){m.width=v(n.width);var A=r?"right":"left";c==="start"&&(m[A]=n[A]),c==="center"&&(m[A]=n[A]+n.width/2,m.transform=r?"translateX(50%)":"translateX(-50%)"),c==="end"&&(m[A]=n[A]+n.width,m.transform="translateX(-100%)")}else m.height=v(n.height),c==="start"&&(m.top=n.top),c==="center"&&(m.top=n.top+n.height/2,m.transform="translateY(-50%)"),c==="end"&&(m.top=n.top+n.height,m.transform="translateY(-100%)");return p(),f.current=Ln(function(){C(m)}),p},[n,i,r,c,v]),{style:d}},NM={width:0,height:0,left:0,top:0};function c$(t,e,n){return y.useMemo(function(){for(var i,r=new Map,o=e.get((i=t[0])===null||i===void 0?void 0:i.key)||NM,a=o.left+o.width,s=0;s<t.length;s+=1){var l=t[s].key,c=e.get(l);if(!c){var g;c=e.get((g=t[s-1])===null||g===void 0?void 0:g.key)||NM}var u=r.get(l)||Re({},c);u.right=a-u.left-u.width,r.set(l,u)}return r},[t.map(function(i){return i.key}).join("_"),e,n])}function FM(t,e){var n=y.useRef(t),i=y.useState({}),r=De(i,2),o=r[1];function a(s){var l=typeof s=="function"?s(n.current):s;l!==n.current&&e(l,n.current),n.current=l,o({})}return[n.current,a]}var g$=.1,HM=.01,up=20,XM=Math.pow(.995,up);function u$(t,e){var n=y.useState(),i=De(n,2),r=i[0],o=i[1],a=y.useState(0),s=De(a,2),l=s[0],c=s[1],g=y.useState(0),u=De(g,2),d=u[0],C=u[1],f=y.useState(),v=De(f,2),p=v[0],m=v[1],A=y.useRef();function b(R){var W=R.touches[0],M=W.screenX,N=W.screenY;o({x:M,y:N}),window.clearInterval(A.current)}function G(R){if(r){var W=R.touches[0],M=W.screenX,N=W.screenY;o({x:M,y:N});var X=M-r.x,E=N-r.y;e(X,E);var Q=Date.now();c(Q),C(Q-l),m({x:X,y:E})}}function w(){if(r&&(o(null),m(null),p)){var R=p.x/d,W=p.y/d,M=Math.abs(R),N=Math.abs(W);if(Math.max(M,N)<g$)return;var X=R,E=W;A.current=window.setInterval(function(){if(Math.abs(X)<HM&&Math.abs(E)<HM){window.clearInterval(A.current);return}X*=XM,E*=XM,e(X*up,E*up)},up)}}var S=y.useRef();function Z(R){var W=R.deltaX,M=R.deltaY,N=0,X=Math.abs(W),E=Math.abs(M);X===E?N=S.current==="x"?W:M:X>E?(N=W,S.current="x"):(N=M,S.current="y"),e(-N,-N)&&R.preventDefault()}var x=y.useRef(null);x.current={onTouchStart:b,onTouchMove:G,onTouchEnd:w,onWheel:Z},y.useEffect(function(){function R(X){x.current.onTouchStart(X)}function W(X){x.current.onTouchMove(X)}function M(X){x.current.onTouchEnd(X)}function N(X){x.current.onWheel(X)}return document.addEventListener("touchmove",W,{passive:!1}),document.addEventListener("touchend",M,{passive:!0}),t.current.addEventListener("touchstart",R,{passive:!0}),t.current.addEventListener("wheel",N,{passive:!1}),function(){document.removeEventListener("touchmove",W),document.removeEventListener("touchend",M)}},[])}function UY(t){var e=y.useState(0),n=De(e,2),i=n[0],r=n[1],o=y.useRef(0),a=y.useRef();return a.current=t,v2(function(){var s;(s=a.current)===null||s===void 0||s.call(a)},[i]),function(){o.current===i&&(o.current+=1,r(o.current))}}function d$(t){var e=y.useRef([]),n=y.useState({}),i=De(n,2),r=i[1],o=y.useRef(typeof t=="function"?t():t),a=UY(function(){var l=o.current;e.current.forEach(function(c){l=c(l)}),e.current=[],o.current=l,r({})});function s(l){e.current.push(l),a()}return[o.current,s]}var EM={width:0,height:0,left:0,top:0,right:0};function I$(t,e,n,i,r,o,a){var s=a.tabs,l=a.tabPosition,c=a.rtl,g,u,d;return["top","bottom"].includes(l)?(g="width",u=c?"right":"left",d=Math.abs(n)):(g="height",u="top",d=-n),y.useMemo(function(){if(!s.length)return[0,0];for(var C=s.length,f=C,v=0;v<C;v+=1){var p=t.get(s[v].key)||EM;if(Math.floor(p[u]+p[g])>Math.floor(d+e)){f=v-1;break}}for(var m=0,A=C-1;A>=0;A-=1){var b=t.get(s[A].key)||EM;if(b[u]<d){m=A+1;break}}return m>=f?[0,0]:[m,f]},[t,e,i,r,o,d,l,s.map(function(C){return C.key}).join("_"),c])}function YM(t){var e;return t instanceof Map?(e={},t.forEach(function(n,i){e[i]=n})):e=t,JSON.stringify(e)}var C$="TABS_DQ";function DY(t){return String(t).replace(/"/g,C$)}function OY(t,e,n,i){return!(!n||i||t===!1||t===void 0&&(e===!1||e===null))}var JY=y.forwardRef(function(t,e){var n=t.prefixCls,i=t.editable,r=t.locale,o=t.style;return!i||i.showAdd===!1?null:y.createElement("button",{ref:e,type:"button",className:"".concat(n,"-nav-add"),style:o,"aria-label":(r==null?void 0:r.addAriaLabel)||"Add tab",onClick:function(s){i.onEdit("add",{event:s})}},i.addIcon||"+")}),zM=y.forwardRef(function(t,e){var n=t.position,i=t.prefixCls,r=t.extra;if(!r)return null;var o,a={};return qt(r)==="object"&&!y.isValidElement(r)?a=r:a.right=r,n==="right"&&(o=a.right),n==="left"&&(o=a.left),o?y.createElement("div",{className:"".concat(i,"-extra-content"),ref:e},o):null}),h$=y.forwardRef(function(t,e){var n=t.prefixCls,i=t.id,r=t.tabs,o=t.locale,a=t.mobile,s=t.more,l=s===void 0?{}:s,c=t.style,g=t.className,u=t.editable,d=t.tabBarGutter,C=t.rtl,f=t.removeAriaLabel,v=t.onTabClick,p=t.getPopupContainer,m=t.popupClassName,A=y.useState(!1),b=De(A,2),G=b[0],w=b[1],S=y.useState(null),Z=De(S,2),x=Z[0],R=Z[1],W=l.icon,M=W===void 0?"More":W,N="".concat(i,"-more-popup"),X="".concat(n,"-dropdown"),E=x!==null?"".concat(N,"-").concat(x):null,Q=o==null?void 0:o.dropdownAriaLabel;function k(j,P){j.preventDefault(),j.stopPropagation(),u.onEdit("remove",{key:P,event:j})}var J=y.createElement(nf,{onClick:function(P){var $=P.key,oe=P.domEvent;v($,oe),w(!1)},prefixCls:"".concat(X,"-menu"),id:N,tabIndex:-1,role:"listbox","aria-activedescendant":E,selectedKeys:[x],"aria-label":Q!==void 0?Q:"expanded dropdown"},r.map(function(j){var P=j.closable,$=j.disabled,oe=j.closeIcon,ie=j.key,de=j.label,Ve=OY(P,oe,u,$);return y.createElement(Sv,{key:ie,id:"".concat(N,"-").concat(ie),role:"option","aria-controls":i&&"".concat(i,"-panel-").concat(ie),disabled:$},y.createElement("span",null,de),Ve&&y.createElement("button",{type:"button","aria-label":f||"remove",tabIndex:0,className:"".concat(X,"-menu-item-remove"),onClick:function(me){me.stopPropagation(),k(me,ie)}},oe||u.removeIcon||""))}));function F(j){for(var P=r.filter(function(Ve){return!Ve.disabled}),$=P.findIndex(function(Ve){return Ve.key===x})||0,oe=P.length,ie=0;ie<oe;ie+=1){$=($+j+oe)%oe;var de=P[$];if(!de.disabled){R(de.key);return}}}function L(j){var P=j.which;if(!G){[Ct.DOWN,Ct.SPACE,Ct.ENTER].includes(P)&&(w(!0),j.preventDefault());return}switch(P){case Ct.UP:F(-1),j.preventDefault();break;case Ct.DOWN:F(1),j.preventDefault();break;case Ct.ESC:w(!1);break;case Ct.SPACE:case Ct.ENTER:x!==null&&v(x,j);break}}y.useEffect(function(){var j=document.getElementById(E);j&&j.scrollIntoView&&j.scrollIntoView(!1)},[x]),y.useEffect(function(){G||R(null)},[G]);var z=we({},C?"marginRight":"marginLeft",d);r.length||(z.visibility="hidden",z.order=1);var K=qe(we({},"".concat(X,"-rtl"),C)),O=a?null:y.createElement(r6,Zt({prefixCls:X,overlay:J,visible:r.length?G:!1,onVisibleChange:w,overlayClassName:qe(K,m),mouseEnterDelay:.1,mouseLeaveDelay:.1,getPopupContainer:p},l),y.createElement("button",{type:"button",className:"".concat(n,"-nav-more"),style:z,tabIndex:-1,"aria-hidden":"true","aria-haspopup":"listbox","aria-controls":N,id:"".concat(i,"-more"),"aria-expanded":G,onKeyDown:L},M));return y.createElement("div",{className:qe("".concat(n,"-nav-operations"),g),style:c,ref:e},O,y.createElement(JY,{prefixCls:n,locale:o,editable:u}))});const f$=y.memo(h$,function(t,e){return e.tabMoving});var m$=function(e){var n=e.prefixCls,i=e.id,r=e.active,o=e.tab,a=o.key,s=o.label,l=o.disabled,c=o.closeIcon,g=o.icon,u=e.closable,d=e.renderWrapper,C=e.removeAriaLabel,f=e.editable,v=e.onClick,p=e.onFocus,m=e.style,A="".concat(n,"-tab"),b=OY(u,c,f,l);function G(x){l||v(x)}function w(x){x.preventDefault(),x.stopPropagation(),f.onEdit("remove",{key:a,event:x})}var S=y.useMemo(function(){return g&&typeof s=="string"?y.createElement("span",null,s):s},[s,g]),Z=y.createElement("div",{key:a,"data-node-key":DY(a),className:qe(A,we(we(we({},"".concat(A,"-with-remove"),b),"".concat(A,"-active"),r),"".concat(A,"-disabled"),l)),style:m,onClick:G},y.createElement("div",{role:"tab","aria-selected":r,id:i&&"".concat(i,"-tab-").concat(a),className:"".concat(A,"-btn"),"aria-controls":i&&"".concat(i,"-panel-").concat(a),"aria-disabled":l,tabIndex:l?null:0,onClick:function(R){R.stopPropagation(),G(R)},onKeyDown:function(R){[Ct.SPACE,Ct.ENTER].includes(R.which)&&(R.preventDefault(),G(R))},onFocus:p},g&&y.createElement("span",{className:"".concat(A,"-icon")},g),s&&S),b&&y.createElement("button",{type:"button","aria-label":C||"remove",tabIndex:0,className:"".concat(A,"-remove"),onClick:function(R){R.stopPropagation(),w(R)}},c||f.removeIcon||""));return d?d(Z):Z},A$=function(e,n){var i=e.offsetWidth,r=e.offsetHeight,o=e.offsetTop,a=e.offsetLeft,s=e.getBoundingClientRect(),l=s.width,c=s.height,g=s.left,u=s.top;return Math.abs(l-i)<1?[l,c,g-n.left,u-n.top]:[i,r,a,o]},hu=function(e){var n=e.current||{},i=n.offsetWidth,r=i===void 0?0:i,o=n.offsetHeight,a=o===void 0?0:o;if(e.current){var s=e.current.getBoundingClientRect(),l=s.width,c=s.height;if(Math.abs(l-r)<1)return[l,c]}return[r,a]},Xm=function(e,n){return e[n?0:1]},KM=y.forwardRef(function(t,e){var n=t.className,i=t.style,r=t.id,o=t.animated,a=t.activeKey,s=t.rtl,l=t.extra,c=t.editable,g=t.locale,u=t.tabPosition,d=t.tabBarGutter,C=t.children,f=t.onTabClick,v=t.onTabScroll,p=t.indicator,m=y.useContext(Zv),A=m.prefixCls,b=m.tabs,G=y.useRef(null),w=y.useRef(null),S=y.useRef(null),Z=y.useRef(null),x=y.useRef(null),R=y.useRef(null),W=y.useRef(null),M=u==="top"||u==="bottom",N=FM(0,function(Ot,U){M&&v&&v({direction:Ot>U?"left":"right"})}),X=De(N,2),E=X[0],Q=X[1],k=FM(0,function(Ot,U){!M&&v&&v({direction:Ot>U?"top":"bottom"})}),J=De(k,2),F=J[0],L=J[1],z=y.useState([0,0]),K=De(z,2),O=K[0],j=K[1],P=y.useState([0,0]),$=De(P,2),oe=$[0],ie=$[1],de=y.useState([0,0]),Ve=De(de,2),Se=Ve[0],me=Ve[1],T=y.useState([0,0]),Ge=De(T,2),ne=Ge[0],he=Ge[1],ae=d$(new Map),He=De(ae,2),ve=He[0],Me=He[1],q=c$(b,ve,oe[0]),Y=Xm(O,M),Ce=Xm(oe,M),se=Xm(Se,M),fe=Xm(ne,M),Ze=Math.floor(Y)<Math.floor(Ce+se),Oe=Ze?Y-fe:Y-se,Fe="".concat(A,"-nav-operations-hidden"),Ee=0,Qe=0;M&&s?(Ee=0,Qe=Math.max(0,Ce-Oe)):(Ee=Math.min(0,Oe-Ce),Qe=0);function Ye(Ot){return Ot<Ee?Ee:Ot>Qe?Qe:Ot}var $e=y.useRef(null),st=y.useState(),Ue=De(st,2),Ne=Ue[0],je=Ue[1];function Ie(){je(Date.now())}function Te(){$e.current&&clearTimeout($e.current)}u$(Z,function(Ot,U){function ee(Be,_){Be(function(te){var ce=Ye(te+_);return ce})}return Ze?(M?ee(Q,Ot):ee(L,U),Te(),Ie(),!0):!1}),y.useEffect(function(){return Te(),Ne&&($e.current=setTimeout(function(){je(0)},100)),Te},[Ne]);var ue=I$(q,Oe,M?E:F,Ce,se,fe,Re(Re({},t),{},{tabs:b})),Pe=De(ue,2),be=Pe[0],Le=Pe[1],ct=Xi(function(){var Ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:a,U=q.get(Ot)||{width:0,height:0,left:0,right:0,top:0};if(M){var ee=E;s?U.right<E?ee=U.right:U.right+U.width>E+Oe&&(ee=U.right+U.width-Oe):U.left<-E?ee=-U.left:U.left+U.width>-E+Oe&&(ee=-(U.left+U.width-Oe)),L(0),Q(Ye(ee))}else{var Be=F;U.top<-F?Be=-U.top:U.top+U.height>-F+Oe&&(Be=-(U.top+U.height-Oe)),Q(0),L(Ye(Be))}}),dt={};u==="top"||u==="bottom"?dt[s?"marginRight":"marginLeft"]=d:dt.marginTop=d;var It=b.map(function(Ot,U){var ee=Ot.key;return y.createElement(m$,{id:r,prefixCls:A,key:ee,tab:Ot,style:U===0?void 0:dt,closable:Ot.closable,editable:c,active:ee===a,renderWrapper:C,removeAriaLabel:g==null?void 0:g.removeAriaLabel,onClick:function(_){f(ee,_)},onFocus:function(){ct(ee),Ie(),Z.current&&(s||(Z.current.scrollLeft=0),Z.current.scrollTop=0)}})}),Vt=function(){return Me(function(){var U,ee=new Map,Be=(U=x.current)===null||U===void 0?void 0:U.getBoundingClientRect();return b.forEach(function(_){var te,ce=_.key,le=(te=x.current)===null||te===void 0?void 0:te.querySelector('[data-node-key="'.concat(DY(ce),'"]'));if(le){var re=A$(le,Be),xe=De(re,4),Xe=xe[0],_e=xe[1],We=xe[2],pt=xe[3];ee.set(ce,{width:Xe,height:_e,left:We,top:pt})}}),ee})};y.useEffect(function(){Vt()},[b.map(function(Ot){return Ot.key}).join("_")]);var vt=UY(function(){var Ot=hu(G),U=hu(w),ee=hu(S);j([Ot[0]-U[0]-ee[0],Ot[1]-U[1]-ee[1]]);var Be=hu(W);me(Be);var _=hu(R);he(_);var te=hu(x);ie([te[0]-Be[0],te[1]-Be[1]]),Vt()}),et=b.slice(0,be),rt=b.slice(Le+1),ut=[].concat(Et(et),Et(rt)),Tt=q.get(a),Ft=l$({activeTabOffset:Tt,horizontal:M,indicator:p,rtl:s}),ft=Ft.style;y.useEffect(function(){ct()},[a,Ee,Qe,YM(Tt),YM(q),M]),y.useEffect(function(){vt()},[s]);var At=!!ut.length,Gt="".concat(A,"-nav-wrap"),Bt,Yt,St,sn;return M?s?(Yt=E>0,Bt=E!==Qe):(Bt=E<0,Yt=E!==Ee):(St=F<0,sn=F!==Ee),y.createElement(Pa,{onResize:vt},y.createElement("div",{ref:zg(e,G),role:"tablist",className:qe("".concat(A,"-nav"),n),style:i,onKeyDown:function(){Ie()}},y.createElement(zM,{ref:w,position:"left",extra:l,prefixCls:A}),y.createElement(Pa,{onResize:vt},y.createElement("div",{className:qe(Gt,we(we(we(we({},"".concat(Gt,"-ping-left"),Bt),"".concat(Gt,"-ping-right"),Yt),"".concat(Gt,"-ping-top"),St),"".concat(Gt,"-ping-bottom"),sn)),ref:Z},y.createElement(Pa,{onResize:vt},y.createElement("div",{ref:x,className:"".concat(A,"-nav-list"),style:{transform:"translate(".concat(E,"px, ").concat(F,"px)"),transition:Ne?"none":void 0}},It,y.createElement(JY,{ref:W,prefixCls:A,locale:g,editable:c,style:Re(Re({},It.length===0?void 0:dt),{},{visibility:At?"hidden":null})}),y.createElement("div",{className:qe("".concat(A,"-ink-bar"),we({},"".concat(A,"-ink-bar-animated"),o.inkBar)),style:ft}))))),y.createElement(f$,Zt({},t,{removeAriaLabel:g==null?void 0:g.removeAriaLabel,ref:R,prefixCls:A,tabs:ut,className:!At&&Fe,tabMoving:!!Ne})),y.createElement(zM,{ref:S,position:"right",extra:l,prefixCls:A})))}),QY=y.forwardRef(function(t,e){var n=t.prefixCls,i=t.className,r=t.style,o=t.id,a=t.active,s=t.tabKey,l=t.children;return y.createElement("div",{id:o&&"".concat(o,"-panel-").concat(s),role:"tabpanel",tabIndex:a?0:-1,"aria-labelledby":o&&"".concat(o,"-tab-").concat(s),"aria-hidden":!a,style:r,className:qe(n,a&&"".concat(n,"-active"),i),ref:e},l)}),p$=["renderTabBar"],v$=["label","key"],b$=function(e){var n=e.renderTabBar,i=An(e,p$),r=y.useContext(Zv),o=r.tabs;if(n){var a=Re(Re({},i),{},{panes:o.map(function(s){var l=s.label,c=s.key,g=An(s,v$);return y.createElement(QY,Zt({tab:l,key:c,tabKey:c},g))})});return n(a,KM)}return y.createElement(KM,i)},y$=["key","forceRender","style","className","destroyInactiveTabPane"],G$=function(e){var n=e.id,i=e.activeKey,r=e.animated,o=e.tabPosition,a=e.destroyInactiveTabPane,s=y.useContext(Zv),l=s.prefixCls,c=s.tabs,g=r.tabPane,u="".concat(l,"-tabpane");return y.createElement("div",{className:qe("".concat(l,"-content-holder"))},y.createElement("div",{className:qe("".concat(l,"-content"),"".concat(l,"-content-").concat(o),we({},"".concat(l,"-content-animated"),g))},c.map(function(d){var C=d.key,f=d.forceRender,v=d.style,p=d.className,m=d.destroyInactiveTabPane,A=An(d,y$),b=C===i;return y.createElement(Cl,Zt({key:C,visible:b,forceRender:f,removeOnLeave:!!(a||m),leavedClassName:"".concat(u,"-hidden")},r.tabPaneMotion),function(G,w){var S=G.style,Z=G.className;return y.createElement(QY,Zt({},A,{prefixCls:u,id:n,tabKey:C,animated:g,active:b,style:Re(Re({},v),S),className:qe(p,Z),ref:w}))})})))};function B$(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{inkBar:!0,tabPane:!1},e;return t===!1?e={inkBar:!1,tabPane:!1}:t===!0?e={inkBar:!0,tabPane:!1}:e=Re({inkBar:!0},qt(t)==="object"?t:{}),e.tabPaneMotion&&e.tabPane===void 0&&(e.tabPane=!0),!e.tabPaneMotion&&e.tabPane&&(e.tabPane=!1),e}var S$=["id","prefixCls","className","items","direction","activeKey","defaultActiveKey","editable","animated","tabPosition","tabBarGutter","tabBarStyle","tabBarExtraContent","locale","more","destroyInactiveTabPane","renderTabBar","onChange","onTabClick","onTabScroll","getPopupContainer","popupClassName","indicator"],LM=0,w$=y.forwardRef(function(t,e){var n=t.id,i=t.prefixCls,r=i===void 0?"rc-tabs":i,o=t.className,a=t.items,s=t.direction,l=t.activeKey,c=t.defaultActiveKey,g=t.editable,u=t.animated,d=t.tabPosition,C=d===void 0?"top":d,f=t.tabBarGutter,v=t.tabBarStyle,p=t.tabBarExtraContent,m=t.locale,A=t.more,b=t.destroyInactiveTabPane,G=t.renderTabBar,w=t.onChange,S=t.onTabClick,Z=t.onTabScroll,x=t.getPopupContainer,R=t.popupClassName,W=t.indicator,M=An(t,S$),N=y.useMemo(function(){return(a||[]).filter(function(ne){return ne&&qt(ne)==="object"&&"key"in ne})},[a]),X=s==="rtl",E=B$(u),Q=y.useState(!1),k=De(Q,2),J=k[0],F=k[1];y.useEffect(function(){F(AZ())},[]);var L=$r(function(){var ne;return(ne=N[0])===null||ne===void 0?void 0:ne.key},{value:l,defaultValue:c}),z=De(L,2),K=z[0],O=z[1],j=y.useState(function(){return N.findIndex(function(ne){return ne.key===K})}),P=De(j,2),$=P[0],oe=P[1];y.useEffect(function(){var ne=N.findIndex(function(ae){return ae.key===K});if(ne===-1){var he;ne=Math.max(0,Math.min($,N.length-1)),O((he=N[ne])===null||he===void 0?void 0:he.key)}oe(ne)},[N.map(function(ne){return ne.key}).join("_"),K,$]);var ie=$r(null,{value:n}),de=De(ie,2),Ve=de[0],Se=de[1];y.useEffect(function(){n||(Se("rc-tabs-".concat(LM)),LM+=1)},[]);function me(ne,he){S==null||S(ne,he);var ae=ne!==K;O(ne),ae&&(w==null||w(ne))}var T={id:Ve,activeKey:K,animated:E,tabPosition:C,rtl:X,mobile:J},Ge=Re(Re({},T),{},{editable:g,locale:m,more:A,tabBarGutter:f,onTabClick:me,onTabScroll:Z,extra:p,style:v,panes:null,getPopupContainer:x,popupClassName:R,indicator:W});return y.createElement(Zv.Provider,{value:{tabs:N,prefixCls:r}},y.createElement("div",Zt({ref:e,id:n,className:qe(r,"".concat(r,"-").concat(C),we(we(we({},"".concat(r,"-mobile"),J),"".concat(r,"-editable"),g),"".concat(r,"-rtl"),X),o)},M),y.createElement(b$,Zt({},Ge,{renderTabBar:G})),y.createElement(G$,Zt({destroyInactiveTabPane:b},T,{animated:E}))))});const Z$={motionAppear:!1,motionEnter:!0,motionLeave:!0};function x$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{inkBar:!0,tabPane:!1},n;return e===!1?n={inkBar:!1,tabPane:!1}:e===!0?n={inkBar:!0,tabPane:!0}:n=Object.assign({inkBar:!0},typeof e=="object"?e:{}),n.tabPane&&(n.tabPaneMotion=Object.assign(Object.assign({},Z$),{motionName:Yd(t,"switch")})),n}var R$=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function W$(t){return t.filter(e=>e)}function V$(t,e){if(t)return t;const n=Rg(e).map(i=>{if(y.isValidElement(i)){const{key:r,props:o}=i,a=o||{},{tab:s}=a,l=R$(a,["tab"]);return Object.assign(Object.assign({key:String(r)},l),{label:s})}return null});return W$(n)}const M$=t=>{const{componentCls:e,motionDurationSlow:n}=t;return[{[e]:{[`${e}-switch`]:{"&-appear, &-enter":{transition:"none","&-start":{opacity:0},"&-active":{opacity:1,transition:`opacity ${n}`}},"&-leave":{position:"absolute",transition:"none",inset:0,"&-start":{opacity:1},"&-active":{opacity:0,transition:`opacity ${n}`}}}}},[jp(t,"slide-up"),jp(t,"slide-down")]]},N$=t=>{const{componentCls:e,tabsCardPadding:n,cardBg:i,cardGutter:r,colorBorderSecondary:o,itemSelectedColor:a}=t;return{[`${e}-card`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab`]:{margin:0,padding:n,background:i,border:`${Je(t.lineWidth)} ${t.lineType} ${o}`,transition:`all ${t.motionDurationSlow} ${t.motionEaseInOut}`},[`${e}-tab-active`]:{color:a,background:t.colorBgContainer},[`${e}-ink-bar`]:{visibility:"hidden"}},[`&${e}-top, &${e}-bottom`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab + ${e}-tab`]:{marginLeft:{_skip_check_:!0,value:Je(r)}}}},[`&${e}-top`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab`]:{borderRadius:`${Je(t.borderRadiusLG)} ${Je(t.borderRadiusLG)} 0 0`},[`${e}-tab-active`]:{borderBottomColor:t.colorBgContainer}}},[`&${e}-bottom`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab`]:{borderRadius:`0 0 ${Je(t.borderRadiusLG)} ${Je(t.borderRadiusLG)}`},[`${e}-tab-active`]:{borderTopColor:t.colorBgContainer}}},[`&${e}-left, &${e}-right`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab + ${e}-tab`]:{marginTop:Je(r)}}},[`&${e}-left`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab`]:{borderRadius:{_skip_check_:!0,value:`${Je(t.borderRadiusLG)} 0 0 ${Je(t.borderRadiusLG)}`}},[`${e}-tab-active`]:{borderRightColor:{_skip_check_:!0,value:t.colorBgContainer}}}},[`&${e}-right`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab`]:{borderRadius:{_skip_check_:!0,value:`0 ${Je(t.borderRadiusLG)} ${Je(t.borderRadiusLG)} 0`}},[`${e}-tab-active`]:{borderLeftColor:{_skip_check_:!0,value:t.colorBgContainer}}}}}}},F$=t=>{const{componentCls:e,itemHoverColor:n,dropdownEdgeChildVerticalPadding:i}=t;return{[`${e}-dropdown`]:Object.assign(Object.assign({},ba(t)),{position:"absolute",top:-9999,left:{_skip_check_:!0,value:-9999},zIndex:t.zIndexPopup,display:"block","&-hidden":{display:"none"},[`${e}-dropdown-menu`]:{maxHeight:t.tabsDropdownHeight,margin:0,padding:`${Je(i)} 0`,overflowX:"hidden",overflowY:"auto",textAlign:{_skip_check_:!0,value:"left"},listStyleType:"none",backgroundColor:t.colorBgContainer,backgroundClip:"padding-box",borderRadius:t.borderRadiusLG,outline:"none",boxShadow:t.boxShadowSecondary,"&-item":Object.assign(Object.assign({},Xd),{display:"flex",alignItems:"center",minWidth:t.tabsDropdownWidth,margin:0,padding:`${Je(t.paddingXXS)} ${Je(t.paddingSM)}`,color:t.colorText,fontWeight:"normal",fontSize:t.fontSize,lineHeight:t.lineHeight,cursor:"pointer",transition:`all ${t.motionDurationSlow}`,"> span":{flex:1,whiteSpace:"nowrap"},"&-remove":{flex:"none",marginLeft:{_skip_check_:!0,value:t.marginSM},color:t.colorTextDescription,fontSize:t.fontSizeSM,background:"transparent",border:0,cursor:"pointer","&:hover":{color:n}},"&:hover":{background:t.controlItemBgHover},"&-disabled":{"&, &:hover":{color:t.colorTextDisabled,background:"transparent",cursor:"not-allowed"}}})}})}},H$=t=>{const{componentCls:e,margin:n,colorBorderSecondary:i,horizontalMargin:r,verticalItemPadding:o,verticalItemMargin:a,calc:s}=t;return{[`${e}-top, ${e}-bottom`]:{flexDirection:"column",[`> ${e}-nav, > div > ${e}-nav`]:{margin:r,"&::before":{position:"absolute",right:{_skip_check_:!0,value:0},left:{_skip_check_:!0,value:0},borderBottom:`${Je(t.lineWidth)} ${t.lineType} ${i}`,content:"''"},[`${e}-ink-bar`]:{height:t.lineWidthBold,"&-animated":{transition:`width ${t.motionDurationSlow}, left ${t.motionDurationSlow},
            right ${t.motionDurationSlow}`}},[`${e}-nav-wrap`]:{"&::before, &::after":{top:0,bottom:0,width:t.controlHeight},"&::before":{left:{_skip_check_:!0,value:0},boxShadow:t.boxShadowTabsOverflowLeft},"&::after":{right:{_skip_check_:!0,value:0},boxShadow:t.boxShadowTabsOverflowRight},[`&${e}-nav-wrap-ping-left::before`]:{opacity:1},[`&${e}-nav-wrap-ping-right::after`]:{opacity:1}}}},[`${e}-top`]:{[`> ${e}-nav,
        > div > ${e}-nav`]:{"&::before":{bottom:0},[`${e}-ink-bar`]:{bottom:0}}},[`${e}-bottom`]:{[`> ${e}-nav, > div > ${e}-nav`]:{order:1,marginTop:n,marginBottom:0,"&::before":{top:0},[`${e}-ink-bar`]:{top:0}},[`> ${e}-content-holder, > div > ${e}-content-holder`]:{order:0}},[`${e}-left, ${e}-right`]:{[`> ${e}-nav, > div > ${e}-nav`]:{flexDirection:"column",minWidth:s(t.controlHeight).mul(1.25).equal(),[`${e}-tab`]:{padding:o,textAlign:"center"},[`${e}-tab + ${e}-tab`]:{margin:a},[`${e}-nav-wrap`]:{flexDirection:"column","&::before, &::after":{right:{_skip_check_:!0,value:0},left:{_skip_check_:!0,value:0},height:t.controlHeight},"&::before":{top:0,boxShadow:t.boxShadowTabsOverflowTop},"&::after":{bottom:0,boxShadow:t.boxShadowTabsOverflowBottom},[`&${e}-nav-wrap-ping-top::before`]:{opacity:1},[`&${e}-nav-wrap-ping-bottom::after`]:{opacity:1}},[`${e}-ink-bar`]:{width:t.lineWidthBold,"&-animated":{transition:`height ${t.motionDurationSlow}, top ${t.motionDurationSlow}`}},[`${e}-nav-list, ${e}-nav-operations`]:{flex:"1 0 auto",flexDirection:"column"}}},[`${e}-left`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-ink-bar`]:{right:{_skip_check_:!0,value:0}}},[`> ${e}-content-holder, > div > ${e}-content-holder`]:{marginLeft:{_skip_check_:!0,value:Je(s(t.lineWidth).mul(-1).equal())},borderLeft:{_skip_check_:!0,value:`${Je(t.lineWidth)} ${t.lineType} ${t.colorBorder}`},[`> ${e}-content > ${e}-tabpane`]:{paddingLeft:{_skip_check_:!0,value:t.paddingLG}}}},[`${e}-right`]:{[`> ${e}-nav, > div > ${e}-nav`]:{order:1,[`${e}-ink-bar`]:{left:{_skip_check_:!0,value:0}}},[`> ${e}-content-holder, > div > ${e}-content-holder`]:{order:0,marginRight:{_skip_check_:!0,value:s(t.lineWidth).mul(-1).equal()},borderRight:{_skip_check_:!0,value:`${Je(t.lineWidth)} ${t.lineType} ${t.colorBorder}`},[`> ${e}-content > ${e}-tabpane`]:{paddingRight:{_skip_check_:!0,value:t.paddingLG}}}}}},X$=t=>{const{componentCls:e,cardPaddingSM:n,cardPaddingLG:i,horizontalItemPaddingSM:r,horizontalItemPaddingLG:o}=t;return{[e]:{"&-small":{[`> ${e}-nav`]:{[`${e}-tab`]:{padding:r,fontSize:t.titleFontSizeSM}}},"&-large":{[`> ${e}-nav`]:{[`${e}-tab`]:{padding:o,fontSize:t.titleFontSizeLG}}}},[`${e}-card`]:{[`&${e}-small`]:{[`> ${e}-nav`]:{[`${e}-tab`]:{padding:n}},[`&${e}-bottom`]:{[`> ${e}-nav ${e}-tab`]:{borderRadius:`0 0 ${Je(t.borderRadius)} ${Je(t.borderRadius)}`}},[`&${e}-top`]:{[`> ${e}-nav ${e}-tab`]:{borderRadius:`${Je(t.borderRadius)} ${Je(t.borderRadius)} 0 0`}},[`&${e}-right`]:{[`> ${e}-nav ${e}-tab`]:{borderRadius:{_skip_check_:!0,value:`0 ${Je(t.borderRadius)} ${Je(t.borderRadius)} 0`}}},[`&${e}-left`]:{[`> ${e}-nav ${e}-tab`]:{borderRadius:{_skip_check_:!0,value:`${Je(t.borderRadius)} 0 0 ${Je(t.borderRadius)}`}}}},[`&${e}-large`]:{[`> ${e}-nav`]:{[`${e}-tab`]:{padding:i}}}}}},E$=t=>{const{componentCls:e,itemActiveColor:n,itemHoverColor:i,iconCls:r,tabsHorizontalItemMargin:o,horizontalItemPadding:a,itemSelectedColor:s,itemColor:l}=t,c=`${e}-tab`;return{[c]:{position:"relative",WebkitTouchCallout:"none",WebkitTapHighlightColor:"transparent",display:"inline-flex",alignItems:"center",padding:a,fontSize:t.titleFontSize,background:"transparent",border:0,outline:"none",cursor:"pointer",color:l,"&-btn, &-remove":Object.assign({"&:focus:not(:focus-visible), &:active":{color:n}},Dh(t)),"&-btn":{outline:"none",transition:`all ${t.motionDurationSlow}`,[`${c}-icon:not(:last-child)`]:{marginInlineEnd:t.marginSM}},"&-remove":{flex:"none",marginRight:{_skip_check_:!0,value:t.calc(t.marginXXS).mul(-1).equal()},marginLeft:{_skip_check_:!0,value:t.marginXS},color:t.colorTextDescription,fontSize:t.fontSizeSM,background:"transparent",border:"none",outline:"none",cursor:"pointer",transition:`all ${t.motionDurationSlow}`,"&:hover":{color:t.colorTextHeading}},"&:hover":{color:i},[`&${c}-active ${c}-btn`]:{color:s,textShadow:t.tabsActiveTextShadow},[`&${c}-disabled`]:{color:t.colorTextDisabled,cursor:"not-allowed"},[`&${c}-disabled ${c}-btn, &${c}-disabled ${e}-remove`]:{"&:focus, &:active":{color:t.colorTextDisabled}},[`& ${c}-remove ${r}`]:{margin:0},[`${r}:not(:last-child)`]:{marginRight:{_skip_check_:!0,value:t.marginSM}}},[`${c} + ${c}`]:{margin:{_skip_check_:!0,value:o}}}},Y$=t=>{const{componentCls:e,tabsHorizontalItemMarginRTL:n,iconCls:i,cardGutter:r,calc:o}=t;return{[`${e}-rtl`]:{direction:"rtl",[`${e}-nav`]:{[`${e}-tab`]:{margin:{_skip_check_:!0,value:n},[`${e}-tab:last-of-type`]:{marginLeft:{_skip_check_:!0,value:0}},[i]:{marginRight:{_skip_check_:!0,value:0},marginLeft:{_skip_check_:!0,value:Je(t.marginSM)}},[`${e}-tab-remove`]:{marginRight:{_skip_check_:!0,value:Je(t.marginXS)},marginLeft:{_skip_check_:!0,value:Je(o(t.marginXXS).mul(-1).equal())},[i]:{margin:0}}}},[`&${e}-left`]:{[`> ${e}-nav`]:{order:1},[`> ${e}-content-holder`]:{order:0}},[`&${e}-right`]:{[`> ${e}-nav`]:{order:0},[`> ${e}-content-holder`]:{order:1}},[`&${e}-card${e}-top, &${e}-card${e}-bottom`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-tab + ${e}-tab`]:{marginRight:{_skip_check_:!0,value:r},marginLeft:{_skip_check_:!0,value:0}}}}},[`${e}-dropdown-rtl`]:{direction:"rtl"},[`${e}-menu-item`]:{[`${e}-dropdown-rtl`]:{textAlign:{_skip_check_:!0,value:"right"}}}}},z$=t=>{const{componentCls:e,tabsCardPadding:n,cardHeight:i,cardGutter:r,itemHoverColor:o,itemActiveColor:a,colorBorderSecondary:s}=t;return{[e]:Object.assign(Object.assign(Object.assign(Object.assign({},ba(t)),{display:"flex",[`> ${e}-nav, > div > ${e}-nav`]:{position:"relative",display:"flex",flex:"none",alignItems:"center",[`${e}-nav-wrap`]:{position:"relative",display:"flex",flex:"auto",alignSelf:"stretch",overflow:"hidden",whiteSpace:"nowrap",transform:"translate(0)","&::before, &::after":{position:"absolute",zIndex:1,opacity:0,transition:`opacity ${t.motionDurationSlow}`,content:"''",pointerEvents:"none"}},[`${e}-nav-list`]:{position:"relative",display:"flex",transition:`opacity ${t.motionDurationSlow}`},[`${e}-nav-operations`]:{display:"flex",alignSelf:"stretch"},[`${e}-nav-operations-hidden`]:{position:"absolute",visibility:"hidden",pointerEvents:"none"},[`${e}-nav-more`]:{position:"relative",padding:n,background:"transparent",border:0,color:t.colorText,"&::after":{position:"absolute",right:{_skip_check_:!0,value:0},bottom:0,left:{_skip_check_:!0,value:0},height:t.calc(t.controlHeightLG).div(8).equal(),transform:"translateY(100%)",content:"''"}},[`${e}-nav-add`]:Object.assign({minWidth:i,minHeight:i,marginLeft:{_skip_check_:!0,value:r},padding:`0 ${Je(t.paddingXS)}`,background:"transparent",border:`${Je(t.lineWidth)} ${t.lineType} ${s}`,borderRadius:`${Je(t.borderRadiusLG)} ${Je(t.borderRadiusLG)} 0 0`,outline:"none",cursor:"pointer",color:t.colorText,transition:`all ${t.motionDurationSlow} ${t.motionEaseInOut}`,"&:hover":{color:o},"&:active, &:focus:not(:focus-visible)":{color:a}},Dh(t))},[`${e}-extra-content`]:{flex:"none"},[`${e}-ink-bar`]:{position:"absolute",background:t.inkBarColor,pointerEvents:"none"}}),E$(t)),{[`${e}-content`]:{position:"relative",width:"100%"},[`${e}-content-holder`]:{flex:"auto",minWidth:0,minHeight:0},[`${e}-tabpane`]:{outline:"none","&-hidden":{display:"none"}}}),[`${e}-centered`]:{[`> ${e}-nav, > div > ${e}-nav`]:{[`${e}-nav-wrap`]:{[`&:not([class*='${e}-nav-wrap-ping'])`]:{justifyContent:"center"}}}}}},K$=t=>{const e=t.controlHeightLG;return{zIndexPopup:t.zIndexPopupBase+50,cardBg:t.colorFillAlter,cardHeight:e,cardPadding:`${(e-Math.round(t.fontSize*t.lineHeight))/2-t.lineWidth}px ${t.padding}px`,cardPaddingSM:`${t.paddingXXS*1.5}px ${t.padding}px`,cardPaddingLG:`${t.paddingXS}px ${t.padding}px ${t.paddingXXS*1.5}px`,titleFontSize:t.fontSize,titleFontSizeLG:t.fontSizeLG,titleFontSizeSM:t.fontSize,inkBarColor:t.colorPrimary,horizontalMargin:`0 0 ${t.margin}px 0`,horizontalItemGutter:32,horizontalItemMargin:"",horizontalItemMarginRTL:"",horizontalItemPadding:`${t.paddingSM}px 0`,horizontalItemPaddingSM:`${t.paddingXS}px 0`,horizontalItemPaddingLG:`${t.padding}px 0`,verticalItemPadding:`${t.paddingXS}px ${t.paddingLG}px`,verticalItemMargin:`${t.margin}px 0 0 0`,itemColor:t.colorText,itemSelectedColor:t.colorPrimary,itemHoverColor:t.colorPrimaryHover,itemActiveColor:t.colorPrimaryActive,cardGutter:t.marginXXS/2}},L$=yo("Tabs",t=>{const e=ci(t,{tabsCardPadding:t.cardPadding,dropdownEdgeChildVerticalPadding:t.paddingXXS,tabsActiveTextShadow:"0 0 0.25px currentcolor",tabsDropdownHeight:200,tabsDropdownWidth:120,tabsHorizontalItemMargin:`0 0 0 ${Je(t.horizontalItemGutter)}`,tabsHorizontalItemMarginRTL:`0 0 0 ${Je(t.horizontalItemGutter)}`});return[X$(e),Y$(e),H$(e),F$(e),N$(e),z$(e),M$(e)]},K$),T$=()=>null;var _$=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const jY=t=>{var e,n,i,r,o,a,s,l,c,g,u;const{type:d,className:C,rootClassName:f,size:v,onEdit:p,hideAdd:m,centered:A,addIcon:b,removeIcon:G,moreIcon:w,more:S,popupClassName:Z,children:x,items:R,animated:W,style:M,indicatorSize:N,indicator:X}=t,E=_$(t,["type","className","rootClassName","size","onEdit","hideAdd","centered","addIcon","removeIcon","moreIcon","more","popupClassName","children","items","animated","style","indicatorSize","indicator"]),{prefixCls:Q}=E,{direction:k,tabs:J,getPrefixCls:F,getPopupContainer:L}=y.useContext(yn),z=F("tabs",Q),K=Lg(z),[O,j,P]=L$(z,K);let $;d==="editable-card"&&($={onEdit:(T,Ge)=>{let{key:ne,event:he}=Ge;p==null||p(T==="add"?he:ne,T)},removeIcon:(e=G??(J==null?void 0:J.removeIcon))!==null&&e!==void 0?e:y.createElement(Oh,null),addIcon:(b??(J==null?void 0:J.addIcon))||y.createElement(PY,null),showAdd:m!==!0});const oe=F(),ie=Zs(v),de=V$(R,x),Ve=x$(z,W),Se=Object.assign(Object.assign({},J==null?void 0:J.style),M),me={align:(n=X==null?void 0:X.align)!==null&&n!==void 0?n:(i=J==null?void 0:J.indicator)===null||i===void 0?void 0:i.align,size:(s=(o=(r=X==null?void 0:X.size)!==null&&r!==void 0?r:N)!==null&&o!==void 0?o:(a=J==null?void 0:J.indicator)===null||a===void 0?void 0:a.size)!==null&&s!==void 0?s:J==null?void 0:J.indicatorSize};return O(y.createElement(w$,Object.assign({direction:k,getPopupContainer:L},E,{items:de,className:qe({[`${z}-${ie}`]:ie,[`${z}-card`]:["card","editable-card"].includes(d),[`${z}-editable-card`]:d==="editable-card",[`${z}-centered`]:A},J==null?void 0:J.className,C,f,j,P,K),popupClassName:qe(Z,j,P,K),style:Se,editable:$,more:Object.assign({icon:(u=(g=(c=(l=J==null?void 0:J.more)===null||l===void 0?void 0:l.icon)!==null&&c!==void 0?c:J==null?void 0:J.moreIcon)!==null&&g!==void 0?g:w)!==null&&u!==void 0?u:y.createElement(k6,null),transitionName:`${oe}-slide-up`},S),prefixCls:z,animated:Ve,indicator:me})))};jY.TabPane=T$;var k$=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const $Y=t=>{var{prefixCls:e,className:n,hoverable:i=!0}=t,r=k$(t,["prefixCls","className","hoverable"]);const{getPrefixCls:o}=y.useContext(yn),a=o("card",e),s=qe(`${a}-grid`,n,{[`${a}-grid-hoverable`]:i});return y.createElement("div",Object.assign({},r,{className:s}))},P$=t=>{const{antCls:e,componentCls:n,headerHeight:i,cardPaddingBase:r,tabsMarginBottom:o}=t;return Object.assign(Object.assign({display:"flex",justifyContent:"center",flexDirection:"column",minHeight:i,marginBottom:-1,padding:`0 ${Je(r)}`,color:t.colorTextHeading,fontWeight:t.fontWeightStrong,fontSize:t.headerFontSize,background:t.headerBg,borderBottom:`${Je(t.lineWidth)} ${t.lineType} ${t.colorBorderSecondary}`,borderRadius:`${Je(t.borderRadiusLG)} ${Je(t.borderRadiusLG)} 0 0`},jd()),{"&-wrapper":{width:"100%",display:"flex",alignItems:"center"},"&-title":Object.assign(Object.assign({display:"inline-block",flex:1},Xd),{[`
          > ${n}-typography,
          > ${n}-typography-edit-content
        `]:{insetInlineStart:0,marginTop:0,marginBottom:0}}),[`${e}-tabs-top`]:{clear:"both",marginBottom:o,color:t.colorText,fontWeight:"normal",fontSize:t.fontSize,"&-bar":{borderBottom:`${Je(t.lineWidth)} ${t.lineType} ${t.colorBorderSecondary}`}}})},U$=t=>{const{cardPaddingBase:e,colorBorderSecondary:n,cardShadow:i,lineWidth:r}=t;return{width:"33.33%",padding:e,border:0,borderRadius:0,boxShadow:`
      ${Je(r)} 0 0 0 ${n},
      0 ${Je(r)} 0 0 ${n},
      ${Je(r)} ${Je(r)} 0 0 ${n},
      ${Je(r)} 0 0 0 ${n} inset,
      0 ${Je(r)} 0 0 ${n} inset;
    `,transition:`all ${t.motionDurationMid}`,"&-hoverable:hover":{position:"relative",zIndex:1,boxShadow:i}}},D$=t=>{const{componentCls:e,iconCls:n,actionsLiMargin:i,cardActionsIconSize:r,colorBorderSecondary:o,actionsBg:a}=t;return Object.assign(Object.assign({margin:0,padding:0,listStyle:"none",background:a,borderTop:`${Je(t.lineWidth)} ${t.lineType} ${o}`,display:"flex",borderRadius:`0 0 ${Je(t.borderRadiusLG)} ${Je(t.borderRadiusLG)}`},jd()),{"& > li":{margin:i,color:t.colorTextDescription,textAlign:"center","> span":{position:"relative",display:"block",minWidth:t.calc(t.cardActionsIconSize).mul(2).equal(),fontSize:t.fontSize,lineHeight:t.lineHeight,cursor:"pointer","&:hover":{color:t.colorPrimary,transition:`color ${t.motionDurationMid}`},[`a:not(${e}-btn), > ${n}`]:{display:"inline-block",width:"100%",color:t.colorTextDescription,lineHeight:Je(t.fontHeight),transition:`color ${t.motionDurationMid}`,"&:hover":{color:t.colorPrimary}},[`> ${n}`]:{fontSize:r,lineHeight:Je(t.calc(r).mul(t.lineHeight).equal())}},"&:not(:last-child)":{borderInlineEnd:`${Je(t.lineWidth)} ${t.lineType} ${o}`}}})},O$=t=>Object.assign(Object.assign({margin:`${Je(t.calc(t.marginXXS).mul(-1).equal())} 0`,display:"flex"},jd()),{"&-avatar":{paddingInlineEnd:t.padding},"&-detail":{overflow:"hidden",flex:1,"> div:not(:last-child)":{marginBottom:t.marginXS}},"&-title":Object.assign({color:t.colorTextHeading,fontWeight:t.fontWeightStrong,fontSize:t.fontSizeLG},Xd),"&-description":{color:t.colorTextDescription}}),J$=t=>{const{componentCls:e,cardPaddingBase:n,colorFillAlter:i}=t;return{[`${e}-head`]:{padding:`0 ${Je(n)}`,background:i,"&-title":{fontSize:t.fontSize}},[`${e}-body`]:{padding:`${Je(t.padding)} ${Je(n)}`}}},Q$=t=>{const{componentCls:e}=t;return{overflow:"hidden",[`${e}-body`]:{userSelect:"none"}}},j$=t=>{const{componentCls:e,cardShadow:n,cardHeadPadding:i,colorBorderSecondary:r,boxShadowTertiary:o,cardPaddingBase:a,extraColor:s}=t;return{[e]:Object.assign(Object.assign({},ba(t)),{position:"relative",background:t.colorBgContainer,borderRadius:t.borderRadiusLG,[`&:not(${e}-bordered)`]:{boxShadow:o},[`${e}-head`]:P$(t),[`${e}-extra`]:{marginInlineStart:"auto",color:s,fontWeight:"normal",fontSize:t.fontSize},[`${e}-body`]:Object.assign({padding:a,borderRadius:`0 0 ${Je(t.borderRadiusLG)} ${Je(t.borderRadiusLG)}`},jd()),[`${e}-grid`]:U$(t),[`${e}-cover`]:{"> *":{display:"block",width:"100%",borderRadius:`${Je(t.borderRadiusLG)} ${Je(t.borderRadiusLG)} 0 0`}},[`${e}-actions`]:D$(t),[`${e}-meta`]:O$(t)}),[`${e}-bordered`]:{border:`${Je(t.lineWidth)} ${t.lineType} ${r}`,[`${e}-cover`]:{marginTop:-1,marginInlineStart:-1,marginInlineEnd:-1}},[`${e}-hoverable`]:{cursor:"pointer",transition:`box-shadow ${t.motionDurationMid}, border-color ${t.motionDurationMid}`,"&:hover":{borderColor:"transparent",boxShadow:n}},[`${e}-contain-grid`]:{borderRadius:`${Je(t.borderRadiusLG)} ${Je(t.borderRadiusLG)} 0 0 `,[`${e}-body`]:{display:"flex",flexWrap:"wrap"},[`&:not(${e}-loading) ${e}-body`]:{marginBlockStart:t.calc(t.lineWidth).mul(-1).equal(),marginInlineStart:t.calc(t.lineWidth).mul(-1).equal(),padding:0}},[`${e}-contain-tabs`]:{[`> div${e}-head`]:{minHeight:0,[`${e}-head-title, ${e}-extra`]:{paddingTop:i}}},[`${e}-type-inner`]:J$(t),[`${e}-loading`]:Q$(t),[`${e}-rtl`]:{direction:"rtl"}}},$$=t=>{const{componentCls:e,cardPaddingSM:n,headerHeightSM:i,headerFontSizeSM:r}=t;return{[`${e}-small`]:{[`> ${e}-head`]:{minHeight:i,padding:`0 ${Je(n)}`,fontSize:r,[`> ${e}-head-wrapper`]:{[`> ${e}-extra`]:{fontSize:t.fontSize}}},[`> ${e}-body`]:{padding:n}},[`${e}-small${e}-contain-tabs`]:{[`> ${e}-head`]:{[`${e}-head-title, ${e}-extra`]:{paddingTop:0,display:"flex",alignItems:"center"}}}}},q$=t=>({headerBg:"transparent",headerFontSize:t.fontSizeLG,headerFontSizeSM:t.fontSize,headerHeight:t.fontSizeLG*t.lineHeightLG+t.padding*2,headerHeightSM:t.fontSize*t.lineHeight+t.paddingXS*2,actionsBg:t.colorBgContainer,actionsLiMargin:`${t.paddingSM}px 0`,tabsMarginBottom:-t.padding-t.lineWidth,extraColor:t.colorText}),eq=yo("Card",t=>{const e=ci(t,{cardShadow:t.boxShadowCard,cardHeadPadding:t.padding,cardPaddingBase:t.paddingLG,cardActionsIconSize:t.fontSize,cardPaddingSM:12});return[j$(e),$$(e)]},q$);var TM=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const tq=t=>{const{actionClasses:e,actions:n=[],actionStyle:i}=t;return y.createElement("ul",{className:e,style:i},n.map((r,o)=>{const a=`action-${o}`;return y.createElement("li",{style:{width:`${100/n.length}%`},key:a},y.createElement("span",null,r))}))},nq=y.forwardRef((t,e)=>{const{prefixCls:n,className:i,rootClassName:r,style:o,extra:a,headStyle:s={},bodyStyle:l={},title:c,loading:g,bordered:u=!0,size:d,type:C,cover:f,actions:v,tabList:p,children:m,activeTabKey:A,defaultActiveTabKey:b,tabBarExtraContent:G,hoverable:w,tabProps:S={},classNames:Z,styles:x}=t,R=TM(t,["prefixCls","className","rootClassName","style","extra","headStyle","bodyStyle","title","loading","bordered","size","type","cover","actions","tabList","children","activeTabKey","defaultActiveTabKey","tabBarExtraContent","hoverable","tabProps","classNames","styles"]),{getPrefixCls:W,direction:M,card:N}=y.useContext(yn),X=ve=>{var Me;(Me=t.onTabChange)===null||Me===void 0||Me.call(t,ve)},E=ve=>{var Me;return qe((Me=N==null?void 0:N.classNames)===null||Me===void 0?void 0:Me[ve],Z==null?void 0:Z[ve])},Q=ve=>{var Me;return Object.assign(Object.assign({},(Me=N==null?void 0:N.styles)===null||Me===void 0?void 0:Me[ve]),x==null?void 0:x[ve])},k=y.useMemo(()=>{let ve=!1;return y.Children.forEach(m,Me=>{(Me==null?void 0:Me.type)===$Y&&(ve=!0)}),ve},[m]),J=W("card",n),[F,L,z]=eq(J),K=y.createElement(_g,{loading:!0,active:!0,paragraph:{rows:4},title:!1},m),O=A!==void 0,j=Object.assign(Object.assign({},S),{[O?"activeKey":"defaultActiveKey"]:O?A:b,tabBarExtraContent:G});let P;const $=Zs(d),oe=!$||$==="default"?"large":$,ie=p?y.createElement(jY,Object.assign({size:oe},j,{className:`${J}-head-tabs`,onChange:X,items:p.map(ve=>{var{tab:Me}=ve,q=TM(ve,["tab"]);return Object.assign({label:Me},q)})})):null;if(c||a||ie){const ve=qe(`${J}-head`,E("header")),Me=qe(`${J}-head-title`,E("title")),q=qe(`${J}-extra`,E("extra")),Y=Object.assign(Object.assign({},s),Q("header"));P=y.createElement("div",{className:ve,style:Y},y.createElement("div",{className:`${J}-head-wrapper`},c&&y.createElement("div",{className:Me,style:Q("title")},c),a&&y.createElement("div",{className:q,style:Q("extra")},a)),ie)}const de=qe(`${J}-cover`,E("cover")),Ve=f?y.createElement("div",{className:de,style:Q("cover")},f):null,Se=qe(`${J}-body`,E("body")),me=Object.assign(Object.assign({},l),Q("body")),T=y.createElement("div",{className:Se,style:me},g?K:m),Ge=qe(`${J}-actions`,E("actions")),ne=v!=null&&v.length?y.createElement(tq,{actionClasses:Ge,actionStyle:Q("actions"),actions:v}):null,he=$a(R,["onTabChange"]),ae=qe(J,N==null?void 0:N.className,{[`${J}-loading`]:g,[`${J}-bordered`]:u,[`${J}-hoverable`]:w,[`${J}-contain-grid`]:k,[`${J}-contain-tabs`]:p==null?void 0:p.length,[`${J}-${$}`]:$,[`${J}-type-${C}`]:!!C,[`${J}-rtl`]:M==="rtl"},i,r,L,z),He=Object.assign(Object.assign({},N==null?void 0:N.style),o);return F(y.createElement("div",Object.assign({ref:e},he,{className:ae,style:He}),P,Ve,T,ne))});var iq=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const rq=t=>{const{prefixCls:e,className:n,avatar:i,title:r,description:o}=t,a=iq(t,["prefixCls","className","avatar","title","description"]),{getPrefixCls:s}=y.useContext(yn),l=s("card",e),c=qe(`${l}-meta`,n),g=i?y.createElement("div",{className:`${l}-meta-avatar`},i):null,u=r?y.createElement("div",{className:`${l}-meta-title`},r):null,d=o?y.createElement("div",{className:`${l}-meta-description`},o):null,C=u||d?y.createElement("div",{className:`${l}-meta-detail`},u,d):null;return y.createElement("div",Object.assign({},a,{className:c}),g,C)},EZ=nq;EZ.Grid=$Y;EZ.Meta=rq;function oq(t,e,n){var i=n||{},r=i.noTrailing,o=r===void 0?!1:r,a=i.noLeading,s=a===void 0?!1:a,l=i.debounceMode,c=l===void 0?void 0:l,g,u=!1,d=0;function C(){g&&clearTimeout(g)}function f(p){var m=p||{},A=m.upcomingOnly,b=A===void 0?!1:A;C(),u=!b}function v(){for(var p=arguments.length,m=new Array(p),A=0;A<p;A++)m[A]=arguments[A];var b=this,G=Date.now()-d;if(u)return;function w(){d=Date.now(),e.apply(b,m)}function S(){g=void 0}!s&&c&&!g&&w(),C(),c===void 0&&G>t?s?(d=Date.now(),o||(g=setTimeout(c?S:w,t))):w():o!==!0&&(g=setTimeout(c?S:w,c===void 0?t-G:t))}return v.cancel=f,v}function aq(t,e,n){var i={},r=i.atBegin,o=r===void 0?!1:r;return oq(t,e,{debounceMode:o!==!1})}const qY=y.createContext({}),sq=t=>{const{componentCls:e}=t;return{[e]:{display:"flex",flexFlow:"row wrap",minWidth:0,"&::before, &::after":{display:"flex"},"&-no-wrap":{flexWrap:"nowrap"},"&-start":{justifyContent:"flex-start"},"&-center":{justifyContent:"center"},"&-end":{justifyContent:"flex-end"},"&-space-between":{justifyContent:"space-between"},"&-space-around":{justifyContent:"space-around"},"&-space-evenly":{justifyContent:"space-evenly"},"&-top":{alignItems:"flex-start"},"&-middle":{alignItems:"center"},"&-bottom":{alignItems:"flex-end"}}}},lq=t=>{const{componentCls:e}=t;return{[e]:{position:"relative",maxWidth:"100%",minHeight:1}}},cq=(t,e)=>{const{prefixCls:n,componentCls:i,gridColumns:r}=t,o={};for(let a=r;a>=0;a--)a===0?(o[`${i}${e}-${a}`]={display:"none"},o[`${i}-push-${a}`]={insetInlineStart:"auto"},o[`${i}-pull-${a}`]={insetInlineEnd:"auto"},o[`${i}${e}-push-${a}`]={insetInlineStart:"auto"},o[`${i}${e}-pull-${a}`]={insetInlineEnd:"auto"},o[`${i}${e}-offset-${a}`]={marginInlineStart:0},o[`${i}${e}-order-${a}`]={order:0}):(o[`${i}${e}-${a}`]=[{"--ant-display":"block",display:"block"},{display:"var(--ant-display)",flex:`0 0 ${a/r*100}%`,maxWidth:`${a/r*100}%`}],o[`${i}${e}-push-${a}`]={insetInlineStart:`${a/r*100}%`},o[`${i}${e}-pull-${a}`]={insetInlineEnd:`${a/r*100}%`},o[`${i}${e}-offset-${a}`]={marginInlineStart:`${a/r*100}%`},o[`${i}${e}-order-${a}`]={order:a});return o[`${i}${e}-flex`]={flex:`var(--${n}${e}-flex)`},o},AS=(t,e)=>cq(t,e),gq=(t,e,n)=>({[`@media (min-width: ${Je(e)})`]:Object.assign({},AS(t,n))}),uq=()=>({}),dq=()=>({}),Iq=yo("Grid",sq,uq),Cq=yo("Grid",t=>{const e=ci(t,{gridColumns:24}),n={"-sm":e.screenSMMin,"-md":e.screenMDMin,"-lg":e.screenLGMin,"-xl":e.screenXLMin,"-xxl":e.screenXXLMin};return[lq(e),AS(e,""),AS(e,"-xs"),Object.keys(n).map(i=>gq(e,n[i],i)).reduce((i,r)=>Object.assign(Object.assign({},i),r),{})]},dq);var hq=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function _M(t){return typeof t=="number"?`${t} ${t} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(t)?`0 0 ${t}`:t}const fq=["xs","sm","md","lg","xl","xxl"],mq=y.forwardRef((t,e)=>{const{getPrefixCls:n,direction:i}=y.useContext(yn),{gutter:r,wrap:o}=y.useContext(qY),{prefixCls:a,span:s,order:l,offset:c,push:g,pull:u,className:d,children:C,flex:f,style:v}=t,p=hq(t,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),m=n("col",a),[A,b,G]=Cq(m),w={};let S={};fq.forEach(R=>{let W={};const M=t[R];typeof M=="number"?W.span=M:typeof M=="object"&&(W=M||{}),delete p[R],S=Object.assign(Object.assign({},S),{[`${m}-${R}-${W.span}`]:W.span!==void 0,[`${m}-${R}-order-${W.order}`]:W.order||W.order===0,[`${m}-${R}-offset-${W.offset}`]:W.offset||W.offset===0,[`${m}-${R}-push-${W.push}`]:W.push||W.push===0,[`${m}-${R}-pull-${W.pull}`]:W.pull||W.pull===0,[`${m}-rtl`]:i==="rtl"}),W.flex&&(S[`${m}-${R}-flex`]=!0,w[`--${m}-${R}-flex`]=_M(W.flex))});const Z=qe(m,{[`${m}-${s}`]:s!==void 0,[`${m}-order-${l}`]:l,[`${m}-offset-${c}`]:c,[`${m}-push-${g}`]:g,[`${m}-pull-${u}`]:u},d,S,b,G),x={};if(r&&r[0]>0){const R=r[0]/2;x.paddingLeft=R,x.paddingRight=R}return f&&(x.flex=_M(f),o===!1&&!x.minWidth&&(x.minWidth=0)),A(y.createElement("div",Object.assign({},p,{style:Object.assign(Object.assign(Object.assign({},x),v),w),className:Z,ref:e}),C))});var Aq=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function kM(t,e){const[n,i]=y.useState(typeof t=="string"?t:""),r=()=>{if(typeof t=="string"&&i(t),typeof t=="object")for(let o=0;o<Vg.length;o++){const a=Vg[o];if(!e[a])continue;const s=t[a];if(s!==void 0){i(s);return}}};return y.useEffect(()=>{r()},[JSON.stringify(t),e]),n}const pq=y.forwardRef((t,e)=>{const{prefixCls:n,justify:i,align:r,className:o,style:a,children:s,gutter:l=0,wrap:c}=t,g=Aq(t,["prefixCls","justify","align","className","style","children","gutter","wrap"]),{getPrefixCls:u,direction:d}=y.useContext(yn),[C,f]=y.useState({xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0}),[v,p]=y.useState({xs:!1,sm:!1,md:!1,lg:!1,xl:!1,xxl:!1}),m=kM(r,v),A=kM(i,v),b=y.useRef(l),G=xY();y.useEffect(()=>{const J=G.subscribe(F=>{p(F);const L=b.current||0;(!Array.isArray(L)&&typeof L=="object"||Array.isArray(L)&&(typeof L[0]=="object"||typeof L[1]=="object"))&&f(F)});return()=>G.unsubscribe(J)},[]);const w=()=>{const J=[void 0,void 0];return(Array.isArray(l)?l:[l,void 0]).forEach((L,z)=>{if(typeof L=="object")for(let K=0;K<Vg.length;K++){const O=Vg[K];if(C[O]&&L[O]!==void 0){J[z]=L[O];break}}else J[z]=L}),J},S=u("row",n),[Z,x,R]=Iq(S),W=w(),M=qe(S,{[`${S}-no-wrap`]:c===!1,[`${S}-${A}`]:A,[`${S}-${m}`]:m,[`${S}-rtl`]:d==="rtl"},o,x,R),N={},X=W[0]!=null&&W[0]>0?W[0]/-2:void 0;X&&(N.marginLeft=X,N.marginRight=X);const[E,Q]=W;N.rowGap=Q;const k=y.useMemo(()=>({gutter:[E,Q],wrap:c}),[E,Q,c]);return Z(y.createElement(qY.Provider,{value:k},y.createElement("div",Object.assign({},g,{className:M,style:Object.assign(Object.assign({},N),a),ref:e}),s)))});function vq(t){return!!(t.addonBefore||t.addonAfter)}function bq(t){return!!(t.prefix||t.suffix||t.allowClear)}function PM(t,e,n){var i=e.cloneNode(!0),r=Object.create(t,{target:{value:i},currentTarget:{value:i}});return i.value=n,typeof e.selectionStart=="number"&&typeof e.selectionEnd=="number"&&(i.selectionStart=e.selectionStart,i.selectionEnd=e.selectionEnd),i.setSelectionRange=function(){e.setSelectionRange.apply(e,arguments)},r}function n0(t,e,n,i){if(n){var r=e;if(e.type==="click"){r=PM(e,t,""),n(r);return}if(t.type!=="file"&&i!==void 0){r=PM(e,t,i),n(r);return}n(r)}}function yq(t,e){if(t){t.focus(e);var n=e||{},i=n.cursor;if(i){var r=t.value.length;switch(i){case"start":t.setSelectionRange(0,0);break;case"end":t.setSelectionRange(r,r);break;default:t.setSelectionRange(0,r)}}}}var ez=ze.forwardRef(function(t,e){var n,i,r=t.inputElement,o=t.children,a=t.prefixCls,s=t.prefix,l=t.suffix,c=t.addonBefore,g=t.addonAfter,u=t.className,d=t.style,C=t.disabled,f=t.readOnly,v=t.focused,p=t.triggerFocus,m=t.allowClear,A=t.value,b=t.handleReset,G=t.hidden,w=t.classes,S=t.classNames,Z=t.dataAttrs,x=t.styles,R=t.components,W=t.onClear,M=o??r,N=(R==null?void 0:R.affixWrapper)||"span",X=(R==null?void 0:R.groupWrapper)||"span",E=(R==null?void 0:R.wrapper)||"span",Q=(R==null?void 0:R.groupAddon)||"span",k=y.useRef(null),J=function(ne){var he;(he=k.current)!==null&&he!==void 0&&he.contains(ne.target)&&(p==null||p())},F=bq(t),L=y.cloneElement(M,{value:A,className:qe(M.props.className,!F&&(S==null?void 0:S.variant))||null}),z=y.useRef(null);if(ze.useImperativeHandle(e,function(){return{nativeElement:z.current||k.current}}),F){var K=null;if(m){var O=!C&&!f&&A,j="".concat(a,"-clear-icon"),P=qt(m)==="object"&&m!==null&&m!==void 0&&m.clearIcon?m.clearIcon:"";K=ze.createElement("span",{onClick:function(ne){b==null||b(ne),W==null||W()},onMouseDown:function(ne){return ne.preventDefault()},className:qe(j,we(we({},"".concat(j,"-hidden"),!O),"".concat(j,"-has-suffix"),!!l)),role:"button",tabIndex:-1},P)}var $="".concat(a,"-affix-wrapper"),oe=qe($,we(we(we(we(we({},"".concat(a,"-disabled"),C),"".concat($,"-disabled"),C),"".concat($,"-focused"),v),"".concat($,"-readonly"),f),"".concat($,"-input-with-clear-btn"),l&&m&&A),w==null?void 0:w.affixWrapper,S==null?void 0:S.affixWrapper,S==null?void 0:S.variant),ie=(l||m)&&ze.createElement("span",{className:qe("".concat(a,"-suffix"),S==null?void 0:S.suffix),style:x==null?void 0:x.suffix},K,l);L=ze.createElement(N,Zt({className:oe,style:x==null?void 0:x.affixWrapper,onClick:J},Z==null?void 0:Z.affixWrapper,{ref:k}),s&&ze.createElement("span",{className:qe("".concat(a,"-prefix"),S==null?void 0:S.prefix),style:x==null?void 0:x.prefix},s),L,ie)}if(vq(t)){var de="".concat(a,"-group"),Ve="".concat(de,"-addon"),Se="".concat(de,"-wrapper"),me=qe("".concat(a,"-wrapper"),de,w==null?void 0:w.wrapper,S==null?void 0:S.wrapper),T=qe(Se,we({},"".concat(Se,"-disabled"),C),w==null?void 0:w.group,S==null?void 0:S.groupWrapper);L=ze.createElement(X,{className:T,ref:z},ze.createElement(E,{className:me},c&&ze.createElement(Q,{className:Ve},c),L,g&&ze.createElement(Q,{className:Ve},g)))}return ze.cloneElement(L,{className:qe((n=L.props)===null||n===void 0?void 0:n.className,u)||null,style:Re(Re({},(i=L.props)===null||i===void 0?void 0:i.style),d),hidden:G})}),Gq=["show"];function tz(t,e){return y.useMemo(function(){var n={};e&&(n.show=qt(e)==="object"&&e.formatter?e.formatter:!!e),n=Re(Re({},n),t);var i=n,r=i.show,o=An(i,Gq);return Re(Re({},o),{},{show:!!r,showFormatter:typeof r=="function"?r:void 0,strategy:o.strategy||function(a){return a.length}})},[t,e])}var Bq=["autoComplete","onChange","onFocus","onBlur","onPressEnter","onKeyDown","onKeyUp","prefixCls","disabled","htmlSize","className","maxLength","suffix","showCount","count","type","classes","classNames","styles","onCompositionStart","onCompositionEnd"],Sq=y.forwardRef(function(t,e){var n=t.autoComplete,i=t.onChange,r=t.onFocus,o=t.onBlur,a=t.onPressEnter,s=t.onKeyDown,l=t.onKeyUp,c=t.prefixCls,g=c===void 0?"rc-input":c,u=t.disabled,d=t.htmlSize,C=t.className,f=t.maxLength,v=t.suffix,p=t.showCount,m=t.count,A=t.type,b=A===void 0?"text":A,G=t.classes,w=t.classNames,S=t.styles,Z=t.onCompositionStart,x=t.onCompositionEnd,R=An(t,Bq),W=y.useState(!1),M=De(W,2),N=M[0],X=M[1],E=y.useRef(!1),Q=y.useRef(!1),k=y.useRef(null),J=y.useRef(null),F=function(fe){k.current&&yq(k.current,fe)},L=$r(t.defaultValue,{value:t.value}),z=De(L,2),K=z[0],O=z[1],j=K==null?"":String(K),P=y.useState(null),$=De(P,2),oe=$[0],ie=$[1],de=tz(m,p),Ve=de.max||f,Se=de.strategy(j),me=!!Ve&&Se>Ve;y.useImperativeHandle(e,function(){var se;return{focus:F,blur:function(){var Ze;(Ze=k.current)===null||Ze===void 0||Ze.blur()},setSelectionRange:function(Ze,Oe,Fe){var Ee;(Ee=k.current)===null||Ee===void 0||Ee.setSelectionRange(Ze,Oe,Fe)},select:function(){var Ze;(Ze=k.current)===null||Ze===void 0||Ze.select()},input:k.current,nativeElement:((se=J.current)===null||se===void 0?void 0:se.nativeElement)||k.current}}),y.useEffect(function(){X(function(se){return se&&u?!1:se})},[u]);var T=function(fe,Ze,Oe){var Fe=Ze;if(!E.current&&de.exceedFormatter&&de.max&&de.strategy(Ze)>de.max){if(Fe=de.exceedFormatter(Ze,{max:de.max}),Ze!==Fe){var Ee,Qe;ie([((Ee=k.current)===null||Ee===void 0?void 0:Ee.selectionStart)||0,((Qe=k.current)===null||Qe===void 0?void 0:Qe.selectionEnd)||0])}}else if(Oe.source==="compositionEnd")return;O(Fe),k.current&&n0(k.current,fe,i,Fe)};y.useEffect(function(){if(oe){var se;(se=k.current)===null||se===void 0||se.setSelectionRange.apply(se,Et(oe))}},[oe]);var Ge=function(fe){T(fe,fe.target.value,{source:"change"})},ne=function(fe){E.current=!1,T(fe,fe.currentTarget.value,{source:"compositionEnd"}),x==null||x(fe)},he=function(fe){a&&fe.key==="Enter"&&!Q.current&&(Q.current=!0,a(fe)),s==null||s(fe)},ae=function(fe){fe.key==="Enter"&&(Q.current=!1),l==null||l(fe)},He=function(fe){X(!0),r==null||r(fe)},ve=function(fe){X(!1),o==null||o(fe)},Me=function(fe){O(""),F(),k.current&&n0(k.current,fe,i)},q=me&&"".concat(g,"-out-of-range"),Y=function(){var fe=$a(t,["prefixCls","onPressEnter","addonBefore","addonAfter","prefix","suffix","allowClear","defaultValue","showCount","count","classes","htmlSize","styles","classNames","onClear"]);return ze.createElement("input",Zt({autoComplete:n},fe,{onChange:Ge,onFocus:He,onBlur:ve,onKeyDown:he,onKeyUp:ae,className:qe(g,we({},"".concat(g,"-disabled"),u),w==null?void 0:w.input),style:S==null?void 0:S.input,ref:k,size:d,type:b,onCompositionStart:function(Oe){E.current=!0,Z==null||Z(Oe)},onCompositionEnd:ne}))},Ce=function(){var fe=Number(Ve)>0;if(v||de.show){var Ze=de.showFormatter?de.showFormatter({value:j,count:Se,maxLength:Ve}):"".concat(Se).concat(fe?" / ".concat(Ve):"");return ze.createElement(ze.Fragment,null,de.show&&ze.createElement("span",{className:qe("".concat(g,"-show-count-suffix"),we({},"".concat(g,"-show-count-has-suffix"),!!v),w==null?void 0:w.count),style:Re({},S==null?void 0:S.count)},Ze),v)}return null};return ze.createElement(ez,Zt({},R,{prefixCls:g,className:qe(C,q),handleReset:Me,value:j,focused:N,triggerFocus:F,suffix:Ce(),disabled:u,classes:G,classNames:w,styles:S}),Y())});const wq=t=>{const{getPrefixCls:e,direction:n}=y.useContext(yn),{prefixCls:i,className:r}=t,o=e("input-group",i),a=e("input"),[s,l]=XZ(a),c=qe(o,{[`${o}-lg`]:t.size==="large",[`${o}-sm`]:t.size==="small",[`${o}-compact`]:t.compact,[`${o}-rtl`]:n==="rtl"},l,r),g=y.useContext(cl),u=y.useMemo(()=>Object.assign(Object.assign({},g),{isFormItemInput:!1}),[g]);return s(y.createElement("span",{className:c,style:t.style,onMouseEnter:t.onMouseEnter,onMouseLeave:t.onMouseLeave,onFocus:t.onFocus,onBlur:t.onBlur},y.createElement(cl.Provider,{value:u},t.children)))},nz=t=>{let e;return typeof t=="object"&&(t!=null&&t.clearIcon)?e=t:t&&(e={clearIcon:ze.createElement(oZ,null)}),e};function iz(t,e){const n=y.useRef([]),i=()=>{n.current.push(setTimeout(()=>{var r,o,a,s;!((r=t.current)===null||r===void 0)&&r.input&&((o=t.current)===null||o===void 0?void 0:o.input.getAttribute("type"))==="password"&&(!((a=t.current)===null||a===void 0)&&a.input.hasAttribute("value"))&&((s=t.current)===null||s===void 0||s.input.removeAttribute("value"))}))};return y.useEffect(()=>(e&&i(),()=>n.current.forEach(r=>{r&&clearTimeout(r)})),[]),i}function Zq(t){return!!(t.prefix||t.suffix||t.allowClear||t.showCount)}var xq=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function Rq(t,e){if(!t)return;t.focus(e);const{cursor:n}=e||{};if(n){const i=t.value.length;switch(n){case"start":t.setSelectionRange(0,0);break;case"end":t.setSelectionRange(i,i);break;default:t.setSelectionRange(0,i)}}}const xv=y.forwardRef((t,e)=>{var n;const{prefixCls:i,bordered:r=!0,status:o,size:a,disabled:s,onBlur:l,onFocus:c,suffix:g,allowClear:u,addonAfter:d,addonBefore:C,className:f,style:v,styles:p,rootClassName:m,onChange:A,classNames:b,variant:G}=t,w=xq(t,["prefixCls","bordered","status","size","disabled","onBlur","onFocus","suffix","allowClear","addonAfter","addonBefore","className","style","styles","rootClassName","onChange","classNames","variant"]),{getPrefixCls:S,direction:Z,input:x}=ze.useContext(yn),R=S("input",i),W=y.useRef(null),M=Lg(R),[N,X,E]=XZ(R,M),{compactSize:Q,compactItemClassnames:k}=fv(R,Z),J=Zs(Ge=>{var ne;return(ne=a??Q)!==null&&ne!==void 0?ne:Ge}),F=ze.useContext(lc),L=s??F,{status:z,hasFeedback:K,feedbackIcon:O}=y.useContext(cl),j=Gv(z,o),P=Zq(t)||!!K;y.useRef(P);const $=iz(W,!0),oe=Ge=>{$(),l==null||l(Ge)},ie=Ge=>{$(),c==null||c(Ge)},de=Ge=>{$(),A==null||A(Ge)},Ve=(K||g)&&ze.createElement(ze.Fragment,null,g,K&&O),Se=nz(u??(x==null?void 0:x.allowClear)),[me,T]=BZ("input",G,r);return N(ze.createElement(Sq,Object.assign({ref:ja(e,W),prefixCls:R,autoComplete:x==null?void 0:x.autoComplete},w,{disabled:L,onBlur:oe,onFocus:ie,style:Object.assign(Object.assign({},x==null?void 0:x.style),v),styles:Object.assign(Object.assign({},x==null?void 0:x.styles),p),suffix:Ve,allowClear:Se,className:qe(f,m,E,M,k,x==null?void 0:x.className),onChange:de,addonBefore:C&&ze.createElement(aS,{form:!0,space:!0},C),addonAfter:d&&ze.createElement(aS,{form:!0,space:!0},d),classNames:Object.assign(Object.assign(Object.assign({},b),x==null?void 0:x.classNames),{input:qe({[`${R}-sm`]:J==="small",[`${R}-lg`]:J==="large",[`${R}-rtl`]:Z==="rtl"},b==null?void 0:b.input,(n=x==null?void 0:x.classNames)===null||n===void 0?void 0:n.input,X),variant:qe({[`${R}-${me}`]:T},e0(R,j)),affixWrapper:qe({[`${R}-affix-wrapper-sm`]:J==="small",[`${R}-affix-wrapper-lg`]:J==="large",[`${R}-affix-wrapper-rtl`]:Z==="rtl"},X),wrapper:qe({[`${R}-group-rtl`]:Z==="rtl"},X),groupWrapper:qe({[`${R}-group-wrapper-sm`]:J==="small",[`${R}-group-wrapper-lg`]:J==="large",[`${R}-group-wrapper-rtl`]:Z==="rtl",[`${R}-group-wrapper-${me}`]:T},e0(`${R}-group-wrapper`,j,K),X)})})))}),Wq=t=>{const{componentCls:e,paddingXS:n}=t;return{[e]:{display:"inline-flex",alignItems:"center",flexWrap:"nowrap",columnGap:n,"&-rtl":{direction:"rtl"},[`${e}-input`]:{textAlign:"center",paddingInline:t.paddingXXS},[`&${e}-sm ${e}-input`]:{paddingInline:t.calc(t.paddingXXS).div(2).equal()},[`&${e}-lg ${e}-input`]:{paddingInline:t.paddingXS}}}},Vq=yo(["Input","OTP"],t=>{const e=ci(t,VZ(t));return[Wq(e)]},MZ);var Mq=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const Nq=y.forwardRef((t,e)=>{const{value:n,onChange:i,onActiveChange:r,index:o,mask:a}=t,s=Mq(t,["value","onChange","onActiveChange","index","mask"]),l=n&&typeof a=="string"?a:n,c=f=>{i(o,f.target.value)},g=y.useRef(null);y.useImperativeHandle(e,()=>g.current);const u=()=>{Ln(()=>{var f;const v=(f=g.current)===null||f===void 0?void 0:f.input;document.activeElement===v&&v&&v.select()})},d=f=>{let{key:v}=f;v==="ArrowLeft"?r(o-1):v==="ArrowRight"&&r(o+1),u()},C=f=>{f.key==="Backspace"&&!n&&r(o-1),u()};return y.createElement(xv,Object.assign({type:a===!0?"password":"text"},s,{ref:g,value:l,onInput:c,onFocus:u,onKeyDown:d,onKeyUp:C,onMouseDown:u,onMouseUp:u}))});var Fq=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function Em(t){return(t||"").split("")}const Hq=y.forwardRef((t,e)=>{const{prefixCls:n,length:i=6,size:r,defaultValue:o,value:a,onChange:s,formatter:l,variant:c,disabled:g,status:u,autoFocus:d,mask:C,type:f}=t,v=Fq(t,["prefixCls","length","size","defaultValue","value","onChange","formatter","variant","disabled","status","autoFocus","mask","type"]),{getPrefixCls:p,direction:m}=y.useContext(yn),A=p("otp",n),b=ll(v,{aria:!0,data:!0,attr:!0}),G=Lg(A),[w,S,Z]=Vq(A,G),x=Zs(O=>r??O),R=y.useContext(cl),W=Gv(R.status,u),M=y.useMemo(()=>Object.assign(Object.assign({},R),{status:W,hasFeedback:!1,feedbackIcon:null}),[R,W]),N=y.useRef(null),X=y.useRef({});y.useImperativeHandle(e,()=>({focus:()=>{var O;(O=X.current[0])===null||O===void 0||O.focus()},blur:()=>{var O;for(let j=0;j<i;j+=1)(O=X.current[j])===null||O===void 0||O.blur()},nativeElement:N.current}));const E=O=>l?l(O):O,[Q,k]=y.useState(Em(E(o||"")));y.useEffect(()=>{a!==void 0&&k(Em(a))},[a]);const J=Xi(O=>{k(O),s&&O.length===i&&O.every(j=>j)&&O.some((j,P)=>Q[P]!==j)&&s(O.join(""))}),F=Xi((O,j)=>{let P=Et(Q);for(let oe=0;oe<O;oe+=1)P[oe]||(P[oe]="");j.length<=1?P[O]=j:P=P.slice(0,O).concat(Em(j)),P=P.slice(0,i);for(let oe=P.length-1;oe>=0&&!P[oe];oe-=1)P.pop();const $=E(P.map(oe=>oe||" ").join(""));return P=Em($).map((oe,ie)=>oe===" "&&!P[ie]?P[ie]:oe),P}),L=(O,j)=>{var P;const $=F(O,j),oe=Math.min(O+j.length,i-1);oe!==O&&((P=X.current[oe])===null||P===void 0||P.focus()),J($)},z=O=>{var j;(j=X.current[O])===null||j===void 0||j.focus()},K={variant:c,disabled:g,status:W,mask:C,type:f};return w(y.createElement("div",Object.assign({},b,{ref:N,className:qe(A,{[`${A}-sm`]:x==="small",[`${A}-lg`]:x==="large",[`${A}-rtl`]:m==="rtl"},Z,S)}),y.createElement(cl.Provider,{value:M},Array.from({length:i}).map((O,j)=>{const P=`otp-${j}`,$=Q[j]||"";return y.createElement(Nq,Object.assign({ref:oe=>{X.current[j]=oe},key:P,index:j,size:x,htmlSize:1,className:`${A}-input`,onChange:L,value:$,onActiveChange:z,autoFocus:j===0&&d},K))}))))});var Xq={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}},{tag:"path",attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}}]},name:"eye-invisible",theme:"outlined"},Eq=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:Xq}))},Yq=y.forwardRef(Eq),zq={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"},Kq=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:zq}))},Lq=y.forwardRef(Kq),Tq=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const _q=t=>t?y.createElement(Lq,null):y.createElement(Yq,null),kq={click:"onClick",hover:"onMouseOver"},Pq=y.forwardRef((t,e)=>{const{disabled:n,action:i="click",visibilityToggle:r=!0,iconRender:o=_q}=t,a=y.useContext(lc),s=n??a,l=typeof r=="object"&&r.visible!==void 0,[c,g]=y.useState(()=>l?r.visible:!1),u=y.useRef(null);y.useEffect(()=>{l&&g(r.visible)},[l,r]);const d=iz(u),C=()=>{s||(c&&d(),g(W=>{var M;const N=!W;return typeof r=="object"&&((M=r.onVisibleChange)===null||M===void 0||M.call(r,N)),N}))},f=W=>{const M=kq[i]||"",N=o(c),X={[M]:C,className:`${W}-icon`,key:"passwordIcon",onMouseDown:E=>{E.preventDefault()},onMouseUp:E=>{E.preventDefault()}};return y.cloneElement(y.isValidElement(N)?N:y.createElement("span",null,N),X)},{className:v,prefixCls:p,inputPrefixCls:m,size:A}=t,b=Tq(t,["className","prefixCls","inputPrefixCls","size"]),{getPrefixCls:G}=y.useContext(yn),w=G("input",m),S=G("input-password",p),Z=r&&f(S),x=qe(S,v,{[`${S}-${A}`]:!!A}),R=Object.assign(Object.assign({},$a(b,["suffix","iconRender","visibilityToggle"])),{type:c?"text":"password",className:x,prefixCls:w,suffix:Z});return A&&(R.size=A),y.createElement(xv,Object.assign({ref:ja(e,u)},R))});var Uq=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const Dq=y.forwardRef((t,e)=>{const{prefixCls:n,inputPrefixCls:i,className:r,size:o,suffix:a,enterButton:s=!1,addonAfter:l,loading:c,disabled:g,onSearch:u,onChange:d,onCompositionStart:C,onCompositionEnd:f}=t,v=Uq(t,["prefixCls","inputPrefixCls","className","size","suffix","enterButton","addonAfter","loading","disabled","onSearch","onChange","onCompositionStart","onCompositionEnd"]),{getPrefixCls:p,direction:m}=y.useContext(yn),A=y.useRef(!1),b=p("input-search",n),G=p("input",i),{compactSize:w}=fv(b,m),S=Zs(z=>{var K;return(K=o??w)!==null&&K!==void 0?K:z}),Z=y.useRef(null),x=z=>{z!=null&&z.target&&z.type==="click"&&u&&u(z.target.value,z,{source:"clear"}),d==null||d(z)},R=z=>{var K;document.activeElement===((K=Z.current)===null||K===void 0?void 0:K.input)&&z.preventDefault()},W=z=>{var K,O;u&&u((O=(K=Z.current)===null||K===void 0?void 0:K.input)===null||O===void 0?void 0:O.value,z,{source:"input"})},M=z=>{A.current||c||W(z)},N=typeof s=="boolean"?y.createElement(wY,null):null,X=`${b}-button`;let E;const Q=s||{},k=Q.type&&Q.type.__ANT_BUTTON===!0;k||Q.type==="button"?E=Ed(Q,Object.assign({onMouseDown:R,onClick:z=>{var K,O;(O=(K=Q==null?void 0:Q.props)===null||K===void 0?void 0:K.onClick)===null||O===void 0||O.call(K,z),W(z)},key:"enterButton"},k?{className:X,size:S}:{})):E=y.createElement(nr,{className:X,type:s?"primary":void 0,size:S,disabled:g,key:"enterButton",onMouseDown:R,onClick:W,loading:c,icon:N},s),l&&(E=[E,Ed(l,{key:"addonAfter"})]);const J=qe(b,{[`${b}-rtl`]:m==="rtl",[`${b}-${S}`]:!!S,[`${b}-with-button`]:!!s},r),F=z=>{A.current=!0,C==null||C(z)},L=z=>{A.current=!1,f==null||f(z)};return y.createElement(xv,Object.assign({ref:ja(Z,e),onPressEnter:M},v,{size:S,onCompositionStart:F,onCompositionEnd:L,prefixCls:G,addonAfter:E,suffix:a,onChange:x,className:J,disabled:g}))});var Oq=`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
  pointer-events: none !important;
`,Jq=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break","white-space"],sG={},No;function Qq(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=t.getAttribute("id")||t.getAttribute("data-reactid")||t.getAttribute("name");if(e&&sG[n])return sG[n];var i=window.getComputedStyle(t),r=i.getPropertyValue("box-sizing")||i.getPropertyValue("-moz-box-sizing")||i.getPropertyValue("-webkit-box-sizing"),o=parseFloat(i.getPropertyValue("padding-bottom"))+parseFloat(i.getPropertyValue("padding-top")),a=parseFloat(i.getPropertyValue("border-bottom-width"))+parseFloat(i.getPropertyValue("border-top-width")),s=Jq.map(function(c){return"".concat(c,":").concat(i.getPropertyValue(c))}).join(";"),l={sizingStyle:s,paddingSize:o,borderSize:a,boxSizing:r};return e&&n&&(sG[n]=l),l}function jq(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;No||(No=document.createElement("textarea"),No.setAttribute("tab-index","-1"),No.setAttribute("aria-hidden","true"),No.setAttribute("name","hiddenTextarea"),document.body.appendChild(No)),t.getAttribute("wrap")?No.setAttribute("wrap",t.getAttribute("wrap")):No.removeAttribute("wrap");var r=Qq(t,e),o=r.paddingSize,a=r.borderSize,s=r.boxSizing,l=r.sizingStyle;No.setAttribute("style","".concat(l,";").concat(Oq)),No.value=t.value||t.placeholder||"";var c=void 0,g=void 0,u,d=No.scrollHeight;if(s==="border-box"?d+=a:s==="content-box"&&(d-=o),n!==null||i!==null){No.value=" ";var C=No.scrollHeight-o;n!==null&&(c=C*n,s==="border-box"&&(c=c+o+a),d=Math.max(c,d)),i!==null&&(g=C*i,s==="border-box"&&(g=g+o+a),u=d>g?"":"hidden",d=Math.min(g,d))}var f={height:d,overflowY:u,resize:"none"};return c&&(f.minHeight=c),g&&(f.maxHeight=g),f}var $q=["prefixCls","defaultValue","value","autoSize","onResize","className","style","disabled","onChange","onInternalAutoSize"],lG=0,cG=1,gG=2,qq=y.forwardRef(function(t,e){var n=t,i=n.prefixCls,r=n.defaultValue,o=n.value,a=n.autoSize,s=n.onResize,l=n.className,c=n.style,g=n.disabled,u=n.onChange;n.onInternalAutoSize;var d=An(n,$q),C=$r(r,{value:o,postState:function(P){return P??""}}),f=De(C,2),v=f[0],p=f[1],m=function(P){p(P.target.value),u==null||u(P)},A=y.useRef();y.useImperativeHandle(e,function(){return{textArea:A.current}});var b=y.useMemo(function(){return a&&qt(a)==="object"?[a.minRows,a.maxRows]:[]},[a]),G=De(b,2),w=G[0],S=G[1],Z=!!a,x=function(){try{if(document.activeElement===A.current){var P=A.current,$=P.selectionStart,oe=P.selectionEnd,ie=P.scrollTop;A.current.setSelectionRange($,oe),A.current.scrollTop=ie}}catch{}},R=y.useState(gG),W=De(R,2),M=W[0],N=W[1],X=y.useState(),E=De(X,2),Q=E[0],k=E[1],J=function(){N(lG)};qn(function(){Z&&J()},[o,w,S,Z]),qn(function(){if(M===lG)N(cG);else if(M===cG){var j=jq(A.current,!1,w,S);N(gG),k(j)}else x()},[M]);var F=y.useRef(),L=function(){Ln.cancel(F.current)},z=function(P){M===gG&&(s==null||s(P),a&&(L(),F.current=Ln(function(){J()})))};y.useEffect(function(){return L},[]);var K=Z?Q:null,O=Re(Re({},c),K);return(M===lG||M===cG)&&(O.overflowY="hidden",O.overflowX="hidden"),y.createElement(Pa,{onResize:z,disabled:!(a||s)},y.createElement("textarea",Zt({},d,{ref:A,style:O,className:qe(i,l,we({},"".concat(i,"-disabled"),g)),disabled:g,value:v,onChange:m})))}),eee=["defaultValue","value","onFocus","onBlur","onChange","allowClear","maxLength","onCompositionStart","onCompositionEnd","suffix","prefixCls","showCount","count","className","style","disabled","hidden","classNames","styles","onResize","onClear","onPressEnter","readOnly","autoSize","onKeyDown"],tee=ze.forwardRef(function(t,e){var n,i=t.defaultValue,r=t.value,o=t.onFocus,a=t.onBlur,s=t.onChange,l=t.allowClear,c=t.maxLength,g=t.onCompositionStart,u=t.onCompositionEnd,d=t.suffix,C=t.prefixCls,f=C===void 0?"rc-textarea":C,v=t.showCount,p=t.count,m=t.className,A=t.style,b=t.disabled,G=t.hidden,w=t.classNames,S=t.styles,Z=t.onResize,x=t.onClear,R=t.onPressEnter,W=t.readOnly,M=t.autoSize,N=t.onKeyDown,X=An(t,eee),E=$r(i,{value:r,defaultValue:i}),Q=De(E,2),k=Q[0],J=Q[1],F=k==null?"":String(k),L=ze.useState(!1),z=De(L,2),K=z[0],O=z[1],j=ze.useRef(!1),P=ze.useState(null),$=De(P,2),oe=$[0],ie=$[1],de=y.useRef(null),Ve=y.useRef(null),Se=function(){var Ne;return(Ne=Ve.current)===null||Ne===void 0?void 0:Ne.textArea},me=function(){Se().focus()};y.useImperativeHandle(e,function(){var Ue;return{resizableTextArea:Ve.current,focus:me,blur:function(){Se().blur()},nativeElement:((Ue=de.current)===null||Ue===void 0?void 0:Ue.nativeElement)||Se()}}),y.useEffect(function(){O(function(Ue){return!b&&Ue})},[b]);var T=ze.useState(null),Ge=De(T,2),ne=Ge[0],he=Ge[1];ze.useEffect(function(){if(ne){var Ue;(Ue=Se()).setSelectionRange.apply(Ue,Et(ne))}},[ne]);var ae=tz(p,v),He=(n=ae.max)!==null&&n!==void 0?n:c,ve=Number(He)>0,Me=ae.strategy(F),q=!!He&&Me>He,Y=function(Ne,je){var Ie=je;!j.current&&ae.exceedFormatter&&ae.max&&ae.strategy(je)>ae.max&&(Ie=ae.exceedFormatter(je,{max:ae.max}),je!==Ie&&he([Se().selectionStart||0,Se().selectionEnd||0])),J(Ie),n0(Ne.currentTarget,Ne,s,Ie)},Ce=function(Ne){j.current=!0,g==null||g(Ne)},se=function(Ne){j.current=!1,Y(Ne,Ne.currentTarget.value),u==null||u(Ne)},fe=function(Ne){Y(Ne,Ne.target.value)},Ze=function(Ne){Ne.key==="Enter"&&R&&R(Ne),N==null||N(Ne)},Oe=function(Ne){O(!0),o==null||o(Ne)},Fe=function(Ne){O(!1),a==null||a(Ne)},Ee=function(Ne){J(""),me(),n0(Se(),Ne,s)},Qe=d,Ye;ae.show&&(ae.showFormatter?Ye=ae.showFormatter({value:F,count:Me,maxLength:He}):Ye="".concat(Me).concat(ve?" / ".concat(He):""),Qe=ze.createElement(ze.Fragment,null,Qe,ze.createElement("span",{className:qe("".concat(f,"-data-count"),w==null?void 0:w.count),style:S==null?void 0:S.count},Ye)));var $e=function(Ne){var je;Z==null||Z(Ne),(je=Se())!==null&&je!==void 0&&je.style.height&&ie(!0)},st=!M&&!v&&!l;return ze.createElement(ez,{ref:de,value:F,allowClear:l,handleReset:Ee,suffix:Qe,prefixCls:f,classNames:Re(Re({},w),{},{affixWrapper:qe(w==null?void 0:w.affixWrapper,we(we({},"".concat(f,"-show-count"),v),"".concat(f,"-textarea-allow-clear"),l))}),disabled:b,focused:K,className:qe(m,q&&"".concat(f,"-out-of-range")),style:Re(Re({},A),oe&&!st?{height:"auto"}:{}),dataAttrs:{affixWrapper:{"data-count":typeof Ye=="string"?Ye:void 0}},hidden:G,readOnly:W,onClear:x},ze.createElement(qq,Zt({},X,{autoSize:M,maxLength:c,onKeyDown:Ze,onChange:fe,onFocus:Oe,onBlur:Fe,onCompositionStart:Ce,onCompositionEnd:se,className:qe(w==null?void 0:w.textarea),style:Re(Re({},S==null?void 0:S.textarea),{},{resize:A==null?void 0:A.resize}),disabled:b,prefixCls:f,onResize:$e,ref:Ve,readOnly:W})))}),nee=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const iee=y.forwardRef((t,e)=>{var n,i;const{prefixCls:r,bordered:o=!0,size:a,disabled:s,status:l,allowClear:c,classNames:g,rootClassName:u,className:d,style:C,styles:f,variant:v}=t,p=nee(t,["prefixCls","bordered","size","disabled","status","allowClear","classNames","rootClassName","className","style","styles","variant"]),{getPrefixCls:m,direction:A,textArea:b}=y.useContext(yn),G=Zs(a),w=y.useContext(lc),S=s??w,{status:Z,hasFeedback:x,feedbackIcon:R}=y.useContext(cl),W=Gv(Z,l),M=y.useRef(null);y.useImperativeHandle(e,()=>{var z;return{resizableTextArea:(z=M.current)===null||z===void 0?void 0:z.resizableTextArea,focus:K=>{var O,j;Rq((j=(O=M.current)===null||O===void 0?void 0:O.resizableTextArea)===null||j===void 0?void 0:j.textArea,K)},blur:()=>{var K;return(K=M.current)===null||K===void 0?void 0:K.blur()}}});const N=m("input",r),X=Lg(N),[E,Q,k]=XZ(N,X),[J,F]=BZ("textArea",v,o),L=nz(c??(b==null?void 0:b.allowClear));return E(y.createElement(tee,Object.assign({autoComplete:b==null?void 0:b.autoComplete},p,{style:Object.assign(Object.assign({},b==null?void 0:b.style),C),styles:Object.assign(Object.assign({},b==null?void 0:b.styles),f),disabled:S,allowClear:L,className:qe(k,X,d,u,b==null?void 0:b.className),classNames:Object.assign(Object.assign(Object.assign({},g),b==null?void 0:b.classNames),{textarea:qe({[`${N}-sm`]:G==="small",[`${N}-lg`]:G==="large"},Q,g==null?void 0:g.textarea,(n=b==null?void 0:b.classNames)===null||n===void 0?void 0:n.textarea),variant:qe({[`${N}-${J}`]:F},e0(N,W)),affixWrapper:qe(`${N}-textarea-affix-wrapper`,{[`${N}-affix-wrapper-rtl`]:A==="rtl",[`${N}-affix-wrapper-sm`]:G==="small",[`${N}-affix-wrapper-lg`]:G==="large",[`${N}-textarea-show-count`]:t.showCount||((i=t.count)===null||i===void 0?void 0:i.show)},Q)}),prefixCls:N,suffix:x&&y.createElement("span",{className:`${N}-textarea-suffix`},R),ref:M})))}),js=xv;js.Group=wq;js.Search=Dq;js.TextArea=iee;js.Password=Pq;js.OTP=Hq;const ree=function(){const t=Object.assign({},arguments.length<=0?void 0:arguments[0]);for(let e=1;e<arguments.length;e++){const n=e<0||arguments.length<=e?void 0:arguments[e];n&&Object.keys(n).forEach(i=>{const r=n[i];r!==void 0&&(t[i]=r)})}return t};var oee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M272.9 512l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L186.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H532c6.7 0 10.4-7.7 6.3-12.9L272.9 512zm304 0l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L490.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H836c6.7 0 10.4-7.7 6.3-12.9L576.9 512z"}}]},name:"double-left",theme:"outlined"},aee=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:oee}))},UM=y.forwardRef(aee),see={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M533.2 492.3L277.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H188c-6.7 0-10.4 7.7-6.3 12.9L447.1 512 181.7 851.1A7.98 7.98 0 00188 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5zm304 0L581.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H492c-6.7 0-10.4 7.7-6.3 12.9L751.1 512 485.7 851.1A7.98 7.98 0 00492 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5z"}}]},name:"double-right",theme:"outlined"},lee=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:see}))},DM=y.forwardRef(lee),cee={items_per_page:"/",jump_to:"",jump_to_confirm:"",page:"",prev_page:"",next_page:"",prev_5:" 5 ",next_5:" 5 ",prev_3:" 3 ",next_3:" 3 ",page_size:""},gee=["10","20","50","100"],uee=function(e){var n=e.pageSizeOptions,i=n===void 0?gee:n,r=e.locale,o=e.changeSize,a=e.pageSize,s=e.goButton,l=e.quickGo,c=e.rootPrefixCls,g=e.selectComponentClass,u=e.selectPrefixCls,d=e.disabled,C=e.buildOptionText,f=e.showSizeChanger,v=ze.useState(""),p=De(v,2),m=p[0],A=p[1],b=function(){return!m||Number.isNaN(m)?void 0:Number(m)},G=typeof C=="function"?C:function(F){return"".concat(F," ").concat(r.items_per_page)},w=function(L,z){if(o==null||o(Number(L)),qt(f)==="object"){var K;(K=f.onChange)===null||K===void 0||K.call(f,L,z)}},S=function(L){A(L.target.value)},Z=function(L){s||m===""||(A(""),!(L.relatedTarget&&(L.relatedTarget.className.indexOf("".concat(c,"-item-link"))>=0||L.relatedTarget.className.indexOf("".concat(c,"-item"))>=0))&&(l==null||l(b())))},x=function(L){m!==""&&(L.keyCode===Ct.ENTER||L.type==="click")&&(A(""),l==null||l(b()))},R=function(){return i.some(function(L){return L.toString()===a.toString()})?i:i.concat([a.toString()]).sort(function(L,z){var K=Number.isNaN(Number(L))?0:Number(L),O=Number.isNaN(Number(z))?0:Number(z);return K-O})},W="".concat(c,"-options");if(!f&&!l)return null;var M=null,N=null,X=null;if(f&&g){var E=qt(f)==="object"?f:{},Q=E.options,k=E.className,J=Q?void 0:R().map(function(F,L){return ze.createElement(g.Option,{key:L,value:F.toString()},G(F))});M=ze.createElement(g,Zt({disabled:d,prefixCls:u,showSearch:!1,optionLabelProp:Q?"label":"children",popupMatchSelectWidth:!1,value:(a||i[0]).toString(),getPopupContainer:function(L){return L.parentNode},"aria-label":r.page_size,defaultOpen:!1},qt(f)==="object"?f:null,{className:qe("".concat(W,"-size-changer"),k),options:Q,onChange:w}),J)}return l&&(s&&(X=typeof s=="boolean"?ze.createElement("button",{type:"button",onClick:x,onKeyUp:x,disabled:d,className:"".concat(W,"-quick-jumper-button")},r.jump_to_confirm):ze.createElement("span",{onClick:x,onKeyUp:x},s)),N=ze.createElement("div",{className:"".concat(W,"-quick-jumper")},r.jump_to,ze.createElement("input",{disabled:d,type:"text",value:m,onChange:S,onKeyUp:x,onBlur:Z,"aria-label":r.page}),r.page,X)),ze.createElement("li",{className:W},M,N)},EI=function(e){var n=e.rootPrefixCls,i=e.page,r=e.active,o=e.className,a=e.showTitle,s=e.onClick,l=e.onKeyPress,c=e.itemRender,g="".concat(n,"-item"),u=qe(g,"".concat(g,"-").concat(i),we(we({},"".concat(g,"-active"),r),"".concat(g,"-disabled"),!i),o),d=function(){s(i)},C=function(p){l(p,s,i)},f=c(i,"page",ze.createElement("a",{rel:"nofollow"},i));return f?ze.createElement("li",{title:a?String(i):null,className:u,onClick:d,onKeyDown:C,tabIndex:0},f):null},dee=function(e,n,i){return i};function OM(){}function JM(t){var e=Number(t);return typeof e=="number"&&!Number.isNaN(e)&&isFinite(e)&&Math.floor(e)===e}function Mc(t,e,n){var i=typeof t>"u"?e:t;return Math.floor((n-1)/i)+1}var Iee=function(e){var n=e.prefixCls,i=n===void 0?"rc-pagination":n,r=e.selectPrefixCls,o=r===void 0?"rc-select":r,a=e.className,s=e.selectComponentClass,l=e.current,c=e.defaultCurrent,g=c===void 0?1:c,u=e.total,d=u===void 0?0:u,C=e.pageSize,f=e.defaultPageSize,v=f===void 0?10:f,p=e.onChange,m=p===void 0?OM:p,A=e.hideOnSinglePage,b=e.align,G=e.showPrevNextJumpers,w=G===void 0?!0:G,S=e.showQuickJumper,Z=e.showLessItems,x=e.showTitle,R=x===void 0?!0:x,W=e.onShowSizeChange,M=W===void 0?OM:W,N=e.locale,X=N===void 0?cee:N,E=e.style,Q=e.totalBoundaryShowSizeChanger,k=Q===void 0?50:Q,J=e.disabled,F=e.simple,L=e.showTotal,z=e.showSizeChanger,K=z===void 0?d>k:z,O=e.pageSizeOptions,j=e.itemRender,P=j===void 0?dee:j,$=e.jumpPrevIcon,oe=e.jumpNextIcon,ie=e.prevIcon,de=e.nextIcon,Ve=ze.useRef(null),Se=$r(10,{value:C,defaultValue:v}),me=De(Se,2),T=me[0],Ge=me[1],ne=$r(1,{value:l,defaultValue:g,postState:function(bt){return Math.max(1,Math.min(bt,Mc(void 0,T,d)))}}),he=De(ne,2),ae=he[0],He=he[1],ve=ze.useState(ae),Me=De(ve,2),q=Me[0],Y=Me[1];y.useEffect(function(){Y(ae)},[ae]);var Ce=Math.max(1,ae-(Z?3:5)),se=Math.min(Mc(void 0,T,d),ae+(Z?3:5));function fe(ot,bt){var Wt=ot||ze.createElement("button",{type:"button","aria-label":bt,className:"".concat(i,"-item-link")});return typeof ot=="function"&&(Wt=ze.createElement(ot,Re({},e))),Wt}function Ze(ot){var bt=ot.target.value,Wt=Mc(void 0,T,d),yt;return bt===""?yt=bt:Number.isNaN(Number(bt))?yt=q:bt>=Wt?yt=Wt:yt=Number(bt),yt}function Oe(ot){return JM(ot)&&ot!==ae&&JM(d)&&d>0}var Fe=d>T?S:!1;function Ee(ot){(ot.keyCode===Ct.UP||ot.keyCode===Ct.DOWN)&&ot.preventDefault()}function Qe(ot){var bt=Ze(ot);switch(bt!==q&&Y(bt),ot.keyCode){case Ct.ENTER:st(bt);break;case Ct.UP:st(bt-1);break;case Ct.DOWN:st(bt+1);break}}function Ye(ot){st(Ze(ot))}function $e(ot){var bt=Mc(ot,T,d),Wt=ae>bt&&bt!==0?bt:ae;Ge(ot),Y(Wt),M==null||M(ae,ot),He(Wt),m==null||m(Wt,ot)}function st(ot){if(Oe(ot)&&!J){var bt=Mc(void 0,T,d),Wt=ot;return ot>bt?Wt=bt:ot<1&&(Wt=1),Wt!==q&&Y(Wt),He(Wt),m==null||m(Wt,T),Wt}return ae}var Ue=ae>1,Ne=ae<Mc(void 0,T,d);function je(){Ue&&st(ae-1)}function Ie(){Ne&&st(ae+1)}function Te(){st(Ce)}function ue(){st(se)}function Pe(ot,bt){if(ot.key==="Enter"||ot.charCode===Ct.ENTER||ot.keyCode===Ct.ENTER){for(var Wt=arguments.length,yt=new Array(Wt>2?Wt-2:0),ht=2;ht<Wt;ht++)yt[ht-2]=arguments[ht];bt.apply(void 0,yt)}}function be(ot){Pe(ot,je)}function Le(ot){Pe(ot,Ie)}function ct(ot){Pe(ot,Te)}function dt(ot){Pe(ot,ue)}function It(ot){var bt=P(ot,"prev",fe(ie,"prev page"));return ze.isValidElement(bt)?ze.cloneElement(bt,{disabled:!Ue}):bt}function Vt(ot){var bt=P(ot,"next",fe(de,"next page"));return ze.isValidElement(bt)?ze.cloneElement(bt,{disabled:!Ne}):bt}function vt(ot){(ot.type==="click"||ot.keyCode===Ct.ENTER)&&st(q)}var et=null,rt=ll(e,{aria:!0,data:!0}),ut=L&&ze.createElement("li",{className:"".concat(i,"-total-text")},L(d,[d===0?0:(ae-1)*T+1,ae*T>d?d:ae*T])),Tt=null,Ft=Mc(void 0,T,d);if(A&&d<=T)return null;var ft=[],At={rootPrefixCls:i,onClick:st,onKeyPress:Pe,showTitle:R,itemRender:P,page:-1},Gt=ae-1>0?ae-1:0,Bt=ae+1<Ft?ae+1:Ft,Yt=S&&S.goButton,St=qt(F)==="object"?F.readOnly:!F,sn=Yt,Ot=null;F&&(Yt&&(typeof Yt=="boolean"?sn=ze.createElement("button",{type:"button",onClick:vt,onKeyUp:vt},X.jump_to_confirm):sn=ze.createElement("span",{onClick:vt,onKeyUp:vt},Yt),sn=ze.createElement("li",{title:R?"".concat(X.jump_to).concat(ae,"/").concat(Ft):null,className:"".concat(i,"-simple-pager")},sn)),Ot=ze.createElement("li",{title:R?"".concat(ae,"/").concat(Ft):null,className:"".concat(i,"-simple-pager")},St?q:ze.createElement("input",{type:"text",value:q,disabled:J,onKeyDown:Ee,onKeyUp:Qe,onChange:Qe,onBlur:Ye,size:3}),ze.createElement("span",{className:"".concat(i,"-slash")},"/"),Ft));var U=Z?1:2;if(Ft<=3+U*2){Ft||ft.push(ze.createElement(EI,Zt({},At,{key:"noPager",page:1,className:"".concat(i,"-item-disabled")})));for(var ee=1;ee<=Ft;ee+=1)ft.push(ze.createElement(EI,Zt({},At,{key:ee,page:ee,active:ae===ee})))}else{var Be=Z?X.prev_3:X.prev_5,_=Z?X.next_3:X.next_5,te=P(Ce,"jump-prev",fe($,"prev page")),ce=P(se,"jump-next",fe(oe,"next page"));w&&(et=te?ze.createElement("li",{title:R?Be:null,key:"prev",onClick:Te,tabIndex:0,onKeyDown:ct,className:qe("".concat(i,"-jump-prev"),we({},"".concat(i,"-jump-prev-custom-icon"),!!$))},te):null,Tt=ce?ze.createElement("li",{title:R?_:null,key:"next",onClick:ue,tabIndex:0,onKeyDown:dt,className:qe("".concat(i,"-jump-next"),we({},"".concat(i,"-jump-next-custom-icon"),!!oe))},ce):null);var le=Math.max(1,ae-U),re=Math.min(ae+U,Ft);ae-1<=U&&(re=1+U*2),Ft-ae<=U&&(le=Ft-U*2);for(var xe=le;xe<=re;xe+=1)ft.push(ze.createElement(EI,Zt({},At,{key:xe,page:xe,active:ae===xe})));if(ae-1>=U*2&&ae!==3&&(ft[0]=ze.cloneElement(ft[0],{className:qe("".concat(i,"-item-after-jump-prev"),ft[0].props.className)}),ft.unshift(et)),Ft-ae>=U*2&&ae!==Ft-2){var Xe=ft[ft.length-1];ft[ft.length-1]=ze.cloneElement(Xe,{className:qe("".concat(i,"-item-before-jump-next"),Xe.props.className)}),ft.push(Tt)}le!==1&&ft.unshift(ze.createElement(EI,Zt({},At,{key:1,page:1}))),re!==Ft&&ft.push(ze.createElement(EI,Zt({},At,{key:Ft,page:Ft})))}var _e=It(Gt);if(_e){var We=!Ue||!Ft;_e=ze.createElement("li",{title:R?X.prev_page:null,onClick:je,tabIndex:We?null:0,onKeyDown:be,className:qe("".concat(i,"-prev"),we({},"".concat(i,"-disabled"),We)),"aria-disabled":We},_e)}var pt=Vt(Bt);if(pt){var lt,nt;F?(lt=!Ne,nt=Ue?0:null):(lt=!Ne||!Ft,nt=lt?null:0),pt=ze.createElement("li",{title:R?X.next_page:null,onClick:Ie,tabIndex:nt,onKeyDown:Le,className:qe("".concat(i,"-next"),we({},"".concat(i,"-disabled"),lt)),"aria-disabled":lt},pt)}var wt=qe(i,a,we(we(we(we(we({},"".concat(i,"-start"),b==="start"),"".concat(i,"-center"),b==="center"),"".concat(i,"-end"),b==="end"),"".concat(i,"-simple"),F),"".concat(i,"-disabled"),J));return ze.createElement("ul",Zt({className:wt,style:E,ref:Ve},rt),ut,_e,F?Ot:ft,pt,ze.createElement(uee,{locale:X,rootPrefixCls:i,disabled:J,selectComponentClass:s,selectPrefixCls:o,changeSize:$e,pageSize:T,pageSizeOptions:O,quickGo:Fe?st:null,goButton:sn,showSizeChanger:K}))};const rz=t=>y.createElement(hl,Object.assign({},t,{showSearch:!0,size:"small"})),oz=t=>y.createElement(hl,Object.assign({},t,{showSearch:!0,size:"middle"}));rz.Option=hl.Option;oz.Option=hl.Option;const Cee=t=>{const{componentCls:e}=t;return{[`${e}-disabled`]:{"&, &:hover":{cursor:"not-allowed",[`${e}-item-link`]:{color:t.colorTextDisabled,cursor:"not-allowed"}},"&:focus-visible":{cursor:"not-allowed",[`${e}-item-link`]:{color:t.colorTextDisabled,cursor:"not-allowed"}}},[`&${e}-disabled`]:{cursor:"not-allowed",[`${e}-item`]:{cursor:"not-allowed","&:hover, &:active":{backgroundColor:"transparent"},a:{color:t.colorTextDisabled,backgroundColor:"transparent",border:"none",cursor:"not-allowed"},"&-active":{borderColor:t.colorBorder,backgroundColor:t.itemActiveBgDisabled,"&:hover, &:active":{backgroundColor:t.itemActiveBgDisabled},a:{color:t.itemActiveColorDisabled}}},[`${e}-item-link`]:{color:t.colorTextDisabled,cursor:"not-allowed","&:hover, &:active":{backgroundColor:"transparent"},[`${e}-simple&`]:{backgroundColor:"transparent","&:hover, &:active":{backgroundColor:"transparent"}}},[`${e}-simple-pager`]:{color:t.colorTextDisabled},[`${e}-jump-prev, ${e}-jump-next`]:{[`${e}-item-link-icon`]:{opacity:0},[`${e}-item-ellipsis`]:{opacity:1}}},[`&${e}-simple`]:{[`${e}-prev, ${e}-next`]:{[`&${e}-disabled ${e}-item-link`]:{"&:hover, &:active":{backgroundColor:"transparent"}}}}}},hee=t=>{const{componentCls:e}=t;return{[`&${e}-mini ${e}-total-text, &${e}-mini ${e}-simple-pager`]:{height:t.itemSizeSM,lineHeight:Je(t.itemSizeSM)},[`&${e}-mini ${e}-item`]:{minWidth:t.itemSizeSM,height:t.itemSizeSM,margin:0,lineHeight:Je(t.calc(t.itemSizeSM).sub(2).equal())},[`&${e}-mini:not(${e}-disabled) ${e}-item:not(${e}-item-active)`]:{backgroundColor:"transparent",borderColor:"transparent","&:hover":{backgroundColor:t.colorBgTextHover},"&:active":{backgroundColor:t.colorBgTextActive}},[`&${e}-mini ${e}-prev, &${e}-mini ${e}-next`]:{minWidth:t.itemSizeSM,height:t.itemSizeSM,margin:0,lineHeight:Je(t.itemSizeSM)},[`&${e}-mini:not(${e}-disabled)`]:{[`${e}-prev, ${e}-next`]:{[`&:hover ${e}-item-link`]:{backgroundColor:t.colorBgTextHover},[`&:active ${e}-item-link`]:{backgroundColor:t.colorBgTextActive},[`&${e}-disabled:hover ${e}-item-link`]:{backgroundColor:"transparent"}}},[`
    &${e}-mini ${e}-prev ${e}-item-link,
    &${e}-mini ${e}-next ${e}-item-link
    `]:{backgroundColor:"transparent",borderColor:"transparent","&::after":{height:t.itemSizeSM,lineHeight:Je(t.itemSizeSM)}},[`&${e}-mini ${e}-jump-prev, &${e}-mini ${e}-jump-next`]:{height:t.itemSizeSM,marginInlineEnd:0,lineHeight:Je(t.itemSizeSM)},[`&${e}-mini ${e}-options`]:{marginInlineStart:t.paginationMiniOptionsMarginInlineStart,"&-size-changer":{top:t.miniOptionsSizeChangerTop},"&-quick-jumper":{height:t.itemSizeSM,lineHeight:Je(t.itemSizeSM),input:Object.assign(Object.assign({},FZ(t)),{width:t.paginationMiniQuickJumperInputWidth,height:t.controlHeightSM})}}}},fee=t=>{const{componentCls:e}=t;return{[`
    &${e}-simple ${e}-prev,
    &${e}-simple ${e}-next
    `]:{height:t.itemSizeSM,lineHeight:Je(t.itemSizeSM),verticalAlign:"top",[`${e}-item-link`]:{height:t.itemSizeSM,backgroundColor:"transparent",border:0,"&:hover":{backgroundColor:t.colorBgTextHover},"&:active":{backgroundColor:t.colorBgTextActive},"&::after":{height:t.itemSizeSM,lineHeight:Je(t.itemSizeSM)}}},[`&${e}-simple ${e}-simple-pager`]:{display:"inline-block",height:t.itemSizeSM,marginInlineEnd:t.marginXS,input:{boxSizing:"border-box",height:"100%",padding:`0 ${Je(t.paginationItemPaddingInline)}`,textAlign:"center",backgroundColor:t.itemInputBg,border:`${Je(t.lineWidth)} ${t.lineType} ${t.colorBorder}`,borderRadius:t.borderRadius,outline:"none",transition:`border-color ${t.motionDurationMid}`,color:"inherit","&:hover":{borderColor:t.colorPrimary},"&:focus":{borderColor:t.colorPrimaryHover,boxShadow:`${Je(t.inputOutlineOffset)} 0 ${Je(t.controlOutlineWidth)} ${t.controlOutline}`},"&[disabled]":{color:t.colorTextDisabled,backgroundColor:t.colorBgContainerDisabled,borderColor:t.colorBorder,cursor:"not-allowed"}}}}},mee=t=>{const{componentCls:e}=t;return{[`${e}-jump-prev, ${e}-jump-next`]:{outline:0,[`${e}-item-container`]:{position:"relative",[`${e}-item-link-icon`]:{color:t.colorPrimary,fontSize:t.fontSizeSM,opacity:0,transition:`all ${t.motionDurationMid}`,"&-svg":{top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,margin:"auto"}},[`${e}-item-ellipsis`]:{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,display:"block",margin:"auto",color:t.colorTextDisabled,letterSpacing:t.paginationEllipsisLetterSpacing,textAlign:"center",textIndent:t.paginationEllipsisTextIndent,opacity:1,transition:`all ${t.motionDurationMid}`}},"&:hover":{[`${e}-item-link-icon`]:{opacity:1},[`${e}-item-ellipsis`]:{opacity:0}}},[`
    ${e}-prev,
    ${e}-jump-prev,
    ${e}-jump-next
    `]:{marginInlineEnd:t.marginXS},[`
    ${e}-prev,
    ${e}-next,
    ${e}-jump-prev,
    ${e}-jump-next
    `]:{display:"inline-block",minWidth:t.itemSize,height:t.itemSize,color:t.colorText,fontFamily:t.fontFamily,lineHeight:Je(t.itemSize),textAlign:"center",verticalAlign:"middle",listStyle:"none",borderRadius:t.borderRadius,cursor:"pointer",transition:`all ${t.motionDurationMid}`},[`${e}-prev, ${e}-next`]:{outline:0,button:{color:t.colorText,cursor:"pointer",userSelect:"none"},[`${e}-item-link`]:{display:"block",width:"100%",height:"100%",padding:0,fontSize:t.fontSizeSM,textAlign:"center",backgroundColor:"transparent",border:`${Je(t.lineWidth)} ${t.lineType} transparent`,borderRadius:t.borderRadius,outline:"none",transition:`all ${t.motionDurationMid}`},[`&:hover ${e}-item-link`]:{backgroundColor:t.colorBgTextHover},[`&:active ${e}-item-link`]:{backgroundColor:t.colorBgTextActive},[`&${e}-disabled:hover`]:{[`${e}-item-link`]:{backgroundColor:"transparent"}}},[`${e}-slash`]:{marginInlineEnd:t.paginationSlashMarginInlineEnd,marginInlineStart:t.paginationSlashMarginInlineStart},[`${e}-options`]:{display:"inline-block",marginInlineStart:t.margin,verticalAlign:"middle","&-size-changer":{display:"inline-block",width:"auto"},"&-quick-jumper":{display:"inline-block",height:t.controlHeight,marginInlineStart:t.marginXS,lineHeight:Je(t.controlHeight),verticalAlign:"top",input:Object.assign(Object.assign(Object.assign({},HZ(t)),NZ(t,{borderColor:t.colorBorder,hoverBorderColor:t.colorPrimaryHover,activeBorderColor:t.colorPrimary,activeShadow:t.activeShadow})),{"&[disabled]":Object.assign({},wv(t)),width:t.calc(t.controlHeightLG).mul(1.25).equal(),height:t.controlHeight,boxSizing:"border-box",margin:0,marginInlineStart:t.marginXS,marginInlineEnd:t.marginXS})}}}},Aee=t=>{const{componentCls:e}=t;return{[`${e}-item`]:{display:"inline-block",minWidth:t.itemSize,height:t.itemSize,marginInlineEnd:t.marginXS,fontFamily:t.fontFamily,lineHeight:Je(t.calc(t.itemSize).sub(2).equal()),textAlign:"center",verticalAlign:"middle",listStyle:"none",backgroundColor:t.itemBg,border:`${Je(t.lineWidth)} ${t.lineType} transparent`,borderRadius:t.borderRadius,outline:0,cursor:"pointer",userSelect:"none",a:{display:"block",padding:`0 ${Je(t.paginationItemPaddingInline)}`,color:t.colorText,"&:hover":{textDecoration:"none"}},[`&:not(${e}-item-active)`]:{"&:hover":{transition:`all ${t.motionDurationMid}`,backgroundColor:t.colorBgTextHover},"&:active":{backgroundColor:t.colorBgTextActive}},"&-active":{fontWeight:t.fontWeightStrong,backgroundColor:t.itemActiveBg,borderColor:t.colorPrimary,a:{color:t.colorPrimary},"&:hover":{borderColor:t.colorPrimaryHover},"&:hover a":{color:t.colorPrimaryHover}}}}},pee=t=>{const{componentCls:e}=t;return{[e]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ba(t)),{display:"flex","&-start":{justifyContent:"start"},"&-center":{justifyContent:"center"},"&-end":{justifyContent:"end"},"ul, ol":{margin:0,padding:0,listStyle:"none"},"&::after":{display:"block",clear:"both",height:0,overflow:"hidden",visibility:"hidden",content:'""'},[`${e}-total-text`]:{display:"inline-block",height:t.itemSize,marginInlineEnd:t.marginXS,lineHeight:Je(t.calc(t.itemSize).sub(2).equal()),verticalAlign:"middle"}}),Aee(t)),mee(t)),fee(t)),hee(t)),Cee(t)),{[`@media only screen and (max-width: ${t.screenLG}px)`]:{[`${e}-item`]:{"&-after-jump-prev, &-before-jump-next":{display:"none"}}},[`@media only screen and (max-width: ${t.screenSM}px)`]:{[`${e}-options`]:{display:"none"}}}),[`&${t.componentCls}-rtl`]:{direction:"rtl"}}},vee=t=>{const{componentCls:e}=t;return{[`${e}:not(${e}-disabled)`]:{[`${e}-item`]:Object.assign({},Dh(t)),[`${e}-jump-prev, ${e}-jump-next`]:{"&:focus-visible":Object.assign({[`${e}-item-link-icon`]:{opacity:1},[`${e}-item-ellipsis`]:{opacity:0}},L2(t))},[`${e}-prev, ${e}-next`]:{[`&:focus-visible ${e}-item-link`]:Object.assign({},L2(t))}}}},az=t=>Object.assign({itemBg:t.colorBgContainer,itemSize:t.controlHeight,itemSizeSM:t.controlHeightSM,itemActiveBg:t.colorBgContainer,itemLinkBg:t.colorBgContainer,itemActiveColorDisabled:t.colorTextDisabled,itemActiveBgDisabled:t.controlItemBgActiveDisabled,itemInputBg:t.colorBgContainer,miniOptionsSizeChangerTop:0},MZ(t)),sz=t=>ci(t,{inputOutlineOffset:0,paginationMiniOptionsMarginInlineStart:t.calc(t.marginXXS).div(2).equal(),paginationMiniQuickJumperInputWidth:t.calc(t.controlHeightLG).mul(1.1).equal(),paginationItemPaddingInline:t.calc(t.marginXXS).mul(1.5).equal(),paginationEllipsisLetterSpacing:t.calc(t.marginXXS).div(2).equal(),paginationSlashMarginInlineStart:t.marginSM,paginationSlashMarginInlineEnd:t.marginSM,paginationEllipsisTextIndent:"0.13em"},VZ(t)),bee=yo("Pagination",t=>{const e=sz(t);return[pee(e),vee(e)]},az),yee=t=>{const{componentCls:e}=t;return{[`${e}${e}-bordered${e}-disabled:not(${e}-mini)`]:{"&, &:hover":{[`${e}-item-link`]:{borderColor:t.colorBorder}},"&:focus-visible":{[`${e}-item-link`]:{borderColor:t.colorBorder}},[`${e}-item, ${e}-item-link`]:{backgroundColor:t.colorBgContainerDisabled,borderColor:t.colorBorder,[`&:hover:not(${e}-item-active)`]:{backgroundColor:t.colorBgContainerDisabled,borderColor:t.colorBorder,a:{color:t.colorTextDisabled}},[`&${e}-item-active`]:{backgroundColor:t.itemActiveBgDisabled}},[`${e}-prev, ${e}-next`]:{"&:hover button":{backgroundColor:t.colorBgContainerDisabled,borderColor:t.colorBorder,color:t.colorTextDisabled},[`${e}-item-link`]:{backgroundColor:t.colorBgContainerDisabled,borderColor:t.colorBorder}}},[`${e}${e}-bordered:not(${e}-mini)`]:{[`${e}-prev, ${e}-next`]:{"&:hover button":{borderColor:t.colorPrimaryHover,backgroundColor:t.itemBg},[`${e}-item-link`]:{backgroundColor:t.itemLinkBg,borderColor:t.colorBorder},[`&:hover ${e}-item-link`]:{borderColor:t.colorPrimary,backgroundColor:t.itemBg,color:t.colorPrimary},[`&${e}-disabled`]:{[`${e}-item-link`]:{borderColor:t.colorBorder,color:t.colorTextDisabled}}},[`${e}-item`]:{backgroundColor:t.itemBg,border:`${Je(t.lineWidth)} ${t.lineType} ${t.colorBorder}`,[`&:hover:not(${e}-item-active)`]:{borderColor:t.colorPrimary,backgroundColor:t.itemBg,a:{color:t.colorPrimary}},"&-active":{borderColor:t.colorPrimary}}}}},Gee=iZ(["Pagination","bordered"],t=>{const e=sz(t);return[yee(e)]},az);var Bee=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const See=t=>{const{align:e,prefixCls:n,selectPrefixCls:i,className:r,rootClassName:o,style:a,size:s,locale:l,selectComponentClass:c,responsive:g,showSizeChanger:u}=t,d=Bee(t,["align","prefixCls","selectPrefixCls","className","rootClassName","style","size","locale","selectComponentClass","responsive","showSizeChanger"]),{xs:C}=RY(g),[,f]=Qo(),{getPrefixCls:v,direction:p,pagination:m={}}=y.useContext(yn),A=v("pagination",n),[b,G,w]=bee(A),S=u??m.showSizeChanger,Z=y.useMemo(()=>{const Q=y.createElement("span",{className:`${A}-item-ellipsis`},""),k=y.createElement("button",{className:`${A}-item-link`,type:"button",tabIndex:-1},p==="rtl"?y.createElement(GV,null):y.createElement(xM,null)),J=y.createElement("button",{className:`${A}-item-link`,type:"button",tabIndex:-1},p==="rtl"?y.createElement(xM,null):y.createElement(GV,null)),F=y.createElement("a",{className:`${A}-item-link`},y.createElement("div",{className:`${A}-item-container`},p==="rtl"?y.createElement(DM,{className:`${A}-item-link-icon`}):y.createElement(UM,{className:`${A}-item-link-icon`}),Q)),L=y.createElement("a",{className:`${A}-item-link`},y.createElement("div",{className:`${A}-item-container`},p==="rtl"?y.createElement(UM,{className:`${A}-item-link-icon`}):y.createElement(DM,{className:`${A}-item-link-icon`}),Q));return{prevIcon:k,nextIcon:J,jumpPrevIcon:F,jumpNextIcon:L}},[p,A]),[x]=Uh("Pagination",NX),R=Object.assign(Object.assign({},x),l),W=Zs(s),M=W==="small"||!!(C&&!W&&g),N=v("select",i),X=qe({[`${A}-${e}`]:!!e,[`${A}-mini`]:M,[`${A}-rtl`]:p==="rtl",[`${A}-bordered`]:f.wireframe},m==null?void 0:m.className,r,o,G,w),E=Object.assign(Object.assign({},m==null?void 0:m.style),a);return b(y.createElement(y.Fragment,null,f.wireframe&&y.createElement(Gee,{prefixCls:A}),y.createElement(Iee,Object.assign({},Z,d,{style:E,prefixCls:A,selectPrefixCls:N,className:X,selectComponentClass:c||(M?rz:oz),locale:R,showSizeChanger:S}))))},i0=100,lz=i0/5,cz=i0/2-lz/2,uG=cz*2*Math.PI,QM=50,jM=t=>{const{dotClassName:e,style:n,hasCircleCls:i}=t;return y.createElement("circle",{className:qe(`${e}-circle`,{[`${e}-circle-bg`]:i}),r:cz,cx:QM,cy:QM,strokeWidth:lz,style:n})},wee=t=>{let{percent:e,prefixCls:n}=t;const i=`${n}-dot`,r=`${i}-holder`,o=`${r}-hidden`,[a,s]=y.useState(!1);qn(()=>{e!==0&&s(!0)},[e!==0]);const l=Math.max(Math.min(e,100),0);if(!a)return null;const c={strokeDashoffset:`${uG/4}`,strokeDasharray:`${uG*l/100} ${uG*(100-l)/100}`};return y.createElement("span",{className:qe(r,`${i}-progress`,l<=0&&o)},y.createElement("svg",{viewBox:`0 0 ${i0} ${i0}`,role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":l},y.createElement(jM,{dotClassName:i,hasCircleCls:!0}),y.createElement(jM,{dotClassName:i,style:c})))};function Zee(t){const{prefixCls:e,percent:n=0}=t,i=`${e}-dot`,r=`${i}-holder`,o=`${r}-hidden`;return y.createElement(y.Fragment,null,y.createElement("span",{className:qe(r,n>0&&o)},y.createElement("span",{className:qe(i,`${e}-dot-spin`)},[1,2,3,4].map(a=>y.createElement("i",{className:`${e}-dot-item`,key:a})))),y.createElement(wee,{prefixCls:e,percent:n}))}function xee(t){const{prefixCls:e,indicator:n,percent:i}=t,r=`${e}-dot`;return n&&y.isValidElement(n)?Ed(n,{className:qe(n.props.className,r),percent:i}):y.createElement(Zee,{prefixCls:e,percent:i})}const Ree=new Fn("antSpinMove",{to:{opacity:1}}),Wee=new Fn("antRotate",{to:{transform:"rotate(405deg)"}}),Vee=t=>{const{componentCls:e,calc:n}=t;return{[e]:Object.assign(Object.assign({},ba(t)),{position:"absolute",display:"none",color:t.colorPrimary,fontSize:0,textAlign:"center",verticalAlign:"middle",opacity:0,transition:`transform ${t.motionDurationSlow} ${t.motionEaseInOutCirc}`,"&-spinning":{position:"relative",display:"inline-block",opacity:1},[`${e}-text`]:{fontSize:t.fontSize,paddingTop:n(n(t.dotSize).sub(t.fontSize)).div(2).add(2).equal()},"&-fullscreen":{position:"fixed",width:"100vw",height:"100vh",backgroundColor:t.colorBgMask,zIndex:t.zIndexPopupBase,inset:0,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",opacity:0,visibility:"hidden",transition:`all ${t.motionDurationMid}`,"&-show":{opacity:1,visibility:"visible"},[e]:{[`${e}-dot-holder`]:{color:t.colorWhite},[`${e}-text`]:{color:t.colorTextLightSolid}}},"&-nested-loading":{position:"relative",[`> div > ${e}`]:{position:"absolute",top:0,insetInlineStart:0,zIndex:4,display:"block",width:"100%",height:"100%",maxHeight:t.contentHeight,[`${e}-dot`]:{position:"absolute",top:"50%",insetInlineStart:"50%",margin:n(t.dotSize).mul(-1).div(2).equal()},[`${e}-text`]:{position:"absolute",top:"50%",width:"100%",textShadow:`0 1px 2px ${t.colorBgContainer}`},[`&${e}-show-text ${e}-dot`]:{marginTop:n(t.dotSize).div(2).mul(-1).sub(10).equal()},"&-sm":{[`${e}-dot`]:{margin:n(t.dotSizeSM).mul(-1).div(2).equal()},[`${e}-text`]:{paddingTop:n(n(t.dotSizeSM).sub(t.fontSize)).div(2).add(2).equal()},[`&${e}-show-text ${e}-dot`]:{marginTop:n(t.dotSizeSM).div(2).mul(-1).sub(10).equal()}},"&-lg":{[`${e}-dot`]:{margin:n(t.dotSizeLG).mul(-1).div(2).equal()},[`${e}-text`]:{paddingTop:n(n(t.dotSizeLG).sub(t.fontSize)).div(2).add(2).equal()},[`&${e}-show-text ${e}-dot`]:{marginTop:n(t.dotSizeLG).div(2).mul(-1).sub(10).equal()}}},[`${e}-container`]:{position:"relative",transition:`opacity ${t.motionDurationSlow}`,"&::after":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:10,width:"100%",height:"100%",background:t.colorBgContainer,opacity:0,transition:`all ${t.motionDurationSlow}`,content:'""',pointerEvents:"none"}},[`${e}-blur`]:{clear:"both",opacity:.5,userSelect:"none",pointerEvents:"none","&::after":{opacity:.4,pointerEvents:"auto"}}},"&-tip":{color:t.spinDotDefault},[`${e}-dot-holder`]:{width:"1em",height:"1em",fontSize:t.dotSize,display:"inline-block",transition:`transform ${t.motionDurationSlow} ease, opacity ${t.motionDurationSlow} ease`,transformOrigin:"50% 50%",lineHeight:1,color:t.colorPrimary,"&-hidden":{transform:"scale(0.3)",opacity:0}},[`${e}-dot-progress`]:{position:"absolute",top:"50%",transform:"translate(-50%, -50%)",insetInlineStart:"50%"},[`${e}-dot`]:{position:"relative",display:"inline-block",fontSize:t.dotSize,width:"1em",height:"1em","&-item":{position:"absolute",display:"block",width:n(t.dotSize).sub(n(t.marginXXS).div(2)).div(2).equal(),height:n(t.dotSize).sub(n(t.marginXXS).div(2)).div(2).equal(),background:"currentColor",borderRadius:"100%",transform:"scale(0.75)",transformOrigin:"50% 50%",opacity:.3,animationName:Ree,animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDirection:"alternate","&:nth-child(1)":{top:0,insetInlineStart:0,animationDelay:"0s"},"&:nth-child(2)":{top:0,insetInlineEnd:0,animationDelay:"0.4s"},"&:nth-child(3)":{insetInlineEnd:0,bottom:0,animationDelay:"0.8s"},"&:nth-child(4)":{bottom:0,insetInlineStart:0,animationDelay:"1.2s"}},"&-spin":{transform:"rotate(45deg)",animationName:Wee,animationDuration:"1.2s",animationIterationCount:"infinite",animationTimingFunction:"linear"},"&-circle":{strokeLinecap:"round",transition:["stroke-dashoffset","stroke-dasharray","stroke","stroke-width","opacity"].map(i=>`${i} ${t.motionDurationSlow} ease`).join(","),fillOpacity:0,stroke:"currentcolor"},"&-circle-bg":{stroke:t.colorFillSecondary}},[`&-sm ${e}-dot`]:{"&, &-holder":{fontSize:t.dotSizeSM}},[`&-sm ${e}-dot-holder`]:{i:{width:n(n(t.dotSizeSM).sub(n(t.marginXXS).div(2))).div(2).equal(),height:n(n(t.dotSizeSM).sub(n(t.marginXXS).div(2))).div(2).equal()}},[`&-lg ${e}-dot`]:{"&, &-holder":{fontSize:t.dotSizeLG}},[`&-lg ${e}-dot-holder`]:{i:{width:n(n(t.dotSizeLG).sub(t.marginXXS)).div(2).equal(),height:n(n(t.dotSizeLG).sub(t.marginXXS)).div(2).equal()}},[`&${e}-show-text ${e}-text`]:{display:"block"}})}},Mee=t=>{const{controlHeightLG:e,controlHeight:n}=t;return{contentHeight:400,dotSize:e/2,dotSizeSM:e*.35,dotSizeLG:n}},Nee=yo("Spin",t=>{const e=ci(t,{spinDotDefault:t.colorTextDescription});return[Vee(e)]},Mee),Fee=200,$M=[[30,.05],[70,.03],[96,.01]];function Hee(t,e){const[n,i]=y.useState(0),r=y.useRef(),o=e==="auto";return y.useEffect(()=>(o&&t&&(i(0),r.current=setInterval(()=>{i(a=>{const s=100-a;for(let l=0;l<$M.length;l+=1){const[c,g]=$M[l];if(a<=c)return a+s*g}return a})},Fee)),()=>{clearInterval(r.current)}),[o,t]),o?n:e}var Xee=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};let gz;function Eee(t,e){return!!t&&!!e&&!isNaN(Number(e))}const YZ=t=>{var e;const{prefixCls:n,spinning:i=!0,delay:r=0,className:o,rootClassName:a,size:s="default",tip:l,wrapperClassName:c,style:g,children:u,fullscreen:d=!1,indicator:C,percent:f}=t,v=Xee(t,["prefixCls","spinning","delay","className","rootClassName","size","tip","wrapperClassName","style","children","fullscreen","indicator","percent"]),{getPrefixCls:p,direction:m,spin:A}=y.useContext(yn),b=p("spin",n),[G,w,S]=Nee(b),[Z,x]=y.useState(()=>i&&!Eee(i,r)),R=Hee(Z,f);y.useEffect(()=>{if(i){const k=aq(r,()=>{x(!0)});return k(),()=>{var J;(J=k==null?void 0:k.cancel)===null||J===void 0||J.call(k)}}x(!1)},[r,i]);const W=y.useMemo(()=>typeof u<"u"&&!d,[u,d]),M=qe(b,A==null?void 0:A.className,{[`${b}-sm`]:s==="small",[`${b}-lg`]:s==="large",[`${b}-spinning`]:Z,[`${b}-show-text`]:!!l,[`${b}-rtl`]:m==="rtl"},o,!d&&a,w,S),N=qe(`${b}-container`,{[`${b}-blur`]:Z}),X=(e=C??(A==null?void 0:A.indicator))!==null&&e!==void 0?e:gz,E=Object.assign(Object.assign({},A==null?void 0:A.style),g),Q=y.createElement("div",Object.assign({},v,{style:E,className:M,"aria-live":"polite","aria-busy":Z}),y.createElement(xee,{prefixCls:b,indicator:X,percent:R}),l&&(W||d)?y.createElement("div",{className:`${b}-text`},l):null);return G(W?y.createElement("div",Object.assign({},v,{className:qe(`${b}-nested-loading`,c,w,S)}),Z&&y.createElement("div",{key:"loading"},Q),y.createElement("div",{className:N,key:"container"},u)):d?y.createElement("div",{className:qe(`${b}-fullscreen`,{[`${b}-fullscreen-show`]:Z},a,w,S)},Q):Q)};YZ.setDefaultIndicator=t=>{gz=t};const zZ=ze.createContext({});zZ.Consumer;var uz=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const Yee=t=>{var{prefixCls:e,className:n,avatar:i,title:r,description:o}=t,a=uz(t,["prefixCls","className","avatar","title","description"]);const{getPrefixCls:s}=y.useContext(yn),l=s("list",e),c=qe(`${l}-item-meta`,n),g=ze.createElement("div",{className:`${l}-item-meta-content`},r&&ze.createElement("h4",{className:`${l}-item-meta-title`},r),o&&ze.createElement("div",{className:`${l}-item-meta-description`},o));return ze.createElement("div",Object.assign({},a,{className:c}),i&&ze.createElement("div",{className:`${l}-item-meta-avatar`},i),(r||o)&&g)},zee=ze.forwardRef((t,e)=>{const{prefixCls:n,children:i,actions:r,extra:o,styles:a,className:s,classNames:l,colStyle:c}=t,g=uz(t,["prefixCls","children","actions","extra","styles","className","classNames","colStyle"]),{grid:u,itemLayout:d}=y.useContext(zZ),{getPrefixCls:C,list:f}=y.useContext(yn),v=Z=>{var x,R;return qe((R=(x=f==null?void 0:f.item)===null||x===void 0?void 0:x.classNames)===null||R===void 0?void 0:R[Z],l==null?void 0:l[Z])},p=Z=>{var x,R;return Object.assign(Object.assign({},(R=(x=f==null?void 0:f.item)===null||x===void 0?void 0:x.styles)===null||R===void 0?void 0:R[Z]),a==null?void 0:a[Z])},m=()=>{let Z=!1;return y.Children.forEach(i,x=>{typeof x=="string"&&(Z=!0)}),Z&&y.Children.count(i)>1},A=()=>d==="vertical"?!!o:!m(),b=C("list",n),G=r&&r.length>0&&ze.createElement("ul",{className:qe(`${b}-item-action`,v("actions")),key:"actions",style:p("actions")},r.map((Z,x)=>ze.createElement("li",{key:`${b}-item-action-${x}`},Z,x!==r.length-1&&ze.createElement("em",{className:`${b}-item-action-split`})))),w=u?"div":"li",S=ze.createElement(w,Object.assign({},g,u?{}:{ref:e},{className:qe(`${b}-item`,{[`${b}-item-no-flex`]:!A()},s)}),d==="vertical"&&o?[ze.createElement("div",{className:`${b}-item-main`,key:"content"},i,G),ze.createElement("div",{className:qe(`${b}-item-extra`,v("extra")),key:"extra",style:p("extra")},o)]:[i,G,Ed(o,{key:"extra"})]);return u?ze.createElement(mq,{ref:e,flex:1,style:c},S):S}),dz=zee;dz.Meta=Yee;const Kee=t=>{const{listBorderedCls:e,componentCls:n,paddingLG:i,margin:r,itemPaddingSM:o,itemPaddingLG:a,marginLG:s,borderRadiusLG:l}=t;return{[e]:{border:`${Je(t.lineWidth)} ${t.lineType} ${t.colorBorder}`,borderRadius:l,[`${n}-header,${n}-footer,${n}-item`]:{paddingInline:i},[`${n}-pagination`]:{margin:`${Je(r)} ${Je(s)}`}},[`${e}${n}-sm`]:{[`${n}-item,${n}-header,${n}-footer`]:{padding:o}},[`${e}${n}-lg`]:{[`${n}-item,${n}-header,${n}-footer`]:{padding:a}}}},Lee=t=>{const{componentCls:e,screenSM:n,screenMD:i,marginLG:r,marginSM:o,margin:a}=t;return{[`@media screen and (max-width:${i}px)`]:{[e]:{[`${e}-item`]:{[`${e}-item-action`]:{marginInlineStart:r}}},[`${e}-vertical`]:{[`${e}-item`]:{[`${e}-item-extra`]:{marginInlineStart:r}}}},[`@media screen and (max-width: ${n}px)`]:{[e]:{[`${e}-item`]:{flexWrap:"wrap",[`${e}-action`]:{marginInlineStart:o}}},[`${e}-vertical`]:{[`${e}-item`]:{flexWrap:"wrap-reverse",[`${e}-item-main`]:{minWidth:t.contentWidth},[`${e}-item-extra`]:{margin:`auto auto ${Je(a)}`}}}}}},Tee=t=>{const{componentCls:e,antCls:n,controlHeight:i,minHeight:r,paddingSM:o,marginLG:a,padding:s,itemPadding:l,colorPrimary:c,itemPaddingSM:g,itemPaddingLG:u,paddingXS:d,margin:C,colorText:f,colorTextDescription:v,motionDurationSlow:p,lineWidth:m,headerBg:A,footerBg:b,emptyTextPadding:G,metaMarginBottom:w,avatarMarginRight:S,titleMarginBottom:Z,descriptionFontSize:x}=t;return{[e]:Object.assign(Object.assign({},ba(t)),{position:"relative","*":{outline:"none"},[`${e}-header`]:{background:A},[`${e}-footer`]:{background:b},[`${e}-header, ${e}-footer`]:{paddingBlock:o},[`${e}-pagination`]:{marginBlockStart:a,[`${n}-pagination-options`]:{textAlign:"start"}},[`${e}-spin`]:{minHeight:r,textAlign:"center"},[`${e}-items`]:{margin:0,padding:0,listStyle:"none"},[`${e}-item`]:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:l,color:f,[`${e}-item-meta`]:{display:"flex",flex:1,alignItems:"flex-start",maxWidth:"100%",[`${e}-item-meta-avatar`]:{marginInlineEnd:S},[`${e}-item-meta-content`]:{flex:"1 0",width:0,color:f},[`${e}-item-meta-title`]:{margin:`0 0 ${Je(t.marginXXS)} 0`,color:f,fontSize:t.fontSize,lineHeight:t.lineHeight,"> a":{color:f,transition:`all ${p}`,"&:hover":{color:c}}},[`${e}-item-meta-description`]:{color:v,fontSize:x,lineHeight:t.lineHeight}},[`${e}-item-action`]:{flex:"0 0 auto",marginInlineStart:t.marginXXL,padding:0,fontSize:0,listStyle:"none","& > li":{position:"relative",display:"inline-block",padding:`0 ${Je(d)}`,color:v,fontSize:t.fontSize,lineHeight:t.lineHeight,textAlign:"center","&:first-child":{paddingInlineStart:0}},[`${e}-item-action-split`]:{position:"absolute",insetBlockStart:"50%",insetInlineEnd:0,width:m,height:t.calc(t.fontHeight).sub(t.calc(t.marginXXS).mul(2)).equal(),transform:"translateY(-50%)",backgroundColor:t.colorSplit}}},[`${e}-empty`]:{padding:`${Je(s)} 0`,color:v,fontSize:t.fontSizeSM,textAlign:"center"},[`${e}-empty-text`]:{padding:G,color:t.colorTextDisabled,fontSize:t.fontSize,textAlign:"center"},[`${e}-item-no-flex`]:{display:"block"}}),[`${e}-grid ${n}-col > ${e}-item`]:{display:"block",maxWidth:"100%",marginBlockEnd:C,paddingBlock:0,borderBlockEnd:"none"},[`${e}-vertical ${e}-item`]:{alignItems:"initial",[`${e}-item-main`]:{display:"block",flex:1},[`${e}-item-extra`]:{marginInlineStart:a},[`${e}-item-meta`]:{marginBlockEnd:w,[`${e}-item-meta-title`]:{marginBlockStart:0,marginBlockEnd:Z,color:f,fontSize:t.fontSizeLG,lineHeight:t.lineHeightLG}},[`${e}-item-action`]:{marginBlockStart:s,marginInlineStart:"auto","> li":{padding:`0 ${Je(s)}`,"&:first-child":{paddingInlineStart:0}}}},[`${e}-split ${e}-item`]:{borderBlockEnd:`${Je(t.lineWidth)} ${t.lineType} ${t.colorSplit}`,"&:last-child":{borderBlockEnd:"none"}},[`${e}-split ${e}-header`]:{borderBlockEnd:`${Je(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-split${e}-empty ${e}-footer`]:{borderTop:`${Je(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-loading ${e}-spin-nested-loading`]:{minHeight:i},[`${e}-split${e}-something-after-last-item ${n}-spin-container > ${e}-items > ${e}-item:last-child`]:{borderBlockEnd:`${Je(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-lg ${e}-item`]:{padding:u},[`${e}-sm ${e}-item`]:{padding:g},[`${e}:not(${e}-vertical)`]:{[`${e}-item-no-flex`]:{[`${e}-item-action`]:{float:"right"}}}}},_ee=t=>({contentWidth:220,itemPadding:`${Je(t.paddingContentVertical)} 0`,itemPaddingSM:`${Je(t.paddingContentVerticalSM)} ${Je(t.paddingContentHorizontal)}`,itemPaddingLG:`${Je(t.paddingContentVerticalLG)} ${Je(t.paddingContentHorizontalLG)}`,headerBg:"transparent",footerBg:"transparent",emptyTextPadding:t.padding,metaMarginBottom:t.padding,avatarMarginRight:t.padding,titleMarginBottom:t.paddingSM,descriptionFontSize:t.fontSize}),kee=yo("List",t=>{const e=ci(t,{listBorderedCls:`${t.componentCls}-bordered`,minHeight:t.controlHeightLG});return[Tee(e),Kee(e),Lee(e)]},_ee);var Pee=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function Uee(t,e){var{pagination:n=!1,prefixCls:i,bordered:r=!1,split:o=!0,className:a,rootClassName:s,style:l,children:c,itemLayout:g,loadMore:u,grid:d,dataSource:C=[],size:f,header:v,footer:p,loading:m=!1,rowKey:A,renderItem:b,locale:G}=t,w=Pee(t,["pagination","prefixCls","bordered","split","className","rootClassName","style","children","itemLayout","loadMore","grid","dataSource","size","header","footer","loading","rowKey","renderItem","locale"]);const S=n&&typeof n=="object"?n:{},[Z,x]=y.useState(S.defaultCurrent||1),[R,W]=y.useState(S.defaultPageSize||10),{getPrefixCls:M,renderEmpty:N,direction:X,list:E}=y.useContext(yn),Q={current:1,total:0},k=Y=>(Ce,se)=>{var fe;x(Ce),W(se),n&&((fe=n==null?void 0:n[Y])===null||fe===void 0||fe.call(n,Ce,se))},J=k("onChange"),F=k("onShowSizeChange"),L=(Y,Ce)=>{if(!b)return null;let se;return typeof A=="function"?se=A(Y):A?se=Y[A]:se=Y.key,se||(se=`list-item-${Ce}`),y.createElement(y.Fragment,{key:se},b(Y,Ce))},z=()=>!!(u||n||p),K=M("list",i),[O,j,P]=kee(K);let $=m;typeof $=="boolean"&&($={spinning:$});const oe=!!($!=null&&$.spinning),ie=Zs(f);let de="";switch(ie){case"large":de="lg";break;case"small":de="sm";break}const Ve=qe(K,{[`${K}-vertical`]:g==="vertical",[`${K}-${de}`]:de,[`${K}-split`]:o,[`${K}-bordered`]:r,[`${K}-loading`]:oe,[`${K}-grid`]:!!d,[`${K}-something-after-last-item`]:z(),[`${K}-rtl`]:X==="rtl"},E==null?void 0:E.className,a,s,j,P),Se=ree(Q,{total:C.length,current:Z,pageSize:R},n||{}),me=Math.ceil(Se.total/Se.pageSize);Se.current>me&&(Se.current=me);const T=n&&y.createElement("div",{className:qe(`${K}-pagination`)},y.createElement(See,Object.assign({align:"end"},Se,{onChange:J,onShowSizeChange:F})));let Ge=Et(C);n&&C.length>(Se.current-1)*Se.pageSize&&(Ge=Et(C).splice((Se.current-1)*Se.pageSize,Se.pageSize));const ne=Object.keys(d||{}).some(Y=>["xs","sm","md","lg","xl","xxl"].includes(Y)),he=RY(ne),ae=y.useMemo(()=>{for(let Y=0;Y<Vg.length;Y+=1){const Ce=Vg[Y];if(he[Ce])return Ce}},[he]),He=y.useMemo(()=>{if(!d)return;const Y=ae&&d[ae]?d[ae]:d.column;if(Y)return{width:`${100/Y}%`,maxWidth:`${100/Y}%`}},[JSON.stringify(d),ae]);let ve=oe&&y.createElement("div",{style:{minHeight:53}});if(Ge.length>0){const Y=Ge.map((Ce,se)=>L(Ce,se));ve=d?y.createElement(pq,{gutter:d.gutter},y.Children.map(Y,Ce=>y.createElement("div",{key:Ce==null?void 0:Ce.key,style:He},Ce))):y.createElement("ul",{className:`${K}-items`},Y)}else!c&&!oe&&(ve=y.createElement("div",{className:`${K}-empty-text`},(G==null?void 0:G.emptyText)||(N==null?void 0:N("List"))||y.createElement(GY,{componentName:"List"})));const Me=Se.position||"bottom",q=y.useMemo(()=>({grid:d,itemLayout:g}),[JSON.stringify(d),g]);return O(y.createElement(zZ.Provider,{value:q},y.createElement("div",Object.assign({ref:e,style:Object.assign(Object.assign({},E==null?void 0:E.style),l),className:Ve},w),(Me==="top"||Me==="both")&&T,v&&y.createElement("div",{className:`${K}-header`},v),y.createElement(YZ,Object.assign({},$),ve,c),p&&y.createElement("div",{className:`${K}-footer`},p),u||(Me==="bottom"||Me==="both")&&T)))}const Dee=y.forwardRef(Uee),pS=Dee;pS.Item=dz;var Oee=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const Jee=t=>{const{prefixCls:e,className:n,closeIcon:i,closable:r,type:o,title:a,children:s,footer:l}=t,c=Oee(t,["prefixCls","className","closeIcon","closable","type","title","children","footer"]),{getPrefixCls:g}=y.useContext(yn),u=g(),d=e||g("modal"),C=Lg(u),[f,v,p]=QE(d,C),m=`${d}-confirm`;let A={};return o?A={closable:r??!1,title:"",footer:"",children:y.createElement($E,Object.assign({},t,{prefixCls:d,confirmPrefixCls:m,rootPrefixCls:u,content:s}))}:A={closable:r??!0,title:a,footer:l!==null&&y.createElement(DE,Object.assign({},t)),children:s},f(y.createElement(EE,Object.assign({prefixCls:d,className:qe(v,`${d}-pure-panel`,o&&m,o&&`${m}-${o}`,n,p,C)},c,{closeIcon:UE(d,i),closable:r},A)))},Qee=sY(Jee);function Iz(t){return qh(nY(t))}const _o=jE;_o.useModal=Fj;_o.info=function(e){return qh(iY(e))};_o.success=function(e){return qh(rY(e))};_o.error=function(e){return qh(oY(e))};_o.warning=Iz;_o.warn=Iz;_o.confirm=function(e){return qh(aY(e))};_o.destroyAll=function(){for(;lg.length;){const e=lg.pop();e&&e()}};_o.config=Rj;_o._InternalPanelDoNotUseOrYouWillBeFired=Qee;var jee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},$ee=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:jee}))},qee=y.forwardRef($ee),ete={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"},tte=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:ete}))},nte=y.forwardRef(tte),ite={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 009.3-35.2l-.9-2.6a443.74 443.74 0 00-79.7-137.9l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.4a351.86 351.86 0 00-99 57.4l-81.9-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a446.02 446.02 0 00-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1 0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0025.8 25.7l2.7.5a449.4 449.4 0 00159 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-85a350 350 0 0099.7-57.6l81.3 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1 74.7 63.9a370.03 370.03 0 01-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3-17.9 97a377.5 377.5 0 01-85 0l-17.9-97.2-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5 0-15.3 1.2-30.6 3.7-45.5l6.5-40-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2 31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3 17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97 38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8 92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8A111.6 111.6 0 01624 502c0 29.9-11.7 58-32.8 79.2z"}}]},name:"setting",theme:"outlined"},rte=function(e,n){return y.createElement(Ai,Zt({},e,{ref:n,icon:ite}))},ote=y.forwardRef(rte);/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const rf="168",Oc={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Jc={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Cz=0,vS=1,hz=2,ate=3,fz=0,Rv=1,RC=2,Ea=3,gl=0,qr=1,da=2,ys=0,Ag=1,bS=2,yS=3,GS=4,mz=5,_l=100,Az=101,pz=102,vz=103,bz=104,yz=200,Gz=201,Bz=202,Sz=203,r0=204,o0=205,wz=206,Zz=207,xz=208,Rz=209,Wz=210,Vz=211,Mz=212,Nz=213,Fz=214,Hz=0,Xz=1,Ez=2,Ah=3,Yz=4,zz=5,Kz=6,Lz=7,of=0,Tz=1,_z=2,Gs=0,kz=1,Pz=2,Uz=3,KZ=4,Dz=5,Oz=6,Jz=7,BS="attached",Qz="detached",cc=300,Ss=301,gc=302,Ld=303,ph=304,eI=306,vh=1e3,zi=1001,bh=1002,rr=1003,LZ=1004,ste=1004,rd=1005,lte=1005,Kn=1006,WC=1007,cte=1007,ms=1008,SS=1008,vo=1009,Wv=1010,Vv=1011,Td=1012,af=1013,ws=1014,hi=1015,or=1016,Mv=1017,Nv=1018,Mg=1020,TZ=35902,_Z=1021,kZ=1022,Wi=1023,PZ=1024,UZ=1025,pg=1026,Ng=1027,sf=1028,lf=1029,DZ=1030,Fv=1031,gte=1032,Hv=1033,VC=33776,MC=33777,NC=33778,FC=33779,a0=35840,s0=35841,l0=35842,c0=35843,g0=36196,u0=37492,d0=37496,I0=37808,C0=37809,h0=37810,f0=37811,m0=37812,A0=37813,p0=37814,v0=37815,b0=37816,y0=37817,G0=37818,B0=37819,S0=37820,w0=37821,HC=36492,Z0=36494,x0=36495,OZ=36283,R0=36284,W0=36285,V0=36286,jz=2200,$z=2201,qz=2202,yh=2300,M0=2301,dp=2302,cg=2400,gg=2401,Gh=2402,Xv=2500,JZ=2501,ute=0,dte=1,Ite=2,e9=3200,QZ=3201,Cte=3202,hte=3203,fc=0,t9=1,Ds="",Yo="srgb",pa="srgb-linear",Ev="display-p3",cf="display-p3-linear",Bh="linear",jn="srgb",Sh="rec709",wh="p3",fte=0,Qc=7680,mte=7681,Ate=7682,pte=7683,vte=34055,bte=34056,yte=5386,Gte=512,Bte=513,Ste=514,wte=515,Zte=516,xte=517,Rte=518,wS=519,n9=512,i9=513,r9=514,jZ=515,o9=516,a9=517,s9=518,l9=519,Zh=35044,c9=35048,Wte=35040,Vte=35045,Mte=35049,Nte=35041,Fte=35046,Hte=35050,Xte=35042,Ete="100",ZS="300 es",As=2e3,xh=2001;let xs=class{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const o=r.indexOf(n);o!==-1&&r.splice(o,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let o=0,a=r.length;o<a;o++)r[o].call(this,e);e.target=null}}};const wr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let qM=1234567;const vg=Math.PI/180,_d=180/Math.PI;function ko(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(wr[t&255]+wr[t>>8&255]+wr[t>>16&255]+wr[t>>24&255]+"-"+wr[e&255]+wr[e>>8&255]+"-"+wr[e>>16&15|64]+wr[e>>24&255]+"-"+wr[n&63|128]+wr[n>>8&255]+"-"+wr[n>>16&255]+wr[n>>24&255]+wr[i&255]+wr[i>>8&255]+wr[i>>16&255]+wr[i>>24&255]).toLowerCase()}function yi(t,e,n){return Math.max(e,Math.min(n,t))}function $Z(t,e){return(t%e+e)%e}function Yte(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)}function zte(t,e,n){return t!==e?(n-t)/(e-t):0}function XC(t,e,n){return(1-n)*t+n*e}function Kte(t,e,n,i){return XC(t,e,1-Math.exp(-n*i))}function Lte(t,e=1){return e-Math.abs($Z(t,e*2)-e)}function Tte(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function _te(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function kte(t,e){return t+Math.floor(Math.random()*(e-t+1))}function Pte(t,e){return t+Math.random()*(e-t)}function Ute(t){return t*(.5-Math.random())}function Dte(t){t!==void 0&&(qM=t);let e=qM+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Ote(t){return t*vg}function Jte(t){return t*_d}function Qte(t){return(t&t-1)===0&&t!==0}function jte(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function $te(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function qte(t,e,n,i,r){const o=Math.cos,a=Math.sin,s=o(n/2),l=a(n/2),c=o((e+i)/2),g=a((e+i)/2),u=o((e-i)/2),d=a((e-i)/2),C=o((i-e)/2),f=a((i-e)/2);switch(r){case"XYX":t.set(s*g,l*u,l*d,s*c);break;case"YZY":t.set(l*d,s*g,l*u,s*c);break;case"ZXZ":t.set(l*u,l*d,s*g,s*c);break;case"XZX":t.set(s*g,l*f,l*C,s*c);break;case"YXY":t.set(l*C,s*g,l*f,s*c);break;case"ZYZ":t.set(l*f,l*C,s*g,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Qr(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function vn(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const ene={DEG2RAD:vg,RAD2DEG:_d,generateUUID:ko,clamp:yi,euclideanModulo:$Z,mapLinear:Yte,inverseLerp:zte,lerp:XC,damp:Kte,pingpong:Lte,smoothstep:Tte,smootherstep:_te,randInt:kte,randFloat:Pte,randFloatSpread:Ute,seededRandom:Dte,degToRad:Ote,radToDeg:Jte,isPowerOfTwo:Qte,ceilPowerOfTwo:jte,floorPowerOfTwo:$te,setQuaternionFromProperEuler:qte,normalize:vn,denormalize:Qr};class gt{constructor(e=0,n=0){gt.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(yi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),r=Math.sin(n),o=this.x-e.x,a=this.y-e.y;return this.x=o*i-a*r+e.x,this.y=o*r+a*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class mn{constructor(e,n,i,r,o,a,s,l,c){mn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,r,o,a,s,l,c)}set(e,n,i,r,o,a,s,l,c){const g=this.elements;return g[0]=e,g[1]=r,g[2]=s,g[3]=n,g[4]=o,g[5]=l,g[6]=i,g[7]=a,g[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,o=this.elements,a=i[0],s=i[3],l=i[6],c=i[1],g=i[4],u=i[7],d=i[2],C=i[5],f=i[8],v=r[0],p=r[3],m=r[6],A=r[1],b=r[4],G=r[7],w=r[2],S=r[5],Z=r[8];return o[0]=a*v+s*A+l*w,o[3]=a*p+s*b+l*S,o[6]=a*m+s*G+l*Z,o[1]=c*v+g*A+u*w,o[4]=c*p+g*b+u*S,o[7]=c*m+g*G+u*Z,o[2]=d*v+C*A+f*w,o[5]=d*p+C*b+f*S,o[8]=d*m+C*G+f*Z,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],g=e[8];return n*a*g-n*s*c-i*o*g+i*s*l+r*o*c-r*a*l}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],g=e[8],u=g*a-s*c,d=s*l-g*o,C=c*o-a*l,f=n*u+i*d+r*C;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);const v=1/f;return e[0]=u*v,e[1]=(r*c-g*i)*v,e[2]=(s*i-r*a)*v,e[3]=d*v,e[4]=(g*n-r*l)*v,e[5]=(r*o-s*n)*v,e[6]=C*v,e[7]=(i*l-c*n)*v,e[8]=(a*n-i*o)*v,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,r,o,a,s){const l=Math.cos(o),c=Math.sin(o);return this.set(i*l,i*c,-i*(l*a+c*s)+a+e,-r*c,r*l,-r*(-c*a+l*s)+s+n,0,0,1),this}scale(e,n){return this.premultiply(dG.makeScale(e,n)),this}rotate(e){return this.premultiply(dG.makeRotation(-e)),this}translate(e,n){return this.premultiply(dG.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<9;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const dG=new mn;function g9(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const tne={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function od(t,e){return new tne[t](e)}function Rh(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function u9(){const t=Rh("canvas");return t.style.display="block",t}const eN={};function Ad(t){t in eN||(eN[t]=!0,console.warn(t))}function nne(t,e,n){return new Promise(function(i,r){function o(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:r();break;case t.TIMEOUT_EXPIRED:setTimeout(o,n);break;default:i()}}setTimeout(o,n)})}const tN=new mn().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),nN=new mn().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),YI={[pa]:{transfer:Bh,primaries:Sh,luminanceCoefficients:[.2126,.7152,.0722],toReference:t=>t,fromReference:t=>t},[Yo]:{transfer:jn,primaries:Sh,luminanceCoefficients:[.2126,.7152,.0722],toReference:t=>t.convertSRGBToLinear(),fromReference:t=>t.convertLinearToSRGB()},[cf]:{transfer:Bh,primaries:wh,luminanceCoefficients:[.2289,.6917,.0793],toReference:t=>t.applyMatrix3(nN),fromReference:t=>t.applyMatrix3(tN)},[Ev]:{transfer:jn,primaries:wh,luminanceCoefficients:[.2289,.6917,.0793],toReference:t=>t.convertSRGBToLinear().applyMatrix3(nN),fromReference:t=>t.applyMatrix3(tN).convertLinearToSRGB()}},ine=new Set([pa,cf]),Yn={enabled:!0,_workingColorSpace:pa,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(t){if(!ine.has(t))throw new Error(`Unsupported working color space, "${t}".`);this._workingColorSpace=t},convert:function(t,e,n){if(this.enabled===!1||e===n||!e||!n)return t;const i=YI[e].toReference,r=YI[n].fromReference;return r(i(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this._workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this._workingColorSpace)},getPrimaries:function(t){return YI[t].primaries},getTransfer:function(t){return t===Ds?Bh:YI[t].transfer},getLuminanceCoefficients:function(t,e=this._workingColorSpace){return t.fromArray(YI[e].luminanceCoefficients)}};function pd(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function IG(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let fu;class d9{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{fu===void 0&&(fu=Rh("canvas")),fu.width=e.width,fu.height=e.height;const i=fu.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),n=fu}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=Rh("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),o=r.data;for(let a=0;a<o.length;a++)o[a]=pd(o[a]/255)*255;return i.putImageData(r,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(pd(n[i]/255)*255):n[i]=pd(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let rne=0;class ug{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:rne++}),this.uuid=ko(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let o;if(Array.isArray(r)){o=[];for(let a=0,s=r.length;a<s;a++)r[a].isDataTexture?o.push(CG(r[a].image)):o.push(CG(r[a]))}else o=CG(r);i.url=o}return n||(e.images[this.uuid]=i),i}}function CG(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?d9.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let one=0;class Tn extends xs{constructor(e=Tn.DEFAULT_IMAGE,n=Tn.DEFAULT_MAPPING,i=zi,r=zi,o=Kn,a=ms,s=Wi,l=vo,c=Tn.DEFAULT_ANISOTROPY,g=Ds){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:one++}),this.uuid=ko(),this.name="",this.source=new ug(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=o,this.minFilter=a,this.anisotropy=c,this.format=s,this.internalFormat=null,this.type=l,this.offset=new gt(0,0),this.repeat=new gt(1,1),this.center=new gt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new mn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=g,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==cc)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case vh:e.x=e.x-Math.floor(e.x);break;case zi:e.x=e.x<0?0:1;break;case bh:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case vh:e.y=e.y-Math.floor(e.y);break;case zi:e.y=e.y<0?0:1;break;case bh:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Tn.DEFAULT_IMAGE=null;Tn.DEFAULT_MAPPING=cc;Tn.DEFAULT_ANISOTROPY=1;class zn{constructor(e=0,n=0,i=0,r=1){zn.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,o=this.w,a=e.elements;return this.x=a[0]*n+a[4]*i+a[8]*r+a[12]*o,this.y=a[1]*n+a[5]*i+a[9]*r+a[13]*o,this.z=a[2]*n+a[6]*i+a[10]*r+a[14]*o,this.w=a[3]*n+a[7]*i+a[11]*r+a[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,r,o;const l=e.elements,c=l[0],g=l[4],u=l[8],d=l[1],C=l[5],f=l[9],v=l[2],p=l[6],m=l[10];if(Math.abs(g-d)<.01&&Math.abs(u-v)<.01&&Math.abs(f-p)<.01){if(Math.abs(g+d)<.1&&Math.abs(u+v)<.1&&Math.abs(f+p)<.1&&Math.abs(c+C+m-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const b=(c+1)/2,G=(C+1)/2,w=(m+1)/2,S=(g+d)/4,Z=(u+v)/4,x=(f+p)/4;return b>G&&b>w?b<.01?(i=0,r=.707106781,o=.707106781):(i=Math.sqrt(b),r=S/i,o=Z/i):G>w?G<.01?(i=.707106781,r=0,o=.707106781):(r=Math.sqrt(G),i=S/r,o=x/r):w<.01?(i=.707106781,r=.707106781,o=0):(o=Math.sqrt(w),i=Z/o,r=x/o),this.set(i,r,o,n),this}let A=Math.sqrt((p-f)*(p-f)+(u-v)*(u-v)+(d-g)*(d-g));return Math.abs(A)<.001&&(A=1),this.x=(p-f)/A,this.y=(u-v)/A,this.z=(d-g)/A,this.w=Math.acos((c+C+m-1)/2),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class I9 extends xs{constructor(e=1,n=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new zn(0,0,e,n),this.scissorTest=!1,this.viewport=new zn(0,0,e,n);const r={width:e,height:n,depth:1};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Kn,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},i);const o=new Tn(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);o.flipY=!1,o.generateMipmaps=i.generateMipmaps,o.internalFormat=i.internalFormat,this.textures=[];const a=i.count;for(let s=0;s<a;s++)this.textures[s]=o.clone(),this.textures[s].isRenderTargetTexture=!0;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,n,i=1){if(this.width!==e||this.height!==n||this.depth!==i){this.width=e,this.height=n,this.depth=i;for(let r=0,o=this.textures.length;r<o;r++)this.textures[r].image.width=e,this.textures[r].image.height=n,this.textures[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let i=0,r=e.textures.length;i<r;i++)this.textures[i]=e.textures[i].clone(),this.textures[i].isRenderTargetTexture=!0;const n=Object.assign({},e.texture.image);return this.texture.source=new ug(n),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Do extends I9{constructor(e=1,n=1,i={}){super(e,n,i),this.isWebGLRenderTarget=!0}}class Yv extends Tn{constructor(e=null,n=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=rr,this.minFilter=rr,this.wrapR=zi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class ane extends Do{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new Yv(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class qZ extends Tn{constructor(e=null,n=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=rr,this.minFilter=rr,this.wrapR=zi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class sne extends Do{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new qZ(null,e,n,i),this.texture.isRenderTargetTexture=!0}}let sr=class{constructor(e=0,n=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=r}static slerpFlat(e,n,i,r,o,a,s){let l=i[r+0],c=i[r+1],g=i[r+2],u=i[r+3];const d=o[a+0],C=o[a+1],f=o[a+2],v=o[a+3];if(s===0){e[n+0]=l,e[n+1]=c,e[n+2]=g,e[n+3]=u;return}if(s===1){e[n+0]=d,e[n+1]=C,e[n+2]=f,e[n+3]=v;return}if(u!==v||l!==d||c!==C||g!==f){let p=1-s;const m=l*d+c*C+g*f+u*v,A=m>=0?1:-1,b=1-m*m;if(b>Number.EPSILON){const w=Math.sqrt(b),S=Math.atan2(w,m*A);p=Math.sin(p*S)/w,s=Math.sin(s*S)/w}const G=s*A;if(l=l*p+d*G,c=c*p+C*G,g=g*p+f*G,u=u*p+v*G,p===1-s){const w=1/Math.sqrt(l*l+c*c+g*g+u*u);l*=w,c*=w,g*=w,u*=w}}e[n]=l,e[n+1]=c,e[n+2]=g,e[n+3]=u}static multiplyQuaternionsFlat(e,n,i,r,o,a){const s=i[r],l=i[r+1],c=i[r+2],g=i[r+3],u=o[a],d=o[a+1],C=o[a+2],f=o[a+3];return e[n]=s*f+g*u+l*C-c*d,e[n+1]=l*f+g*d+c*u-s*C,e[n+2]=c*f+g*C+s*d-l*u,e[n+3]=g*f-s*u-l*d-c*C,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,r){return this._x=e,this._y=n,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const i=e._x,r=e._y,o=e._z,a=e._order,s=Math.cos,l=Math.sin,c=s(i/2),g=s(r/2),u=s(o/2),d=l(i/2),C=l(r/2),f=l(o/2);switch(a){case"XYZ":this._x=d*g*u+c*C*f,this._y=c*C*u-d*g*f,this._z=c*g*f+d*C*u,this._w=c*g*u-d*C*f;break;case"YXZ":this._x=d*g*u+c*C*f,this._y=c*C*u-d*g*f,this._z=c*g*f-d*C*u,this._w=c*g*u+d*C*f;break;case"ZXY":this._x=d*g*u-c*C*f,this._y=c*C*u+d*g*f,this._z=c*g*f+d*C*u,this._w=c*g*u-d*C*f;break;case"ZYX":this._x=d*g*u-c*C*f,this._y=c*C*u+d*g*f,this._z=c*g*f-d*C*u,this._w=c*g*u+d*C*f;break;case"YZX":this._x=d*g*u+c*C*f,this._y=c*C*u+d*g*f,this._z=c*g*f-d*C*u,this._w=c*g*u-d*C*f;break;case"XZY":this._x=d*g*u-c*C*f,this._y=c*C*u-d*g*f,this._z=c*g*f+d*C*u,this._w=c*g*u+d*C*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],r=n[4],o=n[8],a=n[1],s=n[5],l=n[9],c=n[2],g=n[6],u=n[10],d=i+s+u;if(d>0){const C=.5/Math.sqrt(d+1);this._w=.25/C,this._x=(g-l)*C,this._y=(o-c)*C,this._z=(a-r)*C}else if(i>s&&i>u){const C=2*Math.sqrt(1+i-s-u);this._w=(g-l)/C,this._x=.25*C,this._y=(r+a)/C,this._z=(o+c)/C}else if(s>u){const C=2*Math.sqrt(1+s-i-u);this._w=(o-c)/C,this._x=(r+a)/C,this._y=.25*C,this._z=(l+g)/C}else{const C=2*Math.sqrt(1+u-i-s);this._w=(a-r)/C,this._x=(o+c)/C,this._y=(l+g)/C,this._z=.25*C}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(yi(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,n/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,r=e._y,o=e._z,a=e._w,s=n._x,l=n._y,c=n._z,g=n._w;return this._x=i*g+a*s+r*c-o*l,this._y=r*g+a*l+o*s-i*c,this._z=o*g+a*c+i*l-r*s,this._w=a*g-i*s-r*l-o*c,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,r=this._y,o=this._z,a=this._w;let s=a*e._w+i*e._x+r*e._y+o*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=a,this._x=i,this._y=r,this._z=o,this;const l=1-s*s;if(l<=Number.EPSILON){const C=1-n;return this._w=C*a+n*this._w,this._x=C*i+n*this._x,this._y=C*r+n*this._y,this._z=C*o+n*this._z,this.normalize(),this}const c=Math.sqrt(l),g=Math.atan2(c,s),u=Math.sin((1-n)*g)/c,d=Math.sin(n*g)/c;return this._w=a*u+this._w*d,this._x=i*u+this._x*d,this._y=r*u+this._y*d,this._z=o*u+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),o=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),o*Math.sin(n),o*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}};class ge{constructor(e=0,n=0,i=0){ge.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(iN.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(iN.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*n+o[3]*i+o[6]*r,this.y=o[1]*n+o[4]*i+o[7]*r,this.z=o[2]*n+o[5]*i+o[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,o=e.elements,a=1/(o[3]*n+o[7]*i+o[11]*r+o[15]);return this.x=(o[0]*n+o[4]*i+o[8]*r+o[12])*a,this.y=(o[1]*n+o[5]*i+o[9]*r+o[13])*a,this.z=(o[2]*n+o[6]*i+o[10]*r+o[14])*a,this}applyQuaternion(e){const n=this.x,i=this.y,r=this.z,o=e.x,a=e.y,s=e.z,l=e.w,c=2*(a*r-s*i),g=2*(s*n-o*r),u=2*(o*i-a*n);return this.x=n+l*c+a*u-s*g,this.y=i+l*g+s*c-o*u,this.z=r+l*u+o*g-a*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*n+o[4]*i+o[8]*r,this.y=o[1]*n+o[5]*i+o[9]*r,this.z=o[2]*n+o[6]*i+o[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,r=e.y,o=e.z,a=n.x,s=n.y,l=n.z;return this.x=r*l-o*s,this.y=o*a-i*l,this.z=i*s-r*a,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return hG.copy(this).projectOnVector(e),this.sub(hG)}reflect(e){return this.sub(hG.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(yi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,i=Math.sqrt(1-n*n);return this.x=i*Math.cos(e),this.y=n,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const hG=new ge,iN=new sr;class Cr{constructor(e=new ge(1/0,1/0,1/0),n=new ge(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(Ra.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(Ra.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=Ra.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const o=i.getAttribute("position");if(n===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let a=0,s=o.count;a<s;a++)e.isMesh===!0?e.getVertexPosition(a,Ra):Ra.fromBufferAttribute(o,a),Ra.applyMatrix4(e.matrixWorld),this.expandByPoint(Ra);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Ym.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),Ym.copy(i.boundingBox)),Ym.applyMatrix4(e.matrixWorld),this.union(Ym)}const r=e.children;for(let o=0,a=r.length;o<a;o++)this.expandByObject(r[o],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Ra),Ra.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(zI),zm.subVectors(this.max,zI),mu.subVectors(e.a,zI),Au.subVectors(e.b,zI),pu.subVectors(e.c,zI),Zl.subVectors(Au,mu),xl.subVectors(pu,Au),Nc.subVectors(mu,pu);let n=[0,-Zl.z,Zl.y,0,-xl.z,xl.y,0,-Nc.z,Nc.y,Zl.z,0,-Zl.x,xl.z,0,-xl.x,Nc.z,0,-Nc.x,-Zl.y,Zl.x,0,-xl.y,xl.x,0,-Nc.y,Nc.x,0];return!fG(n,mu,Au,pu,zm)||(n=[1,0,0,0,1,0,0,0,1],!fG(n,mu,Au,pu,zm))?!1:(Km.crossVectors(Zl,xl),n=[Km.x,Km.y,Km.z],fG(n,mu,Au,pu,zm))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ra).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ra).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Ys[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ys[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ys[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ys[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ys[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ys[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ys[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ys[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ys),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Ys=[new ge,new ge,new ge,new ge,new ge,new ge,new ge,new ge],Ra=new ge,Ym=new Cr,mu=new ge,Au=new ge,pu=new ge,Zl=new ge,xl=new ge,Nc=new ge,zI=new ge,zm=new ge,Km=new ge,Fc=new ge;function fG(t,e,n,i,r){for(let o=0,a=t.length-3;o<=a;o+=3){Fc.fromArray(t,o);const s=r.x*Math.abs(Fc.x)+r.y*Math.abs(Fc.y)+r.z*Math.abs(Fc.z),l=e.dot(Fc),c=n.dot(Fc),g=i.dot(Fc);if(Math.max(-Math.max(l,c,g),Math.min(l,c,g))>s)return!1}return!0}const lne=new Cr,KI=new ge,mG=new ge;class hr{constructor(e=new ge,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):lne.setFromPoints(e).getCenter(i);let r=0;for(let o=0,a=e.length;o<a;o++)r=Math.max(r,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;KI.subVectors(e,this.center);const n=KI.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),r=(i-this.radius)*.5;this.center.addScaledVector(KI,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(mG.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(KI.copy(e.center).add(mG)),this.expandByPoint(KI.copy(e.center).sub(mG))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const zs=new ge,AG=new ge,Lm=new ge,Rl=new ge,pG=new ge,Tm=new ge,vG=new ge;let kg=class{constructor(e=new ge,n=new ge(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,zs)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=zs.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(zs.copy(this.origin).addScaledVector(this.direction,n),zs.distanceToSquared(e))}distanceSqToSegment(e,n,i,r){AG.copy(e).add(n).multiplyScalar(.5),Lm.copy(n).sub(e).normalize(),Rl.copy(this.origin).sub(AG);const o=e.distanceTo(n)*.5,a=-this.direction.dot(Lm),s=Rl.dot(this.direction),l=-Rl.dot(Lm),c=Rl.lengthSq(),g=Math.abs(1-a*a);let u,d,C,f;if(g>0)if(u=a*l-s,d=a*s-l,f=o*g,u>=0)if(d>=-f)if(d<=f){const v=1/g;u*=v,d*=v,C=u*(u+a*d+2*s)+d*(a*u+d+2*l)+c}else d=o,u=Math.max(0,-(a*d+s)),C=-u*u+d*(d+2*l)+c;else d=-o,u=Math.max(0,-(a*d+s)),C=-u*u+d*(d+2*l)+c;else d<=-f?(u=Math.max(0,-(-a*o+s)),d=u>0?-o:Math.min(Math.max(-o,-l),o),C=-u*u+d*(d+2*l)+c):d<=f?(u=0,d=Math.min(Math.max(-o,-l),o),C=d*(d+2*l)+c):(u=Math.max(0,-(a*o+s)),d=u>0?o:Math.min(Math.max(-o,-l),o),C=-u*u+d*(d+2*l)+c);else d=a>0?-o:o,u=Math.max(0,-(a*d+s)),C=-u*u+d*(d+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,u),r&&r.copy(AG).addScaledVector(Lm,d),C}intersectSphere(e,n){zs.subVectors(e.center,this.origin);const i=zs.dot(this.direction),r=zs.dot(zs)-i*i,o=e.radius*e.radius;if(r>o)return null;const a=Math.sqrt(o-r),s=i-a,l=i+a;return l<0?null:s<0?this.at(l,n):this.at(s,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,r,o,a,s,l;const c=1/this.direction.x,g=1/this.direction.y,u=1/this.direction.z,d=this.origin;return c>=0?(i=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(i=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),g>=0?(o=(e.min.y-d.y)*g,a=(e.max.y-d.y)*g):(o=(e.max.y-d.y)*g,a=(e.min.y-d.y)*g),i>a||o>r||((o>i||isNaN(i))&&(i=o),(a<r||isNaN(r))&&(r=a),u>=0?(s=(e.min.z-d.z)*u,l=(e.max.z-d.z)*u):(s=(e.max.z-d.z)*u,l=(e.min.z-d.z)*u),i>l||s>r)||((s>i||i!==i)&&(i=s),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,n)}intersectsBox(e){return this.intersectBox(e,zs)!==null}intersectTriangle(e,n,i,r,o){pG.subVectors(n,e),Tm.subVectors(i,e),vG.crossVectors(pG,Tm);let a=this.direction.dot(vG),s;if(a>0){if(r)return null;s=1}else if(a<0)s=-1,a=-a;else return null;Rl.subVectors(this.origin,e);const l=s*this.direction.dot(Tm.crossVectors(Rl,Tm));if(l<0)return null;const c=s*this.direction.dot(pG.cross(Rl));if(c<0||l+c>a)return null;const g=-s*Rl.dot(vG);return g<0?null:this.at(g/a,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}};class ln{constructor(e,n,i,r,o,a,s,l,c,g,u,d,C,f,v,p){ln.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,r,o,a,s,l,c,g,u,d,C,f,v,p)}set(e,n,i,r,o,a,s,l,c,g,u,d,C,f,v,p){const m=this.elements;return m[0]=e,m[4]=n,m[8]=i,m[12]=r,m[1]=o,m[5]=a,m[9]=s,m[13]=l,m[2]=c,m[6]=g,m[10]=u,m[14]=d,m[3]=C,m[7]=f,m[11]=v,m[15]=p,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ln().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,r=1/vu.setFromMatrixColumn(e,0).length(),o=1/vu.setFromMatrixColumn(e,1).length(),a=1/vu.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*o,n[5]=i[5]*o,n[6]=i[6]*o,n[7]=0,n[8]=i[8]*a,n[9]=i[9]*a,n[10]=i[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,r=e.y,o=e.z,a=Math.cos(i),s=Math.sin(i),l=Math.cos(r),c=Math.sin(r),g=Math.cos(o),u=Math.sin(o);if(e.order==="XYZ"){const d=a*g,C=a*u,f=s*g,v=s*u;n[0]=l*g,n[4]=-l*u,n[8]=c,n[1]=C+f*c,n[5]=d-v*c,n[9]=-s*l,n[2]=v-d*c,n[6]=f+C*c,n[10]=a*l}else if(e.order==="YXZ"){const d=l*g,C=l*u,f=c*g,v=c*u;n[0]=d+v*s,n[4]=f*s-C,n[8]=a*c,n[1]=a*u,n[5]=a*g,n[9]=-s,n[2]=C*s-f,n[6]=v+d*s,n[10]=a*l}else if(e.order==="ZXY"){const d=l*g,C=l*u,f=c*g,v=c*u;n[0]=d-v*s,n[4]=-a*u,n[8]=f+C*s,n[1]=C+f*s,n[5]=a*g,n[9]=v-d*s,n[2]=-a*c,n[6]=s,n[10]=a*l}else if(e.order==="ZYX"){const d=a*g,C=a*u,f=s*g,v=s*u;n[0]=l*g,n[4]=f*c-C,n[8]=d*c+v,n[1]=l*u,n[5]=v*c+d,n[9]=C*c-f,n[2]=-c,n[6]=s*l,n[10]=a*l}else if(e.order==="YZX"){const d=a*l,C=a*c,f=s*l,v=s*c;n[0]=l*g,n[4]=v-d*u,n[8]=f*u+C,n[1]=u,n[5]=a*g,n[9]=-s*g,n[2]=-c*g,n[6]=C*u+f,n[10]=d-v*u}else if(e.order==="XZY"){const d=a*l,C=a*c,f=s*l,v=s*c;n[0]=l*g,n[4]=-u,n[8]=c*g,n[1]=d*u+v,n[5]=a*g,n[9]=C*u-f,n[2]=f*u-C,n[6]=s*g,n[10]=v*u+d}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(cne,e,gne)}lookAt(e,n,i){const r=this.elements;return Fo.subVectors(e,n),Fo.lengthSq()===0&&(Fo.z=1),Fo.normalize(),Wl.crossVectors(i,Fo),Wl.lengthSq()===0&&(Math.abs(i.z)===1?Fo.x+=1e-4:Fo.z+=1e-4,Fo.normalize(),Wl.crossVectors(i,Fo)),Wl.normalize(),_m.crossVectors(Fo,Wl),r[0]=Wl.x,r[4]=_m.x,r[8]=Fo.x,r[1]=Wl.y,r[5]=_m.y,r[9]=Fo.y,r[2]=Wl.z,r[6]=_m.z,r[10]=Fo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,o=this.elements,a=i[0],s=i[4],l=i[8],c=i[12],g=i[1],u=i[5],d=i[9],C=i[13],f=i[2],v=i[6],p=i[10],m=i[14],A=i[3],b=i[7],G=i[11],w=i[15],S=r[0],Z=r[4],x=r[8],R=r[12],W=r[1],M=r[5],N=r[9],X=r[13],E=r[2],Q=r[6],k=r[10],J=r[14],F=r[3],L=r[7],z=r[11],K=r[15];return o[0]=a*S+s*W+l*E+c*F,o[4]=a*Z+s*M+l*Q+c*L,o[8]=a*x+s*N+l*k+c*z,o[12]=a*R+s*X+l*J+c*K,o[1]=g*S+u*W+d*E+C*F,o[5]=g*Z+u*M+d*Q+C*L,o[9]=g*x+u*N+d*k+C*z,o[13]=g*R+u*X+d*J+C*K,o[2]=f*S+v*W+p*E+m*F,o[6]=f*Z+v*M+p*Q+m*L,o[10]=f*x+v*N+p*k+m*z,o[14]=f*R+v*X+p*J+m*K,o[3]=A*S+b*W+G*E+w*F,o[7]=A*Z+b*M+G*Q+w*L,o[11]=A*x+b*N+G*k+w*z,o[15]=A*R+b*X+G*J+w*K,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],r=e[8],o=e[12],a=e[1],s=e[5],l=e[9],c=e[13],g=e[2],u=e[6],d=e[10],C=e[14],f=e[3],v=e[7],p=e[11],m=e[15];return f*(+o*l*u-r*c*u-o*s*d+i*c*d+r*s*C-i*l*C)+v*(+n*l*C-n*c*d+o*a*d-r*a*C+r*c*g-o*l*g)+p*(+n*c*u-n*s*C-o*a*u+i*a*C+o*s*g-i*c*g)+m*(-r*s*g-n*l*u+n*s*d+r*a*u-i*a*d+i*l*g)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],g=e[8],u=e[9],d=e[10],C=e[11],f=e[12],v=e[13],p=e[14],m=e[15],A=u*p*c-v*d*c+v*l*C-s*p*C-u*l*m+s*d*m,b=f*d*c-g*p*c-f*l*C+a*p*C+g*l*m-a*d*m,G=g*v*c-f*u*c+f*s*C-a*v*C-g*s*m+a*u*m,w=f*u*l-g*v*l-f*s*d+a*v*d+g*s*p-a*u*p,S=n*A+i*b+r*G+o*w;if(S===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Z=1/S;return e[0]=A*Z,e[1]=(v*d*o-u*p*o-v*r*C+i*p*C+u*r*m-i*d*m)*Z,e[2]=(s*p*o-v*l*o+v*r*c-i*p*c-s*r*m+i*l*m)*Z,e[3]=(u*l*o-s*d*o-u*r*c+i*d*c+s*r*C-i*l*C)*Z,e[4]=b*Z,e[5]=(g*p*o-f*d*o+f*r*C-n*p*C-g*r*m+n*d*m)*Z,e[6]=(f*l*o-a*p*o-f*r*c+n*p*c+a*r*m-n*l*m)*Z,e[7]=(a*d*o-g*l*o+g*r*c-n*d*c-a*r*C+n*l*C)*Z,e[8]=G*Z,e[9]=(f*u*o-g*v*o-f*i*C+n*v*C+g*i*m-n*u*m)*Z,e[10]=(a*v*o-f*s*o+f*i*c-n*v*c-a*i*m+n*s*m)*Z,e[11]=(g*s*o-a*u*o-g*i*c+n*u*c+a*i*C-n*s*C)*Z,e[12]=w*Z,e[13]=(g*v*r-f*u*r+f*i*d-n*v*d-g*i*p+n*u*p)*Z,e[14]=(f*s*r-a*v*r-f*i*l+n*v*l+a*i*p-n*s*p)*Z,e[15]=(a*u*r-g*s*r+g*i*l-n*u*l-a*i*d+n*s*d)*Z,this}scale(e){const n=this.elements,i=e.x,r=e.y,o=e.z;return n[0]*=i,n[4]*=r,n[8]*=o,n[1]*=i,n[5]*=r,n[9]*=o,n[2]*=i,n[6]*=r,n[10]*=o,n[3]*=i,n[7]*=r,n[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,r))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),r=Math.sin(n),o=1-i,a=e.x,s=e.y,l=e.z,c=o*a,g=o*s;return this.set(c*a+i,c*s-r*l,c*l+r*s,0,c*s+r*l,g*s+i,g*l-r*a,0,c*l-r*s,g*l+r*a,o*l*l+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,r,o,a){return this.set(1,i,o,0,e,1,a,0,n,r,1,0,0,0,0,1),this}compose(e,n,i){const r=this.elements,o=n._x,a=n._y,s=n._z,l=n._w,c=o+o,g=a+a,u=s+s,d=o*c,C=o*g,f=o*u,v=a*g,p=a*u,m=s*u,A=l*c,b=l*g,G=l*u,w=i.x,S=i.y,Z=i.z;return r[0]=(1-(v+m))*w,r[1]=(C+G)*w,r[2]=(f-b)*w,r[3]=0,r[4]=(C-G)*S,r[5]=(1-(d+m))*S,r[6]=(p+A)*S,r[7]=0,r[8]=(f+b)*Z,r[9]=(p-A)*Z,r[10]=(1-(d+v))*Z,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){const r=this.elements;let o=vu.set(r[0],r[1],r[2]).length();const a=vu.set(r[4],r[5],r[6]).length(),s=vu.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),e.x=r[12],e.y=r[13],e.z=r[14],Wa.copy(this);const c=1/o,g=1/a,u=1/s;return Wa.elements[0]*=c,Wa.elements[1]*=c,Wa.elements[2]*=c,Wa.elements[4]*=g,Wa.elements[5]*=g,Wa.elements[6]*=g,Wa.elements[8]*=u,Wa.elements[9]*=u,Wa.elements[10]*=u,n.setFromRotationMatrix(Wa),i.x=o,i.y=a,i.z=s,this}makePerspective(e,n,i,r,o,a,s=As){const l=this.elements,c=2*o/(n-e),g=2*o/(i-r),u=(n+e)/(n-e),d=(i+r)/(i-r);let C,f;if(s===As)C=-(a+o)/(a-o),f=-2*a*o/(a-o);else if(s===xh)C=-a/(a-o),f=-a*o/(a-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);return l[0]=c,l[4]=0,l[8]=u,l[12]=0,l[1]=0,l[5]=g,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=C,l[14]=f,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,n,i,r,o,a,s=As){const l=this.elements,c=1/(n-e),g=1/(i-r),u=1/(a-o),d=(n+e)*c,C=(i+r)*g;let f,v;if(s===As)f=(a+o)*u,v=-2*u;else if(s===xh)f=o*u,v=-1*u;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*g,l[9]=0,l[13]=-C,l[2]=0,l[6]=0,l[10]=v,l[14]=-f,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}const vu=new ge,Wa=new ln,cne=new ge(0,0,0),gne=new ge(1,1,1),Wl=new ge,_m=new ge,Fo=new ge,rN=new ln,oN=new sr;class Ei{constructor(e=0,n=0,i=0,r=Ei.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,r=this._order){return this._x=e,this._y=n,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const r=e.elements,o=r[0],a=r[4],s=r[8],l=r[1],c=r[5],g=r[9],u=r[2],d=r[6],C=r[10];switch(n){case"XYZ":this._y=Math.asin(yi(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-g,C),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-yi(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(s,C),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-u,o),this._z=0);break;case"ZXY":this._x=Math.asin(yi(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,C),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-yi(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,C),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,c));break;case"YZX":this._z=Math.asin(yi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-g,c),this._y=Math.atan2(-u,o)):(this._x=0,this._y=Math.atan2(s,C));break;case"XZY":this._z=Math.asin(-yi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-g,C),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return rN.makeRotationFromQuaternion(e),this.setFromRotationMatrix(rN,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return oN.setFromEuler(this),this.setFromQuaternion(oN,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Ei.DEFAULT_ORDER="XYZ";class bg{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let une=0;const aN=new ge,bu=new sr,Ks=new ln,km=new ge,LI=new ge,dne=new ge,Ine=new sr,sN=new ge(1,0,0),lN=new ge(0,1,0),cN=new ge(0,0,1),gN={type:"added"},Cne={type:"removed"},yu={type:"childadded",child:null},bG={type:"childremoved",child:null};class Vn extends xs{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:une++}),this.uuid=ko(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Vn.DEFAULT_UP.clone();const e=new ge,n=new Ei,i=new sr,r=new ge(1,1,1);function o(){i.setFromEuler(n,!1)}function a(){n.setFromQuaternion(i,void 0,!1)}n._onChange(o),i._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ln},normalMatrix:{value:new mn}}),this.matrix=new ln,this.matrixWorld=new ln,this.matrixAutoUpdate=Vn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Vn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new bg,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return bu.setFromAxisAngle(e,n),this.quaternion.multiply(bu),this}rotateOnWorldAxis(e,n){return bu.setFromAxisAngle(e,n),this.quaternion.premultiply(bu),this}rotateX(e){return this.rotateOnAxis(sN,e)}rotateY(e){return this.rotateOnAxis(lN,e)}rotateZ(e){return this.rotateOnAxis(cN,e)}translateOnAxis(e,n){return aN.copy(e).applyQuaternion(this.quaternion),this.position.add(aN.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(sN,e)}translateY(e){return this.translateOnAxis(lN,e)}translateZ(e){return this.translateOnAxis(cN,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Ks.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?km.copy(e):km.set(e,n,i);const r=this.parent;this.updateWorldMatrix(!0,!1),LI.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ks.lookAt(LI,km,this.up):Ks.lookAt(km,LI,this.up),this.quaternion.setFromRotationMatrix(Ks),r&&(Ks.extractRotation(r.matrixWorld),bu.setFromRotationMatrix(Ks),this.quaternion.premultiply(bu.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(gN),yu.child=e,this.dispatchEvent(yu),yu.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Cne),bG.child=e,this.dispatchEvent(bG),bG.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Ks.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Ks.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ks),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(gN),yu.child=e,this.dispatchEvent(yu),yu.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,r=this.children.length;i<r;i++){const a=this.children[i].getObjectByProperty(e,n);if(a!==void 0)return a}}getObjectsByProperty(e,n,i=[]){this[e]===n&&i.push(this);const r=this.children;for(let o=0,a=r.length;o<a;o++)r[o].getObjectsByProperty(e,n,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(LI,e,dne),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(LI,Ine,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].updateMatrixWorld(e)}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const r=this.children;for(let o=0,a=r.length;o<a;o++)r[o].updateWorldMatrix(!1,!0)}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(s=>({boxInitialized:s.boxInitialized,boxMin:s.box.min.toArray(),boxMax:s.box.max.toArray(),sphereInitialized:s.sphereInitialized,sphereRadius:s.sphere.radius,sphereCenter:s.sphere.center.toArray()})),r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function o(s,l){return s[l.uuid]===void 0&&(s[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=o(e.geometries,this.geometry);const s=this.geometry.parameters;if(s!==void 0&&s.shapes!==void 0){const l=s.shapes;if(Array.isArray(l))for(let c=0,g=l.length;c<g;c++){const u=l[c];o(e.shapes,u)}else o(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const s=[];for(let l=0,c=this.material.length;l<c;l++)s.push(o(e.materials,this.material[l]));r.material=s}else r.material=o(e.materials,this.material);if(this.children.length>0){r.children=[];for(let s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let s=0;s<this.animations.length;s++){const l=this.animations[s];r.animations.push(o(e.animations,l))}}if(n){const s=a(e.geometries),l=a(e.materials),c=a(e.textures),g=a(e.images),u=a(e.shapes),d=a(e.skeletons),C=a(e.animations),f=a(e.nodes);s.length>0&&(i.geometries=s),l.length>0&&(i.materials=l),c.length>0&&(i.textures=c),g.length>0&&(i.images=g),u.length>0&&(i.shapes=u),d.length>0&&(i.skeletons=d),C.length>0&&(i.animations=C),f.length>0&&(i.nodes=f)}return i.object=r,i;function a(s){const l=[];for(const c in s){const g=s[c];delete g.metadata,l.push(g)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}Vn.DEFAULT_UP=new ge(0,1,0);Vn.DEFAULT_MATRIX_AUTO_UPDATE=!0;Vn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Va=new ge,Ls=new ge,yG=new ge,Ts=new ge,Gu=new ge,Bu=new ge,uN=new ge,GG=new ge,BG=new ge,SG=new ge;class zo{constructor(e=new ge,n=new ge,i=new ge){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,r){r.subVectors(i,n),Va.subVectors(e,n),r.cross(Va);const o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(e,n,i,r,o){Va.subVectors(r,n),Ls.subVectors(i,n),yG.subVectors(e,n);const a=Va.dot(Va),s=Va.dot(Ls),l=Va.dot(yG),c=Ls.dot(Ls),g=Ls.dot(yG),u=a*c-s*s;if(u===0)return o.set(0,0,0),null;const d=1/u,C=(c*l-s*g)*d,f=(a*g-s*l)*d;return o.set(1-C-f,f,C)}static containsPoint(e,n,i,r){return this.getBarycoord(e,n,i,r,Ts)===null?!1:Ts.x>=0&&Ts.y>=0&&Ts.x+Ts.y<=1}static getInterpolation(e,n,i,r,o,a,s,l){return this.getBarycoord(e,n,i,r,Ts)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(o,Ts.x),l.addScaledVector(a,Ts.y),l.addScaledVector(s,Ts.z),l)}static isFrontFacing(e,n,i,r){return Va.subVectors(i,n),Ls.subVectors(e,n),Va.cross(Ls).dot(r)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,r){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,n,i,r){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Va.subVectors(this.c,this.b),Ls.subVectors(this.a,this.b),Va.cross(Ls).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return zo.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return zo.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,i,r,o){return zo.getInterpolation(e,this.a,this.b,this.c,n,i,r,o)}containsPoint(e){return zo.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return zo.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,r=this.b,o=this.c;let a,s;Gu.subVectors(r,i),Bu.subVectors(o,i),GG.subVectors(e,i);const l=Gu.dot(GG),c=Bu.dot(GG);if(l<=0&&c<=0)return n.copy(i);BG.subVectors(e,r);const g=Gu.dot(BG),u=Bu.dot(BG);if(g>=0&&u<=g)return n.copy(r);const d=l*u-g*c;if(d<=0&&l>=0&&g<=0)return a=l/(l-g),n.copy(i).addScaledVector(Gu,a);SG.subVectors(e,o);const C=Gu.dot(SG),f=Bu.dot(SG);if(f>=0&&C<=f)return n.copy(o);const v=C*c-l*f;if(v<=0&&c>=0&&f<=0)return s=c/(c-f),n.copy(i).addScaledVector(Bu,s);const p=g*f-C*u;if(p<=0&&u-g>=0&&C-f>=0)return uN.subVectors(o,r),s=(u-g)/(u-g+(C-f)),n.copy(r).addScaledVector(uN,s);const m=1/(p+v+d);return a=v*m,s=d*m,n.copy(i).addScaledVector(Gu,a).addScaledVector(Bu,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const C9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Vl={h:0,s:0,l:0},Pm={h:0,s:0,l:0};function wG(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}class kt{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Yo){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Yn.toWorkingColorSpace(this,n),this}setRGB(e,n,i,r=Yn.workingColorSpace){return this.r=e,this.g=n,this.b=i,Yn.toWorkingColorSpace(this,r),this}setHSL(e,n,i,r=Yn.workingColorSpace){if(e=$Z(e,1),n=yi(n,0,1),i=yi(i,0,1),n===0)this.r=this.g=this.b=i;else{const o=i<=.5?i*(1+n):i+n-i*n,a=2*i-o;this.r=wG(a,o,e+1/3),this.g=wG(a,o,e),this.b=wG(a,o,e-1/3)}return Yn.toWorkingColorSpace(this,r),this}setStyle(e,n=Yo){function i(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const a=r[1],s=r[2];switch(a){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return i(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,n);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return i(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,n);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return i(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=r[1],a=o.length;if(a===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,n);if(a===6)return this.setHex(parseInt(o,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=Yo){const i=C9[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=pd(e.r),this.g=pd(e.g),this.b=pd(e.b),this}copyLinearToSRGB(e){return this.r=IG(e.r),this.g=IG(e.g),this.b=IG(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Yo){return Yn.fromWorkingColorSpace(Zr.copy(this),e),Math.round(yi(Zr.r*255,0,255))*65536+Math.round(yi(Zr.g*255,0,255))*256+Math.round(yi(Zr.b*255,0,255))}getHexString(e=Yo){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=Yn.workingColorSpace){Yn.fromWorkingColorSpace(Zr.copy(this),n);const i=Zr.r,r=Zr.g,o=Zr.b,a=Math.max(i,r,o),s=Math.min(i,r,o);let l,c;const g=(s+a)/2;if(s===a)l=0,c=0;else{const u=a-s;switch(c=g<=.5?u/(a+s):u/(2-a-s),a){case i:l=(r-o)/u+(r<o?6:0);break;case r:l=(o-i)/u+2;break;case o:l=(i-r)/u+4;break}l/=6}return e.h=l,e.s=c,e.l=g,e}getRGB(e,n=Yn.workingColorSpace){return Yn.fromWorkingColorSpace(Zr.copy(this),n),e.r=Zr.r,e.g=Zr.g,e.b=Zr.b,e}getStyle(e=Yo){Yn.fromWorkingColorSpace(Zr.copy(this),e);const n=Zr.r,i=Zr.g,r=Zr.b;return e!==Yo?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,n,i){return this.getHSL(Vl),this.setHSL(Vl.h+e,Vl.s+n,Vl.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(Vl),e.getHSL(Pm);const i=XC(Vl.h,Pm.h,n),r=XC(Vl.s,Pm.s,n),o=XC(Vl.l,Pm.l,n);return this.setHSL(i,r,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,r=this.b,o=e.elements;return this.r=o[0]*n+o[3]*i+o[6]*r,this.g=o[1]*n+o[4]*i+o[7]*r,this.b=o[2]*n+o[5]*i+o[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Zr=new kt;kt.NAMES=C9;let hne=0;class Er extends xs{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:hne++}),this.uuid=ko(),this.name="",this.type="Material",this.blending=Ag,this.side=gl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=r0,this.blendDst=o0,this.blendEquation=_l,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new kt(0,0,0),this.blendAlpha=0,this.depthFunc=Ah,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=wS,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Qc,this.stencilZFail=Qc,this.stencilZPass=Qc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const r=this[n];if(r===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Ag&&(i.blending=this.blending),this.side!==gl&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==r0&&(i.blendSrc=this.blendSrc),this.blendDst!==o0&&(i.blendDst=this.blendDst),this.blendEquation!==_l&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Ah&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==wS&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Qc&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Qc&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Qc&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(o){const a=[];for(const s in o){const l=o[s];delete l.metadata,a.push(l)}return a}if(n){const o=r(e.textures),a=r(e.images);o.length>0&&(i.textures=o),a.length>0&&(i.images=a)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const r=n.length;i=new Array(r);for(let o=0;o!==r;++o)i[o]=n[o].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class Rs extends Er{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new kt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ei,this.combine=of,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Os=fne();function fne(){const t=new ArrayBuffer(4),e=new Float32Array(t),n=new Uint32Array(t),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(i[l]=0,i[l|256]=32768,r[l]=24,r[l|256]=24):c<-14?(i[l]=1024>>-c-14,i[l|256]=1024>>-c-14|32768,r[l]=-c-1,r[l|256]=-c-1):c<=15?(i[l]=c+15<<10,i[l|256]=c+15<<10|32768,r[l]=13,r[l|256]=13):c<128?(i[l]=31744,i[l|256]=64512,r[l]=24,r[l|256]=24):(i[l]=31744,i[l|256]=64512,r[l]=13,r[l|256]=13)}const o=new Uint32Array(2048),a=new Uint32Array(64),s=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,g=0;for(;!(c&8388608);)c<<=1,g-=8388608;c&=-8388609,g+=947912704,o[l]=c|g}for(let l=1024;l<2048;++l)o[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(s[l]=1024);return{floatView:e,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:o,exponentTable:a,offsetTable:s}}function uo(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=yi(t,-65504,65504),Os.floatView[0]=t;const e=Os.uint32View[0],n=e>>23&511;return Os.baseTable[n]+((e&8388607)>>Os.shiftTable[n])}function dC(t){const e=t>>10;return Os.uint32View[0]=Os.mantissaTable[Os.offsetTable[e]+(t&1023)]+Os.exponentTable[e],Os.floatView[0]}const dg={toHalfFloat:uo,fromHalfFloat:dC},Fi=new ge,Um=new gt;class Un{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=Zh,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=hi,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return Ad("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[e+r]=n.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)Um.fromBufferAttribute(this,n),Um.applyMatrix3(e),this.setXY(n,Um.x,Um.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)Fi.fromBufferAttribute(this,n),Fi.applyMatrix3(e),this.setXYZ(n,Fi.x,Fi.y,Fi.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)Fi.fromBufferAttribute(this,n),Fi.applyMatrix4(e),this.setXYZ(n,Fi.x,Fi.y,Fi.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)Fi.fromBufferAttribute(this,n),Fi.applyNormalMatrix(e),this.setXYZ(n,Fi.x,Fi.y,Fi.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)Fi.fromBufferAttribute(this,n),Fi.transformDirection(e),this.setXYZ(n,Fi.x,Fi.y,Fi.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=Qr(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=vn(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Qr(n,this.array)),n}setX(e,n){return this.normalized&&(n=vn(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Qr(n,this.array)),n}setY(e,n){return this.normalized&&(n=vn(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Qr(n,this.array)),n}setZ(e,n){return this.normalized&&(n=vn(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Qr(n,this.array)),n}setW(e,n){return this.normalized&&(n=vn(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=vn(n,this.array),i=vn(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=vn(n,this.array),i=vn(i,this.array),r=vn(r,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,n,i,r,o){return e*=this.itemSize,this.normalized&&(n=vn(n,this.array),i=vn(i,this.array),r=vn(r,this.array),o=vn(o,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Zh&&(e.usage=this.usage),e}}class mne extends Un{constructor(e,n,i){super(new Int8Array(e),n,i)}}class Ane extends Un{constructor(e,n,i){super(new Uint8Array(e),n,i)}}class pne extends Un{constructor(e,n,i){super(new Uint8ClampedArray(e),n,i)}}class vne extends Un{constructor(e,n,i){super(new Int16Array(e),n,i)}}class e1 extends Un{constructor(e,n,i){super(new Uint16Array(e),n,i)}}class bne extends Un{constructor(e,n,i){super(new Int32Array(e),n,i)}}class t1 extends Un{constructor(e,n,i){super(new Uint32Array(e),n,i)}}class yne extends Un{constructor(e,n,i){super(new Uint16Array(e),n,i),this.isFloat16BufferAttribute=!0}getX(e){let n=dC(this.array[e*this.itemSize]);return this.normalized&&(n=Qr(n,this.array)),n}setX(e,n){return this.normalized&&(n=vn(n,this.array)),this.array[e*this.itemSize]=uo(n),this}getY(e){let n=dC(this.array[e*this.itemSize+1]);return this.normalized&&(n=Qr(n,this.array)),n}setY(e,n){return this.normalized&&(n=vn(n,this.array)),this.array[e*this.itemSize+1]=uo(n),this}getZ(e){let n=dC(this.array[e*this.itemSize+2]);return this.normalized&&(n=Qr(n,this.array)),n}setZ(e,n){return this.normalized&&(n=vn(n,this.array)),this.array[e*this.itemSize+2]=uo(n),this}getW(e){let n=dC(this.array[e*this.itemSize+3]);return this.normalized&&(n=Qr(n,this.array)),n}setW(e,n){return this.normalized&&(n=vn(n,this.array)),this.array[e*this.itemSize+3]=uo(n),this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=vn(n,this.array),i=vn(i,this.array)),this.array[e+0]=uo(n),this.array[e+1]=uo(i),this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=vn(n,this.array),i=vn(i,this.array),r=vn(r,this.array)),this.array[e+0]=uo(n),this.array[e+1]=uo(i),this.array[e+2]=uo(r),this}setXYZW(e,n,i,r,o){return e*=this.itemSize,this.normalized&&(n=vn(n,this.array),i=vn(i,this.array),r=vn(r,this.array),o=vn(o,this.array)),this.array[e+0]=uo(n),this.array[e+1]=uo(i),this.array[e+2]=uo(r),this.array[e+3]=uo(o),this}}class tn extends Un{constructor(e,n,i){super(new Float32Array(e),n,i)}}let Gne=0;const ca=new ln,ZG=new Vn,Su=new ge,Ho=new Cr,TI=new Cr,tr=new ge;class Sn extends xs{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Gne++}),this.uuid=ko(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(g9(e)?t1:e1)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const o=new mn().getNormalMatrix(e);i.applyNormalMatrix(o),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return ca.makeRotationFromQuaternion(e),this.applyMatrix4(ca),this}rotateX(e){return ca.makeRotationX(e),this.applyMatrix4(ca),this}rotateY(e){return ca.makeRotationY(e),this.applyMatrix4(ca),this}rotateZ(e){return ca.makeRotationZ(e),this.applyMatrix4(ca),this}translate(e,n,i){return ca.makeTranslation(e,n,i),this.applyMatrix4(ca),this}scale(e,n,i){return ca.makeScale(e,n,i),this.applyMatrix4(ca),this}lookAt(e){return ZG.lookAt(e),ZG.updateMatrix(),this.applyMatrix4(ZG.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Su).negate(),this.translate(Su.x,Su.y,Su.z),this}setFromPoints(e){const n=[];for(let i=0,r=e.length;i<r;i++){const o=e[i];n.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new tn(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Cr);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ge(-1/0,-1/0,-1/0),new ge(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,r=n.length;i<r;i++){const o=n[i];Ho.setFromBufferAttribute(o),this.morphTargetsRelative?(tr.addVectors(this.boundingBox.min,Ho.min),this.boundingBox.expandByPoint(tr),tr.addVectors(this.boundingBox.max,Ho.max),this.boundingBox.expandByPoint(tr)):(this.boundingBox.expandByPoint(Ho.min),this.boundingBox.expandByPoint(Ho.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new hr);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ge,1/0);return}if(e){const i=this.boundingSphere.center;if(Ho.setFromBufferAttribute(e),n)for(let o=0,a=n.length;o<a;o++){const s=n[o];TI.setFromBufferAttribute(s),this.morphTargetsRelative?(tr.addVectors(Ho.min,TI.min),Ho.expandByPoint(tr),tr.addVectors(Ho.max,TI.max),Ho.expandByPoint(tr)):(Ho.expandByPoint(TI.min),Ho.expandByPoint(TI.max))}Ho.getCenter(i);let r=0;for(let o=0,a=e.count;o<a;o++)tr.fromBufferAttribute(e,o),r=Math.max(r,i.distanceToSquared(tr));if(n)for(let o=0,a=n.length;o<a;o++){const s=n[o],l=this.morphTargetsRelative;for(let c=0,g=s.count;c<g;c++)tr.fromBufferAttribute(s,c),l&&(Su.fromBufferAttribute(e,c),tr.add(Su)),r=Math.max(r,i.distanceToSquared(tr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=n.position,r=n.normal,o=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Un(new Float32Array(4*i.count),4));const a=this.getAttribute("tangent"),s=[],l=[];for(let x=0;x<i.count;x++)s[x]=new ge,l[x]=new ge;const c=new ge,g=new ge,u=new ge,d=new gt,C=new gt,f=new gt,v=new ge,p=new ge;function m(x,R,W){c.fromBufferAttribute(i,x),g.fromBufferAttribute(i,R),u.fromBufferAttribute(i,W),d.fromBufferAttribute(o,x),C.fromBufferAttribute(o,R),f.fromBufferAttribute(o,W),g.sub(c),u.sub(c),C.sub(d),f.sub(d);const M=1/(C.x*f.y-f.x*C.y);isFinite(M)&&(v.copy(g).multiplyScalar(f.y).addScaledVector(u,-C.y).multiplyScalar(M),p.copy(u).multiplyScalar(C.x).addScaledVector(g,-f.x).multiplyScalar(M),s[x].add(v),s[R].add(v),s[W].add(v),l[x].add(p),l[R].add(p),l[W].add(p))}let A=this.groups;A.length===0&&(A=[{start:0,count:e.count}]);for(let x=0,R=A.length;x<R;++x){const W=A[x],M=W.start,N=W.count;for(let X=M,E=M+N;X<E;X+=3)m(e.getX(X+0),e.getX(X+1),e.getX(X+2))}const b=new ge,G=new ge,w=new ge,S=new ge;function Z(x){w.fromBufferAttribute(r,x),S.copy(w);const R=s[x];b.copy(R),b.sub(w.multiplyScalar(w.dot(R))).normalize(),G.crossVectors(S,R);const M=G.dot(l[x])<0?-1:1;a.setXYZW(x,b.x,b.y,b.z,M)}for(let x=0,R=A.length;x<R;++x){const W=A[x],M=W.start,N=W.count;for(let X=M,E=M+N;X<E;X+=3)Z(e.getX(X+0)),Z(e.getX(X+1)),Z(e.getX(X+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Un(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let d=0,C=i.count;d<C;d++)i.setXYZ(d,0,0,0);const r=new ge,o=new ge,a=new ge,s=new ge,l=new ge,c=new ge,g=new ge,u=new ge;if(e)for(let d=0,C=e.count;d<C;d+=3){const f=e.getX(d+0),v=e.getX(d+1),p=e.getX(d+2);r.fromBufferAttribute(n,f),o.fromBufferAttribute(n,v),a.fromBufferAttribute(n,p),g.subVectors(a,o),u.subVectors(r,o),g.cross(u),s.fromBufferAttribute(i,f),l.fromBufferAttribute(i,v),c.fromBufferAttribute(i,p),s.add(g),l.add(g),c.add(g),i.setXYZ(f,s.x,s.y,s.z),i.setXYZ(v,l.x,l.y,l.z),i.setXYZ(p,c.x,c.y,c.z)}else for(let d=0,C=n.count;d<C;d+=3)r.fromBufferAttribute(n,d+0),o.fromBufferAttribute(n,d+1),a.fromBufferAttribute(n,d+2),g.subVectors(a,o),u.subVectors(r,o),g.cross(u),i.setXYZ(d+0,g.x,g.y,g.z),i.setXYZ(d+1,g.x,g.y,g.z),i.setXYZ(d+2,g.x,g.y,g.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)tr.fromBufferAttribute(e,n),tr.normalize(),e.setXYZ(n,tr.x,tr.y,tr.z)}toNonIndexed(){function e(s,l){const c=s.array,g=s.itemSize,u=s.normalized,d=new c.constructor(l.length*g);let C=0,f=0;for(let v=0,p=l.length;v<p;v++){s.isInterleavedBufferAttribute?C=l[v]*s.data.stride+s.offset:C=l[v]*g;for(let m=0;m<g;m++)d[f++]=c[C++]}return new Un(d,g,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new Sn,i=this.index.array,r=this.attributes;for(const s in r){const l=r[s],c=e(l,i);n.setAttribute(s,c)}const o=this.morphAttributes;for(const s in o){const l=[],c=o[s];for(let g=0,u=c.length;g<u;g++){const d=c[g],C=e(d,i);l.push(C)}n.morphAttributes[s]=l}n.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let s=0,l=a.length;s<l;s++){const c=a[s];n.addGroup(c.start,c.count,c.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const l in i){const c=i[l];e.data.attributes[l]=c.toJSON(e.data)}const r={};let o=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],g=[];for(let u=0,d=c.length;u<d;u++){const C=c[u];g.push(C.toJSON(e.data))}g.length>0&&(r[l]=g,o=!0)}o&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const s=this.boundingSphere;return s!==null&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(n));const r=e.attributes;for(const c in r){const g=r[c];this.setAttribute(c,g.clone(n))}const o=e.morphAttributes;for(const c in o){const g=[],u=o[c];for(let d=0,C=u.length;d<C;d++)g.push(u[d].clone(n));this.morphAttributes[c]=g}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let c=0,g=a.length;c<g;c++){const u=a[c];this.addGroup(u.start,u.count,u.materialIndex)}const s=e.boundingBox;s!==null&&(this.boundingBox=s.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const dN=new ln,Hc=new kg,Dm=new hr,IN=new ge,wu=new ge,Zu=new ge,xu=new ge,xG=new ge,Om=new ge,Jm=new gt,Qm=new gt,jm=new gt,CN=new ge,hN=new ge,fN=new ge,$m=new ge,qm=new ge;class ti extends Vn{constructor(e=new Sn,n=new Rs){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=r.length;o<a;o++){const s=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=o}}}}getVertexPosition(e,n){const i=this.geometry,r=i.attributes.position,o=i.morphAttributes.position,a=i.morphTargetsRelative;n.fromBufferAttribute(r,e);const s=this.morphTargetInfluences;if(o&&s){Om.set(0,0,0);for(let l=0,c=o.length;l<c;l++){const g=s[l],u=o[l];g!==0&&(xG.fromBufferAttribute(u,e),a?Om.addScaledVector(xG,g):Om.addScaledVector(xG.sub(n),g))}n.add(Om)}return n}raycast(e,n){const i=this.geometry,r=this.material,o=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Dm.copy(i.boundingSphere),Dm.applyMatrix4(o),Hc.copy(e.ray).recast(e.near),!(Dm.containsPoint(Hc.origin)===!1&&(Hc.intersectSphere(Dm,IN)===null||Hc.origin.distanceToSquared(IN)>(e.far-e.near)**2))&&(dN.copy(o).invert(),Hc.copy(e.ray).applyMatrix4(dN),!(i.boundingBox!==null&&Hc.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,Hc)))}_computeIntersections(e,n,i){let r;const o=this.geometry,a=this.material,s=o.index,l=o.attributes.position,c=o.attributes.uv,g=o.attributes.uv1,u=o.attributes.normal,d=o.groups,C=o.drawRange;if(s!==null)if(Array.isArray(a))for(let f=0,v=d.length;f<v;f++){const p=d[f],m=a[p.materialIndex],A=Math.max(p.start,C.start),b=Math.min(s.count,Math.min(p.start+p.count,C.start+C.count));for(let G=A,w=b;G<w;G+=3){const S=s.getX(G),Z=s.getX(G+1),x=s.getX(G+2);r=eA(this,m,e,i,c,g,u,S,Z,x),r&&(r.faceIndex=Math.floor(G/3),r.face.materialIndex=p.materialIndex,n.push(r))}}else{const f=Math.max(0,C.start),v=Math.min(s.count,C.start+C.count);for(let p=f,m=v;p<m;p+=3){const A=s.getX(p),b=s.getX(p+1),G=s.getX(p+2);r=eA(this,a,e,i,c,g,u,A,b,G),r&&(r.faceIndex=Math.floor(p/3),n.push(r))}}else if(l!==void 0)if(Array.isArray(a))for(let f=0,v=d.length;f<v;f++){const p=d[f],m=a[p.materialIndex],A=Math.max(p.start,C.start),b=Math.min(l.count,Math.min(p.start+p.count,C.start+C.count));for(let G=A,w=b;G<w;G+=3){const S=G,Z=G+1,x=G+2;r=eA(this,m,e,i,c,g,u,S,Z,x),r&&(r.faceIndex=Math.floor(G/3),r.face.materialIndex=p.materialIndex,n.push(r))}}else{const f=Math.max(0,C.start),v=Math.min(l.count,C.start+C.count);for(let p=f,m=v;p<m;p+=3){const A=p,b=p+1,G=p+2;r=eA(this,a,e,i,c,g,u,A,b,G),r&&(r.faceIndex=Math.floor(p/3),n.push(r))}}}}function Bne(t,e,n,i,r,o,a,s){let l;if(e.side===qr?l=i.intersectTriangle(a,o,r,!0,s):l=i.intersectTriangle(r,o,a,e.side===gl,s),l===null)return null;qm.copy(s),qm.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(qm);return c<n.near||c>n.far?null:{distance:c,point:qm.clone(),object:t}}function eA(t,e,n,i,r,o,a,s,l,c){t.getVertexPosition(s,wu),t.getVertexPosition(l,Zu),t.getVertexPosition(c,xu);const g=Bne(t,e,n,i,wu,Zu,xu,$m);if(g){r&&(Jm.fromBufferAttribute(r,s),Qm.fromBufferAttribute(r,l),jm.fromBufferAttribute(r,c),g.uv=zo.getInterpolation($m,wu,Zu,xu,Jm,Qm,jm,new gt)),o&&(Jm.fromBufferAttribute(o,s),Qm.fromBufferAttribute(o,l),jm.fromBufferAttribute(o,c),g.uv1=zo.getInterpolation($m,wu,Zu,xu,Jm,Qm,jm,new gt)),a&&(CN.fromBufferAttribute(a,s),hN.fromBufferAttribute(a,l),fN.fromBufferAttribute(a,c),g.normal=zo.getInterpolation($m,wu,Zu,xu,CN,hN,fN,new ge),g.normal.dot(i.direction)>0&&g.normal.multiplyScalar(-1));const u={a:s,b:l,c,normal:new ge,materialIndex:0};zo.getNormal(wu,Zu,xu,u.normal),g.face=u}return g}class Pg extends Sn{constructor(e=1,n=1,i=1,r=1,o=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:r,heightSegments:o,depthSegments:a};const s=this;r=Math.floor(r),o=Math.floor(o),a=Math.floor(a);const l=[],c=[],g=[],u=[];let d=0,C=0;f("z","y","x",-1,-1,i,n,e,a,o,0),f("z","y","x",1,-1,i,n,-e,a,o,1),f("x","z","y",1,1,e,i,n,r,a,2),f("x","z","y",1,-1,e,i,-n,r,a,3),f("x","y","z",1,-1,e,n,i,r,o,4),f("x","y","z",-1,-1,e,n,-i,r,o,5),this.setIndex(l),this.setAttribute("position",new tn(c,3)),this.setAttribute("normal",new tn(g,3)),this.setAttribute("uv",new tn(u,2));function f(v,p,m,A,b,G,w,S,Z,x,R){const W=G/Z,M=w/x,N=G/2,X=w/2,E=S/2,Q=Z+1,k=x+1;let J=0,F=0;const L=new ge;for(let z=0;z<k;z++){const K=z*M-X;for(let O=0;O<Q;O++){const j=O*W-N;L[v]=j*A,L[p]=K*b,L[m]=E,c.push(L.x,L.y,L.z),L[v]=0,L[p]=0,L[m]=S>0?1:-1,g.push(L.x,L.y,L.z),u.push(O/Z),u.push(1-z/x),J+=1}}for(let z=0;z<x;z++)for(let K=0;K<Z;K++){const O=d+K+Q*z,j=d+K+Q*(z+1),P=d+(K+1)+Q*(z+1),$=d+(K+1)+Q*z;l.push(O,j,$),l.push(j,P,$),F+=6}s.addGroup(C,F,R),C+=F,d+=J}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Pg(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function kd(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function Pr(t){const e={};for(let n=0;n<t.length;n++){const i=kd(t[n]);for(const r in i)e[r]=i[r]}return e}function Sne(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function h9(t){const e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Yn.workingColorSpace}const n1={clone:kd,merge:Pr};var wne=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Zne=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class bo extends Er{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=wne,this.fragmentShader=Zne,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=kd(e.uniforms),this.uniformsGroups=Sne(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;a&&a.isTexture?n.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?n.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?n.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?n.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?n.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?n.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?n.uniforms[r]={type:"m4",value:a.toArray()}:n.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}class gf extends Vn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ln,this.projectionMatrix=new ln,this.projectionMatrixInverse=new ln,this.coordinateSystem=As}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Ml=new ge,mN=new gt,AN=new gt;class Ri extends gf{constructor(e=50,n=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=_d*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(vg*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return _d*2*Math.atan(Math.tan(vg*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,i){Ml.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Ml.x,Ml.y).multiplyScalar(-e/Ml.z),Ml.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Ml.x,Ml.y).multiplyScalar(-e/Ml.z)}getViewSize(e,n){return this.getViewBounds(e,mN,AN),n.subVectors(AN,mN)}setViewOffset(e,n,i,r,o,a){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(vg*.5*this.fov)/this.zoom,i=2*n,r=this.aspect*i,o=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const l=a.fullWidth,c=a.fullHeight;o+=a.offsetX*r/l,n-=a.offsetY*i/c,r*=a.width/l,i*=a.height/c}const s=this.filmOffset;s!==0&&(o+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,n,n-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const Ru=-90,Wu=1;class f9 extends Vn{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Ri(Ru,Wu,e,n);r.layers=this.layers,this.add(r);const o=new Ri(Ru,Wu,e,n);o.layers=this.layers,this.add(o);const a=new Ri(Ru,Wu,e,n);a.layers=this.layers,this.add(a);const s=new Ri(Ru,Wu,e,n);s.layers=this.layers,this.add(s);const l=new Ri(Ru,Wu,e,n);l.layers=this.layers,this.add(l);const c=new Ri(Ru,Wu,e,n);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[i,r,o,a,s,l]=n;for(const c of n)this.remove(c);if(e===As)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===xh)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of n)this.add(c),c.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[o,a,s,l,c,g]=this.children,u=e.getRenderTarget(),d=e.getActiveCubeFace(),C=e.getActiveMipmapLevel(),f=e.xr.enabled;e.xr.enabled=!1;const v=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(n,o),e.setRenderTarget(i,1,r),e.render(n,a),e.setRenderTarget(i,2,r),e.render(n,s),e.setRenderTarget(i,3,r),e.render(n,l),e.setRenderTarget(i,4,r),e.render(n,c),i.texture.generateMipmaps=v,e.setRenderTarget(i,5,r),e.render(n,g),e.setRenderTarget(u,d,C),e.xr.enabled=f,i.texture.needsPMREMUpdate=!0}}class uf extends Tn{constructor(e,n,i,r,o,a,s,l,c,g){e=e!==void 0?e:[],n=n!==void 0?n:Ss,super(e,n,i,r,o,a,s,l,c,g),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class i1 extends Do{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new uf(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:Kn}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Pg(5,5,5),o=new bo({name:"CubemapFromEquirect",uniforms:kd(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:qr,blending:ys});o.uniforms.tEquirect.value=n;const a=new ti(r,o),s=n.minFilter;return n.minFilter===ms&&(n.minFilter=Kn),new f9(1,10,this).update(e,a),n.minFilter=s,a.geometry.dispose(),a.material.dispose(),this}clear(e,n,i,r){const o=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(n,i,r);e.setRenderTarget(o)}}const RG=new ge,xne=new ge,Rne=new mn;let Us=class{constructor(e=new ge(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,r){return this.normal.set(e,n,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const r=RG.subVectors(i,n).cross(xne.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(RG),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:n.copy(e.start).addScaledVector(i,o)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||Rne.getNormalMatrix(e),r=this.coplanarPoint(RG).applyMatrix4(e),o=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};const Xc=new hr,tA=new ge;class df{constructor(e=new Us,n=new Us,i=new Us,r=new Us,o=new Us,a=new Us){this.planes=[e,n,i,r,o,a]}set(e,n,i,r,o,a){const s=this.planes;return s[0].copy(e),s[1].copy(n),s[2].copy(i),s[3].copy(r),s[4].copy(o),s[5].copy(a),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,n=As){const i=this.planes,r=e.elements,o=r[0],a=r[1],s=r[2],l=r[3],c=r[4],g=r[5],u=r[6],d=r[7],C=r[8],f=r[9],v=r[10],p=r[11],m=r[12],A=r[13],b=r[14],G=r[15];if(i[0].setComponents(l-o,d-c,p-C,G-m).normalize(),i[1].setComponents(l+o,d+c,p+C,G+m).normalize(),i[2].setComponents(l+a,d+g,p+f,G+A).normalize(),i[3].setComponents(l-a,d-g,p-f,G-A).normalize(),i[4].setComponents(l-s,d-u,p-v,G-b).normalize(),n===As)i[5].setComponents(l+s,d+u,p+v,G+b).normalize();else if(n===xh)i[5].setComponents(s,u,v,b).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Xc.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),Xc.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Xc)}intersectsSprite(e){return Xc.center.set(0,0,0),Xc.radius=.7071067811865476,Xc.applyMatrix4(e.matrixWorld),this.intersectsSphere(Xc)}intersectsSphere(e){const n=this.planes,i=e.center,r=-e.radius;for(let o=0;o<6;o++)if(n[o].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const r=n[i];if(tA.x=r.normal.x>0?e.max.x:e.min.x,tA.y=r.normal.y>0?e.max.y:e.min.y,tA.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(tA)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function m9(){let t=null,e=!1,n=null,i=null;function r(o,a){n(o,a),i=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&n!==null&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(o){n=o},setContext:function(o){t=o}}}function Wne(t){const e=new WeakMap;function n(s,l){const c=s.array,g=s.usage,u=c.byteLength,d=t.createBuffer();t.bindBuffer(l,d),t.bufferData(l,c,g),s.onUploadCallback();let C;if(c instanceof Float32Array)C=t.FLOAT;else if(c instanceof Uint16Array)s.isFloat16BufferAttribute?C=t.HALF_FLOAT:C=t.UNSIGNED_SHORT;else if(c instanceof Int16Array)C=t.SHORT;else if(c instanceof Uint32Array)C=t.UNSIGNED_INT;else if(c instanceof Int32Array)C=t.INT;else if(c instanceof Int8Array)C=t.BYTE;else if(c instanceof Uint8Array)C=t.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)C=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:d,type:C,bytesPerElement:c.BYTES_PER_ELEMENT,version:s.version,size:u}}function i(s,l,c){const g=l.array,u=l._updateRange,d=l.updateRanges;if(t.bindBuffer(c,s),u.count===-1&&d.length===0&&t.bufferSubData(c,0,g),d.length!==0){for(let C=0,f=d.length;C<f;C++){const v=d[C];t.bufferSubData(c,v.start*g.BYTES_PER_ELEMENT,g,v.start,v.count)}l.clearUpdateRanges()}u.count!==-1&&(t.bufferSubData(c,u.offset*g.BYTES_PER_ELEMENT,g,u.offset,u.count),u.count=-1),l.onUploadCallback()}function r(s){return s.isInterleavedBufferAttribute&&(s=s.data),e.get(s)}function o(s){s.isInterleavedBufferAttribute&&(s=s.data);const l=e.get(s);l&&(t.deleteBuffer(l.buffer),e.delete(s))}function a(s,l){if(s.isInterleavedBufferAttribute&&(s=s.data),s.isGLBufferAttribute){const g=e.get(s);(!g||g.version<s.version)&&e.set(s,{buffer:s.buffer,type:s.type,bytesPerElement:s.elementSize,version:s.version});return}const c=e.get(s);if(c===void 0)e.set(s,n(s,l));else if(c.version<s.version){if(c.size!==s.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(c.buffer,s,l),c.version=s.version}}return{get:r,remove:o,update:a}}class qa extends Sn{constructor(e=1,n=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:r};const o=e/2,a=n/2,s=Math.floor(i),l=Math.floor(r),c=s+1,g=l+1,u=e/s,d=n/l,C=[],f=[],v=[],p=[];for(let m=0;m<g;m++){const A=m*d-a;for(let b=0;b<c;b++){const G=b*u-o;f.push(G,-A,0),v.push(0,0,1),p.push(b/s),p.push(1-m/l)}}for(let m=0;m<l;m++)for(let A=0;A<s;A++){const b=A+c*m,G=A+c*(m+1),w=A+1+c*(m+1),S=A+1+c*m;C.push(b,G,S),C.push(G,w,S)}this.setIndex(C),this.setAttribute("position",new tn(f,3)),this.setAttribute("normal",new tn(v,3)),this.setAttribute("uv",new tn(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new qa(e.width,e.height,e.widthSegments,e.heightSegments)}}var Vne=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Mne=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Nne=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,Fne=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Hne=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,Xne=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Ene=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Yne=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,zne=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,Kne=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,Lne=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,Tne=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,_ne=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,kne=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Pne=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Une=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,Dne=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,One=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Jne=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Qne=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,jne=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,$ne=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,qne=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,eie=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,tie=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,nie=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,iie=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,rie=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,oie=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,aie=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,sie="gl_FragColor = linearToOutputTexel( gl_FragColor );",lie=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,cie=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,gie=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,uie=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,die=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Iie=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Cie=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,hie=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fie=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,mie=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Aie=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,pie=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,vie=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,bie=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,yie=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Gie=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Bie=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Sie=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,wie=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Zie=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,xie=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,Rie=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Wie=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Vie=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Mie=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Nie=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Fie=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Hie=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Xie=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,Eie=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Yie=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,zie=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Kie=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Lie=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Tie=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,_ie=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,kie=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Pie=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Uie=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,Die=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Oie=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Jie=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Qie=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,jie=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,$ie=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,qie=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,ere=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,tre=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,nre=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,ire=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,rre=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,ore=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,are=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,sre=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,lre=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,cre=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,gre=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,ure=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,dre=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,Ire=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Cre=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,hre=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,fre=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,mre=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Are=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,pre=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,vre=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,bre=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,yre=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Gre=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Bre=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Sre=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,wre=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Zre=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,xre=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Rre=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Wre=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Vre=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Mre=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Nre=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Fre=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Hre=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Xre=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Ere=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,Yre=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,zre=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Kre=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Lre=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Tre=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,_re=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,kre=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Pre=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ure=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Dre=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ore=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Jre=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Qre=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,jre=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,$re=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,qre=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,eoe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,toe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,noe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ioe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,roe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,ooe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,aoe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,soe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,loe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,coe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,pn={alphahash_fragment:Vne,alphahash_pars_fragment:Mne,alphamap_fragment:Nne,alphamap_pars_fragment:Fne,alphatest_fragment:Hne,alphatest_pars_fragment:Xne,aomap_fragment:Ene,aomap_pars_fragment:Yne,batching_pars_vertex:zne,batching_vertex:Kne,begin_vertex:Lne,beginnormal_vertex:Tne,bsdfs:_ne,iridescence_fragment:kne,bumpmap_pars_fragment:Pne,clipping_planes_fragment:Une,clipping_planes_pars_fragment:Dne,clipping_planes_pars_vertex:One,clipping_planes_vertex:Jne,color_fragment:Qne,color_pars_fragment:jne,color_pars_vertex:$ne,color_vertex:qne,common:eie,cube_uv_reflection_fragment:tie,defaultnormal_vertex:nie,displacementmap_pars_vertex:iie,displacementmap_vertex:rie,emissivemap_fragment:oie,emissivemap_pars_fragment:aie,colorspace_fragment:sie,colorspace_pars_fragment:lie,envmap_fragment:cie,envmap_common_pars_fragment:gie,envmap_pars_fragment:uie,envmap_pars_vertex:die,envmap_physical_pars_fragment:Gie,envmap_vertex:Iie,fog_vertex:Cie,fog_pars_vertex:hie,fog_fragment:fie,fog_pars_fragment:mie,gradientmap_pars_fragment:Aie,lightmap_pars_fragment:pie,lights_lambert_fragment:vie,lights_lambert_pars_fragment:bie,lights_pars_begin:yie,lights_toon_fragment:Bie,lights_toon_pars_fragment:Sie,lights_phong_fragment:wie,lights_phong_pars_fragment:Zie,lights_physical_fragment:xie,lights_physical_pars_fragment:Rie,lights_fragment_begin:Wie,lights_fragment_maps:Vie,lights_fragment_end:Mie,logdepthbuf_fragment:Nie,logdepthbuf_pars_fragment:Fie,logdepthbuf_pars_vertex:Hie,logdepthbuf_vertex:Xie,map_fragment:Eie,map_pars_fragment:Yie,map_particle_fragment:zie,map_particle_pars_fragment:Kie,metalnessmap_fragment:Lie,metalnessmap_pars_fragment:Tie,morphinstance_vertex:_ie,morphcolor_vertex:kie,morphnormal_vertex:Pie,morphtarget_pars_vertex:Uie,morphtarget_vertex:Die,normal_fragment_begin:Oie,normal_fragment_maps:Jie,normal_pars_fragment:Qie,normal_pars_vertex:jie,normal_vertex:$ie,normalmap_pars_fragment:qie,clearcoat_normal_fragment_begin:ere,clearcoat_normal_fragment_maps:tre,clearcoat_pars_fragment:nre,iridescence_pars_fragment:ire,opaque_fragment:rre,packing:ore,premultiplied_alpha_fragment:are,project_vertex:sre,dithering_fragment:lre,dithering_pars_fragment:cre,roughnessmap_fragment:gre,roughnessmap_pars_fragment:ure,shadowmap_pars_fragment:dre,shadowmap_pars_vertex:Ire,shadowmap_vertex:Cre,shadowmask_pars_fragment:hre,skinbase_vertex:fre,skinning_pars_vertex:mre,skinning_vertex:Are,skinnormal_vertex:pre,specularmap_fragment:vre,specularmap_pars_fragment:bre,tonemapping_fragment:yre,tonemapping_pars_fragment:Gre,transmission_fragment:Bre,transmission_pars_fragment:Sre,uv_pars_fragment:wre,uv_pars_vertex:Zre,uv_vertex:xre,worldpos_vertex:Rre,background_vert:Wre,background_frag:Vre,backgroundCube_vert:Mre,backgroundCube_frag:Nre,cube_vert:Fre,cube_frag:Hre,depth_vert:Xre,depth_frag:Ere,distanceRGBA_vert:Yre,distanceRGBA_frag:zre,equirect_vert:Kre,equirect_frag:Lre,linedashed_vert:Tre,linedashed_frag:_re,meshbasic_vert:kre,meshbasic_frag:Pre,meshlambert_vert:Ure,meshlambert_frag:Dre,meshmatcap_vert:Ore,meshmatcap_frag:Jre,meshnormal_vert:Qre,meshnormal_frag:jre,meshphong_vert:$re,meshphong_frag:qre,meshphysical_vert:eoe,meshphysical_frag:toe,meshtoon_vert:noe,meshtoon_frag:ioe,points_vert:roe,points_frag:ooe,shadow_vert:aoe,shadow_frag:soe,sprite_vert:loe,sprite_frag:coe},Kt={common:{diffuse:{value:new kt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new mn},alphaMap:{value:null},alphaMapTransform:{value:new mn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new mn}},envmap:{envMap:{value:null},envMapRotation:{value:new mn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new mn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new mn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new mn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new mn},normalScale:{value:new gt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new mn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new mn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new mn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new mn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new kt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new kt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new mn},alphaTest:{value:0},uvTransform:{value:new mn}},sprite:{diffuse:{value:new kt(16777215)},opacity:{value:1},center:{value:new gt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new mn},alphaMap:{value:null},alphaMapTransform:{value:new mn},alphaTest:{value:0}}},Ta={basic:{uniforms:Pr([Kt.common,Kt.specularmap,Kt.envmap,Kt.aomap,Kt.lightmap,Kt.fog]),vertexShader:pn.meshbasic_vert,fragmentShader:pn.meshbasic_frag},lambert:{uniforms:Pr([Kt.common,Kt.specularmap,Kt.envmap,Kt.aomap,Kt.lightmap,Kt.emissivemap,Kt.bumpmap,Kt.normalmap,Kt.displacementmap,Kt.fog,Kt.lights,{emissive:{value:new kt(0)}}]),vertexShader:pn.meshlambert_vert,fragmentShader:pn.meshlambert_frag},phong:{uniforms:Pr([Kt.common,Kt.specularmap,Kt.envmap,Kt.aomap,Kt.lightmap,Kt.emissivemap,Kt.bumpmap,Kt.normalmap,Kt.displacementmap,Kt.fog,Kt.lights,{emissive:{value:new kt(0)},specular:{value:new kt(1118481)},shininess:{value:30}}]),vertexShader:pn.meshphong_vert,fragmentShader:pn.meshphong_frag},standard:{uniforms:Pr([Kt.common,Kt.envmap,Kt.aomap,Kt.lightmap,Kt.emissivemap,Kt.bumpmap,Kt.normalmap,Kt.displacementmap,Kt.roughnessmap,Kt.metalnessmap,Kt.fog,Kt.lights,{emissive:{value:new kt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:pn.meshphysical_vert,fragmentShader:pn.meshphysical_frag},toon:{uniforms:Pr([Kt.common,Kt.aomap,Kt.lightmap,Kt.emissivemap,Kt.bumpmap,Kt.normalmap,Kt.displacementmap,Kt.gradientmap,Kt.fog,Kt.lights,{emissive:{value:new kt(0)}}]),vertexShader:pn.meshtoon_vert,fragmentShader:pn.meshtoon_frag},matcap:{uniforms:Pr([Kt.common,Kt.bumpmap,Kt.normalmap,Kt.displacementmap,Kt.fog,{matcap:{value:null}}]),vertexShader:pn.meshmatcap_vert,fragmentShader:pn.meshmatcap_frag},points:{uniforms:Pr([Kt.points,Kt.fog]),vertexShader:pn.points_vert,fragmentShader:pn.points_frag},dashed:{uniforms:Pr([Kt.common,Kt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:pn.linedashed_vert,fragmentShader:pn.linedashed_frag},depth:{uniforms:Pr([Kt.common,Kt.displacementmap]),vertexShader:pn.depth_vert,fragmentShader:pn.depth_frag},normal:{uniforms:Pr([Kt.common,Kt.bumpmap,Kt.normalmap,Kt.displacementmap,{opacity:{value:1}}]),vertexShader:pn.meshnormal_vert,fragmentShader:pn.meshnormal_frag},sprite:{uniforms:Pr([Kt.sprite,Kt.fog]),vertexShader:pn.sprite_vert,fragmentShader:pn.sprite_frag},background:{uniforms:{uvTransform:{value:new mn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:pn.background_vert,fragmentShader:pn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new mn}},vertexShader:pn.backgroundCube_vert,fragmentShader:pn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:pn.cube_vert,fragmentShader:pn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:pn.equirect_vert,fragmentShader:pn.equirect_frag},distanceRGBA:{uniforms:Pr([Kt.common,Kt.displacementmap,{referencePosition:{value:new ge},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:pn.distanceRGBA_vert,fragmentShader:pn.distanceRGBA_frag},shadow:{uniforms:Pr([Kt.lights,Kt.fog,{color:{value:new kt(0)},opacity:{value:1}}]),vertexShader:pn.shadow_vert,fragmentShader:pn.shadow_frag}};Ta.physical={uniforms:Pr([Ta.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new mn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new mn},clearcoatNormalScale:{value:new gt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new mn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new mn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new mn},sheen:{value:0},sheenColor:{value:new kt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new mn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new mn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new mn},transmissionSamplerSize:{value:new gt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new mn},attenuationDistance:{value:0},attenuationColor:{value:new kt(0)},specularColor:{value:new kt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new mn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new mn},anisotropyVector:{value:new gt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new mn}}]),vertexShader:pn.meshphysical_vert,fragmentShader:pn.meshphysical_frag};const nA={r:0,b:0,g:0},Ec=new Ei,goe=new ln;function uoe(t,e,n,i,r,o,a){const s=new kt(0);let l=o===!0?0:1,c,g,u=null,d=0,C=null;function f(A){let b=A.isScene===!0?A.background:null;return b&&b.isTexture&&(b=(A.backgroundBlurriness>0?n:e).get(b)),b}function v(A){let b=!1;const G=f(A);G===null?m(s,l):G&&G.isColor&&(m(G,1),b=!0);const w=t.xr.getEnvironmentBlendMode();w==="additive"?i.buffers.color.setClear(0,0,0,1,a):w==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,a),(t.autoClear||b)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}function p(A,b){const G=f(b);G&&(G.isCubeTexture||G.mapping===eI)?(g===void 0&&(g=new ti(new Pg(1,1,1),new bo({name:"BackgroundCubeMaterial",uniforms:kd(Ta.backgroundCube.uniforms),vertexShader:Ta.backgroundCube.vertexShader,fragmentShader:Ta.backgroundCube.fragmentShader,side:qr,depthTest:!1,depthWrite:!1,fog:!1})),g.geometry.deleteAttribute("normal"),g.geometry.deleteAttribute("uv"),g.onBeforeRender=function(w,S,Z){this.matrixWorld.copyPosition(Z.matrixWorld)},Object.defineProperty(g.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(g)),Ec.copy(b.backgroundRotation),Ec.x*=-1,Ec.y*=-1,Ec.z*=-1,G.isCubeTexture&&G.isRenderTargetTexture===!1&&(Ec.y*=-1,Ec.z*=-1),g.material.uniforms.envMap.value=G,g.material.uniforms.flipEnvMap.value=G.isCubeTexture&&G.isRenderTargetTexture===!1?-1:1,g.material.uniforms.backgroundBlurriness.value=b.backgroundBlurriness,g.material.uniforms.backgroundIntensity.value=b.backgroundIntensity,g.material.uniforms.backgroundRotation.value.setFromMatrix4(goe.makeRotationFromEuler(Ec)),g.material.toneMapped=Yn.getTransfer(G.colorSpace)!==jn,(u!==G||d!==G.version||C!==t.toneMapping)&&(g.material.needsUpdate=!0,u=G,d=G.version,C=t.toneMapping),g.layers.enableAll(),A.unshift(g,g.geometry,g.material,0,0,null)):G&&G.isTexture&&(c===void 0&&(c=new ti(new qa(2,2),new bo({name:"BackgroundMaterial",uniforms:kd(Ta.background.uniforms),vertexShader:Ta.background.vertexShader,fragmentShader:Ta.background.fragmentShader,side:gl,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=G,c.material.uniforms.backgroundIntensity.value=b.backgroundIntensity,c.material.toneMapped=Yn.getTransfer(G.colorSpace)!==jn,G.matrixAutoUpdate===!0&&G.updateMatrix(),c.material.uniforms.uvTransform.value.copy(G.matrix),(u!==G||d!==G.version||C!==t.toneMapping)&&(c.material.needsUpdate=!0,u=G,d=G.version,C=t.toneMapping),c.layers.enableAll(),A.unshift(c,c.geometry,c.material,0,0,null))}function m(A,b){A.getRGB(nA,h9(t)),i.buffers.color.setClear(nA.r,nA.g,nA.b,b,a)}return{getClearColor:function(){return s},setClearColor:function(A,b=1){s.set(A),l=b,m(s,l)},getClearAlpha:function(){return l},setClearAlpha:function(A){l=A,m(s,l)},render:v,addToRenderList:p}}function doe(t,e){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),i={},r=d(null);let o=r,a=!1;function s(W,M,N,X,E){let Q=!1;const k=u(X,N,M);o!==k&&(o=k,c(o.object)),Q=C(W,X,N,E),Q&&f(W,X,N,E),E!==null&&e.update(E,t.ELEMENT_ARRAY_BUFFER),(Q||a)&&(a=!1,G(W,M,N,X),E!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(E).buffer))}function l(){return t.createVertexArray()}function c(W){return t.bindVertexArray(W)}function g(W){return t.deleteVertexArray(W)}function u(W,M,N){const X=N.wireframe===!0;let E=i[W.id];E===void 0&&(E={},i[W.id]=E);let Q=E[M.id];Q===void 0&&(Q={},E[M.id]=Q);let k=Q[X];return k===void 0&&(k=d(l()),Q[X]=k),k}function d(W){const M=[],N=[],X=[];for(let E=0;E<n;E++)M[E]=0,N[E]=0,X[E]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:M,enabledAttributes:N,attributeDivisors:X,object:W,attributes:{},index:null}}function C(W,M,N,X){const E=o.attributes,Q=M.attributes;let k=0;const J=N.getAttributes();for(const F in J)if(J[F].location>=0){const z=E[F];let K=Q[F];if(K===void 0&&(F==="instanceMatrix"&&W.instanceMatrix&&(K=W.instanceMatrix),F==="instanceColor"&&W.instanceColor&&(K=W.instanceColor)),z===void 0||z.attribute!==K||K&&z.data!==K.data)return!0;k++}return o.attributesNum!==k||o.index!==X}function f(W,M,N,X){const E={},Q=M.attributes;let k=0;const J=N.getAttributes();for(const F in J)if(J[F].location>=0){let z=Q[F];z===void 0&&(F==="instanceMatrix"&&W.instanceMatrix&&(z=W.instanceMatrix),F==="instanceColor"&&W.instanceColor&&(z=W.instanceColor));const K={};K.attribute=z,z&&z.data&&(K.data=z.data),E[F]=K,k++}o.attributes=E,o.attributesNum=k,o.index=X}function v(){const W=o.newAttributes;for(let M=0,N=W.length;M<N;M++)W[M]=0}function p(W){m(W,0)}function m(W,M){const N=o.newAttributes,X=o.enabledAttributes,E=o.attributeDivisors;N[W]=1,X[W]===0&&(t.enableVertexAttribArray(W),X[W]=1),E[W]!==M&&(t.vertexAttribDivisor(W,M),E[W]=M)}function A(){const W=o.newAttributes,M=o.enabledAttributes;for(let N=0,X=M.length;N<X;N++)M[N]!==W[N]&&(t.disableVertexAttribArray(N),M[N]=0)}function b(W,M,N,X,E,Q,k){k===!0?t.vertexAttribIPointer(W,M,N,E,Q):t.vertexAttribPointer(W,M,N,X,E,Q)}function G(W,M,N,X){v();const E=X.attributes,Q=N.getAttributes(),k=M.defaultAttributeValues;for(const J in Q){const F=Q[J];if(F.location>=0){let L=E[J];if(L===void 0&&(J==="instanceMatrix"&&W.instanceMatrix&&(L=W.instanceMatrix),J==="instanceColor"&&W.instanceColor&&(L=W.instanceColor)),L!==void 0){const z=L.normalized,K=L.itemSize,O=e.get(L);if(O===void 0)continue;const j=O.buffer,P=O.type,$=O.bytesPerElement,oe=P===t.INT||P===t.UNSIGNED_INT||L.gpuType===af;if(L.isInterleavedBufferAttribute){const ie=L.data,de=ie.stride,Ve=L.offset;if(ie.isInstancedInterleavedBuffer){for(let Se=0;Se<F.locationSize;Se++)m(F.location+Se,ie.meshPerAttribute);W.isInstancedMesh!==!0&&X._maxInstanceCount===void 0&&(X._maxInstanceCount=ie.meshPerAttribute*ie.count)}else for(let Se=0;Se<F.locationSize;Se++)p(F.location+Se);t.bindBuffer(t.ARRAY_BUFFER,j);for(let Se=0;Se<F.locationSize;Se++)b(F.location+Se,K/F.locationSize,P,z,de*$,(Ve+K/F.locationSize*Se)*$,oe)}else{if(L.isInstancedBufferAttribute){for(let ie=0;ie<F.locationSize;ie++)m(F.location+ie,L.meshPerAttribute);W.isInstancedMesh!==!0&&X._maxInstanceCount===void 0&&(X._maxInstanceCount=L.meshPerAttribute*L.count)}else for(let ie=0;ie<F.locationSize;ie++)p(F.location+ie);t.bindBuffer(t.ARRAY_BUFFER,j);for(let ie=0;ie<F.locationSize;ie++)b(F.location+ie,K/F.locationSize,P,z,K*$,K/F.locationSize*ie*$,oe)}}else if(k!==void 0){const z=k[J];if(z!==void 0)switch(z.length){case 2:t.vertexAttrib2fv(F.location,z);break;case 3:t.vertexAttrib3fv(F.location,z);break;case 4:t.vertexAttrib4fv(F.location,z);break;default:t.vertexAttrib1fv(F.location,z)}}}}A()}function w(){x();for(const W in i){const M=i[W];for(const N in M){const X=M[N];for(const E in X)g(X[E].object),delete X[E];delete M[N]}delete i[W]}}function S(W){if(i[W.id]===void 0)return;const M=i[W.id];for(const N in M){const X=M[N];for(const E in X)g(X[E].object),delete X[E];delete M[N]}delete i[W.id]}function Z(W){for(const M in i){const N=i[M];if(N[W.id]===void 0)continue;const X=N[W.id];for(const E in X)g(X[E].object),delete X[E];delete N[W.id]}}function x(){R(),a=!0,o!==r&&(o=r,c(o.object))}function R(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:s,reset:x,resetDefaultState:R,dispose:w,releaseStatesOfGeometry:S,releaseStatesOfProgram:Z,initAttributes:v,enableAttribute:p,disableUnusedAttributes:A}}function Ioe(t,e,n){let i;function r(c){i=c}function o(c,g){t.drawArrays(i,c,g),n.update(g,i,1)}function a(c,g,u){u!==0&&(t.drawArraysInstanced(i,c,g,u),n.update(g,i,u))}function s(c,g,u){if(u===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,c,0,g,0,u);let C=0;for(let f=0;f<u;f++)C+=g[f];n.update(C,i,1)}function l(c,g,u,d){if(u===0)return;const C=e.get("WEBGL_multi_draw");if(C===null)for(let f=0;f<c.length;f++)a(c[f],g[f],d[f]);else{C.multiDrawArraysInstancedWEBGL(i,c,0,g,0,d,0,u);let f=0;for(let v=0;v<u;v++)f+=g[v];for(let v=0;v<d.length;v++)n.update(f,i,d[v])}}this.setMode=r,this.render=o,this.renderInstances=a,this.renderMultiDraw=s,this.renderMultiDrawInstances=l}function Coe(t,e,n,i){let r;function o(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const S=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(S.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(S){return!(S!==Wi&&i.convert(S)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}function s(S){const Z=S===or&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(S!==vo&&i.convert(S)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&S!==hi&&!Z)}function l(S){if(S==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";S="mediump"}return S==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=n.precision!==void 0?n.precision:"highp";const g=l(c);g!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",g,"instead."),c=g);const u=n.logarithmicDepthBuffer===!0,d=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),C=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=t.getParameter(t.MAX_TEXTURE_SIZE),v=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),p=t.getParameter(t.MAX_VERTEX_ATTRIBS),m=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),A=t.getParameter(t.MAX_VARYING_VECTORS),b=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),G=C>0,w=t.getParameter(t.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:o,getMaxPrecision:l,textureFormatReadable:a,textureTypeReadable:s,precision:c,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:C,maxTextureSize:f,maxCubemapSize:v,maxAttributes:p,maxVertexUniforms:m,maxVaryings:A,maxFragmentUniforms:b,vertexTextures:G,maxSamples:w}}function hoe(t){const e=this;let n=null,i=0,r=!1,o=!1;const a=new Us,s=new mn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,d){const C=u.length!==0||d||i!==0||r;return r=d,i=u.length,C},this.beginShadows=function(){o=!0,g(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(u,d){n=g(u,d,0)},this.setState=function(u,d,C){const f=u.clippingPlanes,v=u.clipIntersection,p=u.clipShadows,m=t.get(u);if(!r||f===null||f.length===0||o&&!p)o?g(null):c();else{const A=o?0:i,b=A*4;let G=m.clippingState||null;l.value=G,G=g(f,d,b,C);for(let w=0;w!==b;++w)G[w]=n[w];m.clippingState=G,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=A}};function c(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function g(u,d,C,f){const v=u!==null?u.length:0;let p=null;if(v!==0){if(p=l.value,f!==!0||p===null){const m=C+v*4,A=d.matrixWorldInverse;s.getNormalMatrix(A),(p===null||p.length<m)&&(p=new Float32Array(m));for(let b=0,G=C;b!==v;++b,G+=4)a.copy(u[b]).applyMatrix4(A,s),a.normal.toArray(p,G),p[G+3]=a.constant}l.value=p,l.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,p}}function foe(t){let e=new WeakMap;function n(a,s){return s===Ld?a.mapping=Ss:s===ph&&(a.mapping=gc),a}function i(a){if(a&&a.isTexture){const s=a.mapping;if(s===Ld||s===ph)if(e.has(a)){const l=e.get(a).texture;return n(l,a.mapping)}else{const l=a.image;if(l&&l.height>0){const c=new i1(l.height);return c.fromEquirectangularTexture(t,a),e.set(a,c),a.addEventListener("dispose",r),n(c.texture,a.mapping)}else return null}}return a}function r(a){const s=a.target;s.removeEventListener("dispose",r);const l=e.get(s);l!==void 0&&(e.delete(s),l.dispose())}function o(){e=new WeakMap}return{get:i,dispose:o}}class il extends gf{constructor(e=-1,n=1,i=1,r=-1,o=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=r,this.near=o,this.far=a,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,r,o,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let o=i-e,a=i+e,s=r+n,l=r-n;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=c*this.view.offsetX,a=o+c*this.view.width,s-=g*this.view.offsetY,l=s-g*this.view.height}this.projectionMatrix.makeOrthographic(o,a,s,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}const ad=4,pN=[.125,.215,.35,.446,.526,.582],eg=20,WG=new il,vN=new kt;let VG=null,MG=0,NG=0,FG=!1;const jc=(1+Math.sqrt(5))/2,Vu=1/jc,bN=[new ge(-jc,Vu,0),new ge(jc,Vu,0),new ge(-Vu,0,jc),new ge(Vu,0,jc),new ge(0,jc,-Vu),new ge(0,jc,Vu),new ge(-1,1,-1),new ge(1,1,-1),new ge(-1,1,1),new ge(1,1,1)];class xS{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,i=.1,r=100){VG=this._renderer.getRenderTarget(),MG=this._renderer.getActiveCubeFace(),NG=this._renderer.getActiveMipmapLevel(),FG=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,i,r,o),n>0&&this._blur(o,0,0,n),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=BN(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=GN(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(VG,MG,NG),this._renderer.xr.enabled=FG,e.scissorTest=!1,iA(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===Ss||e.mapping===gc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),VG=this._renderer.getRenderTarget(),MG=this._renderer.getActiveCubeFace(),NG=this._renderer.getActiveMipmapLevel(),FG=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:Kn,minFilter:Kn,generateMipmaps:!1,type:or,format:Wi,colorSpace:pa,depthBuffer:!1},r=yN(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=yN(e,n,i);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=moe(o)),this._blurMaterial=Aoe(o,e,n)}return r}_compileMaterial(e){const n=new ti(this._lodPlanes[0],e);this._renderer.compile(n,WG)}_sceneToCubeUV(e,n,i,r){const s=new Ri(90,1,n,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],g=this._renderer,u=g.autoClear,d=g.toneMapping;g.getClearColor(vN),g.toneMapping=Gs,g.autoClear=!1;const C=new Rs({name:"PMREM.Background",side:qr,depthWrite:!1,depthTest:!1}),f=new ti(new Pg,C);let v=!1;const p=e.background;p?p.isColor&&(C.color.copy(p),e.background=null,v=!0):(C.color.copy(vN),v=!0);for(let m=0;m<6;m++){const A=m%3;A===0?(s.up.set(0,l[m],0),s.lookAt(c[m],0,0)):A===1?(s.up.set(0,0,l[m]),s.lookAt(0,c[m],0)):(s.up.set(0,l[m],0),s.lookAt(0,0,c[m]));const b=this._cubeSize;iA(r,A*b,m>2?b:0,b,b),g.setRenderTarget(r),v&&g.render(f,s),g.render(e,s)}f.geometry.dispose(),f.material.dispose(),g.toneMapping=d,g.autoClear=u,e.background=p}_textureToCubeUV(e,n){const i=this._renderer,r=e.mapping===Ss||e.mapping===gc;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=BN()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=GN());const o=r?this._cubemapMaterial:this._equirectMaterial,a=new ti(this._lodPlanes[0],o),s=o.uniforms;s.envMap.value=e;const l=this._cubeSize;iA(n,0,0,3*l,2*l),i.setRenderTarget(n),i.render(a,WG)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;const r=this._lodPlanes.length;for(let o=1;o<r;o++){const a=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]),s=bN[(r-o-1)%bN.length];this._blur(e,o-1,o,a,s)}n.autoClear=i}_blur(e,n,i,r,o){const a=this._pingPongRenderTarget;this._halfBlur(e,a,n,i,r,"latitudinal",o),this._halfBlur(a,e,i,i,r,"longitudinal",o)}_halfBlur(e,n,i,r,o,a,s){const l=this._renderer,c=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const g=3,u=new ti(this._lodPlanes[r],c),d=c.uniforms,C=this._sizeLods[i]-1,f=isFinite(o)?Math.PI/(2*C):2*Math.PI/(2*eg-1),v=o/f,p=isFinite(o)?1+Math.floor(g*v):eg;p>eg&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${p} samples when the maximum is set to ${eg}`);const m=[];let A=0;for(let Z=0;Z<eg;++Z){const x=Z/v,R=Math.exp(-x*x/2);m.push(R),Z===0?A+=R:Z<p&&(A+=2*R)}for(let Z=0;Z<m.length;Z++)m[Z]=m[Z]/A;d.envMap.value=e.texture,d.samples.value=p,d.weights.value=m,d.latitudinal.value=a==="latitudinal",s&&(d.poleAxis.value=s);const{_lodMax:b}=this;d.dTheta.value=f,d.mipInt.value=b-i;const G=this._sizeLods[r],w=3*G*(r>b-ad?r-b+ad:0),S=4*(this._cubeSize-G);iA(n,w,S,3*G,2*G),l.setRenderTarget(n),l.render(u,WG)}}function moe(t){const e=[],n=[],i=[];let r=t;const o=t-ad+1+pN.length;for(let a=0;a<o;a++){const s=Math.pow(2,r);n.push(s);let l=1/s;a>t-ad?l=pN[a-t+ad-1]:a===0&&(l=0),i.push(l);const c=1/(s-2),g=-c,u=1+c,d=[g,g,u,g,u,u,g,g,u,u,g,u],C=6,f=6,v=3,p=2,m=1,A=new Float32Array(v*f*C),b=new Float32Array(p*f*C),G=new Float32Array(m*f*C);for(let S=0;S<C;S++){const Z=S%3*2/3-1,x=S>2?0:-1,R=[Z,x,0,Z+2/3,x,0,Z+2/3,x+1,0,Z,x,0,Z+2/3,x+1,0,Z,x+1,0];A.set(R,v*f*S),b.set(d,p*f*S);const W=[S,S,S,S,S,S];G.set(W,m*f*S)}const w=new Sn;w.setAttribute("position",new Un(A,v)),w.setAttribute("uv",new Un(b,p)),w.setAttribute("faceIndex",new Un(G,m)),e.push(w),r>ad&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}function yN(t,e,n){const i=new Do(t,e,n);return i.texture.mapping=eI,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function iA(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function Aoe(t,e,n){const i=new Float32Array(eg),r=new ge(0,1,0);return new bo({name:"SphericalGaussianBlur",defines:{n:eg,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:r1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:ys,depthTest:!1,depthWrite:!1})}function GN(){return new bo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:r1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:ys,depthTest:!1,depthWrite:!1})}function BN(){return new bo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:r1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:ys,depthTest:!1,depthWrite:!1})}function r1(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function poe(t){let e=new WeakMap,n=null;function i(s){if(s&&s.isTexture){const l=s.mapping,c=l===Ld||l===ph,g=l===Ss||l===gc;if(c||g){let u=e.get(s);const d=u!==void 0?u.texture.pmremVersion:0;if(s.isRenderTargetTexture&&s.pmremVersion!==d)return n===null&&(n=new xS(t)),u=c?n.fromEquirectangular(s,u):n.fromCubemap(s,u),u.texture.pmremVersion=s.pmremVersion,e.set(s,u),u.texture;if(u!==void 0)return u.texture;{const C=s.image;return c&&C&&C.height>0||g&&C&&r(C)?(n===null&&(n=new xS(t)),u=c?n.fromEquirectangular(s):n.fromCubemap(s),u.texture.pmremVersion=s.pmremVersion,e.set(s,u),s.addEventListener("dispose",o),u.texture):null}}}return s}function r(s){let l=0;const c=6;for(let g=0;g<c;g++)s[g]!==void 0&&l++;return l===c}function o(s){const l=s.target;l.removeEventListener("dispose",o);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function a(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:a}}function voe(t){const e={};function n(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(i)}return e[i]=r,r}return{has:function(i){return n(i)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(i){const r=n(i);return r===null&&Ad("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function boe(t,e,n,i){const r={},o=new WeakMap;function a(u){const d=u.target;d.index!==null&&e.remove(d.index);for(const f in d.attributes)e.remove(d.attributes[f]);for(const f in d.morphAttributes){const v=d.morphAttributes[f];for(let p=0,m=v.length;p<m;p++)e.remove(v[p])}d.removeEventListener("dispose",a),delete r[d.id];const C=o.get(d);C&&(e.remove(C),o.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,n.memory.geometries--}function s(u,d){return r[d.id]===!0||(d.addEventListener("dispose",a),r[d.id]=!0,n.memory.geometries++),d}function l(u){const d=u.attributes;for(const f in d)e.update(d[f],t.ARRAY_BUFFER);const C=u.morphAttributes;for(const f in C){const v=C[f];for(let p=0,m=v.length;p<m;p++)e.update(v[p],t.ARRAY_BUFFER)}}function c(u){const d=[],C=u.index,f=u.attributes.position;let v=0;if(C!==null){const A=C.array;v=C.version;for(let b=0,G=A.length;b<G;b+=3){const w=A[b+0],S=A[b+1],Z=A[b+2];d.push(w,S,S,Z,Z,w)}}else if(f!==void 0){const A=f.array;v=f.version;for(let b=0,G=A.length/3-1;b<G;b+=3){const w=b+0,S=b+1,Z=b+2;d.push(w,S,S,Z,Z,w)}}else return;const p=new(g9(d)?t1:e1)(d,1);p.version=v;const m=o.get(u);m&&e.remove(m),o.set(u,p)}function g(u){const d=o.get(u);if(d){const C=u.index;C!==null&&d.version<C.version&&c(u)}else c(u);return o.get(u)}return{get:s,update:l,getWireframeAttribute:g}}function yoe(t,e,n){let i;function r(d){i=d}let o,a;function s(d){o=d.type,a=d.bytesPerElement}function l(d,C){t.drawElements(i,C,o,d*a),n.update(C,i,1)}function c(d,C,f){f!==0&&(t.drawElementsInstanced(i,C,o,d*a,f),n.update(C,i,f))}function g(d,C,f){if(f===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,C,0,o,d,0,f);let p=0;for(let m=0;m<f;m++)p+=C[m];n.update(p,i,1)}function u(d,C,f,v){if(f===0)return;const p=e.get("WEBGL_multi_draw");if(p===null)for(let m=0;m<d.length;m++)c(d[m]/a,C[m],v[m]);else{p.multiDrawElementsInstancedWEBGL(i,C,0,o,d,0,v,0,f);let m=0;for(let A=0;A<f;A++)m+=C[A];for(let A=0;A<v.length;A++)n.update(m,i,v[A])}}this.setMode=r,this.setIndex=s,this.render=l,this.renderInstances=c,this.renderMultiDraw=g,this.renderMultiDrawInstances=u}function Goe(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(o,a,s){switch(n.calls++,a){case t.TRIANGLES:n.triangles+=s*(o/3);break;case t.LINES:n.lines+=s*(o/2);break;case t.LINE_STRIP:n.lines+=s*(o-1);break;case t.LINE_LOOP:n.lines+=s*o;break;case t.POINTS:n.points+=s*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function r(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:r,update:i}}function Boe(t,e,n){const i=new WeakMap,r=new zn;function o(a,s,l){const c=a.morphTargetInfluences,g=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,u=g!==void 0?g.length:0;let d=i.get(s);if(d===void 0||d.count!==u){let W=function(){x.dispose(),i.delete(s),s.removeEventListener("dispose",W)};var C=W;d!==void 0&&d.texture.dispose();const f=s.morphAttributes.position!==void 0,v=s.morphAttributes.normal!==void 0,p=s.morphAttributes.color!==void 0,m=s.morphAttributes.position||[],A=s.morphAttributes.normal||[],b=s.morphAttributes.color||[];let G=0;f===!0&&(G=1),v===!0&&(G=2),p===!0&&(G=3);let w=s.attributes.position.count*G,S=1;w>e.maxTextureSize&&(S=Math.ceil(w/e.maxTextureSize),w=e.maxTextureSize);const Z=new Float32Array(w*S*4*u),x=new Yv(Z,w,S,u);x.type=hi,x.needsUpdate=!0;const R=G*4;for(let M=0;M<u;M++){const N=m[M],X=A[M],E=b[M],Q=w*S*4*M;for(let k=0;k<N.count;k++){const J=k*R;f===!0&&(r.fromBufferAttribute(N,k),Z[Q+J+0]=r.x,Z[Q+J+1]=r.y,Z[Q+J+2]=r.z,Z[Q+J+3]=0),v===!0&&(r.fromBufferAttribute(X,k),Z[Q+J+4]=r.x,Z[Q+J+5]=r.y,Z[Q+J+6]=r.z,Z[Q+J+7]=0),p===!0&&(r.fromBufferAttribute(E,k),Z[Q+J+8]=r.x,Z[Q+J+9]=r.y,Z[Q+J+10]=r.z,Z[Q+J+11]=E.itemSize===4?r.w:1)}}d={count:u,texture:x,size:new gt(w,S)},i.set(s,d),s.addEventListener("dispose",W)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)l.getUniforms().setValue(t,"morphTexture",a.morphTexture,n);else{let f=0;for(let p=0;p<c.length;p++)f+=c[p];const v=s.morphTargetsRelative?1:1-f;l.getUniforms().setValue(t,"morphTargetBaseInfluence",v),l.getUniforms().setValue(t,"morphTargetInfluences",c)}l.getUniforms().setValue(t,"morphTargetsTexture",d.texture,n),l.getUniforms().setValue(t,"morphTargetsTextureSize",d.size)}return{update:o}}function Soe(t,e,n,i){let r=new WeakMap;function o(l){const c=i.render.frame,g=l.geometry,u=e.get(l,g);if(r.get(u)!==c&&(e.update(u),r.set(u,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",s)===!1&&l.addEventListener("dispose",s),r.get(l)!==c&&(n.update(l.instanceMatrix,t.ARRAY_BUFFER),l.instanceColor!==null&&n.update(l.instanceColor,t.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const d=l.skeleton;r.get(d)!==c&&(d.update(),r.set(d,c))}return u}function a(){r=new WeakMap}function s(l){const c=l.target;c.removeEventListener("dispose",s),n.remove(c.instanceMatrix),c.instanceColor!==null&&n.remove(c.instanceColor)}return{update:o,dispose:a}}class o1 extends Tn{constructor(e,n,i,r,o,a,s,l,c,g=pg){if(g!==pg&&g!==Ng)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&g===pg&&(i=ws),i===void 0&&g===Ng&&(i=Mg),super(null,r,o,a,s,l,g,i,c),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=s!==void 0?s:rr,this.minFilter=l!==void 0?l:rr,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}const A9=new Tn,SN=new o1(1,1),p9=new Yv,v9=new qZ,b9=new uf,wN=[],ZN=[],xN=new Float32Array(16),RN=new Float32Array(9),WN=new Float32Array(4);function tI(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let o=wN[r];if(o===void 0&&(o=new Float32Array(r),wN[r]=o),e!==0){i.toArray(o,0);for(let a=1,s=0;a!==e;++a)s+=n,t[a].toArray(o,s)}return o}function Di(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Oi(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function zv(t,e){let n=ZN[e];n===void 0&&(n=new Int32Array(e),ZN[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function woe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Zoe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Di(n,e))return;t.uniform2fv(this.addr,e),Oi(n,e)}}function xoe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Di(n,e))return;t.uniform3fv(this.addr,e),Oi(n,e)}}function Roe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Di(n,e))return;t.uniform4fv(this.addr,e),Oi(n,e)}}function Woe(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Di(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Oi(n,e)}else{if(Di(n,i))return;WN.set(i),t.uniformMatrix2fv(this.addr,!1,WN),Oi(n,i)}}function Voe(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Di(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Oi(n,e)}else{if(Di(n,i))return;RN.set(i),t.uniformMatrix3fv(this.addr,!1,RN),Oi(n,i)}}function Moe(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Di(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Oi(n,e)}else{if(Di(n,i))return;xN.set(i),t.uniformMatrix4fv(this.addr,!1,xN),Oi(n,i)}}function Noe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Foe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Di(n,e))return;t.uniform2iv(this.addr,e),Oi(n,e)}}function Hoe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Di(n,e))return;t.uniform3iv(this.addr,e),Oi(n,e)}}function Xoe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Di(n,e))return;t.uniform4iv(this.addr,e),Oi(n,e)}}function Eoe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Yoe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Di(n,e))return;t.uniform2uiv(this.addr,e),Oi(n,e)}}function zoe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Di(n,e))return;t.uniform3uiv(this.addr,e),Oi(n,e)}}function Koe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Di(n,e))return;t.uniform4uiv(this.addr,e),Oi(n,e)}}function Loe(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r);let o;this.type===t.SAMPLER_2D_SHADOW?(SN.compareFunction=jZ,o=SN):o=A9,n.setTexture2D(e||o,r)}function Toe(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||v9,r)}function _oe(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||b9,r)}function koe(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||p9,r)}function Poe(t){switch(t){case 5126:return woe;case 35664:return Zoe;case 35665:return xoe;case 35666:return Roe;case 35674:return Woe;case 35675:return Voe;case 35676:return Moe;case 5124:case 35670:return Noe;case 35667:case 35671:return Foe;case 35668:case 35672:return Hoe;case 35669:case 35673:return Xoe;case 5125:return Eoe;case 36294:return Yoe;case 36295:return zoe;case 36296:return Koe;case 35678:case 36198:case 36298:case 36306:case 35682:return Loe;case 35679:case 36299:case 36307:return Toe;case 35680:case 36300:case 36308:case 36293:return _oe;case 36289:case 36303:case 36311:case 36292:return koe}}function Uoe(t,e){t.uniform1fv(this.addr,e)}function Doe(t,e){const n=tI(e,this.size,2);t.uniform2fv(this.addr,n)}function Ooe(t,e){const n=tI(e,this.size,3);t.uniform3fv(this.addr,n)}function Joe(t,e){const n=tI(e,this.size,4);t.uniform4fv(this.addr,n)}function Qoe(t,e){const n=tI(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function joe(t,e){const n=tI(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function $oe(t,e){const n=tI(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function qoe(t,e){t.uniform1iv(this.addr,e)}function eae(t,e){t.uniform2iv(this.addr,e)}function tae(t,e){t.uniform3iv(this.addr,e)}function nae(t,e){t.uniform4iv(this.addr,e)}function iae(t,e){t.uniform1uiv(this.addr,e)}function rae(t,e){t.uniform2uiv(this.addr,e)}function oae(t,e){t.uniform3uiv(this.addr,e)}function aae(t,e){t.uniform4uiv(this.addr,e)}function sae(t,e,n){const i=this.cache,r=e.length,o=zv(n,r);Di(i,o)||(t.uniform1iv(this.addr,o),Oi(i,o));for(let a=0;a!==r;++a)n.setTexture2D(e[a]||A9,o[a])}function lae(t,e,n){const i=this.cache,r=e.length,o=zv(n,r);Di(i,o)||(t.uniform1iv(this.addr,o),Oi(i,o));for(let a=0;a!==r;++a)n.setTexture3D(e[a]||v9,o[a])}function cae(t,e,n){const i=this.cache,r=e.length,o=zv(n,r);Di(i,o)||(t.uniform1iv(this.addr,o),Oi(i,o));for(let a=0;a!==r;++a)n.setTextureCube(e[a]||b9,o[a])}function gae(t,e,n){const i=this.cache,r=e.length,o=zv(n,r);Di(i,o)||(t.uniform1iv(this.addr,o),Oi(i,o));for(let a=0;a!==r;++a)n.setTexture2DArray(e[a]||p9,o[a])}function uae(t){switch(t){case 5126:return Uoe;case 35664:return Doe;case 35665:return Ooe;case 35666:return Joe;case 35674:return Qoe;case 35675:return joe;case 35676:return $oe;case 5124:case 35670:return qoe;case 35667:case 35671:return eae;case 35668:case 35672:return tae;case 35669:case 35673:return nae;case 5125:return iae;case 36294:return rae;case 36295:return oae;case 36296:return aae;case 35678:case 36198:case 36298:case 36306:case 35682:return sae;case 35679:case 36299:case 36307:return lae;case 35680:case 36300:case 36308:case 36293:return cae;case 36289:case 36303:case 36311:case 36292:return gae}}class dae{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.setValue=Poe(n.type)}}class Iae{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=uae(n.type)}}class Cae{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,i){const r=this.seq;for(let o=0,a=r.length;o!==a;++o){const s=r[o];s.setValue(e,n[s.id],i)}}}const HG=/(\w+)(\])?(\[|\.)?/g;function VN(t,e){t.seq.push(e),t.map[e.id]=e}function hae(t,e,n){const i=t.name,r=i.length;for(HG.lastIndex=0;;){const o=HG.exec(i),a=HG.lastIndex;let s=o[1];const l=o[2]==="]",c=o[3];if(l&&(s=s|0),c===void 0||c==="["&&a+2===r){VN(n,c===void 0?new dae(s,t,e):new Iae(s,t,e));break}else{let u=n.map[s];u===void 0&&(u=new Cae(s),VN(n,u)),n=u}}}class Ip{constructor(e,n){this.seq=[],this.map={};const i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const o=e.getActiveUniform(n,r),a=e.getUniformLocation(n,o.name);hae(o,a,this)}}setValue(e,n,i,r){const o=this.map[n];o!==void 0&&o.setValue(e,i,r)}setOptional(e,n,i){const r=n[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,n,i,r){for(let o=0,a=n.length;o!==a;++o){const s=n[o],l=i[s.id];l.needsUpdate!==!1&&s.setValue(e,l.value,r)}}static seqWithValue(e,n){const i=[];for(let r=0,o=e.length;r!==o;++r){const a=e[r];a.id in n&&i.push(a)}return i}}function MN(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}const fae=37297;let mae=0;function Aae(t,e){const n=t.split(`
`),i=[],r=Math.max(e-6,0),o=Math.min(e+6,n.length);for(let a=r;a<o;a++){const s=a+1;i.push(`${s===e?">":" "} ${s}: ${n[a]}`)}return i.join(`
`)}function pae(t){const e=Yn.getPrimaries(Yn.workingColorSpace),n=Yn.getPrimaries(t);let i;switch(e===n?i="":e===wh&&n===Sh?i="LinearDisplayP3ToLinearSRGB":e===Sh&&n===wh&&(i="LinearSRGBToLinearDisplayP3"),t){case pa:case cf:return[i,"LinearTransferOETF"];case Yo:case Ev:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",t),[i,"LinearTransferOETF"]}}function NN(t,e,n){const i=t.getShaderParameter(e,t.COMPILE_STATUS),r=t.getShaderInfoLog(e).trim();if(i&&r==="")return"";const o=/ERROR: 0:(\d+)/.exec(r);if(o){const a=parseInt(o[1]);return n.toUpperCase()+`

`+r+`

`+Aae(t.getShaderSource(e),a)}else return r}function vae(t,e){const n=pae(e);return`vec4 ${t}( vec4 value ) { return ${n[0]}( ${n[1]}( value ) ); }`}function bae(t,e){let n;switch(e){case kz:n="Linear";break;case Pz:n="Reinhard";break;case Uz:n="Cineon";break;case KZ:n="ACESFilmic";break;case Oz:n="AgX";break;case Jz:n="Neutral";break;case Dz:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const rA=new ge;function yae(){Yn.getLuminanceCoefficients(rA);const t=rA.x.toFixed(4),e=rA.y.toFixed(4),n=rA.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${t}, ${e}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function Gae(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(IC).join(`
`)}function Bae(t){const e=[];for(const n in t){const i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function Sae(t,e){const n={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const o=t.getActiveAttrib(e,r),a=o.name;let s=1;o.type===t.FLOAT_MAT2&&(s=2),o.type===t.FLOAT_MAT3&&(s=3),o.type===t.FLOAT_MAT4&&(s=4),n[a]={type:o.type,location:t.getAttribLocation(e,a),locationSize:s}}return n}function IC(t){return t!==""}function FN(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function HN(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const wae=/^[ \t]*#include +<([\w\d./]+)>/gm;function RS(t){return t.replace(wae,xae)}const Zae=new Map;function xae(t,e){let n=pn[e];if(n===void 0){const i=Zae.get(e);if(i!==void 0)n=pn[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return RS(n)}const Rae=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function XN(t){return t.replace(Rae,Wae)}function Wae(t,e,n,i){let r="";for(let o=parseInt(e);o<parseInt(n);o++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function EN(t){let e=`precision ${t.precision} float;
	precision ${t.precision} int;
	precision ${t.precision} sampler2D;
	precision ${t.precision} samplerCube;
	precision ${t.precision} sampler3D;
	precision ${t.precision} sampler2DArray;
	precision ${t.precision} sampler2DShadow;
	precision ${t.precision} samplerCubeShadow;
	precision ${t.precision} sampler2DArrayShadow;
	precision ${t.precision} isampler2D;
	precision ${t.precision} isampler3D;
	precision ${t.precision} isamplerCube;
	precision ${t.precision} isampler2DArray;
	precision ${t.precision} usampler2D;
	precision ${t.precision} usampler3D;
	precision ${t.precision} usamplerCube;
	precision ${t.precision} usampler2DArray;
	`;return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Vae(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===Rv?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===RC?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Ea&&(e="SHADOWMAP_TYPE_VSM"),e}function Mae(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case Ss:case gc:e="ENVMAP_TYPE_CUBE";break;case eI:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Nae(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case gc:e="ENVMAP_MODE_REFRACTION";break}return e}function Fae(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case of:e="ENVMAP_BLENDING_MULTIPLY";break;case Tz:e="ENVMAP_BLENDING_MIX";break;case _z:e="ENVMAP_BLENDING_ADD";break}return e}function Hae(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function Xae(t,e,n,i){const r=t.getContext(),o=n.defines;let a=n.vertexShader,s=n.fragmentShader;const l=Vae(n),c=Mae(n),g=Nae(n),u=Fae(n),d=Hae(n),C=Gae(n),f=Bae(o),v=r.createProgram();let p,m,A=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(p=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f].filter(IC).join(`
`),p.length>0&&(p+=`
`),m=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f].filter(IC).join(`
`),m.length>0&&(m+=`
`)):(p=[EN(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+g:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(IC).join(`
`),m=[EN(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+g:"",n.envMap?"#define "+u:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Gs?"#define TONE_MAPPING":"",n.toneMapping!==Gs?pn.tonemapping_pars_fragment:"",n.toneMapping!==Gs?bae("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",pn.colorspace_pars_fragment,vae("linearToOutputTexel",n.outputColorSpace),yae(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(IC).join(`
`)),a=RS(a),a=FN(a,n),a=HN(a,n),s=RS(s),s=FN(s,n),s=HN(s,n),a=XN(a),s=XN(s),n.isRawShaderMaterial!==!0&&(A=`#version 300 es
`,p=[C,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+p,m=["#define varying in",n.glslVersion===ZS?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===ZS?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+m);const b=A+p+a,G=A+m+s,w=MN(r,r.VERTEX_SHADER,b),S=MN(r,r.FRAGMENT_SHADER,G);r.attachShader(v,w),r.attachShader(v,S),n.index0AttributeName!==void 0?r.bindAttribLocation(v,0,n.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(v,0,"position"),r.linkProgram(v);function Z(M){if(t.debug.checkShaderErrors){const N=r.getProgramInfoLog(v).trim(),X=r.getShaderInfoLog(w).trim(),E=r.getShaderInfoLog(S).trim();let Q=!0,k=!0;if(r.getProgramParameter(v,r.LINK_STATUS)===!1)if(Q=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(r,v,w,S);else{const J=NN(r,w,"vertex"),F=NN(r,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(v,r.VALIDATE_STATUS)+`

Material Name: `+M.name+`
Material Type: `+M.type+`

Program Info Log: `+N+`
`+J+`
`+F)}else N!==""?console.warn("THREE.WebGLProgram: Program Info Log:",N):(X===""||E==="")&&(k=!1);k&&(M.diagnostics={runnable:Q,programLog:N,vertexShader:{log:X,prefix:p},fragmentShader:{log:E,prefix:m}})}r.deleteShader(w),r.deleteShader(S),x=new Ip(r,v),R=Sae(r,v)}let x;this.getUniforms=function(){return x===void 0&&Z(this),x};let R;this.getAttributes=function(){return R===void 0&&Z(this),R};let W=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return W===!1&&(W=r.getProgramParameter(v,fae)),W},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(v),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=mae++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=w,this.fragmentShader=S,this}let Eae=0;class Yae{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(n),o=this._getShaderStage(i),a=this._getShaderCacheForMaterial(e);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(o)===!1&&(a.add(o),o.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let i=n.get(e);return i===void 0&&(i=new Set,n.set(e,i)),i}_getShaderStage(e){const n=this.shaderCache;let i=n.get(e);return i===void 0&&(i=new zae(e),n.set(e,i)),i}}class zae{constructor(e){this.id=Eae++,this.code=e,this.usedTimes=0}}function Kae(t,e,n,i,r,o,a){const s=new bg,l=new Yae,c=new Set,g=[],u=r.logarithmicDepthBuffer,d=r.vertexTextures;let C=r.precision;const f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(R){return c.add(R),R===0?"uv":`uv${R}`}function p(R,W,M,N,X){const E=N.fog,Q=X.geometry,k=R.isMeshStandardMaterial?N.environment:null,J=(R.isMeshStandardMaterial?n:e).get(R.envMap||k),F=J&&J.mapping===eI?J.image.height:null,L=f[R.type];R.precision!==null&&(C=r.getMaxPrecision(R.precision),C!==R.precision&&console.warn("THREE.WebGLProgram.getParameters:",R.precision,"not supported, using",C,"instead."));const z=Q.morphAttributes.position||Q.morphAttributes.normal||Q.morphAttributes.color,K=z!==void 0?z.length:0;let O=0;Q.morphAttributes.position!==void 0&&(O=1),Q.morphAttributes.normal!==void 0&&(O=2),Q.morphAttributes.color!==void 0&&(O=3);let j,P,$,oe;if(L){const et=Ta[L];j=et.vertexShader,P=et.fragmentShader}else j=R.vertexShader,P=R.fragmentShader,l.update(R),$=l.getVertexShaderID(R),oe=l.getFragmentShaderID(R);const ie=t.getRenderTarget(),de=X.isInstancedMesh===!0,Ve=X.isBatchedMesh===!0,Se=!!R.map,me=!!R.matcap,T=!!J,Ge=!!R.aoMap,ne=!!R.lightMap,he=!!R.bumpMap,ae=!!R.normalMap,He=!!R.displacementMap,ve=!!R.emissiveMap,Me=!!R.metalnessMap,q=!!R.roughnessMap,Y=R.anisotropy>0,Ce=R.clearcoat>0,se=R.dispersion>0,fe=R.iridescence>0,Ze=R.sheen>0,Oe=R.transmission>0,Fe=Y&&!!R.anisotropyMap,Ee=Ce&&!!R.clearcoatMap,Qe=Ce&&!!R.clearcoatNormalMap,Ye=Ce&&!!R.clearcoatRoughnessMap,$e=fe&&!!R.iridescenceMap,st=fe&&!!R.iridescenceThicknessMap,Ue=Ze&&!!R.sheenColorMap,Ne=Ze&&!!R.sheenRoughnessMap,je=!!R.specularMap,Ie=!!R.specularColorMap,Te=!!R.specularIntensityMap,ue=Oe&&!!R.transmissionMap,Pe=Oe&&!!R.thicknessMap,be=!!R.gradientMap,Le=!!R.alphaMap,ct=R.alphaTest>0,dt=!!R.alphaHash,It=!!R.extensions;let Vt=Gs;R.toneMapped&&(ie===null||ie.isXRRenderTarget===!0)&&(Vt=t.toneMapping);const vt={shaderID:L,shaderType:R.type,shaderName:R.name,vertexShader:j,fragmentShader:P,defines:R.defines,customVertexShaderID:$,customFragmentShaderID:oe,isRawShaderMaterial:R.isRawShaderMaterial===!0,glslVersion:R.glslVersion,precision:C,batching:Ve,batchingColor:Ve&&X._colorsTexture!==null,instancing:de,instancingColor:de&&X.instanceColor!==null,instancingMorph:de&&X.morphTexture!==null,supportsVertexTextures:d,outputColorSpace:ie===null?t.outputColorSpace:ie.isXRRenderTarget===!0?ie.texture.colorSpace:pa,alphaToCoverage:!!R.alphaToCoverage,map:Se,matcap:me,envMap:T,envMapMode:T&&J.mapping,envMapCubeUVHeight:F,aoMap:Ge,lightMap:ne,bumpMap:he,normalMap:ae,displacementMap:d&&He,emissiveMap:ve,normalMapObjectSpace:ae&&R.normalMapType===t9,normalMapTangentSpace:ae&&R.normalMapType===fc,metalnessMap:Me,roughnessMap:q,anisotropy:Y,anisotropyMap:Fe,clearcoat:Ce,clearcoatMap:Ee,clearcoatNormalMap:Qe,clearcoatRoughnessMap:Ye,dispersion:se,iridescence:fe,iridescenceMap:$e,iridescenceThicknessMap:st,sheen:Ze,sheenColorMap:Ue,sheenRoughnessMap:Ne,specularMap:je,specularColorMap:Ie,specularIntensityMap:Te,transmission:Oe,transmissionMap:ue,thicknessMap:Pe,gradientMap:be,opaque:R.transparent===!1&&R.blending===Ag&&R.alphaToCoverage===!1,alphaMap:Le,alphaTest:ct,alphaHash:dt,combine:R.combine,mapUv:Se&&v(R.map.channel),aoMapUv:Ge&&v(R.aoMap.channel),lightMapUv:ne&&v(R.lightMap.channel),bumpMapUv:he&&v(R.bumpMap.channel),normalMapUv:ae&&v(R.normalMap.channel),displacementMapUv:He&&v(R.displacementMap.channel),emissiveMapUv:ve&&v(R.emissiveMap.channel),metalnessMapUv:Me&&v(R.metalnessMap.channel),roughnessMapUv:q&&v(R.roughnessMap.channel),anisotropyMapUv:Fe&&v(R.anisotropyMap.channel),clearcoatMapUv:Ee&&v(R.clearcoatMap.channel),clearcoatNormalMapUv:Qe&&v(R.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ye&&v(R.clearcoatRoughnessMap.channel),iridescenceMapUv:$e&&v(R.iridescenceMap.channel),iridescenceThicknessMapUv:st&&v(R.iridescenceThicknessMap.channel),sheenColorMapUv:Ue&&v(R.sheenColorMap.channel),sheenRoughnessMapUv:Ne&&v(R.sheenRoughnessMap.channel),specularMapUv:je&&v(R.specularMap.channel),specularColorMapUv:Ie&&v(R.specularColorMap.channel),specularIntensityMapUv:Te&&v(R.specularIntensityMap.channel),transmissionMapUv:ue&&v(R.transmissionMap.channel),thicknessMapUv:Pe&&v(R.thicknessMap.channel),alphaMapUv:Le&&v(R.alphaMap.channel),vertexTangents:!!Q.attributes.tangent&&(ae||Y),vertexColors:R.vertexColors,vertexAlphas:R.vertexColors===!0&&!!Q.attributes.color&&Q.attributes.color.itemSize===4,pointsUvs:X.isPoints===!0&&!!Q.attributes.uv&&(Se||Le),fog:!!E,useFog:R.fog===!0,fogExp2:!!E&&E.isFogExp2,flatShading:R.flatShading===!0,sizeAttenuation:R.sizeAttenuation===!0,logarithmicDepthBuffer:u,skinning:X.isSkinnedMesh===!0,morphTargets:Q.morphAttributes.position!==void 0,morphNormals:Q.morphAttributes.normal!==void 0,morphColors:Q.morphAttributes.color!==void 0,morphTargetsCount:K,morphTextureStride:O,numDirLights:W.directional.length,numPointLights:W.point.length,numSpotLights:W.spot.length,numSpotLightMaps:W.spotLightMap.length,numRectAreaLights:W.rectArea.length,numHemiLights:W.hemi.length,numDirLightShadows:W.directionalShadowMap.length,numPointLightShadows:W.pointShadowMap.length,numSpotLightShadows:W.spotShadowMap.length,numSpotLightShadowsWithMaps:W.numSpotLightShadowsWithMaps,numLightProbes:W.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:R.dithering,shadowMapEnabled:t.shadowMap.enabled&&M.length>0,shadowMapType:t.shadowMap.type,toneMapping:Vt,decodeVideoTexture:Se&&R.map.isVideoTexture===!0&&Yn.getTransfer(R.map.colorSpace)===jn,premultipliedAlpha:R.premultipliedAlpha,doubleSided:R.side===da,flipSided:R.side===qr,useDepthPacking:R.depthPacking>=0,depthPacking:R.depthPacking||0,index0AttributeName:R.index0AttributeName,extensionClipCullDistance:It&&R.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(It&&R.extensions.multiDraw===!0||Ve)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:R.customProgramCacheKey()};return vt.vertexUv1s=c.has(1),vt.vertexUv2s=c.has(2),vt.vertexUv3s=c.has(3),c.clear(),vt}function m(R){const W=[];if(R.shaderID?W.push(R.shaderID):(W.push(R.customVertexShaderID),W.push(R.customFragmentShaderID)),R.defines!==void 0)for(const M in R.defines)W.push(M),W.push(R.defines[M]);return R.isRawShaderMaterial===!1&&(A(W,R),b(W,R),W.push(t.outputColorSpace)),W.push(R.customProgramCacheKey),W.join()}function A(R,W){R.push(W.precision),R.push(W.outputColorSpace),R.push(W.envMapMode),R.push(W.envMapCubeUVHeight),R.push(W.mapUv),R.push(W.alphaMapUv),R.push(W.lightMapUv),R.push(W.aoMapUv),R.push(W.bumpMapUv),R.push(W.normalMapUv),R.push(W.displacementMapUv),R.push(W.emissiveMapUv),R.push(W.metalnessMapUv),R.push(W.roughnessMapUv),R.push(W.anisotropyMapUv),R.push(W.clearcoatMapUv),R.push(W.clearcoatNormalMapUv),R.push(W.clearcoatRoughnessMapUv),R.push(W.iridescenceMapUv),R.push(W.iridescenceThicknessMapUv),R.push(W.sheenColorMapUv),R.push(W.sheenRoughnessMapUv),R.push(W.specularMapUv),R.push(W.specularColorMapUv),R.push(W.specularIntensityMapUv),R.push(W.transmissionMapUv),R.push(W.thicknessMapUv),R.push(W.combine),R.push(W.fogExp2),R.push(W.sizeAttenuation),R.push(W.morphTargetsCount),R.push(W.morphAttributeCount),R.push(W.numDirLights),R.push(W.numPointLights),R.push(W.numSpotLights),R.push(W.numSpotLightMaps),R.push(W.numHemiLights),R.push(W.numRectAreaLights),R.push(W.numDirLightShadows),R.push(W.numPointLightShadows),R.push(W.numSpotLightShadows),R.push(W.numSpotLightShadowsWithMaps),R.push(W.numLightProbes),R.push(W.shadowMapType),R.push(W.toneMapping),R.push(W.numClippingPlanes),R.push(W.numClipIntersection),R.push(W.depthPacking)}function b(R,W){s.disableAll(),W.supportsVertexTextures&&s.enable(0),W.instancing&&s.enable(1),W.instancingColor&&s.enable(2),W.instancingMorph&&s.enable(3),W.matcap&&s.enable(4),W.envMap&&s.enable(5),W.normalMapObjectSpace&&s.enable(6),W.normalMapTangentSpace&&s.enable(7),W.clearcoat&&s.enable(8),W.iridescence&&s.enable(9),W.alphaTest&&s.enable(10),W.vertexColors&&s.enable(11),W.vertexAlphas&&s.enable(12),W.vertexUv1s&&s.enable(13),W.vertexUv2s&&s.enable(14),W.vertexUv3s&&s.enable(15),W.vertexTangents&&s.enable(16),W.anisotropy&&s.enable(17),W.alphaHash&&s.enable(18),W.batching&&s.enable(19),W.dispersion&&s.enable(20),W.batchingColor&&s.enable(21),R.push(s.mask),s.disableAll(),W.fog&&s.enable(0),W.useFog&&s.enable(1),W.flatShading&&s.enable(2),W.logarithmicDepthBuffer&&s.enable(3),W.skinning&&s.enable(4),W.morphTargets&&s.enable(5),W.morphNormals&&s.enable(6),W.morphColors&&s.enable(7),W.premultipliedAlpha&&s.enable(8),W.shadowMapEnabled&&s.enable(9),W.doubleSided&&s.enable(10),W.flipSided&&s.enable(11),W.useDepthPacking&&s.enable(12),W.dithering&&s.enable(13),W.transmission&&s.enable(14),W.sheen&&s.enable(15),W.opaque&&s.enable(16),W.pointsUvs&&s.enable(17),W.decodeVideoTexture&&s.enable(18),W.alphaToCoverage&&s.enable(19),R.push(s.mask)}function G(R){const W=f[R.type];let M;if(W){const N=Ta[W];M=n1.clone(N.uniforms)}else M=R.uniforms;return M}function w(R,W){let M;for(let N=0,X=g.length;N<X;N++){const E=g[N];if(E.cacheKey===W){M=E,++M.usedTimes;break}}return M===void 0&&(M=new Xae(t,W,R,o),g.push(M)),M}function S(R){if(--R.usedTimes===0){const W=g.indexOf(R);g[W]=g[g.length-1],g.pop(),R.destroy()}}function Z(R){l.remove(R)}function x(){l.dispose()}return{getParameters:p,getProgramCacheKey:m,getUniforms:G,acquireProgram:w,releaseProgram:S,releaseShaderCache:Z,programs:g,dispose:x}}function Lae(){let t=new WeakMap;function e(a){return t.has(a)}function n(a){let s=t.get(a);return s===void 0&&(s={},t.set(a,s)),s}function i(a){t.delete(a)}function r(a,s,l){t.get(a)[s]=l}function o(){t=new WeakMap}return{has:e,get:n,remove:i,update:r,dispose:o}}function Tae(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function YN(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function zN(){const t=[];let e=0;const n=[],i=[],r=[];function o(){e=0,n.length=0,i.length=0,r.length=0}function a(u,d,C,f,v,p){let m=t[e];return m===void 0?(m={id:u.id,object:u,geometry:d,material:C,groupOrder:f,renderOrder:u.renderOrder,z:v,group:p},t[e]=m):(m.id=u.id,m.object=u,m.geometry=d,m.material=C,m.groupOrder=f,m.renderOrder=u.renderOrder,m.z=v,m.group=p),e++,m}function s(u,d,C,f,v,p){const m=a(u,d,C,f,v,p);C.transmission>0?i.push(m):C.transparent===!0?r.push(m):n.push(m)}function l(u,d,C,f,v,p){const m=a(u,d,C,f,v,p);C.transmission>0?i.unshift(m):C.transparent===!0?r.unshift(m):n.unshift(m)}function c(u,d){n.length>1&&n.sort(u||Tae),i.length>1&&i.sort(d||YN),r.length>1&&r.sort(d||YN)}function g(){for(let u=e,d=t.length;u<d;u++){const C=t[u];if(C.id===null)break;C.id=null,C.object=null,C.geometry=null,C.material=null,C.group=null}}return{opaque:n,transmissive:i,transparent:r,init:o,push:s,unshift:l,finish:g,sort:c}}function _ae(){let t=new WeakMap;function e(i,r){const o=t.get(i);let a;return o===void 0?(a=new zN,t.set(i,[a])):r>=o.length?(a=new zN,o.push(a)):a=o[r],a}function n(){t=new WeakMap}return{get:e,dispose:n}}function kae(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new ge,color:new kt};break;case"SpotLight":n={position:new ge,direction:new ge,color:new kt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new ge,color:new kt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new ge,skyColor:new kt,groundColor:new kt};break;case"RectAreaLight":n={color:new kt,position:new ge,halfWidth:new ge,halfHeight:new ge};break}return t[e.id]=n,n}}}function Pae(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let Uae=0;function Dae(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Oae(t){const e=new kae,n=Pae(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)i.probe.push(new ge);const r=new ge,o=new ln,a=new ln;function s(c){let g=0,u=0,d=0;for(let R=0;R<9;R++)i.probe[R].set(0,0,0);let C=0,f=0,v=0,p=0,m=0,A=0,b=0,G=0,w=0,S=0,Z=0;c.sort(Dae);for(let R=0,W=c.length;R<W;R++){const M=c[R],N=M.color,X=M.intensity,E=M.distance,Q=M.shadow&&M.shadow.map?M.shadow.map.texture:null;if(M.isAmbientLight)g+=N.r*X,u+=N.g*X,d+=N.b*X;else if(M.isLightProbe){for(let k=0;k<9;k++)i.probe[k].addScaledVector(M.sh.coefficients[k],X);Z++}else if(M.isDirectionalLight){const k=e.get(M);if(k.color.copy(M.color).multiplyScalar(M.intensity),M.castShadow){const J=M.shadow,F=n.get(M);F.shadowIntensity=J.intensity,F.shadowBias=J.bias,F.shadowNormalBias=J.normalBias,F.shadowRadius=J.radius,F.shadowMapSize=J.mapSize,i.directionalShadow[C]=F,i.directionalShadowMap[C]=Q,i.directionalShadowMatrix[C]=M.shadow.matrix,A++}i.directional[C]=k,C++}else if(M.isSpotLight){const k=e.get(M);k.position.setFromMatrixPosition(M.matrixWorld),k.color.copy(N).multiplyScalar(X),k.distance=E,k.coneCos=Math.cos(M.angle),k.penumbraCos=Math.cos(M.angle*(1-M.penumbra)),k.decay=M.decay,i.spot[v]=k;const J=M.shadow;if(M.map&&(i.spotLightMap[w]=M.map,w++,J.updateMatrices(M),M.castShadow&&S++),i.spotLightMatrix[v]=J.matrix,M.castShadow){const F=n.get(M);F.shadowIntensity=J.intensity,F.shadowBias=J.bias,F.shadowNormalBias=J.normalBias,F.shadowRadius=J.radius,F.shadowMapSize=J.mapSize,i.spotShadow[v]=F,i.spotShadowMap[v]=Q,G++}v++}else if(M.isRectAreaLight){const k=e.get(M);k.color.copy(N).multiplyScalar(X),k.halfWidth.set(M.width*.5,0,0),k.halfHeight.set(0,M.height*.5,0),i.rectArea[p]=k,p++}else if(M.isPointLight){const k=e.get(M);if(k.color.copy(M.color).multiplyScalar(M.intensity),k.distance=M.distance,k.decay=M.decay,M.castShadow){const J=M.shadow,F=n.get(M);F.shadowIntensity=J.intensity,F.shadowBias=J.bias,F.shadowNormalBias=J.normalBias,F.shadowRadius=J.radius,F.shadowMapSize=J.mapSize,F.shadowCameraNear=J.camera.near,F.shadowCameraFar=J.camera.far,i.pointShadow[f]=F,i.pointShadowMap[f]=Q,i.pointShadowMatrix[f]=M.shadow.matrix,b++}i.point[f]=k,f++}else if(M.isHemisphereLight){const k=e.get(M);k.skyColor.copy(M.color).multiplyScalar(X),k.groundColor.copy(M.groundColor).multiplyScalar(X),i.hemi[m]=k,m++}}p>0&&(t.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Kt.LTC_FLOAT_1,i.rectAreaLTC2=Kt.LTC_FLOAT_2):(i.rectAreaLTC1=Kt.LTC_HALF_1,i.rectAreaLTC2=Kt.LTC_HALF_2)),i.ambient[0]=g,i.ambient[1]=u,i.ambient[2]=d;const x=i.hash;(x.directionalLength!==C||x.pointLength!==f||x.spotLength!==v||x.rectAreaLength!==p||x.hemiLength!==m||x.numDirectionalShadows!==A||x.numPointShadows!==b||x.numSpotShadows!==G||x.numSpotMaps!==w||x.numLightProbes!==Z)&&(i.directional.length=C,i.spot.length=v,i.rectArea.length=p,i.point.length=f,i.hemi.length=m,i.directionalShadow.length=A,i.directionalShadowMap.length=A,i.pointShadow.length=b,i.pointShadowMap.length=b,i.spotShadow.length=G,i.spotShadowMap.length=G,i.directionalShadowMatrix.length=A,i.pointShadowMatrix.length=b,i.spotLightMatrix.length=G+w-S,i.spotLightMap.length=w,i.numSpotLightShadowsWithMaps=S,i.numLightProbes=Z,x.directionalLength=C,x.pointLength=f,x.spotLength=v,x.rectAreaLength=p,x.hemiLength=m,x.numDirectionalShadows=A,x.numPointShadows=b,x.numSpotShadows=G,x.numSpotMaps=w,x.numLightProbes=Z,i.version=Uae++)}function l(c,g){let u=0,d=0,C=0,f=0,v=0;const p=g.matrixWorldInverse;for(let m=0,A=c.length;m<A;m++){const b=c[m];if(b.isDirectionalLight){const G=i.directional[u];G.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),G.direction.sub(r),G.direction.transformDirection(p),u++}else if(b.isSpotLight){const G=i.spot[C];G.position.setFromMatrixPosition(b.matrixWorld),G.position.applyMatrix4(p),G.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),G.direction.sub(r),G.direction.transformDirection(p),C++}else if(b.isRectAreaLight){const G=i.rectArea[f];G.position.setFromMatrixPosition(b.matrixWorld),G.position.applyMatrix4(p),a.identity(),o.copy(b.matrixWorld),o.premultiply(p),a.extractRotation(o),G.halfWidth.set(b.width*.5,0,0),G.halfHeight.set(0,b.height*.5,0),G.halfWidth.applyMatrix4(a),G.halfHeight.applyMatrix4(a),f++}else if(b.isPointLight){const G=i.point[d];G.position.setFromMatrixPosition(b.matrixWorld),G.position.applyMatrix4(p),d++}else if(b.isHemisphereLight){const G=i.hemi[v];G.direction.setFromMatrixPosition(b.matrixWorld),G.direction.transformDirection(p),v++}}}return{setup:s,setupView:l,state:i}}function KN(t){const e=new Oae(t),n=[],i=[];function r(g){c.camera=g,n.length=0,i.length=0}function o(g){n.push(g)}function a(g){i.push(g)}function s(){e.setup(n)}function l(g){e.setupView(n,g)}const c={lightsArray:n,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:c,setupLights:s,setupLightsView:l,pushLight:o,pushShadow:a}}function Jae(t){let e=new WeakMap;function n(r,o=0){const a=e.get(r);let s;return a===void 0?(s=new KN(t),e.set(r,[s])):o>=a.length?(s=new KN(t),a.push(s)):s=a[o],s}function i(){e=new WeakMap}return{get:n,dispose:i}}class Kv extends Er{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=e9,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Lv extends Er{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const Qae=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,jae=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function $ae(t,e,n){let i=new df;const r=new gt,o=new gt,a=new zn,s=new Kv({depthPacking:QZ}),l=new Lv,c={},g=n.maxTextureSize,u={[gl]:qr,[qr]:gl,[da]:da},d=new bo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new gt},radius:{value:4}},vertexShader:Qae,fragmentShader:jae}),C=d.clone();C.defines.HORIZONTAL_PASS=1;const f=new Sn;f.setAttribute("position",new Un(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new ti(f,d),p=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Rv;let m=this.type;this.render=function(S,Z,x){if(p.enabled===!1||p.autoUpdate===!1&&p.needsUpdate===!1||S.length===0)return;const R=t.getRenderTarget(),W=t.getActiveCubeFace(),M=t.getActiveMipmapLevel(),N=t.state;N.setBlending(ys),N.buffers.color.setClear(1,1,1,1),N.buffers.depth.setTest(!0),N.setScissorTest(!1);const X=m!==Ea&&this.type===Ea,E=m===Ea&&this.type!==Ea;for(let Q=0,k=S.length;Q<k;Q++){const J=S[Q],F=J.shadow;if(F===void 0){console.warn("THREE.WebGLShadowMap:",J,"has no shadow.");continue}if(F.autoUpdate===!1&&F.needsUpdate===!1)continue;r.copy(F.mapSize);const L=F.getFrameExtents();if(r.multiply(L),o.copy(F.mapSize),(r.x>g||r.y>g)&&(r.x>g&&(o.x=Math.floor(g/L.x),r.x=o.x*L.x,F.mapSize.x=o.x),r.y>g&&(o.y=Math.floor(g/L.y),r.y=o.y*L.y,F.mapSize.y=o.y)),F.map===null||X===!0||E===!0){const K=this.type!==Ea?{minFilter:rr,magFilter:rr}:{};F.map!==null&&F.map.dispose(),F.map=new Do(r.x,r.y,K),F.map.texture.name=J.name+".shadowMap",F.camera.updateProjectionMatrix()}t.setRenderTarget(F.map),t.clear();const z=F.getViewportCount();for(let K=0;K<z;K++){const O=F.getViewport(K);a.set(o.x*O.x,o.y*O.y,o.x*O.z,o.y*O.w),N.viewport(a),F.updateMatrices(J,K),i=F.getFrustum(),G(Z,x,F.camera,J,this.type)}F.isPointLightShadow!==!0&&this.type===Ea&&A(F,x),F.needsUpdate=!1}m=this.type,p.needsUpdate=!1,t.setRenderTarget(R,W,M)};function A(S,Z){const x=e.update(v);d.defines.VSM_SAMPLES!==S.blurSamples&&(d.defines.VSM_SAMPLES=S.blurSamples,C.defines.VSM_SAMPLES=S.blurSamples,d.needsUpdate=!0,C.needsUpdate=!0),S.mapPass===null&&(S.mapPass=new Do(r.x,r.y)),d.uniforms.shadow_pass.value=S.map.texture,d.uniforms.resolution.value=S.mapSize,d.uniforms.radius.value=S.radius,t.setRenderTarget(S.mapPass),t.clear(),t.renderBufferDirect(Z,null,x,d,v,null),C.uniforms.shadow_pass.value=S.mapPass.texture,C.uniforms.resolution.value=S.mapSize,C.uniforms.radius.value=S.radius,t.setRenderTarget(S.map),t.clear(),t.renderBufferDirect(Z,null,x,C,v,null)}function b(S,Z,x,R){let W=null;const M=x.isPointLight===!0?S.customDistanceMaterial:S.customDepthMaterial;if(M!==void 0)W=M;else if(W=x.isPointLight===!0?l:s,t.localClippingEnabled&&Z.clipShadows===!0&&Array.isArray(Z.clippingPlanes)&&Z.clippingPlanes.length!==0||Z.displacementMap&&Z.displacementScale!==0||Z.alphaMap&&Z.alphaTest>0||Z.map&&Z.alphaTest>0){const N=W.uuid,X=Z.uuid;let E=c[N];E===void 0&&(E={},c[N]=E);let Q=E[X];Q===void 0&&(Q=W.clone(),E[X]=Q,Z.addEventListener("dispose",w)),W=Q}if(W.visible=Z.visible,W.wireframe=Z.wireframe,R===Ea?W.side=Z.shadowSide!==null?Z.shadowSide:Z.side:W.side=Z.shadowSide!==null?Z.shadowSide:u[Z.side],W.alphaMap=Z.alphaMap,W.alphaTest=Z.alphaTest,W.map=Z.map,W.clipShadows=Z.clipShadows,W.clippingPlanes=Z.clippingPlanes,W.clipIntersection=Z.clipIntersection,W.displacementMap=Z.displacementMap,W.displacementScale=Z.displacementScale,W.displacementBias=Z.displacementBias,W.wireframeLinewidth=Z.wireframeLinewidth,W.linewidth=Z.linewidth,x.isPointLight===!0&&W.isMeshDistanceMaterial===!0){const N=t.properties.get(W);N.light=x}return W}function G(S,Z,x,R,W){if(S.visible===!1)return;if(S.layers.test(Z.layers)&&(S.isMesh||S.isLine||S.isPoints)&&(S.castShadow||S.receiveShadow&&W===Ea)&&(!S.frustumCulled||i.intersectsObject(S))){S.modelViewMatrix.multiplyMatrices(x.matrixWorldInverse,S.matrixWorld);const X=e.update(S),E=S.material;if(Array.isArray(E)){const Q=X.groups;for(let k=0,J=Q.length;k<J;k++){const F=Q[k],L=E[F.materialIndex];if(L&&L.visible){const z=b(S,L,R,W);S.onBeforeShadow(t,S,Z,x,X,z,F),t.renderBufferDirect(x,null,X,z,S,F),S.onAfterShadow(t,S,Z,x,X,z,F)}}}else if(E.visible){const Q=b(S,E,R,W);S.onBeforeShadow(t,S,Z,x,X,Q,null),t.renderBufferDirect(x,null,X,Q,S,null),S.onAfterShadow(t,S,Z,x,X,Q,null)}}const N=S.children;for(let X=0,E=N.length;X<E;X++)G(N[X],Z,x,R,W)}function w(S){S.target.removeEventListener("dispose",w);for(const x in c){const R=c[x],W=S.target.uuid;W in R&&(R[W].dispose(),delete R[W])}}}function qae(t){function e(){let ue=!1;const Pe=new zn;let be=null;const Le=new zn(0,0,0,0);return{setMask:function(ct){be!==ct&&!ue&&(t.colorMask(ct,ct,ct,ct),be=ct)},setLocked:function(ct){ue=ct},setClear:function(ct,dt,It,Vt,vt){vt===!0&&(ct*=Vt,dt*=Vt,It*=Vt),Pe.set(ct,dt,It,Vt),Le.equals(Pe)===!1&&(t.clearColor(ct,dt,It,Vt),Le.copy(Pe))},reset:function(){ue=!1,be=null,Le.set(-1,0,0,0)}}}function n(){let ue=!1,Pe=null,be=null,Le=null;return{setTest:function(ct){ct?oe(t.DEPTH_TEST):ie(t.DEPTH_TEST)},setMask:function(ct){Pe!==ct&&!ue&&(t.depthMask(ct),Pe=ct)},setFunc:function(ct){if(be!==ct){switch(ct){case Hz:t.depthFunc(t.NEVER);break;case Xz:t.depthFunc(t.ALWAYS);break;case Ez:t.depthFunc(t.LESS);break;case Ah:t.depthFunc(t.LEQUAL);break;case Yz:t.depthFunc(t.EQUAL);break;case zz:t.depthFunc(t.GEQUAL);break;case Kz:t.depthFunc(t.GREATER);break;case Lz:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}be=ct}},setLocked:function(ct){ue=ct},setClear:function(ct){Le!==ct&&(t.clearDepth(ct),Le=ct)},reset:function(){ue=!1,Pe=null,be=null,Le=null}}}function i(){let ue=!1,Pe=null,be=null,Le=null,ct=null,dt=null,It=null,Vt=null,vt=null;return{setTest:function(et){ue||(et?oe(t.STENCIL_TEST):ie(t.STENCIL_TEST))},setMask:function(et){Pe!==et&&!ue&&(t.stencilMask(et),Pe=et)},setFunc:function(et,rt,ut){(be!==et||Le!==rt||ct!==ut)&&(t.stencilFunc(et,rt,ut),be=et,Le=rt,ct=ut)},setOp:function(et,rt,ut){(dt!==et||It!==rt||Vt!==ut)&&(t.stencilOp(et,rt,ut),dt=et,It=rt,Vt=ut)},setLocked:function(et){ue=et},setClear:function(et){vt!==et&&(t.clearStencil(et),vt=et)},reset:function(){ue=!1,Pe=null,be=null,Le=null,ct=null,dt=null,It=null,Vt=null,vt=null}}}const r=new e,o=new n,a=new i,s=new WeakMap,l=new WeakMap;let c={},g={},u=new WeakMap,d=[],C=null,f=!1,v=null,p=null,m=null,A=null,b=null,G=null,w=null,S=new kt(0,0,0),Z=0,x=!1,R=null,W=null,M=null,N=null,X=null;const E=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Q=!1,k=0;const J=t.getParameter(t.VERSION);J.indexOf("WebGL")!==-1?(k=parseFloat(/^WebGL (\d)/.exec(J)[1]),Q=k>=1):J.indexOf("OpenGL ES")!==-1&&(k=parseFloat(/^OpenGL ES (\d)/.exec(J)[1]),Q=k>=2);let F=null,L={};const z=t.getParameter(t.SCISSOR_BOX),K=t.getParameter(t.VIEWPORT),O=new zn().fromArray(z),j=new zn().fromArray(K);function P(ue,Pe,be,Le){const ct=new Uint8Array(4),dt=t.createTexture();t.bindTexture(ue,dt),t.texParameteri(ue,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(ue,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let It=0;It<be;It++)ue===t.TEXTURE_3D||ue===t.TEXTURE_2D_ARRAY?t.texImage3D(Pe,0,t.RGBA,1,1,Le,0,t.RGBA,t.UNSIGNED_BYTE,ct):t.texImage2D(Pe+It,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,ct);return dt}const $={};$[t.TEXTURE_2D]=P(t.TEXTURE_2D,t.TEXTURE_2D,1),$[t.TEXTURE_CUBE_MAP]=P(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),$[t.TEXTURE_2D_ARRAY]=P(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),$[t.TEXTURE_3D]=P(t.TEXTURE_3D,t.TEXTURE_3D,1,1),r.setClear(0,0,0,1),o.setClear(1),a.setClear(0),oe(t.DEPTH_TEST),o.setFunc(Ah),he(!1),ae(vS),oe(t.CULL_FACE),Ge(ys);function oe(ue){c[ue]!==!0&&(t.enable(ue),c[ue]=!0)}function ie(ue){c[ue]!==!1&&(t.disable(ue),c[ue]=!1)}function de(ue,Pe){return g[ue]!==Pe?(t.bindFramebuffer(ue,Pe),g[ue]=Pe,ue===t.DRAW_FRAMEBUFFER&&(g[t.FRAMEBUFFER]=Pe),ue===t.FRAMEBUFFER&&(g[t.DRAW_FRAMEBUFFER]=Pe),!0):!1}function Ve(ue,Pe){let be=d,Le=!1;if(ue){be=u.get(Pe),be===void 0&&(be=[],u.set(Pe,be));const ct=ue.textures;if(be.length!==ct.length||be[0]!==t.COLOR_ATTACHMENT0){for(let dt=0,It=ct.length;dt<It;dt++)be[dt]=t.COLOR_ATTACHMENT0+dt;be.length=ct.length,Le=!0}}else be[0]!==t.BACK&&(be[0]=t.BACK,Le=!0);Le&&t.drawBuffers(be)}function Se(ue){return C!==ue?(t.useProgram(ue),C=ue,!0):!1}const me={[_l]:t.FUNC_ADD,[Az]:t.FUNC_SUBTRACT,[pz]:t.FUNC_REVERSE_SUBTRACT};me[vz]=t.MIN,me[bz]=t.MAX;const T={[yz]:t.ZERO,[Gz]:t.ONE,[Bz]:t.SRC_COLOR,[r0]:t.SRC_ALPHA,[Wz]:t.SRC_ALPHA_SATURATE,[xz]:t.DST_COLOR,[wz]:t.DST_ALPHA,[Sz]:t.ONE_MINUS_SRC_COLOR,[o0]:t.ONE_MINUS_SRC_ALPHA,[Rz]:t.ONE_MINUS_DST_COLOR,[Zz]:t.ONE_MINUS_DST_ALPHA,[Vz]:t.CONSTANT_COLOR,[Mz]:t.ONE_MINUS_CONSTANT_COLOR,[Nz]:t.CONSTANT_ALPHA,[Fz]:t.ONE_MINUS_CONSTANT_ALPHA};function Ge(ue,Pe,be,Le,ct,dt,It,Vt,vt,et){if(ue===ys){f===!0&&(ie(t.BLEND),f=!1);return}if(f===!1&&(oe(t.BLEND),f=!0),ue!==mz){if(ue!==v||et!==x){if((p!==_l||b!==_l)&&(t.blendEquation(t.FUNC_ADD),p=_l,b=_l),et)switch(ue){case Ag:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case bS:t.blendFunc(t.ONE,t.ONE);break;case yS:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case GS:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ue);break}else switch(ue){case Ag:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case bS:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case yS:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case GS:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ue);break}m=null,A=null,G=null,w=null,S.set(0,0,0),Z=0,v=ue,x=et}return}ct=ct||Pe,dt=dt||be,It=It||Le,(Pe!==p||ct!==b)&&(t.blendEquationSeparate(me[Pe],me[ct]),p=Pe,b=ct),(be!==m||Le!==A||dt!==G||It!==w)&&(t.blendFuncSeparate(T[be],T[Le],T[dt],T[It]),m=be,A=Le,G=dt,w=It),(Vt.equals(S)===!1||vt!==Z)&&(t.blendColor(Vt.r,Vt.g,Vt.b,vt),S.copy(Vt),Z=vt),v=ue,x=!1}function ne(ue,Pe){ue.side===da?ie(t.CULL_FACE):oe(t.CULL_FACE);let be=ue.side===qr;Pe&&(be=!be),he(be),ue.blending===Ag&&ue.transparent===!1?Ge(ys):Ge(ue.blending,ue.blendEquation,ue.blendSrc,ue.blendDst,ue.blendEquationAlpha,ue.blendSrcAlpha,ue.blendDstAlpha,ue.blendColor,ue.blendAlpha,ue.premultipliedAlpha),o.setFunc(ue.depthFunc),o.setTest(ue.depthTest),o.setMask(ue.depthWrite),r.setMask(ue.colorWrite);const Le=ue.stencilWrite;a.setTest(Le),Le&&(a.setMask(ue.stencilWriteMask),a.setFunc(ue.stencilFunc,ue.stencilRef,ue.stencilFuncMask),a.setOp(ue.stencilFail,ue.stencilZFail,ue.stencilZPass)),ve(ue.polygonOffset,ue.polygonOffsetFactor,ue.polygonOffsetUnits),ue.alphaToCoverage===!0?oe(t.SAMPLE_ALPHA_TO_COVERAGE):ie(t.SAMPLE_ALPHA_TO_COVERAGE)}function he(ue){R!==ue&&(ue?t.frontFace(t.CW):t.frontFace(t.CCW),R=ue)}function ae(ue){ue!==Cz?(oe(t.CULL_FACE),ue!==W&&(ue===vS?t.cullFace(t.BACK):ue===hz?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):ie(t.CULL_FACE),W=ue}function He(ue){ue!==M&&(Q&&t.lineWidth(ue),M=ue)}function ve(ue,Pe,be){ue?(oe(t.POLYGON_OFFSET_FILL),(N!==Pe||X!==be)&&(t.polygonOffset(Pe,be),N=Pe,X=be)):ie(t.POLYGON_OFFSET_FILL)}function Me(ue){ue?oe(t.SCISSOR_TEST):ie(t.SCISSOR_TEST)}function q(ue){ue===void 0&&(ue=t.TEXTURE0+E-1),F!==ue&&(t.activeTexture(ue),F=ue)}function Y(ue,Pe,be){be===void 0&&(F===null?be=t.TEXTURE0+E-1:be=F);let Le=L[be];Le===void 0&&(Le={type:void 0,texture:void 0},L[be]=Le),(Le.type!==ue||Le.texture!==Pe)&&(F!==be&&(t.activeTexture(be),F=be),t.bindTexture(ue,Pe||$[ue]),Le.type=ue,Le.texture=Pe)}function Ce(){const ue=L[F];ue!==void 0&&ue.type!==void 0&&(t.bindTexture(ue.type,null),ue.type=void 0,ue.texture=void 0)}function se(){try{t.compressedTexImage2D.apply(t,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function fe(){try{t.compressedTexImage3D.apply(t,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function Ze(){try{t.texSubImage2D.apply(t,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function Oe(){try{t.texSubImage3D.apply(t,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function Fe(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function Ee(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function Qe(){try{t.texStorage2D.apply(t,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function Ye(){try{t.texStorage3D.apply(t,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function $e(){try{t.texImage2D.apply(t,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function st(){try{t.texImage3D.apply(t,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function Ue(ue){O.equals(ue)===!1&&(t.scissor(ue.x,ue.y,ue.z,ue.w),O.copy(ue))}function Ne(ue){j.equals(ue)===!1&&(t.viewport(ue.x,ue.y,ue.z,ue.w),j.copy(ue))}function je(ue,Pe){let be=l.get(Pe);be===void 0&&(be=new WeakMap,l.set(Pe,be));let Le=be.get(ue);Le===void 0&&(Le=t.getUniformBlockIndex(Pe,ue.name),be.set(ue,Le))}function Ie(ue,Pe){const Le=l.get(Pe).get(ue);s.get(Pe)!==Le&&(t.uniformBlockBinding(Pe,Le,ue.__bindingPointIndex),s.set(Pe,Le))}function Te(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),c={},F=null,L={},g={},u=new WeakMap,d=[],C=null,f=!1,v=null,p=null,m=null,A=null,b=null,G=null,w=null,S=new kt(0,0,0),Z=0,x=!1,R=null,W=null,M=null,N=null,X=null,O.set(0,0,t.canvas.width,t.canvas.height),j.set(0,0,t.canvas.width,t.canvas.height),r.reset(),o.reset(),a.reset()}return{buffers:{color:r,depth:o,stencil:a},enable:oe,disable:ie,bindFramebuffer:de,drawBuffers:Ve,useProgram:Se,setBlending:Ge,setMaterial:ne,setFlipSided:he,setCullFace:ae,setLineWidth:He,setPolygonOffset:ve,setScissorTest:Me,activeTexture:q,bindTexture:Y,unbindTexture:Ce,compressedTexImage2D:se,compressedTexImage3D:fe,texImage2D:$e,texImage3D:st,updateUBOMapping:je,uniformBlockBinding:Ie,texStorage2D:Qe,texStorage3D:Ye,texSubImage2D:Ze,texSubImage3D:Oe,compressedTexSubImage2D:Fe,compressedTexSubImage3D:Ee,scissor:Ue,viewport:Ne,reset:Te}}function ese(t,e){const n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2):(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0),t}function tse(t,e){const n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0):(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2),t}function nse(t){return t.repeat.x=1,t.repeat.y=1,t.offset.x=0,t.offset.y=0,t}function WS(t,e,n,i){const r=ise(i);switch(n){case _Z:return t*e;case PZ:return t*e;case UZ:return t*e*2;case sf:return t*e/r.components*r.byteLength;case lf:return t*e/r.components*r.byteLength;case DZ:return t*e*2/r.components*r.byteLength;case Fv:return t*e*2/r.components*r.byteLength;case kZ:return t*e*3/r.components*r.byteLength;case Wi:return t*e*4/r.components*r.byteLength;case Hv:return t*e*4/r.components*r.byteLength;case VC:case MC:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case NC:case FC:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case s0:case c0:return Math.max(t,16)*Math.max(e,8)/4;case a0:case l0:return Math.max(t,8)*Math.max(e,8)/2;case g0:case u0:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case d0:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case I0:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case C0:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case h0:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case f0:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case m0:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case A0:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case p0:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case v0:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case b0:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case y0:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case G0:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case B0:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case S0:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case w0:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case HC:case Z0:case x0:return Math.ceil(t/4)*Math.ceil(e/4)*16;case OZ:case R0:return Math.ceil(t/4)*Math.ceil(e/4)*8;case W0:case V0:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function ise(t){switch(t){case vo:case Wv:return{byteLength:1,components:1};case Td:case Vv:case or:return{byteLength:2,components:1};case Mv:case Nv:return{byteLength:2,components:4};case ws:case af:case hi:return{byteLength:4,components:1};case TZ:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}const rse={contain:ese,cover:tse,fill:nse,getByteLength:WS};function ose(t,e,n,i,r,o,a){const s=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new gt,g=new WeakMap;let u;const d=new WeakMap;let C=!1;try{C=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function f(q,Y){return C?new OffscreenCanvas(q,Y):Rh("canvas")}function v(q,Y,Ce){let se=1;const fe=Me(q);if((fe.width>Ce||fe.height>Ce)&&(se=Ce/Math.max(fe.width,fe.height)),se<1)if(typeof HTMLImageElement<"u"&&q instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&q instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&q instanceof ImageBitmap||typeof VideoFrame<"u"&&q instanceof VideoFrame){const Ze=Math.floor(se*fe.width),Oe=Math.floor(se*fe.height);u===void 0&&(u=f(Ze,Oe));const Fe=Y?f(Ze,Oe):u;return Fe.width=Ze,Fe.height=Oe,Fe.getContext("2d").drawImage(q,0,0,Ze,Oe),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+fe.width+"x"+fe.height+") to ("+Ze+"x"+Oe+")."),Fe}else return"data"in q&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+fe.width+"x"+fe.height+")."),q;return q}function p(q){return q.generateMipmaps&&q.minFilter!==rr&&q.minFilter!==Kn}function m(q){t.generateMipmap(q)}function A(q,Y,Ce,se,fe=!1){if(q!==null){if(t[q]!==void 0)return t[q];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+q+"'")}let Ze=Y;if(Y===t.RED&&(Ce===t.FLOAT&&(Ze=t.R32F),Ce===t.HALF_FLOAT&&(Ze=t.R16F),Ce===t.UNSIGNED_BYTE&&(Ze=t.R8)),Y===t.RED_INTEGER&&(Ce===t.UNSIGNED_BYTE&&(Ze=t.R8UI),Ce===t.UNSIGNED_SHORT&&(Ze=t.R16UI),Ce===t.UNSIGNED_INT&&(Ze=t.R32UI),Ce===t.BYTE&&(Ze=t.R8I),Ce===t.SHORT&&(Ze=t.R16I),Ce===t.INT&&(Ze=t.R32I)),Y===t.RG&&(Ce===t.FLOAT&&(Ze=t.RG32F),Ce===t.HALF_FLOAT&&(Ze=t.RG16F),Ce===t.UNSIGNED_BYTE&&(Ze=t.RG8)),Y===t.RG_INTEGER&&(Ce===t.UNSIGNED_BYTE&&(Ze=t.RG8UI),Ce===t.UNSIGNED_SHORT&&(Ze=t.RG16UI),Ce===t.UNSIGNED_INT&&(Ze=t.RG32UI),Ce===t.BYTE&&(Ze=t.RG8I),Ce===t.SHORT&&(Ze=t.RG16I),Ce===t.INT&&(Ze=t.RG32I)),Y===t.RGB&&Ce===t.UNSIGNED_INT_5_9_9_9_REV&&(Ze=t.RGB9_E5),Y===t.RGBA){const Oe=fe?Bh:Yn.getTransfer(se);Ce===t.FLOAT&&(Ze=t.RGBA32F),Ce===t.HALF_FLOAT&&(Ze=t.RGBA16F),Ce===t.UNSIGNED_BYTE&&(Ze=Oe===jn?t.SRGB8_ALPHA8:t.RGBA8),Ce===t.UNSIGNED_SHORT_4_4_4_4&&(Ze=t.RGBA4),Ce===t.UNSIGNED_SHORT_5_5_5_1&&(Ze=t.RGB5_A1)}return(Ze===t.R16F||Ze===t.R32F||Ze===t.RG16F||Ze===t.RG32F||Ze===t.RGBA16F||Ze===t.RGBA32F)&&e.get("EXT_color_buffer_float"),Ze}function b(q,Y){let Ce;return q?Y===null||Y===ws||Y===Mg?Ce=t.DEPTH24_STENCIL8:Y===hi?Ce=t.DEPTH32F_STENCIL8:Y===Td&&(Ce=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):Y===null||Y===ws||Y===Mg?Ce=t.DEPTH_COMPONENT24:Y===hi?Ce=t.DEPTH_COMPONENT32F:Y===Td&&(Ce=t.DEPTH_COMPONENT16),Ce}function G(q,Y){return p(q)===!0||q.isFramebufferTexture&&q.minFilter!==rr&&q.minFilter!==Kn?Math.log2(Math.max(Y.width,Y.height))+1:q.mipmaps!==void 0&&q.mipmaps.length>0?q.mipmaps.length:q.isCompressedTexture&&Array.isArray(q.image)?Y.mipmaps.length:1}function w(q){const Y=q.target;Y.removeEventListener("dispose",w),Z(Y),Y.isVideoTexture&&g.delete(Y)}function S(q){const Y=q.target;Y.removeEventListener("dispose",S),R(Y)}function Z(q){const Y=i.get(q);if(Y.__webglInit===void 0)return;const Ce=q.source,se=d.get(Ce);if(se){const fe=se[Y.__cacheKey];fe.usedTimes--,fe.usedTimes===0&&x(q),Object.keys(se).length===0&&d.delete(Ce)}i.remove(q)}function x(q){const Y=i.get(q);t.deleteTexture(Y.__webglTexture);const Ce=q.source,se=d.get(Ce);delete se[Y.__cacheKey],a.memory.textures--}function R(q){const Y=i.get(q);if(q.depthTexture&&q.depthTexture.dispose(),q.isWebGLCubeRenderTarget)for(let se=0;se<6;se++){if(Array.isArray(Y.__webglFramebuffer[se]))for(let fe=0;fe<Y.__webglFramebuffer[se].length;fe++)t.deleteFramebuffer(Y.__webglFramebuffer[se][fe]);else t.deleteFramebuffer(Y.__webglFramebuffer[se]);Y.__webglDepthbuffer&&t.deleteRenderbuffer(Y.__webglDepthbuffer[se])}else{if(Array.isArray(Y.__webglFramebuffer))for(let se=0;se<Y.__webglFramebuffer.length;se++)t.deleteFramebuffer(Y.__webglFramebuffer[se]);else t.deleteFramebuffer(Y.__webglFramebuffer);if(Y.__webglDepthbuffer&&t.deleteRenderbuffer(Y.__webglDepthbuffer),Y.__webglMultisampledFramebuffer&&t.deleteFramebuffer(Y.__webglMultisampledFramebuffer),Y.__webglColorRenderbuffer)for(let se=0;se<Y.__webglColorRenderbuffer.length;se++)Y.__webglColorRenderbuffer[se]&&t.deleteRenderbuffer(Y.__webglColorRenderbuffer[se]);Y.__webglDepthRenderbuffer&&t.deleteRenderbuffer(Y.__webglDepthRenderbuffer)}const Ce=q.textures;for(let se=0,fe=Ce.length;se<fe;se++){const Ze=i.get(Ce[se]);Ze.__webglTexture&&(t.deleteTexture(Ze.__webglTexture),a.memory.textures--),i.remove(Ce[se])}i.remove(q)}let W=0;function M(){W=0}function N(){const q=W;return q>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+q+" texture units while this GPU supports only "+r.maxTextures),W+=1,q}function X(q){const Y=[];return Y.push(q.wrapS),Y.push(q.wrapT),Y.push(q.wrapR||0),Y.push(q.magFilter),Y.push(q.minFilter),Y.push(q.anisotropy),Y.push(q.internalFormat),Y.push(q.format),Y.push(q.type),Y.push(q.generateMipmaps),Y.push(q.premultiplyAlpha),Y.push(q.flipY),Y.push(q.unpackAlignment),Y.push(q.colorSpace),Y.join()}function E(q,Y){const Ce=i.get(q);if(q.isVideoTexture&&He(q),q.isRenderTargetTexture===!1&&q.version>0&&Ce.__version!==q.version){const se=q.image;if(se===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(se.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{j(Ce,q,Y);return}}n.bindTexture(t.TEXTURE_2D,Ce.__webglTexture,t.TEXTURE0+Y)}function Q(q,Y){const Ce=i.get(q);if(q.version>0&&Ce.__version!==q.version){j(Ce,q,Y);return}n.bindTexture(t.TEXTURE_2D_ARRAY,Ce.__webglTexture,t.TEXTURE0+Y)}function k(q,Y){const Ce=i.get(q);if(q.version>0&&Ce.__version!==q.version){j(Ce,q,Y);return}n.bindTexture(t.TEXTURE_3D,Ce.__webglTexture,t.TEXTURE0+Y)}function J(q,Y){const Ce=i.get(q);if(q.version>0&&Ce.__version!==q.version){P(Ce,q,Y);return}n.bindTexture(t.TEXTURE_CUBE_MAP,Ce.__webglTexture,t.TEXTURE0+Y)}const F={[vh]:t.REPEAT,[zi]:t.CLAMP_TO_EDGE,[bh]:t.MIRRORED_REPEAT},L={[rr]:t.NEAREST,[LZ]:t.NEAREST_MIPMAP_NEAREST,[rd]:t.NEAREST_MIPMAP_LINEAR,[Kn]:t.LINEAR,[WC]:t.LINEAR_MIPMAP_NEAREST,[ms]:t.LINEAR_MIPMAP_LINEAR},z={[n9]:t.NEVER,[l9]:t.ALWAYS,[i9]:t.LESS,[jZ]:t.LEQUAL,[r9]:t.EQUAL,[s9]:t.GEQUAL,[o9]:t.GREATER,[a9]:t.NOTEQUAL};function K(q,Y){if(Y.type===hi&&e.has("OES_texture_float_linear")===!1&&(Y.magFilter===Kn||Y.magFilter===WC||Y.magFilter===rd||Y.magFilter===ms||Y.minFilter===Kn||Y.minFilter===WC||Y.minFilter===rd||Y.minFilter===ms)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(q,t.TEXTURE_WRAP_S,F[Y.wrapS]),t.texParameteri(q,t.TEXTURE_WRAP_T,F[Y.wrapT]),(q===t.TEXTURE_3D||q===t.TEXTURE_2D_ARRAY)&&t.texParameteri(q,t.TEXTURE_WRAP_R,F[Y.wrapR]),t.texParameteri(q,t.TEXTURE_MAG_FILTER,L[Y.magFilter]),t.texParameteri(q,t.TEXTURE_MIN_FILTER,L[Y.minFilter]),Y.compareFunction&&(t.texParameteri(q,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(q,t.TEXTURE_COMPARE_FUNC,z[Y.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(Y.magFilter===rr||Y.minFilter!==rd&&Y.minFilter!==ms||Y.type===hi&&e.has("OES_texture_float_linear")===!1)return;if(Y.anisotropy>1||i.get(Y).__currentAnisotropy){const Ce=e.get("EXT_texture_filter_anisotropic");t.texParameterf(q,Ce.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Y.anisotropy,r.getMaxAnisotropy())),i.get(Y).__currentAnisotropy=Y.anisotropy}}}function O(q,Y){let Ce=!1;q.__webglInit===void 0&&(q.__webglInit=!0,Y.addEventListener("dispose",w));const se=Y.source;let fe=d.get(se);fe===void 0&&(fe={},d.set(se,fe));const Ze=X(Y);if(Ze!==q.__cacheKey){fe[Ze]===void 0&&(fe[Ze]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,Ce=!0),fe[Ze].usedTimes++;const Oe=fe[q.__cacheKey];Oe!==void 0&&(fe[q.__cacheKey].usedTimes--,Oe.usedTimes===0&&x(Y)),q.__cacheKey=Ze,q.__webglTexture=fe[Ze].texture}return Ce}function j(q,Y,Ce){let se=t.TEXTURE_2D;(Y.isDataArrayTexture||Y.isCompressedArrayTexture)&&(se=t.TEXTURE_2D_ARRAY),Y.isData3DTexture&&(se=t.TEXTURE_3D);const fe=O(q,Y),Ze=Y.source;n.bindTexture(se,q.__webglTexture,t.TEXTURE0+Ce);const Oe=i.get(Ze);if(Ze.version!==Oe.__version||fe===!0){n.activeTexture(t.TEXTURE0+Ce);const Fe=Yn.getPrimaries(Yn.workingColorSpace),Ee=Y.colorSpace===Ds?null:Yn.getPrimaries(Y.colorSpace),Qe=Y.colorSpace===Ds||Fe===Ee?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,Y.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Y.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,Y.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Qe);let Ye=v(Y.image,!1,r.maxTextureSize);Ye=ve(Y,Ye);const $e=o.convert(Y.format,Y.colorSpace),st=o.convert(Y.type);let Ue=A(Y.internalFormat,$e,st,Y.colorSpace,Y.isVideoTexture);K(se,Y);let Ne;const je=Y.mipmaps,Ie=Y.isVideoTexture!==!0,Te=Oe.__version===void 0||fe===!0,ue=Ze.dataReady,Pe=G(Y,Ye);if(Y.isDepthTexture)Ue=b(Y.format===Ng,Y.type),Te&&(Ie?n.texStorage2D(t.TEXTURE_2D,1,Ue,Ye.width,Ye.height):n.texImage2D(t.TEXTURE_2D,0,Ue,Ye.width,Ye.height,0,$e,st,null));else if(Y.isDataTexture)if(je.length>0){Ie&&Te&&n.texStorage2D(t.TEXTURE_2D,Pe,Ue,je[0].width,je[0].height);for(let be=0,Le=je.length;be<Le;be++)Ne=je[be],Ie?ue&&n.texSubImage2D(t.TEXTURE_2D,be,0,0,Ne.width,Ne.height,$e,st,Ne.data):n.texImage2D(t.TEXTURE_2D,be,Ue,Ne.width,Ne.height,0,$e,st,Ne.data);Y.generateMipmaps=!1}else Ie?(Te&&n.texStorage2D(t.TEXTURE_2D,Pe,Ue,Ye.width,Ye.height),ue&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,Ye.width,Ye.height,$e,st,Ye.data)):n.texImage2D(t.TEXTURE_2D,0,Ue,Ye.width,Ye.height,0,$e,st,Ye.data);else if(Y.isCompressedTexture)if(Y.isCompressedArrayTexture){Ie&&Te&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Pe,Ue,je[0].width,je[0].height,Ye.depth);for(let be=0,Le=je.length;be<Le;be++)if(Ne=je[be],Y.format!==Wi)if($e!==null)if(Ie){if(ue)if(Y.layerUpdates.size>0){const ct=WS(Ne.width,Ne.height,Y.format,Y.type);for(const dt of Y.layerUpdates){const It=Ne.data.subarray(dt*ct/Ne.data.BYTES_PER_ELEMENT,(dt+1)*ct/Ne.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,be,0,0,dt,Ne.width,Ne.height,1,$e,It,0,0)}Y.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,be,0,0,0,Ne.width,Ne.height,Ye.depth,$e,Ne.data,0,0)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,be,Ue,Ne.width,Ne.height,Ye.depth,0,Ne.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Ie?ue&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,be,0,0,0,Ne.width,Ne.height,Ye.depth,$e,st,Ne.data):n.texImage3D(t.TEXTURE_2D_ARRAY,be,Ue,Ne.width,Ne.height,Ye.depth,0,$e,st,Ne.data)}else{Ie&&Te&&n.texStorage2D(t.TEXTURE_2D,Pe,Ue,je[0].width,je[0].height);for(let be=0,Le=je.length;be<Le;be++)Ne=je[be],Y.format!==Wi?$e!==null?Ie?ue&&n.compressedTexSubImage2D(t.TEXTURE_2D,be,0,0,Ne.width,Ne.height,$e,Ne.data):n.compressedTexImage2D(t.TEXTURE_2D,be,Ue,Ne.width,Ne.height,0,Ne.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ie?ue&&n.texSubImage2D(t.TEXTURE_2D,be,0,0,Ne.width,Ne.height,$e,st,Ne.data):n.texImage2D(t.TEXTURE_2D,be,Ue,Ne.width,Ne.height,0,$e,st,Ne.data)}else if(Y.isDataArrayTexture)if(Ie){if(Te&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Pe,Ue,Ye.width,Ye.height,Ye.depth),ue)if(Y.layerUpdates.size>0){const be=WS(Ye.width,Ye.height,Y.format,Y.type);for(const Le of Y.layerUpdates){const ct=Ye.data.subarray(Le*be/Ye.data.BYTES_PER_ELEMENT,(Le+1)*be/Ye.data.BYTES_PER_ELEMENT);n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,Le,Ye.width,Ye.height,1,$e,st,ct)}Y.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,Ye.width,Ye.height,Ye.depth,$e,st,Ye.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,Ue,Ye.width,Ye.height,Ye.depth,0,$e,st,Ye.data);else if(Y.isData3DTexture)Ie?(Te&&n.texStorage3D(t.TEXTURE_3D,Pe,Ue,Ye.width,Ye.height,Ye.depth),ue&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,Ye.width,Ye.height,Ye.depth,$e,st,Ye.data)):n.texImage3D(t.TEXTURE_3D,0,Ue,Ye.width,Ye.height,Ye.depth,0,$e,st,Ye.data);else if(Y.isFramebufferTexture){if(Te)if(Ie)n.texStorage2D(t.TEXTURE_2D,Pe,Ue,Ye.width,Ye.height);else{let be=Ye.width,Le=Ye.height;for(let ct=0;ct<Pe;ct++)n.texImage2D(t.TEXTURE_2D,ct,Ue,be,Le,0,$e,st,null),be>>=1,Le>>=1}}else if(je.length>0){if(Ie&&Te){const be=Me(je[0]);n.texStorage2D(t.TEXTURE_2D,Pe,Ue,be.width,be.height)}for(let be=0,Le=je.length;be<Le;be++)Ne=je[be],Ie?ue&&n.texSubImage2D(t.TEXTURE_2D,be,0,0,$e,st,Ne):n.texImage2D(t.TEXTURE_2D,be,Ue,$e,st,Ne);Y.generateMipmaps=!1}else if(Ie){if(Te){const be=Me(Ye);n.texStorage2D(t.TEXTURE_2D,Pe,Ue,be.width,be.height)}ue&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,$e,st,Ye)}else n.texImage2D(t.TEXTURE_2D,0,Ue,$e,st,Ye);p(Y)&&m(se),Oe.__version=Ze.version,Y.onUpdate&&Y.onUpdate(Y)}q.__version=Y.version}function P(q,Y,Ce){if(Y.image.length!==6)return;const se=O(q,Y),fe=Y.source;n.bindTexture(t.TEXTURE_CUBE_MAP,q.__webglTexture,t.TEXTURE0+Ce);const Ze=i.get(fe);if(fe.version!==Ze.__version||se===!0){n.activeTexture(t.TEXTURE0+Ce);const Oe=Yn.getPrimaries(Yn.workingColorSpace),Fe=Y.colorSpace===Ds?null:Yn.getPrimaries(Y.colorSpace),Ee=Y.colorSpace===Ds||Oe===Fe?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,Y.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Y.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,Y.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ee);const Qe=Y.isCompressedTexture||Y.image[0].isCompressedTexture,Ye=Y.image[0]&&Y.image[0].isDataTexture,$e=[];for(let Le=0;Le<6;Le++)!Qe&&!Ye?$e[Le]=v(Y.image[Le],!0,r.maxCubemapSize):$e[Le]=Ye?Y.image[Le].image:Y.image[Le],$e[Le]=ve(Y,$e[Le]);const st=$e[0],Ue=o.convert(Y.format,Y.colorSpace),Ne=o.convert(Y.type),je=A(Y.internalFormat,Ue,Ne,Y.colorSpace),Ie=Y.isVideoTexture!==!0,Te=Ze.__version===void 0||se===!0,ue=fe.dataReady;let Pe=G(Y,st);K(t.TEXTURE_CUBE_MAP,Y);let be;if(Qe){Ie&&Te&&n.texStorage2D(t.TEXTURE_CUBE_MAP,Pe,je,st.width,st.height);for(let Le=0;Le<6;Le++){be=$e[Le].mipmaps;for(let ct=0;ct<be.length;ct++){const dt=be[ct];Y.format!==Wi?Ue!==null?Ie?ue&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Le,ct,0,0,dt.width,dt.height,Ue,dt.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Le,ct,je,dt.width,dt.height,0,dt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ie?ue&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Le,ct,0,0,dt.width,dt.height,Ue,Ne,dt.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Le,ct,je,dt.width,dt.height,0,Ue,Ne,dt.data)}}}else{if(be=Y.mipmaps,Ie&&Te){be.length>0&&Pe++;const Le=Me($e[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,Pe,je,Le.width,Le.height)}for(let Le=0;Le<6;Le++)if(Ye){Ie?ue&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Le,0,0,0,$e[Le].width,$e[Le].height,Ue,Ne,$e[Le].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Le,0,je,$e[Le].width,$e[Le].height,0,Ue,Ne,$e[Le].data);for(let ct=0;ct<be.length;ct++){const It=be[ct].image[Le].image;Ie?ue&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Le,ct+1,0,0,It.width,It.height,Ue,Ne,It.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Le,ct+1,je,It.width,It.height,0,Ue,Ne,It.data)}}else{Ie?ue&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Le,0,0,0,Ue,Ne,$e[Le]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Le,0,je,Ue,Ne,$e[Le]);for(let ct=0;ct<be.length;ct++){const dt=be[ct];Ie?ue&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Le,ct+1,0,0,Ue,Ne,dt.image[Le]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Le,ct+1,je,Ue,Ne,dt.image[Le])}}}p(Y)&&m(t.TEXTURE_CUBE_MAP),Ze.__version=fe.version,Y.onUpdate&&Y.onUpdate(Y)}q.__version=Y.version}function $(q,Y,Ce,se,fe,Ze){const Oe=o.convert(Ce.format,Ce.colorSpace),Fe=o.convert(Ce.type),Ee=A(Ce.internalFormat,Oe,Fe,Ce.colorSpace);if(!i.get(Y).__hasExternalTextures){const Ye=Math.max(1,Y.width>>Ze),$e=Math.max(1,Y.height>>Ze);fe===t.TEXTURE_3D||fe===t.TEXTURE_2D_ARRAY?n.texImage3D(fe,Ze,Ee,Ye,$e,Y.depth,0,Oe,Fe,null):n.texImage2D(fe,Ze,Ee,Ye,$e,0,Oe,Fe,null)}n.bindFramebuffer(t.FRAMEBUFFER,q),ae(Y)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,se,fe,i.get(Ce).__webglTexture,0,he(Y)):(fe===t.TEXTURE_2D||fe>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&fe<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,se,fe,i.get(Ce).__webglTexture,Ze),n.bindFramebuffer(t.FRAMEBUFFER,null)}function oe(q,Y,Ce){if(t.bindRenderbuffer(t.RENDERBUFFER,q),Y.depthBuffer){const se=Y.depthTexture,fe=se&&se.isDepthTexture?se.type:null,Ze=b(Y.stencilBuffer,fe),Oe=Y.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Fe=he(Y);ae(Y)?s.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Fe,Ze,Y.width,Y.height):Ce?t.renderbufferStorageMultisample(t.RENDERBUFFER,Fe,Ze,Y.width,Y.height):t.renderbufferStorage(t.RENDERBUFFER,Ze,Y.width,Y.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,Oe,t.RENDERBUFFER,q)}else{const se=Y.textures;for(let fe=0;fe<se.length;fe++){const Ze=se[fe],Oe=o.convert(Ze.format,Ze.colorSpace),Fe=o.convert(Ze.type),Ee=A(Ze.internalFormat,Oe,Fe,Ze.colorSpace),Qe=he(Y);Ce&&ae(Y)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,Qe,Ee,Y.width,Y.height):ae(Y)?s.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Qe,Ee,Y.width,Y.height):t.renderbufferStorage(t.RENDERBUFFER,Ee,Y.width,Y.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function ie(q,Y){if(Y&&Y.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,q),!(Y.depthTexture&&Y.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(Y.depthTexture).__webglTexture||Y.depthTexture.image.width!==Y.width||Y.depthTexture.image.height!==Y.height)&&(Y.depthTexture.image.width=Y.width,Y.depthTexture.image.height=Y.height,Y.depthTexture.needsUpdate=!0),E(Y.depthTexture,0);const se=i.get(Y.depthTexture).__webglTexture,fe=he(Y);if(Y.depthTexture.format===pg)ae(Y)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,se,0,fe):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,se,0);else if(Y.depthTexture.format===Ng)ae(Y)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,se,0,fe):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,se,0);else throw new Error("Unknown depthTexture format")}function de(q){const Y=i.get(q),Ce=q.isWebGLCubeRenderTarget===!0;if(Y.__boundDepthTexture!==q.depthTexture){const se=q.depthTexture;if(Y.__depthDisposeCallback&&Y.__depthDisposeCallback(),se){const fe=()=>{delete Y.__boundDepthTexture,delete Y.__depthDisposeCallback,se.removeEventListener("dispose",fe)};se.addEventListener("dispose",fe),Y.__depthDisposeCallback=fe}Y.__boundDepthTexture=se}if(q.depthTexture&&!Y.__autoAllocateDepthBuffer){if(Ce)throw new Error("target.depthTexture not supported in Cube render targets");ie(Y.__webglFramebuffer,q)}else if(Ce){Y.__webglDepthbuffer=[];for(let se=0;se<6;se++)if(n.bindFramebuffer(t.FRAMEBUFFER,Y.__webglFramebuffer[se]),Y.__webglDepthbuffer[se]===void 0)Y.__webglDepthbuffer[se]=t.createRenderbuffer(),oe(Y.__webglDepthbuffer[se],q,!1);else{const fe=q.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ze=Y.__webglDepthbuffer[se];t.bindRenderbuffer(t.RENDERBUFFER,Ze),t.framebufferRenderbuffer(t.FRAMEBUFFER,fe,t.RENDERBUFFER,Ze)}}else if(n.bindFramebuffer(t.FRAMEBUFFER,Y.__webglFramebuffer),Y.__webglDepthbuffer===void 0)Y.__webglDepthbuffer=t.createRenderbuffer(),oe(Y.__webglDepthbuffer,q,!1);else{const se=q.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,fe=Y.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,fe),t.framebufferRenderbuffer(t.FRAMEBUFFER,se,t.RENDERBUFFER,fe)}n.bindFramebuffer(t.FRAMEBUFFER,null)}function Ve(q,Y,Ce){const se=i.get(q);Y!==void 0&&$(se.__webglFramebuffer,q,q.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),Ce!==void 0&&de(q)}function Se(q){const Y=q.texture,Ce=i.get(q),se=i.get(Y);q.addEventListener("dispose",S);const fe=q.textures,Ze=q.isWebGLCubeRenderTarget===!0,Oe=fe.length>1;if(Oe||(se.__webglTexture===void 0&&(se.__webglTexture=t.createTexture()),se.__version=Y.version,a.memory.textures++),Ze){Ce.__webglFramebuffer=[];for(let Fe=0;Fe<6;Fe++)if(Y.mipmaps&&Y.mipmaps.length>0){Ce.__webglFramebuffer[Fe]=[];for(let Ee=0;Ee<Y.mipmaps.length;Ee++)Ce.__webglFramebuffer[Fe][Ee]=t.createFramebuffer()}else Ce.__webglFramebuffer[Fe]=t.createFramebuffer()}else{if(Y.mipmaps&&Y.mipmaps.length>0){Ce.__webglFramebuffer=[];for(let Fe=0;Fe<Y.mipmaps.length;Fe++)Ce.__webglFramebuffer[Fe]=t.createFramebuffer()}else Ce.__webglFramebuffer=t.createFramebuffer();if(Oe)for(let Fe=0,Ee=fe.length;Fe<Ee;Fe++){const Qe=i.get(fe[Fe]);Qe.__webglTexture===void 0&&(Qe.__webglTexture=t.createTexture(),a.memory.textures++)}if(q.samples>0&&ae(q)===!1){Ce.__webglMultisampledFramebuffer=t.createFramebuffer(),Ce.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,Ce.__webglMultisampledFramebuffer);for(let Fe=0;Fe<fe.length;Fe++){const Ee=fe[Fe];Ce.__webglColorRenderbuffer[Fe]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,Ce.__webglColorRenderbuffer[Fe]);const Qe=o.convert(Ee.format,Ee.colorSpace),Ye=o.convert(Ee.type),$e=A(Ee.internalFormat,Qe,Ye,Ee.colorSpace,q.isXRRenderTarget===!0),st=he(q);t.renderbufferStorageMultisample(t.RENDERBUFFER,st,$e,q.width,q.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Fe,t.RENDERBUFFER,Ce.__webglColorRenderbuffer[Fe])}t.bindRenderbuffer(t.RENDERBUFFER,null),q.depthBuffer&&(Ce.__webglDepthRenderbuffer=t.createRenderbuffer(),oe(Ce.__webglDepthRenderbuffer,q,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Ze){n.bindTexture(t.TEXTURE_CUBE_MAP,se.__webglTexture),K(t.TEXTURE_CUBE_MAP,Y);for(let Fe=0;Fe<6;Fe++)if(Y.mipmaps&&Y.mipmaps.length>0)for(let Ee=0;Ee<Y.mipmaps.length;Ee++)$(Ce.__webglFramebuffer[Fe][Ee],q,Y,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,Ee);else $(Ce.__webglFramebuffer[Fe],q,Y,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,0);p(Y)&&m(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(Oe){for(let Fe=0,Ee=fe.length;Fe<Ee;Fe++){const Qe=fe[Fe],Ye=i.get(Qe);n.bindTexture(t.TEXTURE_2D,Ye.__webglTexture),K(t.TEXTURE_2D,Qe),$(Ce.__webglFramebuffer,q,Qe,t.COLOR_ATTACHMENT0+Fe,t.TEXTURE_2D,0),p(Qe)&&m(t.TEXTURE_2D)}n.unbindTexture()}else{let Fe=t.TEXTURE_2D;if((q.isWebGL3DRenderTarget||q.isWebGLArrayRenderTarget)&&(Fe=q.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(Fe,se.__webglTexture),K(Fe,Y),Y.mipmaps&&Y.mipmaps.length>0)for(let Ee=0;Ee<Y.mipmaps.length;Ee++)$(Ce.__webglFramebuffer[Ee],q,Y,t.COLOR_ATTACHMENT0,Fe,Ee);else $(Ce.__webglFramebuffer,q,Y,t.COLOR_ATTACHMENT0,Fe,0);p(Y)&&m(Fe),n.unbindTexture()}q.depthBuffer&&de(q)}function me(q){const Y=q.textures;for(let Ce=0,se=Y.length;Ce<se;Ce++){const fe=Y[Ce];if(p(fe)){const Ze=q.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,Oe=i.get(fe).__webglTexture;n.bindTexture(Ze,Oe),m(Ze),n.unbindTexture()}}}const T=[],Ge=[];function ne(q){if(q.samples>0){if(ae(q)===!1){const Y=q.textures,Ce=q.width,se=q.height;let fe=t.COLOR_BUFFER_BIT;const Ze=q.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Oe=i.get(q),Fe=Y.length>1;if(Fe)for(let Ee=0;Ee<Y.length;Ee++)n.bindFramebuffer(t.FRAMEBUFFER,Oe.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ee,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,Oe.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ee,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,Oe.__webglMultisampledFramebuffer),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,Oe.__webglFramebuffer);for(let Ee=0;Ee<Y.length;Ee++){if(q.resolveDepthBuffer&&(q.depthBuffer&&(fe|=t.DEPTH_BUFFER_BIT),q.stencilBuffer&&q.resolveStencilBuffer&&(fe|=t.STENCIL_BUFFER_BIT)),Fe){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,Oe.__webglColorRenderbuffer[Ee]);const Qe=i.get(Y[Ee]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,Qe,0)}t.blitFramebuffer(0,0,Ce,se,0,0,Ce,se,fe,t.NEAREST),l===!0&&(T.length=0,Ge.length=0,T.push(t.COLOR_ATTACHMENT0+Ee),q.depthBuffer&&q.resolveDepthBuffer===!1&&(T.push(Ze),Ge.push(Ze),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,Ge)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,T))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),Fe)for(let Ee=0;Ee<Y.length;Ee++){n.bindFramebuffer(t.FRAMEBUFFER,Oe.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ee,t.RENDERBUFFER,Oe.__webglColorRenderbuffer[Ee]);const Qe=i.get(Y[Ee]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,Oe.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ee,t.TEXTURE_2D,Qe,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,Oe.__webglMultisampledFramebuffer)}else if(q.depthBuffer&&q.resolveDepthBuffer===!1&&l){const Y=q.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[Y])}}}function he(q){return Math.min(r.maxSamples,q.samples)}function ae(q){const Y=i.get(q);return q.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&Y.__useRenderToTexture!==!1}function He(q){const Y=a.render.frame;g.get(q)!==Y&&(g.set(q,Y),q.update())}function ve(q,Y){const Ce=q.colorSpace,se=q.format,fe=q.type;return q.isCompressedTexture===!0||q.isVideoTexture===!0||Ce!==pa&&Ce!==Ds&&(Yn.getTransfer(Ce)===jn?(se!==Wi||fe!==vo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ce)),Y}function Me(q){return typeof HTMLImageElement<"u"&&q instanceof HTMLImageElement?(c.width=q.naturalWidth||q.width,c.height=q.naturalHeight||q.height):typeof VideoFrame<"u"&&q instanceof VideoFrame?(c.width=q.displayWidth,c.height=q.displayHeight):(c.width=q.width,c.height=q.height),c}this.allocateTextureUnit=N,this.resetTextureUnits=M,this.setTexture2D=E,this.setTexture2DArray=Q,this.setTexture3D=k,this.setTextureCube=J,this.rebindTextures=Ve,this.setupRenderTarget=Se,this.updateRenderTargetMipmap=me,this.updateMultisampleRenderTarget=ne,this.setupDepthRenderbuffer=de,this.setupFrameBufferTexture=$,this.useMultisampledRTT=ae}function y9(t,e){function n(i,r=Ds){let o;const a=Yn.getTransfer(r);if(i===vo)return t.UNSIGNED_BYTE;if(i===Mv)return t.UNSIGNED_SHORT_4_4_4_4;if(i===Nv)return t.UNSIGNED_SHORT_5_5_5_1;if(i===TZ)return t.UNSIGNED_INT_5_9_9_9_REV;if(i===Wv)return t.BYTE;if(i===Vv)return t.SHORT;if(i===Td)return t.UNSIGNED_SHORT;if(i===af)return t.INT;if(i===ws)return t.UNSIGNED_INT;if(i===hi)return t.FLOAT;if(i===or)return t.HALF_FLOAT;if(i===_Z)return t.ALPHA;if(i===kZ)return t.RGB;if(i===Wi)return t.RGBA;if(i===PZ)return t.LUMINANCE;if(i===UZ)return t.LUMINANCE_ALPHA;if(i===pg)return t.DEPTH_COMPONENT;if(i===Ng)return t.DEPTH_STENCIL;if(i===sf)return t.RED;if(i===lf)return t.RED_INTEGER;if(i===DZ)return t.RG;if(i===Fv)return t.RG_INTEGER;if(i===Hv)return t.RGBA_INTEGER;if(i===VC||i===MC||i===NC||i===FC)if(a===jn)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(i===VC)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===MC)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===NC)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===FC)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(i===VC)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===MC)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===NC)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===FC)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===a0||i===s0||i===l0||i===c0)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(i===a0)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===s0)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===l0)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===c0)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===g0||i===u0||i===d0)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(i===g0||i===u0)return a===jn?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(i===d0)return a===jn?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===I0||i===C0||i===h0||i===f0||i===m0||i===A0||i===p0||i===v0||i===b0||i===y0||i===G0||i===B0||i===S0||i===w0)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(i===I0)return a===jn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===C0)return a===jn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===h0)return a===jn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===f0)return a===jn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===m0)return a===jn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===A0)return a===jn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===p0)return a===jn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===v0)return a===jn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===b0)return a===jn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===y0)return a===jn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===G0)return a===jn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===B0)return a===jn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===S0)return a===jn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===w0)return a===jn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===HC||i===Z0||i===x0)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(i===HC)return a===jn?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===Z0)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===x0)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===OZ||i===R0||i===W0||i===V0)if(o=e.get("EXT_texture_compression_rgtc"),o!==null){if(i===HC)return o.COMPRESSED_RED_RGTC1_EXT;if(i===R0)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===W0)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===V0)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===Mg?t.UNSIGNED_INT_24_8:t[i]!==void 0?t[i]:null}return{convert:n}}class G9 extends Ri{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class sd extends Vn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const ase={type:"move"};class XG{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new sd,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new sd,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ge,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ge),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new sd,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ge,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ge),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const i of e.hand.values())this._getHandJoint(n,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,i){let r=null,o=null,a=null;const s=this._targetRay,l=this._grip,c=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(c&&e.hand){a=!0;for(const v of e.hand.values()){const p=n.getJointPose(v,i),m=this._getHandJoint(c,v);p!==null&&(m.matrix.fromArray(p.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,m.jointRadius=p.radius),m.visible=p!==null}const g=c.joints["index-finger-tip"],u=c.joints["thumb-tip"],d=g.position.distanceTo(u.position),C=.02,f=.005;c.inputState.pinching&&d>C+f?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&d<=C-f&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(o=n.getPose(e.gripSpace,i),o!==null&&(l.matrix.fromArray(o.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,o.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(o.linearVelocity)):l.hasLinearVelocity=!1,o.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(o.angularVelocity)):l.hasAngularVelocity=!1));s!==null&&(r=n.getPose(e.targetRaySpace,i),r===null&&o!==null&&(r=o),r!==null&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(ase)))}return s!==null&&(s.visible=r!==null),l!==null&&(l.visible=o!==null),c!==null&&(c.visible=a!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const i=new sd;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[n.jointName]=i,e.add(i)}return e.joints[n.jointName]}}const sse=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,lse=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class cse{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n,i){if(this.texture===null){const r=new Tn,o=e.properties.get(r);o.__webglTexture=n.texture,(n.depthNear!=i.depthNear||n.depthFar!=i.depthFar)&&(this.depthNear=n.depthNear,this.depthFar=n.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const n=e.cameras[0].viewport,i=new bo({vertexShader:sse,fragmentShader:lse,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new ti(new qa(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class gse extends xs{constructor(e,n){super();const i=this;let r=null,o=1,a=null,s="local-floor",l=1,c=null,g=null,u=null,d=null,C=null,f=null;const v=new cse,p=n.getContextAttributes();let m=null,A=null;const b=[],G=[],w=new gt;let S=null;const Z=new Ri;Z.layers.enable(1),Z.viewport=new zn;const x=new Ri;x.layers.enable(2),x.viewport=new zn;const R=[Z,x],W=new G9;W.layers.enable(1),W.layers.enable(2);let M=null,N=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(P){let $=b[P];return $===void 0&&($=new XG,b[P]=$),$.getTargetRaySpace()},this.getControllerGrip=function(P){let $=b[P];return $===void 0&&($=new XG,b[P]=$),$.getGripSpace()},this.getHand=function(P){let $=b[P];return $===void 0&&($=new XG,b[P]=$),$.getHandSpace()};function X(P){const $=G.indexOf(P.inputSource);if($===-1)return;const oe=b[$];oe!==void 0&&(oe.update(P.inputSource,P.frame,c||a),oe.dispatchEvent({type:P.type,data:P.inputSource}))}function E(){r.removeEventListener("select",X),r.removeEventListener("selectstart",X),r.removeEventListener("selectend",X),r.removeEventListener("squeeze",X),r.removeEventListener("squeezestart",X),r.removeEventListener("squeezeend",X),r.removeEventListener("end",E),r.removeEventListener("inputsourceschange",Q);for(let P=0;P<b.length;P++){const $=G[P];$!==null&&(G[P]=null,b[P].disconnect($))}M=null,N=null,v.reset(),e.setRenderTarget(m),C=null,d=null,u=null,r=null,A=null,j.stop(),i.isPresenting=!1,e.setPixelRatio(S),e.setSize(w.width,w.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(P){o=P,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(P){s=P,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||a},this.setReferenceSpace=function(P){c=P},this.getBaseLayer=function(){return d!==null?d:C},this.getBinding=function(){return u},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=async function(P){if(r=P,r!==null){if(m=e.getRenderTarget(),r.addEventListener("select",X),r.addEventListener("selectstart",X),r.addEventListener("selectend",X),r.addEventListener("squeeze",X),r.addEventListener("squeezestart",X),r.addEventListener("squeezeend",X),r.addEventListener("end",E),r.addEventListener("inputsourceschange",Q),p.xrCompatible!==!0&&await n.makeXRCompatible(),S=e.getPixelRatio(),e.getSize(w),r.renderState.layers===void 0){const $={antialias:p.antialias,alpha:!0,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:o};C=new XRWebGLLayer(r,n,$),r.updateRenderState({baseLayer:C}),e.setPixelRatio(1),e.setSize(C.framebufferWidth,C.framebufferHeight,!1),A=new Do(C.framebufferWidth,C.framebufferHeight,{format:Wi,type:vo,colorSpace:e.outputColorSpace,stencilBuffer:p.stencil})}else{let $=null,oe=null,ie=null;p.depth&&(ie=p.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,$=p.stencil?Ng:pg,oe=p.stencil?Mg:ws);const de={colorFormat:n.RGBA8,depthFormat:ie,scaleFactor:o};u=new XRWebGLBinding(r,n),d=u.createProjectionLayer(de),r.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),A=new Do(d.textureWidth,d.textureHeight,{format:Wi,type:vo,depthTexture:new o1(d.textureWidth,d.textureHeight,oe,void 0,void 0,void 0,void 0,void 0,void 0,$),stencilBuffer:p.stencil,colorSpace:e.outputColorSpace,samples:p.antialias?4:0,resolveDepthBuffer:d.ignoreDepthValues===!1})}A.isXRRenderTarget=!0,this.setFoveation(l),c=null,a=await r.requestReferenceSpace(s),j.setContext(r),j.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return v.getDepthTexture()};function Q(P){for(let $=0;$<P.removed.length;$++){const oe=P.removed[$],ie=G.indexOf(oe);ie>=0&&(G[ie]=null,b[ie].disconnect(oe))}for(let $=0;$<P.added.length;$++){const oe=P.added[$];let ie=G.indexOf(oe);if(ie===-1){for(let Ve=0;Ve<b.length;Ve++)if(Ve>=G.length){G.push(oe),ie=Ve;break}else if(G[Ve]===null){G[Ve]=oe,ie=Ve;break}if(ie===-1)break}const de=b[ie];de&&de.connect(oe)}}const k=new ge,J=new ge;function F(P,$,oe){k.setFromMatrixPosition($.matrixWorld),J.setFromMatrixPosition(oe.matrixWorld);const ie=k.distanceTo(J),de=$.projectionMatrix.elements,Ve=oe.projectionMatrix.elements,Se=de[14]/(de[10]-1),me=de[14]/(de[10]+1),T=(de[9]+1)/de[5],Ge=(de[9]-1)/de[5],ne=(de[8]-1)/de[0],he=(Ve[8]+1)/Ve[0],ae=Se*ne,He=Se*he,ve=ie/(-ne+he),Me=ve*-ne;if($.matrixWorld.decompose(P.position,P.quaternion,P.scale),P.translateX(Me),P.translateZ(ve),P.matrixWorld.compose(P.position,P.quaternion,P.scale),P.matrixWorldInverse.copy(P.matrixWorld).invert(),de[10]===-1)P.projectionMatrix.copy($.projectionMatrix),P.projectionMatrixInverse.copy($.projectionMatrixInverse);else{const q=Se+ve,Y=me+ve,Ce=ae-Me,se=He+(ie-Me),fe=T*me/Y*q,Ze=Ge*me/Y*q;P.projectionMatrix.makePerspective(Ce,se,fe,Ze,q,Y),P.projectionMatrixInverse.copy(P.projectionMatrix).invert()}}function L(P,$){$===null?P.matrixWorld.copy(P.matrix):P.matrixWorld.multiplyMatrices($.matrixWorld,P.matrix),P.matrixWorldInverse.copy(P.matrixWorld).invert()}this.updateCamera=function(P){if(r===null)return;let $=P.near,oe=P.far;v.texture!==null&&(v.depthNear>0&&($=v.depthNear),v.depthFar>0&&(oe=v.depthFar)),W.near=x.near=Z.near=$,W.far=x.far=Z.far=oe,(M!==W.near||N!==W.far)&&(r.updateRenderState({depthNear:W.near,depthFar:W.far}),M=W.near,N=W.far);const ie=P.parent,de=W.cameras;L(W,ie);for(let Ve=0;Ve<de.length;Ve++)L(de[Ve],ie);de.length===2?F(W,Z,x):W.projectionMatrix.copy(Z.projectionMatrix),z(P,W,ie)};function z(P,$,oe){oe===null?P.matrix.copy($.matrixWorld):(P.matrix.copy(oe.matrixWorld),P.matrix.invert(),P.matrix.multiply($.matrixWorld)),P.matrix.decompose(P.position,P.quaternion,P.scale),P.updateMatrixWorld(!0),P.projectionMatrix.copy($.projectionMatrix),P.projectionMatrixInverse.copy($.projectionMatrixInverse),P.isPerspectiveCamera&&(P.fov=_d*2*Math.atan(1/P.projectionMatrix.elements[5]),P.zoom=1)}this.getCamera=function(){return W},this.getFoveation=function(){if(!(d===null&&C===null))return l},this.setFoveation=function(P){l=P,d!==null&&(d.fixedFoveation=P),C!==null&&C.fixedFoveation!==void 0&&(C.fixedFoveation=P)},this.hasDepthSensing=function(){return v.texture!==null},this.getDepthSensingMesh=function(){return v.getMesh(W)};let K=null;function O(P,$){if(g=$.getViewerPose(c||a),f=$,g!==null){const oe=g.views;C!==null&&(e.setRenderTargetFramebuffer(A,C.framebuffer),e.setRenderTarget(A));let ie=!1;oe.length!==W.cameras.length&&(W.cameras.length=0,ie=!0);for(let Ve=0;Ve<oe.length;Ve++){const Se=oe[Ve];let me=null;if(C!==null)me=C.getViewport(Se);else{const Ge=u.getViewSubImage(d,Se);me=Ge.viewport,Ve===0&&(e.setRenderTargetTextures(A,Ge.colorTexture,d.ignoreDepthValues?void 0:Ge.depthStencilTexture),e.setRenderTarget(A))}let T=R[Ve];T===void 0&&(T=new Ri,T.layers.enable(Ve),T.viewport=new zn,R[Ve]=T),T.matrix.fromArray(Se.transform.matrix),T.matrix.decompose(T.position,T.quaternion,T.scale),T.projectionMatrix.fromArray(Se.projectionMatrix),T.projectionMatrixInverse.copy(T.projectionMatrix).invert(),T.viewport.set(me.x,me.y,me.width,me.height),Ve===0&&(W.matrix.copy(T.matrix),W.matrix.decompose(W.position,W.quaternion,W.scale)),ie===!0&&W.cameras.push(T)}const de=r.enabledFeatures;if(de&&de.includes("depth-sensing")){const Ve=u.getDepthInformation(oe[0]);Ve&&Ve.isValid&&Ve.texture&&v.init(e,Ve,r.renderState)}}for(let oe=0;oe<b.length;oe++){const ie=G[oe],de=b[oe];ie!==null&&de!==void 0&&de.update(ie,$,c||a)}K&&K(P,$),$.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:$}),f=null}const j=new m9;j.setAnimationLoop(O),this.setAnimationLoop=function(P){K=P},this.dispose=function(){}}}const Yc=new Ei,use=new ln;function dse(t,e){function n(p,m){p.matrixAutoUpdate===!0&&p.updateMatrix(),m.value.copy(p.matrix)}function i(p,m){m.color.getRGB(p.fogColor.value,h9(t)),m.isFog?(p.fogNear.value=m.near,p.fogFar.value=m.far):m.isFogExp2&&(p.fogDensity.value=m.density)}function r(p,m,A,b,G){m.isMeshBasicMaterial||m.isMeshLambertMaterial?o(p,m):m.isMeshToonMaterial?(o(p,m),u(p,m)):m.isMeshPhongMaterial?(o(p,m),g(p,m)):m.isMeshStandardMaterial?(o(p,m),d(p,m),m.isMeshPhysicalMaterial&&C(p,m,G)):m.isMeshMatcapMaterial?(o(p,m),f(p,m)):m.isMeshDepthMaterial?o(p,m):m.isMeshDistanceMaterial?(o(p,m),v(p,m)):m.isMeshNormalMaterial?o(p,m):m.isLineBasicMaterial?(a(p,m),m.isLineDashedMaterial&&s(p,m)):m.isPointsMaterial?l(p,m,A,b):m.isSpriteMaterial?c(p,m):m.isShadowMaterial?(p.color.value.copy(m.color),p.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function o(p,m){p.opacity.value=m.opacity,m.color&&p.diffuse.value.copy(m.color),m.emissive&&p.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(p.map.value=m.map,n(m.map,p.mapTransform)),m.alphaMap&&(p.alphaMap.value=m.alphaMap,n(m.alphaMap,p.alphaMapTransform)),m.bumpMap&&(p.bumpMap.value=m.bumpMap,n(m.bumpMap,p.bumpMapTransform),p.bumpScale.value=m.bumpScale,m.side===qr&&(p.bumpScale.value*=-1)),m.normalMap&&(p.normalMap.value=m.normalMap,n(m.normalMap,p.normalMapTransform),p.normalScale.value.copy(m.normalScale),m.side===qr&&p.normalScale.value.negate()),m.displacementMap&&(p.displacementMap.value=m.displacementMap,n(m.displacementMap,p.displacementMapTransform),p.displacementScale.value=m.displacementScale,p.displacementBias.value=m.displacementBias),m.emissiveMap&&(p.emissiveMap.value=m.emissiveMap,n(m.emissiveMap,p.emissiveMapTransform)),m.specularMap&&(p.specularMap.value=m.specularMap,n(m.specularMap,p.specularMapTransform)),m.alphaTest>0&&(p.alphaTest.value=m.alphaTest);const A=e.get(m),b=A.envMap,G=A.envMapRotation;b&&(p.envMap.value=b,Yc.copy(G),Yc.x*=-1,Yc.y*=-1,Yc.z*=-1,b.isCubeTexture&&b.isRenderTargetTexture===!1&&(Yc.y*=-1,Yc.z*=-1),p.envMapRotation.value.setFromMatrix4(use.makeRotationFromEuler(Yc)),p.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,p.reflectivity.value=m.reflectivity,p.ior.value=m.ior,p.refractionRatio.value=m.refractionRatio),m.lightMap&&(p.lightMap.value=m.lightMap,p.lightMapIntensity.value=m.lightMapIntensity,n(m.lightMap,p.lightMapTransform)),m.aoMap&&(p.aoMap.value=m.aoMap,p.aoMapIntensity.value=m.aoMapIntensity,n(m.aoMap,p.aoMapTransform))}function a(p,m){p.diffuse.value.copy(m.color),p.opacity.value=m.opacity,m.map&&(p.map.value=m.map,n(m.map,p.mapTransform))}function s(p,m){p.dashSize.value=m.dashSize,p.totalSize.value=m.dashSize+m.gapSize,p.scale.value=m.scale}function l(p,m,A,b){p.diffuse.value.copy(m.color),p.opacity.value=m.opacity,p.size.value=m.size*A,p.scale.value=b*.5,m.map&&(p.map.value=m.map,n(m.map,p.uvTransform)),m.alphaMap&&(p.alphaMap.value=m.alphaMap,n(m.alphaMap,p.alphaMapTransform)),m.alphaTest>0&&(p.alphaTest.value=m.alphaTest)}function c(p,m){p.diffuse.value.copy(m.color),p.opacity.value=m.opacity,p.rotation.value=m.rotation,m.map&&(p.map.value=m.map,n(m.map,p.mapTransform)),m.alphaMap&&(p.alphaMap.value=m.alphaMap,n(m.alphaMap,p.alphaMapTransform)),m.alphaTest>0&&(p.alphaTest.value=m.alphaTest)}function g(p,m){p.specular.value.copy(m.specular),p.shininess.value=Math.max(m.shininess,1e-4)}function u(p,m){m.gradientMap&&(p.gradientMap.value=m.gradientMap)}function d(p,m){p.metalness.value=m.metalness,m.metalnessMap&&(p.metalnessMap.value=m.metalnessMap,n(m.metalnessMap,p.metalnessMapTransform)),p.roughness.value=m.roughness,m.roughnessMap&&(p.roughnessMap.value=m.roughnessMap,n(m.roughnessMap,p.roughnessMapTransform)),m.envMap&&(p.envMapIntensity.value=m.envMapIntensity)}function C(p,m,A){p.ior.value=m.ior,m.sheen>0&&(p.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),p.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(p.sheenColorMap.value=m.sheenColorMap,n(m.sheenColorMap,p.sheenColorMapTransform)),m.sheenRoughnessMap&&(p.sheenRoughnessMap.value=m.sheenRoughnessMap,n(m.sheenRoughnessMap,p.sheenRoughnessMapTransform))),m.clearcoat>0&&(p.clearcoat.value=m.clearcoat,p.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(p.clearcoatMap.value=m.clearcoatMap,n(m.clearcoatMap,p.clearcoatMapTransform)),m.clearcoatRoughnessMap&&(p.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap,n(m.clearcoatRoughnessMap,p.clearcoatRoughnessMapTransform)),m.clearcoatNormalMap&&(p.clearcoatNormalMap.value=m.clearcoatNormalMap,n(m.clearcoatNormalMap,p.clearcoatNormalMapTransform),p.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),m.side===qr&&p.clearcoatNormalScale.value.negate())),m.dispersion>0&&(p.dispersion.value=m.dispersion),m.iridescence>0&&(p.iridescence.value=m.iridescence,p.iridescenceIOR.value=m.iridescenceIOR,p.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],p.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(p.iridescenceMap.value=m.iridescenceMap,n(m.iridescenceMap,p.iridescenceMapTransform)),m.iridescenceThicknessMap&&(p.iridescenceThicknessMap.value=m.iridescenceThicknessMap,n(m.iridescenceThicknessMap,p.iridescenceThicknessMapTransform))),m.transmission>0&&(p.transmission.value=m.transmission,p.transmissionSamplerMap.value=A.texture,p.transmissionSamplerSize.value.set(A.width,A.height),m.transmissionMap&&(p.transmissionMap.value=m.transmissionMap,n(m.transmissionMap,p.transmissionMapTransform)),p.thickness.value=m.thickness,m.thicknessMap&&(p.thicknessMap.value=m.thicknessMap,n(m.thicknessMap,p.thicknessMapTransform)),p.attenuationDistance.value=m.attenuationDistance,p.attenuationColor.value.copy(m.attenuationColor)),m.anisotropy>0&&(p.anisotropyVector.value.set(m.anisotropy*Math.cos(m.anisotropyRotation),m.anisotropy*Math.sin(m.anisotropyRotation)),m.anisotropyMap&&(p.anisotropyMap.value=m.anisotropyMap,n(m.anisotropyMap,p.anisotropyMapTransform))),p.specularIntensity.value=m.specularIntensity,p.specularColor.value.copy(m.specularColor),m.specularColorMap&&(p.specularColorMap.value=m.specularColorMap,n(m.specularColorMap,p.specularColorMapTransform)),m.specularIntensityMap&&(p.specularIntensityMap.value=m.specularIntensityMap,n(m.specularIntensityMap,p.specularIntensityMapTransform))}function f(p,m){m.matcap&&(p.matcap.value=m.matcap)}function v(p,m){const A=e.get(m).light;p.referencePosition.value.setFromMatrixPosition(A.matrixWorld),p.nearDistance.value=A.shadow.camera.near,p.farDistance.value=A.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function Ise(t,e,n,i){let r={},o={},a=[];const s=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function l(A,b){const G=b.program;i.uniformBlockBinding(A,G)}function c(A,b){let G=r[A.id];G===void 0&&(f(A),G=g(A),r[A.id]=G,A.addEventListener("dispose",p));const w=b.program;i.updateUBOMapping(A,w);const S=e.render.frame;o[A.id]!==S&&(d(A),o[A.id]=S)}function g(A){const b=u();A.__bindingPointIndex=b;const G=t.createBuffer(),w=A.__size,S=A.usage;return t.bindBuffer(t.UNIFORM_BUFFER,G),t.bufferData(t.UNIFORM_BUFFER,w,S),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,b,G),G}function u(){for(let A=0;A<s;A++)if(a.indexOf(A)===-1)return a.push(A),A;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(A){const b=r[A.id],G=A.uniforms,w=A.__cache;t.bindBuffer(t.UNIFORM_BUFFER,b);for(let S=0,Z=G.length;S<Z;S++){const x=Array.isArray(G[S])?G[S]:[G[S]];for(let R=0,W=x.length;R<W;R++){const M=x[R];if(C(M,S,R,w)===!0){const N=M.__offset,X=Array.isArray(M.value)?M.value:[M.value];let E=0;for(let Q=0;Q<X.length;Q++){const k=X[Q],J=v(k);typeof k=="number"||typeof k=="boolean"?(M.__data[0]=k,t.bufferSubData(t.UNIFORM_BUFFER,N+E,M.__data)):k.isMatrix3?(M.__data[0]=k.elements[0],M.__data[1]=k.elements[1],M.__data[2]=k.elements[2],M.__data[3]=0,M.__data[4]=k.elements[3],M.__data[5]=k.elements[4],M.__data[6]=k.elements[5],M.__data[7]=0,M.__data[8]=k.elements[6],M.__data[9]=k.elements[7],M.__data[10]=k.elements[8],M.__data[11]=0):(k.toArray(M.__data,E),E+=J.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,N,M.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function C(A,b,G,w){const S=A.value,Z=b+"_"+G;if(w[Z]===void 0)return typeof S=="number"||typeof S=="boolean"?w[Z]=S:w[Z]=S.clone(),!0;{const x=w[Z];if(typeof S=="number"||typeof S=="boolean"){if(x!==S)return w[Z]=S,!0}else if(x.equals(S)===!1)return x.copy(S),!0}return!1}function f(A){const b=A.uniforms;let G=0;const w=16;for(let Z=0,x=b.length;Z<x;Z++){const R=Array.isArray(b[Z])?b[Z]:[b[Z]];for(let W=0,M=R.length;W<M;W++){const N=R[W],X=Array.isArray(N.value)?N.value:[N.value];for(let E=0,Q=X.length;E<Q;E++){const k=X[E],J=v(k),F=G%w,L=F%J.boundary,z=F+L;G+=L,z!==0&&w-z<J.storage&&(G+=w-z),N.__data=new Float32Array(J.storage/Float32Array.BYTES_PER_ELEMENT),N.__offset=G,G+=J.storage}}}const S=G%w;return S>0&&(G+=w-S),A.__size=G,A.__cache={},this}function v(A){const b={boundary:0,storage:0};return typeof A=="number"||typeof A=="boolean"?(b.boundary=4,b.storage=4):A.isVector2?(b.boundary=8,b.storage=8):A.isVector3||A.isColor?(b.boundary=16,b.storage=12):A.isVector4?(b.boundary=16,b.storage=16):A.isMatrix3?(b.boundary=48,b.storage=48):A.isMatrix4?(b.boundary=64,b.storage=64):A.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",A),b}function p(A){const b=A.target;b.removeEventListener("dispose",p);const G=a.indexOf(b.__bindingPointIndex);a.splice(G,1),t.deleteBuffer(r[b.id]),delete r[b.id],delete o[b.id]}function m(){for(const A in r)t.deleteBuffer(r[A]);a=[],r={},o={}}return{bind:l,update:c,dispose:m}}class a1{constructor(e={}){const{canvas:n=u9(),context:i=null,depth:r=!0,stencil:o=!1,alpha:a=!1,antialias:s=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:g="default",failIfMajorPerformanceCaveat:u=!1}=e;this.isWebGLRenderer=!0;let d;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");d=i.getContextAttributes().alpha}else d=a;const C=new Uint32Array(4),f=new Int32Array(4);let v=null,p=null;const m=[],A=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Yo,this.toneMapping=Gs,this.toneMappingExposure=1;const b=this;let G=!1,w=0,S=0,Z=null,x=-1,R=null;const W=new zn,M=new zn;let N=null;const X=new kt(0);let E=0,Q=n.width,k=n.height,J=1,F=null,L=null;const z=new zn(0,0,Q,k),K=new zn(0,0,Q,k);let O=!1;const j=new df;let P=!1,$=!1;const oe=new ln,ie=new ge,de=new zn,Ve={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Se=!1;function me(){return Z===null?J:1}let T=i;function Ge(_,te){return n.getContext(_,te)}try{const _={alpha:!0,depth:r,stencil:o,antialias:s,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:g,failIfMajorPerformanceCaveat:u};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${rf}`),n.addEventListener("webglcontextlost",be,!1),n.addEventListener("webglcontextrestored",Le,!1),n.addEventListener("webglcontextcreationerror",ct,!1),T===null){const te="webgl2";if(T=Ge(te,_),T===null)throw Ge(te)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(_){throw console.error("THREE.WebGLRenderer: "+_.message),_}let ne,he,ae,He,ve,Me,q,Y,Ce,se,fe,Ze,Oe,Fe,Ee,Qe,Ye,$e,st,Ue,Ne,je,Ie,Te;function ue(){ne=new voe(T),ne.init(),je=new y9(T,ne),he=new Coe(T,ne,e,je),ae=new qae(T),He=new Goe(T),ve=new Lae,Me=new ose(T,ne,ae,ve,he,je,He),q=new foe(b),Y=new poe(b),Ce=new Wne(T),Ie=new doe(T,Ce),se=new boe(T,Ce,He,Ie),fe=new Soe(T,se,Ce,He),st=new Boe(T,he,Me),Qe=new hoe(ve),Ze=new Kae(b,q,Y,ne,he,Ie,Qe),Oe=new dse(b,ve),Fe=new _ae,Ee=new Jae(ne),$e=new uoe(b,q,Y,ae,fe,d,l),Ye=new $ae(b,fe,he),Te=new Ise(T,He,he,ae),Ue=new Ioe(T,ne,He),Ne=new yoe(T,ne,He),He.programs=Ze.programs,b.capabilities=he,b.extensions=ne,b.properties=ve,b.renderLists=Fe,b.shadowMap=Ye,b.state=ae,b.info=He}ue();const Pe=new gse(b,T);this.xr=Pe,this.getContext=function(){return T},this.getContextAttributes=function(){return T.getContextAttributes()},this.forceContextLoss=function(){const _=ne.get("WEBGL_lose_context");_&&_.loseContext()},this.forceContextRestore=function(){const _=ne.get("WEBGL_lose_context");_&&_.restoreContext()},this.getPixelRatio=function(){return J},this.setPixelRatio=function(_){_!==void 0&&(J=_,this.setSize(Q,k,!1))},this.getSize=function(_){return _.set(Q,k)},this.setSize=function(_,te,ce=!0){if(Pe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Q=_,k=te,n.width=Math.floor(_*J),n.height=Math.floor(te*J),ce===!0&&(n.style.width=_+"px",n.style.height=te+"px"),this.setViewport(0,0,_,te)},this.getDrawingBufferSize=function(_){return _.set(Q*J,k*J).floor()},this.setDrawingBufferSize=function(_,te,ce){Q=_,k=te,J=ce,n.width=Math.floor(_*ce),n.height=Math.floor(te*ce),this.setViewport(0,0,_,te)},this.getCurrentViewport=function(_){return _.copy(W)},this.getViewport=function(_){return _.copy(z)},this.setViewport=function(_,te,ce,le){_.isVector4?z.set(_.x,_.y,_.z,_.w):z.set(_,te,ce,le),ae.viewport(W.copy(z).multiplyScalar(J).round())},this.getScissor=function(_){return _.copy(K)},this.setScissor=function(_,te,ce,le){_.isVector4?K.set(_.x,_.y,_.z,_.w):K.set(_,te,ce,le),ae.scissor(M.copy(K).multiplyScalar(J).round())},this.getScissorTest=function(){return O},this.setScissorTest=function(_){ae.setScissorTest(O=_)},this.setOpaqueSort=function(_){F=_},this.setTransparentSort=function(_){L=_},this.getClearColor=function(_){return _.copy($e.getClearColor())},this.setClearColor=function(){$e.setClearColor.apply($e,arguments)},this.getClearAlpha=function(){return $e.getClearAlpha()},this.setClearAlpha=function(){$e.setClearAlpha.apply($e,arguments)},this.clear=function(_=!0,te=!0,ce=!0){let le=0;if(_){let re=!1;if(Z!==null){const xe=Z.texture.format;re=xe===Hv||xe===Fv||xe===lf}if(re){const xe=Z.texture.type,Xe=xe===vo||xe===ws||xe===Td||xe===Mg||xe===Mv||xe===Nv,_e=$e.getClearColor(),We=$e.getClearAlpha(),pt=_e.r,lt=_e.g,nt=_e.b;Xe?(C[0]=pt,C[1]=lt,C[2]=nt,C[3]=We,T.clearBufferuiv(T.COLOR,0,C)):(f[0]=pt,f[1]=lt,f[2]=nt,f[3]=We,T.clearBufferiv(T.COLOR,0,f))}else le|=T.COLOR_BUFFER_BIT}te&&(le|=T.DEPTH_BUFFER_BIT),ce&&(le|=T.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),T.clear(le)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",be,!1),n.removeEventListener("webglcontextrestored",Le,!1),n.removeEventListener("webglcontextcreationerror",ct,!1),Fe.dispose(),Ee.dispose(),ve.dispose(),q.dispose(),Y.dispose(),fe.dispose(),Ie.dispose(),Te.dispose(),Ze.dispose(),Pe.dispose(),Pe.removeEventListener("sessionstart",ut),Pe.removeEventListener("sessionend",Tt),Ft.stop()};function be(_){_.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),G=!0}function Le(){console.log("THREE.WebGLRenderer: Context Restored."),G=!1;const _=He.autoReset,te=Ye.enabled,ce=Ye.autoUpdate,le=Ye.needsUpdate,re=Ye.type;ue(),He.autoReset=_,Ye.enabled=te,Ye.autoUpdate=ce,Ye.needsUpdate=le,Ye.type=re}function ct(_){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",_.statusMessage)}function dt(_){const te=_.target;te.removeEventListener("dispose",dt),It(te)}function It(_){Vt(_),ve.remove(_)}function Vt(_){const te=ve.get(_).programs;te!==void 0&&(te.forEach(function(ce){Ze.releaseProgram(ce)}),_.isShaderMaterial&&Ze.releaseShaderCache(_))}this.renderBufferDirect=function(_,te,ce,le,re,xe){te===null&&(te=Ve);const Xe=re.isMesh&&re.matrixWorld.determinant()<0,_e=U(_,te,ce,le,re);ae.setMaterial(le,Xe);let We=ce.index,pt=1;if(le.wireframe===!0){if(We=se.getWireframeAttribute(ce),We===void 0)return;pt=2}const lt=ce.drawRange,nt=ce.attributes.position;let wt=lt.start*pt,ot=(lt.start+lt.count)*pt;xe!==null&&(wt=Math.max(wt,xe.start*pt),ot=Math.min(ot,(xe.start+xe.count)*pt)),We!==null?(wt=Math.max(wt,0),ot=Math.min(ot,We.count)):nt!=null&&(wt=Math.max(wt,0),ot=Math.min(ot,nt.count));const bt=ot-wt;if(bt<0||bt===1/0)return;Ie.setup(re,le,_e,ce,We);let Wt,yt=Ue;if(We!==null&&(Wt=Ce.get(We),yt=Ne,yt.setIndex(Wt)),re.isMesh)le.wireframe===!0?(ae.setLineWidth(le.wireframeLinewidth*me()),yt.setMode(T.LINES)):yt.setMode(T.TRIANGLES);else if(re.isLine){let ht=le.linewidth;ht===void 0&&(ht=1),ae.setLineWidth(ht*me()),re.isLineSegments?yt.setMode(T.LINES):re.isLineLoop?yt.setMode(T.LINE_LOOP):yt.setMode(T.LINE_STRIP)}else re.isPoints?yt.setMode(T.POINTS):re.isSprite&&yt.setMode(T.TRIANGLES);if(re.isBatchedMesh)if(re._multiDrawInstances!==null)yt.renderMultiDrawInstances(re._multiDrawStarts,re._multiDrawCounts,re._multiDrawCount,re._multiDrawInstances);else if(ne.get("WEBGL_multi_draw"))yt.renderMultiDraw(re._multiDrawStarts,re._multiDrawCounts,re._multiDrawCount);else{const ht=re._multiDrawStarts,Qt=re._multiDrawCounts,zt=re._multiDrawCount,Pt=We?Ce.get(We).bytesPerElement:1,dn=ve.get(le).currentProgram.getUniforms();for(let un=0;un<zt;un++)dn.setValue(T,"_gl_DrawID",un),yt.render(ht[un]/Pt,Qt[un])}else if(re.isInstancedMesh)yt.renderInstances(wt,bt,re.count);else if(ce.isInstancedBufferGeometry){const ht=ce._maxInstanceCount!==void 0?ce._maxInstanceCount:1/0,Qt=Math.min(ce.instanceCount,ht);yt.renderInstances(wt,bt,Qt)}else yt.render(wt,bt)};function vt(_,te,ce){_.transparent===!0&&_.side===da&&_.forceSinglePass===!1?(_.side=qr,_.needsUpdate=!0,St(_,te,ce),_.side=gl,_.needsUpdate=!0,St(_,te,ce),_.side=da):St(_,te,ce)}this.compile=function(_,te,ce=null){ce===null&&(ce=_),p=Ee.get(ce),p.init(te),A.push(p),ce.traverseVisible(function(re){re.isLight&&re.layers.test(te.layers)&&(p.pushLight(re),re.castShadow&&p.pushShadow(re))}),_!==ce&&_.traverseVisible(function(re){re.isLight&&re.layers.test(te.layers)&&(p.pushLight(re),re.castShadow&&p.pushShadow(re))}),p.setupLights();const le=new Set;return _.traverse(function(re){const xe=re.material;if(xe)if(Array.isArray(xe))for(let Xe=0;Xe<xe.length;Xe++){const _e=xe[Xe];vt(_e,ce,re),le.add(_e)}else vt(xe,ce,re),le.add(xe)}),A.pop(),p=null,le},this.compileAsync=function(_,te,ce=null){const le=this.compile(_,te,ce);return new Promise(re=>{function xe(){if(le.forEach(function(Xe){ve.get(Xe).currentProgram.isReady()&&le.delete(Xe)}),le.size===0){re(_);return}setTimeout(xe,10)}ne.get("KHR_parallel_shader_compile")!==null?xe():setTimeout(xe,10)})};let et=null;function rt(_){et&&et(_)}function ut(){Ft.stop()}function Tt(){Ft.start()}const Ft=new m9;Ft.setAnimationLoop(rt),typeof self<"u"&&Ft.setContext(self),this.setAnimationLoop=function(_){et=_,Pe.setAnimationLoop(_),_===null?Ft.stop():Ft.start()},Pe.addEventListener("sessionstart",ut),Pe.addEventListener("sessionend",Tt),this.render=function(_,te){if(te!==void 0&&te.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(G===!0)return;if(_.matrixWorldAutoUpdate===!0&&_.updateMatrixWorld(),te.parent===null&&te.matrixWorldAutoUpdate===!0&&te.updateMatrixWorld(),Pe.enabled===!0&&Pe.isPresenting===!0&&(Pe.cameraAutoUpdate===!0&&Pe.updateCamera(te),te=Pe.getCamera()),_.isScene===!0&&_.onBeforeRender(b,_,te,Z),p=Ee.get(_,A.length),p.init(te),A.push(p),oe.multiplyMatrices(te.projectionMatrix,te.matrixWorldInverse),j.setFromProjectionMatrix(oe),$=this.localClippingEnabled,P=Qe.init(this.clippingPlanes,$),v=Fe.get(_,m.length),v.init(),m.push(v),Pe.enabled===!0&&Pe.isPresenting===!0){const xe=b.xr.getDepthSensingMesh();xe!==null&&ft(xe,te,-1/0,b.sortObjects)}ft(_,te,0,b.sortObjects),v.finish(),b.sortObjects===!0&&v.sort(F,L),Se=Pe.enabled===!1||Pe.isPresenting===!1||Pe.hasDepthSensing()===!1,Se&&$e.addToRenderList(v,_),this.info.render.frame++,P===!0&&Qe.beginShadows();const ce=p.state.shadowsArray;Ye.render(ce,_,te),P===!0&&Qe.endShadows(),this.info.autoReset===!0&&this.info.reset();const le=v.opaque,re=v.transmissive;if(p.setupLights(),te.isArrayCamera){const xe=te.cameras;if(re.length>0)for(let Xe=0,_e=xe.length;Xe<_e;Xe++){const We=xe[Xe];Gt(le,re,_,We)}Se&&$e.render(_);for(let Xe=0,_e=xe.length;Xe<_e;Xe++){const We=xe[Xe];At(v,_,We,We.viewport)}}else re.length>0&&Gt(le,re,_,te),Se&&$e.render(_),At(v,_,te);Z!==null&&(Me.updateMultisampleRenderTarget(Z),Me.updateRenderTargetMipmap(Z)),_.isScene===!0&&_.onAfterRender(b,_,te),Ie.resetDefaultState(),x=-1,R=null,A.pop(),A.length>0?(p=A[A.length-1],P===!0&&Qe.setGlobalState(b.clippingPlanes,p.state.camera)):p=null,m.pop(),m.length>0?v=m[m.length-1]:v=null};function ft(_,te,ce,le){if(_.visible===!1)return;if(_.layers.test(te.layers)){if(_.isGroup)ce=_.renderOrder;else if(_.isLOD)_.autoUpdate===!0&&_.update(te);else if(_.isLight)p.pushLight(_),_.castShadow&&p.pushShadow(_);else if(_.isSprite){if(!_.frustumCulled||j.intersectsSprite(_)){le&&de.setFromMatrixPosition(_.matrixWorld).applyMatrix4(oe);const Xe=fe.update(_),_e=_.material;_e.visible&&v.push(_,Xe,_e,ce,de.z,null)}}else if((_.isMesh||_.isLine||_.isPoints)&&(!_.frustumCulled||j.intersectsObject(_))){const Xe=fe.update(_),_e=_.material;if(le&&(_.boundingSphere!==void 0?(_.boundingSphere===null&&_.computeBoundingSphere(),de.copy(_.boundingSphere.center)):(Xe.boundingSphere===null&&Xe.computeBoundingSphere(),de.copy(Xe.boundingSphere.center)),de.applyMatrix4(_.matrixWorld).applyMatrix4(oe)),Array.isArray(_e)){const We=Xe.groups;for(let pt=0,lt=We.length;pt<lt;pt++){const nt=We[pt],wt=_e[nt.materialIndex];wt&&wt.visible&&v.push(_,Xe,wt,ce,de.z,nt)}}else _e.visible&&v.push(_,Xe,_e,ce,de.z,null)}}const xe=_.children;for(let Xe=0,_e=xe.length;Xe<_e;Xe++)ft(xe[Xe],te,ce,le)}function At(_,te,ce,le){const re=_.opaque,xe=_.transmissive,Xe=_.transparent;p.setupLightsView(ce),P===!0&&Qe.setGlobalState(b.clippingPlanes,ce),le&&ae.viewport(W.copy(le)),re.length>0&&Bt(re,te,ce),xe.length>0&&Bt(xe,te,ce),Xe.length>0&&Bt(Xe,te,ce),ae.buffers.depth.setTest(!0),ae.buffers.depth.setMask(!0),ae.buffers.color.setMask(!0),ae.setPolygonOffset(!1)}function Gt(_,te,ce,le){if((ce.isScene===!0?ce.overrideMaterial:null)!==null)return;p.state.transmissionRenderTarget[le.id]===void 0&&(p.state.transmissionRenderTarget[le.id]=new Do(1,1,{generateMipmaps:!0,type:ne.has("EXT_color_buffer_half_float")||ne.has("EXT_color_buffer_float")?or:vo,minFilter:ms,samples:4,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Yn.workingColorSpace}));const xe=p.state.transmissionRenderTarget[le.id],Xe=le.viewport||W;xe.setSize(Xe.z,Xe.w);const _e=b.getRenderTarget();b.setRenderTarget(xe),b.getClearColor(X),E=b.getClearAlpha(),E<1&&b.setClearColor(16777215,.5),b.clear(),Se&&$e.render(ce);const We=b.toneMapping;b.toneMapping=Gs;const pt=le.viewport;if(le.viewport!==void 0&&(le.viewport=void 0),p.setupLightsView(le),P===!0&&Qe.setGlobalState(b.clippingPlanes,le),Bt(_,ce,le),Me.updateMultisampleRenderTarget(xe),Me.updateRenderTargetMipmap(xe),ne.has("WEBGL_multisampled_render_to_texture")===!1){let lt=!1;for(let nt=0,wt=te.length;nt<wt;nt++){const ot=te[nt],bt=ot.object,Wt=ot.geometry,yt=ot.material,ht=ot.group;if(yt.side===da&&bt.layers.test(le.layers)){const Qt=yt.side;yt.side=qr,yt.needsUpdate=!0,Yt(bt,ce,le,Wt,yt,ht),yt.side=Qt,yt.needsUpdate=!0,lt=!0}}lt===!0&&(Me.updateMultisampleRenderTarget(xe),Me.updateRenderTargetMipmap(xe))}b.setRenderTarget(_e),b.setClearColor(X,E),pt!==void 0&&(le.viewport=pt),b.toneMapping=We}function Bt(_,te,ce){const le=te.isScene===!0?te.overrideMaterial:null;for(let re=0,xe=_.length;re<xe;re++){const Xe=_[re],_e=Xe.object,We=Xe.geometry,pt=le===null?Xe.material:le,lt=Xe.group;_e.layers.test(ce.layers)&&Yt(_e,te,ce,We,pt,lt)}}function Yt(_,te,ce,le,re,xe){_.onBeforeRender(b,te,ce,le,re,xe),_.modelViewMatrix.multiplyMatrices(ce.matrixWorldInverse,_.matrixWorld),_.normalMatrix.getNormalMatrix(_.modelViewMatrix),re.onBeforeRender(b,te,ce,le,_,xe),re.transparent===!0&&re.side===da&&re.forceSinglePass===!1?(re.side=qr,re.needsUpdate=!0,b.renderBufferDirect(ce,te,le,re,_,xe),re.side=gl,re.needsUpdate=!0,b.renderBufferDirect(ce,te,le,re,_,xe),re.side=da):b.renderBufferDirect(ce,te,le,re,_,xe),_.onAfterRender(b,te,ce,le,re,xe)}function St(_,te,ce){te.isScene!==!0&&(te=Ve);const le=ve.get(_),re=p.state.lights,xe=p.state.shadowsArray,Xe=re.state.version,_e=Ze.getParameters(_,re.state,xe,te,ce),We=Ze.getProgramCacheKey(_e);let pt=le.programs;le.environment=_.isMeshStandardMaterial?te.environment:null,le.fog=te.fog,le.envMap=(_.isMeshStandardMaterial?Y:q).get(_.envMap||le.environment),le.envMapRotation=le.environment!==null&&_.envMap===null?te.environmentRotation:_.envMapRotation,pt===void 0&&(_.addEventListener("dispose",dt),pt=new Map,le.programs=pt);let lt=pt.get(We);if(lt!==void 0){if(le.currentProgram===lt&&le.lightsStateVersion===Xe)return Ot(_,_e),lt}else _e.uniforms=Ze.getUniforms(_),_.onBeforeCompile(_e,b),lt=Ze.acquireProgram(_e,We),pt.set(We,lt),le.uniforms=_e.uniforms;const nt=le.uniforms;return(!_.isShaderMaterial&&!_.isRawShaderMaterial||_.clipping===!0)&&(nt.clippingPlanes=Qe.uniform),Ot(_,_e),le.needsLights=Be(_),le.lightsStateVersion=Xe,le.needsLights&&(nt.ambientLightColor.value=re.state.ambient,nt.lightProbe.value=re.state.probe,nt.directionalLights.value=re.state.directional,nt.directionalLightShadows.value=re.state.directionalShadow,nt.spotLights.value=re.state.spot,nt.spotLightShadows.value=re.state.spotShadow,nt.rectAreaLights.value=re.state.rectArea,nt.ltc_1.value=re.state.rectAreaLTC1,nt.ltc_2.value=re.state.rectAreaLTC2,nt.pointLights.value=re.state.point,nt.pointLightShadows.value=re.state.pointShadow,nt.hemisphereLights.value=re.state.hemi,nt.directionalShadowMap.value=re.state.directionalShadowMap,nt.directionalShadowMatrix.value=re.state.directionalShadowMatrix,nt.spotShadowMap.value=re.state.spotShadowMap,nt.spotLightMatrix.value=re.state.spotLightMatrix,nt.spotLightMap.value=re.state.spotLightMap,nt.pointShadowMap.value=re.state.pointShadowMap,nt.pointShadowMatrix.value=re.state.pointShadowMatrix),le.currentProgram=lt,le.uniformsList=null,lt}function sn(_){if(_.uniformsList===null){const te=_.currentProgram.getUniforms();_.uniformsList=Ip.seqWithValue(te.seq,_.uniforms)}return _.uniformsList}function Ot(_,te){const ce=ve.get(_);ce.outputColorSpace=te.outputColorSpace,ce.batching=te.batching,ce.batchingColor=te.batchingColor,ce.instancing=te.instancing,ce.instancingColor=te.instancingColor,ce.instancingMorph=te.instancingMorph,ce.skinning=te.skinning,ce.morphTargets=te.morphTargets,ce.morphNormals=te.morphNormals,ce.morphColors=te.morphColors,ce.morphTargetsCount=te.morphTargetsCount,ce.numClippingPlanes=te.numClippingPlanes,ce.numIntersection=te.numClipIntersection,ce.vertexAlphas=te.vertexAlphas,ce.vertexTangents=te.vertexTangents,ce.toneMapping=te.toneMapping}function U(_,te,ce,le,re){te.isScene!==!0&&(te=Ve),Me.resetTextureUnits();const xe=te.fog,Xe=le.isMeshStandardMaterial?te.environment:null,_e=Z===null?b.outputColorSpace:Z.isXRRenderTarget===!0?Z.texture.colorSpace:pa,We=(le.isMeshStandardMaterial?Y:q).get(le.envMap||Xe),pt=le.vertexColors===!0&&!!ce.attributes.color&&ce.attributes.color.itemSize===4,lt=!!ce.attributes.tangent&&(!!le.normalMap||le.anisotropy>0),nt=!!ce.morphAttributes.position,wt=!!ce.morphAttributes.normal,ot=!!ce.morphAttributes.color;let bt=Gs;le.toneMapped&&(Z===null||Z.isXRRenderTarget===!0)&&(bt=b.toneMapping);const Wt=ce.morphAttributes.position||ce.morphAttributes.normal||ce.morphAttributes.color,yt=Wt!==void 0?Wt.length:0,ht=ve.get(le),Qt=p.state.lights;if(P===!0&&($===!0||_!==R)){const Rt=_===R&&le.id===x;Qe.setState(le,_,Rt)}let zt=!1;le.version===ht.__version?(ht.needsLights&&ht.lightsStateVersion!==Qt.state.version||ht.outputColorSpace!==_e||re.isBatchedMesh&&ht.batching===!1||!re.isBatchedMesh&&ht.batching===!0||re.isBatchedMesh&&ht.batchingColor===!0&&re.colorTexture===null||re.isBatchedMesh&&ht.batchingColor===!1&&re.colorTexture!==null||re.isInstancedMesh&&ht.instancing===!1||!re.isInstancedMesh&&ht.instancing===!0||re.isSkinnedMesh&&ht.skinning===!1||!re.isSkinnedMesh&&ht.skinning===!0||re.isInstancedMesh&&ht.instancingColor===!0&&re.instanceColor===null||re.isInstancedMesh&&ht.instancingColor===!1&&re.instanceColor!==null||re.isInstancedMesh&&ht.instancingMorph===!0&&re.morphTexture===null||re.isInstancedMesh&&ht.instancingMorph===!1&&re.morphTexture!==null||ht.envMap!==We||le.fog===!0&&ht.fog!==xe||ht.numClippingPlanes!==void 0&&(ht.numClippingPlanes!==Qe.numPlanes||ht.numIntersection!==Qe.numIntersection)||ht.vertexAlphas!==pt||ht.vertexTangents!==lt||ht.morphTargets!==nt||ht.morphNormals!==wt||ht.morphColors!==ot||ht.toneMapping!==bt||ht.morphTargetsCount!==yt)&&(zt=!0):(zt=!0,ht.__version=le.version);let Pt=ht.currentProgram;zt===!0&&(Pt=St(le,te,re));let dn=!1,un=!1,In=!1;const Ht=Pt.getUniforms(),mt=ht.uniforms;if(ae.useProgram(Pt.program)&&(dn=!0,un=!0,In=!0),le.id!==x&&(x=le.id,un=!0),dn||R!==_){Ht.setValue(T,"projectionMatrix",_.projectionMatrix),Ht.setValue(T,"viewMatrix",_.matrixWorldInverse);const Rt=Ht.map.cameraPosition;Rt!==void 0&&Rt.setValue(T,ie.setFromMatrixPosition(_.matrixWorld)),he.logarithmicDepthBuffer&&Ht.setValue(T,"logDepthBufFC",2/(Math.log(_.far+1)/Math.LN2)),(le.isMeshPhongMaterial||le.isMeshToonMaterial||le.isMeshLambertMaterial||le.isMeshBasicMaterial||le.isMeshStandardMaterial||le.isShaderMaterial)&&Ht.setValue(T,"isOrthographic",_.isOrthographicCamera===!0),R!==_&&(R=_,un=!0,In=!0)}if(re.isSkinnedMesh){Ht.setOptional(T,re,"bindMatrix"),Ht.setOptional(T,re,"bindMatrixInverse");const Rt=re.skeleton;Rt&&(Rt.boneTexture===null&&Rt.computeBoneTexture(),Ht.setValue(T,"boneTexture",Rt.boneTexture,Me))}re.isBatchedMesh&&(Ht.setOptional(T,re,"batchingTexture"),Ht.setValue(T,"batchingTexture",re._matricesTexture,Me),Ht.setOptional(T,re,"batchingIdTexture"),Ht.setValue(T,"batchingIdTexture",re._indirectTexture,Me),Ht.setOptional(T,re,"batchingColorTexture"),re._colorsTexture!==null&&Ht.setValue(T,"batchingColorTexture",re._colorsTexture,Me));const Lt=ce.morphAttributes;if((Lt.position!==void 0||Lt.normal!==void 0||Lt.color!==void 0)&&st.update(re,ce,Pt),(un||ht.receiveShadow!==re.receiveShadow)&&(ht.receiveShadow=re.receiveShadow,Ht.setValue(T,"receiveShadow",re.receiveShadow)),le.isMeshGouraudMaterial&&le.envMap!==null&&(mt.envMap.value=We,mt.flipEnvMap.value=We.isCubeTexture&&We.isRenderTargetTexture===!1?-1:1),le.isMeshStandardMaterial&&le.envMap===null&&te.environment!==null&&(mt.envMapIntensity.value=te.environmentIntensity),un&&(Ht.setValue(T,"toneMappingExposure",b.toneMappingExposure),ht.needsLights&&ee(mt,In),xe&&le.fog===!0&&Oe.refreshFogUniforms(mt,xe),Oe.refreshMaterialUniforms(mt,le,J,k,p.state.transmissionRenderTarget[_.id]),Ip.upload(T,sn(ht),mt,Me)),le.isShaderMaterial&&le.uniformsNeedUpdate===!0&&(Ip.upload(T,sn(ht),mt,Me),le.uniformsNeedUpdate=!1),le.isSpriteMaterial&&Ht.setValue(T,"center",re.center),Ht.setValue(T,"modelViewMatrix",re.modelViewMatrix),Ht.setValue(T,"normalMatrix",re.normalMatrix),Ht.setValue(T,"modelMatrix",re.matrixWorld),le.isShaderMaterial||le.isRawShaderMaterial){const Rt=le.uniformsGroups;for(let Xt=0,en=Rt.length;Xt<en;Xt++){const Rn=Rt[Xt];Te.update(Rn,Pt),Te.bind(Rn,Pt)}}return Pt}function ee(_,te){_.ambientLightColor.needsUpdate=te,_.lightProbe.needsUpdate=te,_.directionalLights.needsUpdate=te,_.directionalLightShadows.needsUpdate=te,_.pointLights.needsUpdate=te,_.pointLightShadows.needsUpdate=te,_.spotLights.needsUpdate=te,_.spotLightShadows.needsUpdate=te,_.rectAreaLights.needsUpdate=te,_.hemisphereLights.needsUpdate=te}function Be(_){return _.isMeshLambertMaterial||_.isMeshToonMaterial||_.isMeshPhongMaterial||_.isMeshStandardMaterial||_.isShadowMaterial||_.isShaderMaterial&&_.lights===!0}this.getActiveCubeFace=function(){return w},this.getActiveMipmapLevel=function(){return S},this.getRenderTarget=function(){return Z},this.setRenderTargetTextures=function(_,te,ce){ve.get(_.texture).__webglTexture=te,ve.get(_.depthTexture).__webglTexture=ce;const le=ve.get(_);le.__hasExternalTextures=!0,le.__autoAllocateDepthBuffer=ce===void 0,le.__autoAllocateDepthBuffer||ne.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),le.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(_,te){const ce=ve.get(_);ce.__webglFramebuffer=te,ce.__useDefaultFramebuffer=te===void 0},this.setRenderTarget=function(_,te=0,ce=0){Z=_,w=te,S=ce;let le=!0,re=null,xe=!1,Xe=!1;if(_){const We=ve.get(_);if(We.__useDefaultFramebuffer!==void 0)ae.bindFramebuffer(T.FRAMEBUFFER,null),le=!1;else if(We.__webglFramebuffer===void 0)Me.setupRenderTarget(_);else if(We.__hasExternalTextures)Me.rebindTextures(_,ve.get(_.texture).__webglTexture,ve.get(_.depthTexture).__webglTexture);else if(_.depthBuffer){const nt=_.depthTexture;if(We.__boundDepthTexture!==nt){if(nt!==null&&ve.has(nt)&&(_.width!==nt.image.width||_.height!==nt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Me.setupDepthRenderbuffer(_)}}const pt=_.texture;(pt.isData3DTexture||pt.isDataArrayTexture||pt.isCompressedArrayTexture)&&(Xe=!0);const lt=ve.get(_).__webglFramebuffer;_.isWebGLCubeRenderTarget?(Array.isArray(lt[te])?re=lt[te][ce]:re=lt[te],xe=!0):_.samples>0&&Me.useMultisampledRTT(_)===!1?re=ve.get(_).__webglMultisampledFramebuffer:Array.isArray(lt)?re=lt[ce]:re=lt,W.copy(_.viewport),M.copy(_.scissor),N=_.scissorTest}else W.copy(z).multiplyScalar(J).floor(),M.copy(K).multiplyScalar(J).floor(),N=O;if(ae.bindFramebuffer(T.FRAMEBUFFER,re)&&le&&ae.drawBuffers(_,re),ae.viewport(W),ae.scissor(M),ae.setScissorTest(N),xe){const We=ve.get(_.texture);T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.TEXTURE_CUBE_MAP_POSITIVE_X+te,We.__webglTexture,ce)}else if(Xe){const We=ve.get(_.texture),pt=te||0;T.framebufferTextureLayer(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,We.__webglTexture,ce||0,pt)}x=-1},this.readRenderTargetPixels=function(_,te,ce,le,re,xe,Xe){if(!(_&&_.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let _e=ve.get(_).__webglFramebuffer;if(_.isWebGLCubeRenderTarget&&Xe!==void 0&&(_e=_e[Xe]),_e){ae.bindFramebuffer(T.FRAMEBUFFER,_e);try{const We=_.texture,pt=We.format,lt=We.type;if(!he.textureFormatReadable(pt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!he.textureTypeReadable(lt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}te>=0&&te<=_.width-le&&ce>=0&&ce<=_.height-re&&T.readPixels(te,ce,le,re,je.convert(pt),je.convert(lt),xe)}finally{const We=Z!==null?ve.get(Z).__webglFramebuffer:null;ae.bindFramebuffer(T.FRAMEBUFFER,We)}}},this.readRenderTargetPixelsAsync=async function(_,te,ce,le,re,xe,Xe){if(!(_&&_.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let _e=ve.get(_).__webglFramebuffer;if(_.isWebGLCubeRenderTarget&&Xe!==void 0&&(_e=_e[Xe]),_e){ae.bindFramebuffer(T.FRAMEBUFFER,_e);try{const We=_.texture,pt=We.format,lt=We.type;if(!he.textureFormatReadable(pt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!he.textureTypeReadable(lt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(te>=0&&te<=_.width-le&&ce>=0&&ce<=_.height-re){const nt=T.createBuffer();T.bindBuffer(T.PIXEL_PACK_BUFFER,nt),T.bufferData(T.PIXEL_PACK_BUFFER,xe.byteLength,T.STREAM_READ),T.readPixels(te,ce,le,re,je.convert(pt),je.convert(lt),0),T.flush();const wt=T.fenceSync(T.SYNC_GPU_COMMANDS_COMPLETE,0);await nne(T,wt,4);try{T.bindBuffer(T.PIXEL_PACK_BUFFER,nt),T.getBufferSubData(T.PIXEL_PACK_BUFFER,0,xe)}finally{T.deleteBuffer(nt),T.deleteSync(wt)}return xe}}finally{const We=Z!==null?ve.get(Z).__webglFramebuffer:null;ae.bindFramebuffer(T.FRAMEBUFFER,We)}}},this.copyFramebufferToTexture=function(_,te=null,ce=0){_.isTexture!==!0&&(Ad("WebGLRenderer: copyFramebufferToTexture function signature has changed."),te=arguments[0]||null,_=arguments[1]);const le=Math.pow(2,-ce),re=Math.floor(_.image.width*le),xe=Math.floor(_.image.height*le),Xe=te!==null?te.x:0,_e=te!==null?te.y:0;Me.setTexture2D(_,0),T.copyTexSubImage2D(T.TEXTURE_2D,ce,0,0,Xe,_e,re,xe),ae.unbindTexture()},this.copyTextureToTexture=function(_,te,ce=null,le=null,re=0){_.isTexture!==!0&&(Ad("WebGLRenderer: copyTextureToTexture function signature has changed."),le=arguments[0]||null,_=arguments[1],te=arguments[2],re=arguments[3]||0,ce=null);let xe,Xe,_e,We,pt,lt;ce!==null?(xe=ce.max.x-ce.min.x,Xe=ce.max.y-ce.min.y,_e=ce.min.x,We=ce.min.y):(xe=_.image.width,Xe=_.image.height,_e=0,We=0),le!==null?(pt=le.x,lt=le.y):(pt=0,lt=0);const nt=je.convert(te.format),wt=je.convert(te.type);Me.setTexture2D(te,0),T.pixelStorei(T.UNPACK_FLIP_Y_WEBGL,te.flipY),T.pixelStorei(T.UNPACK_PREMULTIPLY_ALPHA_WEBGL,te.premultiplyAlpha),T.pixelStorei(T.UNPACK_ALIGNMENT,te.unpackAlignment);const ot=T.getParameter(T.UNPACK_ROW_LENGTH),bt=T.getParameter(T.UNPACK_IMAGE_HEIGHT),Wt=T.getParameter(T.UNPACK_SKIP_PIXELS),yt=T.getParameter(T.UNPACK_SKIP_ROWS),ht=T.getParameter(T.UNPACK_SKIP_IMAGES),Qt=_.isCompressedTexture?_.mipmaps[re]:_.image;T.pixelStorei(T.UNPACK_ROW_LENGTH,Qt.width),T.pixelStorei(T.UNPACK_IMAGE_HEIGHT,Qt.height),T.pixelStorei(T.UNPACK_SKIP_PIXELS,_e),T.pixelStorei(T.UNPACK_SKIP_ROWS,We),_.isDataTexture?T.texSubImage2D(T.TEXTURE_2D,re,pt,lt,xe,Xe,nt,wt,Qt.data):_.isCompressedTexture?T.compressedTexSubImage2D(T.TEXTURE_2D,re,pt,lt,Qt.width,Qt.height,nt,Qt.data):T.texSubImage2D(T.TEXTURE_2D,re,pt,lt,xe,Xe,nt,wt,Qt),T.pixelStorei(T.UNPACK_ROW_LENGTH,ot),T.pixelStorei(T.UNPACK_IMAGE_HEIGHT,bt),T.pixelStorei(T.UNPACK_SKIP_PIXELS,Wt),T.pixelStorei(T.UNPACK_SKIP_ROWS,yt),T.pixelStorei(T.UNPACK_SKIP_IMAGES,ht),re===0&&te.generateMipmaps&&T.generateMipmap(T.TEXTURE_2D),ae.unbindTexture()},this.copyTextureToTexture3D=function(_,te,ce=null,le=null,re=0){_.isTexture!==!0&&(Ad("WebGLRenderer: copyTextureToTexture3D function signature has changed."),ce=arguments[0]||null,le=arguments[1]||null,_=arguments[2],te=arguments[3],re=arguments[4]||0);let xe,Xe,_e,We,pt,lt,nt,wt,ot;const bt=_.isCompressedTexture?_.mipmaps[re]:_.image;ce!==null?(xe=ce.max.x-ce.min.x,Xe=ce.max.y-ce.min.y,_e=ce.max.z-ce.min.z,We=ce.min.x,pt=ce.min.y,lt=ce.min.z):(xe=bt.width,Xe=bt.height,_e=bt.depth,We=0,pt=0,lt=0),le!==null?(nt=le.x,wt=le.y,ot=le.z):(nt=0,wt=0,ot=0);const Wt=je.convert(te.format),yt=je.convert(te.type);let ht;if(te.isData3DTexture)Me.setTexture3D(te,0),ht=T.TEXTURE_3D;else if(te.isDataArrayTexture||te.isCompressedArrayTexture)Me.setTexture2DArray(te,0),ht=T.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}T.pixelStorei(T.UNPACK_FLIP_Y_WEBGL,te.flipY),T.pixelStorei(T.UNPACK_PREMULTIPLY_ALPHA_WEBGL,te.premultiplyAlpha),T.pixelStorei(T.UNPACK_ALIGNMENT,te.unpackAlignment);const Qt=T.getParameter(T.UNPACK_ROW_LENGTH),zt=T.getParameter(T.UNPACK_IMAGE_HEIGHT),Pt=T.getParameter(T.UNPACK_SKIP_PIXELS),dn=T.getParameter(T.UNPACK_SKIP_ROWS),un=T.getParameter(T.UNPACK_SKIP_IMAGES);T.pixelStorei(T.UNPACK_ROW_LENGTH,bt.width),T.pixelStorei(T.UNPACK_IMAGE_HEIGHT,bt.height),T.pixelStorei(T.UNPACK_SKIP_PIXELS,We),T.pixelStorei(T.UNPACK_SKIP_ROWS,pt),T.pixelStorei(T.UNPACK_SKIP_IMAGES,lt),_.isDataTexture||_.isData3DTexture?T.texSubImage3D(ht,re,nt,wt,ot,xe,Xe,_e,Wt,yt,bt.data):te.isCompressedArrayTexture?T.compressedTexSubImage3D(ht,re,nt,wt,ot,xe,Xe,_e,Wt,bt.data):T.texSubImage3D(ht,re,nt,wt,ot,xe,Xe,_e,Wt,yt,bt),T.pixelStorei(T.UNPACK_ROW_LENGTH,Qt),T.pixelStorei(T.UNPACK_IMAGE_HEIGHT,zt),T.pixelStorei(T.UNPACK_SKIP_PIXELS,Pt),T.pixelStorei(T.UNPACK_SKIP_ROWS,dn),T.pixelStorei(T.UNPACK_SKIP_IMAGES,un),re===0&&te.generateMipmaps&&T.generateMipmap(ht),ae.unbindTexture()},this.initRenderTarget=function(_){ve.get(_).__webglFramebuffer===void 0&&Me.setupRenderTarget(_)},this.initTexture=function(_){_.isCubeTexture?Me.setTextureCube(_,0):_.isData3DTexture?Me.setTexture3D(_,0):_.isDataArrayTexture||_.isCompressedArrayTexture?Me.setTexture2DArray(_,0):Me.setTexture2D(_,0),ae.unbindTexture()},this.resetState=function(){w=0,S=0,Z=null,ae.reset(),Ie.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return As}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=e===Ev?"display-p3":"srgb",n.unpackColorSpace=Yn.workingColorSpace===cf?"display-p3":"srgb"}}class Tv{constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new kt(e),this.density=n}clone(){return new Tv(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class _v{constructor(e,n=1,i=1e3){this.isFog=!0,this.name="",this.color=new kt(e),this.near=n,this.far=i}clone(){return new _v(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class If extends Vn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Ei,this.environmentIntensity=1,this.environmentRotation=new Ei,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}class kv{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=Zh,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=ko()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return Ad("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,i){e*=this.stride,i*=n.stride;for(let r=0,o=this.stride;r<o;r++)this.array[e+r]=n.array[i+r];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ko()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ko()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const kr=new ge;class Fg{constructor(e,n,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,i=this.data.count;n<i;n++)kr.fromBufferAttribute(this,n),kr.applyMatrix4(e),this.setXYZ(n,kr.x,kr.y,kr.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)kr.fromBufferAttribute(this,n),kr.applyNormalMatrix(e),this.setXYZ(n,kr.x,kr.y,kr.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)kr.fromBufferAttribute(this,n),kr.transformDirection(e),this.setXYZ(n,kr.x,kr.y,kr.z);return this}getComponent(e,n){let i=this.array[e*this.data.stride+this.offset+n];return this.normalized&&(i=Qr(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=vn(i,this.array)),this.data.array[e*this.data.stride+this.offset+n]=i,this}setX(e,n){return this.normalized&&(n=vn(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=vn(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=vn(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=vn(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=Qr(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=Qr(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=Qr(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=Qr(n,this.array)),n}setXY(e,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=vn(n,this.array),i=vn(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this}setXYZ(e,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(n=vn(n,this.array),i=vn(i,this.array),r=vn(r,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,n,i,r,o){return e=e*this.data.stride+this.offset,this.normalized&&(n=vn(n,this.array),i=vn(i,this.array),r=vn(r,this.array),o=vn(o,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=o,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)n.push(this.data.array[r+o])}return new Un(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Fg(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)n.push(this.data.array[r+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class s1 extends Er{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new kt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Mu;const _I=new ge,Nu=new ge,Fu=new ge,Hu=new gt,kI=new gt,B9=new ln,oA=new ge,PI=new ge,aA=new ge,LN=new gt,EG=new gt,TN=new gt;class S9 extends Vn{constructor(e=new s1){if(super(),this.isSprite=!0,this.type="Sprite",Mu===void 0){Mu=new Sn;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new kv(n,5);Mu.setIndex([0,1,2,0,2,3]),Mu.setAttribute("position",new Fg(i,3,0,!1)),Mu.setAttribute("uv",new Fg(i,2,3,!1))}this.geometry=Mu,this.material=e,this.center=new gt(.5,.5)}raycast(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Nu.setFromMatrixScale(this.matrixWorld),B9.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Fu.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Nu.multiplyScalar(-Fu.z);const i=this.material.rotation;let r,o;i!==0&&(o=Math.cos(i),r=Math.sin(i));const a=this.center;sA(oA.set(-.5,-.5,0),Fu,a,Nu,r,o),sA(PI.set(.5,-.5,0),Fu,a,Nu,r,o),sA(aA.set(.5,.5,0),Fu,a,Nu,r,o),LN.set(0,0),EG.set(1,0),TN.set(1,1);let s=e.ray.intersectTriangle(oA,PI,aA,!1,_I);if(s===null&&(sA(PI.set(-.5,.5,0),Fu,a,Nu,r,o),EG.set(0,1),s=e.ray.intersectTriangle(oA,aA,PI,!1,_I),s===null))return;const l=e.ray.origin.distanceTo(_I);l<e.near||l>e.far||n.push({distance:l,point:_I.clone(),uv:zo.getInterpolation(_I,oA,PI,aA,LN,EG,TN,new gt),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function sA(t,e,n,i,r,o){Hu.subVectors(t,n).addScalar(.5).multiply(i),r!==void 0?(kI.x=o*Hu.x-r*Hu.y,kI.y=r*Hu.x+o*Hu.y):kI.copy(Hu),t.copy(e),t.x+=kI.x,t.y+=kI.y,t.applyMatrix4(B9)}const lA=new ge,_N=new ge;class w9 extends Vn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const n=e.levels;for(let i=0,r=n.length;i<r;i++){const o=n[i];this.addLevel(o.object.clone(),o.distance,o.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,n=0,i=0){n=Math.abs(n);const r=this.levels;let o;for(o=0;o<r.length&&!(n<r[o].distance);o++);return r.splice(o,0,{distance:n,hysteresis:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const n=this.levels;if(n.length>0){let i,r;for(i=1,r=n.length;i<r;i++){let o=n[i].distance;if(n[i].object.visible&&(o-=o*n[i].hysteresis),e<o)break}return n[i-1].object}return null}raycast(e,n){if(this.levels.length>0){lA.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(lA);this.getObjectForDistance(r).raycast(e,n)}}update(e){const n=this.levels;if(n.length>1){lA.setFromMatrixPosition(e.matrixWorld),_N.setFromMatrixPosition(this.matrixWorld);const i=lA.distanceTo(_N)/e.zoom;n[0].object.visible=!0;let r,o;for(r=1,o=n.length;r<o;r++){let a=n[r].distance;if(n[r].object.visible&&(a-=a*n[r].hysteresis),i>=a)n[r-1].object.visible=!1,n[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<o;r++)n[r].object.visible=!1}}toJSON(e){const n=super.toJSON(e);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];const i=this.levels;for(let r=0,o=i.length;r<o;r++){const a=i[r];n.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return n}}const kN=new ge,PN=new zn,UN=new zn,Cse=new ge,DN=new ln,cA=new ge,YG=new hr,ON=new ln,zG=new kg;class Z9 extends ti{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=BS,this.bindMatrix=new ln,this.bindMatrixInverse=new ln,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Cr),this.boundingBox.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,cA),this.boundingBox.expandByPoint(cA)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new hr),this.boundingSphere.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,cA),this.boundingSphere.expandByPoint(cA)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,n){const i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),YG.copy(this.boundingSphere),YG.applyMatrix4(r),e.ray.intersectsSphere(YG)!==!1&&(ON.copy(r).invert(),zG.copy(e.ray).applyMatrix4(ON),!(this.boundingBox!==null&&zG.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,n,zG)))}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new zn,n=this.geometry.attributes.skinWeight;for(let i=0,r=n.count;i<r;i++){e.fromBufferAttribute(n,i);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),n.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===BS?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Qz?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){const i=this.skeleton,r=this.geometry;PN.fromBufferAttribute(r.attributes.skinIndex,e),UN.fromBufferAttribute(r.attributes.skinWeight,e),kN.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let o=0;o<4;o++){const a=UN.getComponent(o);if(a!==0){const s=PN.getComponent(o);DN.multiplyMatrices(i.bones[s].matrixWorld,i.boneInverses[s]),n.addScaledVector(Cse.copy(kN).applyMatrix4(DN),a)}}return n.applyMatrix4(this.bindMatrixInverse)}}class l1 extends Vn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Oa extends Tn{constructor(e=null,n=1,i=1,r,o,a,s,l,c=rr,g=rr,u,d){super(null,a,s,l,c,g,r,o,u,d),this.isDataTexture=!0,this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const JN=new ln,hse=new ln;class Pv{constructor(e=[],n=[]){this.uuid=ko(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new ln)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const i=new ln;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,n=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let o=0,a=e.length;o<a;o++){const s=e[o]?e[o].matrixWorld:hse;JN.multiplyMatrices(s,n[o]),JN.toArray(i,o*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new Pv(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const i=new Oa(n,e,e,Wi,hi);return i.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=i,this}getBoneByName(e){for(let n=0,i=this.bones.length;n<i;n++){const r=this.bones[n];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const o=e.bones[i];let a=n[o];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),a=new l1),this.bones.push(a),this.boneInverses.push(new ln().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,i=this.boneInverses;for(let r=0,o=n.length;r<o;r++){const a=n[r];e.bones.push(a.uuid);const s=i[r];e.boneInverses.push(s.toArray())}return e}}class Hg extends Un{constructor(e,n,i,r=1){super(e,n,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Xu=new ln,QN=new ln,gA=[],jN=new Cr,fse=new ln,UI=new ti,DI=new hr;class vd extends ti{constructor(e,n,i){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new Hg(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,fse)}computeBoundingBox(){const e=this.geometry,n=this.count;this.boundingBox===null&&(this.boundingBox=new Cr),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,Xu),jN.copy(e.boundingBox).applyMatrix4(Xu),this.boundingBox.union(jN)}computeBoundingSphere(){const e=this.geometry,n=this.count;this.boundingSphere===null&&(this.boundingSphere=new hr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,Xu),DI.copy(e.boundingSphere).applyMatrix4(Xu),this.boundingSphere.union(DI)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,n){const i=n.morphTargetInfluences,r=this.morphTexture.source.data.data,o=i.length+1,a=e*o+1;for(let s=0;s<i.length;s++)i[s]=r[a+s]}raycast(e,n){const i=this.matrixWorld,r=this.count;if(UI.geometry=this.geometry,UI.material=this.material,UI.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),DI.copy(this.boundingSphere),DI.applyMatrix4(i),e.ray.intersectsSphere(DI)!==!1))for(let o=0;o<r;o++){this.getMatrixAt(o,Xu),QN.multiplyMatrices(i,Xu),UI.matrixWorld=QN,UI.raycast(e,gA);for(let a=0,s=gA.length;a<s;a++){const l=gA[a];l.instanceId=o,l.object=this,n.push(l)}gA.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new Hg(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,n){const i=n.morphTargetInfluences,r=i.length+1;this.morphTexture===null&&(this.morphTexture=new Oa(new Float32Array(r*this.count),r,this.count,sf,hi));const o=this.morphTexture.source.data.data;let a=0;for(let c=0;c<i.length;c++)a+=i[c];const s=this.geometry.morphTargetsRelative?1:1-a,l=r*e;o[l]=s,o.set(i,l+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function mse(t,e){return t.z-e.z}function Ase(t,e){return e.z-t.z}class pse{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,n,i){const r=this.pool,o=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1,index:-1});const a=r[this.index];o.push(a),this.index++,a.start=e.start,a.count=e.count,a.z=n,a.index=i}reset(){this.list.length=0,this.index=0}}const Nl=new ln,KG=new ln,vse=new ln,bse=new kt(1,1,1),$N=new ln,LG=new df,uA=new Cr,zc=new hr,OI=new ge,qN=new ge,yse=new ge,TG=new pse,xr=new ti,dA=[];function Gse(t,e,n=0){const i=e.itemSize;if(t.isInterleavedBufferAttribute||t.array.constructor!==e.array.constructor){const r=t.count;for(let o=0;o<r;o++)for(let a=0;a<i;a++)e.setComponent(o+n,a,t.getComponent(o,a))}else e.array.set(t.array,n*i);e.needsUpdate=!0}class x9 extends ti{get maxInstanceCount(){return this._maxInstanceCount}constructor(e,n,i=n*2,r){super(new Sn,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawInfo=[],this._drawRanges=[],this._reservedRanges=[],this._bounds=[],this._maxInstanceCount=e,this._maxVertexCount=n,this._maxIndexCount=i,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4),i=new Oa(n,e,e,Wi,hi);this._matricesTexture=i}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const n=new Uint32Array(e*e),i=new Oa(n,e,e,lf,ws);this._indirectTexture=i}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const n=new Float32Array(e*e*4).fill(1),i=new Oa(n,e,e,Wi,hi);i.colorSpace=Yn.workingColorSpace,this._colorsTexture=i}_initializeGeometry(e){const n=this.geometry,i=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(const o in e.attributes){const a=e.getAttribute(o),{array:s,itemSize:l,normalized:c}=a,g=new s.constructor(i*l),u=new Un(g,l,c);n.setAttribute(o,u)}if(e.getIndex()!==null){const o=i>65535?new Uint32Array(r):new Uint16Array(r);n.setIndex(new Un(o,1))}this._geometryInitialized=!0}}_validateGeometry(e){const n=this.geometry;if(!!e.getIndex()!=!!n.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const i in n.attributes){if(!e.hasAttribute(i))throw new Error(`BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);const r=e.getAttribute(i),o=n.getAttribute(i);if(r.itemSize!==o.itemSize||r.normalized!==o.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Cr);const e=this.boundingBox,n=this._drawInfo;e.makeEmpty();for(let i=0,r=n.length;i<r;i++){if(n[i].active===!1)continue;const o=n[i].geometryIndex;this.getMatrixAt(i,Nl),this.getBoundingBoxAt(o,uA).applyMatrix4(Nl),e.union(uA)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new hr);const e=this.boundingSphere,n=this._drawInfo;e.makeEmpty();for(let i=0,r=n.length;i<r;i++){if(n[i].active===!1)continue;const o=n[i].geometryIndex;this.getMatrixAt(i,Nl),this.getBoundingSphereAt(o,zc).applyMatrix4(Nl),e.union(zc)}}addInstance(e){if(this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");this._drawInfo.push({visible:!0,active:!0,geometryIndex:e});const n=this._drawInfo.length-1,i=this._matricesTexture,r=i.image.data;vse.toArray(r,n*16),i.needsUpdate=!0;const o=this._colorsTexture;return o&&(bse.toArray(o.image.data,n*4),o.needsUpdate=!0),n}addGeometry(e,n=-1,i=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");const r={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let o=null;const a=this._reservedRanges,s=this._drawRanges,l=this._bounds;this._geometryCount!==0&&(o=a[a.length-1]),n===-1?r.vertexCount=e.getAttribute("position").count:r.vertexCount=n,o===null?r.vertexStart=0:r.vertexStart=o.vertexStart+o.vertexCount;const c=e.getIndex(),g=c!==null;if(g&&(i===-1?r.indexCount=c.count:r.indexCount=i,o===null?r.indexStart=0:r.indexStart=o.indexStart+o.indexCount),r.indexStart!==-1&&r.indexStart+r.indexCount>this._maxIndexCount||r.vertexStart+r.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const u=this._geometryCount;return this._geometryCount++,a.push(r),s.push({start:g?r.indexStart:r.vertexStart,count:-1}),l.push({boxInitialized:!1,box:new Cr,sphereInitialized:!1,sphere:new hr}),this.setGeometryAt(u,e),u}setGeometryAt(e,n){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(n);const i=this.geometry,r=i.getIndex()!==null,o=i.getIndex(),a=n.getIndex(),s=this._reservedRanges[e];if(r&&a.count>s.indexCount||n.attributes.position.count>s.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const l=s.vertexStart,c=s.vertexCount;for(const C in i.attributes){const f=n.getAttribute(C),v=i.getAttribute(C);Gse(f,v,l);const p=f.itemSize;for(let m=f.count,A=c;m<A;m++){const b=l+m;for(let G=0;G<p;G++)v.setComponent(b,G,0)}v.needsUpdate=!0,v.addUpdateRange(l*p,c*p)}if(r){const C=s.indexStart;for(let f=0;f<a.count;f++)o.setX(C+f,l+a.getX(f));for(let f=a.count,v=s.indexCount;f<v;f++)o.setX(C+f,l);o.needsUpdate=!0,o.addUpdateRange(C,s.indexCount)}const g=this._bounds[e];n.boundingBox!==null?(g.box.copy(n.boundingBox),g.boxInitialized=!0):g.boxInitialized=!1,n.boundingSphere!==null?(g.sphere.copy(n.boundingSphere),g.sphereInitialized=!0):g.sphereInitialized=!1;const u=this._drawRanges[e],d=n.getAttribute("position");return u.count=r?a.count:d.count,this._visibilityChanged=!0,e}getBoundingBoxAt(e,n){if(e>=this._geometryCount)return null;const i=this._bounds[e],r=i.box,o=this.geometry;if(i.boxInitialized===!1){r.makeEmpty();const a=o.index,s=o.attributes.position,l=this._drawRanges[e];for(let c=l.start,g=l.start+l.count;c<g;c++){let u=c;a&&(u=a.getX(u)),r.expandByPoint(OI.fromBufferAttribute(s,u))}i.boxInitialized=!0}return n.copy(r),n}getBoundingSphereAt(e,n){if(e>=this._geometryCount)return null;const i=this._bounds[e],r=i.sphere,o=this.geometry;if(i.sphereInitialized===!1){r.makeEmpty(),this.getBoundingBoxAt(e,uA),uA.getCenter(r.center);const a=o.index,s=o.attributes.position,l=this._drawRanges[e];let c=0;for(let g=l.start,u=l.start+l.count;g<u;g++){let d=g;a&&(d=a.getX(d)),OI.fromBufferAttribute(s,d),c=Math.max(c,r.center.distanceToSquared(OI))}r.radius=Math.sqrt(c),i.sphereInitialized=!0}return n.copy(r),n}setMatrixAt(e,n){const i=this._drawInfo,r=this._matricesTexture,o=this._matricesTexture.image.data;return e>=i.length||i[e].active===!1?this:(n.toArray(o,e*16),r.needsUpdate=!0,this)}getMatrixAt(e,n){const i=this._drawInfo,r=this._matricesTexture.image.data;return e>=i.length||i[e].active===!1?null:n.fromArray(r,e*16)}setColorAt(e,n){this._colorsTexture===null&&this._initColorsTexture();const i=this._colorsTexture,r=this._colorsTexture.image.data,o=this._drawInfo;return e>=o.length||o[e].active===!1?this:(n.toArray(r,e*4),i.needsUpdate=!0,this)}getColorAt(e,n){const i=this._colorsTexture.image.data,r=this._drawInfo;return e>=r.length||r[e].active===!1?null:n.fromArray(i,e*4)}setVisibleAt(e,n){const i=this._drawInfo;return e>=i.length||i[e].active===!1||i[e].visible===n?this:(i[e].visible=n,this._visibilityChanged=!0,this)}getVisibleAt(e){const n=this._drawInfo;return e>=n.length||n[e].active===!1?!1:n[e].visible}raycast(e,n){const i=this._drawInfo,r=this._drawRanges,o=this.matrixWorld,a=this.geometry;xr.material=this.material,xr.geometry.index=a.index,xr.geometry.attributes=a.attributes,xr.geometry.boundingBox===null&&(xr.geometry.boundingBox=new Cr),xr.geometry.boundingSphere===null&&(xr.geometry.boundingSphere=new hr);for(let s=0,l=i.length;s<l;s++){if(!i[s].visible||!i[s].active)continue;const c=i[s].geometryIndex,g=r[c];xr.geometry.setDrawRange(g.start,g.count),this.getMatrixAt(s,xr.matrixWorld).premultiply(o),this.getBoundingBoxAt(c,xr.geometry.boundingBox),this.getBoundingSphereAt(c,xr.geometry.boundingSphere),xr.raycast(e,dA);for(let u=0,d=dA.length;u<d;u++){const C=dA[u];C.object=this,C.batchId=s,n.push(C)}dA.length=0}xr.material=null,xr.geometry.index=null,xr.geometry.attributes={},xr.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(n=>({...n})),this._reservedRanges=e._reservedRanges.map(n=>({...n})),this._drawInfo=e._drawInfo.map(n=>({...n})),this._bounds=e._bounds.map(n=>({boxInitialized:n.boxInitialized,box:n.box.clone(),sphereInitialized:n.sphereInitialized,sphere:n.sphere.clone()})),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(e,n,i,r,o){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=r.getIndex(),s=a===null?1:a.array.BYTES_PER_ELEMENT,l=this._drawInfo,c=this._multiDrawStarts,g=this._multiDrawCounts,u=this._drawRanges,d=this.perObjectFrustumCulled,C=this._indirectTexture,f=C.image.data;d&&($N.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),LG.setFromProjectionMatrix($N,e.coordinateSystem));let v=0;if(this.sortObjects){KG.copy(this.matrixWorld).invert(),OI.setFromMatrixPosition(i.matrixWorld).applyMatrix4(KG),qN.set(0,0,-1).transformDirection(i.matrixWorld).transformDirection(KG);for(let A=0,b=l.length;A<b;A++)if(l[A].visible&&l[A].active){const G=l[A].geometryIndex;this.getMatrixAt(A,Nl),this.getBoundingSphereAt(G,zc).applyMatrix4(Nl);let w=!1;if(d&&(w=!LG.intersectsSphere(zc)),!w){const S=yse.subVectors(zc.center,OI).dot(qN);TG.push(u[G],S,A)}}const p=TG.list,m=this.customSort;m===null?p.sort(o.transparent?Ase:mse):m.call(this,p,i);for(let A=0,b=p.length;A<b;A++){const G=p[A];c[v]=G.start*s,g[v]=G.count,f[v]=G.index,v++}TG.reset()}else for(let p=0,m=l.length;p<m;p++)if(l[p].visible&&l[p].active){const A=l[p].geometryIndex;let b=!1;if(d&&(this.getMatrixAt(p,Nl),this.getBoundingSphereAt(A,zc).applyMatrix4(Nl),b=!LG.intersectsSphere(zc)),!b){const G=u[A];c[v]=G.start*s,g[v]=G.count,f[v]=p,v++}}C.needsUpdate=!0,this._multiDrawCount=v,this._visibilityChanged=!1}onBeforeShadow(e,n,i,r,o,a){this.onBeforeRender(e,null,r,o,a)}}class io extends Er{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new kt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const N0=new ge,F0=new ge,eF=new ln,JI=new kg,IA=new hr,_G=new ge,tF=new ge;class uc extends Vn{constructor(e=new Sn,n=new io){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let r=1,o=n.count;r<o;r++)N0.fromBufferAttribute(n,r-1),F0.fromBufferAttribute(n,r),i[r]=i[r-1],i[r]+=N0.distanceTo(F0);e.setAttribute("lineDistance",new tn(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,o=e.params.Line.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),IA.copy(i.boundingSphere),IA.applyMatrix4(r),IA.radius+=o,e.ray.intersectsSphere(IA)===!1)return;eF.copy(r).invert(),JI.copy(e.ray).applyMatrix4(eF);const s=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=s*s,c=this.isLineSegments?2:1,g=i.index,d=i.attributes.position;if(g!==null){const C=Math.max(0,a.start),f=Math.min(g.count,a.start+a.count);for(let v=C,p=f-1;v<p;v+=c){const m=g.getX(v),A=g.getX(v+1),b=CA(this,e,JI,l,m,A);b&&n.push(b)}if(this.isLineLoop){const v=g.getX(f-1),p=g.getX(C),m=CA(this,e,JI,l,v,p);m&&n.push(m)}}else{const C=Math.max(0,a.start),f=Math.min(d.count,a.start+a.count);for(let v=C,p=f-1;v<p;v+=c){const m=CA(this,e,JI,l,v,v+1);m&&n.push(m)}if(this.isLineLoop){const v=CA(this,e,JI,l,f-1,C);v&&n.push(v)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=r.length;o<a;o++){const s=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=o}}}}}function CA(t,e,n,i,r,o){const a=t.geometry.attributes.position;if(N0.fromBufferAttribute(a,r),F0.fromBufferAttribute(a,o),n.distanceSqToSegment(N0,F0,_G,tF)>i)return;_G.applyMatrix4(t.matrixWorld);const l=e.ray.origin.distanceTo(_G);if(!(l<e.near||l>e.far))return{distance:l,point:tF.clone().applyMatrix4(t.matrixWorld),index:r,face:null,faceIndex:null,object:t}}const nF=new ge,iF=new ge;class Ws extends uc{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[];for(let r=0,o=n.count;r<o;r+=2)nF.fromBufferAttribute(n,r),iF.fromBufferAttribute(n,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+nF.distanceTo(iF);e.setAttribute("lineDistance",new tn(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class R9 extends uc{constructor(e,n){super(e,n),this.isLineLoop=!0,this.type="LineLoop"}}class c1 extends Er{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new kt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const rF=new ln,VS=new kg,hA=new hr,fA=new ge;class W9 extends Vn{constructor(e=new Sn,n=new c1){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,o=e.params.Points.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),hA.copy(i.boundingSphere),hA.applyMatrix4(r),hA.radius+=o,e.ray.intersectsSphere(hA)===!1)return;rF.copy(r).invert(),VS.copy(e.ray).applyMatrix4(rF);const s=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=s*s,c=i.index,u=i.attributes.position;if(c!==null){const d=Math.max(0,a.start),C=Math.min(c.count,a.start+a.count);for(let f=d,v=C;f<v;f++){const p=c.getX(f);fA.fromBufferAttribute(u,p),oF(fA,p,l,r,e,n,this)}}else{const d=Math.max(0,a.start),C=Math.min(u.count,a.start+a.count);for(let f=d,v=C;f<v;f++)fA.fromBufferAttribute(u,f),oF(fA,f,l,r,e,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=r.length;o<a;o++){const s=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=o}}}}}function oF(t,e,n,i,r,o,a){const s=VS.distanceSqToPoint(t);if(s<n){const l=new ge;VS.closestPointToPoint(t,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;o.push({distance:c,distanceToRay:Math.sqrt(s),point:l,index:e,face:null,object:a})}}class Bse extends Tn{constructor(e,n,i,r,o,a,s,l,c){super(e,n,i,r,o,a,s,l,c),this.isVideoTexture=!0,this.minFilter=a!==void 0?a:Kn,this.magFilter=o!==void 0?o:Kn,this.generateMipmaps=!1;const g=this;function u(){g.needsUpdate=!0,e.requestVideoFrameCallback(u)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(u)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class Sse extends Tn{constructor(e,n){super({width:e,height:n}),this.isFramebufferTexture=!0,this.magFilter=rr,this.minFilter=rr,this.generateMipmaps=!1,this.needsUpdate=!0}}class Uv extends Tn{constructor(e,n,i,r,o,a,s,l,c,g,u,d){super(null,a,s,l,c,g,r,o,u,d),this.isCompressedTexture=!0,this.image={width:n,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class wse extends Uv{constructor(e,n,i,r,o,a){super(e,n,i,o,a),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=zi,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Zse extends Uv{constructor(e,n,i){super(void 0,e[0].width,e[0].height,n,i,Ss),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class xse extends Tn{constructor(e,n,i,r,o,a,s,l,c){super(e,n,i,r,o,a,s,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class es{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,r=this.getPoint(0),o=0;n.push(0);for(let a=1;a<=e;a++)i=this.getPoint(a/e),o+=i.distanceTo(r),n.push(o),r=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n){const i=this.getLengths();let r=0;const o=i.length;let a;n?a=n:a=e*i[o-1];let s=0,l=o-1,c;for(;s<=l;)if(r=Math.floor(s+(l-s)/2),c=i[r]-a,c<0)s=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,i[r]===a)return r/(o-1);const g=i[r],d=i[r+1]-g,C=(a-g)/d;return(r+C)/(o-1)}getTangent(e,n){let r=e-1e-4,o=e+1e-4;r<0&&(r=0),o>1&&(o=1);const a=this.getPoint(r),s=this.getPoint(o),l=n||(a.isVector2?new gt:new ge);return l.copy(s).sub(a).normalize(),l}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n){const i=new ge,r=[],o=[],a=[],s=new ge,l=new ln;for(let C=0;C<=e;C++){const f=C/e;r[C]=this.getTangentAt(f,new ge)}o[0]=new ge,a[0]=new ge;let c=Number.MAX_VALUE;const g=Math.abs(r[0].x),u=Math.abs(r[0].y),d=Math.abs(r[0].z);g<=c&&(c=g,i.set(1,0,0)),u<=c&&(c=u,i.set(0,1,0)),d<=c&&i.set(0,0,1),s.crossVectors(r[0],i).normalize(),o[0].crossVectors(r[0],s),a[0].crossVectors(r[0],o[0]);for(let C=1;C<=e;C++){if(o[C]=o[C-1].clone(),a[C]=a[C-1].clone(),s.crossVectors(r[C-1],r[C]),s.length()>Number.EPSILON){s.normalize();const f=Math.acos(yi(r[C-1].dot(r[C]),-1,1));o[C].applyMatrix4(l.makeRotationAxis(s,f))}a[C].crossVectors(r[C],o[C])}if(n===!0){let C=Math.acos(yi(o[0].dot(o[e]),-1,1));C/=e,r[0].dot(s.crossVectors(o[0],o[e]))>0&&(C=-C);for(let f=1;f<=e;f++)o[f].applyMatrix4(l.makeRotationAxis(r[f],C*f)),a[f].crossVectors(r[f],o[f])}return{tangents:r,normals:o,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Dv extends es{constructor(e=0,n=0,i=1,r=1,o=0,a=Math.PI*2,s=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=i,this.yRadius=r,this.aStartAngle=o,this.aEndAngle=a,this.aClockwise=s,this.aRotation=l}getPoint(e,n=new gt){const i=n,r=Math.PI*2;let o=this.aEndAngle-this.aStartAngle;const a=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=r;for(;o>r;)o-=r;o<Number.EPSILON&&(a?o=0:o=r),this.aClockwise===!0&&!a&&(o===r?o=-r:o=o-r);const s=this.aStartAngle+e*o;let l=this.aX+this.xRadius*Math.cos(s),c=this.aY+this.yRadius*Math.sin(s);if(this.aRotation!==0){const g=Math.cos(this.aRotation),u=Math.sin(this.aRotation),d=l-this.aX,C=c-this.aY;l=d*g-C*u+this.aX,c=d*u+C*g+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class V9 extends Dv{constructor(e,n,i,r,o,a){super(e,n,i,i,r,o,a),this.isArcCurve=!0,this.type="ArcCurve"}}function g1(){let t=0,e=0,n=0,i=0;function r(o,a,s,l){t=o,e=s,n=-3*o+3*a-2*s-l,i=2*o-2*a+s+l}return{initCatmullRom:function(o,a,s,l,c){r(a,s,c*(s-o),c*(l-a))},initNonuniformCatmullRom:function(o,a,s,l,c,g,u){let d=(a-o)/c-(s-o)/(c+g)+(s-a)/g,C=(s-a)/g-(l-a)/(g+u)+(l-s)/u;d*=g,C*=g,r(a,s,d,C)},calc:function(o){const a=o*o,s=a*o;return t+e*o+n*a+i*s}}}const mA=new ge,kG=new g1,PG=new g1,UG=new g1;class M9 extends es{constructor(e=[],n=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=i,this.tension=r}getPoint(e,n=new ge){const i=n,r=this.points,o=r.length,a=(o-(this.closed?0:1))*e;let s=Math.floor(a),l=a-s;this.closed?s+=s>0?0:(Math.floor(Math.abs(s)/o)+1)*o:l===0&&s===o-1&&(s=o-2,l=1);let c,g;this.closed||s>0?c=r[(s-1)%o]:(mA.subVectors(r[0],r[1]).add(r[0]),c=mA);const u=r[s%o],d=r[(s+1)%o];if(this.closed||s+2<o?g=r[(s+2)%o]:(mA.subVectors(r[o-1],r[o-2]).add(r[o-1]),g=mA),this.curveType==="centripetal"||this.curveType==="chordal"){const C=this.curveType==="chordal"?.5:.25;let f=Math.pow(c.distanceToSquared(u),C),v=Math.pow(u.distanceToSquared(d),C),p=Math.pow(d.distanceToSquared(g),C);v<1e-4&&(v=1),f<1e-4&&(f=v),p<1e-4&&(p=v),kG.initNonuniformCatmullRom(c.x,u.x,d.x,g.x,f,v,p),PG.initNonuniformCatmullRom(c.y,u.y,d.y,g.y,f,v,p),UG.initNonuniformCatmullRom(c.z,u.z,d.z,g.z,f,v,p)}else this.curveType==="catmullrom"&&(kG.initCatmullRom(c.x,u.x,d.x,g.x,this.tension),PG.initCatmullRom(c.y,u.y,d.y,g.y,this.tension),UG.initCatmullRom(c.z,u.z,d.z,g.z,this.tension));return i.set(kG.calc(l),PG.calc(l),UG.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new ge().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function aF(t,e,n,i,r){const o=(i-e)*.5,a=(r-n)*.5,s=t*t,l=t*s;return(2*n-2*i+o+a)*l+(-3*n+3*i-2*o-a)*s+o*t+n}function Rse(t,e){const n=1-t;return n*n*e}function Wse(t,e){return 2*(1-t)*t*e}function Vse(t,e){return t*t*e}function EC(t,e,n,i){return Rse(t,e)+Wse(t,n)+Vse(t,i)}function Mse(t,e){const n=1-t;return n*n*n*e}function Nse(t,e){const n=1-t;return 3*n*n*t*e}function Fse(t,e){return 3*(1-t)*t*t*e}function Hse(t,e){return t*t*t*e}function YC(t,e,n,i,r){return Mse(t,e)+Nse(t,n)+Fse(t,i)+Hse(t,r)}class u1 extends es{constructor(e=new gt,n=new gt,i=new gt,r=new gt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new gt){const i=n,r=this.v0,o=this.v1,a=this.v2,s=this.v3;return i.set(YC(e,r.x,o.x,a.x,s.x),YC(e,r.y,o.y,a.y,s.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class N9 extends es{constructor(e=new ge,n=new ge,i=new ge,r=new ge){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new ge){const i=n,r=this.v0,o=this.v1,a=this.v2,s=this.v3;return i.set(YC(e,r.x,o.x,a.x,s.x),YC(e,r.y,o.y,a.y,s.y),YC(e,r.z,o.z,a.z,s.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class d1 extends es{constructor(e=new gt,n=new gt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new gt){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new gt){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class F9 extends es{constructor(e=new ge,n=new ge){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new ge){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new ge){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class I1 extends es{constructor(e=new gt,n=new gt,i=new gt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new gt){const i=n,r=this.v0,o=this.v1,a=this.v2;return i.set(EC(e,r.x,o.x,a.x),EC(e,r.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class C1 extends es{constructor(e=new ge,n=new ge,i=new ge){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new ge){const i=n,r=this.v0,o=this.v1,a=this.v2;return i.set(EC(e,r.x,o.x,a.x),EC(e,r.y,o.y,a.y),EC(e,r.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class h1 extends es{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new gt){const i=n,r=this.points,o=(r.length-1)*e,a=Math.floor(o),s=o-a,l=r[a===0?a:a-1],c=r[a],g=r[a>r.length-2?r.length-1:a+1],u=r[a>r.length-3?r.length-1:a+2];return i.set(aF(s,l.x,c.x,g.x,u.x),aF(s,l.y,c.y,g.y,u.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new gt().fromArray(r))}return this}}var H0=Object.freeze({__proto__:null,ArcCurve:V9,CatmullRomCurve3:M9,CubicBezierCurve:u1,CubicBezierCurve3:N9,EllipseCurve:Dv,LineCurve:d1,LineCurve3:F9,QuadraticBezierCurve:I1,QuadraticBezierCurve3:C1,SplineCurve:h1});class H9 extends es{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(n)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new H0[i](n,e))}return this}getPoint(e,n){const i=e*this.getLength(),r=this.getCurveLengths();let o=0;for(;o<r.length;){if(r[o]>=i){const a=r[o]-i,s=this.curves[o],l=s.getLength(),c=l===0?0:1-a/l;return s.getPointAt(c,n)}o++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let i=0,r=this.curves.length;i<r;i++)n+=this.curves[i].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let i;for(let r=0,o=this.curves;r<o.length;r++){const a=o[r],s=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,l=a.getPoints(s);for(let c=0;c<l.length;c++){const g=l[c];i&&i.equals(g)||(n.push(g),i=g)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,i=this.curves.length;n<i;n++){const r=this.curves[n];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(new H0[r.type]().fromJSON(r))}return this}}class Wh extends H9{constructor(e){super(),this.type="Path",this.currentPoint=new gt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,i=e.length;n<i;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const i=new d1(this.currentPoint.clone(),new gt(e,n));return this.curves.push(i),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,i,r){const o=new I1(this.currentPoint.clone(),new gt(e,n),new gt(i,r));return this.curves.push(o),this.currentPoint.set(i,r),this}bezierCurveTo(e,n,i,r,o,a){const s=new u1(this.currentPoint.clone(),new gt(e,n),new gt(i,r),new gt(o,a));return this.curves.push(s),this.currentPoint.set(o,a),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),i=new h1(n);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,i,r,o,a){const s=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+s,n+l,i,r,o,a),this}absarc(e,n,i,r,o,a){return this.absellipse(e,n,i,i,r,o,a),this}ellipse(e,n,i,r,o,a,s,l){const c=this.currentPoint.x,g=this.currentPoint.y;return this.absellipse(e+c,n+g,i,r,o,a,s,l),this}absellipse(e,n,i,r,o,a,s,l){const c=new Dv(e,n,i,r,o,a,s,l);if(this.curves.length>0){const u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);const g=c.getPoint(1);return this.currentPoint.copy(g),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Cf extends Sn{constructor(e=[new gt(0,-.5),new gt(.5,0),new gt(0,.5)],n=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:i,phiLength:r},n=Math.floor(n),r=yi(r,0,Math.PI*2);const o=[],a=[],s=[],l=[],c=[],g=1/n,u=new ge,d=new gt,C=new ge,f=new ge,v=new ge;let p=0,m=0;for(let A=0;A<=e.length-1;A++)switch(A){case 0:p=e[A+1].x-e[A].x,m=e[A+1].y-e[A].y,C.x=m*1,C.y=-p,C.z=m*0,v.copy(C),C.normalize(),l.push(C.x,C.y,C.z);break;case e.length-1:l.push(v.x,v.y,v.z);break;default:p=e[A+1].x-e[A].x,m=e[A+1].y-e[A].y,C.x=m*1,C.y=-p,C.z=m*0,f.copy(C),C.x+=v.x,C.y+=v.y,C.z+=v.z,C.normalize(),l.push(C.x,C.y,C.z),v.copy(f)}for(let A=0;A<=n;A++){const b=i+A*g*r,G=Math.sin(b),w=Math.cos(b);for(let S=0;S<=e.length-1;S++){u.x=e[S].x*G,u.y=e[S].y,u.z=e[S].x*w,a.push(u.x,u.y,u.z),d.x=A/n,d.y=S/(e.length-1),s.push(d.x,d.y);const Z=l[3*S+0]*G,x=l[3*S+1],R=l[3*S+0]*w;c.push(Z,x,R)}}for(let A=0;A<n;A++)for(let b=0;b<e.length-1;b++){const G=b+A*e.length,w=G,S=G+e.length,Z=G+e.length+1,x=G+1;o.push(w,S,x),o.push(Z,x,S)}this.setIndex(o),this.setAttribute("position",new tn(a,3)),this.setAttribute("uv",new tn(s,2)),this.setAttribute("normal",new tn(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Cf(e.points,e.segments,e.phiStart,e.phiLength)}}class Ov extends Cf{constructor(e=1,n=1,i=4,r=8){const o=new Wh;o.absarc(0,-n/2,e,Math.PI*1.5,0),o.absarc(0,n/2,e,0,Math.PI*.5),super(o.getPoints(i),r),this.type="CapsuleGeometry",this.parameters={radius:e,length:n,capSegments:i,radialSegments:r}}static fromJSON(e){return new Ov(e.radius,e.length,e.capSegments,e.radialSegments)}}class Jv extends Sn{constructor(e=1,n=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:i,thetaLength:r},n=Math.max(3,n);const o=[],a=[],s=[],l=[],c=new ge,g=new gt;a.push(0,0,0),s.push(0,0,1),l.push(.5,.5);for(let u=0,d=3;u<=n;u++,d+=3){const C=i+u/n*r;c.x=e*Math.cos(C),c.y=e*Math.sin(C),a.push(c.x,c.y,c.z),s.push(0,0,1),g.x=(a[d]/e+1)/2,g.y=(a[d+1]/e+1)/2,l.push(g.x,g.y)}for(let u=1;u<=n;u++)o.push(u,u+1,0);this.setIndex(o),this.setAttribute("position",new tn(a,3)),this.setAttribute("normal",new tn(s,3)),this.setAttribute("uv",new tn(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Jv(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class nI extends Sn{constructor(e=1,n=1,i=1,r=32,o=1,a=!1,s=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:r,heightSegments:o,openEnded:a,thetaStart:s,thetaLength:l};const c=this;r=Math.floor(r),o=Math.floor(o);const g=[],u=[],d=[],C=[];let f=0;const v=[],p=i/2;let m=0;A(),a===!1&&(e>0&&b(!0),n>0&&b(!1)),this.setIndex(g),this.setAttribute("position",new tn(u,3)),this.setAttribute("normal",new tn(d,3)),this.setAttribute("uv",new tn(C,2));function A(){const G=new ge,w=new ge;let S=0;const Z=(n-e)/i;for(let x=0;x<=o;x++){const R=[],W=x/o,M=W*(n-e)+e;for(let N=0;N<=r;N++){const X=N/r,E=X*l+s,Q=Math.sin(E),k=Math.cos(E);w.x=M*Q,w.y=-W*i+p,w.z=M*k,u.push(w.x,w.y,w.z),G.set(Q,Z,k).normalize(),d.push(G.x,G.y,G.z),C.push(X,1-W),R.push(f++)}v.push(R)}for(let x=0;x<r;x++)for(let R=0;R<o;R++){const W=v[R][x],M=v[R+1][x],N=v[R+1][x+1],X=v[R][x+1];g.push(W,M,X),g.push(M,N,X),S+=6}c.addGroup(m,S,0),m+=S}function b(G){const w=f,S=new gt,Z=new ge;let x=0;const R=G===!0?e:n,W=G===!0?1:-1;for(let N=1;N<=r;N++)u.push(0,p*W,0),d.push(0,W,0),C.push(.5,.5),f++;const M=f;for(let N=0;N<=r;N++){const E=N/r*l+s,Q=Math.cos(E),k=Math.sin(E);Z.x=R*k,Z.y=p*W,Z.z=R*Q,u.push(Z.x,Z.y,Z.z),d.push(0,W,0),S.x=Q*.5+.5,S.y=k*.5*W+.5,C.push(S.x,S.y),f++}for(let N=0;N<r;N++){const X=w+N,E=M+N;G===!0?g.push(E,E+1,X):g.push(E+1,E,X),x+=3}c.addGroup(m,x,G===!0?1:2),m+=x}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new nI(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Qv extends nI{constructor(e=1,n=1,i=32,r=1,o=!1,a=0,s=Math.PI*2){super(0,e,n,i,r,o,a,s),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s}}static fromJSON(e){return new Qv(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class mc extends Sn{constructor(e=[],n=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:i,detail:r};const o=[],a=[];s(r),c(i),g(),this.setAttribute("position",new tn(o,3)),this.setAttribute("normal",new tn(o.slice(),3)),this.setAttribute("uv",new tn(a,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function s(A){const b=new ge,G=new ge,w=new ge;for(let S=0;S<n.length;S+=3)C(n[S+0],b),C(n[S+1],G),C(n[S+2],w),l(b,G,w,A)}function l(A,b,G,w){const S=w+1,Z=[];for(let x=0;x<=S;x++){Z[x]=[];const R=A.clone().lerp(G,x/S),W=b.clone().lerp(G,x/S),M=S-x;for(let N=0;N<=M;N++)N===0&&x===S?Z[x][N]=R:Z[x][N]=R.clone().lerp(W,N/M)}for(let x=0;x<S;x++)for(let R=0;R<2*(S-x)-1;R++){const W=Math.floor(R/2);R%2===0?(d(Z[x][W+1]),d(Z[x+1][W]),d(Z[x][W])):(d(Z[x][W+1]),d(Z[x+1][W+1]),d(Z[x+1][W]))}}function c(A){const b=new ge;for(let G=0;G<o.length;G+=3)b.x=o[G+0],b.y=o[G+1],b.z=o[G+2],b.normalize().multiplyScalar(A),o[G+0]=b.x,o[G+1]=b.y,o[G+2]=b.z}function g(){const A=new ge;for(let b=0;b<o.length;b+=3){A.x=o[b+0],A.y=o[b+1],A.z=o[b+2];const G=p(A)/2/Math.PI+.5,w=m(A)/Math.PI+.5;a.push(G,1-w)}f(),u()}function u(){for(let A=0;A<a.length;A+=6){const b=a[A+0],G=a[A+2],w=a[A+4],S=Math.max(b,G,w),Z=Math.min(b,G,w);S>.9&&Z<.1&&(b<.2&&(a[A+0]+=1),G<.2&&(a[A+2]+=1),w<.2&&(a[A+4]+=1))}}function d(A){o.push(A.x,A.y,A.z)}function C(A,b){const G=A*3;b.x=e[G+0],b.y=e[G+1],b.z=e[G+2]}function f(){const A=new ge,b=new ge,G=new ge,w=new ge,S=new gt,Z=new gt,x=new gt;for(let R=0,W=0;R<o.length;R+=9,W+=6){A.set(o[R+0],o[R+1],o[R+2]),b.set(o[R+3],o[R+4],o[R+5]),G.set(o[R+6],o[R+7],o[R+8]),S.set(a[W+0],a[W+1]),Z.set(a[W+2],a[W+3]),x.set(a[W+4],a[W+5]),w.copy(A).add(b).add(G).divideScalar(3);const M=p(w);v(S,W+0,A,M),v(Z,W+2,b,M),v(x,W+4,G,M)}}function v(A,b,G,w){w<0&&A.x===1&&(a[b]=A.x-1),G.x===0&&G.z===0&&(a[b]=w/2/Math.PI+.5)}function p(A){return Math.atan2(A.z,-A.x)}function m(A){return Math.atan2(-A.y,Math.sqrt(A.x*A.x+A.z*A.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new mc(e.vertices,e.indices,e.radius,e.details)}}class jv extends mc{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=1/i,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(o,a,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new jv(e.radius,e.detail)}}const AA=new ge,pA=new ge,DG=new ge,vA=new zo;class X9 extends Sn{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){const r=Math.pow(10,4),o=Math.cos(vg*n),a=e.getIndex(),s=e.getAttribute("position"),l=a?a.count:s.count,c=[0,0,0],g=["a","b","c"],u=new Array(3),d={},C=[];for(let f=0;f<l;f+=3){a?(c[0]=a.getX(f),c[1]=a.getX(f+1),c[2]=a.getX(f+2)):(c[0]=f,c[1]=f+1,c[2]=f+2);const{a:v,b:p,c:m}=vA;if(v.fromBufferAttribute(s,c[0]),p.fromBufferAttribute(s,c[1]),m.fromBufferAttribute(s,c[2]),vA.getNormal(DG),u[0]=`${Math.round(v.x*r)},${Math.round(v.y*r)},${Math.round(v.z*r)}`,u[1]=`${Math.round(p.x*r)},${Math.round(p.y*r)},${Math.round(p.z*r)}`,u[2]=`${Math.round(m.x*r)},${Math.round(m.y*r)},${Math.round(m.z*r)}`,!(u[0]===u[1]||u[1]===u[2]||u[2]===u[0]))for(let A=0;A<3;A++){const b=(A+1)%3,G=u[A],w=u[b],S=vA[g[A]],Z=vA[g[b]],x=`${G}_${w}`,R=`${w}_${G}`;R in d&&d[R]?(DG.dot(d[R].normal)<=o&&(C.push(S.x,S.y,S.z),C.push(Z.x,Z.y,Z.z)),d[R]=null):x in d||(d[x]={index0:c[A],index1:c[b],normal:DG.clone()})}}for(const f in d)if(d[f]){const{index0:v,index1:p}=d[f];AA.fromBufferAttribute(s,v),pA.fromBufferAttribute(s,p),C.push(AA.x,AA.y,AA.z),C.push(pA.x,pA.y,pA.z)}this.setAttribute("position",new tn(C,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}let yg=class extends Wh{constructor(e){super(e),this.uuid=ko(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let i=0,r=this.holes.length;i<r;i++)n[i]=this.holes[i].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,i=this.holes.length;n<i;n++){const r=this.holes[n];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(new Wh().fromJSON(r))}return this}};const Xse={triangulate:function(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let o=E9(t,0,r,n,!0);const a=[];if(!o||o.next===o.prev)return a;let s,l,c,g,u,d,C;if(i&&(o=Lse(t,e,o,n)),t.length>80*n){s=c=t[0],l=g=t[1];for(let f=n;f<r;f+=n)u=t[f],d=t[f+1],u<s&&(s=u),d<l&&(l=d),u>c&&(c=u),d>g&&(g=d);C=Math.max(c-s,g-l),C=C!==0?32767/C:0}return Vh(o,a,n,s,l,C,0),a}};function E9(t,e,n,i,r){let o,a;if(r===$se(t,e,n,i)>0)for(o=e;o<n;o+=i)a=sF(o,t[o],t[o+1],a);else for(o=n-i;o>=e;o-=i)a=sF(o,t[o],t[o+1],a);return a&&$v(a,a.next)&&(Nh(a),a=a.next),a}function Xg(t,e){if(!t)return t;e||(e=t);let n=t,i;do if(i=!1,!n.steiner&&($v(n,n.next)||Ci(n.prev,n,n.next)===0)){if(Nh(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function Vh(t,e,n,i,r,o,a){if(!t)return;!a&&o&&Use(t,i,r,o);let s=t,l,c;for(;t.prev!==t.next;){if(l=t.prev,c=t.next,o?Yse(t,i,r,o):Ese(t)){e.push(l.i/n|0),e.push(t.i/n|0),e.push(c.i/n|0),Nh(t),t=c.next,s=c.next;continue}if(t=c,t===s){a?a===1?(t=zse(Xg(t),e,n),Vh(t,e,n,i,r,o,2)):a===2&&Kse(t,e,n,i,r,o):Vh(Xg(t),e,n,i,r,o,1);break}}}function Ese(t){const e=t.prev,n=t,i=t.next;if(Ci(e,n,i)>=0)return!1;const r=e.x,o=n.x,a=i.x,s=e.y,l=n.y,c=i.y,g=r<o?r<a?r:a:o<a?o:a,u=s<l?s<c?s:c:l<c?l:c,d=r>o?r>a?r:a:o>a?o:a,C=s>l?s>c?s:c:l>c?l:c;let f=i.next;for(;f!==e;){if(f.x>=g&&f.x<=d&&f.y>=u&&f.y<=C&&ld(r,s,o,l,a,c,f.x,f.y)&&Ci(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Yse(t,e,n,i){const r=t.prev,o=t,a=t.next;if(Ci(r,o,a)>=0)return!1;const s=r.x,l=o.x,c=a.x,g=r.y,u=o.y,d=a.y,C=s<l?s<c?s:c:l<c?l:c,f=g<u?g<d?g:d:u<d?u:d,v=s>l?s>c?s:c:l>c?l:c,p=g>u?g>d?g:d:u>d?u:d,m=MS(C,f,e,n,i),A=MS(v,p,e,n,i);let b=t.prevZ,G=t.nextZ;for(;b&&b.z>=m&&G&&G.z<=A;){if(b.x>=C&&b.x<=v&&b.y>=f&&b.y<=p&&b!==r&&b!==a&&ld(s,g,l,u,c,d,b.x,b.y)&&Ci(b.prev,b,b.next)>=0||(b=b.prevZ,G.x>=C&&G.x<=v&&G.y>=f&&G.y<=p&&G!==r&&G!==a&&ld(s,g,l,u,c,d,G.x,G.y)&&Ci(G.prev,G,G.next)>=0))return!1;G=G.nextZ}for(;b&&b.z>=m;){if(b.x>=C&&b.x<=v&&b.y>=f&&b.y<=p&&b!==r&&b!==a&&ld(s,g,l,u,c,d,b.x,b.y)&&Ci(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;G&&G.z<=A;){if(G.x>=C&&G.x<=v&&G.y>=f&&G.y<=p&&G!==r&&G!==a&&ld(s,g,l,u,c,d,G.x,G.y)&&Ci(G.prev,G,G.next)>=0)return!1;G=G.nextZ}return!0}function zse(t,e,n){let i=t;do{const r=i.prev,o=i.next.next;!$v(r,o)&&Y9(r,i,i.next,o)&&Mh(r,o)&&Mh(o,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(o.i/n|0),Nh(i),Nh(i.next),i=t=o),i=i.next}while(i!==t);return Xg(i)}function Kse(t,e,n,i,r,o){let a=t;do{let s=a.next.next;for(;s!==a.prev;){if(a.i!==s.i&&Jse(a,s)){let l=z9(a,s);a=Xg(a,a.next),l=Xg(l,l.next),Vh(a,e,n,i,r,o,0),Vh(l,e,n,i,r,o,0);return}s=s.next}a=a.next}while(a!==t)}function Lse(t,e,n,i){const r=[];let o,a,s,l,c;for(o=0,a=e.length;o<a;o++)s=e[o]*i,l=o<a-1?e[o+1]*i:t.length,c=E9(t,s,l,i,!1),c===c.next&&(c.steiner=!0),r.push(Ose(c));for(r.sort(Tse),o=0;o<r.length;o++)n=_se(r[o],n);return n}function Tse(t,e){return t.x-e.x}function _se(t,e){const n=kse(t,e);if(!n)return e;const i=z9(n,t);return Xg(i,i.next),Xg(n,n.next)}function kse(t,e){let n=e,i=-1/0,r;const o=t.x,a=t.y;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){const d=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(d<=o&&d>i&&(i=d,r=n.x<n.next.x?n:n.next,d===o))return r}n=n.next}while(n!==e);if(!r)return null;const s=r,l=r.x,c=r.y;let g=1/0,u;n=r;do o>=n.x&&n.x>=l&&o!==n.x&&ld(a<c?o:i,a,l,c,a<c?i:o,a,n.x,n.y)&&(u=Math.abs(a-n.y)/(o-n.x),Mh(n,t)&&(u<g||u===g&&(n.x>r.x||n.x===r.x&&Pse(r,n)))&&(r=n,g=u)),n=n.next;while(n!==s);return r}function Pse(t,e){return Ci(t.prev,t,e.prev)<0&&Ci(e.next,t,t.next)<0}function Use(t,e,n,i){let r=t;do r.z===0&&(r.z=MS(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,Dse(r)}function Dse(t){let e,n,i,r,o,a,s,l,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,i=n,s=0,e=0;e<c&&(s++,i=i.nextZ,!!i);e++);for(l=c;s>0||l>0&&i;)s!==0&&(l===0||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,c*=2}while(a>1);return t}function MS(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function Ose(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function ld(t,e,n,i,r,o,a,s){return(r-a)*(e-s)>=(t-a)*(o-s)&&(t-a)*(i-s)>=(n-a)*(e-s)&&(n-a)*(o-s)>=(r-a)*(i-s)}function Jse(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Qse(t,e)&&(Mh(t,e)&&Mh(e,t)&&jse(t,e)&&(Ci(t.prev,t,e.prev)||Ci(t,e.prev,e))||$v(t,e)&&Ci(t.prev,t,t.next)>0&&Ci(e.prev,e,e.next)>0)}function Ci(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function $v(t,e){return t.x===e.x&&t.y===e.y}function Y9(t,e,n,i){const r=yA(Ci(t,e,n)),o=yA(Ci(t,e,i)),a=yA(Ci(n,i,t)),s=yA(Ci(n,i,e));return!!(r!==o&&a!==s||r===0&&bA(t,n,e)||o===0&&bA(t,i,e)||a===0&&bA(n,t,i)||s===0&&bA(n,e,i))}function bA(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function yA(t){return t>0?1:t<0?-1:0}function Qse(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Y9(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Mh(t,e){return Ci(t.prev,t,t.next)<0?Ci(t,e,t.next)>=0&&Ci(t,t.prev,e)>=0:Ci(t,e,t.prev)<0||Ci(t,t.next,e)<0}function jse(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,o=(t.y+e.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function z9(t,e){const n=new NS(t.i,t.x,t.y),i=new NS(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function sF(t,e,n,i){const r=new NS(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Nh(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function NS(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function $se(t,e,n,i){let r=0;for(let o=e,a=n-i;o<n;o+=i)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}class Bs{static area(e){const n=e.length;let i=0;for(let r=n-1,o=0;o<n;r=o++)i+=e[r].x*e[o].y-e[o].x*e[r].y;return i*.5}static isClockWise(e){return Bs.area(e)<0}static triangulateShape(e,n){const i=[],r=[],o=[];lF(e),cF(i,e);let a=e.length;n.forEach(lF);for(let l=0;l<n.length;l++)r.push(a),a+=n[l].length,cF(i,n[l]);const s=Xse.triangulate(i,r);for(let l=0;l<s.length;l+=3)o.push(s.slice(l,l+3));return o}}function lF(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function cF(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class qv extends Sn{constructor(e=new yg([new gt(.5,.5),new gt(-.5,.5),new gt(-.5,-.5),new gt(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const i=this,r=[],o=[];for(let s=0,l=e.length;s<l;s++){const c=e[s];a(c)}this.setAttribute("position",new tn(r,3)),this.setAttribute("uv",new tn(o,2)),this.computeVertexNormals();function a(s){const l=[],c=n.curveSegments!==void 0?n.curveSegments:12,g=n.steps!==void 0?n.steps:1,u=n.depth!==void 0?n.depth:1;let d=n.bevelEnabled!==void 0?n.bevelEnabled:!0,C=n.bevelThickness!==void 0?n.bevelThickness:.2,f=n.bevelSize!==void 0?n.bevelSize:C-.1,v=n.bevelOffset!==void 0?n.bevelOffset:0,p=n.bevelSegments!==void 0?n.bevelSegments:3;const m=n.extrudePath,A=n.UVGenerator!==void 0?n.UVGenerator:qse;let b,G=!1,w,S,Z,x;m&&(b=m.getSpacedPoints(g),G=!0,d=!1,w=m.computeFrenetFrames(g,!1),S=new ge,Z=new ge,x=new ge),d||(p=0,C=0,f=0,v=0);const R=s.extractPoints(c);let W=R.shape;const M=R.holes;if(!Bs.isClockWise(W)){W=W.reverse();for(let T=0,Ge=M.length;T<Ge;T++){const ne=M[T];Bs.isClockWise(ne)&&(M[T]=ne.reverse())}}const X=Bs.triangulateShape(W,M),E=W;for(let T=0,Ge=M.length;T<Ge;T++){const ne=M[T];W=W.concat(ne)}function Q(T,Ge,ne){return Ge||console.error("THREE.ExtrudeGeometry: vec does not exist"),T.clone().addScaledVector(Ge,ne)}const k=W.length,J=X.length;function F(T,Ge,ne){let he,ae,He;const ve=T.x-Ge.x,Me=T.y-Ge.y,q=ne.x-T.x,Y=ne.y-T.y,Ce=ve*ve+Me*Me,se=ve*Y-Me*q;if(Math.abs(se)>Number.EPSILON){const fe=Math.sqrt(Ce),Ze=Math.sqrt(q*q+Y*Y),Oe=Ge.x-Me/fe,Fe=Ge.y+ve/fe,Ee=ne.x-Y/Ze,Qe=ne.y+q/Ze,Ye=((Ee-Oe)*Y-(Qe-Fe)*q)/(ve*Y-Me*q);he=Oe+ve*Ye-T.x,ae=Fe+Me*Ye-T.y;const $e=he*he+ae*ae;if($e<=2)return new gt(he,ae);He=Math.sqrt($e/2)}else{let fe=!1;ve>Number.EPSILON?q>Number.EPSILON&&(fe=!0):ve<-Number.EPSILON?q<-Number.EPSILON&&(fe=!0):Math.sign(Me)===Math.sign(Y)&&(fe=!0),fe?(he=-Me,ae=ve,He=Math.sqrt(Ce)):(he=ve,ae=Me,He=Math.sqrt(Ce/2))}return new gt(he/He,ae/He)}const L=[];for(let T=0,Ge=E.length,ne=Ge-1,he=T+1;T<Ge;T++,ne++,he++)ne===Ge&&(ne=0),he===Ge&&(he=0),L[T]=F(E[T],E[ne],E[he]);const z=[];let K,O=L.concat();for(let T=0,Ge=M.length;T<Ge;T++){const ne=M[T];K=[];for(let he=0,ae=ne.length,He=ae-1,ve=he+1;he<ae;he++,He++,ve++)He===ae&&(He=0),ve===ae&&(ve=0),K[he]=F(ne[he],ne[He],ne[ve]);z.push(K),O=O.concat(K)}for(let T=0;T<p;T++){const Ge=T/p,ne=C*Math.cos(Ge*Math.PI/2),he=f*Math.sin(Ge*Math.PI/2)+v;for(let ae=0,He=E.length;ae<He;ae++){const ve=Q(E[ae],L[ae],he);ie(ve.x,ve.y,-ne)}for(let ae=0,He=M.length;ae<He;ae++){const ve=M[ae];K=z[ae];for(let Me=0,q=ve.length;Me<q;Me++){const Y=Q(ve[Me],K[Me],he);ie(Y.x,Y.y,-ne)}}}const j=f+v;for(let T=0;T<k;T++){const Ge=d?Q(W[T],O[T],j):W[T];G?(Z.copy(w.normals[0]).multiplyScalar(Ge.x),S.copy(w.binormals[0]).multiplyScalar(Ge.y),x.copy(b[0]).add(Z).add(S),ie(x.x,x.y,x.z)):ie(Ge.x,Ge.y,0)}for(let T=1;T<=g;T++)for(let Ge=0;Ge<k;Ge++){const ne=d?Q(W[Ge],O[Ge],j):W[Ge];G?(Z.copy(w.normals[T]).multiplyScalar(ne.x),S.copy(w.binormals[T]).multiplyScalar(ne.y),x.copy(b[T]).add(Z).add(S),ie(x.x,x.y,x.z)):ie(ne.x,ne.y,u/g*T)}for(let T=p-1;T>=0;T--){const Ge=T/p,ne=C*Math.cos(Ge*Math.PI/2),he=f*Math.sin(Ge*Math.PI/2)+v;for(let ae=0,He=E.length;ae<He;ae++){const ve=Q(E[ae],L[ae],he);ie(ve.x,ve.y,u+ne)}for(let ae=0,He=M.length;ae<He;ae++){const ve=M[ae];K=z[ae];for(let Me=0,q=ve.length;Me<q;Me++){const Y=Q(ve[Me],K[Me],he);G?ie(Y.x,Y.y+b[g-1].y,b[g-1].x+ne):ie(Y.x,Y.y,u+ne)}}}P(),$();function P(){const T=r.length/3;if(d){let Ge=0,ne=k*Ge;for(let he=0;he<J;he++){const ae=X[he];de(ae[2]+ne,ae[1]+ne,ae[0]+ne)}Ge=g+p*2,ne=k*Ge;for(let he=0;he<J;he++){const ae=X[he];de(ae[0]+ne,ae[1]+ne,ae[2]+ne)}}else{for(let Ge=0;Ge<J;Ge++){const ne=X[Ge];de(ne[2],ne[1],ne[0])}for(let Ge=0;Ge<J;Ge++){const ne=X[Ge];de(ne[0]+k*g,ne[1]+k*g,ne[2]+k*g)}}i.addGroup(T,r.length/3-T,0)}function $(){const T=r.length/3;let Ge=0;oe(E,Ge),Ge+=E.length;for(let ne=0,he=M.length;ne<he;ne++){const ae=M[ne];oe(ae,Ge),Ge+=ae.length}i.addGroup(T,r.length/3-T,1)}function oe(T,Ge){let ne=T.length;for(;--ne>=0;){const he=ne;let ae=ne-1;ae<0&&(ae=T.length-1);for(let He=0,ve=g+p*2;He<ve;He++){const Me=k*He,q=k*(He+1),Y=Ge+he+Me,Ce=Ge+ae+Me,se=Ge+ae+q,fe=Ge+he+q;Ve(Y,Ce,se,fe)}}}function ie(T,Ge,ne){l.push(T),l.push(Ge),l.push(ne)}function de(T,Ge,ne){Se(T),Se(Ge),Se(ne);const he=r.length/3,ae=A.generateTopUV(i,r,he-3,he-2,he-1);me(ae[0]),me(ae[1]),me(ae[2])}function Ve(T,Ge,ne,he){Se(T),Se(Ge),Se(he),Se(Ge),Se(ne),Se(he);const ae=r.length/3,He=A.generateSideWallUV(i,r,ae-6,ae-3,ae-2,ae-1);me(He[0]),me(He[1]),me(He[3]),me(He[1]),me(He[2]),me(He[3])}function Se(T){r.push(l[T*3+0]),r.push(l[T*3+1]),r.push(l[T*3+2])}function me(T){o.push(T.x),o.push(T.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,i=this.parameters.options;return ele(n,i,e)}static fromJSON(e,n){const i=[];for(let o=0,a=e.shapes.length;o<a;o++){const s=n[e.shapes[o]];i.push(s)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new H0[r.type]().fromJSON(r)),new qv(i,e.options)}}const qse={generateTopUV:function(t,e,n,i,r){const o=e[n*3],a=e[n*3+1],s=e[i*3],l=e[i*3+1],c=e[r*3],g=e[r*3+1];return[new gt(o,a),new gt(s,l),new gt(c,g)]},generateSideWallUV:function(t,e,n,i,r,o){const a=e[n*3],s=e[n*3+1],l=e[n*3+2],c=e[i*3],g=e[i*3+1],u=e[i*3+2],d=e[r*3],C=e[r*3+1],f=e[r*3+2],v=e[o*3],p=e[o*3+1],m=e[o*3+2];return Math.abs(s-g)<Math.abs(a-c)?[new gt(a,1-l),new gt(c,1-u),new gt(d,1-f),new gt(v,1-m)]:[new gt(s,1-l),new gt(g,1-u),new gt(C,1-f),new gt(p,1-m)]}};function ele(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){const o=t[i];n.shapes.push(o.uuid)}else n.shapes.push(t.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class hf extends mc{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],o=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,o,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new hf(e.radius,e.detail)}}class ff extends mc{constructor(e=1,n=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new ff(e.radius,e.detail)}}class eb extends Sn{constructor(e=.5,n=1,i=32,r=1,o=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:i,phiSegments:r,thetaStart:o,thetaLength:a},i=Math.max(3,i),r=Math.max(1,r);const s=[],l=[],c=[],g=[];let u=e;const d=(n-e)/r,C=new ge,f=new gt;for(let v=0;v<=r;v++){for(let p=0;p<=i;p++){const m=o+p/i*a;C.x=u*Math.cos(m),C.y=u*Math.sin(m),l.push(C.x,C.y,C.z),c.push(0,0,1),f.x=(C.x/n+1)/2,f.y=(C.y/n+1)/2,g.push(f.x,f.y)}u+=d}for(let v=0;v<r;v++){const p=v*(i+1);for(let m=0;m<i;m++){const A=m+p,b=A,G=A+i+1,w=A+i+2,S=A+1;s.push(b,G,S),s.push(G,w,S)}}this.setIndex(s),this.setAttribute("position",new tn(l,3)),this.setAttribute("normal",new tn(c,3)),this.setAttribute("uv",new tn(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new eb(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class tb extends Sn{constructor(e=new yg([new gt(0,.5),new gt(-.5,-.5),new gt(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const i=[],r=[],o=[],a=[];let s=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let g=0;g<e.length;g++)c(e[g]),this.addGroup(s,l,g),s+=l,l=0;this.setIndex(i),this.setAttribute("position",new tn(r,3)),this.setAttribute("normal",new tn(o,3)),this.setAttribute("uv",new tn(a,2));function c(g){const u=r.length/3,d=g.extractPoints(n);let C=d.shape;const f=d.holes;Bs.isClockWise(C)===!1&&(C=C.reverse());for(let p=0,m=f.length;p<m;p++){const A=f[p];Bs.isClockWise(A)===!0&&(f[p]=A.reverse())}const v=Bs.triangulateShape(C,f);for(let p=0,m=f.length;p<m;p++){const A=f[p];C=C.concat(A)}for(let p=0,m=C.length;p<m;p++){const A=C[p];r.push(A.x,A.y,0),o.push(0,0,1),a.push(A.x,A.y)}for(let p=0,m=v.length;p<m;p++){const A=v[p],b=A[0]+u,G=A[1]+u,w=A[2]+u;i.push(b,G,w),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes;return tle(n,e)}static fromJSON(e,n){const i=[];for(let r=0,o=e.shapes.length;r<o;r++){const a=n[e.shapes[r]];i.push(a)}return new tb(i,e.curveSegments)}}function tle(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}class mf extends Sn{constructor(e=1,n=32,i=16,r=0,o=Math.PI*2,a=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:r,phiLength:o,thetaStart:a,thetaLength:s},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const l=Math.min(a+s,Math.PI);let c=0;const g=[],u=new ge,d=new ge,C=[],f=[],v=[],p=[];for(let m=0;m<=i;m++){const A=[],b=m/i;let G=0;m===0&&a===0?G=.5/n:m===i&&l===Math.PI&&(G=-.5/n);for(let w=0;w<=n;w++){const S=w/n;u.x=-e*Math.cos(r+S*o)*Math.sin(a+b*s),u.y=e*Math.cos(a+b*s),u.z=e*Math.sin(r+S*o)*Math.sin(a+b*s),f.push(u.x,u.y,u.z),d.copy(u).normalize(),v.push(d.x,d.y,d.z),p.push(S+G,1-b),A.push(c++)}g.push(A)}for(let m=0;m<i;m++)for(let A=0;A<n;A++){const b=g[m][A+1],G=g[m][A],w=g[m+1][A],S=g[m+1][A+1];(m!==0||a>0)&&C.push(b,G,S),(m!==i-1||l<Math.PI)&&C.push(G,w,S)}this.setIndex(C),this.setAttribute("position",new tn(f,3)),this.setAttribute("normal",new tn(v,3)),this.setAttribute("uv",new tn(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new mf(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class nb extends mc{constructor(e=1,n=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new nb(e.radius,e.detail)}}class ib extends Sn{constructor(e=1,n=.4,i=12,r=48,o=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:i,tubularSegments:r,arc:o},i=Math.floor(i),r=Math.floor(r);const a=[],s=[],l=[],c=[],g=new ge,u=new ge,d=new ge;for(let C=0;C<=i;C++)for(let f=0;f<=r;f++){const v=f/r*o,p=C/i*Math.PI*2;u.x=(e+n*Math.cos(p))*Math.cos(v),u.y=(e+n*Math.cos(p))*Math.sin(v),u.z=n*Math.sin(p),s.push(u.x,u.y,u.z),g.x=e*Math.cos(v),g.y=e*Math.sin(v),d.subVectors(u,g).normalize(),l.push(d.x,d.y,d.z),c.push(f/r),c.push(C/i)}for(let C=1;C<=i;C++)for(let f=1;f<=r;f++){const v=(r+1)*C+f-1,p=(r+1)*(C-1)+f-1,m=(r+1)*(C-1)+f,A=(r+1)*C+f;a.push(v,p,A),a.push(p,m,A)}this.setIndex(a),this.setAttribute("position",new tn(s,3)),this.setAttribute("normal",new tn(l,3)),this.setAttribute("uv",new tn(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ib(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class rb extends Sn{constructor(e=1,n=.4,i=64,r=8,o=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:i,radialSegments:r,p:o,q:a},i=Math.floor(i),r=Math.floor(r);const s=[],l=[],c=[],g=[],u=new ge,d=new ge,C=new ge,f=new ge,v=new ge,p=new ge,m=new ge;for(let b=0;b<=i;++b){const G=b/i*o*Math.PI*2;A(G,o,a,e,C),A(G+.01,o,a,e,f),p.subVectors(f,C),m.addVectors(f,C),v.crossVectors(p,m),m.crossVectors(v,p),v.normalize(),m.normalize();for(let w=0;w<=r;++w){const S=w/r*Math.PI*2,Z=-n*Math.cos(S),x=n*Math.sin(S);u.x=C.x+(Z*m.x+x*v.x),u.y=C.y+(Z*m.y+x*v.y),u.z=C.z+(Z*m.z+x*v.z),l.push(u.x,u.y,u.z),d.subVectors(u,C).normalize(),c.push(d.x,d.y,d.z),g.push(b/i),g.push(w/r)}}for(let b=1;b<=i;b++)for(let G=1;G<=r;G++){const w=(r+1)*(b-1)+(G-1),S=(r+1)*b+(G-1),Z=(r+1)*b+G,x=(r+1)*(b-1)+G;s.push(w,S,x),s.push(S,Z,x)}this.setIndex(s),this.setAttribute("position",new tn(l,3)),this.setAttribute("normal",new tn(c,3)),this.setAttribute("uv",new tn(g,2));function A(b,G,w,S,Z){const x=Math.cos(b),R=Math.sin(b),W=w/G*b,M=Math.cos(W);Z.x=S*(2+M)*.5*x,Z.y=S*(2+M)*R*.5,Z.z=S*Math.sin(W)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new rb(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class ob extends Sn{constructor(e=new C1(new ge(-1,-1,0),new ge(-1,1,0),new ge(1,1,0)),n=64,i=1,r=8,o=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:r,closed:o};const a=e.computeFrenetFrames(n,o);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const s=new ge,l=new ge,c=new gt;let g=new ge;const u=[],d=[],C=[],f=[];v(),this.setIndex(f),this.setAttribute("position",new tn(u,3)),this.setAttribute("normal",new tn(d,3)),this.setAttribute("uv",new tn(C,2));function v(){for(let b=0;b<n;b++)p(b);p(o===!1?n:0),A(),m()}function p(b){g=e.getPointAt(b/n,g);const G=a.normals[b],w=a.binormals[b];for(let S=0;S<=r;S++){const Z=S/r*Math.PI*2,x=Math.sin(Z),R=-Math.cos(Z);l.x=R*G.x+x*w.x,l.y=R*G.y+x*w.y,l.z=R*G.z+x*w.z,l.normalize(),d.push(l.x,l.y,l.z),s.x=g.x+i*l.x,s.y=g.y+i*l.y,s.z=g.z+i*l.z,u.push(s.x,s.y,s.z)}}function m(){for(let b=1;b<=n;b++)for(let G=1;G<=r;G++){const w=(r+1)*(b-1)+(G-1),S=(r+1)*b+(G-1),Z=(r+1)*b+G,x=(r+1)*(b-1)+G;f.push(w,S,x),f.push(S,Z,x)}}function A(){for(let b=0;b<=n;b++)for(let G=0;G<=r;G++)c.x=b/n,c.y=G/r,C.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new ob(new H0[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class K9 extends Sn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],i=new Set,r=new ge,o=new ge;if(e.index!==null){const a=e.attributes.position,s=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:s.count,materialIndex:0}]);for(let c=0,g=l.length;c<g;++c){const u=l[c],d=u.start,C=u.count;for(let f=d,v=d+C;f<v;f+=3)for(let p=0;p<3;p++){const m=s.getX(f+p),A=s.getX(f+(p+1)%3);r.fromBufferAttribute(a,m),o.fromBufferAttribute(a,A),gF(r,o,i)===!0&&(n.push(r.x,r.y,r.z),n.push(o.x,o.y,o.z))}}}else{const a=e.attributes.position;for(let s=0,l=a.count/3;s<l;s++)for(let c=0;c<3;c++){const g=3*s+c,u=3*s+(c+1)%3;r.fromBufferAttribute(a,g),o.fromBufferAttribute(a,u),gF(r,o,i)===!0&&(n.push(r.x,r.y,r.z),n.push(o.x,o.y,o.z))}}this.setAttribute("position",new tn(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function gF(t,e,n){const i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return n.has(i)===!0||n.has(r)===!0?!1:(n.add(i),n.add(r),!0)}var uF=Object.freeze({__proto__:null,BoxGeometry:Pg,CapsuleGeometry:Ov,CircleGeometry:Jv,ConeGeometry:Qv,CylinderGeometry:nI,DodecahedronGeometry:jv,EdgesGeometry:X9,ExtrudeGeometry:qv,IcosahedronGeometry:hf,LatheGeometry:Cf,OctahedronGeometry:ff,PlaneGeometry:qa,PolyhedronGeometry:mc,RingGeometry:eb,ShapeGeometry:tb,SphereGeometry:mf,TetrahedronGeometry:nb,TorusGeometry:ib,TorusKnotGeometry:rb,TubeGeometry:ob,WireframeGeometry:K9});class L9 extends Er{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new kt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class T9 extends bo{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class f1 extends Er{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new kt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fc,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ei,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class _9 extends f1{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new gt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return yi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new kt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new kt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new kt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class k9 extends Er{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new kt(16777215),this.specular=new kt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fc,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ei,this.combine=of,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class P9 extends Er{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new kt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fc,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class U9 extends Er{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fc,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class D9 extends Er{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new kt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fc,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ei,this.combine=of,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class O9 extends Er{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new kt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fc,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class J9 extends io{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Ig(t,e,n){return!t||!n&&t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function Q9(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function j9(t){function e(r,o){return t[r]-t[o]}const n=t.length,i=new Array(n);for(let r=0;r!==n;++r)i[r]=r;return i.sort(e),i}function FS(t,e,n){const i=t.length,r=new t.constructor(i);for(let o=0,a=0;a!==i;++o){const s=n[o]*e;for(let l=0;l!==e;++l)r[a++]=t[s+l]}return r}function m1(t,e,n,i){let r=1,o=t[0];for(;o!==void 0&&o[i]===void 0;)o=t[r++];if(o===void 0)return;let a=o[i];if(a!==void 0)if(Array.isArray(a))do a=o[i],a!==void 0&&(e.push(o.time),n.push.apply(n,a)),o=t[r++];while(o!==void 0);else if(a.toArray!==void 0)do a=o[i],a!==void 0&&(e.push(o.time),a.toArray(n,n.length)),o=t[r++];while(o!==void 0);else do a=o[i],a!==void 0&&(e.push(o.time),n.push(a)),o=t[r++];while(o!==void 0)}function nle(t,e,n,i,r=30){const o=t.clone();o.name=e;const a=[];for(let l=0;l<o.tracks.length;++l){const c=o.tracks[l],g=c.getValueSize(),u=[],d=[];for(let C=0;C<c.times.length;++C){const f=c.times[C]*r;if(!(f<n||f>=i)){u.push(c.times[C]);for(let v=0;v<g;++v)d.push(c.values[C*g+v])}}u.length!==0&&(c.times=Ig(u,c.times.constructor),c.values=Ig(d,c.values.constructor),a.push(c))}o.tracks=a;let s=1/0;for(let l=0;l<o.tracks.length;++l)s>o.tracks[l].times[0]&&(s=o.tracks[l].times[0]);for(let l=0;l<o.tracks.length;++l)o.tracks[l].shift(-1*s);return o.resetDuration(),o}function ile(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,o=e/i;for(let a=0;a<r;++a){const s=n.tracks[a],l=s.ValueTypeName;if(l==="bool"||l==="string")continue;const c=t.tracks.find(function(m){return m.name===s.name&&m.ValueTypeName===l});if(c===void 0)continue;let g=0;const u=s.getValueSize();s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(g=u/3);let d=0;const C=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=C/3);const f=s.times.length-1;let v;if(o<=s.times[0]){const m=g,A=u-g;v=s.values.slice(m,A)}else if(o>=s.times[f]){const m=f*u+g,A=m+u-g;v=s.values.slice(m,A)}else{const m=s.createInterpolant(),A=g,b=u-g;m.evaluate(o),v=m.resultBuffer.slice(A,b)}l==="quaternion"&&new sr().fromArray(v).normalize().conjugate().toArray(v);const p=c.times.length;for(let m=0;m<p;++m){const A=m*C+d;if(l==="quaternion")sr.multiplyQuaternionsFlat(c.values,A,v,0,c.values,A);else{const b=C-d*2;for(let G=0;G<b;++G)c.values[A+G]-=v[G]}}}return t.blendMode=JZ,t}const rle={convertArray:Ig,isTypedArray:Q9,getKeyframeOrder:j9,sortedArray:FS,flattenJSON:m1,subclip:nle,makeClipAdditive:ile};class Af{constructor(e,n,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let i=this._cachedIndex,r=n[i],o=n[i-1];e:{t:{let a;n:{i:if(!(e<r)){for(let s=i+2;;){if(r===void 0){if(e<o)break i;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===s)break;if(o=r,r=n[++i],e<r)break t}a=n.length;break n}if(!(e>=o)){const s=n[1];e<s&&(i=2,o=s);for(let l=i-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=o,o=n[--i-1],e>=o)break t}a=i,i=0;break n}break e}for(;i<a;){const s=i+a>>>1;e<n[s]?a=s:i=s+1}if(r=n[i],o=n[i-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,o,r)}return this.interpolate_(i,o,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,r=this.valueSize,o=e*r;for(let a=0;a!==r;++a)n[a]=i[o+a];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class $9 extends Af{constructor(e,n,i,r){super(e,n,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:cg,endingEnd:cg}}intervalChanged_(e,n,i){const r=this.parameterPositions;let o=e-2,a=e+1,s=r[o],l=r[a];if(s===void 0)switch(this.getSettings_().endingStart){case gg:o=e,s=2*n-i;break;case Gh:o=r.length-2,s=n+r[o]-r[o+1];break;default:o=e,s=i}if(l===void 0)switch(this.getSettings_().endingEnd){case gg:a=e,l=2*i-n;break;case Gh:a=1,l=i+r[1]-r[0];break;default:a=e-1,l=n}const c=(i-n)*.5,g=this.valueSize;this._weightPrev=c/(n-s),this._weightNext=c/(l-i),this._offsetPrev=o*g,this._offsetNext=a*g}interpolate_(e,n,i,r){const o=this.resultBuffer,a=this.sampleValues,s=this.valueSize,l=e*s,c=l-s,g=this._offsetPrev,u=this._offsetNext,d=this._weightPrev,C=this._weightNext,f=(i-n)/(r-n),v=f*f,p=v*f,m=-d*p+2*d*v-d*f,A=(1+d)*p+(-1.5-2*d)*v+(-.5+d)*f+1,b=(-1-C)*p+(1.5+C)*v+.5*f,G=C*p-C*v;for(let w=0;w!==s;++w)o[w]=m*a[g+w]+A*a[c+w]+b*a[l+w]+G*a[u+w];return o}}class A1 extends Af{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const o=this.resultBuffer,a=this.sampleValues,s=this.valueSize,l=e*s,c=l-s,g=(i-n)/(r-n),u=1-g;for(let d=0;d!==s;++d)o[d]=a[c+d]*u+a[l+d]*g;return o}}class q9 extends Af{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class ts{constructor(e,n,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ig(n,this.TimeBufferType),this.values=Ig(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:Ig(e.times,Array),values:Ig(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new q9(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new A1(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new $9(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case yh:n=this.InterpolantFactoryMethodDiscrete;break;case M0:n=this.InterpolantFactoryMethodLinear;break;case dp:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return yh;case this.InterpolantFactoryMethodLinear:return M0;case this.InterpolantFactoryMethodSmooth:return dp}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]*=e}return this}trim(e,n){const i=this.times,r=i.length;let o=0,a=r-1;for(;o!==r&&i[o]<e;)++o;for(;a!==-1&&i[a]>n;)--a;if(++a,o!==0||a!==r){o>=a&&(a=Math.max(a,1),o=a-1);const s=this.getValueSize();this.times=i.slice(o,a),this.values=this.values.slice(o*s,a*s)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,o=i.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let s=0;s!==o;s++){const l=i[s];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,l),e=!1;break}if(a!==null&&a>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,l,a),e=!1;break}a=l}if(r!==void 0&&Q9(r))for(let s=0,l=r.length;s!==l;++s){const c=r[s];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),n=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===dp,o=e.length-1;let a=1;for(let s=1;s<o;++s){let l=!1;const c=e[s],g=e[s+1];if(c!==g&&(s!==1||c!==e[0]))if(r)l=!0;else{const u=s*i,d=u-i,C=u+i;for(let f=0;f!==i;++f){const v=n[u+f];if(v!==n[d+f]||v!==n[C+f]){l=!0;break}}}if(l){if(s!==a){e[a]=e[s];const u=s*i,d=a*i;for(let C=0;C!==i;++C)n[d+C]=n[u+C]}++a}}if(o>0){e[a]=e[o];for(let s=o*i,l=a*i,c=0;c!==i;++c)n[l+c]=n[s+c];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=n.slice(0,a*i)):(this.times=e,this.values=n),this}clone(){const e=this.times.slice(),n=this.values.slice(),i=this.constructor,r=new i(this.name,e,n);return r.createInterpolant=this.createInterpolant,r}}ts.prototype.TimeBufferType=Float32Array;ts.prototype.ValueBufferType=Float32Array;ts.prototype.DefaultInterpolation=M0;class Ug extends ts{constructor(e,n,i){super(e,n,i)}}Ug.prototype.ValueTypeName="bool";Ug.prototype.ValueBufferType=Array;Ug.prototype.DefaultInterpolation=yh;Ug.prototype.InterpolantFactoryMethodLinear=void 0;Ug.prototype.InterpolantFactoryMethodSmooth=void 0;class p1 extends ts{}p1.prototype.ValueTypeName="color";class Fh extends ts{}Fh.prototype.ValueTypeName="number";class eK extends Af{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const o=this.resultBuffer,a=this.sampleValues,s=this.valueSize,l=(i-n)/(r-n);let c=e*s;for(let g=c+s;c!==g;c+=4)sr.slerpFlat(o,0,a,c-s,a,c,l);return o}}class pf extends ts{InterpolantFactoryMethodLinear(e){return new eK(this.times,this.values,this.getValueSize(),e)}}pf.prototype.ValueTypeName="quaternion";pf.prototype.InterpolantFactoryMethodSmooth=void 0;class Dg extends ts{constructor(e,n,i){super(e,n,i)}}Dg.prototype.ValueTypeName="string";Dg.prototype.ValueBufferType=Array;Dg.prototype.DefaultInterpolation=yh;Dg.prototype.InterpolantFactoryMethodLinear=void 0;Dg.prototype.InterpolantFactoryMethodSmooth=void 0;class Hh extends ts{}Hh.prototype.ValueTypeName="vector";class Xh{constructor(e="",n=-1,i=[],r=Xv){this.name=e,this.tracks=i,this.duration=n,this.blendMode=r,this.uuid=ko(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],i=e.tracks,r=1/(e.fps||1);for(let a=0,s=i.length;a!==s;++a)n.push(ale(i[a]).scale(r));const o=new this(e.name,e.duration,n,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){const n=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,a=i.length;o!==a;++o)n.push(ts.toJSON(i[o]));return r}static CreateFromMorphTargetSequence(e,n,i,r){const o=n.length,a=[];for(let s=0;s<o;s++){let l=[],c=[];l.push((s+o-1)%o,s,(s+1)%o),c.push(0,1,0);const g=j9(l);l=FS(l,1,g),c=FS(c,1,g),!r&&l[0]===0&&(l.push(o),c.push(c[0])),a.push(new Fh(".morphTargetInfluences["+n[s].name+"]",l,c).scale(1/i))}return new this(e,-1,a)}static findByName(e,n){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===n)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,n,i){const r={},o=/^([\w-]*?)([\d]+)$/;for(let s=0,l=e.length;s<l;s++){const c=e[s],g=c.name.match(o);if(g&&g.length>1){const u=g[1];let d=r[u];d||(r[u]=d=[]),d.push(c)}}const a=[];for(const s in r)a.push(this.CreateFromMorphTargetSequence(s,r[s],n,i));return a}static parseAnimation(e,n){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(u,d,C,f,v){if(C.length!==0){const p=[],m=[];m1(C,p,m,f),p.length!==0&&v.push(new u(d,p,m))}},r=[],o=e.name||"default",a=e.fps||30,s=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let u=0;u<c.length;u++){const d=c[u].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const C={};let f;for(f=0;f<d.length;f++)if(d[f].morphTargets)for(let v=0;v<d[f].morphTargets.length;v++)C[d[f].morphTargets[v]]=-1;for(const v in C){const p=[],m=[];for(let A=0;A!==d[f].morphTargets.length;++A){const b=d[f];p.push(b.time),m.push(b.morphTarget===v?1:0)}r.push(new Fh(".morphTargetInfluence["+v+"]",p,m))}l=C.length*a}else{const C=".bones["+n[u].name+"]";i(Hh,C+".position",d,"pos",r),i(pf,C+".quaternion",d,"rot",r),i(Hh,C+".scale",d,"scl",r)}}return r.length===0?null:new this(o,l,r,s)}resetDuration(){const e=this.tracks;let n=0;for(let i=0,r=e.length;i!==r;++i){const o=this.tracks[i];n=Math.max(n,o.times[o.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function ole(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Fh;case"vector":case"vector2":case"vector3":case"vector4":return Hh;case"color":return p1;case"quaternion":return pf;case"bool":case"boolean":return Ug;case"string":return Dg}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function ale(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=ole(t.type);if(t.times===void 0){const n=[],i=[];m1(t.keys,n,i,"value"),t.times=n,t.values=i}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const $s={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class ab{constructor(e,n,i){const r=this;let o=!1,a=0,s=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this.itemStart=function(g){s++,o===!1&&r.onStart!==void 0&&r.onStart(g,a,s),o=!0},this.itemEnd=function(g){a++,r.onProgress!==void 0&&r.onProgress(g,a,s),a===s&&(o=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(g){r.onError!==void 0&&r.onError(g)},this.resolveURL=function(g){return l?l(g):g},this.setURLModifier=function(g){return l=g,this},this.addHandler=function(g,u){return c.push(g,u),this},this.removeHandler=function(g){const u=c.indexOf(g);return u!==-1&&c.splice(u,2),this},this.getHandler=function(g){for(let u=0,d=c.length;u<d;u+=2){const C=c[u],f=c[u+1];if(C.global&&(C.lastIndex=0),C.test(g))return f}return null}}}const tK=new ab;class ro{constructor(e){this.manager=e!==void 0?e:tK,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(r,o){i.load(e,r,n,o)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}ro.DEFAULT_MATERIAL_NAME="__DEFAULT";const _s={};class sle extends Error{constructor(e,n){super(e),this.response=n}}class Po extends ro{constructor(e){super(e)}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=$s.get(e);if(o!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(o),this.manager.itemEnd(e)},0),o;if(_s[e]!==void 0){_s[e].push({onLoad:n,onProgress:i,onError:r});return}_s[e]=[],_s[e].push({onLoad:n,onProgress:i,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,l=this.responseType;fetch(a).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const g=_s[e],u=c.body.getReader(),d=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),C=d?parseInt(d):0,f=C!==0;let v=0;const p=new ReadableStream({start(m){A();function A(){u.read().then(({done:b,value:G})=>{if(b)m.close();else{v+=G.byteLength;const w=new ProgressEvent("progress",{lengthComputable:f,loaded:v,total:C});for(let S=0,Z=g.length;S<Z;S++){const x=g[S];x.onProgress&&x.onProgress(w)}m.enqueue(G),A()}},b=>{m.error(b)})}}});return new Response(p)}else throw new sle(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(g=>new DOMParser().parseFromString(g,s));case"json":return c.json();default:if(s===void 0)return c.text();{const u=/charset="?([^;"\s]*)"?/i.exec(s),d=u&&u[1]?u[1].toLowerCase():void 0,C=new TextDecoder(d);return c.arrayBuffer().then(f=>C.decode(f))}}}).then(c=>{$s.add(e,c);const g=_s[e];delete _s[e];for(let u=0,d=g.length;u<d;u++){const C=g[u];C.onLoad&&C.onLoad(c)}}).catch(c=>{const g=_s[e];if(g===void 0)throw this.manager.itemError(e),c;delete _s[e];for(let u=0,d=g.length;u<d;u++){const C=g[u];C.onError&&C.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class lle extends ro{constructor(e){super(e)}load(e,n,i,r){const o=this,a=new Po(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(s){try{n(o.parse(JSON.parse(s)))}catch(l){r?r(l):console.error(l),o.manager.itemError(e)}},i,r)}parse(e){const n=[];for(let i=0;i<e.length;i++){const r=Xh.parse(e[i]);n.push(r)}return n}}class cle extends ro{constructor(e){super(e)}load(e,n,i,r){const o=this,a=[],s=new Uv,l=new Po(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(o.withCredentials);let c=0;function g(u){l.load(e[u],function(d){const C=o.parse(d,!0);a[u]={width:C.width,height:C.height,format:C.format,mipmaps:C.mipmaps},c+=1,c===6&&(C.mipmapCount===1&&(s.minFilter=Kn),s.image=a,s.format=C.format,s.needsUpdate=!0,n&&n(s))},i,r)}if(Array.isArray(e))for(let u=0,d=e.length;u<d;++u)g(u);else l.load(e,function(u){const d=o.parse(u,!0);if(d.isCubemap){const C=d.mipmaps.length/d.mipmapCount;for(let f=0;f<C;f++){a[f]={mipmaps:[]};for(let v=0;v<d.mipmapCount;v++)a[f].mipmaps.push(d.mipmaps[f*d.mipmapCount+v]),a[f].format=d.format,a[f].width=d.width,a[f].height=d.height}s.image=a}else s.image.width=d.width,s.image.height=d.height,s.mipmaps=d.mipmaps;d.mipmapCount===1&&(s.minFilter=Kn),s.format=d.format,s.needsUpdate=!0,n&&n(s)},i,r);return s}}class Eh extends ro{constructor(e){super(e)}load(e,n,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,a=$s.get(e);if(a!==void 0)return o.manager.itemStart(e),setTimeout(function(){n&&n(a),o.manager.itemEnd(e)},0),a;const s=Rh("img");function l(){g(),$s.add(e,this),n&&n(this),o.manager.itemEnd(e)}function c(u){g(),r&&r(u),o.manager.itemError(e),o.manager.itemEnd(e)}function g(){s.removeEventListener("load",l,!1),s.removeEventListener("error",c,!1)}return s.addEventListener("load",l,!1),s.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(s.crossOrigin=this.crossOrigin),o.manager.itemStart(e),s.src=e,s}}class nK extends ro{constructor(e){super(e)}load(e,n,i,r){const o=new uf;o.colorSpace=Yo;const a=new Eh(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let s=0;function l(c){a.load(e[c],function(g){o.images[c]=g,s++,s===6&&(o.needsUpdate=!0,n&&n(o))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return o}}class v1 extends ro{constructor(e){super(e)}load(e,n,i,r){const o=this,a=new Oa,s=new Po(this.manager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(o.withCredentials),s.load(e,function(l){let c;try{c=o.parse(l)}catch(g){if(r!==void 0)r(g);else{console.error(g);return}}c.image!==void 0?a.image=c.image:c.data!==void 0&&(a.image.width=c.width,a.image.height=c.height,a.image.data=c.data),a.wrapS=c.wrapS!==void 0?c.wrapS:zi,a.wrapT=c.wrapT!==void 0?c.wrapT:zi,a.magFilter=c.magFilter!==void 0?c.magFilter:Kn,a.minFilter=c.minFilter!==void 0?c.minFilter:Kn,a.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0&&(a.colorSpace=c.colorSpace),c.flipY!==void 0&&(a.flipY=c.flipY),c.format!==void 0&&(a.format=c.format),c.type!==void 0&&(a.type=c.type),c.mipmaps!==void 0&&(a.mipmaps=c.mipmaps,a.minFilter=ms),c.mipmapCount===1&&(a.minFilter=Kn),c.generateMipmaps!==void 0&&(a.generateMipmaps=c.generateMipmaps),a.needsUpdate=!0,n&&n(a,c)},i,r),a}}class gle extends ro{constructor(e){super(e)}load(e,n,i,r){const o=new Tn,a=new Eh(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(s){o.image=s,o.needsUpdate=!0,n!==void 0&&n(o)},i,r),o}}class Ac extends Vn{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new kt(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(n.object.target=this.target.uuid),n}}class iK extends Ac{constructor(e,n,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Vn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new kt(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}}const OG=new ln,dF=new ge,IF=new ge;class b1{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new gt(512,512),this.map=null,this.mapPass=null,this.matrix=new ln,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new df,this._frameExtents=new gt(1,1),this._viewportCount=1,this._viewports=[new zn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,i=this.matrix;dF.setFromMatrixPosition(e.matrixWorld),n.position.copy(dF),IF.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(IF),n.updateMatrixWorld(),OG.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(OG),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(OG)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class ule extends b1{constructor(){super(new Ri(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,i=_d*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,o=e.distance||n.far;(i!==n.fov||r!==n.aspect||o!==n.far)&&(n.fov=i,n.aspect=r,n.far=o,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class rK extends Ac{constructor(e,n,i=0,r=Math.PI/3,o=0,a=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Vn.DEFAULT_UP),this.updateMatrix(),this.target=new Vn,this.distance=i,this.angle=r,this.penumbra=o,this.decay=a,this.map=null,this.shadow=new ule}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const CF=new ln,QI=new ge,JG=new ge;class dle extends b1{constructor(){super(new Ri(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new gt(4,2),this._viewportCount=6,this._viewports=[new zn(2,1,1,1),new zn(0,1,1,1),new zn(3,1,1,1),new zn(1,1,1,1),new zn(3,0,1,1),new zn(1,0,1,1)],this._cubeDirections=[new ge(1,0,0),new ge(-1,0,0),new ge(0,0,1),new ge(0,0,-1),new ge(0,1,0),new ge(0,-1,0)],this._cubeUps=[new ge(0,1,0),new ge(0,1,0),new ge(0,1,0),new ge(0,1,0),new ge(0,0,1),new ge(0,0,-1)]}updateMatrices(e,n=0){const i=this.camera,r=this.matrix,o=e.distance||i.far;o!==i.far&&(i.far=o,i.updateProjectionMatrix()),QI.setFromMatrixPosition(e.matrixWorld),i.position.copy(QI),JG.copy(i.position),JG.add(this._cubeDirections[n]),i.up.copy(this._cubeUps[n]),i.lookAt(JG),i.updateMatrixWorld(),r.makeTranslation(-QI.x,-QI.y,-QI.z),CF.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(CF)}}class oK extends Ac{constructor(e,n,i=0,r=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new dle}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Ile extends b1{constructor(){super(new il(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class aK extends Ac{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Vn.DEFAULT_UP),this.updateMatrix(),this.target=new Vn,this.shadow=new Ile}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class sK extends Ac{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class lK extends Ac{constructor(e,n,i=10,r=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class cK{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ge)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const i=e.x,r=e.y,o=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.282095),n.addScaledVector(a[1],.488603*r),n.addScaledVector(a[2],.488603*o),n.addScaledVector(a[3],.488603*i),n.addScaledVector(a[4],1.092548*(i*r)),n.addScaledVector(a[5],1.092548*(r*o)),n.addScaledVector(a[6],.315392*(3*o*o-1)),n.addScaledVector(a[7],1.092548*(i*o)),n.addScaledVector(a[8],.546274*(i*i-r*r)),n}getIrradianceAt(e,n){const i=e.x,r=e.y,o=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.886227),n.addScaledVector(a[1],2*.511664*r),n.addScaledVector(a[2],2*.511664*o),n.addScaledVector(a[3],2*.511664*i),n.addScaledVector(a[4],2*.429043*i*r),n.addScaledVector(a[5],2*.429043*r*o),n.addScaledVector(a[6],.743125*o*o-.247708),n.addScaledVector(a[7],2*.429043*i*o),n.addScaledVector(a[8],.429043*(i*i-r*r)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,n+r*3);return this}toArray(e=[],n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,n+r*3);return e}static getBasisAt(e,n){const i=e.x,r=e.y,o=e.z;n[0]=.282095,n[1]=.488603*r,n[2]=.488603*o,n[3]=.488603*i,n[4]=1.092548*i*r,n[5]=1.092548*r*o,n[6]=.315392*(3*o*o-1),n[7]=1.092548*i*o,n[8]=.546274*(i*i-r*r)}}class gK extends Ac{constructor(e=new cK,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class sb extends ro{constructor(e){super(e),this.textures={}}load(e,n,i,r){const o=this,a=new Po(o.manager);a.setPath(o.path),a.setRequestHeader(o.requestHeader),a.setWithCredentials(o.withCredentials),a.load(e,function(s){try{n(o.parse(JSON.parse(s)))}catch(l){r?r(l):console.error(l),o.manager.itemError(e)}},i,r)}parse(e){const n=this.textures;function i(o){return n[o]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",o),n[o]}const r=sb.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new kt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const o in e.uniforms){const a=e.uniforms[o];switch(r.uniforms[o]={},a.type){case"t":r.uniforms[o].value=i(a.value);break;case"c":r.uniforms[o].value=new kt().setHex(a.value);break;case"v2":r.uniforms[o].value=new gt().fromArray(a.value);break;case"v3":r.uniforms[o].value=new ge().fromArray(a.value);break;case"v4":r.uniforms[o].value=new zn().fromArray(a.value);break;case"m3":r.uniforms[o].value=new mn().fromArray(a.value);break;case"m4":r.uniforms[o].value=new ln().fromArray(a.value);break;default:r.uniforms[o].value=a.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const o in e.extensions)r.extensions[o]=e.extensions[o];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let o=e.normalScale;Array.isArray(o)===!1&&(o=[o,o]),r.normalScale=new gt().fromArray(o)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new gt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const n={ShadowMaterial:L9,SpriteMaterial:s1,RawShaderMaterial:T9,ShaderMaterial:bo,PointsMaterial:c1,MeshPhysicalMaterial:_9,MeshStandardMaterial:f1,MeshPhongMaterial:k9,MeshToonMaterial:P9,MeshNormalMaterial:U9,MeshLambertMaterial:D9,MeshDepthMaterial:Kv,MeshDistanceMaterial:Lv,MeshBasicMaterial:Rs,MeshMatcapMaterial:O9,LineDashedMaterial:J9,LineBasicMaterial:io,Material:Er};return new n[e]}}class HS{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let n="";for(let i=0,r=e.length;i<r;i++)n+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(n))}catch{return n}}static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}class y1 extends Sn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class uK extends ro{constructor(e){super(e)}load(e,n,i,r){const o=this,a=new Po(o.manager);a.setPath(o.path),a.setRequestHeader(o.requestHeader),a.setWithCredentials(o.withCredentials),a.load(e,function(s){try{n(o.parse(JSON.parse(s)))}catch(l){r?r(l):console.error(l),o.manager.itemError(e)}},i,r)}parse(e){const n={},i={};function r(C,f){if(n[f]!==void 0)return n[f];const p=C.interleavedBuffers[f],m=o(C,p.buffer),A=od(p.type,m),b=new kv(A,p.stride);return b.uuid=p.uuid,n[f]=b,b}function o(C,f){if(i[f]!==void 0)return i[f];const p=C.arrayBuffers[f],m=new Uint32Array(p).buffer;return i[f]=m,m}const a=e.isInstancedBufferGeometry?new y1:new Sn,s=e.data.index;if(s!==void 0){const C=od(s.type,s.array);a.setIndex(new Un(C,1))}const l=e.data.attributes;for(const C in l){const f=l[C];let v;if(f.isInterleavedBufferAttribute){const p=r(e.data,f.data);v=new Fg(p,f.itemSize,f.offset,f.normalized)}else{const p=od(f.type,f.array),m=f.isInstancedBufferAttribute?Hg:Un;v=new m(p,f.itemSize,f.normalized)}f.name!==void 0&&(v.name=f.name),f.usage!==void 0&&v.setUsage(f.usage),a.setAttribute(C,v)}const c=e.data.morphAttributes;if(c)for(const C in c){const f=c[C],v=[];for(let p=0,m=f.length;p<m;p++){const A=f[p];let b;if(A.isInterleavedBufferAttribute){const G=r(e.data,A.data);b=new Fg(G,A.itemSize,A.offset,A.normalized)}else{const G=od(A.type,A.array);b=new Un(G,A.itemSize,A.normalized)}A.name!==void 0&&(b.name=A.name),v.push(b)}a.morphAttributes[C]=v}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const u=e.data.groups||e.data.drawcalls||e.data.offsets;if(u!==void 0)for(let C=0,f=u.length;C!==f;++C){const v=u[C];a.addGroup(v.start,v.count,v.materialIndex)}const d=e.data.boundingSphere;if(d!==void 0){const C=new ge;d.center!==void 0&&C.fromArray(d.center),a.boundingSphere=new hr(C,d.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class Cle extends ro{constructor(e){super(e)}load(e,n,i,r){const o=this,a=this.path===""?HS.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const s=new Po(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(u){r!==void 0&&r(u),console.error("THREE:ObjectLoader: Can't parse "+e+".",u.message);return}const g=c.metadata;if(g===void 0||g.type===void 0||g.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}o.parse(c,n)},i,r)}async loadAsync(e,n){const i=this,r=this.path===""?HS.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const o=new Po(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials);const a=await o.loadAsync(e,n),s=JSON.parse(a),l=s.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(s)}parse(e,n){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),o=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,function(){n!==void 0&&n(c)}),s=this.parseTextures(e.textures,a),l=this.parseMaterials(e.materials,s),c=this.parseObject(e.object,o,l,s,i),g=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,g),this.bindLightTargets(c),n!==void 0){let u=!1;for(const d in a)if(a[d].data instanceof HTMLImageElement){u=!0;break}u===!1&&n(c)}return c}async parseAsync(e){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),o=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,o),s=this.parseMaterials(e.materials,a),l=this.parseObject(e.object,r,s,a,n),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),this.bindLightTargets(l),l}parseShapes(e){const n={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const o=new yg().fromJSON(e[i]);n[o.uuid]=o}return n}parseSkeletons(e,n){const i={},r={};if(n.traverse(function(o){o.isBone&&(r[o.uuid]=o)}),e!==void 0)for(let o=0,a=e.length;o<a;o++){const s=new Pv().fromJSON(e[o],r);i[s.uuid]=s}return i}parseGeometries(e,n){const i={};if(e!==void 0){const r=new uK;for(let o=0,a=e.length;o<a;o++){let s;const l=e[o];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":s=r.parse(l);break;default:l.type in uF?s=uF[l.type].fromJSON(l,n):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}s.uuid=l.uuid,l.name!==void 0&&(s.name=l.name),l.userData!==void 0&&(s.userData=l.userData),i[l.uuid]=s}}return i}parseMaterials(e,n){const i={},r={};if(e!==void 0){const o=new sb;o.setTextures(n);for(let a=0,s=e.length;a<s;a++){const l=e[a];i[l.uuid]===void 0&&(i[l.uuid]=o.parse(l)),r[l.uuid]=i[l.uuid]}}return r}parseAnimations(e){const n={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],o=Xh.parse(r);n[o.uuid]=o}return n}parseImages(e,n){const i=this,r={};let o;function a(l){return i.manager.itemStart(l),o.load(l,function(){i.manager.itemEnd(l)},void 0,function(){i.manager.itemError(l),i.manager.itemEnd(l)})}function s(l){if(typeof l=="string"){const c=l,g=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:i.resourcePath+c;return a(g)}else return l.data?{data:od(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new ab(n);o=new Eh(l),o.setCrossOrigin(this.crossOrigin);for(let c=0,g=e.length;c<g;c++){const u=e[c],d=u.url;if(Array.isArray(d)){const C=[];for(let f=0,v=d.length;f<v;f++){const p=d[f],m=s(p);m!==null&&(m instanceof HTMLImageElement?C.push(m):C.push(new Oa(m.data,m.width,m.height)))}r[u.uuid]=new ug(C)}else{const C=s(u.url);r[u.uuid]=new ug(C)}}}return r}async parseImagesAsync(e){const n=this,i={};let r;async function o(a){if(typeof a=="string"){const s=a,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(s)?s:n.resourcePath+s;return await r.loadAsync(l)}else return a.data?{data:od(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){r=new Eh(this.manager),r.setCrossOrigin(this.crossOrigin);for(let a=0,s=e.length;a<s;a++){const l=e[a],c=l.url;if(Array.isArray(c)){const g=[];for(let u=0,d=c.length;u<d;u++){const C=c[u],f=await o(C);f!==null&&(f instanceof HTMLImageElement?g.push(f):g.push(new Oa(f.data,f.width,f.height)))}i[l.uuid]=new ug(g)}else{const g=await o(l.url);i[l.uuid]=new ug(g)}}}return i}parseTextures(e,n){function i(o,a){return typeof o=="number"?o:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",o),a[o])}const r={};if(e!==void 0)for(let o=0,a=e.length;o<a;o++){const s=e[o];s.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),n[s.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",s.image);const l=n[s.image],c=l.data;let g;Array.isArray(c)?(g=new uf,c.length===6&&(g.needsUpdate=!0)):(c&&c.data?g=new Oa:g=new Tn,c&&(g.needsUpdate=!0)),g.source=l,g.uuid=s.uuid,s.name!==void 0&&(g.name=s.name),s.mapping!==void 0&&(g.mapping=i(s.mapping,hle)),s.channel!==void 0&&(g.channel=s.channel),s.offset!==void 0&&g.offset.fromArray(s.offset),s.repeat!==void 0&&g.repeat.fromArray(s.repeat),s.center!==void 0&&g.center.fromArray(s.center),s.rotation!==void 0&&(g.rotation=s.rotation),s.wrap!==void 0&&(g.wrapS=i(s.wrap[0],hF),g.wrapT=i(s.wrap[1],hF)),s.format!==void 0&&(g.format=s.format),s.internalFormat!==void 0&&(g.internalFormat=s.internalFormat),s.type!==void 0&&(g.type=s.type),s.colorSpace!==void 0&&(g.colorSpace=s.colorSpace),s.minFilter!==void 0&&(g.minFilter=i(s.minFilter,fF)),s.magFilter!==void 0&&(g.magFilter=i(s.magFilter,fF)),s.anisotropy!==void 0&&(g.anisotropy=s.anisotropy),s.flipY!==void 0&&(g.flipY=s.flipY),s.generateMipmaps!==void 0&&(g.generateMipmaps=s.generateMipmaps),s.premultiplyAlpha!==void 0&&(g.premultiplyAlpha=s.premultiplyAlpha),s.unpackAlignment!==void 0&&(g.unpackAlignment=s.unpackAlignment),s.compareFunction!==void 0&&(g.compareFunction=s.compareFunction),s.userData!==void 0&&(g.userData=s.userData),r[s.uuid]=g}return r}parseObject(e,n,i,r,o){let a;function s(d){return n[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",d),n[d]}function l(d){if(d!==void 0){if(Array.isArray(d)){const C=[];for(let f=0,v=d.length;f<v;f++){const p=d[f];i[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",p),C.push(i[p])}return C}return i[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",d),i[d]}}function c(d){return r[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",d),r[d]}let g,u;switch(e.type){case"Scene":a=new If,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new kt(e.background):a.background=c(e.background)),e.environment!==void 0&&(a.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new _v(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new Tv(e.fog.color,e.fog.density)),e.fog.name!==""&&(a.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&a.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(a.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new Ri(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new il(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new sK(e.color,e.intensity);break;case"DirectionalLight":a=new aK(e.color,e.intensity),a.target=e.target||"";break;case"PointLight":a=new oK(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new lK(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new rK(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),a.target=e.target||"";break;case"HemisphereLight":a=new iK(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new gK().fromJSON(e);break;case"SkinnedMesh":g=s(e.geometry),u=l(e.material),a=new Z9(g,u),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":g=s(e.geometry),u=l(e.material),a=new ti(g,u);break;case"InstancedMesh":g=s(e.geometry),u=l(e.material);const d=e.count,C=e.instanceMatrix,f=e.instanceColor;a=new vd(g,u,d),a.instanceMatrix=new Hg(new Float32Array(C.array),16),f!==void 0&&(a.instanceColor=new Hg(new Float32Array(f.array),f.itemSize));break;case"BatchedMesh":g=s(e.geometry),u=l(e.material),a=new x9(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,u),a.geometry=g,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._visibility=e.visibility,a._active=e.active,a._bounds=e.bounds.map(v=>{const p=new Cr;p.min.fromArray(v.boxMin),p.max.fromArray(v.boxMax);const m=new hr;return m.radius=v.sphereRadius,m.center.fromArray(v.sphereCenter),{boxInitialized:v.boxInitialized,box:p,sphereInitialized:v.sphereInitialized,sphere:m}}),a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._geometryCount=e.geometryCount,a._matricesTexture=c(e.matricesTexture.uuid),e.colorsTexture!==void 0&&(a._colorsTexture=c(e.colorsTexture.uuid));break;case"LOD":a=new w9;break;case"Line":a=new uc(s(e.geometry),l(e.material));break;case"LineLoop":a=new R9(s(e.geometry),l(e.material));break;case"LineSegments":a=new Ws(s(e.geometry),l(e.material));break;case"PointCloud":case"Points":a=new W9(s(e.geometry),l(e.material));break;case"Sprite":a=new S9(l(e.material));break;case"Group":a=new sd;break;case"Bone":a=new l1;break;default:a=new Vn}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.up!==void 0&&a.up.fromArray(e.up),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(a.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const d=e.children;for(let C=0;C<d.length;C++)a.add(this.parseObject(d[C],n,i,r,o))}if(e.animations!==void 0){const d=e.animations;for(let C=0;C<d.length;C++){const f=d[C];a.animations.push(o[f])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const d=e.levels;for(let C=0;C<d.length;C++){const f=d[C],v=a.getObjectByProperty("uuid",f.object);v!==void 0&&a.addLevel(v,f.distance,f.hysteresis)}}return a}bindSkeletons(e,n){Object.keys(n).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=n[i.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}bindLightTargets(e){e.traverse(function(n){if(n.isDirectionalLight||n.isSpotLight){const i=n.target,r=e.getObjectByProperty("uuid",i);r!==void 0?n.target=r:n.target=new Vn}})}}const hle={UVMapping:cc,CubeReflectionMapping:Ss,CubeRefractionMapping:gc,EquirectangularReflectionMapping:Ld,EquirectangularRefractionMapping:ph,CubeUVReflectionMapping:eI},hF={RepeatWrapping:vh,ClampToEdgeWrapping:zi,MirroredRepeatWrapping:bh},fF={NearestFilter:rr,NearestMipmapNearestFilter:LZ,NearestMipmapLinearFilter:rd,LinearFilter:Kn,LinearMipmapNearestFilter:WC,LinearMipmapLinearFilter:ms};class fle extends ro{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,a=$s.get(e);if(a!==void 0){if(o.manager.itemStart(e),a.then){a.then(c=>{n&&n(c),o.manager.itemEnd(e)}).catch(c=>{r&&r(c)});return}return setTimeout(function(){n&&n(a),o.manager.itemEnd(e)},0),a}const s={};s.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",s.headers=this.requestHeader;const l=fetch(e,s).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(c){return $s.add(e,c),n&&n(c),o.manager.itemEnd(e),c}).catch(function(c){r&&r(c),$s.remove(e),o.manager.itemError(e),o.manager.itemEnd(e)});$s.add(e,l),o.manager.itemStart(e)}}let GA;class G1{static getContext(){return GA===void 0&&(GA=new(window.AudioContext||window.webkitAudioContext)),GA}static setContext(e){GA=e}}class mle extends ro{constructor(e){super(e)}load(e,n,i,r){const o=this,a=new Po(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{const c=l.slice(0);G1.getContext().decodeAudioData(c,function(u){n(u)}).catch(s)}catch(c){s(c)}},i,r);function s(l){r?r(l):console.error(l),o.manager.itemError(e)}}}const mF=new ln,AF=new ln,Kc=new ln;class Ale{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ri,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ri,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,Kc.copy(e.projectionMatrix);const r=n.eyeSep/2,o=r*n.near/n.focus,a=n.near*Math.tan(vg*n.fov*.5)/n.zoom;let s,l;AF.elements[12]=-r,mF.elements[12]=r,s=-a*n.aspect+o,l=a*n.aspect+o,Kc.elements[0]=2*n.near/(l-s),Kc.elements[8]=(l+s)/(l-s),this.cameraL.projectionMatrix.copy(Kc),s=-a*n.aspect-o,l=a*n.aspect-o,Kc.elements[0]=2*n.near/(l-s),Kc.elements[8]=(l+s)/(l-s),this.cameraR.projectionMatrix.copy(Kc)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(AF),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(mF)}}class B1{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=pF(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=pF();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}function pF(){return(typeof performance>"u"?Date:performance).now()}const Lc=new ge,vF=new sr,ple=new ge,Tc=new ge;class vle extends Vn{constructor(){super(),this.type="AudioListener",this.context=G1.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new B1}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Lc,vF,ple),Tc.set(0,0,-1).applyQuaternion(vF),n.positionX){const r=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(Lc.x,r),n.positionY.linearRampToValueAtTime(Lc.y,r),n.positionZ.linearRampToValueAtTime(Lc.z,r),n.forwardX.linearRampToValueAtTime(Tc.x,r),n.forwardY.linearRampToValueAtTime(Tc.y,r),n.forwardZ.linearRampToValueAtTime(Tc.z,r),n.upX.linearRampToValueAtTime(i.x,r),n.upY.linearRampToValueAtTime(i.y,r),n.upZ.linearRampToValueAtTime(i.z,r)}else n.setPosition(Lc.x,Lc.y,Lc.z),n.setOrientation(Tc.x,Tc.y,Tc.z,i.x,i.y,i.z)}}class dK extends Vn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const _c=new ge,bF=new sr,ble=new ge,kc=new ge;class yle extends dK{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(_c,bF,ble),kc.set(0,0,1).applyQuaternion(bF);const n=this.panner;if(n.positionX){const i=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(_c.x,i),n.positionY.linearRampToValueAtTime(_c.y,i),n.positionZ.linearRampToValueAtTime(_c.z,i),n.orientationX.linearRampToValueAtTime(kc.x,i),n.orientationY.linearRampToValueAtTime(kc.y,i),n.orientationZ.linearRampToValueAtTime(kc.z,i)}else n.setPosition(_c.x,_c.y,_c.z),n.setOrientation(kc.x,kc.y,kc.z)}}class Gle{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const n=this.getFrequencyData();for(let i=0;i<n.length;i++)e+=n[i];return e/n.length}}class IK{constructor(e,n,i){this.binding=e,this.valueSize=i;let r,o,a;switch(n){case"quaternion":r=this._slerp,o=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,o=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,o=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=o,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const i=this.buffer,r=this.valueSize,o=e*r+r;let a=this.cumulativeWeight;if(a===0){for(let s=0;s!==r;++s)i[o+s]=i[s];a=n}else{a+=n;const s=n/a;this._mixBufferRegion(i,o,0,s,r)}this.cumulativeWeight=a}accumulateAdditive(e){const n=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,i=this.buffer,r=e*n+n,o=this.cumulativeWeight,a=this.cumulativeWeightAdditive,s=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){const l=n*this._origIndex;this._mixBufferRegion(i,r,l,1-o,n)}a>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*n,1,n);for(let l=n,c=n+n;l!==c;++l)if(i[l]!==i[l+n]){s.setValue(i,r);break}}saveOriginalState(){const e=this.binding,n=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(n,r);for(let o=i,a=r;o!==a;++o)n[o]=n[r+o%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let i=e;i<n;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[n+i]=this.buffer[e+i]}_select(e,n,i,r,o){if(r>=.5)for(let a=0;a!==o;++a)e[n+a]=e[i+a]}_slerp(e,n,i,r){sr.slerpFlat(e,n,e,n,e,i,r)}_slerpAdditive(e,n,i,r,o){const a=this._workIndex*o;sr.multiplyQuaternionsFlat(e,a,e,n,e,i),sr.slerpFlat(e,n,e,n,e,a,r)}_lerp(e,n,i,r,o){const a=1-r;for(let s=0;s!==o;++s){const l=n+s;e[l]=e[l]*a+e[i+s]*r}}_lerpAdditive(e,n,i,r,o){for(let a=0;a!==o;++a){const s=n+a;e[s]=e[s]+e[i+a]*r}}}const S1="\\[\\]\\.:\\/",Ble=new RegExp("["+S1+"]","g"),w1="[^"+S1+"]",Sle="[^"+S1.replace("\\.","")+"]",wle=/((?:WC+[\/:])*)/.source.replace("WC",w1),Zle=/(WCOD+)?/.source.replace("WCOD",Sle),xle=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",w1),Rle=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",w1),Wle=new RegExp("^"+wle+Zle+xle+Rle+"$"),Vle=["material","materials","bones","map"];class Mle{constructor(e,n,i){const r=i||Mn.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,r)}getValue(e,n){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,n)}setValue(e,n){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,o=i.length;r!==o;++r)i[r].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}}class Mn{constructor(e,n,i){this.path=n,this.parsedPath=i||Mn.parseTrackName(n),this.node=Mn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,i){return e&&e.isAnimationObjectGroup?new Mn.Composite(e,n,i):new Mn(e,n,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Ble,"")}static parseTrackName(e){const n=Wle.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const o=i.nodeName.substring(r+1);Vle.indexOf(o)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=o)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(n);if(i!==void 0)return i}if(e.children){const i=function(o){for(let a=0;a<o.length;a++){const s=o[a];if(s.name===n||s.uuid===n)return s;const l=i(s.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const i=this.resolvedProperty;for(let r=0,o=i.length;r!==o;++r)e[n++]=i[r]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const i=this.resolvedProperty;for(let r=0,o=i.length;r!==o;++r)i[r]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,o=i.length;r!==o;++r)i[r]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,o=i.length;r!==o;++r)i[r]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,i=n.objectName,r=n.propertyName;let o=n.propertyIndex;if(e||(e=Mn.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let c=n.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let g=0;g<e.length;g++)if(e[g].name===c){c=g;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const a=e[r];if(a===void 0){const c=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e);return}let s=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?s=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(s=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(o!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[o]!==void 0&&(o=e.morphTargetDictionary[o])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else a.fromArray!==void 0&&a.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Mn.Composite=Mle;Mn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Mn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Mn.prototype.GetterByBindingType=[Mn.prototype._getValue_direct,Mn.prototype._getValue_array,Mn.prototype._getValue_arrayElement,Mn.prototype._getValue_toArray];Mn.prototype.SetterByBindingTypeAndVersioning=[[Mn.prototype._setValue_direct,Mn.prototype._setValue_direct_setNeedsUpdate,Mn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Mn.prototype._setValue_array,Mn.prototype._setValue_array_setNeedsUpdate,Mn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Mn.prototype._setValue_arrayElement,Mn.prototype._setValue_arrayElement_setNeedsUpdate,Mn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Mn.prototype._setValue_fromArray,Mn.prototype._setValue_fromArray_setNeedsUpdate,Mn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Nle{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ko(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const e=this._objects,n=this._indicesByUUID,i=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length;let s,l=e.length,c=this.nCachedObjects_;for(let g=0,u=arguments.length;g!==u;++g){const d=arguments[g],C=d.uuid;let f=n[C];if(f===void 0){f=l++,n[C]=f,e.push(d);for(let v=0,p=a;v!==p;++v)o[v].push(new Mn(d,i[v],r[v]))}else if(f<c){s=e[f];const v=--c,p=e[v];n[p.uuid]=f,e[f]=p,n[C]=v,e[v]=d;for(let m=0,A=a;m!==A;++m){const b=o[m],G=b[v];let w=b[f];b[f]=G,w===void 0&&(w=new Mn(d,i[m],r[m])),b[v]=w}}else e[f]!==s&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let o=this.nCachedObjects_;for(let a=0,s=arguments.length;a!==s;++a){const l=arguments[a],c=l.uuid,g=n[c];if(g!==void 0&&g>=o){const u=o++,d=e[u];n[d.uuid]=g,e[g]=d,n[c]=u,e[u]=l;for(let C=0,f=r;C!==f;++C){const v=i[C],p=v[u],m=v[g];v[g]=p,v[u]=m}}}this.nCachedObjects_=o}uncache(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let o=this.nCachedObjects_,a=e.length;for(let s=0,l=arguments.length;s!==l;++s){const c=arguments[s],g=c.uuid,u=n[g];if(u!==void 0)if(delete n[g],u<o){const d=--o,C=e[d],f=--a,v=e[f];n[C.uuid]=u,e[u]=C,n[v.uuid]=d,e[d]=v,e.pop();for(let p=0,m=r;p!==m;++p){const A=i[p],b=A[d],G=A[f];A[u]=b,A[d]=G,A.pop()}}else{const d=--a,C=e[d];d>0&&(n[C.uuid]=u),e[u]=C,e.pop();for(let f=0,v=r;f!==v;++f){const p=i[f];p[u]=p[d],p.pop()}}}this.nCachedObjects_=o}subscribe_(e,n){const i=this._bindingsIndicesByPath;let r=i[e];const o=this._bindings;if(r!==void 0)return o[r];const a=this._paths,s=this._parsedPaths,l=this._objects,c=l.length,g=this.nCachedObjects_,u=new Array(c);r=o.length,i[e]=r,a.push(e),s.push(n),o.push(u);for(let d=g,C=l.length;d!==C;++d){const f=l[d];u[d]=new Mn(f,e,n)}return u}unsubscribe_(e){const n=this._bindingsIndicesByPath,i=n[e];if(i!==void 0){const r=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length-1,l=a[s],c=e[s];n[c]=i,a[i]=l,a.pop(),o[i]=o[s],o.pop(),r[i]=r[s],r.pop()}}}class CK{constructor(e,n,i=null,r=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=i,this.blendMode=r;const o=n.tracks,a=o.length,s=new Array(a),l={endingStart:cg,endingEnd:cg};for(let c=0;c!==a;++c){const g=o[c].createInterpolant(null);s[c]=g,g.settings=l}this._interpolantSettings=l,this._interpolants=s,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=$z,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,i){if(e.fadeOut(n),this.fadeIn(n),i){const r=this._clip.duration,o=e._clip.duration,a=o/r,s=r/o;e.warp(1,a,n),this.warp(s,1,n)}return this}crossFadeTo(e,n,i){return e.crossFadeFrom(this,n,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,i){const r=this._mixer,o=r.time,a=this.timeScale;let s=this._timeScaleInterpolant;s===null&&(s=r._lendControlInterpolant(),this._timeScaleInterpolant=s);const l=s.parameterPositions,c=s.sampleValues;return l[0]=o,l[1]=o+i,c[0]=e/a,c[1]=n/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,i,r){if(!this.enabled){this._updateWeight(e);return}const o=this._startTime;if(o!==null){const l=(e-o)*i;l<0||i===0?n=0:(this._startTime=null,n=i*l)}n*=this._updateTimeScale(e);const a=this._updateTime(n),s=this._updateWeight(e);if(s>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case JZ:for(let g=0,u=l.length;g!==u;++g)l[g].evaluate(a),c[g].accumulateAdditive(s);break;case Xv:default:for(let g=0,u=l.length;g!==u;++g)l[g].evaluate(a),c[g].accumulate(r,s)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,i=this.loop;let r=this.time+e,o=this._loopCount;const a=i===qz;if(e===0)return o===-1?r:a&&(o&1)===1?n-r:r;if(i===jz){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=n)r=n;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(o===-1&&(e>=0?(o=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),r>=n||r<0){const s=Math.floor(r/n);r-=n*s,o+=Math.abs(s);const l=this.repetitions-o;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?n:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=o,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s})}}else this.time=r;if(a&&(o&1)===1)return n-r}return r}_setEndings(e,n,i){const r=this._interpolantSettings;i?(r.endingStart=gg,r.endingEnd=gg):(e?r.endingStart=this.zeroSlopeAtStart?gg:cg:r.endingStart=Gh,n?r.endingEnd=this.zeroSlopeAtEnd?gg:cg:r.endingEnd=Gh)}_scheduleFading(e,n,i){const r=this._mixer,o=r.time;let a=this._weightInterpolant;a===null&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const s=a.parameterPositions,l=a.sampleValues;return s[0]=o,l[0]=n,s[1]=o+e,l[1]=i,this}}const Fle=new Float32Array(1);class Hle extends xs{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const i=e._localRoot||this._root,r=e._clip.tracks,o=r.length,a=e._propertyBindings,s=e._interpolants,l=i.uuid,c=this._bindingsByRootAndName;let g=c[l];g===void 0&&(g={},c[l]=g);for(let u=0;u!==o;++u){const d=r[u],C=d.name;let f=g[C];if(f!==void 0)++f.referenceCount,a[u]=f;else{if(f=a[u],f!==void 0){f._cacheIndex===null&&(++f.referenceCount,this._addInactiveBinding(f,l,C));continue}const v=n&&n._propertyBindings[u].binding.parsedPath;f=new IK(Mn.create(i,C,v),d.ValueTypeName,d.getValueSize()),++f.referenceCount,this._addInactiveBinding(f,l,C),a[u]=f}s[u].resultBuffer=f.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,o=this._actionsByClip[r];this._bindAction(e,o&&o.knownActions[0]),this._addInactiveAction(e,r,i)}const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const o=n[i];o.useCount++===0&&(this._lendBinding(o),o.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const o=n[i];--o.useCount===0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,i){const r=this._actions,o=this._actionsByClip;let a=o[n];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[n]=a;else{const s=a.knownActions;e._byClipCacheIndex=s.length,s.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[i]=e}_removeInactiveAction(e){const n=this._actions,i=n[n.length-1],r=e._cacheIndex;i._cacheIndex=r,n[r]=i,n.pop(),e._cacheIndex=null;const o=e._clip.uuid,a=this._actionsByClip,s=a[o],l=s.knownActions,c=l[l.length-1],g=e._byClipCacheIndex;c._byClipCacheIndex=g,l[g]=c,l.pop(),e._byClipCacheIndex=null;const u=s.actionByRoot,d=(e._localRoot||this._root).uuid;delete u[d],l.length===0&&delete a[o],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const o=n[i];--o.referenceCount===0&&this._removeInactiveBinding(o)}}_lendAction(e){const n=this._actions,i=e._cacheIndex,r=this._nActiveActions++,o=n[r];e._cacheIndex=r,n[r]=e,o._cacheIndex=i,n[i]=o}_takeBackAction(e){const n=this._actions,i=e._cacheIndex,r=--this._nActiveActions,o=n[r];e._cacheIndex=r,n[r]=e,o._cacheIndex=i,n[i]=o}_addInactiveBinding(e,n,i){const r=this._bindingsByRootAndName,o=this._bindings;let a=r[n];a===void 0&&(a={},r[n]=a),a[i]=e,e._cacheIndex=o.length,o.push(e)}_removeInactiveBinding(e){const n=this._bindings,i=e.binding,r=i.rootNode.uuid,o=i.path,a=this._bindingsByRootAndName,s=a[r],l=n[n.length-1],c=e._cacheIndex;l._cacheIndex=c,n[c]=l,n.pop(),delete s[o],Object.keys(s).length===0&&delete a[r]}_lendBinding(e){const n=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,o=n[r];e._cacheIndex=r,n[r]=e,o._cacheIndex=i,n[i]=o}_takeBackBinding(e){const n=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,o=n[r];e._cacheIndex=r,n[r]=e,o._cacheIndex=i,n[i]=o}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let i=e[n];return i===void 0&&(i=new A1(new Float32Array(2),new Float32Array(2),1,Fle),i.__cacheIndex=n,e[n]=i),i}_takeBackControlInterpolant(e){const n=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,o=n[r];e.__cacheIndex=r,n[r]=e,o.__cacheIndex=i,n[i]=o}clipAction(e,n,i){const r=n||this._root,o=r.uuid;let a=typeof e=="string"?Xh.findByName(r,e):e;const s=a!==null?a.uuid:e,l=this._actionsByClip[s];let c=null;if(i===void 0&&(a!==null?i=a.blendMode:i=Xv),l!==void 0){const u=l.actionByRoot[o];if(u!==void 0&&u.blendMode===i)return u;c=l.knownActions[0],a===null&&(a=c._clip)}if(a===null)return null;const g=new CK(this,a,n,i);return this._bindAction(g,c),this._addInactiveAction(g,s,o),g}existingAction(e,n){const i=n||this._root,r=i.uuid,o=typeof e=="string"?Xh.findByName(i,e):e,a=o?o.uuid:e,s=this._actionsByClip[a];return s!==void 0&&s.actionByRoot[r]||null}stopAllAction(){const e=this._actions,n=this._nActiveActions;for(let i=n-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const n=this._actions,i=this._nActiveActions,r=this.time+=e,o=Math.sign(e),a=this._accuIndex^=1;for(let c=0;c!==i;++c)n[c]._update(r,e,o,a);const s=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)s[c].apply(a);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,i=e.uuid,r=this._actionsByClip,o=r[i];if(o!==void 0){const a=o.knownActions;for(let s=0,l=a.length;s!==l;++s){const c=a[s];this._deactivateAction(c);const g=c._cacheIndex,u=n[n.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,u._cacheIndex=g,n[g]=u,n.pop(),this._removeInactiveBindingsForAction(c)}delete r[i]}}uncacheRoot(e){const n=e.uuid,i=this._actionsByClip;for(const a in i){const s=i[a].actionByRoot,l=s[n];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,o=r[n];if(o!==void 0)for(const a in o){const s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}}uncacheAction(e,n){const i=this.existingAction(e,n);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class Z1{constructor(e){this.value=e}clone(){return new Z1(this.value.clone===void 0?this.value:this.value.clone())}}let Xle=0;class Ele extends xs{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Xle++}),this.name="",this.usage=Zh,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const n=e.uniforms;this.uniforms.length=0;for(let i=0,r=n.length;i<r;i++){const o=Array.isArray(n[i])?n[i]:[n[i]];for(let a=0;a<o.length;a++)this.uniforms.push(o[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class Yle extends kv{constructor(e,n,i=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}class zle{constructor(e,n,i,r,o){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=i,this.elementSize=r,this.count=o,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const yF=new ln;class x1{constructor(e,n,i=0,r=1/0){this.ray=new kg(e,n),this.near=i,this.far=r,this.camera=null,this.layers=new bg,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}setFromXRController(e){return yF.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(yF),this}intersectObject(e,n=!0,i=[]){return XS(e,this,i,n),i.sort(GF),i}intersectObjects(e,n=!0,i=[]){for(let r=0,o=e.length;r<o;r++)XS(e[r],this,i,n);return i.sort(GF),i}}function GF(t,e){return t.distance-e.distance}function XS(t,e,n,i){let r=!0;if(t.layers.test(e.layers)&&t.raycast(e,n)===!1&&(r=!1),r===!0&&i===!0){const o=t.children;for(let a=0,s=o.length;a<s;a++)XS(o[a],e,n,!0)}}class ES{constructor(e=1,n=0,i=0){return this.radius=e,this.phi=n,this.theta=i,this}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(yi(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Kle{constructor(e=1,n=0,i=0){return this.radius=e,this.theta=n,this.y=i,this}set(e,n,i){return this.radius=e,this.theta=n,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=n,this}clone(){return new this.constructor().copy(this)}}class R1{constructor(e,n,i,r){R1.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,n,i,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,n=0){for(let i=0;i<4;i++)this.elements[i]=e[i+n];return this}set(e,n,i,r){const o=this.elements;return o[0]=e,o[2]=n,o[1]=i,o[3]=r,this}}const BF=new gt;class Lle{constructor(e=new gt(1/0,1/0),n=new gt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=BF.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,BF).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const SF=new ge,BA=new ge;class Tle{constructor(e=new ge,n=new ge){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){SF.subVectors(e,this.start),BA.subVectors(this.end,this.start);const i=BA.dot(BA);let o=BA.dot(SF)/i;return n&&(o=yi(o,0,1)),o}closestPointToPoint(e,n,i){const r=this.closestPointToPointParameter(e,n);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const wF=new ge;class _le extends Vn{constructor(e,n){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=n,this.type="SpotLightHelper";const i=new Sn,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,s=1,l=32;a<l;a++,s++){const c=a/l*Math.PI*2,g=s/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(g),Math.sin(g),1)}i.setAttribute("position",new tn(r,3));const o=new io({fog:!1,toneMapped:!1});this.cone=new Ws(i,o),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),wF.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(wF),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Fl=new ge,SA=new ln,QG=new ln;class kle extends Ws{constructor(e){const n=hK(e),i=new Sn,r=[],o=[],a=new kt(0,0,1),s=new kt(0,1,0);for(let c=0;c<n.length;c++){const g=n[c];g.parent&&g.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),o.push(a.r,a.g,a.b),o.push(s.r,s.g,s.b))}i.setAttribute("position",new tn(r,3)),i.setAttribute("color",new tn(o,3));const l=new io({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const n=this.bones,i=this.geometry,r=i.getAttribute("position");QG.copy(this.root.matrixWorld).invert();for(let o=0,a=0;o<n.length;o++){const s=n[o];s.parent&&s.parent.isBone&&(SA.multiplyMatrices(QG,s.matrixWorld),Fl.setFromMatrixPosition(SA),r.setXYZ(a,Fl.x,Fl.y,Fl.z),SA.multiplyMatrices(QG,s.parent.matrixWorld),Fl.setFromMatrixPosition(SA),r.setXYZ(a+1,Fl.x,Fl.y,Fl.z),a+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function hK(t){const e=[];t.isBone===!0&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,hK(t.children[n]));return e}class Ple extends ti{constructor(e,n,i){const r=new mf(n,4,2),o=new Rs({wireframe:!0,fog:!1,toneMapped:!1});super(r,o),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Ule=new ge,ZF=new kt,xF=new kt;class Dle extends Vn{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new ff(n);r.rotateY(Math.PI*.5),this.material=new Rs({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const o=r.getAttribute("position"),a=new Float32Array(o.count*3);r.setAttribute("color",new Un(a,3)),this.add(new ti(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const n=e.geometry.getAttribute("color");ZF.copy(this.light.color),xF.copy(this.light.groundColor);for(let i=0,r=n.count;i<r;i++){const o=i<r/2?ZF:xF;n.setXYZ(i,o.r,o.g,o.b)}n.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(Ule.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Ole extends Ws{constructor(e=10,n=10,i=4473924,r=8947848){i=new kt(i),r=new kt(r);const o=n/2,a=e/n,s=e/2,l=[],c=[];for(let d=0,C=0,f=-s;d<=n;d++,f+=a){l.push(-s,0,f,s,0,f),l.push(f,0,-s,f,0,s);const v=d===o?i:r;v.toArray(c,C),C+=3,v.toArray(c,C),C+=3,v.toArray(c,C),C+=3,v.toArray(c,C),C+=3}const g=new Sn;g.setAttribute("position",new tn(l,3)),g.setAttribute("color",new tn(c,3));const u=new io({vertexColors:!0,toneMapped:!1});super(g,u),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class Jle extends Ws{constructor(e=10,n=16,i=8,r=64,o=4473924,a=8947848){o=new kt(o),a=new kt(a);const s=[],l=[];if(n>1)for(let u=0;u<n;u++){const d=u/n*(Math.PI*2),C=Math.sin(d)*e,f=Math.cos(d)*e;s.push(0,0,0),s.push(C,0,f);const v=u&1?o:a;l.push(v.r,v.g,v.b),l.push(v.r,v.g,v.b)}for(let u=0;u<i;u++){const d=u&1?o:a,C=e-e/i*u;for(let f=0;f<r;f++){let v=f/r*(Math.PI*2),p=Math.sin(v)*C,m=Math.cos(v)*C;s.push(p,0,m),l.push(d.r,d.g,d.b),v=(f+1)/r*(Math.PI*2),p=Math.sin(v)*C,m=Math.cos(v)*C,s.push(p,0,m),l.push(d.r,d.g,d.b)}}const c=new Sn;c.setAttribute("position",new tn(s,3)),c.setAttribute("color",new tn(l,3));const g=new io({vertexColors:!0,toneMapped:!1});super(c,g),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const RF=new ge,wA=new ge,WF=new ge;class Qle extends Vn{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",n===void 0&&(n=1);let r=new Sn;r.setAttribute("position",new tn([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));const o=new io({fog:!1,toneMapped:!1});this.lightPlane=new uc(r,o),this.add(this.lightPlane),r=new Sn,r.setAttribute("position",new tn([0,0,0,0,0,1],3)),this.targetLine=new uc(r,o),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),RF.setFromMatrixPosition(this.light.matrixWorld),wA.setFromMatrixPosition(this.light.target.matrixWorld),WF.subVectors(wA,RF),this.lightPlane.lookAt(wA),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(wA),this.targetLine.scale.z=WF.length()}}const ZA=new ge,vi=new gf;class jle extends Ws{constructor(e){const n=new Sn,i=new io({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],o=[],a={};s("n1","n2"),s("n2","n4"),s("n4","n3"),s("n3","n1"),s("f1","f2"),s("f2","f4"),s("f4","f3"),s("f3","f1"),s("n1","f1"),s("n2","f2"),s("n3","f3"),s("n4","f4"),s("p","n1"),s("p","n2"),s("p","n3"),s("p","n4"),s("u1","u2"),s("u2","u3"),s("u3","u1"),s("c","t"),s("p","c"),s("cn1","cn2"),s("cn3","cn4"),s("cf1","cf2"),s("cf3","cf4");function s(f,v){l(f),l(v)}function l(f){r.push(0,0,0),o.push(0,0,0),a[f]===void 0&&(a[f]=[]),a[f].push(r.length/3-1)}n.setAttribute("position",new tn(r,3)),n.setAttribute("color",new tn(o,3)),super(n,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const c=new kt(16755200),g=new kt(16711680),u=new kt(43775),d=new kt(16777215),C=new kt(3355443);this.setColors(c,g,u,d,C)}setColors(e,n,i,r,o){const s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,n.r,n.g,n.b),s.setXYZ(25,n.r,n.g,n.b),s.setXYZ(26,n.r,n.g,n.b),s.setXYZ(27,n.r,n.g,n.b),s.setXYZ(28,n.r,n.g,n.b),s.setXYZ(29,n.r,n.g,n.b),s.setXYZ(30,n.r,n.g,n.b),s.setXYZ(31,n.r,n.g,n.b),s.setXYZ(32,i.r,i.g,i.b),s.setXYZ(33,i.r,i.g,i.b),s.setXYZ(34,i.r,i.g,i.b),s.setXYZ(35,i.r,i.g,i.b),s.setXYZ(36,i.r,i.g,i.b),s.setXYZ(37,i.r,i.g,i.b),s.setXYZ(38,r.r,r.g,r.b),s.setXYZ(39,r.r,r.g,r.b),s.setXYZ(40,o.r,o.g,o.b),s.setXYZ(41,o.r,o.g,o.b),s.setXYZ(42,o.r,o.g,o.b),s.setXYZ(43,o.r,o.g,o.b),s.setXYZ(44,o.r,o.g,o.b),s.setXYZ(45,o.r,o.g,o.b),s.setXYZ(46,o.r,o.g,o.b),s.setXYZ(47,o.r,o.g,o.b),s.setXYZ(48,o.r,o.g,o.b),s.setXYZ(49,o.r,o.g,o.b),s.needsUpdate=!0}update(){const e=this.geometry,n=this.pointMap,i=1,r=1;vi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),wi("c",n,e,vi,0,0,-1),wi("t",n,e,vi,0,0,1),wi("n1",n,e,vi,-i,-r,-1),wi("n2",n,e,vi,i,-r,-1),wi("n3",n,e,vi,-i,r,-1),wi("n4",n,e,vi,i,r,-1),wi("f1",n,e,vi,-i,-r,1),wi("f2",n,e,vi,i,-r,1),wi("f3",n,e,vi,-i,r,1),wi("f4",n,e,vi,i,r,1),wi("u1",n,e,vi,i*.7,r*1.1,-1),wi("u2",n,e,vi,-i*.7,r*1.1,-1),wi("u3",n,e,vi,0,r*2,-1),wi("cf1",n,e,vi,-i,0,1),wi("cf2",n,e,vi,i,0,1),wi("cf3",n,e,vi,0,-r,1),wi("cf4",n,e,vi,0,r,1),wi("cn1",n,e,vi,-i,0,-1),wi("cn2",n,e,vi,i,0,-1),wi("cn3",n,e,vi,0,-r,-1),wi("cn4",n,e,vi,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function wi(t,e,n,i,r,o,a){ZA.set(r,o,a).unproject(i);const s=e[t];if(s!==void 0){const l=n.getAttribute("position");for(let c=0,g=s.length;c<g;c++)l.setXYZ(s[c],ZA.x,ZA.y,ZA.z)}}const xA=new Cr;class $le extends Ws{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),o=new Sn;o.setIndex(new Un(i,1)),o.setAttribute("position",new Un(r,3)),super(o,new io({color:n,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&xA.setFromObject(this.object),xA.isEmpty())return;const n=xA.min,i=xA.max,r=this.geometry.attributes.position,o=r.array;o[0]=i.x,o[1]=i.y,o[2]=i.z,o[3]=n.x,o[4]=i.y,o[5]=i.z,o[6]=n.x,o[7]=n.y,o[8]=i.z,o[9]=i.x,o[10]=n.y,o[11]=i.z,o[12]=i.x,o[13]=i.y,o[14]=n.z,o[15]=n.x,o[16]=i.y,o[17]=n.z,o[18]=n.x,o[19]=n.y,o[20]=n.z,o[21]=i.x,o[22]=n.y,o[23]=n.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,n){return super.copy(e,n),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class qle extends Ws{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],o=new Sn;o.setIndex(new Un(i,1)),o.setAttribute("position",new tn(r,3)),super(o,new io({color:n,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class ece extends uc{constructor(e,n=1,i=16776960){const r=i,o=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new Sn;a.setAttribute("position",new tn(o,3)),a.computeBoundingSphere(),super(a,new io({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=n;const s=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new Sn;l.setAttribute("position",new tn(s,3)),l.computeBoundingSphere(),this.add(new ti(l,new Rs({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const VF=new ge;let RA,jG;class tce extends Vn{constructor(e=new ge(0,0,1),n=new ge(0,0,0),i=1,r=16776960,o=i*.2,a=o*.2){super(),this.type="ArrowHelper",RA===void 0&&(RA=new Sn,RA.setAttribute("position",new tn([0,0,0,0,1,0],3)),jG=new nI(0,.5,1,5,1),jG.translate(0,-.5,0)),this.position.copy(n),this.line=new uc(RA,new io({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ti(jG,new Rs({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,o,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{VF.set(e.z,0,-e.x).normalize();const n=Math.acos(e.y);this.quaternion.setFromAxisAngle(VF,n)}}setLength(e,n=e*.2,i=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(i,n,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class nce extends Ws{constructor(e=1){const n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Sn;r.setAttribute("position",new tn(n,3)),r.setAttribute("color",new tn(i,3));const o=new io({vertexColors:!0,toneMapped:!1});super(r,o),this.type="AxesHelper"}setColors(e,n,i){const r=new kt,o=this.geometry.attributes.color.array;return r.set(e),r.toArray(o,0),r.toArray(o,3),r.set(n),r.toArray(o,6),r.toArray(o,9),r.set(i),r.toArray(o,12),r.toArray(o,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ice{constructor(){this.type="ShapePath",this.color=new kt,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new Wh,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,i,r){return this.currentPath.quadraticCurveTo(e,n,i,r),this}bezierCurveTo(e,n,i,r,o,a){return this.currentPath.bezierCurveTo(e,n,i,r,o,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(m){const A=[];for(let b=0,G=m.length;b<G;b++){const w=m[b],S=new yg;S.curves=w.curves,A.push(S)}return A}function i(m,A){const b=A.length;let G=!1;for(let w=b-1,S=0;S<b;w=S++){let Z=A[w],x=A[S],R=x.x-Z.x,W=x.y-Z.y;if(Math.abs(W)>Number.EPSILON){if(W<0&&(Z=A[S],R=-R,x=A[w],W=-W),m.y<Z.y||m.y>x.y)continue;if(m.y===Z.y){if(m.x===Z.x)return!0}else{const M=W*(m.x-Z.x)-R*(m.y-Z.y);if(M===0)return!0;if(M<0)continue;G=!G}}else{if(m.y!==Z.y)continue;if(x.x<=m.x&&m.x<=Z.x||Z.x<=m.x&&m.x<=x.x)return!0}}return G}const r=Bs.isClockWise,o=this.subPaths;if(o.length===0)return[];let a,s,l;const c=[];if(o.length===1)return s=o[0],l=new yg,l.curves=s.curves,c.push(l),c;let g=!r(o[0].getPoints());g=e?!g:g;const u=[],d=[];let C=[],f=0,v;d[f]=void 0,C[f]=[];for(let m=0,A=o.length;m<A;m++)s=o[m],v=s.getPoints(),a=r(v),a=e?!a:a,a?(!g&&d[f]&&f++,d[f]={s:new yg,p:v},d[f].s.curves=s.curves,g&&f++,C[f]=[]):C[f].push({h:s,p:v[0]});if(!d[0])return n(o);if(d.length>1){let m=!1,A=0;for(let b=0,G=d.length;b<G;b++)u[b]=[];for(let b=0,G=d.length;b<G;b++){const w=C[b];for(let S=0;S<w.length;S++){const Z=w[S];let x=!0;for(let R=0;R<d.length;R++)i(Z.p,d[R].p)&&(b!==R&&A++,x?(x=!1,u[R].push(Z)):m=!0);x&&u[b].push(Z)}}A>0&&m===!1&&(C=u)}let p;for(let m=0,A=d.length;m<A;m++){l=d[m].s,c.push(l),p=C[m];for(let b=0,G=p.length;b<G;b++)l.holes.push(p[b].h)}return c}}class rce extends xs{constructor(e,n){super(),this.object=e,this.domElement=n,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}class oce extends Do{constructor(e=1,n=1,i=1,r={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,n,{...r,count:i}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:rf}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=rf);const ace=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:KZ,AddEquation:_l,AddOperation:_z,AdditiveAnimationBlendMode:JZ,AdditiveBlending:bS,AgXToneMapping:Oz,AlphaFormat:_Z,AlwaysCompare:l9,AlwaysDepth:Xz,AlwaysStencilFunc:wS,AmbientLight:sK,AnimationAction:CK,AnimationClip:Xh,AnimationLoader:lle,AnimationMixer:Hle,AnimationObjectGroup:Nle,AnimationUtils:rle,ArcCurve:V9,ArrayCamera:G9,ArrowHelper:tce,AttachedBindMode:BS,Audio:dK,AudioAnalyser:Gle,AudioContext:G1,AudioListener:vle,AudioLoader:mle,AxesHelper:nce,BackSide:qr,BasicDepthPacking:e9,BasicShadowMap:fz,BatchedMesh:x9,Bone:l1,BooleanKeyframeTrack:Ug,Box2:Lle,Box3:Cr,Box3Helper:qle,BoxGeometry:Pg,BoxHelper:$le,BufferAttribute:Un,BufferGeometry:Sn,BufferGeometryLoader:uK,ByteType:Wv,Cache:$s,Camera:gf,CameraHelper:jle,CanvasTexture:xse,CapsuleGeometry:Ov,CatmullRomCurve3:M9,CineonToneMapping:Uz,CircleGeometry:Jv,ClampToEdgeWrapping:zi,Clock:B1,Color:kt,ColorKeyframeTrack:p1,ColorManagement:Yn,CompressedArrayTexture:wse,CompressedCubeTexture:Zse,CompressedTexture:Uv,CompressedTextureLoader:cle,ConeGeometry:Qv,ConstantAlphaFactor:Nz,ConstantColorFactor:Vz,Controls:rce,CubeCamera:f9,CubeReflectionMapping:Ss,CubeRefractionMapping:gc,CubeTexture:uf,CubeTextureLoader:nK,CubeUVReflectionMapping:eI,CubicBezierCurve:u1,CubicBezierCurve3:N9,CubicInterpolant:$9,CullFaceBack:vS,CullFaceFront:hz,CullFaceFrontBack:ate,CullFaceNone:Cz,Curve:es,CurvePath:H9,CustomBlending:mz,CustomToneMapping:Dz,CylinderGeometry:nI,Cylindrical:Kle,Data3DTexture:qZ,DataArrayTexture:Yv,DataTexture:Oa,DataTextureLoader:v1,DataUtils:dg,DecrementStencilOp:pte,DecrementWrapStencilOp:bte,DefaultLoadingManager:tK,DepthFormat:pg,DepthStencilFormat:Ng,DepthTexture:o1,DetachedBindMode:Qz,DirectionalLight:aK,DirectionalLightHelper:Qle,DiscreteInterpolant:q9,DisplayP3ColorSpace:Ev,DodecahedronGeometry:jv,DoubleSide:da,DstAlphaFactor:wz,DstColorFactor:xz,DynamicCopyUsage:Hte,DynamicDrawUsage:c9,DynamicReadUsage:Mte,EdgesGeometry:X9,EllipseCurve:Dv,EqualCompare:r9,EqualDepth:Yz,EqualStencilFunc:Ste,EquirectangularReflectionMapping:Ld,EquirectangularRefractionMapping:ph,Euler:Ei,EventDispatcher:xs,ExtrudeGeometry:qv,FileLoader:Po,Float16BufferAttribute:yne,Float32BufferAttribute:tn,FloatType:hi,Fog:_v,FogExp2:Tv,FramebufferTexture:Sse,FrontSide:gl,Frustum:df,GLBufferAttribute:zle,GLSL1:Ete,GLSL3:ZS,GreaterCompare:o9,GreaterDepth:Kz,GreaterEqualCompare:s9,GreaterEqualDepth:zz,GreaterEqualStencilFunc:Rte,GreaterStencilFunc:Zte,GridHelper:Ole,Group:sd,HalfFloatType:or,HemisphereLight:iK,HemisphereLightHelper:Dle,IcosahedronGeometry:hf,ImageBitmapLoader:fle,ImageLoader:Eh,ImageUtils:d9,IncrementStencilOp:Ate,IncrementWrapStencilOp:vte,InstancedBufferAttribute:Hg,InstancedBufferGeometry:y1,InstancedInterleavedBuffer:Yle,InstancedMesh:vd,Int16BufferAttribute:vne,Int32BufferAttribute:bne,Int8BufferAttribute:mne,IntType:af,InterleavedBuffer:kv,InterleavedBufferAttribute:Fg,Interpolant:Af,InterpolateDiscrete:yh,InterpolateLinear:M0,InterpolateSmooth:dp,InvertStencilOp:yte,KeepStencilOp:Qc,KeyframeTrack:ts,LOD:w9,LatheGeometry:Cf,Layers:bg,LessCompare:i9,LessDepth:Ez,LessEqualCompare:jZ,LessEqualDepth:Ah,LessEqualStencilFunc:wte,LessStencilFunc:Bte,Light:Ac,LightProbe:gK,Line:uc,Line3:Tle,LineBasicMaterial:io,LineCurve:d1,LineCurve3:F9,LineDashedMaterial:J9,LineLoop:R9,LineSegments:Ws,LinearDisplayP3ColorSpace:cf,LinearFilter:Kn,LinearInterpolant:A1,LinearMipMapLinearFilter:SS,LinearMipMapNearestFilter:cte,LinearMipmapLinearFilter:ms,LinearMipmapNearestFilter:WC,LinearSRGBColorSpace:pa,LinearToneMapping:kz,LinearTransfer:Bh,Loader:ro,LoaderUtils:HS,LoadingManager:ab,LoopOnce:jz,LoopPingPong:qz,LoopRepeat:$z,LuminanceAlphaFormat:UZ,LuminanceFormat:PZ,MOUSE:Oc,Material:Er,MaterialLoader:sb,MathUtils:ene,Matrix2:R1,Matrix3:mn,Matrix4:ln,MaxEquation:bz,Mesh:ti,MeshBasicMaterial:Rs,MeshDepthMaterial:Kv,MeshDistanceMaterial:Lv,MeshLambertMaterial:D9,MeshMatcapMaterial:O9,MeshNormalMaterial:U9,MeshPhongMaterial:k9,MeshPhysicalMaterial:_9,MeshStandardMaterial:f1,MeshToonMaterial:P9,MinEquation:vz,MirroredRepeatWrapping:bh,MixOperation:Tz,MultiplyBlending:GS,MultiplyOperation:of,NearestFilter:rr,NearestMipMapLinearFilter:lte,NearestMipMapNearestFilter:ste,NearestMipmapLinearFilter:rd,NearestMipmapNearestFilter:LZ,NeutralToneMapping:Jz,NeverCompare:n9,NeverDepth:Hz,NeverStencilFunc:Gte,NoBlending:ys,NoColorSpace:Ds,NoToneMapping:Gs,NormalAnimationBlendMode:Xv,NormalBlending:Ag,NotEqualCompare:a9,NotEqualDepth:Lz,NotEqualStencilFunc:xte,NumberKeyframeTrack:Fh,Object3D:Vn,ObjectLoader:Cle,ObjectSpaceNormalMap:t9,OctahedronGeometry:ff,OneFactor:Gz,OneMinusConstantAlphaFactor:Fz,OneMinusConstantColorFactor:Mz,OneMinusDstAlphaFactor:Zz,OneMinusDstColorFactor:Rz,OneMinusSrcAlphaFactor:o0,OneMinusSrcColorFactor:Sz,OrthographicCamera:il,P3Primaries:wh,PCFShadowMap:Rv,PCFSoftShadowMap:RC,PMREMGenerator:xS,Path:Wh,PerspectiveCamera:Ri,Plane:Us,PlaneGeometry:qa,PlaneHelper:ece,PointLight:oK,PointLightHelper:Ple,Points:W9,PointsMaterial:c1,PolarGridHelper:Jle,PolyhedronGeometry:mc,PositionalAudio:yle,PropertyBinding:Mn,PropertyMixer:IK,QuadraticBezierCurve:I1,QuadraticBezierCurve3:C1,Quaternion:sr,QuaternionKeyframeTrack:pf,QuaternionLinearInterpolant:eK,RED_GREEN_RGTC2_Format:W0,RED_RGTC1_Format:OZ,REVISION:rf,RGBADepthPacking:QZ,RGBAFormat:Wi,RGBAIntegerFormat:Hv,RGBA_ASTC_10x10_Format:B0,RGBA_ASTC_10x5_Format:b0,RGBA_ASTC_10x6_Format:y0,RGBA_ASTC_10x8_Format:G0,RGBA_ASTC_12x10_Format:S0,RGBA_ASTC_12x12_Format:w0,RGBA_ASTC_4x4_Format:I0,RGBA_ASTC_5x4_Format:C0,RGBA_ASTC_5x5_Format:h0,RGBA_ASTC_6x5_Format:f0,RGBA_ASTC_6x6_Format:m0,RGBA_ASTC_8x5_Format:A0,RGBA_ASTC_8x6_Format:p0,RGBA_ASTC_8x8_Format:v0,RGBA_BPTC_Format:HC,RGBA_ETC2_EAC_Format:d0,RGBA_PVRTC_2BPPV1_Format:c0,RGBA_PVRTC_4BPPV1_Format:l0,RGBA_S3TC_DXT1_Format:MC,RGBA_S3TC_DXT3_Format:NC,RGBA_S3TC_DXT5_Format:FC,RGBDepthPacking:Cte,RGBFormat:kZ,RGBIntegerFormat:gte,RGB_BPTC_SIGNED_Format:Z0,RGB_BPTC_UNSIGNED_Format:x0,RGB_ETC1_Format:g0,RGB_ETC2_Format:u0,RGB_PVRTC_2BPPV1_Format:s0,RGB_PVRTC_4BPPV1_Format:a0,RGB_S3TC_DXT1_Format:VC,RGDepthPacking:hte,RGFormat:DZ,RGIntegerFormat:Fv,RawShaderMaterial:T9,Ray:kg,Raycaster:x1,Rec709Primaries:Sh,RectAreaLight:lK,RedFormat:sf,RedIntegerFormat:lf,ReinhardToneMapping:Pz,RenderTarget:I9,RepeatWrapping:vh,ReplaceStencilOp:mte,ReverseSubtractEquation:pz,RingGeometry:eb,SIGNED_RED_GREEN_RGTC2_Format:V0,SIGNED_RED_RGTC1_Format:R0,SRGBColorSpace:Yo,SRGBTransfer:jn,Scene:If,ShaderChunk:pn,ShaderLib:Ta,ShaderMaterial:bo,ShadowMaterial:L9,Shape:yg,ShapeGeometry:tb,ShapePath:ice,ShapeUtils:Bs,ShortType:Vv,Skeleton:Pv,SkeletonHelper:kle,SkinnedMesh:Z9,Source:ug,Sphere:hr,SphereGeometry:mf,Spherical:ES,SphericalHarmonics3:cK,SplineCurve:h1,SpotLight:rK,SpotLightHelper:_le,Sprite:S9,SpriteMaterial:s1,SrcAlphaFactor:r0,SrcAlphaSaturateFactor:Wz,SrcColorFactor:Bz,StaticCopyUsage:Fte,StaticDrawUsage:Zh,StaticReadUsage:Vte,StereoCamera:Ale,StreamCopyUsage:Xte,StreamDrawUsage:Wte,StreamReadUsage:Nte,StringKeyframeTrack:Dg,SubtractEquation:Az,SubtractiveBlending:yS,TOUCH:Jc,TangentSpaceNormalMap:fc,TetrahedronGeometry:nb,Texture:Tn,TextureLoader:gle,TextureUtils:rse,TorusGeometry:ib,TorusKnotGeometry:rb,Triangle:zo,TriangleFanDrawMode:Ite,TriangleStripDrawMode:dte,TrianglesDrawMode:ute,TubeGeometry:ob,UVMapping:cc,Uint16BufferAttribute:e1,Uint32BufferAttribute:t1,Uint8BufferAttribute:Ane,Uint8ClampedBufferAttribute:pne,Uniform:Z1,UniformsGroup:Ele,UniformsLib:Kt,UniformsUtils:n1,UnsignedByteType:vo,UnsignedInt248Type:Mg,UnsignedInt5999Type:TZ,UnsignedIntType:ws,UnsignedShort4444Type:Mv,UnsignedShort5551Type:Nv,UnsignedShortType:Td,VSMShadowMap:Ea,Vector2:gt,Vector3:ge,Vector4:zn,VectorKeyframeTrack:Hh,VideoTexture:Bse,WebGL3DRenderTarget:sne,WebGLArrayRenderTarget:ane,WebGLCoordinateSystem:As,WebGLCubeRenderTarget:i1,WebGLMultipleRenderTargets:oce,WebGLRenderTarget:Do,WebGLRenderer:a1,WebGLUtils:y9,WebGPUCoordinateSystem:xh,WireframeGeometry:K9,WrapAroundEnding:Gh,ZeroCurvatureEnding:cg,ZeroFactor:yz,ZeroSlopeEnding:gg,ZeroStencilOp:fte,createCanvasElement:u9},Symbol.toStringTag,{value:"Module"}));var fK={exports:{}},Og={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Og.ConcurrentRoot=1;Og.ContinuousEventPriority=4;Og.DefaultEventPriority=16;Og.DiscreteEventPriority=1;Og.IdleEventPriority=536870912;Og.LegacyRoot=0;fK.exports=Og;var cd=fK.exports;function sce(t){let e;const n=new Set,i=(c,g)=>{const u=typeof c=="function"?c(e):c;if(u!==e){const d=e;e=g?u:Object.assign({},e,u),n.forEach(C=>C(e,d))}},r=()=>e,o=(c,g=r,u=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let d=g(e);function C(){const f=g(e);if(!u(d,f)){const v=d;c(d=f,v)}}return n.add(C),()=>n.delete(C)},l={setState:i,getState:r,subscribe:(c,g,u)=>g||u?o(c,g,u):(n.add(c),()=>n.delete(c)),destroy:()=>n.clear()};return e=t(i,r,l),l}const lce=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),MF=lce?y.useEffect:y.useLayoutEffect;function mK(t){const e=typeof t=="function"?sce(t):t,n=(i=e.getState,r=Object.is)=>{const[,o]=y.useReducer(p=>p+1,0),a=e.getState(),s=y.useRef(a),l=y.useRef(i),c=y.useRef(r),g=y.useRef(!1),u=y.useRef();u.current===void 0&&(u.current=i(a));let d,C=!1;(s.current!==a||l.current!==i||c.current!==r||g.current)&&(d=i(a),C=!r(u.current,d)),MF(()=>{C&&(u.current=d),s.current=a,l.current=i,c.current=r,g.current=!1});const f=y.useRef(a);MF(()=>{const p=()=>{try{const A=e.getState(),b=l.current(A);c.current(u.current,b)||(s.current=A,u.current=b,o())}catch{g.current=!0,o()}},m=e.subscribe(p);return e.getState()!==f.current&&p(),m},[]);const v=C?d:u.current;return y.useDebugValue(v),v};return Object.assign(n,e),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const i=[n,e];return{next(){const r=i.length<=0;return{value:i.shift(),done:r}}}},n}const cce=t=>typeof t=="object"&&typeof t.then=="function",Cg=[];function AK(t,e,n=(i,r)=>i===r){if(t===e)return!0;if(!t||!e)return!1;const i=t.length;if(e.length!==i)return!1;for(let r=0;r<i;r++)if(!n(t[r],e[r]))return!1;return!0}function pK(t,e=null,n=!1,i={}){e===null&&(e=[t]);for(const o of Cg)if(AK(e,o.keys,o.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(o,"error"))throw o.error;if(Object.prototype.hasOwnProperty.call(o,"response"))return i.lifespan&&i.lifespan>0&&(o.timeout&&clearTimeout(o.timeout),o.timeout=setTimeout(o.remove,i.lifespan)),o.response;if(!n)throw o.promise}const r={keys:e,equal:i.equal,remove:()=>{const o=Cg.indexOf(r);o!==-1&&Cg.splice(o,1)},promise:(cce(t)?t:t(...e)).then(o=>{r.response=o,i.lifespan&&i.lifespan>0&&(r.timeout=setTimeout(r.remove,i.lifespan))}).catch(o=>r.error=o)};if(Cg.push(r),!n)throw r.promise}const vK=(t,e,n)=>pK(t,e,!1,n),gce=(t,e,n)=>void pK(t,e,!0,n),uce=t=>{if(t===void 0||t.length===0)Cg.splice(0,Cg.length);else{const e=Cg.find(n=>AK(t,n.keys,n.equal));e&&e.remove()}};var bK={exports:{}},$G={exports:{}},qG={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NF;function dce(){return NF||(NF=1,function(t){function e(F,L){var z=F.length;F.push(L);e:for(;0<z;){var K=z-1>>>1,O=F[K];if(0<r(O,L))F[K]=L,F[z]=O,z=K;else break e}}function n(F){return F.length===0?null:F[0]}function i(F){if(F.length===0)return null;var L=F[0],z=F.pop();if(z!==L){F[0]=z;e:for(var K=0,O=F.length,j=O>>>1;K<j;){var P=2*(K+1)-1,$=F[P],oe=P+1,ie=F[oe];if(0>r($,z))oe<O&&0>r(ie,$)?(F[K]=ie,F[oe]=z,K=oe):(F[K]=$,F[P]=z,K=P);else if(oe<O&&0>r(ie,z))F[K]=ie,F[oe]=z,K=oe;else break e}}return L}function r(F,L){var z=F.sortIndex-L.sortIndex;return z!==0?z:F.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,s=a.now();t.unstable_now=function(){return a.now()-s}}var l=[],c=[],g=1,u=null,d=3,C=!1,f=!1,v=!1,p=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(F){for(var L=n(c);L!==null;){if(L.callback===null)i(c);else if(L.startTime<=F)i(c),L.sortIndex=L.expirationTime,e(l,L);else break;L=n(c)}}function G(F){if(v=!1,b(F),!f)if(n(l)!==null)f=!0,k(w);else{var L=n(c);L!==null&&J(G,L.startTime-F)}}function w(F,L){f=!1,v&&(v=!1,m(x),x=-1),C=!0;var z=d;try{for(b(L),u=n(l);u!==null&&(!(u.expirationTime>L)||F&&!M());){var K=u.callback;if(typeof K=="function"){u.callback=null,d=u.priorityLevel;var O=K(u.expirationTime<=L);L=t.unstable_now(),typeof O=="function"?u.callback=O:u===n(l)&&i(l),b(L)}else i(l);u=n(l)}if(u!==null)var j=!0;else{var P=n(c);P!==null&&J(G,P.startTime-L),j=!1}return j}finally{u=null,d=z,C=!1}}var S=!1,Z=null,x=-1,R=5,W=-1;function M(){return!(t.unstable_now()-W<R)}function N(){if(Z!==null){var F=t.unstable_now();W=F;var L=!0;try{L=Z(!0,F)}finally{L?X():(S=!1,Z=null)}}else S=!1}var X;if(typeof A=="function")X=function(){A(N)};else if(typeof MessageChannel<"u"){var E=new MessageChannel,Q=E.port2;E.port1.onmessage=N,X=function(){Q.postMessage(null)}}else X=function(){p(N,0)};function k(F){Z=F,S||(S=!0,X())}function J(F,L){x=p(function(){F(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){f||C||(f=!0,k(w))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(F){switch(d){case 1:case 2:case 3:var L=3;break;default:L=d}var z=d;d=L;try{return F()}finally{d=z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,L){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var z=d;d=F;try{return L()}finally{d=z}},t.unstable_scheduleCallback=function(F,L,z){var K=t.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?K+z:K):z=K,F){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=z+O,F={id:g++,callback:L,priorityLevel:F,startTime:z,expirationTime:O,sortIndex:-1},z>K?(F.sortIndex=z,e(c,F),n(l)===null&&F===n(c)&&(v?(m(x),x=-1):v=!0,J(G,z-K))):(F.sortIndex=O,e(l,F),f||C||(f=!0,k(w))),F},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(F){var L=d;return function(){var z=d;d=L;try{return F.apply(this,arguments)}finally{d=z}}}}(qG)),qG}var FF;function Ice(){return FF||(FF=1,$G.exports=dce()),$G.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cce=function(e){var n={},i=y,r=Ice(),o=Object.assign;function a(I){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+I,B=1;B<arguments.length;B++)h+="&args[]="+encodeURIComponent(arguments[B]);return"Minified React error #"+I+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),f=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),G=Symbol.for("react.offscreen"),w=Symbol.iterator;function S(I){return I===null||typeof I!="object"?null:(I=w&&I[w]||I["@@iterator"],typeof I=="function"?I:null)}function Z(I){if(I==null)return null;if(typeof I=="function")return I.displayName||I.name||null;if(typeof I=="string")return I;switch(I){case g:return"Fragment";case c:return"Portal";case d:return"Profiler";case u:return"StrictMode";case p:return"Suspense";case m:return"SuspenseList"}if(typeof I=="object")switch(I.$$typeof){case f:return(I.displayName||"Context")+".Consumer";case C:return(I._context.displayName||"Context")+".Provider";case v:var h=I.render;return I=I.displayName,I||(I=h.displayName||h.name||"",I=I!==""?"ForwardRef("+I+")":"ForwardRef"),I;case A:return h=I.displayName||null,h!==null?h:Z(I.type)||"Memo";case b:h=I._payload,I=I._init;try{return Z(I(h))}catch{}}return null}function x(I){var h=I.type;switch(I.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return I=h.render,I=I.displayName||I.name||"",h.displayName||(I!==""?"ForwardRef("+I+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Z(h);case 8:return h===u?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function R(I){var h=I,B=I;if(I.alternate)for(;h.return;)h=h.return;else{I=h;do h=I,h.flags&4098&&(B=h.return),I=h.return;while(I)}return h.tag===3?B:null}function W(I){if(R(I)!==I)throw Error(a(188))}function M(I){var h=I.alternate;if(!h){if(h=R(I),h===null)throw Error(a(188));return h!==I?null:I}for(var B=I,V=h;;){var H=B.return;if(H===null)break;var D=H.alternate;if(D===null){if(V=H.return,V!==null){B=V;continue}break}if(H.child===D.child){for(D=H.child;D;){if(D===B)return W(H),I;if(D===V)return W(H),h;D=D.sibling}throw Error(a(188))}if(B.return!==V.return)B=H,V=D;else{for(var ye=!1,Ke=H.child;Ke;){if(Ke===B){ye=!0,B=H,V=D;break}if(Ke===V){ye=!0,V=H,B=D;break}Ke=Ke.sibling}if(!ye){for(Ke=D.child;Ke;){if(Ke===B){ye=!0,B=D,V=H;break}if(Ke===V){ye=!0,V=D,B=H;break}Ke=Ke.sibling}if(!ye)throw Error(a(189))}}if(B.alternate!==V)throw Error(a(190))}if(B.tag!==3)throw Error(a(188));return B.stateNode.current===B?I:h}function N(I){return I=M(I),I!==null?X(I):null}function X(I){if(I.tag===5||I.tag===6)return I;for(I=I.child;I!==null;){var h=X(I);if(h!==null)return h;I=I.sibling}return null}function E(I){if(I.tag===5||I.tag===6)return I;for(I=I.child;I!==null;){if(I.tag!==4){var h=E(I);if(h!==null)return h}I=I.sibling}return null}var Q=Array.isArray,k=e.getPublicInstance,J=e.getRootHostContext,F=e.getChildHostContext,L=e.prepareForCommit,z=e.resetAfterCommit,K=e.createInstance,O=e.appendInitialChild,j=e.finalizeInitialChildren,P=e.prepareUpdate,$=e.shouldSetTextContent,oe=e.createTextInstance,ie=e.scheduleTimeout,de=e.cancelTimeout,Ve=e.noTimeout,Se=e.isPrimaryRenderer,me=e.supportsMutation,T=e.supportsPersistence,Ge=e.supportsHydration,ne=e.getInstanceFromNode,he=e.preparePortalMount,ae=e.getCurrentEventPriority,He=e.detachDeletedInstance,ve=e.supportsMicrotasks,Me=e.scheduleMicrotask,q=e.supportsTestSelectors,Y=e.findFiberRoot,Ce=e.getBoundingRect,se=e.getTextContent,fe=e.isHiddenSubtree,Ze=e.matchAccessibilityRole,Oe=e.setFocusIfFocusable,Fe=e.setupIntersectionObserver,Ee=e.appendChild,Qe=e.appendChildToContainer,Ye=e.commitTextUpdate,$e=e.commitMount,st=e.commitUpdate,Ue=e.insertBefore,Ne=e.insertInContainerBefore,je=e.removeChild,Ie=e.removeChildFromContainer,Te=e.resetTextContent,ue=e.hideInstance,Pe=e.hideTextInstance,be=e.unhideInstance,Le=e.unhideTextInstance,ct=e.clearContainer,dt=e.cloneInstance,It=e.createContainerChildSet,Vt=e.appendChildToContainerChildSet,vt=e.finalizeContainerChildren,et=e.replaceContainerChildren,rt=e.cloneHiddenInstance,ut=e.cloneHiddenTextInstance,Tt=e.canHydrateInstance,Ft=e.canHydrateTextInstance,ft=e.canHydrateSuspenseInstance,At=e.isSuspenseInstancePending,Gt=e.isSuspenseInstanceFallback,Bt=e.registerSuspenseInstanceRetry,Yt=e.getNextHydratableSibling,St=e.getFirstHydratableChild,sn=e.getFirstHydratableChildWithinContainer,Ot=e.getFirstHydratableChildWithinSuspenseInstance,U=e.hydrateInstance,ee=e.hydrateTextInstance,Be=e.hydrateSuspenseInstance,_=e.getNextHydratableInstanceAfterSuspenseInstance,te=e.commitHydratedContainer,ce=e.commitHydratedSuspenseInstance,le=e.clearSuspenseBoundary,re=e.clearSuspenseBoundaryFromContainer,xe=e.shouldDeleteUnhydratedTailInstances,Xe=e.didNotMatchHydratedContainerTextInstance,_e=e.didNotMatchHydratedTextInstance,We;function pt(I){if(We===void 0)try{throw Error()}catch(B){var h=B.stack.trim().match(/\n( *(at )?)/);We=h&&h[1]||""}return`
`+We+I}var lt=!1;function nt(I,h){if(!I||lt)return"";lt=!0;var B=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(Mt){var V=Mt}Reflect.construct(I,[],h)}else{try{h.call()}catch(Mt){V=Mt}I.call(h.prototype)}else{try{throw Error()}catch(Mt){V=Mt}I()}}catch(Mt){if(Mt&&V&&typeof Mt.stack=="string"){for(var H=Mt.stack.split(`
`),D=V.stack.split(`
`),ye=H.length-1,Ke=D.length-1;1<=ye&&0<=Ke&&H[ye]!==D[Ke];)Ke--;for(;1<=ye&&0<=Ke;ye--,Ke--)if(H[ye]!==D[Ke]){if(ye!==1||Ke!==1)do if(ye--,Ke--,0>Ke||H[ye]!==D[Ke]){var at=`
`+H[ye].replace(" at new "," at ");return I.displayName&&at.includes("<anonymous>")&&(at=at.replace("<anonymous>",I.displayName)),at}while(1<=ye&&0<=Ke);break}}}finally{lt=!1,Error.prepareStackTrace=B}return(I=I?I.displayName||I.name:"")?pt(I):""}var wt=Object.prototype.hasOwnProperty,ot=[],bt=-1;function Wt(I){return{current:I}}function yt(I){0>bt||(I.current=ot[bt],ot[bt]=null,bt--)}function ht(I,h){bt++,ot[bt]=I.current,I.current=h}var Qt={},zt=Wt(Qt),Pt=Wt(!1),dn=Qt;function un(I,h){var B=I.type.contextTypes;if(!B)return Qt;var V=I.stateNode;if(V&&V.__reactInternalMemoizedUnmaskedChildContext===h)return V.__reactInternalMemoizedMaskedChildContext;var H={},D;for(D in B)H[D]=h[D];return V&&(I=I.stateNode,I.__reactInternalMemoizedUnmaskedChildContext=h,I.__reactInternalMemoizedMaskedChildContext=H),H}function In(I){return I=I.childContextTypes,I!=null}function Ht(){yt(Pt),yt(zt)}function mt(I,h,B){if(zt.current!==Qt)throw Error(a(168));ht(zt,h),ht(Pt,B)}function Lt(I,h,B){var V=I.stateNode;if(h=h.childContextTypes,typeof V.getChildContext!="function")return B;V=V.getChildContext();for(var H in V)if(!(H in h))throw Error(a(108,x(I)||"Unknown",H));return o({},B,V)}function Rt(I){return I=(I=I.stateNode)&&I.__reactInternalMemoizedMergedChildContext||Qt,dn=zt.current,ht(zt,I),ht(Pt,Pt.current),!0}function Xt(I,h,B){var V=I.stateNode;if(!V)throw Error(a(169));B?(I=Lt(I,h,dn),V.__reactInternalMemoizedMergedChildContext=I,yt(Pt),yt(zt),ht(zt,I)):yt(Pt),ht(Pt,B)}var en=Math.clz32?Math.clz32:On,Rn=Math.log,bn=Math.LN2;function On(I){return I>>>=0,I===0?32:31-(Rn(I)/bn|0)|0}var gi=64,ni=4194304;function ai(I){switch(I&-I){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return I&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return I&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return I}}function Vi(I,h){var B=I.pendingLanes;if(B===0)return 0;var V=0,H=I.suspendedLanes,D=I.pingedLanes,ye=B&268435455;if(ye!==0){var Ke=ye&~H;Ke!==0?V=ai(Ke):(D&=ye,D!==0&&(V=ai(D)))}else ye=B&~H,ye!==0?V=ai(ye):D!==0&&(V=ai(D));if(V===0)return 0;if(h!==0&&h!==V&&!(h&H)&&(H=V&-V,D=h&-h,H>=D||H===16&&(D&4194240)!==0))return h;if(V&4&&(V|=B&16),h=I.entangledLanes,h!==0)for(I=I.entanglements,h&=V;0<h;)B=31-en(h),H=1<<B,V|=I[B],h&=~H;return V}function jo(I,h){switch(I){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mr(I,h){for(var B=I.suspendedLanes,V=I.pingedLanes,H=I.expirationTimes,D=I.pendingLanes;0<D;){var ye=31-en(D),Ke=1<<ye,at=H[ye];at===-1?(!(Ke&B)||Ke&V)&&(H[ye]=jo(Ke,h)):at<=h&&(I.expiredLanes|=Ke),D&=~Ke}}function Go(I){return I=I.pendingLanes&-1073741825,I!==0?I:I&1073741824?1073741824:0}function Vs(I){for(var h=[],B=0;31>B;B++)h.push(I);return h}function Yr(I,h,B){I.pendingLanes|=h,h!==536870912&&(I.suspendedLanes=0,I.pingedLanes=0),I=I.eventTimes,h=31-en(h),I[h]=B}function ui(I,h){var B=I.pendingLanes&~h;I.pendingLanes=h,I.suspendedLanes=0,I.pingedLanes=0,I.expiredLanes&=h,I.mutableReadLanes&=h,I.entangledLanes&=h,h=I.entanglements;var V=I.eventTimes;for(I=I.expirationTimes;0<B;){var H=31-en(B),D=1<<H;h[H]=0,V[H]=-1,I[H]=-1,B&=~D}}function Ji(I,h){var B=I.entangledLanes|=h;for(I=I.entanglements;B;){var V=31-en(B),H=1<<V;H&h|I[V]&h&&(I[V]|=h),B&=~H}}var Cn=0;function Bo(I){return I&=-I,1<I?4<I?I&268435455?16:536870912:4:1}var Ar=r.unstable_scheduleCallback,Ba=r.unstable_cancelCallback,ns=r.unstable_shouldYield,Jt=r.unstable_requestPaint,Ut=r.unstable_now,Hn=r.unstable_ImmediatePriority,Qn=r.unstable_UserBlockingPriority,Gn=r.unstable_NormalPriority,$o=r.unstable_IdlePriority,Sa=null,pr=null;function is(I){if(pr&&typeof pr.onCommitFiberRoot=="function")try{pr.onCommitFiberRoot(Sa,I,void 0,(I.current.flags&128)===128)}catch{}}function yf(I,h){return I===h&&(I!==0||1/I===1/h)||I!==I&&h!==h}var So=typeof Object.is=="function"?Object.is:yf,zr=null,rs=!1,qo=!1;function rI(I){zr===null?zr=[I]:zr.push(I)}function oI(I){rs=!0,rI(I)}function oo(){if(!qo&&zr!==null){qo=!0;var I=0,h=Cn;try{var B=zr;for(Cn=1;I<B.length;I++){var V=B[I];do V=V(!0);while(V!==null)}zr=null,rs=!1}catch(H){throw zr!==null&&(zr=zr.slice(I+1)),Ar(Hn,oo),H}finally{Cn=h,qo=!1}}return null}var pc=s.ReactCurrentBatchConfig;function vc(I,h){if(So(I,h))return!0;if(typeof I!="object"||I===null||typeof h!="object"||h===null)return!1;var B=Object.keys(I),V=Object.keys(h);if(B.length!==V.length)return!1;for(V=0;V<B.length;V++){var H=B[V];if(!wt.call(h,H)||!So(I[H],h[H]))return!1}return!0}function bc(I){switch(I.tag){case 5:return pt(I.type);case 16:return pt("Lazy");case 13:return pt("Suspense");case 19:return pt("SuspenseList");case 0:case 2:case 15:return I=nt(I.type,!1),I;case 11:return I=nt(I.type.render,!1),I;case 1:return I=nt(I.type,!0),I;default:return""}}function Kr(I,h){if(I&&I.defaultProps){h=o({},h),I=I.defaultProps;for(var B in I)h[B]===void 0&&(h[B]=I[B]);return h}return h}var Qi=Wt(null),Jg=null,wa=null,fl=null;function Qg(){fl=wa=Jg=null}function Gf(I,h,B){Se?(ht(Qi,h._currentValue),h._currentValue=B):(ht(Qi,h._currentValue2),h._currentValue2=B)}function ji(I){var h=Qi.current;yt(Qi),Se?I._currentValue=h:I._currentValue2=h}function Lr(I,h,B){for(;I!==null;){var V=I.alternate;if((I.childLanes&h)!==h?(I.childLanes|=h,V!==null&&(V.childLanes|=h)):V!==null&&(V.childLanes&h)!==h&&(V.childLanes|=h),I===B)break;I=I.return}}function Gi(I,h){Jg=I,fl=wa=null,I=I.dependencies,I!==null&&I.firstContext!==null&&(I.lanes&h&&(Ro=!0),I.firstContext=null)}function Bi(I){var h=Se?I._currentValue:I._currentValue2;if(fl!==I)if(I={context:I,memoizedValue:h,next:null},wa===null){if(Jg===null)throw Error(a(308));wa=I,Jg.dependencies={lanes:0,firstContext:I}}else wa=wa.next=I;return h}var wo=null,ml=!1;function ub(I){I.updateQueue={baseState:I.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function U1(I,h){I=I.updateQueue,h.updateQueue===I&&(h.updateQueue={baseState:I.baseState,firstBaseUpdate:I.firstBaseUpdate,lastBaseUpdate:I.lastBaseUpdate,shared:I.shared,effects:I.effects})}function Ms(I,h){return{eventTime:I,lane:h,tag:0,payload:null,callback:null,next:null}}function Al(I,h){var B=I.updateQueue;B!==null&&(B=B.shared,Mi!==null&&I.mode&1&&!(wn&2)?(I=B.interleaved,I===null?(h.next=h,wo===null?wo=[B]:wo.push(B)):(h.next=I.next,I.next=h),B.interleaved=h):(I=B.pending,I===null?h.next=h:(h.next=I.next,I.next=h),B.pending=h))}function Bf(I,h,B){if(h=h.updateQueue,h!==null&&(h=h.shared,(B&4194240)!==0)){var V=h.lanes;V&=I.pendingLanes,B|=V,h.lanes=B,Ji(I,B)}}function D1(I,h){var B=I.updateQueue,V=I.alternate;if(V!==null&&(V=V.updateQueue,B===V)){var H=null,D=null;if(B=B.firstBaseUpdate,B!==null){do{var ye={eventTime:B.eventTime,lane:B.lane,tag:B.tag,payload:B.payload,callback:B.callback,next:null};D===null?H=D=ye:D=D.next=ye,B=B.next}while(B!==null);D===null?H=D=h:D=D.next=h}else H=D=h;B={baseState:V.baseState,firstBaseUpdate:H,lastBaseUpdate:D,shared:V.shared,effects:V.effects},I.updateQueue=B;return}I=B.lastBaseUpdate,I===null?B.firstBaseUpdate=h:I.next=h,B.lastBaseUpdate=h}function Sf(I,h,B,V){var H=I.updateQueue;ml=!1;var D=H.firstBaseUpdate,ye=H.lastBaseUpdate,Ke=H.shared.pending;if(Ke!==null){H.shared.pending=null;var at=Ke,Mt=at.next;at.next=null,ye===null?D=Mt:ye.next=Mt,ye=at;var $t=I.alternate;$t!==null&&($t=$t.updateQueue,Ke=$t.lastBaseUpdate,Ke!==ye&&(Ke===null?$t.firstBaseUpdate=Mt:Ke.next=Mt,$t.lastBaseUpdate=at))}if(D!==null){var hn=H.baseState;ye=0,$t=Mt=at=null,Ke=D;do{var cn=Ke.lane,Jn=Ke.eventTime;if((V&cn)===cn){$t!==null&&($t=$t.next={eventTime:Jn,lane:0,tag:Ke.tag,payload:Ke.payload,callback:Ke.callback,next:null});e:{var an=I,Gr=Ke;switch(cn=h,Jn=B,Gr.tag){case 1:if(an=Gr.payload,typeof an=="function"){hn=an.call(Jn,hn,cn);break e}hn=an;break e;case 3:an.flags=an.flags&-65537|128;case 0:if(an=Gr.payload,cn=typeof an=="function"?an.call(Jn,hn,cn):an,cn==null)break e;hn=o({},hn,cn);break e;case 2:ml=!0}}Ke.callback!==null&&Ke.lane!==0&&(I.flags|=64,cn=H.effects,cn===null?H.effects=[Ke]:cn.push(Ke))}else Jn={eventTime:Jn,lane:cn,tag:Ke.tag,payload:Ke.payload,callback:Ke.callback,next:null},$t===null?(Mt=$t=Jn,at=hn):$t=$t.next=Jn,ye|=cn;if(Ke=Ke.next,Ke===null){if(Ke=H.shared.pending,Ke===null)break;cn=Ke,Ke=cn.next,cn.next=null,H.lastBaseUpdate=cn,H.shared.pending=null}}while(!0);if($t===null&&(at=hn),H.baseState=at,H.firstBaseUpdate=Mt,H.lastBaseUpdate=$t,h=H.shared.interleaved,h!==null){H=h;do ye|=H.lane,H=H.next;while(H!==h)}else D===null&&(H.shared.lanes=0);ou|=ye,I.lanes=ye,I.memoizedState=hn}}function O1(I,h,B){if(I=h.effects,h.effects=null,I!==null)for(h=0;h<I.length;h++){var V=I[h],H=V.callback;if(H!==null){if(V.callback=null,V=B,typeof H!="function")throw Error(a(191,H));H.call(V)}}}var J1=new i.Component().refs;function db(I,h,B,V){h=I.memoizedState,B=B(V,h),B=B==null?h:o({},h,B),I.memoizedState=B,I.lanes===0&&(I.updateQueue.baseState=B)}var wf={isMounted:function(I){return(I=I._reactInternals)?R(I)===I:!1},enqueueSetState:function(I,h,B){I=I._reactInternals;var V=_r(),H=bl(I),D=Ms(V,H);D.payload=h,B!=null&&(D.callback=B),Al(I,D),h=ra(I,H,V),h!==null&&Bf(h,I,H)},enqueueReplaceState:function(I,h,B){I=I._reactInternals;var V=_r(),H=bl(I),D=Ms(V,H);D.tag=1,D.payload=h,B!=null&&(D.callback=B),Al(I,D),h=ra(I,H,V),h!==null&&Bf(h,I,H)},enqueueForceUpdate:function(I,h){I=I._reactInternals;var B=_r(),V=bl(I),H=Ms(B,V);H.tag=2,h!=null&&(H.callback=h),Al(I,H),h=ra(I,V,B),h!==null&&Bf(h,I,V)}};function Q1(I,h,B,V,H,D,ye){return I=I.stateNode,typeof I.shouldComponentUpdate=="function"?I.shouldComponentUpdate(V,D,ye):h.prototype&&h.prototype.isPureReactComponent?!vc(B,V)||!vc(H,D):!0}function j1(I,h,B){var V=!1,H=Qt,D=h.contextType;return typeof D=="object"&&D!==null?D=Bi(D):(H=In(h)?dn:zt.current,V=h.contextTypes,D=(V=V!=null)?un(I,H):Qt),h=new h(B,D),I.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=wf,I.stateNode=h,h._reactInternals=I,V&&(I=I.stateNode,I.__reactInternalMemoizedUnmaskedChildContext=H,I.__reactInternalMemoizedMaskedChildContext=D),h}function $1(I,h,B,V){I=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(B,V),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(B,V),h.state!==I&&wf.enqueueReplaceState(h,h.state,null)}function Ib(I,h,B,V){var H=I.stateNode;H.props=B,H.state=I.memoizedState,H.refs=J1,ub(I);var D=h.contextType;typeof D=="object"&&D!==null?H.context=Bi(D):(D=In(h)?dn:zt.current,H.context=un(I,D)),H.state=I.memoizedState,D=h.getDerivedStateFromProps,typeof D=="function"&&(db(I,h,D,B),H.state=I.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof H.getSnapshotBeforeUpdate=="function"||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(h=H.state,typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount(),h!==H.state&&wf.enqueueReplaceState(H,H.state,null),Sf(I,B,H,V),H.state=I.memoizedState),typeof H.componentDidMount=="function"&&(I.flags|=4194308)}var jg=[],$g=0,Zf=null,xf=0,ea=[],ta=0,yc=null,Ns=1,Fs="";function Gc(I,h){jg[$g++]=xf,jg[$g++]=Zf,Zf=I,xf=h}function q1(I,h,B){ea[ta++]=Ns,ea[ta++]=Fs,ea[ta++]=yc,yc=I;var V=Ns;I=Fs;var H=32-en(V)-1;V&=~(1<<H),B+=1;var D=32-en(h)+H;if(30<D){var ye=H-H%5;D=(V&(1<<ye)-1).toString(32),V>>=ye,H-=ye,Ns=1<<32-en(h)+H|B<<H|V,Fs=D+I}else Ns=1<<D|B<<H|V,Fs=I}function Cb(I){I.return!==null&&(Gc(I,1),q1(I,1,0))}function hb(I){for(;I===Zf;)Zf=jg[--$g],jg[$g]=null,xf=jg[--$g],jg[$g]=null;for(;I===yc;)yc=ea[--ta],ea[ta]=null,Fs=ea[--ta],ea[ta]=null,Ns=ea[--ta],ea[ta]=null}var Zo=null,xo=null,si=!1,aI=!1,Za=null;function ex(I,h){var B=oa(5,null,null,0);B.elementType="DELETED",B.stateNode=h,B.return=I,h=I.deletions,h===null?(I.deletions=[B],I.flags|=16):h.push(B)}function tx(I,h){switch(I.tag){case 5:return h=Tt(h,I.type,I.pendingProps),h!==null?(I.stateNode=h,Zo=I,xo=St(h),!0):!1;case 6:return h=Ft(h,I.pendingProps),h!==null?(I.stateNode=h,Zo=I,xo=null,!0):!1;case 13:if(h=ft(h),h!==null){var B=yc!==null?{id:Ns,overflow:Fs}:null;return I.memoizedState={dehydrated:h,treeContext:B,retryLane:1073741824},B=oa(18,null,null,0),B.stateNode=h,B.return=I,I.child=B,Zo=I,xo=null,!0}return!1;default:return!1}}function fb(I){return(I.mode&1)!==0&&(I.flags&128)===0}function mb(I){if(si){var h=xo;if(h){var B=h;if(!tx(I,h)){if(fb(I))throw Error(a(418));h=Yt(B);var V=Zo;h&&tx(I,h)?ex(V,B):(I.flags=I.flags&-4097|2,si=!1,Zo=I)}}else{if(fb(I))throw Error(a(418));I.flags=I.flags&-4097|2,si=!1,Zo=I}}}function nx(I){for(I=I.return;I!==null&&I.tag!==5&&I.tag!==3&&I.tag!==13;)I=I.return;Zo=I}function sI(I){if(!Ge||I!==Zo)return!1;if(!si)return nx(I),si=!0,!1;if(I.tag!==3&&(I.tag!==5||xe(I.type)&&!$(I.type,I.memoizedProps))){var h=xo;if(h){if(fb(I)){for(I=xo;I;)I=Yt(I);throw Error(a(418))}for(;h;)ex(I,h),h=Yt(h)}}if(nx(I),I.tag===13){if(!Ge)throw Error(a(316));if(I=I.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(a(317));xo=_(I)}else xo=Zo?Yt(I.stateNode):null;return!0}function qg(){Ge&&(xo=Zo=null,aI=si=!1)}function Ab(I){Za===null?Za=[I]:Za.push(I)}function lI(I,h,B){if(I=B.ref,I!==null&&typeof I!="function"&&typeof I!="object"){if(B._owner){if(B=B._owner,B){if(B.tag!==1)throw Error(a(309));var V=B.stateNode}if(!V)throw Error(a(147,I));var H=V,D=""+I;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===D?h.ref:(h=function(ye){var Ke=H.refs;Ke===J1&&(Ke=H.refs={}),ye===null?delete Ke[D]:Ke[D]=ye},h._stringRef=D,h)}if(typeof I!="string")throw Error(a(284));if(!B._owner)throw Error(a(290,I))}return I}function Rf(I,h){throw I=Object.prototype.toString.call(h),Error(a(31,I==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":I))}function ix(I){var h=I._init;return h(I._payload)}function rx(I){function h(tt,ke){if(I){var it=tt.deletions;it===null?(tt.deletions=[ke],tt.flags|=16):it.push(ke)}}function B(tt,ke){if(!I)return null;for(;ke!==null;)h(tt,ke),ke=ke.sibling;return null}function V(tt,ke){for(tt=new Map;ke!==null;)ke.key!==null?tt.set(ke.key,ke):tt.set(ke.index,ke),ke=ke.sibling;return tt}function H(tt,ke){return tt=Gl(tt,ke),tt.index=0,tt.sibling=null,tt}function D(tt,ke,it){return tt.index=it,I?(it=tt.alternate,it!==null?(it=it.index,it<ke?(tt.flags|=2,ke):it):(tt.flags|=2,ke)):(tt.flags|=1048576,ke)}function ye(tt){return I&&tt.alternate===null&&(tt.flags|=2),tt}function Ke(tt,ke,it,Dt){return ke===null||ke.tag!==6?(ke=ty(it,tt.mode,Dt),ke.return=tt,ke):(ke=H(ke,it),ke.return=tt,ke)}function at(tt,ke,it,Dt){var nn=it.type;return nn===g?$t(tt,ke,it.props.children,Dt,it.key):ke!==null&&(ke.elementType===nn||typeof nn=="object"&&nn!==null&&nn.$$typeof===b&&ix(nn)===ke.type)?(Dt=H(ke,it.props),Dt.ref=lI(tt,ke,it),Dt.return=tt,Dt):(Dt=am(it.type,it.key,it.props,null,tt.mode,Dt),Dt.ref=lI(tt,ke,it),Dt.return=tt,Dt)}function Mt(tt,ke,it,Dt){return ke===null||ke.tag!==4||ke.stateNode.containerInfo!==it.containerInfo||ke.stateNode.implementation!==it.implementation?(ke=ny(it,tt.mode,Dt),ke.return=tt,ke):(ke=H(ke,it.children||[]),ke.return=tt,ke)}function $t(tt,ke,it,Dt,nn){return ke===null||ke.tag!==7?(ke=Wc(it,tt.mode,Dt,nn),ke.return=tt,ke):(ke=H(ke,it),ke.return=tt,ke)}function hn(tt,ke,it){if(typeof ke=="string"&&ke!==""||typeof ke=="number")return ke=ty(""+ke,tt.mode,it),ke.return=tt,ke;if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case l:return it=am(ke.type,ke.key,ke.props,null,tt.mode,it),it.ref=lI(tt,null,ke),it.return=tt,it;case c:return ke=ny(ke,tt.mode,it),ke.return=tt,ke;case b:var Dt=ke._init;return hn(tt,Dt(ke._payload),it)}if(Q(ke)||S(ke))return ke=Wc(ke,tt.mode,it,null),ke.return=tt,ke;Rf(tt,ke)}return null}function cn(tt,ke,it,Dt){var nn=ke!==null?ke.key:null;if(typeof it=="string"&&it!==""||typeof it=="number")return nn!==null?null:Ke(tt,ke,""+it,Dt);if(typeof it=="object"&&it!==null){switch(it.$$typeof){case l:return it.key===nn?at(tt,ke,it,Dt):null;case c:return it.key===nn?Mt(tt,ke,it,Dt):null;case b:return nn=it._init,cn(tt,ke,nn(it._payload),Dt)}if(Q(it)||S(it))return nn!==null?null:$t(tt,ke,it,Dt,null);Rf(tt,it)}return null}function Jn(tt,ke,it,Dt,nn){if(typeof Dt=="string"&&Dt!==""||typeof Dt=="number")return tt=tt.get(it)||null,Ke(ke,tt,""+Dt,nn);if(typeof Dt=="object"&&Dt!==null){switch(Dt.$$typeof){case l:return tt=tt.get(Dt.key===null?it:Dt.key)||null,at(ke,tt,Dt,nn);case c:return tt=tt.get(Dt.key===null?it:Dt.key)||null,Mt(ke,tt,Dt,nn);case b:var Bn=Dt._init;return Jn(tt,ke,it,Bn(Dt._payload),nn)}if(Q(Dt)||S(Dt))return tt=tt.get(it)||null,$t(ke,tt,Dt,nn,null);Rf(ke,Dt)}return null}function an(tt,ke,it,Dt){for(var nn=null,Bn=null,fn=ke,Xn=ke=0,qi=null;fn!==null&&Xn<it.length;Xn++){fn.index>Xn?(qi=fn,fn=null):qi=fn.sibling;var En=cn(tt,fn,it[Xn],Dt);if(En===null){fn===null&&(fn=qi);break}I&&fn&&En.alternate===null&&h(tt,fn),ke=D(En,ke,Xn),Bn===null?nn=En:Bn.sibling=En,Bn=En,fn=qi}if(Xn===it.length)return B(tt,fn),si&&Gc(tt,Xn),nn;if(fn===null){for(;Xn<it.length;Xn++)fn=hn(tt,it[Xn],Dt),fn!==null&&(ke=D(fn,ke,Xn),Bn===null?nn=fn:Bn.sibling=fn,Bn=fn);return si&&Gc(tt,Xn),nn}for(fn=V(tt,fn);Xn<it.length;Xn++)qi=Jn(fn,tt,Xn,it[Xn],Dt),qi!==null&&(I&&qi.alternate!==null&&fn.delete(qi.key===null?Xn:qi.key),ke=D(qi,ke,Xn),Bn===null?nn=qi:Bn.sibling=qi,Bn=qi);return I&&fn.forEach(function(Bl){return h(tt,Bl)}),si&&Gc(tt,Xn),nn}function Gr(tt,ke,it,Dt){var nn=S(it);if(typeof nn!="function")throw Error(a(150));if(it=nn.call(it),it==null)throw Error(a(151));for(var Bn=nn=null,fn=ke,Xn=ke=0,qi=null,En=it.next();fn!==null&&!En.done;Xn++,En=it.next()){fn.index>Xn?(qi=fn,fn=null):qi=fn.sibling;var Bl=cn(tt,fn,En.value,Dt);if(Bl===null){fn===null&&(fn=qi);break}I&&fn&&Bl.alternate===null&&h(tt,fn),ke=D(Bl,ke,Xn),Bn===null?nn=Bl:Bn.sibling=Bl,Bn=Bl,fn=qi}if(En.done)return B(tt,fn),si&&Gc(tt,Xn),nn;if(fn===null){for(;!En.done;Xn++,En=it.next())En=hn(tt,En.value,Dt),En!==null&&(ke=D(En,ke,Xn),Bn===null?nn=En:Bn.sibling=En,Bn=En);return si&&Gc(tt,Xn),nn}for(fn=V(tt,fn);!En.done;Xn++,En=it.next())En=Jn(fn,tt,Xn,En.value,Dt),En!==null&&(I&&En.alternate!==null&&fn.delete(En.key===null?Xn:En.key),ke=D(En,ke,Xn),Bn===null?nn=En:Bn.sibling=En,Bn=En);return I&&fn.forEach(function(dT){return h(tt,dT)}),si&&Gc(tt,Xn),nn}function aa(tt,ke,it,Dt){if(typeof it=="object"&&it!==null&&it.type===g&&it.key===null&&(it=it.props.children),typeof it=="object"&&it!==null){switch(it.$$typeof){case l:e:{for(var nn=it.key,Bn=ke;Bn!==null;){if(Bn.key===nn){if(nn=it.type,nn===g){if(Bn.tag===7){B(tt,Bn.sibling),ke=H(Bn,it.props.children),ke.return=tt,tt=ke;break e}}else if(Bn.elementType===nn||typeof nn=="object"&&nn!==null&&nn.$$typeof===b&&ix(nn)===Bn.type){B(tt,Bn.sibling),ke=H(Bn,it.props),ke.ref=lI(tt,Bn,it),ke.return=tt,tt=ke;break e}B(tt,Bn);break}else h(tt,Bn);Bn=Bn.sibling}it.type===g?(ke=Wc(it.props.children,tt.mode,Dt,it.key),ke.return=tt,tt=ke):(Dt=am(it.type,it.key,it.props,null,tt.mode,Dt),Dt.ref=lI(tt,ke,it),Dt.return=tt,tt=Dt)}return ye(tt);case c:e:{for(Bn=it.key;ke!==null;){if(ke.key===Bn)if(ke.tag===4&&ke.stateNode.containerInfo===it.containerInfo&&ke.stateNode.implementation===it.implementation){B(tt,ke.sibling),ke=H(ke,it.children||[]),ke.return=tt,tt=ke;break e}else{B(tt,ke);break}else h(tt,ke);ke=ke.sibling}ke=ny(it,tt.mode,Dt),ke.return=tt,tt=ke}return ye(tt);case b:return Bn=it._init,aa(tt,ke,Bn(it._payload),Dt)}if(Q(it))return an(tt,ke,it,Dt);if(S(it))return Gr(tt,ke,it,Dt);Rf(tt,it)}return typeof it=="string"&&it!==""||typeof it=="number"?(it=""+it,ke!==null&&ke.tag===6?(B(tt,ke.sibling),ke=H(ke,it),ke.return=tt,tt=ke):(B(tt,ke),ke=ty(it,tt.mode,Dt),ke.return=tt,tt=ke),ye(tt)):B(tt,ke)}return aa}var eu=rx(!0),ox=rx(!1),cI={},na=Wt(cI),gI=Wt(cI),tu=Wt(cI);function os(I){if(I===cI)throw Error(a(174));return I}function pb(I,h){ht(tu,h),ht(gI,I),ht(na,cI),I=J(h),yt(na),ht(na,I)}function nu(){yt(na),yt(gI),yt(tu)}function ax(I){var h=os(tu.current),B=os(na.current);h=F(B,I.type,h),B!==h&&(ht(gI,I),ht(na,h))}function vb(I){gI.current===I&&(yt(na),yt(gI))}var di=Wt(0);function Wf(I){for(var h=I;h!==null;){if(h.tag===13){var B=h.memoizedState;if(B!==null&&(B=B.dehydrated,B===null||At(B)||Gt(B)))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if(h.flags&128)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===I)break;for(;h.sibling===null;){if(h.return===null||h.return===I)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var bb=[];function yb(){for(var I=0;I<bb.length;I++){var h=bb[I];Se?h._workInProgressVersionPrimary=null:h._workInProgressVersionSecondary=null}bb.length=0}var Vf=s.ReactCurrentDispatcher,ia=s.ReactCurrentBatchConfig,iu=0,pi=null,vr=null,$i=null,Mf=!1,uI=!1,dI=0,EL=0;function br(){throw Error(a(321))}function Gb(I,h){if(h===null)return!1;for(var B=0;B<h.length&&B<I.length;B++)if(!So(I[B],h[B]))return!1;return!0}function Bb(I,h,B,V,H,D){if(iu=D,pi=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,Vf.current=I===null||I.memoizedState===null?LL:TL,I=B(V,H),uI){D=0;do{if(uI=!1,dI=0,25<=D)throw Error(a(301));D+=1,$i=vr=null,h.updateQueue=null,Vf.current=_L,I=B(V,H)}while(uI)}if(Vf.current=Ef,h=vr!==null&&vr.next!==null,iu=0,$i=vr=pi=null,Mf=!1,h)throw Error(a(300));return I}function Sb(){var I=dI!==0;return dI=0,I}function Hs(){var I={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $i===null?pi.memoizedState=$i=I:$i=$i.next=I,$i}function as(){if(vr===null){var I=pi.alternate;I=I!==null?I.memoizedState:null}else I=vr.next;var h=$i===null?pi.memoizedState:$i.next;if(h!==null)$i=h,vr=I;else{if(I===null)throw Error(a(310));vr=I,I={memoizedState:vr.memoizedState,baseState:vr.baseState,baseQueue:vr.baseQueue,queue:vr.queue,next:null},$i===null?pi.memoizedState=$i=I:$i=$i.next=I}return $i}function Bc(I,h){return typeof h=="function"?h(I):h}function Nf(I){var h=as(),B=h.queue;if(B===null)throw Error(a(311));B.lastRenderedReducer=I;var V=vr,H=V.baseQueue,D=B.pending;if(D!==null){if(H!==null){var ye=H.next;H.next=D.next,D.next=ye}V.baseQueue=H=D,B.pending=null}if(H!==null){D=H.next,V=V.baseState;var Ke=ye=null,at=null,Mt=D;do{var $t=Mt.lane;if((iu&$t)===$t)at!==null&&(at=at.next={lane:0,action:Mt.action,hasEagerState:Mt.hasEagerState,eagerState:Mt.eagerState,next:null}),V=Mt.hasEagerState?Mt.eagerState:I(V,Mt.action);else{var hn={lane:$t,action:Mt.action,hasEagerState:Mt.hasEagerState,eagerState:Mt.eagerState,next:null};at===null?(Ke=at=hn,ye=V):at=at.next=hn,pi.lanes|=$t,ou|=$t}Mt=Mt.next}while(Mt!==null&&Mt!==D);at===null?ye=V:at.next=Ke,So(V,h.memoizedState)||(Ro=!0),h.memoizedState=V,h.baseState=ye,h.baseQueue=at,B.lastRenderedState=V}if(I=B.interleaved,I!==null){H=I;do D=H.lane,pi.lanes|=D,ou|=D,H=H.next;while(H!==I)}else H===null&&(B.lanes=0);return[h.memoizedState,B.dispatch]}function Ff(I){var h=as(),B=h.queue;if(B===null)throw Error(a(311));B.lastRenderedReducer=I;var V=B.dispatch,H=B.pending,D=h.memoizedState;if(H!==null){B.pending=null;var ye=H=H.next;do D=I(D,ye.action),ye=ye.next;while(ye!==H);So(D,h.memoizedState)||(Ro=!0),h.memoizedState=D,h.baseQueue===null&&(h.baseState=D),B.lastRenderedState=D}return[D,V]}function sx(){}function lx(I,h){var B=pi,V=as(),H=h(),D=!So(V.memoizedState,H);if(D&&(V.memoizedState=H,Ro=!0),V=V.queue,CI(ux.bind(null,B,V,I),[I]),V.getSnapshot!==h||D||$i!==null&&$i.memoizedState.tag&1){if(B.flags|=2048,II(9,gx.bind(null,B,V,H,h),void 0,null),Mi===null)throw Error(a(349));iu&30||cx(B,h,H)}return H}function cx(I,h,B){I.flags|=16384,I={getSnapshot:h,value:B},h=pi.updateQueue,h===null?(h={lastEffect:null,stores:null},pi.updateQueue=h,h.stores=[I]):(B=h.stores,B===null?h.stores=[I]:B.push(I))}function gx(I,h,B,V){h.value=B,h.getSnapshot=V,dx(h)&&ra(I,1,-1)}function ux(I,h,B){return B(function(){dx(h)&&ra(I,1,-1)})}function dx(I){var h=I.getSnapshot;I=I.value;try{var B=h();return!So(I,B)}catch{return!0}}function wb(I){var h=Hs();return typeof I=="function"&&(I=I()),h.memoizedState=h.baseState=I,I={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bc,lastRenderedState:I},h.queue=I,I=I.dispatch=KL.bind(null,pi,I),[h.memoizedState,I]}function II(I,h,B,V){return I={tag:I,create:h,destroy:B,deps:V,next:null},h=pi.updateQueue,h===null?(h={lastEffect:null,stores:null},pi.updateQueue=h,h.lastEffect=I.next=I):(B=h.lastEffect,B===null?h.lastEffect=I.next=I:(V=B.next,B.next=I,I.next=V,h.lastEffect=I)),I}function Ix(){return as().memoizedState}function Hf(I,h,B,V){var H=Hs();pi.flags|=I,H.memoizedState=II(1|h,B,void 0,V===void 0?null:V)}function Xf(I,h,B,V){var H=as();V=V===void 0?null:V;var D=void 0;if(vr!==null){var ye=vr.memoizedState;if(D=ye.destroy,V!==null&&Gb(V,ye.deps)){H.memoizedState=II(h,B,D,V);return}}pi.flags|=I,H.memoizedState=II(1|h,B,D,V)}function Zb(I,h){return Hf(8390656,8,I,h)}function CI(I,h){return Xf(2048,8,I,h)}function Cx(I,h){return Xf(4,2,I,h)}function hx(I,h){return Xf(4,4,I,h)}function fx(I,h){if(typeof h=="function")return I=I(),h(I),function(){h(null)};if(h!=null)return I=I(),h.current=I,function(){h.current=null}}function mx(I,h,B){return B=B!=null?B.concat([I]):null,Xf(4,4,fx.bind(null,h,I),B)}function xb(){}function Ax(I,h){var B=as();h=h===void 0?null:h;var V=B.memoizedState;return V!==null&&h!==null&&Gb(h,V[1])?V[0]:(B.memoizedState=[I,h],I)}function px(I,h){var B=as();h=h===void 0?null:h;var V=B.memoizedState;return V!==null&&h!==null&&Gb(h,V[1])?V[0]:(I=I(),B.memoizedState=[I,h],I)}function YL(I,h){var B=Cn;Cn=B!==0&&4>B?B:4,I(!0);var V=ia.transition;ia.transition={};try{I(!1),h()}finally{Cn=B,ia.transition=V}}function vx(){return as().memoizedState}function zL(I,h,B){var V=bl(I);B={lane:V,action:B,hasEagerState:!1,eagerState:null,next:null},bx(I)?yx(h,B):(Gx(I,h,B),B=_r(),I=ra(I,V,B),I!==null&&Bx(I,h,V))}function KL(I,h,B){var V=bl(I),H={lane:V,action:B,hasEagerState:!1,eagerState:null,next:null};if(bx(I))yx(h,H);else{Gx(I,h,H);var D=I.alternate;if(I.lanes===0&&(D===null||D.lanes===0)&&(D=h.lastRenderedReducer,D!==null))try{var ye=h.lastRenderedState,Ke=D(ye,B);if(H.hasEagerState=!0,H.eagerState=Ke,So(Ke,ye))return}catch{}finally{}B=_r(),I=ra(I,V,B),I!==null&&Bx(I,h,V)}}function bx(I){var h=I.alternate;return I===pi||h!==null&&h===pi}function yx(I,h){uI=Mf=!0;var B=I.pending;B===null?h.next=h:(h.next=B.next,B.next=h),I.pending=h}function Gx(I,h,B){Mi!==null&&I.mode&1&&!(wn&2)?(I=h.interleaved,I===null?(B.next=B,wo===null?wo=[h]:wo.push(h)):(B.next=I.next,I.next=B),h.interleaved=B):(I=h.pending,I===null?B.next=B:(B.next=I.next,I.next=B),h.pending=B)}function Bx(I,h,B){if(B&4194240){var V=h.lanes;V&=I.pendingLanes,B|=V,h.lanes=B,Ji(I,B)}}var Ef={readContext:Bi,useCallback:br,useContext:br,useEffect:br,useImperativeHandle:br,useInsertionEffect:br,useLayoutEffect:br,useMemo:br,useReducer:br,useRef:br,useState:br,useDebugValue:br,useDeferredValue:br,useTransition:br,useMutableSource:br,useSyncExternalStore:br,useId:br,unstable_isNewReconciler:!1},LL={readContext:Bi,useCallback:function(I,h){return Hs().memoizedState=[I,h===void 0?null:h],I},useContext:Bi,useEffect:Zb,useImperativeHandle:function(I,h,B){return B=B!=null?B.concat([I]):null,Hf(4194308,4,fx.bind(null,h,I),B)},useLayoutEffect:function(I,h){return Hf(4194308,4,I,h)},useInsertionEffect:function(I,h){return Hf(4,2,I,h)},useMemo:function(I,h){var B=Hs();return h=h===void 0?null:h,I=I(),B.memoizedState=[I,h],I},useReducer:function(I,h,B){var V=Hs();return h=B!==void 0?B(h):h,V.memoizedState=V.baseState=h,I={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:I,lastRenderedState:h},V.queue=I,I=I.dispatch=zL.bind(null,pi,I),[V.memoizedState,I]},useRef:function(I){var h=Hs();return I={current:I},h.memoizedState=I},useState:wb,useDebugValue:xb,useDeferredValue:function(I){var h=wb(I),B=h[0],V=h[1];return Zb(function(){var H=ia.transition;ia.transition={};try{V(I)}finally{ia.transition=H}},[I]),B},useTransition:function(){var I=wb(!1),h=I[0];return I=YL.bind(null,I[1]),Hs().memoizedState=I,[h,I]},useMutableSource:function(){},useSyncExternalStore:function(I,h,B){var V=pi,H=Hs();if(si){if(B===void 0)throw Error(a(407));B=B()}else{if(B=h(),Mi===null)throw Error(a(349));iu&30||cx(V,h,B)}H.memoizedState=B;var D={value:B,getSnapshot:h};return H.queue=D,Zb(ux.bind(null,V,D,I),[I]),V.flags|=2048,II(9,gx.bind(null,V,D,B,h),void 0,null),B},useId:function(){var I=Hs(),h=Mi.identifierPrefix;if(si){var B=Fs,V=Ns;B=(V&~(1<<32-en(V)-1)).toString(32)+B,h=":"+h+"R"+B,B=dI++,0<B&&(h+="H"+B.toString(32)),h+=":"}else B=EL++,h=":"+h+"r"+B.toString(32)+":";return I.memoizedState=h},unstable_isNewReconciler:!1},TL={readContext:Bi,useCallback:Ax,useContext:Bi,useEffect:CI,useImperativeHandle:mx,useInsertionEffect:Cx,useLayoutEffect:hx,useMemo:px,useReducer:Nf,useRef:Ix,useState:function(){return Nf(Bc)},useDebugValue:xb,useDeferredValue:function(I){var h=Nf(Bc),B=h[0],V=h[1];return CI(function(){var H=ia.transition;ia.transition={};try{V(I)}finally{ia.transition=H}},[I]),B},useTransition:function(){var I=Nf(Bc)[0],h=as().memoizedState;return[I,h]},useMutableSource:sx,useSyncExternalStore:lx,useId:vx,unstable_isNewReconciler:!1},_L={readContext:Bi,useCallback:Ax,useContext:Bi,useEffect:CI,useImperativeHandle:mx,useInsertionEffect:Cx,useLayoutEffect:hx,useMemo:px,useReducer:Ff,useRef:Ix,useState:function(){return Ff(Bc)},useDebugValue:xb,useDeferredValue:function(I){var h=Ff(Bc),B=h[0],V=h[1];return CI(function(){var H=ia.transition;ia.transition={};try{V(I)}finally{ia.transition=H}},[I]),B},useTransition:function(){var I=Ff(Bc)[0],h=as().memoizedState;return[I,h]},useMutableSource:sx,useSyncExternalStore:lx,useId:vx,unstable_isNewReconciler:!1};function Rb(I,h){try{var B="",V=h;do B+=bc(V),V=V.return;while(V);var H=B}catch(D){H=`
Error generating stack: `+D.message+`
`+D.stack}return{value:I,source:h,stack:H}}function Wb(I,h){try{console.error(h.value)}catch(B){setTimeout(function(){throw B})}}var kL=typeof WeakMap=="function"?WeakMap:Map;function Sx(I,h,B){B=Ms(-1,B),B.tag=3,B.payload={element:null};var V=h.value;return B.callback=function(){qf||(qf=!0,Ob=V),Wb(I,h)},B}function wx(I,h,B){B=Ms(-1,B),B.tag=3;var V=I.type.getDerivedStateFromError;if(typeof V=="function"){var H=h.value;B.payload=function(){return V(H)},B.callback=function(){Wb(I,h)}}var D=I.stateNode;return D!==null&&typeof D.componentDidCatch=="function"&&(B.callback=function(){Wb(I,h),typeof V!="function"&&(pl===null?pl=new Set([this]):pl.add(this));var ye=h.stack;this.componentDidCatch(h.value,{componentStack:ye!==null?ye:""})}),B}function Zx(I,h,B){var V=I.pingCache;if(V===null){V=I.pingCache=new kL;var H=new Set;V.set(h,H)}else H=V.get(h),H===void 0&&(H=new Set,V.set(h,H));H.has(B)||(H.add(B),I=rT.bind(null,I,h,B),h.then(I,I))}function xx(I){do{var h;if((h=I.tag===13)&&(h=I.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return I;I=I.return}while(I!==null);return null}function Rx(I,h,B,V,H){return I.mode&1?(I.flags|=65536,I.lanes=H,I):(I===h?I.flags|=65536:(I.flags|=128,B.flags|=131072,B.flags&=-52805,B.tag===1&&(B.alternate===null?B.tag=17:(h=Ms(-1,1),h.tag=2,Al(B,h))),B.lanes|=1),I)}function ss(I){I.flags|=4}function Wx(I,h){if(I!==null&&I.child===h.child)return!0;if(h.flags&16)return!1;for(I=h.child;I!==null;){if(I.flags&12854||I.subtreeFlags&12854)return!1;I=I.sibling}return!0}var hI,fI,Yf,zf;if(me)hI=function(I,h){for(var B=h.child;B!==null;){if(B.tag===5||B.tag===6)O(I,B.stateNode);else if(B.tag!==4&&B.child!==null){B.child.return=B,B=B.child;continue}if(B===h)break;for(;B.sibling===null;){if(B.return===null||B.return===h)return;B=B.return}B.sibling.return=B.return,B=B.sibling}},fI=function(){},Yf=function(I,h,B,V,H){if(I=I.memoizedProps,I!==V){var D=h.stateNode,ye=os(na.current);B=P(D,B,I,V,H,ye),(h.updateQueue=B)&&ss(h)}},zf=function(I,h,B,V){B!==V&&ss(h)};else if(T){hI=function(I,h,B,V){for(var H=h.child;H!==null;){if(H.tag===5){var D=H.stateNode;B&&V&&(D=rt(D,H.type,H.memoizedProps,H)),O(I,D)}else if(H.tag===6)D=H.stateNode,B&&V&&(D=ut(D,H.memoizedProps,H)),O(I,D);else if(H.tag!==4){if(H.tag===22&&H.memoizedState!==null)D=H.child,D!==null&&(D.return=H),hI(I,H,!0,!0);else if(H.child!==null){H.child.return=H,H=H.child;continue}}if(H===h)break;for(;H.sibling===null;){if(H.return===null||H.return===h)return;H=H.return}H.sibling.return=H.return,H=H.sibling}};var Vx=function(I,h,B,V){for(var H=h.child;H!==null;){if(H.tag===5){var D=H.stateNode;B&&V&&(D=rt(D,H.type,H.memoizedProps,H)),Vt(I,D)}else if(H.tag===6)D=H.stateNode,B&&V&&(D=ut(D,H.memoizedProps,H)),Vt(I,D);else if(H.tag!==4){if(H.tag===22&&H.memoizedState!==null)D=H.child,D!==null&&(D.return=H),Vx(I,H,!0,!0);else if(H.child!==null){H.child.return=H,H=H.child;continue}}if(H===h)break;for(;H.sibling===null;){if(H.return===null||H.return===h)return;H=H.return}H.sibling.return=H.return,H=H.sibling}};fI=function(I,h){var B=h.stateNode;if(!Wx(I,h)){I=B.containerInfo;var V=It(I);Vx(V,h,!1,!1),B.pendingChildren=V,ss(h),vt(I,V)}},Yf=function(I,h,B,V,H){var D=I.stateNode,ye=I.memoizedProps;if((I=Wx(I,h))&&ye===V)h.stateNode=D;else{var Ke=h.stateNode,at=os(na.current),Mt=null;ye!==V&&(Mt=P(Ke,B,ye,V,H,at)),I&&Mt===null?h.stateNode=D:(D=dt(D,Mt,B,ye,V,h,I,Ke),j(D,B,V,H,at)&&ss(h),h.stateNode=D,I?ss(h):hI(D,h,!1,!1))}},zf=function(I,h,B,V){B!==V?(I=os(tu.current),B=os(na.current),h.stateNode=oe(V,I,B,h),ss(h)):h.stateNode=I.stateNode}}else fI=function(){},Yf=function(){},zf=function(){};function mI(I,h){if(!si)switch(I.tailMode){case"hidden":h=I.tail;for(var B=null;h!==null;)h.alternate!==null&&(B=h),h=h.sibling;B===null?I.tail=null:B.sibling=null;break;case"collapsed":B=I.tail;for(var V=null;B!==null;)B.alternate!==null&&(V=B),B=B.sibling;V===null?h||I.tail===null?I.tail=null:I.tail.sibling=null:V.sibling=null}}function yr(I){var h=I.alternate!==null&&I.alternate.child===I.child,B=0,V=0;if(h)for(var H=I.child;H!==null;)B|=H.lanes|H.childLanes,V|=H.subtreeFlags&14680064,V|=H.flags&14680064,H.return=I,H=H.sibling;else for(H=I.child;H!==null;)B|=H.lanes|H.childLanes,V|=H.subtreeFlags,V|=H.flags,H.return=I,H=H.sibling;return I.subtreeFlags|=V,I.childLanes=B,h}function PL(I,h,B){var V=h.pendingProps;switch(hb(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yr(h),null;case 1:return In(h.type)&&Ht(),yr(h),null;case 3:return V=h.stateNode,nu(),yt(Pt),yt(zt),yb(),V.pendingContext&&(V.context=V.pendingContext,V.pendingContext=null),(I===null||I.child===null)&&(sI(h)?ss(h):I===null||I.memoizedState.isDehydrated&&!(h.flags&256)||(h.flags|=1024,Za!==null&&(jb(Za),Za=null))),fI(I,h),yr(h),null;case 5:vb(h),B=os(tu.current);var H=h.type;if(I!==null&&h.stateNode!=null)Yf(I,h,H,V,B),I.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!V){if(h.stateNode===null)throw Error(a(166));return yr(h),null}if(I=os(na.current),sI(h)){if(!Ge)throw Error(a(175));I=U(h.stateNode,h.type,h.memoizedProps,B,I,h,!aI),h.updateQueue=I,I!==null&&ss(h)}else{var D=K(H,V,B,I,h);hI(D,h,!1,!1),h.stateNode=D,j(D,H,V,B,I)&&ss(h)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return yr(h),null;case 6:if(I&&h.stateNode!=null)zf(I,h,I.memoizedProps,V);else{if(typeof V!="string"&&h.stateNode===null)throw Error(a(166));if(I=os(tu.current),B=os(na.current),sI(h)){if(!Ge)throw Error(a(176));if(I=h.stateNode,V=h.memoizedProps,(B=ee(I,V,h,!aI))&&(H=Zo,H!==null))switch(D=(H.mode&1)!==0,H.tag){case 3:Xe(H.stateNode.containerInfo,I,V,D);break;case 5:_e(H.type,H.memoizedProps,H.stateNode,I,V,D)}B&&ss(h)}else h.stateNode=oe(V,I,B,h)}return yr(h),null;case 13:if(yt(di),V=h.memoizedState,si&&xo!==null&&h.mode&1&&!(h.flags&128)){for(I=xo;I;)I=Yt(I);return qg(),h.flags|=98560,h}if(V!==null&&V.dehydrated!==null){if(V=sI(h),I===null){if(!V)throw Error(a(318));if(!Ge)throw Error(a(344));if(I=h.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(a(317));Be(I,h)}else qg(),!(h.flags&128)&&(h.memoizedState=null),h.flags|=4;return yr(h),null}return Za!==null&&(jb(Za),Za=null),h.flags&128?(h.lanes=B,h):(V=V!==null,B=!1,I===null?sI(h):B=I.memoizedState!==null,V&&!B&&(h.child.flags|=8192,h.mode&1&&(I===null||di.current&1?Ti===0&&(Ti=3):qb())),h.updateQueue!==null&&(h.flags|=4),yr(h),null);case 4:return nu(),fI(I,h),I===null&&he(h.stateNode.containerInfo),yr(h),null;case 10:return ji(h.type._context),yr(h),null;case 17:return In(h.type)&&Ht(),yr(h),null;case 19:if(yt(di),H=h.memoizedState,H===null)return yr(h),null;if(V=(h.flags&128)!==0,D=H.rendering,D===null)if(V)mI(H,!1);else{if(Ti!==0||I!==null&&I.flags&128)for(I=h.child;I!==null;){if(D=Wf(I),D!==null){for(h.flags|=128,mI(H,!1),I=D.updateQueue,I!==null&&(h.updateQueue=I,h.flags|=4),h.subtreeFlags=0,I=B,V=h.child;V!==null;)B=V,H=I,B.flags&=14680066,D=B.alternate,D===null?(B.childLanes=0,B.lanes=H,B.child=null,B.subtreeFlags=0,B.memoizedProps=null,B.memoizedState=null,B.updateQueue=null,B.dependencies=null,B.stateNode=null):(B.childLanes=D.childLanes,B.lanes=D.lanes,B.child=D.child,B.subtreeFlags=0,B.deletions=null,B.memoizedProps=D.memoizedProps,B.memoizedState=D.memoizedState,B.updateQueue=D.updateQueue,B.type=D.type,H=D.dependencies,B.dependencies=H===null?null:{lanes:H.lanes,firstContext:H.firstContext}),V=V.sibling;return ht(di,di.current&1|2),h.child}I=I.sibling}H.tail!==null&&Ut()>Db&&(h.flags|=128,V=!0,mI(H,!1),h.lanes=4194304)}else{if(!V)if(I=Wf(D),I!==null){if(h.flags|=128,V=!0,I=I.updateQueue,I!==null&&(h.updateQueue=I,h.flags|=4),mI(H,!0),H.tail===null&&H.tailMode==="hidden"&&!D.alternate&&!si)return yr(h),null}else 2*Ut()-H.renderingStartTime>Db&&B!==1073741824&&(h.flags|=128,V=!0,mI(H,!1),h.lanes=4194304);H.isBackwards?(D.sibling=h.child,h.child=D):(I=H.last,I!==null?I.sibling=D:h.child=D,H.last=D)}return H.tail!==null?(h=H.tail,H.rendering=h,H.tail=h.sibling,H.renderingStartTime=Ut(),h.sibling=null,I=di.current,ht(di,V?I&1|2:I&1),h):(yr(h),null);case 22:case 23:return $b(),V=h.memoizedState!==null,I!==null&&I.memoizedState!==null!==V&&(h.flags|=8192),V&&h.mode&1?Wo&1073741824&&(yr(h),me&&h.subtreeFlags&6&&(h.flags|=8192)):yr(h),null;case 24:return null;case 25:return null}throw Error(a(156,h.tag))}var UL=s.ReactCurrentOwner,Ro=!1;function Tr(I,h,B,V){h.child=I===null?ox(h,null,B,V):eu(h,I.child,B,V)}function Mx(I,h,B,V,H){B=B.render;var D=h.ref;return Gi(h,H),V=Bb(I,h,B,V,D,H),B=Sb(),I!==null&&!Ro?(h.updateQueue=I.updateQueue,h.flags&=-2053,I.lanes&=~H,Xs(I,h,H)):(si&&B&&Cb(h),h.flags|=1,Tr(I,h,V,H),h.child)}function Nx(I,h,B,V,H){if(I===null){var D=B.type;return typeof D=="function"&&!ey(D)&&D.defaultProps===void 0&&B.compare===null&&B.defaultProps===void 0?(h.tag=15,h.type=D,Fx(I,h,D,V,H)):(I=am(B.type,null,V,h,h.mode,H),I.ref=h.ref,I.return=h,h.child=I)}if(D=I.child,!(I.lanes&H)){var ye=D.memoizedProps;if(B=B.compare,B=B!==null?B:vc,B(ye,V)&&I.ref===h.ref)return Xs(I,h,H)}return h.flags|=1,I=Gl(D,V),I.ref=h.ref,I.return=h,h.child=I}function Fx(I,h,B,V,H){if(I!==null&&vc(I.memoizedProps,V)&&I.ref===h.ref)if(Ro=!1,(I.lanes&H)!==0)I.flags&131072&&(Ro=!0);else return h.lanes=I.lanes,Xs(I,h,H);return Vb(I,h,B,V,H)}function Hx(I,h,B){var V=h.pendingProps,H=V.children,D=I!==null?I.memoizedState:null;if(V.mode==="hidden")if(!(h.mode&1))h.memoizedState={baseLanes:0,cachePool:null},ht(ru,Wo),Wo|=B;else if(B&1073741824)h.memoizedState={baseLanes:0,cachePool:null},V=D!==null?D.baseLanes:B,ht(ru,Wo),Wo|=V;else return I=D!==null?D.baseLanes|B:B,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:I,cachePool:null},h.updateQueue=null,ht(ru,Wo),Wo|=I,null;else D!==null?(V=D.baseLanes|B,h.memoizedState=null):V=B,ht(ru,Wo),Wo|=V;return Tr(I,h,H,B),h.child}function Xx(I,h){var B=h.ref;(I===null&&B!==null||I!==null&&I.ref!==B)&&(h.flags|=512,h.flags|=2097152)}function Vb(I,h,B,V,H){var D=In(B)?dn:zt.current;return D=un(h,D),Gi(h,H),B=Bb(I,h,B,V,D,H),V=Sb(),I!==null&&!Ro?(h.updateQueue=I.updateQueue,h.flags&=-2053,I.lanes&=~H,Xs(I,h,H)):(si&&V&&Cb(h),h.flags|=1,Tr(I,h,B,H),h.child)}function Ex(I,h,B,V,H){if(In(B)){var D=!0;Rt(h)}else D=!1;if(Gi(h,H),h.stateNode===null)I!==null&&(I.alternate=null,h.alternate=null,h.flags|=2),j1(h,B,V),Ib(h,B,V,H),V=!0;else if(I===null){var ye=h.stateNode,Ke=h.memoizedProps;ye.props=Ke;var at=ye.context,Mt=B.contextType;typeof Mt=="object"&&Mt!==null?Mt=Bi(Mt):(Mt=In(B)?dn:zt.current,Mt=un(h,Mt));var $t=B.getDerivedStateFromProps,hn=typeof $t=="function"||typeof ye.getSnapshotBeforeUpdate=="function";hn||typeof ye.UNSAFE_componentWillReceiveProps!="function"&&typeof ye.componentWillReceiveProps!="function"||(Ke!==V||at!==Mt)&&$1(h,ye,V,Mt),ml=!1;var cn=h.memoizedState;ye.state=cn,Sf(h,V,ye,H),at=h.memoizedState,Ke!==V||cn!==at||Pt.current||ml?(typeof $t=="function"&&(db(h,B,$t,V),at=h.memoizedState),(Ke=ml||Q1(h,B,Ke,V,cn,at,Mt))?(hn||typeof ye.UNSAFE_componentWillMount!="function"&&typeof ye.componentWillMount!="function"||(typeof ye.componentWillMount=="function"&&ye.componentWillMount(),typeof ye.UNSAFE_componentWillMount=="function"&&ye.UNSAFE_componentWillMount()),typeof ye.componentDidMount=="function"&&(h.flags|=4194308)):(typeof ye.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=V,h.memoizedState=at),ye.props=V,ye.state=at,ye.context=Mt,V=Ke):(typeof ye.componentDidMount=="function"&&(h.flags|=4194308),V=!1)}else{ye=h.stateNode,U1(I,h),Ke=h.memoizedProps,Mt=h.type===h.elementType?Ke:Kr(h.type,Ke),ye.props=Mt,hn=h.pendingProps,cn=ye.context,at=B.contextType,typeof at=="object"&&at!==null?at=Bi(at):(at=In(B)?dn:zt.current,at=un(h,at));var Jn=B.getDerivedStateFromProps;($t=typeof Jn=="function"||typeof ye.getSnapshotBeforeUpdate=="function")||typeof ye.UNSAFE_componentWillReceiveProps!="function"&&typeof ye.componentWillReceiveProps!="function"||(Ke!==hn||cn!==at)&&$1(h,ye,V,at),ml=!1,cn=h.memoizedState,ye.state=cn,Sf(h,V,ye,H);var an=h.memoizedState;Ke!==hn||cn!==an||Pt.current||ml?(typeof Jn=="function"&&(db(h,B,Jn,V),an=h.memoizedState),(Mt=ml||Q1(h,B,Mt,V,cn,an,at)||!1)?($t||typeof ye.UNSAFE_componentWillUpdate!="function"&&typeof ye.componentWillUpdate!="function"||(typeof ye.componentWillUpdate=="function"&&ye.componentWillUpdate(V,an,at),typeof ye.UNSAFE_componentWillUpdate=="function"&&ye.UNSAFE_componentWillUpdate(V,an,at)),typeof ye.componentDidUpdate=="function"&&(h.flags|=4),typeof ye.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof ye.componentDidUpdate!="function"||Ke===I.memoizedProps&&cn===I.memoizedState||(h.flags|=4),typeof ye.getSnapshotBeforeUpdate!="function"||Ke===I.memoizedProps&&cn===I.memoizedState||(h.flags|=1024),h.memoizedProps=V,h.memoizedState=an),ye.props=V,ye.state=an,ye.context=at,V=Mt):(typeof ye.componentDidUpdate!="function"||Ke===I.memoizedProps&&cn===I.memoizedState||(h.flags|=4),typeof ye.getSnapshotBeforeUpdate!="function"||Ke===I.memoizedProps&&cn===I.memoizedState||(h.flags|=1024),V=!1)}return Mb(I,h,B,V,D,H)}function Mb(I,h,B,V,H,D){Xx(I,h);var ye=(h.flags&128)!==0;if(!V&&!ye)return H&&Xt(h,B,!1),Xs(I,h,D);V=h.stateNode,UL.current=h;var Ke=ye&&typeof B.getDerivedStateFromError!="function"?null:V.render();return h.flags|=1,I!==null&&ye?(h.child=eu(h,I.child,null,D),h.child=eu(h,null,Ke,D)):Tr(I,h,Ke,D),h.memoizedState=V.state,H&&Xt(h,B,!0),h.child}function Yx(I){var h=I.stateNode;h.pendingContext?mt(I,h.pendingContext,h.pendingContext!==h.context):h.context&&mt(I,h.context,!1),pb(I,h.containerInfo)}function zx(I,h,B,V,H){return qg(),Ab(H),h.flags|=256,Tr(I,h,B,V),h.child}var Kf={dehydrated:null,treeContext:null,retryLane:0};function Lf(I){return{baseLanes:I,cachePool:null}}function Kx(I,h,B){var V=h.pendingProps,H=di.current,D=!1,ye=(h.flags&128)!==0,Ke;if((Ke=ye)||(Ke=I!==null&&I.memoizedState===null?!1:(H&2)!==0),Ke?(D=!0,h.flags&=-129):(I===null||I.memoizedState!==null)&&(H|=1),ht(di,H&1),I===null)return mb(h),I=h.memoizedState,I!==null&&(I=I.dehydrated,I!==null)?(h.mode&1?Gt(I)?h.lanes=8:h.lanes=1073741824:h.lanes=1,null):(H=V.children,I=V.fallback,D?(V=h.mode,D=h.child,H={mode:"hidden",children:H},!(V&1)&&D!==null?(D.childLanes=0,D.pendingProps=H):D=sm(H,V,0,null),I=Wc(I,V,B,null),D.return=h,I.return=h,D.sibling=I,h.child=D,h.child.memoizedState=Lf(B),h.memoizedState=Kf,I):Nb(h,H));if(H=I.memoizedState,H!==null){if(Ke=H.dehydrated,Ke!==null){if(ye)return h.flags&256?(h.flags&=-257,Tf(I,h,B,Error(a(422)))):h.memoizedState!==null?(h.child=I.child,h.flags|=128,null):(D=V.fallback,H=h.mode,V=sm({mode:"visible",children:V.children},H,0,null),D=Wc(D,H,B,null),D.flags|=2,V.return=h,D.return=h,V.sibling=D,h.child=V,h.mode&1&&eu(h,I.child,null,B),h.child.memoizedState=Lf(B),h.memoizedState=Kf,D);if(!(h.mode&1))h=Tf(I,h,B,null);else if(Gt(Ke))h=Tf(I,h,B,Error(a(419)));else if(V=(B&I.childLanes)!==0,Ro||V){if(V=Mi,V!==null){switch(B&-B){case 4:D=2;break;case 16:D=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:D=32;break;case 536870912:D=268435456;break;default:D=0}V=D&(V.suspendedLanes|B)?0:D,V!==0&&V!==H.retryLane&&(H.retryLane=V,ra(I,V,-1))}qb(),h=Tf(I,h,B,Error(a(421)))}else At(Ke)?(h.flags|=128,h.child=I.child,h=oT.bind(null,I),Bt(Ke,h),h=null):(B=H.treeContext,Ge&&(xo=Ot(Ke),Zo=h,si=!0,Za=null,aI=!1,B!==null&&(ea[ta++]=Ns,ea[ta++]=Fs,ea[ta++]=yc,Ns=B.id,Fs=B.overflow,yc=h)),h=Nb(h,h.pendingProps.children),h.flags|=4096);return h}return D?(V=Tx(I,h,V.children,V.fallback,B),D=h.child,H=I.child.memoizedState,D.memoizedState=H===null?Lf(B):{baseLanes:H.baseLanes|B,cachePool:null},D.childLanes=I.childLanes&~B,h.memoizedState=Kf,V):(B=Lx(I,h,V.children,B),h.memoizedState=null,B)}return D?(V=Tx(I,h,V.children,V.fallback,B),D=h.child,H=I.child.memoizedState,D.memoizedState=H===null?Lf(B):{baseLanes:H.baseLanes|B,cachePool:null},D.childLanes=I.childLanes&~B,h.memoizedState=Kf,V):(B=Lx(I,h,V.children,B),h.memoizedState=null,B)}function Nb(I,h){return h=sm({mode:"visible",children:h},I.mode,0,null),h.return=I,I.child=h}function Lx(I,h,B,V){var H=I.child;return I=H.sibling,B=Gl(H,{mode:"visible",children:B}),!(h.mode&1)&&(B.lanes=V),B.return=h,B.sibling=null,I!==null&&(V=h.deletions,V===null?(h.deletions=[I],h.flags|=16):V.push(I)),h.child=B}function Tx(I,h,B,V,H){var D=h.mode;I=I.child;var ye=I.sibling,Ke={mode:"hidden",children:B};return!(D&1)&&h.child!==I?(B=h.child,B.childLanes=0,B.pendingProps=Ke,h.deletions=null):(B=Gl(I,Ke),B.subtreeFlags=I.subtreeFlags&14680064),ye!==null?V=Gl(ye,V):(V=Wc(V,D,H,null),V.flags|=2),V.return=h,B.return=h,B.sibling=V,h.child=B,V}function Tf(I,h,B,V){return V!==null&&Ab(V),eu(h,I.child,null,B),I=Nb(h,h.pendingProps.children),I.flags|=2,h.memoizedState=null,I}function _x(I,h,B){I.lanes|=h;var V=I.alternate;V!==null&&(V.lanes|=h),Lr(I.return,h,B)}function Fb(I,h,B,V,H){var D=I.memoizedState;D===null?I.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:V,tail:B,tailMode:H}:(D.isBackwards=h,D.rendering=null,D.renderingStartTime=0,D.last=V,D.tail=B,D.tailMode=H)}function kx(I,h,B){var V=h.pendingProps,H=V.revealOrder,D=V.tail;if(Tr(I,h,V.children,B),V=di.current,V&2)V=V&1|2,h.flags|=128;else{if(I!==null&&I.flags&128)e:for(I=h.child;I!==null;){if(I.tag===13)I.memoizedState!==null&&_x(I,B,h);else if(I.tag===19)_x(I,B,h);else if(I.child!==null){I.child.return=I,I=I.child;continue}if(I===h)break e;for(;I.sibling===null;){if(I.return===null||I.return===h)break e;I=I.return}I.sibling.return=I.return,I=I.sibling}V&=1}if(ht(di,V),!(h.mode&1))h.memoizedState=null;else switch(H){case"forwards":for(B=h.child,H=null;B!==null;)I=B.alternate,I!==null&&Wf(I)===null&&(H=B),B=B.sibling;B=H,B===null?(H=h.child,h.child=null):(H=B.sibling,B.sibling=null),Fb(h,!1,H,B,D);break;case"backwards":for(B=null,H=h.child,h.child=null;H!==null;){if(I=H.alternate,I!==null&&Wf(I)===null){h.child=H;break}I=H.sibling,H.sibling=B,B=H,H=I}Fb(h,!0,B,null,D);break;case"together":Fb(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function Xs(I,h,B){if(I!==null&&(h.dependencies=I.dependencies),ou|=h.lanes,!(B&h.childLanes))return null;if(I!==null&&h.child!==I.child)throw Error(a(153));if(h.child!==null){for(I=h.child,B=Gl(I,I.pendingProps),h.child=B,B.return=h;I.sibling!==null;)I=I.sibling,B=B.sibling=Gl(I,I.pendingProps),B.return=h;B.sibling=null}return h.child}function DL(I,h,B){switch(h.tag){case 3:Yx(h),qg();break;case 5:ax(h);break;case 1:In(h.type)&&Rt(h);break;case 4:pb(h,h.stateNode.containerInfo);break;case 10:Gf(h,h.type._context,h.memoizedProps.value);break;case 13:var V=h.memoizedState;if(V!==null)return V.dehydrated!==null?(ht(di,di.current&1),h.flags|=128,null):B&h.child.childLanes?Kx(I,h,B):(ht(di,di.current&1),I=Xs(I,h,B),I!==null?I.sibling:null);ht(di,di.current&1);break;case 19:if(V=(B&h.childLanes)!==0,I.flags&128){if(V)return kx(I,h,B);h.flags|=128}var H=h.memoizedState;if(H!==null&&(H.rendering=null,H.tail=null,H.lastEffect=null),ht(di,di.current),V)break;return null;case 22:case 23:return h.lanes=0,Hx(I,h,B)}return Xs(I,h,B)}function OL(I,h){switch(hb(h),h.tag){case 1:return In(h.type)&&Ht(),I=h.flags,I&65536?(h.flags=I&-65537|128,h):null;case 3:return nu(),yt(Pt),yt(zt),yb(),I=h.flags,I&65536&&!(I&128)?(h.flags=I&-65537|128,h):null;case 5:return vb(h),null;case 13:if(yt(di),I=h.memoizedState,I!==null&&I.dehydrated!==null){if(h.alternate===null)throw Error(a(340));qg()}return I=h.flags,I&65536?(h.flags=I&-65537|128,h):null;case 19:return yt(di),null;case 4:return nu(),null;case 10:return ji(h.type._context),null;case 22:case 23:return $b(),null;case 24:return null;default:return null}}var _f=!1,Sc=!1,JL=typeof WeakSet=="function"?WeakSet:Set,_t=null;function kf(I,h){var B=I.ref;if(B!==null)if(typeof B=="function")try{B(null)}catch(V){lo(I,h,V)}else B.current=null}function Hb(I,h,B){try{B()}catch(V){lo(I,h,V)}}var Px=!1;function QL(I,h){for(L(I.containerInfo),_t=h;_t!==null;)if(I=_t,h=I.child,(I.subtreeFlags&1028)!==0&&h!==null)h.return=I,_t=h;else for(;_t!==null;){I=_t;try{var B=I.alternate;if(I.flags&1024)switch(I.tag){case 0:case 11:case 15:break;case 1:if(B!==null){var V=B.memoizedProps,H=B.memoizedState,D=I.stateNode,ye=D.getSnapshotBeforeUpdate(I.elementType===I.type?V:Kr(I.type,V),H);D.__reactInternalSnapshotBeforeUpdate=ye}break;case 3:me&&ct(I.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}catch(Ke){lo(I,I.return,Ke)}if(h=I.sibling,h!==null){h.return=I.return,_t=h;break}_t=I.return}return B=Px,Px=!1,B}function wc(I,h,B){var V=h.updateQueue;if(V=V!==null?V.lastEffect:null,V!==null){var H=V=V.next;do{if((H.tag&I)===I){var D=H.destroy;H.destroy=void 0,D!==void 0&&Hb(h,B,D)}H=H.next}while(H!==V)}}function AI(I,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var B=h=h.next;do{if((B.tag&I)===I){var V=B.create;B.destroy=V()}B=B.next}while(B!==h)}}function Xb(I){var h=I.ref;if(h!==null){var B=I.stateNode;switch(I.tag){case 5:I=k(B);break;default:I=B}typeof h=="function"?h(I):h.current=I}}function Ux(I,h,B){if(pr&&typeof pr.onCommitFiberUnmount=="function")try{pr.onCommitFiberUnmount(Sa,h)}catch{}switch(h.tag){case 0:case 11:case 14:case 15:if(I=h.updateQueue,I!==null&&(I=I.lastEffect,I!==null)){var V=I=I.next;do{var H=V,D=H.destroy;H=H.tag,D!==void 0&&(H&2||H&4)&&Hb(h,B,D),V=V.next}while(V!==I)}break;case 1:if(kf(h,B),I=h.stateNode,typeof I.componentWillUnmount=="function")try{I.props=h.memoizedProps,I.state=h.memoizedState,I.componentWillUnmount()}catch(ye){lo(h,B,ye)}break;case 5:kf(h,B);break;case 4:me?$x(I,h,B):T&&T&&(h=h.stateNode.containerInfo,B=It(h),et(h,B))}}function Dx(I,h,B){for(var V=h;;)if(Ux(I,V,B),V.child===null||me&&V.tag===4){if(V===h)break;for(;V.sibling===null;){if(V.return===null||V.return===h)return;V=V.return}V.sibling.return=V.return,V=V.sibling}else V.child.return=V,V=V.child}function Ox(I){var h=I.alternate;h!==null&&(I.alternate=null,Ox(h)),I.child=null,I.deletions=null,I.sibling=null,I.tag===5&&(h=I.stateNode,h!==null&&He(h)),I.stateNode=null,I.return=null,I.dependencies=null,I.memoizedProps=null,I.memoizedState=null,I.pendingProps=null,I.stateNode=null,I.updateQueue=null}function Jx(I){return I.tag===5||I.tag===3||I.tag===4}function Qx(I){e:for(;;){for(;I.sibling===null;){if(I.return===null||Jx(I.return))return null;I=I.return}for(I.sibling.return=I.return,I=I.sibling;I.tag!==5&&I.tag!==6&&I.tag!==18;){if(I.flags&2||I.child===null||I.tag===4)continue e;I.child.return=I,I=I.child}if(!(I.flags&2))return I.stateNode}}function jx(I){if(me){e:{for(var h=I.return;h!==null;){if(Jx(h))break e;h=h.return}throw Error(a(160))}var B=h;switch(B.tag){case 5:h=B.stateNode,B.flags&32&&(Te(h),B.flags&=-33),B=Qx(I),Yb(I,B,h);break;case 3:case 4:h=B.stateNode.containerInfo,B=Qx(I),Eb(I,B,h);break;default:throw Error(a(161))}}}function Eb(I,h,B){var V=I.tag;if(V===5||V===6)I=I.stateNode,h?Ne(B,I,h):Qe(B,I);else if(V!==4&&(I=I.child,I!==null))for(Eb(I,h,B),I=I.sibling;I!==null;)Eb(I,h,B),I=I.sibling}function Yb(I,h,B){var V=I.tag;if(V===5||V===6)I=I.stateNode,h?Ue(B,I,h):Ee(B,I);else if(V!==4&&(I=I.child,I!==null))for(Yb(I,h,B),I=I.sibling;I!==null;)Yb(I,h,B),I=I.sibling}function $x(I,h,B){for(var V=h,H=!1,D,ye;;){if(!H){H=V.return;e:for(;;){if(H===null)throw Error(a(160));switch(D=H.stateNode,H.tag){case 5:ye=!1;break e;case 3:D=D.containerInfo,ye=!0;break e;case 4:D=D.containerInfo,ye=!0;break e}H=H.return}H=!0}if(V.tag===5||V.tag===6)Dx(I,V,B),ye?Ie(D,V.stateNode):je(D,V.stateNode);else if(V.tag===18)ye?re(D,V.stateNode):le(D,V.stateNode);else if(V.tag===4){if(V.child!==null){D=V.stateNode.containerInfo,ye=!0,V.child.return=V,V=V.child;continue}}else if(Ux(I,V,B),V.child!==null){V.child.return=V,V=V.child;continue}if(V===h)break;for(;V.sibling===null;){if(V.return===null||V.return===h)return;V=V.return,V.tag===4&&(H=!1)}V.sibling.return=V.return,V=V.sibling}}function zb(I,h){if(me){switch(h.tag){case 0:case 11:case 14:case 15:wc(3,h,h.return),AI(3,h),wc(5,h,h.return);return;case 1:return;case 5:var B=h.stateNode;if(B!=null){var V=h.memoizedProps;I=I!==null?I.memoizedProps:V;var H=h.type,D=h.updateQueue;h.updateQueue=null,D!==null&&st(B,D,H,I,V,h)}return;case 6:if(h.stateNode===null)throw Error(a(162));B=h.memoizedProps,Ye(h.stateNode,I!==null?I.memoizedProps:B,B);return;case 3:Ge&&I!==null&&I.memoizedState.isDehydrated&&te(h.stateNode.containerInfo);return;case 12:return;case 13:Pf(h);return;case 19:Pf(h);return;case 17:return}throw Error(a(163))}switch(h.tag){case 0:case 11:case 14:case 15:wc(3,h,h.return),AI(3,h),wc(5,h,h.return);return;case 12:return;case 13:Pf(h);return;case 19:Pf(h);return;case 3:Ge&&I!==null&&I.memoizedState.isDehydrated&&te(h.stateNode.containerInfo);break;case 22:case 23:return}e:if(T){switch(h.tag){case 1:case 5:case 6:break e;case 3:case 4:h=h.stateNode,et(h.containerInfo,h.pendingChildren);break e}throw Error(a(163))}}function Pf(I){var h=I.updateQueue;if(h!==null){I.updateQueue=null;var B=I.stateNode;B===null&&(B=I.stateNode=new JL),h.forEach(function(V){var H=aT.bind(null,I,V);B.has(V)||(B.add(V),V.then(H,H))})}}function jL(I,h){for(_t=h;_t!==null;){h=_t;var B=h.deletions;if(B!==null)for(var V=0;V<B.length;V++){var H=B[V];try{var D=I;me?$x(D,H,h):Dx(D,H,h);var ye=H.alternate;ye!==null&&(ye.return=null),H.return=null}catch(nn){lo(H,h,nn)}}if(B=h.child,h.subtreeFlags&12854&&B!==null)B.return=h,_t=B;else for(;_t!==null;){h=_t;try{var Ke=h.flags;if(Ke&32&&me&&Te(h.stateNode),Ke&512){var at=h.alternate;if(at!==null){var Mt=at.ref;Mt!==null&&(typeof Mt=="function"?Mt(null):Mt.current=null)}}if(Ke&8192)switch(h.tag){case 13:if(h.memoizedState!==null){var $t=h.alternate;($t===null||$t.memoizedState===null)&&(Ub=Ut())}break;case 22:var hn=h.memoizedState!==null,cn=h.alternate,Jn=cn!==null&&cn.memoizedState!==null;if(B=h,me){e:if(V=B,H=hn,D=null,me)for(var an=V;;){if(an.tag===5){if(D===null){D=an;var Gr=an.stateNode;H?ue(Gr):be(an.stateNode,an.memoizedProps)}}else if(an.tag===6){if(D===null){var aa=an.stateNode;H?Pe(aa):Le(aa,an.memoizedProps)}}else if((an.tag!==22&&an.tag!==23||an.memoizedState===null||an===V)&&an.child!==null){an.child.return=an,an=an.child;continue}if(an===V)break;for(;an.sibling===null;){if(an.return===null||an.return===V)break e;D===an&&(D=null),an=an.return}D===an&&(D=null),an.sibling.return=an.return,an=an.sibling}}if(hn&&!Jn&&B.mode&1){_t=B;for(var tt=B.child;tt!==null;){for(B=_t=tt;_t!==null;){V=_t;var ke=V.child;switch(V.tag){case 0:case 11:case 14:case 15:wc(4,V,V.return);break;case 1:kf(V,V.return);var it=V.stateNode;if(typeof it.componentWillUnmount=="function"){var Dt=V.return;try{it.props=V.memoizedProps,it.state=V.memoizedState,it.componentWillUnmount()}catch(nn){lo(V,Dt,nn)}}break;case 5:kf(V,V.return);break;case 22:if(V.memoizedState!==null){tR(B);continue}}ke!==null?(ke.return=V,_t=ke):tR(B)}tt=tt.sibling}}}switch(Ke&4102){case 2:jx(h),h.flags&=-3;break;case 6:jx(h),h.flags&=-3,zb(h.alternate,h);break;case 4096:h.flags&=-4097;break;case 4100:h.flags&=-4097,zb(h.alternate,h);break;case 4:zb(h.alternate,h)}}catch(nn){lo(h,h.return,nn)}if(B=h.sibling,B!==null){B.return=h.return,_t=B;break}_t=h.return}}}function $L(I,h,B){_t=I,qx(I)}function qx(I,h,B){for(var V=(I.mode&1)!==0;_t!==null;){var H=_t,D=H.child;if(H.tag===22&&V){var ye=H.memoizedState!==null||_f;if(!ye){var Ke=H.alternate,at=Ke!==null&&Ke.memoizedState!==null||Sc;Ke=_f;var Mt=Sc;if(_f=ye,(Sc=at)&&!Mt)for(_t=H;_t!==null;)ye=_t,at=ye.child,ye.tag===22&&ye.memoizedState!==null?nR(H):at!==null?(at.return=ye,_t=at):nR(H);for(;D!==null;)_t=D,qx(D),D=D.sibling;_t=H,_f=Ke,Sc=Mt}eR(I)}else H.subtreeFlags&8772&&D!==null?(D.return=H,_t=D):eR(I)}}function eR(I){for(;_t!==null;){var h=_t;if(h.flags&8772){var B=h.alternate;try{if(h.flags&8772)switch(h.tag){case 0:case 11:case 15:Sc||AI(5,h);break;case 1:var V=h.stateNode;if(h.flags&4&&!Sc)if(B===null)V.componentDidMount();else{var H=h.elementType===h.type?B.memoizedProps:Kr(h.type,B.memoizedProps);V.componentDidUpdate(H,B.memoizedState,V.__reactInternalSnapshotBeforeUpdate)}var D=h.updateQueue;D!==null&&O1(h,D,V);break;case 3:var ye=h.updateQueue;if(ye!==null){if(B=null,h.child!==null)switch(h.child.tag){case 5:B=k(h.child.stateNode);break;case 1:B=h.child.stateNode}O1(h,ye,B)}break;case 5:var Ke=h.stateNode;B===null&&h.flags&4&&$e(Ke,h.type,h.memoizedProps,h);break;case 6:break;case 4:break;case 12:break;case 13:if(Ge&&h.memoizedState===null){var at=h.alternate;if(at!==null){var Mt=at.memoizedState;if(Mt!==null){var $t=Mt.dehydrated;$t!==null&&ce($t)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(a(163))}Sc||h.flags&512&&Xb(h)}catch(hn){lo(h,h.return,hn)}}if(h===I){_t=null;break}if(B=h.sibling,B!==null){B.return=h.return,_t=B;break}_t=h.return}}function tR(I){for(;_t!==null;){var h=_t;if(h===I){_t=null;break}var B=h.sibling;if(B!==null){B.return=h.return,_t=B;break}_t=h.return}}function nR(I){for(;_t!==null;){var h=_t;try{switch(h.tag){case 0:case 11:case 15:var B=h.return;try{AI(4,h)}catch(at){lo(h,B,at)}break;case 1:var V=h.stateNode;if(typeof V.componentDidMount=="function"){var H=h.return;try{V.componentDidMount()}catch(at){lo(h,H,at)}}var D=h.return;try{Xb(h)}catch(at){lo(h,D,at)}break;case 5:var ye=h.return;try{Xb(h)}catch(at){lo(h,ye,at)}}}catch(at){lo(h,h.return,at)}if(h===I){_t=null;break}var Ke=h.sibling;if(Ke!==null){Ke.return=h.return,_t=Ke;break}_t=h.return}}var Uf=0,Df=1,Of=2,Jf=3,Qf=4;if(typeof Symbol=="function"&&Symbol.for){var pI=Symbol.for;Uf=pI("selector.component"),Df=pI("selector.has_pseudo_class"),Of=pI("selector.role"),Jf=pI("selector.test_id"),Qf=pI("selector.text")}function Kb(I){var h=ne(I);if(h!=null){if(typeof h.memoizedProps["data-testname"]!="string")throw Error(a(364));return h}if(I=Y(I),I===null)throw Error(a(362));return I.stateNode.current}function Lb(I,h){switch(h.$$typeof){case Uf:if(I.type===h.value)return!0;break;case Df:e:{h=h.value,I=[I,0];for(var B=0;B<I.length;){var V=I[B++],H=I[B++],D=h[H];if(V.tag!==5||!fe(V)){for(;D!=null&&Lb(V,D);)H++,D=h[H];if(H===h.length){h=!0;break e}else for(V=V.child;V!==null;)I.push(V,H),V=V.sibling}}h=!1}return h;case Of:if(I.tag===5&&Ze(I.stateNode,h.value))return!0;break;case Qf:if((I.tag===5||I.tag===6)&&(I=se(I),I!==null&&0<=I.indexOf(h.value)))return!0;break;case Jf:if(I.tag===5&&(I=I.memoizedProps["data-testname"],typeof I=="string"&&I.toLowerCase()===h.value.toLowerCase()))return!0;break;default:throw Error(a(365))}return!1}function Tb(I){switch(I.$$typeof){case Uf:return"<"+(Z(I.value)||"Unknown")+">";case Df:return":has("+(Tb(I)||"")+")";case Of:return'[role="'+I.value+'"]';case Qf:return'"'+I.value+'"';case Jf:return'[data-testname="'+I.value+'"]';default:throw Error(a(365))}}function iR(I,h){var B=[];I=[I,0];for(var V=0;V<I.length;){var H=I[V++],D=I[V++],ye=h[D];if(H.tag!==5||!fe(H)){for(;ye!=null&&Lb(H,ye);)D++,ye=h[D];if(D===h.length)B.push(H);else for(H=H.child;H!==null;)I.push(H,D),H=H.sibling}}return B}function _b(I,h){if(!q)throw Error(a(363));I=Kb(I),I=iR(I,h),h=[],I=Array.from(I);for(var B=0;B<I.length;){var V=I[B++];if(V.tag===5)fe(V)||h.push(V.stateNode);else for(V=V.child;V!==null;)I.push(V),V=V.sibling}return h}var qL=Math.ceil,jf=s.ReactCurrentDispatcher,kb=s.ReactCurrentOwner,Si=s.ReactCurrentBatchConfig,wn=0,Mi=null,Ni=null,lr=0,Wo=0,ru=Wt(0),Ti=0,vI=null,ou=0,$f=0,Pb=0,bI=null,ao=null,Ub=0,Db=1/0;function au(){Db=Ut()+500}var qf=!1,Ob=null,pl=null,em=!1,vl=null,tm=0,yI=0,Jb=null,nm=-1,im=0;function _r(){return wn&6?Ut():nm!==-1?nm:nm=Ut()}function bl(I){return I.mode&1?wn&2&&lr!==0?lr&-lr:pc.transition!==null?(im===0&&(I=gi,gi<<=1,!(gi&4194240)&&(gi=64),im=I),im):(I=Cn,I!==0?I:ae()):1}function ra(I,h,B){if(50<yI)throw yI=0,Jb=null,Error(a(185));var V=rm(I,h);return V===null?null:(Yr(V,h,B),(!(wn&2)||V!==Mi)&&(V===Mi&&(!(wn&2)&&($f|=h),Ti===4&&yl(V,lr)),so(V,B),h===1&&wn===0&&!(I.mode&1)&&(au(),rs&&oo())),V)}function rm(I,h){I.lanes|=h;var B=I.alternate;for(B!==null&&(B.lanes|=h),B=I,I=I.return;I!==null;)I.childLanes|=h,B=I.alternate,B!==null&&(B.childLanes|=h),B=I,I=I.return;return B.tag===3?B.stateNode:null}function so(I,h){var B=I.callbackNode;mr(I,h);var V=Vi(I,I===Mi?lr:0);if(V===0)B!==null&&Ba(B),I.callbackNode=null,I.callbackPriority=0;else if(h=V&-V,I.callbackPriority!==h){if(B!=null&&Ba(B),h===1)I.tag===0?oI(oR.bind(null,I)):rI(oR.bind(null,I)),ve?Me(function(){wn===0&&oo()}):Ar(Hn,oo),B=null;else{switch(Bo(V)){case 1:B=Hn;break;case 4:B=Qn;break;case 16:B=Gn;break;case 536870912:B=$o;break;default:B=Gn}B=CR(B,rR.bind(null,I))}I.callbackPriority=h,I.callbackNode=B}}function rR(I,h){if(nm=-1,im=0,wn&6)throw Error(a(327));var B=I.callbackNode;if(Rc()&&I.callbackNode!==B)return null;var V=Vi(I,I===Mi?lr:0);if(V===0)return null;if(V&30||V&I.expiredLanes||h)h=om(I,V);else{h=V;var H=wn;wn|=2;var D=lR();(Mi!==I||lr!==h)&&(au(),Zc(I,h));do try{nT();break}catch(Ke){sR(I,Ke)}while(!0);Qg(),jf.current=D,wn=H,Ni!==null?h=0:(Mi=null,lr=0,h=Ti)}if(h!==0){if(h===2&&(H=Go(I),H!==0&&(V=H,h=Qb(I,H))),h===1)throw B=vI,Zc(I,0),yl(I,V),so(I,Ut()),B;if(h===6)yl(I,V);else{if(H=I.current.alternate,!(V&30)&&!eT(H)&&(h=om(I,V),h===2&&(D=Go(I),D!==0&&(V=D,h=Qb(I,D))),h===1))throw B=vI,Zc(I,0),yl(I,V),so(I,Ut()),B;switch(I.finishedWork=H,I.finishedLanes=V,h){case 0:case 1:throw Error(a(345));case 2:xc(I,ao);break;case 3:if(yl(I,V),(V&130023424)===V&&(h=Ub+500-Ut(),10<h)){if(Vi(I,0)!==0)break;if(H=I.suspendedLanes,(H&V)!==V){_r(),I.pingedLanes|=I.suspendedLanes&H;break}I.timeoutHandle=ie(xc.bind(null,I,ao),h);break}xc(I,ao);break;case 4:if(yl(I,V),(V&4194240)===V)break;for(h=I.eventTimes,H=-1;0<V;){var ye=31-en(V);D=1<<ye,ye=h[ye],ye>H&&(H=ye),V&=~D}if(V=H,V=Ut()-V,V=(120>V?120:480>V?480:1080>V?1080:1920>V?1920:3e3>V?3e3:4320>V?4320:1960*qL(V/1960))-V,10<V){I.timeoutHandle=ie(xc.bind(null,I,ao),V);break}xc(I,ao);break;case 5:xc(I,ao);break;default:throw Error(a(329))}}}return so(I,Ut()),I.callbackNode===B?rR.bind(null,I):null}function Qb(I,h){var B=bI;return I.current.memoizedState.isDehydrated&&(Zc(I,h).flags|=256),I=om(I,h),I!==2&&(h=ao,ao=B,h!==null&&jb(h)),I}function jb(I){ao===null?ao=I:ao.push.apply(ao,I)}function eT(I){for(var h=I;;){if(h.flags&16384){var B=h.updateQueue;if(B!==null&&(B=B.stores,B!==null))for(var V=0;V<B.length;V++){var H=B[V],D=H.getSnapshot;H=H.value;try{if(!So(D(),H))return!1}catch{return!1}}}if(B=h.child,h.subtreeFlags&16384&&B!==null)B.return=h,h=B;else{if(h===I)break;for(;h.sibling===null;){if(h.return===null||h.return===I)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function yl(I,h){for(h&=~Pb,h&=~$f,I.suspendedLanes|=h,I.pingedLanes&=~h,I=I.expirationTimes;0<h;){var B=31-en(h),V=1<<B;I[B]=-1,h&=~V}}function oR(I){if(wn&6)throw Error(a(327));Rc();var h=Vi(I,0);if(!(h&1))return so(I,Ut()),null;var B=om(I,h);if(I.tag!==0&&B===2){var V=Go(I);V!==0&&(h=V,B=Qb(I,V))}if(B===1)throw B=vI,Zc(I,0),yl(I,h),so(I,Ut()),B;if(B===6)throw Error(a(345));return I.finishedWork=I.current.alternate,I.finishedLanes=h,xc(I,ao),so(I,Ut()),null}function aR(I){vl!==null&&vl.tag===0&&!(wn&6)&&Rc();var h=wn;wn|=1;var B=Si.transition,V=Cn;try{if(Si.transition=null,Cn=1,I)return I()}finally{Cn=V,Si.transition=B,wn=h,!(wn&6)&&oo()}}function $b(){Wo=ru.current,yt(ru)}function Zc(I,h){I.finishedWork=null,I.finishedLanes=0;var B=I.timeoutHandle;if(B!==Ve&&(I.timeoutHandle=Ve,de(B)),Ni!==null)for(B=Ni.return;B!==null;){var V=B;switch(hb(V),V.tag){case 1:V=V.type.childContextTypes,V!=null&&Ht();break;case 3:nu(),yt(Pt),yt(zt),yb();break;case 5:vb(V);break;case 4:nu();break;case 13:yt(di);break;case 19:yt(di);break;case 10:ji(V.type._context);break;case 22:case 23:$b()}B=B.return}if(Mi=I,Ni=I=Gl(I.current,null),lr=Wo=h,Ti=0,vI=null,Pb=$f=ou=0,ao=bI=null,wo!==null){for(h=0;h<wo.length;h++)if(B=wo[h],V=B.interleaved,V!==null){B.interleaved=null;var H=V.next,D=B.pending;if(D!==null){var ye=D.next;D.next=H,V.next=ye}B.pending=V}wo=null}return I}function sR(I,h){do{var B=Ni;try{if(Qg(),Vf.current=Ef,Mf){for(var V=pi.memoizedState;V!==null;){var H=V.queue;H!==null&&(H.pending=null),V=V.next}Mf=!1}if(iu=0,$i=vr=pi=null,uI=!1,dI=0,kb.current=null,B===null||B.return===null){Ti=1,vI=h,Ni=null;break}e:{var D=I,ye=B.return,Ke=B,at=h;if(h=lr,Ke.flags|=32768,at!==null&&typeof at=="object"&&typeof at.then=="function"){var Mt=at,$t=Ke,hn=$t.tag;if(!($t.mode&1)&&(hn===0||hn===11||hn===15)){var cn=$t.alternate;cn?($t.updateQueue=cn.updateQueue,$t.memoizedState=cn.memoizedState,$t.lanes=cn.lanes):($t.updateQueue=null,$t.memoizedState=null)}var Jn=xx(ye);if(Jn!==null){Jn.flags&=-257,Rx(Jn,ye,Ke,D,h),Jn.mode&1&&Zx(D,Mt,h),h=Jn,at=Mt;var an=h.updateQueue;if(an===null){var Gr=new Set;Gr.add(at),h.updateQueue=Gr}else an.add(at);break e}else{if(!(h&1)){Zx(D,Mt,h),qb();break e}at=Error(a(426))}}else if(si&&Ke.mode&1){var aa=xx(ye);if(aa!==null){!(aa.flags&65536)&&(aa.flags|=256),Rx(aa,ye,Ke,D,h),Ab(at);break e}}D=at,Ti!==4&&(Ti=2),bI===null?bI=[D]:bI.push(D),at=Rb(at,Ke),Ke=ye;do{switch(Ke.tag){case 3:Ke.flags|=65536,h&=-h,Ke.lanes|=h;var tt=Sx(Ke,at,h);D1(Ke,tt);break e;case 1:D=at;var ke=Ke.type,it=Ke.stateNode;if(!(Ke.flags&128)&&(typeof ke.getDerivedStateFromError=="function"||it!==null&&typeof it.componentDidCatch=="function"&&(pl===null||!pl.has(it)))){Ke.flags|=65536,h&=-h,Ke.lanes|=h;var Dt=wx(Ke,D,h);D1(Ke,Dt);break e}}Ke=Ke.return}while(Ke!==null)}gR(B)}catch(nn){h=nn,Ni===B&&B!==null&&(Ni=B=B.return);continue}break}while(!0)}function lR(){var I=jf.current;return jf.current=Ef,I===null?Ef:I}function qb(){(Ti===0||Ti===3||Ti===2)&&(Ti=4),Mi===null||!(ou&268435455)&&!($f&268435455)||yl(Mi,lr)}function om(I,h){var B=wn;wn|=2;var V=lR();Mi===I&&lr===h||Zc(I,h);do try{tT();break}catch(H){sR(I,H)}while(!0);if(Qg(),wn=B,jf.current=V,Ni!==null)throw Error(a(261));return Mi=null,lr=0,Ti}function tT(){for(;Ni!==null;)cR(Ni)}function nT(){for(;Ni!==null&&!ns();)cR(Ni)}function cR(I){var h=IR(I.alternate,I,Wo);I.memoizedProps=I.pendingProps,h===null?gR(I):Ni=h,kb.current=null}function gR(I){var h=I;do{var B=h.alternate;if(I=h.return,h.flags&32768){if(B=OL(B,h),B!==null){B.flags&=32767,Ni=B;return}if(I!==null)I.flags|=32768,I.subtreeFlags=0,I.deletions=null;else{Ti=6,Ni=null;return}}else if(B=PL(B,h,Wo),B!==null){Ni=B;return}if(h=h.sibling,h!==null){Ni=h;return}Ni=h=I}while(h!==null);Ti===0&&(Ti=5)}function xc(I,h){var B=Cn,V=Si.transition;try{Si.transition=null,Cn=1,iT(I,h,B)}finally{Si.transition=V,Cn=B}return null}function iT(I,h,B){do Rc();while(vl!==null);if(wn&6)throw Error(a(327));var V=I.finishedWork,H=I.finishedLanes;if(V===null)return null;if(I.finishedWork=null,I.finishedLanes=0,V===I.current)throw Error(a(177));I.callbackNode=null,I.callbackPriority=0;var D=V.lanes|V.childLanes;if(ui(I,D),I===Mi&&(Ni=Mi=null,lr=0),!(V.subtreeFlags&2064)&&!(V.flags&2064)||em||(em=!0,CR(Gn,function(){return Rc(),null})),D=(V.flags&15990)!==0,V.subtreeFlags&15990||D){D=Si.transition,Si.transition=null;var ye=Cn;Cn=1;var Ke=wn;wn|=4,kb.current=null,QL(I,V),jL(I,V),z(I.containerInfo),I.current=V,$L(V),Jt(),wn=Ke,Cn=ye,Si.transition=D}else I.current=V;if(em&&(em=!1,vl=I,tm=H),D=I.pendingLanes,D===0&&(pl=null),is(V.stateNode),so(I,Ut()),h!==null)for(B=I.onRecoverableError,V=0;V<h.length;V++)B(h[V]);if(qf)throw qf=!1,I=Ob,Ob=null,I;return tm&1&&I.tag!==0&&Rc(),D=I.pendingLanes,D&1?I===Jb?yI++:(yI=0,Jb=I):yI=0,oo(),null}function Rc(){if(vl!==null){var I=Bo(tm),h=Si.transition,B=Cn;try{if(Si.transition=null,Cn=16>I?16:I,vl===null)var V=!1;else{if(I=vl,vl=null,tm=0,wn&6)throw Error(a(331));var H=wn;for(wn|=4,_t=I.current;_t!==null;){var D=_t,ye=D.child;if(_t.flags&16){var Ke=D.deletions;if(Ke!==null){for(var at=0;at<Ke.length;at++){var Mt=Ke[at];for(_t=Mt;_t!==null;){var $t=_t;switch($t.tag){case 0:case 11:case 15:wc(8,$t,D)}var hn=$t.child;if(hn!==null)hn.return=$t,_t=hn;else for(;_t!==null;){$t=_t;var cn=$t.sibling,Jn=$t.return;if(Ox($t),$t===Mt){_t=null;break}if(cn!==null){cn.return=Jn,_t=cn;break}_t=Jn}}}var an=D.alternate;if(an!==null){var Gr=an.child;if(Gr!==null){an.child=null;do{var aa=Gr.sibling;Gr.sibling=null,Gr=aa}while(Gr!==null)}}_t=D}}if(D.subtreeFlags&2064&&ye!==null)ye.return=D,_t=ye;else e:for(;_t!==null;){if(D=_t,D.flags&2048)switch(D.tag){case 0:case 11:case 15:wc(9,D,D.return)}var tt=D.sibling;if(tt!==null){tt.return=D.return,_t=tt;break e}_t=D.return}}var ke=I.current;for(_t=ke;_t!==null;){ye=_t;var it=ye.child;if(ye.subtreeFlags&2064&&it!==null)it.return=ye,_t=it;else e:for(ye=ke;_t!==null;){if(Ke=_t,Ke.flags&2048)try{switch(Ke.tag){case 0:case 11:case 15:AI(9,Ke)}}catch(nn){lo(Ke,Ke.return,nn)}if(Ke===ye){_t=null;break e}var Dt=Ke.sibling;if(Dt!==null){Dt.return=Ke.return,_t=Dt;break e}_t=Ke.return}}if(wn=H,oo(),pr&&typeof pr.onPostCommitFiberRoot=="function")try{pr.onPostCommitFiberRoot(Sa,I)}catch{}V=!0}return V}finally{Cn=B,Si.transition=h}}return!1}function uR(I,h,B){h=Rb(B,h),h=Sx(I,h,1),Al(I,h),h=_r(),I=rm(I,1),I!==null&&(Yr(I,1,h),so(I,h))}function lo(I,h,B){if(I.tag===3)uR(I,I,B);else for(;h!==null;){if(h.tag===3){uR(h,I,B);break}else if(h.tag===1){var V=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof V.componentDidCatch=="function"&&(pl===null||!pl.has(V))){I=Rb(B,I),I=wx(h,I,1),Al(h,I),I=_r(),h=rm(h,1),h!==null&&(Yr(h,1,I),so(h,I));break}}h=h.return}}function rT(I,h,B){var V=I.pingCache;V!==null&&V.delete(h),h=_r(),I.pingedLanes|=I.suspendedLanes&B,Mi===I&&(lr&B)===B&&(Ti===4||Ti===3&&(lr&130023424)===lr&&500>Ut()-Ub?Zc(I,0):Pb|=B),so(I,h)}function dR(I,h){h===0&&(I.mode&1?(h=ni,ni<<=1,!(ni&130023424)&&(ni=4194304)):h=1);var B=_r();I=rm(I,h),I!==null&&(Yr(I,h,B),so(I,B))}function oT(I){var h=I.memoizedState,B=0;h!==null&&(B=h.retryLane),dR(I,B)}function aT(I,h){var B=0;switch(I.tag){case 13:var V=I.stateNode,H=I.memoizedState;H!==null&&(B=H.retryLane);break;case 19:V=I.stateNode;break;default:throw Error(a(314))}V!==null&&V.delete(h),dR(I,B)}var IR;IR=function(I,h,B){if(I!==null)if(I.memoizedProps!==h.pendingProps||Pt.current)Ro=!0;else{if(!(I.lanes&B)&&!(h.flags&128))return Ro=!1,DL(I,h,B);Ro=!!(I.flags&131072)}else Ro=!1,si&&h.flags&1048576&&q1(h,xf,h.index);switch(h.lanes=0,h.tag){case 2:var V=h.type;I!==null&&(I.alternate=null,h.alternate=null,h.flags|=2),I=h.pendingProps;var H=un(h,zt.current);Gi(h,B),H=Bb(null,h,V,I,H,B);var D=Sb();return h.flags|=1,typeof H=="object"&&H!==null&&typeof H.render=="function"&&H.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,In(V)?(D=!0,Rt(h)):D=!1,h.memoizedState=H.state!==null&&H.state!==void 0?H.state:null,ub(h),H.updater=wf,h.stateNode=H,H._reactInternals=h,Ib(h,V,I,B),h=Mb(null,h,V,!0,D,B)):(h.tag=0,si&&D&&Cb(h),Tr(null,h,H,B),h=h.child),h;case 16:V=h.elementType;e:{switch(I!==null&&(I.alternate=null,h.alternate=null,h.flags|=2),I=h.pendingProps,H=V._init,V=H(V._payload),h.type=V,H=h.tag=lT(V),I=Kr(V,I),H){case 0:h=Vb(null,h,V,I,B);break e;case 1:h=Ex(null,h,V,I,B);break e;case 11:h=Mx(null,h,V,I,B);break e;case 14:h=Nx(null,h,V,Kr(V.type,I),B);break e}throw Error(a(306,V,""))}return h;case 0:return V=h.type,H=h.pendingProps,H=h.elementType===V?H:Kr(V,H),Vb(I,h,V,H,B);case 1:return V=h.type,H=h.pendingProps,H=h.elementType===V?H:Kr(V,H),Ex(I,h,V,H,B);case 3:e:{if(Yx(h),I===null)throw Error(a(387));V=h.pendingProps,D=h.memoizedState,H=D.element,U1(I,h),Sf(h,V,null,B);var ye=h.memoizedState;if(V=ye.element,Ge&&D.isDehydrated)if(D={element:V,isDehydrated:!1,cache:ye.cache,transitions:ye.transitions},h.updateQueue.baseState=D,h.memoizedState=D,h.flags&256){H=Error(a(423)),h=zx(I,h,V,B,H);break e}else if(V!==H){H=Error(a(424)),h=zx(I,h,V,B,H);break e}else for(Ge&&(xo=sn(h.stateNode.containerInfo),Zo=h,si=!0,Za=null,aI=!1),B=ox(h,null,V,B),h.child=B;B;)B.flags=B.flags&-3|4096,B=B.sibling;else{if(qg(),V===H){h=Xs(I,h,B);break e}Tr(I,h,V,B)}h=h.child}return h;case 5:return ax(h),I===null&&mb(h),V=h.type,H=h.pendingProps,D=I!==null?I.memoizedProps:null,ye=H.children,$(V,H)?ye=null:D!==null&&$(V,D)&&(h.flags|=32),Xx(I,h),Tr(I,h,ye,B),h.child;case 6:return I===null&&mb(h),null;case 13:return Kx(I,h,B);case 4:return pb(h,h.stateNode.containerInfo),V=h.pendingProps,I===null?h.child=eu(h,null,V,B):Tr(I,h,V,B),h.child;case 11:return V=h.type,H=h.pendingProps,H=h.elementType===V?H:Kr(V,H),Mx(I,h,V,H,B);case 7:return Tr(I,h,h.pendingProps,B),h.child;case 8:return Tr(I,h,h.pendingProps.children,B),h.child;case 12:return Tr(I,h,h.pendingProps.children,B),h.child;case 10:e:{if(V=h.type._context,H=h.pendingProps,D=h.memoizedProps,ye=H.value,Gf(h,V,ye),D!==null)if(So(D.value,ye)){if(D.children===H.children&&!Pt.current){h=Xs(I,h,B);break e}}else for(D=h.child,D!==null&&(D.return=h);D!==null;){var Ke=D.dependencies;if(Ke!==null){ye=D.child;for(var at=Ke.firstContext;at!==null;){if(at.context===V){if(D.tag===1){at=Ms(-1,B&-B),at.tag=2;var Mt=D.updateQueue;if(Mt!==null){Mt=Mt.shared;var $t=Mt.pending;$t===null?at.next=at:(at.next=$t.next,$t.next=at),Mt.pending=at}}D.lanes|=B,at=D.alternate,at!==null&&(at.lanes|=B),Lr(D.return,B,h),Ke.lanes|=B;break}at=at.next}}else if(D.tag===10)ye=D.type===h.type?null:D.child;else if(D.tag===18){if(ye=D.return,ye===null)throw Error(a(341));ye.lanes|=B,Ke=ye.alternate,Ke!==null&&(Ke.lanes|=B),Lr(ye,B,h),ye=D.sibling}else ye=D.child;if(ye!==null)ye.return=D;else for(ye=D;ye!==null;){if(ye===h){ye=null;break}if(D=ye.sibling,D!==null){D.return=ye.return,ye=D;break}ye=ye.return}D=ye}Tr(I,h,H.children,B),h=h.child}return h;case 9:return H=h.type,V=h.pendingProps.children,Gi(h,B),H=Bi(H),V=V(H),h.flags|=1,Tr(I,h,V,B),h.child;case 14:return V=h.type,H=Kr(V,h.pendingProps),H=Kr(V.type,H),Nx(I,h,V,H,B);case 15:return Fx(I,h,h.type,h.pendingProps,B);case 17:return V=h.type,H=h.pendingProps,H=h.elementType===V?H:Kr(V,H),I!==null&&(I.alternate=null,h.alternate=null,h.flags|=2),h.tag=1,In(V)?(I=!0,Rt(h)):I=!1,Gi(h,B),j1(h,V,H),Ib(h,V,H,B),Mb(null,h,V,!0,I,B);case 19:return kx(I,h,B);case 22:return Hx(I,h,B)}throw Error(a(156,h.tag))};function CR(I,h){return Ar(I,h)}function sT(I,h,B,V){this.tag=I,this.key=B,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=V,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function oa(I,h,B,V){return new sT(I,h,B,V)}function ey(I){return I=I.prototype,!(!I||!I.isReactComponent)}function lT(I){if(typeof I=="function")return ey(I)?1:0;if(I!=null){if(I=I.$$typeof,I===v)return 11;if(I===A)return 14}return 2}function Gl(I,h){var B=I.alternate;return B===null?(B=oa(I.tag,h,I.key,I.mode),B.elementType=I.elementType,B.type=I.type,B.stateNode=I.stateNode,B.alternate=I,I.alternate=B):(B.pendingProps=h,B.type=I.type,B.flags=0,B.subtreeFlags=0,B.deletions=null),B.flags=I.flags&14680064,B.childLanes=I.childLanes,B.lanes=I.lanes,B.child=I.child,B.memoizedProps=I.memoizedProps,B.memoizedState=I.memoizedState,B.updateQueue=I.updateQueue,h=I.dependencies,B.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},B.sibling=I.sibling,B.index=I.index,B.ref=I.ref,B}function am(I,h,B,V,H,D){var ye=2;if(V=I,typeof I=="function")ey(I)&&(ye=1);else if(typeof I=="string")ye=5;else e:switch(I){case g:return Wc(B.children,H,D,h);case u:ye=8,H|=8;break;case d:return I=oa(12,B,h,H|2),I.elementType=d,I.lanes=D,I;case p:return I=oa(13,B,h,H),I.elementType=p,I.lanes=D,I;case m:return I=oa(19,B,h,H),I.elementType=m,I.lanes=D,I;case G:return sm(B,H,D,h);default:if(typeof I=="object"&&I!==null)switch(I.$$typeof){case C:ye=10;break e;case f:ye=9;break e;case v:ye=11;break e;case A:ye=14;break e;case b:ye=16,V=null;break e}throw Error(a(130,I==null?I:typeof I,""))}return h=oa(ye,B,h,H),h.elementType=I,h.type=V,h.lanes=D,h}function Wc(I,h,B,V){return I=oa(7,I,V,h),I.lanes=B,I}function sm(I,h,B,V){return I=oa(22,I,V,h),I.elementType=G,I.lanes=B,I.stateNode={},I}function ty(I,h,B){return I=oa(6,I,null,h),I.lanes=B,I}function ny(I,h,B){return h=oa(4,I.children!==null?I.children:[],I.key,h),h.lanes=B,h.stateNode={containerInfo:I.containerInfo,pendingChildren:null,implementation:I.implementation},h}function cT(I,h,B,V,H){this.tag=h,this.containerInfo=I,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ve,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vs(0),this.expirationTimes=Vs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vs(0),this.identifierPrefix=V,this.onRecoverableError=H,Ge&&(this.mutableSourceEagerHydrationData=null)}function hR(I,h,B,V,H,D,ye,Ke,at){return I=new cT(I,h,B,Ke,at),h===1?(h=1,D===!0&&(h|=8)):h=0,D=oa(3,null,null,h),I.current=D,D.stateNode=I,D.memoizedState={element:V,isDehydrated:B,cache:null,transitions:null},ub(D),I}function fR(I){if(!I)return Qt;I=I._reactInternals;e:{if(R(I)!==I||I.tag!==1)throw Error(a(170));var h=I;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(In(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(a(171))}if(I.tag===1){var B=I.type;if(In(B))return Lt(I,B,h)}return h}function mR(I){var h=I._reactInternals;if(h===void 0)throw typeof I.render=="function"?Error(a(188)):(I=Object.keys(I).join(","),Error(a(268,I)));return I=N(h),I===null?null:I.stateNode}function AR(I,h){if(I=I.memoizedState,I!==null&&I.dehydrated!==null){var B=I.retryLane;I.retryLane=B!==0&&B<h?B:h}}function iy(I,h){AR(I,h),(I=I.alternate)&&AR(I,h)}function gT(I){return I=N(I),I===null?null:I.stateNode}function uT(){return null}return n.attemptContinuousHydration=function(I){if(I.tag===13){var h=_r();ra(I,134217728,h),iy(I,134217728)}},n.attemptHydrationAtCurrentPriority=function(I){if(I.tag===13){var h=_r(),B=bl(I);ra(I,B,h),iy(I,B)}},n.attemptSynchronousHydration=function(I){switch(I.tag){case 3:var h=I.stateNode;if(h.current.memoizedState.isDehydrated){var B=ai(h.pendingLanes);B!==0&&(Ji(h,B|1),so(h,Ut()),!(wn&6)&&(au(),oo()))}break;case 13:var V=_r();aR(function(){return ra(I,1,V)}),iy(I,1)}},n.batchedUpdates=function(I,h){var B=wn;wn|=1;try{return I(h)}finally{wn=B,wn===0&&(au(),rs&&oo())}},n.createComponentSelector=function(I){return{$$typeof:Uf,value:I}},n.createContainer=function(I,h,B,V,H,D,ye){return hR(I,h,!1,null,B,V,H,D,ye)},n.createHasPseudoClassSelector=function(I){return{$$typeof:Df,value:I}},n.createHydrationContainer=function(I,h,B,V,H,D,ye,Ke,at){return I=hR(B,V,!0,I,H,D,ye,Ke,at),I.context=fR(null),B=I.current,V=_r(),H=bl(B),D=Ms(V,H),D.callback=h??null,Al(B,D),I.current.lanes=H,Yr(I,H,V),so(I,V),I},n.createPortal=function(I,h,B){var V=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:V==null?null:""+V,children:I,containerInfo:h,implementation:B}},n.createRoleSelector=function(I){return{$$typeof:Of,value:I}},n.createTestNameSelector=function(I){return{$$typeof:Jf,value:I}},n.createTextSelector=function(I){return{$$typeof:Qf,value:I}},n.deferredUpdates=function(I){var h=Cn,B=Si.transition;try{return Si.transition=null,Cn=16,I()}finally{Cn=h,Si.transition=B}},n.discreteUpdates=function(I,h,B,V,H){var D=Cn,ye=Si.transition;try{return Si.transition=null,Cn=1,I(h,B,V,H)}finally{Cn=D,Si.transition=ye,wn===0&&au()}},n.findAllNodes=_b,n.findBoundingRects=function(I,h){if(!q)throw Error(a(363));h=_b(I,h),I=[];for(var B=0;B<h.length;B++)I.push(Ce(h[B]));for(h=I.length-1;0<h;h--){B=I[h];for(var V=B.x,H=V+B.width,D=B.y,ye=D+B.height,Ke=h-1;0<=Ke;Ke--)if(h!==Ke){var at=I[Ke],Mt=at.x,$t=Mt+at.width,hn=at.y,cn=hn+at.height;if(V>=Mt&&D>=hn&&H<=$t&&ye<=cn){I.splice(h,1);break}else if(V!==Mt||B.width!==at.width||cn<D||hn>ye){if(!(D!==hn||B.height!==at.height||$t<V||Mt>H)){Mt>V&&(at.width+=Mt-V,at.x=V),$t<H&&(at.width=H-Mt),I.splice(h,1);break}}else{hn>D&&(at.height+=hn-D,at.y=D),cn<ye&&(at.height=ye-hn),I.splice(h,1);break}}}return I},n.findHostInstance=mR,n.findHostInstanceWithNoPortals=function(I){return I=M(I),I=I!==null?E(I):null,I===null?null:I.stateNode},n.findHostInstanceWithWarning=function(I){return mR(I)},n.flushControlled=function(I){var h=wn;wn|=1;var B=Si.transition,V=Cn;try{Si.transition=null,Cn=1,I()}finally{Cn=V,Si.transition=B,wn=h,wn===0&&(au(),oo())}},n.flushPassiveEffects=Rc,n.flushSync=aR,n.focusWithin=function(I,h){if(!q)throw Error(a(363));for(I=Kb(I),h=iR(I,h),h=Array.from(h),I=0;I<h.length;){var B=h[I++];if(!fe(B)){if(B.tag===5&&Oe(B.stateNode))return!0;for(B=B.child;B!==null;)h.push(B),B=B.sibling}}return!1},n.getCurrentUpdatePriority=function(){return Cn},n.getFindAllNodesFailureDescription=function(I,h){if(!q)throw Error(a(363));var B=0,V=[];I=[Kb(I),0];for(var H=0;H<I.length;){var D=I[H++],ye=I[H++],Ke=h[ye];if((D.tag!==5||!fe(D))&&(Lb(D,Ke)&&(V.push(Tb(Ke)),ye++,ye>B&&(B=ye)),ye<h.length))for(D=D.child;D!==null;)I.push(D,ye),D=D.sibling}if(B<h.length){for(I=[];B<h.length;B++)I.push(Tb(h[B]));return`findAllNodes was able to match part of the selector:
  `+(V.join(" > ")+`

No matching component was found for:
  `)+I.join(" > ")}return null},n.getPublicRootInstance=function(I){if(I=I.current,!I.child)return null;switch(I.child.tag){case 5:return k(I.child.stateNode);default:return I.child.stateNode}},n.injectIntoDevTools=function(I){if(I={bundleType:I.bundleType,version:I.version,rendererPackageName:I.rendererPackageName,rendererConfig:I.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:s.ReactCurrentDispatcher,findHostInstanceByFiber:gT,findFiberByHostInstance:I.findFiberByHostInstance||uT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")I=!1;else{var h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(h.isDisabled||!h.supportsFiber)I=!0;else{try{Sa=h.inject(I),pr=h}catch{}I=!!h.checkDCE}}return I},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(I,h,B,V){if(!q)throw Error(a(363));I=_b(I,h);var H=Fe(I,B,V).disconnect;return{disconnect:function(){H()}}},n.registerMutableSourceForHydration=function(I,h){var B=h._getVersion;B=B(h._source),I.mutableSourceEagerHydrationData==null?I.mutableSourceEagerHydrationData=[h,B]:I.mutableSourceEagerHydrationData.push(h,B)},n.runWithPriority=function(I,h){var B=Cn;try{return Cn=I,h()}finally{Cn=B}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(I,h,B,V){var H=h.current,D=_r(),ye=bl(H);return B=fR(B),h.context===null?h.context=B:h.pendingContext=B,h=Ms(D,ye),h.payload={element:I},V=V===void 0?null:V,V!==null&&(h.callback=V),Al(H,h),I=ra(H,ye,D),I!==null&&Bf(I,H,ye),ye},n};bK.exports=Cce;var hce=bK.exports;const fce=X0(hce);var yK={exports:{}},GK={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,L){var z=F.length;F.push(L);e:for(;0<z;){var K=z-1>>>1,O=F[K];if(0<r(O,L))F[K]=L,F[z]=O,z=K;else break e}}function n(F){return F.length===0?null:F[0]}function i(F){if(F.length===0)return null;var L=F[0],z=F.pop();if(z!==L){F[0]=z;e:for(var K=0,O=F.length,j=O>>>1;K<j;){var P=2*(K+1)-1,$=F[P],oe=P+1,ie=F[oe];if(0>r($,z))oe<O&&0>r(ie,$)?(F[K]=ie,F[oe]=z,K=oe):(F[K]=$,F[P]=z,K=P);else if(oe<O&&0>r(ie,z))F[K]=ie,F[oe]=z,K=oe;else break e}}return L}function r(F,L){var z=F.sortIndex-L.sortIndex;return z!==0?z:F.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,s=a.now();t.unstable_now=function(){return a.now()-s}}var l=[],c=[],g=1,u=null,d=3,C=!1,f=!1,v=!1,p=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(F){for(var L=n(c);L!==null;){if(L.callback===null)i(c);else if(L.startTime<=F)i(c),L.sortIndex=L.expirationTime,e(l,L);else break;L=n(c)}}function G(F){if(v=!1,b(F),!f)if(n(l)!==null)f=!0,k(w);else{var L=n(c);L!==null&&J(G,L.startTime-F)}}function w(F,L){f=!1,v&&(v=!1,m(x),x=-1),C=!0;var z=d;try{for(b(L),u=n(l);u!==null&&(!(u.expirationTime>L)||F&&!M());){var K=u.callback;if(typeof K=="function"){u.callback=null,d=u.priorityLevel;var O=K(u.expirationTime<=L);L=t.unstable_now(),typeof O=="function"?u.callback=O:u===n(l)&&i(l),b(L)}else i(l);u=n(l)}if(u!==null)var j=!0;else{var P=n(c);P!==null&&J(G,P.startTime-L),j=!1}return j}finally{u=null,d=z,C=!1}}var S=!1,Z=null,x=-1,R=5,W=-1;function M(){return!(t.unstable_now()-W<R)}function N(){if(Z!==null){var F=t.unstable_now();W=F;var L=!0;try{L=Z(!0,F)}finally{L?X():(S=!1,Z=null)}}else S=!1}var X;if(typeof A=="function")X=function(){A(N)};else if(typeof MessageChannel<"u"){var E=new MessageChannel,Q=E.port2;E.port1.onmessage=N,X=function(){Q.postMessage(null)}}else X=function(){p(N,0)};function k(F){Z=F,S||(S=!0,X())}function J(F,L){x=p(function(){F(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){f||C||(f=!0,k(w))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(F){switch(d){case 1:case 2:case 3:var L=3;break;default:L=d}var z=d;d=L;try{return F()}finally{d=z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,L){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var z=d;d=F;try{return L()}finally{d=z}},t.unstable_scheduleCallback=function(F,L,z){var K=t.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?K+z:K):z=K,F){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=z+O,F={id:g++,callback:L,priorityLevel:F,startTime:z,expirationTime:O,sortIndex:-1},z>K?(F.sortIndex=z,e(c,F),n(l)===null&&F===n(c)&&(v?(m(x),x=-1):v=!0,J(G,z-K))):(F.sortIndex=O,e(l,F),f||C||(f=!0,k(w))),F},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(F){var L=d;return function(){var z=d;d=L;try{return F.apply(this,arguments)}finally{d=z}}}})(GK);yK.exports=GK;var HF=yK.exports;const W1={},BK=t=>void Object.assign(W1,t);function mce(t,e){function n(g,{args:u=[],attach:d,...C},f){let v=`${g[0].toUpperCase()}${g.slice(1)}`,p;if(g==="primitive"){if(C.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const m=C.object;p=Ku(m,{type:g,root:f,attach:d,primitive:!0})}else{const m=W1[v];if(!m)throw new Error(`R3F: ${v} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(u))throw new Error("R3F: The args prop must be an array!");p=Ku(new m(...u),{type:g,root:f,attach:d,memoizedProps:{args:u}})}return p.__r3f.attach===void 0&&(p.isBufferGeometry?p.__r3f.attach="geometry":p.isMaterial&&(p.__r3f.attach="material")),v!=="inject"&&nB(p,C),p}function i(g,u){let d=!1;if(u){var C,f;(C=u.__r3f)!=null&&C.attach?tB(g,u,u.__r3f.attach):u.isObject3D&&g.isObject3D&&(g.add(u),d=!0),d||(f=g.__r3f)==null||f.objects.push(u),u.__r3f||Ku(u,{}),u.__r3f.parent=g,zS(u),Lu(u)}}function r(g,u,d){let C=!1;if(u){var f,v;if((f=u.__r3f)!=null&&f.attach)tB(g,u,u.__r3f.attach);else if(u.isObject3D&&g.isObject3D){u.parent=g,u.dispatchEvent({type:"added"}),g.dispatchEvent({type:"childadded",child:u});const p=g.children.filter(A=>A!==u),m=p.indexOf(d);g.children=[...p.slice(0,m),u,...p.slice(m)],C=!0}C||(v=g.__r3f)==null||v.objects.push(u),u.__r3f||Ku(u,{}),u.__r3f.parent=g,zS(u),Lu(u)}}function o(g,u,d=!1){g&&[...g].forEach(C=>a(u,C,d))}function a(g,u,d){if(u){var C,f,v;if(u.__r3f&&(u.__r3f.parent=null),(C=g.__r3f)!=null&&C.objects&&(g.__r3f.objects=g.__r3f.objects.filter(G=>G!==u)),(f=u.__r3f)!=null&&f.attach)KF(g,u,u.__r3f.attach);else if(u.isObject3D&&g.isObject3D){var p;g.remove(u),(p=u.__r3f)!=null&&p.root&&Sce(Cp(u),u)}const A=(v=u.__r3f)==null?void 0:v.primitive,b=!A&&(d===void 0?u.dispose!==null:d);if(!A){var m;o((m=u.__r3f)==null?void 0:m.objects,u,b),o(u.children,u,b)}if(delete u.__r3f,b&&u.dispose&&u.type!=="Scene"){const G=()=>{try{u.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?HF.unstable_scheduleCallback(HF.unstable_IdlePriority,G):G()}Lu(g)}}function s(g,u,d,C){var f;const v=(f=g.__r3f)==null?void 0:f.parent;if(!v)return;const p=n(u,d,g.__r3f.root);if(g.children){for(const m of g.children)m.__r3f&&i(p,m);g.children=g.children.filter(m=>!m.__r3f)}g.__r3f.objects.forEach(m=>i(p,m)),g.__r3f.objects=[],g.__r3f.autoRemovedBeforeAppend||a(v,g),p.parent&&(p.__r3f.autoRemovedBeforeAppend=!0),i(v,p),p.raycast&&p.__r3f.eventCount&&Cp(p).getState().internal.interaction.push(p),[C,C.alternate].forEach(m=>{m!==null&&(m.stateNode=p,m.ref&&(typeof m.ref=="function"?m.ref(p):m.ref.current=p))})}const l=()=>{};return{reconciler:fce({createInstance:n,removeChild:a,appendChild:i,appendInitialChild:i,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(g,u)=>{if(!u)return;const d=g.getState().scene;d.__r3f&&(d.__r3f.root=g,i(d,u))},removeChildFromContainer:(g,u)=>{u&&a(g.getState().scene,u)},insertInContainerBefore:(g,u,d)=>{if(!u||!d)return;const C=g.getState().scene;C.__r3f&&r(C,u,d)},getRootHostContext:()=>null,getChildHostContext:g=>g,finalizeInitialChildren(g){var u;return!!((u=g==null?void 0:g.__r3f)!=null?u:{}).handlers},prepareUpdate(g,u,d,C){var f;if(((f=g==null?void 0:g.__r3f)!=null?f:{}).primitive&&C.object&&C.object!==g)return[!0];{const{args:p=[],children:m,...A}=C,{args:b=[],children:G,...w}=d;if(!Array.isArray(p))throw new Error("R3F: the args prop must be an array!");if(p.some((Z,x)=>Z!==b[x]))return[!0];const S=VK(g,A,w,!0);return S.changes.length?[!1,S]:null}},commitUpdate(g,[u,d],C,f,v,p){u?s(g,C,v,p):nB(g,d)},commitMount(g,u,d,C){var f;const v=(f=g.__r3f)!=null?f:{};g.raycast&&v.handlers&&v.eventCount&&Cp(g).getState().internal.interaction.push(g)},getPublicInstance:g=>g,prepareForCommit:()=>null,preparePortalMount:g=>Ku(g.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(g){var u;const{attach:d,parent:C}=(u=g.__r3f)!=null?u:{};d&&C&&KF(C,g,d),g.isObject3D&&(g.visible=!1),Lu(g)},unhideInstance(g,u){var d;const{attach:C,parent:f}=(d=g.__r3f)!=null?d:{};C&&f&&tB(f,g,C),(g.isObject3D&&u.visible==null||u.visible)&&(g.visible=!0),Lu(g)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():cd.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&$n.fun(performance.now)?performance.now:$n.fun(Date.now)?Date.now:()=>0,scheduleTimeout:$n.fun(setTimeout)?setTimeout:void 0,cancelTimeout:$n.fun(clearTimeout)?clearTimeout:void 0}),applyProps:nB}}var XF,EF;const eB=t=>"colorSpace"in t||"outputColorSpace"in t,SK=()=>{var t;return(t=W1.ColorManagement)!=null?t:null},wK=t=>t&&t.isOrthographicCamera,Ace=t=>t&&t.hasOwnProperty("current"),vf=typeof window<"u"&&((XF=window.document)!=null&&XF.createElement||((EF=window.navigator)==null?void 0:EF.product)==="ReactNative")?y.useLayoutEffect:y.useEffect;function ZK(t){const e=y.useRef(t);return vf(()=>void(e.current=t),[t]),e}function pce({set:t}){return vf(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}class xK extends y.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}xK.getDerivedStateFromError=()=>({error:!0});const RK="__default",YF=new Map,vce=t=>t&&!!t.memoized&&!!t.changes;function WK(t){var e;const n=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(t)?Math.min(Math.max(t[0],n),t[1]):t}const jI=t=>{var e;return(e=t.__r3f)==null?void 0:e.root.getState()};function Cp(t){let e=t.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const $n={obj:t=>t===Object(t)&&!$n.arr(t)&&typeof t!="function",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",boo:t=>typeof t=="boolean",und:t=>t===void 0,arr:t=>Array.isArray(t),equ(t,e,{arrays:n="shallow",objects:i="reference",strict:r=!0}={}){if(typeof t!=typeof e||!!t!=!!e)return!1;if($n.str(t)||$n.num(t)||$n.boo(t))return t===e;const o=$n.obj(t);if(o&&i==="reference")return t===e;const a=$n.arr(t);if(a&&n==="reference")return t===e;if((a||o)&&t===e)return!0;let s;for(s in t)if(!(s in e))return!1;if(o&&n==="shallow"&&i==="shallow"){for(s in r?e:t)if(!$n.equ(t[s],e[s],{strict:r,objects:"reference"}))return!1}else for(s in r?e:t)if(t[s]!==e[s])return!1;if($n.und(s)){if(a&&t.length===0&&e.length===0||o&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}};function bce(t){const e={nodes:{},materials:{}};return t&&t.traverse(n=>{n.name&&(e.nodes[n.name]=n),n.material&&!e.materials[n.material.name]&&(e.materials[n.material.name]=n.material)}),e}function yce(t){t.dispose&&t.type!=="Scene"&&t.dispose();for(const e in t)e.dispose==null||e.dispose(),delete t[e]}function Ku(t,e){const n=t;return n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},t}function YS(t,e){let n=t;if(e.includes("-")){const i=e.split("-"),r=i.pop();return n=i.reduce((o,a)=>o[a],t),{target:n,key:r}}else return{target:n,key:e}}const zF=/-\d+$/;function tB(t,e,n){if($n.str(n)){if(zF.test(n)){const o=n.replace(zF,""),{target:a,key:s}=YS(t,o);Array.isArray(a[s])||(a[s]=[])}const{target:i,key:r}=YS(t,n);e.__r3f.previousAttach=i[r],i[r]=e}else e.__r3f.previousAttach=n(t,e)}function KF(t,e,n){var i,r;if($n.str(n)){const{target:o,key:a}=YS(t,n),s=e.__r3f.previousAttach;s===void 0?delete o[a]:o[a]=s}else(i=e.__r3f)==null||i.previousAttach==null||i.previousAttach(t,e);(r=e.__r3f)==null||delete r.previousAttach}function VK(t,{children:e,key:n,ref:i,...r},{children:o,key:a,ref:s,...l}={},c=!1){const g=t.__r3f,u=Object.entries(r),d=[];if(c){const f=Object.keys(l);for(let v=0;v<f.length;v++)r.hasOwnProperty(f[v])||u.unshift([f[v],RK+"remove"])}u.forEach(([f,v])=>{var p;if((p=t.__r3f)!=null&&p.primitive&&f==="object"||$n.equ(v,l[f]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(f))return d.push([f,v,!0,[]]);let m=[];f.includes("-")&&(m=f.split("-")),d.push([f,v,!1,m]);for(const A in r){const b=r[A];A.startsWith(`${f}-`)&&d.push([A,b,!1,A.split("-")])}});const C={...r};return g!=null&&g.memoizedProps&&g!=null&&g.memoizedProps.args&&(C.args=g.memoizedProps.args),g!=null&&g.memoizedProps&&g!=null&&g.memoizedProps.attach&&(C.attach=g.memoizedProps.attach),{memoized:C,changes:d}}const Gce=typeof process<"u"&&!1;function nB(t,e){var n;const i=t.__r3f,r=i==null?void 0:i.root,o=r==null||r.getState==null?void 0:r.getState(),{memoized:a,changes:s}=vce(e)?e:VK(t,e),l=i==null?void 0:i.eventCount;t.__r3f&&(t.__r3f.memoizedProps=a);for(let d=0;d<s.length;d++){let[C,f,v,p]=s[d];if(eB(t)){const G="srgb",w="srgb-linear";C==="encoding"?(C="colorSpace",f=f===3001?G:w):C==="outputEncoding"&&(C="outputColorSpace",f=f===3001?G:w)}let m=t,A=m[C];if(p.length&&(A=p.reduce((b,G)=>b[G],t),!(A&&A.set))){const[b,...G]=p.reverse();m=G.reverse().reduce((w,S)=>w[S],t),C=b}if(f===RK+"remove")if(m.constructor){let b=YF.get(m.constructor);b||(b=new m.constructor,YF.set(m.constructor,b)),f=b[C]}else f=0;if(v&&i)f?i.handlers[C]=f:delete i.handlers[C],i.eventCount=Object.keys(i.handlers).length;else if(A&&A.set&&(A.copy||A instanceof bg)){if(Array.isArray(f))A.fromArray?A.fromArray(f):A.set(...f);else if(A.copy&&f&&f.constructor&&(Gce?A.constructor.name===f.constructor.name:A.constructor===f.constructor))A.copy(f);else if(f!==void 0){var c;const b=(c=A)==null?void 0:c.isColor;!b&&A.setScalar?A.setScalar(f):A instanceof bg&&f instanceof bg?A.mask=f.mask:A.set(f),!SK()&&o&&!o.linear&&b&&A.convertSRGBToLinear()}}else{var g;if(m[C]=f,(g=m[C])!=null&&g.isTexture&&m[C].format===Wi&&m[C].type===vo&&o){const b=m[C];eB(b)&&eB(o.gl)?b.colorSpace=o.gl.outputColorSpace:b.encoding=o.gl.outputEncoding}}Lu(t)}if(i&&i.parent&&t.raycast&&l!==i.eventCount){const d=Cp(t).getState().internal,C=d.interaction.indexOf(t);C>-1&&d.interaction.splice(C,1),i.eventCount&&d.interaction.push(t)}return!(s.length===1&&s[0][0]==="onUpdate")&&s.length&&(n=t.__r3f)!=null&&n.parent&&zS(t),t}function Lu(t){var e,n;const i=(e=t.__r3f)==null||(n=e.root)==null||n.getState==null?void 0:n.getState();i&&i.internal.frames===0&&i.invalidate()}function zS(t){t.onUpdate==null||t.onUpdate(t)}function MK(t,e){t.manual||(wK(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix(),t.updateMatrixWorld())}function WA(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function Bce(){var t;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return cd.DefaultEventPriority;switch((t=e.event)==null?void 0:t.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return cd.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return cd.ContinuousEventPriority;default:return cd.DefaultEventPriority}}function NK(t,e,n,i){const r=n.get(e);r&&(n.delete(e),n.size===0&&(t.delete(i),r.target.releasePointerCapture(i)))}function Sce(t,e){const{internal:n}=t.getState();n.interaction=n.interaction.filter(i=>i!==e),n.initialHits=n.initialHits.filter(i=>i!==e),n.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&n.hovered.delete(r)}),n.capturedMap.forEach((i,r)=>{NK(n.capturedMap,e,i,r)})}function wce(t){function e(l){const{internal:c}=t.getState(),g=l.offsetX-c.initialClick[0],u=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(g*g+u*u))}function n(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(g=>{var u;return(u=c.__r3f)==null?void 0:u.handlers["onPointer"+g]}))}function i(l,c){const g=t.getState(),u=new Set,d=[],C=c?c(g.internal.interaction):g.internal.interaction;for(let m=0;m<C.length;m++){const A=jI(C[m]);A&&(A.raycaster.camera=void 0)}g.previousRoot||g.events.compute==null||g.events.compute(l,g);function f(m){const A=jI(m);if(!A||!A.events.enabled||A.raycaster.camera===null)return[];if(A.raycaster.camera===void 0){var b;A.events.compute==null||A.events.compute(l,A,(b=A.previousRoot)==null?void 0:b.getState()),A.raycaster.camera===void 0&&(A.raycaster.camera=null)}return A.raycaster.camera?A.raycaster.intersectObject(m,!0):[]}let v=C.flatMap(f).sort((m,A)=>{const b=jI(m.object),G=jI(A.object);return!b||!G?m.distance-A.distance:G.events.priority-b.events.priority||m.distance-A.distance}).filter(m=>{const A=WA(m);return u.has(A)?!1:(u.add(A),!0)});g.events.filter&&(v=g.events.filter(v,g));for(const m of v){let A=m.object;for(;A;){var p;(p=A.__r3f)!=null&&p.eventCount&&d.push({...m,eventObject:A}),A=A.parent}}if("pointerId"in l&&g.internal.capturedMap.has(l.pointerId))for(let m of g.internal.capturedMap.get(l.pointerId).values())u.has(WA(m.intersection))||d.push(m.intersection);return d}function r(l,c,g,u){const d=t.getState();if(l.length){const C={stopped:!1};for(const f of l){const v=jI(f.object)||d,{raycaster:p,pointer:m,camera:A,internal:b}=v,G=new ge(m.x,m.y,0).unproject(A),w=W=>{var M,N;return(M=(N=b.capturedMap.get(W))==null?void 0:N.has(f.eventObject))!=null?M:!1},S=W=>{const M={intersection:f,target:c.target};b.capturedMap.has(W)?b.capturedMap.get(W).set(f.eventObject,M):b.capturedMap.set(W,new Map([[f.eventObject,M]])),c.target.setPointerCapture(W)},Z=W=>{const M=b.capturedMap.get(W);M&&NK(b.capturedMap,f.eventObject,M,W)};let x={};for(let W in c){let M=c[W];typeof M!="function"&&(x[W]=M)}let R={...f,...x,pointer:m,intersections:l,stopped:C.stopped,delta:g,unprojectedPoint:G,ray:p.ray,camera:A,stopPropagation(){const W="pointerId"in c&&b.capturedMap.get(c.pointerId);if((!W||W.has(f.eventObject))&&(R.stopped=C.stopped=!0,b.hovered.size&&Array.from(b.hovered.values()).find(M=>M.eventObject===f.eventObject))){const M=l.slice(0,l.indexOf(f));o([...M,f])}},target:{hasPointerCapture:w,setPointerCapture:S,releasePointerCapture:Z},currentTarget:{hasPointerCapture:w,setPointerCapture:S,releasePointerCapture:Z},nativeEvent:c};if(u(R),C.stopped===!0)break}}return l}function o(l){const{internal:c}=t.getState();for(const g of c.hovered.values())if(!l.length||!l.find(u=>u.object===g.object&&u.index===g.index&&u.instanceId===g.instanceId)){const d=g.eventObject.__r3f,C=d==null?void 0:d.handlers;if(c.hovered.delete(WA(g)),d!=null&&d.eventCount){const f={...g,intersections:l};C.onPointerOut==null||C.onPointerOut(f),C.onPointerLeave==null||C.onPointerLeave(f)}}}function a(l,c){for(let g=0;g<c.length;g++){const u=c[g].__r3f;u==null||u.handlers.onPointerMissed==null||u.handlers.onPointerMissed(l)}}function s(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>o([]);case"onLostPointerCapture":return c=>{const{internal:g}=t.getState();"pointerId"in c&&g.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{g.capturedMap.has(c.pointerId)&&(g.capturedMap.delete(c.pointerId),o([]))})}}return function(g){const{onPointerMissed:u,internal:d}=t.getState();d.lastEvent.current=g;const C=l==="onPointerMove",f=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",p=i(g,C?n:void 0),m=f?e(g):0;l==="onPointerDown"&&(d.initialClick=[g.offsetX,g.offsetY],d.initialHits=p.map(b=>b.eventObject)),f&&!p.length&&m<=2&&(a(g,d.interaction),u&&u(g)),C&&o(p);function A(b){const G=b.eventObject,w=G.__r3f,S=w==null?void 0:w.handlers;if(w!=null&&w.eventCount)if(C){if(S.onPointerOver||S.onPointerEnter||S.onPointerOut||S.onPointerLeave){const Z=WA(b),x=d.hovered.get(Z);x?x.stopped&&b.stopPropagation():(d.hovered.set(Z,b),S.onPointerOver==null||S.onPointerOver(b),S.onPointerEnter==null||S.onPointerEnter(b))}S.onPointerMove==null||S.onPointerMove(b)}else{const Z=S[l];Z?(!f||d.initialHits.includes(G))&&(a(g,d.interaction.filter(x=>!d.initialHits.includes(x))),Z(b)):f&&d.initialHits.includes(G)&&a(g,d.interaction.filter(x=>!d.initialHits.includes(x)))}}r(p,g,m,A)}}return{handlePointer:s}}const Zce=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],FK=t=>!!(t!=null&&t.render),V1=y.createContext(null),xce=(t,e)=>{const n=mK((s,l)=>{const c=new ge,g=new ge,u=new ge;function d(m=l().camera,A=g,b=l().size){const{width:G,height:w,top:S,left:Z}=b,x=G/w;A.isVector3?u.copy(A):u.set(...A);const R=m.getWorldPosition(c).distanceTo(u);if(wK(m))return{width:G/m.zoom,height:w/m.zoom,top:S,left:Z,factor:1,distance:R,aspect:x};{const W=m.fov*Math.PI/180,M=2*Math.tan(W/2)*R,N=M*(G/w);return{width:N,height:M,top:S,left:Z,factor:G/N,distance:R,aspect:x}}}let C;const f=m=>s(A=>({performance:{...A.performance,current:m}})),v=new gt;return{set:s,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(m=1)=>t(l(),m),advance:(m,A)=>e(m,A,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new B1,pointer:v,mouse:v,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const m=l();C&&clearTimeout(C),m.performance.current!==m.performance.min&&f(m.performance.min),C=setTimeout(()=>f(l().performance.max),m.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:d},setEvents:m=>s(A=>({...A,events:{...A.events,...m}})),setSize:(m,A,b,G,w)=>{const S=l().camera,Z={width:m,height:A,top:G||0,left:w||0,updateStyle:b};s(x=>({size:Z,viewport:{...x.viewport,...d(S,g,Z)}}))},setDpr:m=>s(A=>{const b=WK(m);return{viewport:{...A.viewport,dpr:b,initialDpr:A.viewport.initialDpr||b}}}),setFrameloop:(m="always")=>{const A=l().clock;A.stop(),A.elapsedTime=0,m!=="never"&&(A.start(),A.elapsedTime=0),s(()=>({frameloop:m}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:y.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(m,A,b)=>{const G=l().internal;return G.priority=G.priority+(A>0?1:0),G.subscribers.push({ref:m,priority:A,store:b}),G.subscribers=G.subscribers.sort((w,S)=>w.priority-S.priority),()=>{const w=l().internal;w!=null&&w.subscribers&&(w.priority=w.priority-(A>0?1:0),w.subscribers=w.subscribers.filter(S=>S.ref!==m))}}}}}),i=n.getState();let r=i.size,o=i.viewport.dpr,a=i.camera;return n.subscribe(()=>{const{camera:s,size:l,viewport:c,gl:g,set:u}=n.getState();if(l.width!==r.width||l.height!==r.height||c.dpr!==o){var d;r=l,o=c.dpr,MK(s,l),g.setPixelRatio(c.dpr);const C=(d=l.updateStyle)!=null?d:typeof HTMLCanvasElement<"u"&&g.domElement instanceof HTMLCanvasElement;g.setSize(l.width,l.height,C)}s!==a&&(a=s,u(C=>({viewport:{...C.viewport,...C.viewport.getCurrentViewport(s)}})))}),n.subscribe(s=>t(s)),n};let VA,Rce=new Set,Wce=new Set,Vce=new Set;function iB(t,e){if(t.size)for(const{callback:n}of t.values())n(e)}function $I(t,e){switch(t){case"before":return iB(Rce,e);case"after":return iB(Wce,e);case"tail":return iB(Vce,e)}}let rB,oB;function aB(t,e,n){let i=e.clock.getDelta();for(e.frameloop==="never"&&typeof t=="number"&&(i=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),rB=e.internal.subscribers,VA=0;VA<rB.length;VA++)oB=rB[VA],oB.ref.current(oB.store.getState(),i,n);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function Mce(t){let e=!1,n=!1,i,r,o;function a(c){r=requestAnimationFrame(a),e=!0,i=0,$I("before",c),n=!0;for(const u of t.values()){var g;o=u.store.getState(),o.internal.active&&(o.frameloop==="always"||o.internal.frames>0)&&!((g=o.gl.xr)!=null&&g.isPresenting)&&(i+=aB(c,o))}if(n=!1,$I("after",c),i===0)return $I("tail",c),e=!1,cancelAnimationFrame(r)}function s(c,g=1){var u;if(!c)return t.forEach(d=>s(d.store.getState(),g));(u=c.gl.xr)!=null&&u.isPresenting||!c.internal.active||c.frameloop==="never"||(g>1?c.internal.frames=Math.min(60,c.internal.frames+g):n?c.internal.frames=2:c.internal.frames=1,e||(e=!0,requestAnimationFrame(a)))}function l(c,g=!0,u,d){if(g&&$I("before",c),u)aB(c,u,d);else for(const C of t.values())aB(c,C.store.getState());g&&$I("after",c)}return{loop:a,invalidate:s,advance:l}}function M1(){const t=y.useContext(V1);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function Dr(t=n=>n,e){return M1()(t,e)}function N1(t,e=0){const n=M1(),i=n.getState().internal.subscribe,r=ZK(t);return vf(()=>i(r,e,n),[e,i,n]),null}const LF=new WeakMap;function HK(t,e){return function(n,...i){let r=LF.get(n);return r||(r=new n,LF.set(n,r)),t&&t(r),Promise.all(i.map(o=>new Promise((a,s)=>r.load(o,l=>{l.scene&&Object.assign(l,bce(l.scene)),a(l)},e,l=>s(new Error(`Could not load ${o}: ${l==null?void 0:l.message}`))))))}}function Pd(t,e,n,i){const r=Array.isArray(e)?e:[e],o=vK(HK(n,i),[t,...r],{equal:$n.equ});return Array.isArray(e)?o:o[0]}Pd.preload=function(t,e,n){const i=Array.isArray(e)?e:[e];return gce(HK(n),[t,...i])};Pd.clear=function(t,e){const n=Array.isArray(e)?e:[e];return uce([t,...n])};const Ud=new Map,{invalidate:TF,advance:_F}=Mce(Ud),{reconciler:Yh,applyProps:Kl}=mce(Ud,Bce),Eu={objects:"shallow",strict:!1},Nce=(t,e)=>{const n=typeof t=="function"?t(e):t;return FK(n)?n:new a1({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...t})};function Fce(t,e){const n=typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement;if(e){const{width:i,height:r,top:o,left:a,updateStyle:s=n}=e;return{width:i,height:r,top:o,left:a,updateStyle:s}}else if(typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&t.parentElement){const{width:i,height:r,top:o,left:a}=t.parentElement.getBoundingClientRect();return{width:i,height:r,top:o,left:a,updateStyle:n}}else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height,top:0,left:0,updateStyle:n};return{width:0,height:0,top:0,left:0}}function Hce(t){const e=Ud.get(t),n=e==null?void 0:e.fiber,i=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,o=i||xce(TF,_F),a=n||Yh.createContainer(o,cd.ConcurrentRoot,null,!1,null,"",r,null);e||Ud.set(t,{fiber:a,store:o});let s,l=!1,c;return{configure(g={}){let{gl:u,size:d,scene:C,events:f,onCreated:v,shadows:p=!1,linear:m=!1,flat:A=!1,legacy:b=!1,orthographic:G=!1,frameloop:w="always",dpr:S=[1,2],performance:Z,raycaster:x,camera:R,onPointerMissed:W}=g,M=o.getState(),N=M.gl;M.gl||M.set({gl:N=Nce(u,t)});let X=M.raycaster;X||M.set({raycaster:X=new x1});const{params:E,...Q}=x||{};if($n.equ(Q,X,Eu)||Kl(X,{...Q}),$n.equ(E,X.params,Eu)||Kl(X,{params:{...X.params,...E}}),!M.camera||M.camera===c&&!$n.equ(c,R,Eu)){c=R;const z=R instanceof gf,K=z?R:G?new il(0,0,0,0,.1,1e3):new Ri(75,0,.1,1e3);z||(K.position.z=5,R&&(Kl(K,R),("aspect"in R||"left"in R||"right"in R||"bottom"in R||"top"in R)&&(K.manual=!0,K.updateProjectionMatrix())),!M.camera&&!(R!=null&&R.rotation)&&K.lookAt(0,0,0)),M.set({camera:K}),X.camera=K}if(!M.scene){let z;C!=null&&C.isScene?z=C:(z=new If,C&&Kl(z,C)),M.set({scene:Ku(z)})}if(!M.xr){var k;const z=(j,P)=>{const $=o.getState();$.frameloop!=="never"&&_F(j,!0,$,P)},K=()=>{const j=o.getState();j.gl.xr.enabled=j.gl.xr.isPresenting,j.gl.xr.setAnimationLoop(j.gl.xr.isPresenting?z:null),j.gl.xr.isPresenting||TF(j)},O={connect(){const j=o.getState().gl;j.xr.addEventListener("sessionstart",K),j.xr.addEventListener("sessionend",K)},disconnect(){const j=o.getState().gl;j.xr.removeEventListener("sessionstart",K),j.xr.removeEventListener("sessionend",K)}};typeof((k=N.xr)==null?void 0:k.addEventListener)=="function"&&O.connect(),M.set({xr:O})}if(N.shadowMap){const z=N.shadowMap.enabled,K=N.shadowMap.type;if(N.shadowMap.enabled=!!p,$n.boo(p))N.shadowMap.type=RC;else if($n.str(p)){var J;const O={basic:fz,percentage:Rv,soft:RC,variance:Ea};N.shadowMap.type=(J=O[p])!=null?J:RC}else $n.obj(p)&&Object.assign(N.shadowMap,p);(z!==N.shadowMap.enabled||K!==N.shadowMap.type)&&(N.shadowMap.needsUpdate=!0)}const F=SK();F&&("enabled"in F?F.enabled=!b:"legacyMode"in F&&(F.legacyMode=b)),l||Kl(N,{outputEncoding:m?3e3:3001,toneMapping:A?Gs:KZ}),M.legacy!==b&&M.set(()=>({legacy:b})),M.linear!==m&&M.set(()=>({linear:m})),M.flat!==A&&M.set(()=>({flat:A})),u&&!$n.fun(u)&&!FK(u)&&!$n.equ(u,N,Eu)&&Kl(N,u),f&&!M.events.handlers&&M.set({events:f(o)});const L=Fce(t,d);return $n.equ(L,M.size,Eu)||M.setSize(L.width,L.height,L.updateStyle,L.top,L.left),S&&M.viewport.dpr!==WK(S)&&M.setDpr(S),M.frameloop!==w&&M.setFrameloop(w),M.onPointerMissed||M.set({onPointerMissed:W}),Z&&!$n.equ(Z,M.performance,Eu)&&M.set(z=>({performance:{...z.performance,...Z}})),s=v,l=!0,this},render(g){return l||this.configure(),Yh.updateContainer(Nt.jsx(Xce,{store:o,children:g,onCreated:s,rootElement:t}),a,null,()=>{}),o},unmount(){XK(t)}}}function Xce({store:t,children:e,onCreated:n,rootElement:i}){return vf(()=>{const r=t.getState();r.set(o=>({internal:{...o.internal,active:!0}})),n&&n(r),t.getState().events.connected||r.events.connect==null||r.events.connect(i)},[]),Nt.jsx(V1.Provider,{value:t,children:e})}function XK(t,e){const n=Ud.get(t),i=n==null?void 0:n.fiber;if(i){const r=n==null?void 0:n.store.getState();r&&(r.internal.active=!1),Yh.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var o,a,s,l;r.events.disconnect==null||r.events.disconnect(),(o=r.gl)==null||(a=o.renderLists)==null||a.dispose==null||a.dispose(),(s=r.gl)==null||s.forceContextLoss==null||s.forceContextLoss(),(l=r.gl)!=null&&l.xr&&r.xr.disconnect(),yce(r),Ud.delete(t)}catch{}},500)})}}function Ece(t,e,n){return Nt.jsx(Yce,{children:t,container:e,state:n},e.uuid)}function Yce({state:t={},children:e,container:n}){const{events:i,size:r,...o}=t,a=M1(),[s]=y.useState(()=>new x1),[l]=y.useState(()=>new gt),c=y.useCallback((u,d)=>{const C={...u};Object.keys(u).forEach(v=>{(Zce.includes(v)||u[v]!==d[v]&&d[v])&&delete C[v]});let f;if(d&&r){const v=d.camera;f=u.viewport.getCurrentViewport(v,new ge,r),v!==u.camera&&MK(v,r)}return{...C,scene:n,raycaster:s,pointer:l,mouse:l,previousRoot:a,events:{...u.events,...d==null?void 0:d.events,...i},size:{...u.size,...r},viewport:{...u.viewport,...f},...o}},[t]),[g]=y.useState(()=>{const u=a.getState();return mK((C,f)=>({...u,scene:n,raycaster:s,pointer:l,mouse:l,previousRoot:a,events:{...u.events,...i},size:{...u.size,...r},...o,set:C,get:f,setEvents:v=>C(p=>({...p,events:{...p.events,...v}}))}))});return y.useEffect(()=>{const u=a.subscribe(d=>g.setState(C=>c(d,C)));return()=>{u()}},[c]),y.useEffect(()=>{g.setState(u=>c(a.getState(),u))},[c]),y.useEffect(()=>()=>{g.destroy()},[]),Nt.jsx(Nt.Fragment,{children:Yh.createPortal(Nt.jsx(V1.Provider,{value:g,children:e}),g,null)})}Yh.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:y.version});const sB={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function zce(t){const{handlePointer:e}=wce(t);return{priority:1,enabled:!0,compute(n,i,r){i.pointer.set(n.offsetX/i.size.width*2-1,-(n.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(sB).reduce((n,i)=>({...n,[i]:e(i)}),{}),update:()=>{var n;const{events:i,internal:r}=t.getState();(n=r.lastEvent)!=null&&n.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:n=>{var i;const{set:r,events:o}=t.getState();o.disconnect==null||o.disconnect(),r(a=>({events:{...a.events,connected:n}})),Object.entries((i=o.handlers)!=null?i:[]).forEach(([a,s])=>{const[l,c]=sB[a];n.addEventListener(l,s,{passive:c})})},disconnect:()=>{const{set:n,events:i}=t.getState();if(i.connected){var r;Object.entries((r=i.handlers)!=null?r:[]).forEach(([o,a])=>{if(i&&i.connected instanceof HTMLElement){const[s]=sB[o];i.connected.removeEventListener(s,a)}}),n(o=>({events:{...o.events,connected:void 0}}))}}}}function kF(t,e){let n;return(...i)=>{window.clearTimeout(n),n=window.setTimeout(()=>t(...i),e)}}function Kce({debounce:t,scroll:e,polyfill:n,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const r=n||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,a]=y.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),s=y.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o,orientationHandler:null}),l=t?typeof t=="number"?t:t.scroll:null,c=t?typeof t=="number"?t:t.resize:null,g=y.useRef(!1);y.useEffect(()=>(g.current=!0,()=>void(g.current=!1)));const[u,d,C]=y.useMemo(()=>{const m=()=>{if(!s.current.element)return;const{left:A,top:b,width:G,height:w,bottom:S,right:Z,x,y:R}=s.current.element.getBoundingClientRect(),W={left:A,top:b,width:G,height:w,bottom:S,right:Z,x,y:R};s.current.element instanceof HTMLElement&&i&&(W.height=s.current.element.offsetHeight,W.width=s.current.element.offsetWidth),Object.freeze(W),g.current&&!kce(s.current.lastBounds,W)&&a(s.current.lastBounds=W)};return[m,c?kF(m,c):m,l?kF(m,l):m]},[a,i,l,c]);function f(){s.current.scrollContainers&&(s.current.scrollContainers.forEach(m=>m.removeEventListener("scroll",C,!0)),s.current.scrollContainers=null),s.current.resizeObserver&&(s.current.resizeObserver.disconnect(),s.current.resizeObserver=null),s.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",s.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",s.current.orientationHandler))}function v(){s.current.element&&(s.current.resizeObserver=new r(C),s.current.resizeObserver.observe(s.current.element),e&&s.current.scrollContainers&&s.current.scrollContainers.forEach(m=>m.addEventListener("scroll",C,{capture:!0,passive:!0})),s.current.orientationHandler=()=>{C()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",s.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",s.current.orientationHandler))}const p=m=>{!m||m===s.current.element||(f(),s.current.element=m,s.current.scrollContainers=EK(m),v())};return Tce(C,!!e),Lce(d),y.useEffect(()=>{f(),v()},[e,C,d]),y.useEffect(()=>f,[]),[p,o,u]}function Lce(t){y.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function Tce(t,e){y.useEffect(()=>{if(e){const n=t;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[t,e])}function EK(t){const e=[];if(!t||t===document.body)return e;const{overflow:n,overflowX:i,overflowY:r}=window.getComputedStyle(t);return[n,i,r].some(o=>o==="auto"||o==="scroll")&&e.push(t),[...e,...EK(t.parentElement)]}const _ce=["x","y","top","bottom","left","right","width","height"],kce=(t,e)=>_ce.every(n=>t[n]===e[n]);var Pce=Object.defineProperty,Uce=Object.defineProperties,Dce=Object.getOwnPropertyDescriptors,PF=Object.getOwnPropertySymbols,Oce=Object.prototype.hasOwnProperty,Jce=Object.prototype.propertyIsEnumerable,UF=(t,e,n)=>e in t?Pce(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,DF=(t,e)=>{for(var n in e||(e={}))Oce.call(e,n)&&UF(t,n,e[n]);if(PF)for(var n of PF(e))Jce.call(e,n)&&UF(t,n,e[n]);return t},Qce=(t,e)=>Uce(t,Dce(e)),OF,JF;typeof window<"u"&&((OF=window.document)!=null&&OF.createElement||((JF=window.navigator)==null?void 0:JF.product)==="ReactNative")?y.useLayoutEffect:y.useEffect;function YK(t,e,n){if(!t)return;if(n(t)===!0)return t;let i=t.child;for(;i;){const r=YK(i,e,n);if(r)return r;i=i.sibling}}function zK(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const QF=console.error;console.error=function(){const t=[...arguments].join("");if(t!=null&&t.startsWith("Warning:")&&t.includes("useContext")){console.error=QF;return}return QF.apply(this,arguments)};const F1=zK(y.createContext(null));class KK extends y.Component{render(){return y.createElement(F1.Provider,{value:this._reactInternals},this.props.children)}}function jce(){const t=y.useContext(F1);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=y.useId();return y.useMemo(()=>{for(const i of[t,t==null?void 0:t.alternate]){if(!i)continue;const r=YK(i,!1,o=>{let a=o.memoizedState;for(;a;){if(a.memoizedState===e)return!0;a=a.next}});if(r)return r}},[t,e])}function $ce(){const t=jce(),[e]=y.useState(()=>new Map);e.clear();let n=t;for(;n;){if(n.type&&typeof n.type=="object"){const r=n.type._context===void 0&&n.type.Provider===n.type?n.type:n.type._context;r&&r!==F1&&!e.has(r)&&e.set(r,y.useContext(zK(r)))}n=n.return}return e}function qce(){const t=$ce();return y.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>i=>y.createElement(e,null,y.createElement(n.Provider,Qce(DF({},i),{value:t.get(n)}))),e=>y.createElement(KK,DF({},e))),[t])}const ege=y.forwardRef(function({children:e,fallback:n,resize:i,style:r,gl:o,events:a=zce,eventSource:s,eventPrefix:l,shadows:c,linear:g,flat:u,legacy:d,orthographic:C,frameloop:f,dpr:v,performance:p,raycaster:m,camera:A,scene:b,onPointerMissed:G,onCreated:w,...S},Z){y.useMemo(()=>BK(ace),[]);const x=qce(),[R,W]=Kce({scroll:!0,debounce:{scroll:50,resize:0},...i}),M=y.useRef(null),N=y.useRef(null);y.useImperativeHandle(Z,()=>M.current);const X=ZK(G),[E,Q]=y.useState(!1),[k,J]=y.useState(!1);if(E)throw E;if(k)throw k;const F=y.useRef(null);vf(()=>{const z=M.current;W.width>0&&W.height>0&&z&&(F.current||(F.current=Hce(z)),F.current.configure({gl:o,events:a,shadows:c,linear:g,flat:u,legacy:d,orthographic:C,frameloop:f,dpr:v,performance:p,raycaster:m,camera:A,scene:b,size:W,onPointerMissed:(...K)=>X.current==null?void 0:X.current(...K),onCreated:K=>{K.events.connect==null||K.events.connect(s?Ace(s)?s.current:s:N.current),l&&K.setEvents({compute:(O,j)=>{const P=O[l+"X"],$=O[l+"Y"];j.pointer.set(P/j.size.width*2-1,-($/j.size.height)*2+1),j.raycaster.setFromCamera(j.pointer,j.camera)}}),w==null||w(K)}}),F.current.render(Nt.jsx(x,{children:Nt.jsx(xK,{set:J,children:Nt.jsx(y.Suspense,{fallback:Nt.jsx(pce,{set:Q}),children:e??null})})})))}),y.useEffect(()=>{const z=M.current;if(z)return()=>XK(z)},[]);const L=s?"none":"auto";return Nt.jsx("div",{ref:N,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:L,...r},...S,children:Nt.jsx("div",{ref:R,style:{width:"100%",height:"100%"},children:Nt.jsx("canvas",{ref:M,style:{display:"block"},children:n})})})}),tge=y.forwardRef(function(e,n){return Nt.jsx(KK,{children:Nt.jsx(ege,{...e,ref:n})})}),LK=parseInt(rf.replace(/\D+/g,""));var Ia=Uint8Array,Ql=Uint16Array,KS=Uint32Array,TK=new Ia([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),_K=new Ia([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),nge=new Ia([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),kK=function(t,e){for(var n=new Ql(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];for(var r=new KS(n[30]),i=1;i<30;++i)for(var o=n[i];o<n[i+1];++o)r[o]=o-n[i]<<5|i;return[n,r]},PK=kK(TK,2),UK=PK[0],ige=PK[1];UK[28]=258,ige[258]=28;var rge=kK(_K,0),oge=rge[0],LS=new Ql(32768);for(var ri=0;ri<32768;++ri){var Hl=(ri&43690)>>>1|(ri&21845)<<1;Hl=(Hl&52428)>>>2|(Hl&13107)<<2,Hl=(Hl&61680)>>>4|(Hl&3855)<<4,LS[ri]=((Hl&65280)>>>8|(Hl&255)<<8)>>>1}var zC=function(t,e,n){for(var i=t.length,r=0,o=new Ql(e);r<i;++r)++o[t[r]-1];var a=new Ql(e);for(r=0;r<e;++r)a[r]=a[r-1]+o[r-1]<<1;var s;if(n){s=new Ql(1<<e);var l=15-e;for(r=0;r<i;++r)if(t[r])for(var c=r<<4|t[r],g=e-t[r],u=a[t[r]-1]++<<g,d=u|(1<<g)-1;u<=d;++u)s[LS[u]>>>l]=c}else for(s=new Ql(i),r=0;r<i;++r)t[r]&&(s[r]=LS[a[t[r]-1]++]>>>15-t[r]);return s},bf=new Ia(288);for(var ri=0;ri<144;++ri)bf[ri]=8;for(var ri=144;ri<256;++ri)bf[ri]=9;for(var ri=256;ri<280;++ri)bf[ri]=7;for(var ri=280;ri<288;++ri)bf[ri]=8;var DK=new Ia(32);for(var ri=0;ri<32;++ri)DK[ri]=5;var age=zC(bf,9,1),sge=zC(DK,5,1),lB=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},Ma=function(t,e,n){var i=e/8|0;return(t[i]|t[i+1]<<8)>>(e&7)&n},cB=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},lge=function(t){return(t/8|0)+(t&7&&1)},cge=function(t,e,n){(n==null||n>t.length)&&(n=t.length);var i=new(t instanceof Ql?Ql:t instanceof KS?KS:Ia)(n-e);return i.set(t.subarray(e,n)),i},gge=function(t,e,n){var i=t.length;if(!i||n&&!n.l&&i<5)return e||new Ia(0);var r=!e||n,o=!n||n.i;n||(n={}),e||(e=new Ia(i*3));var a=function(oe){var ie=e.length;if(oe>ie){var de=new Ia(Math.max(ie*2,oe));de.set(e),e=de}},s=n.f||0,l=n.p||0,c=n.b||0,g=n.l,u=n.d,d=n.m,C=n.n,f=i*8;do{if(!g){n.f=s=Ma(t,l,1);var v=Ma(t,l+1,3);if(l+=3,v)if(v==1)g=age,u=sge,d=9,C=5;else if(v==2){var b=Ma(t,l,31)+257,G=Ma(t,l+10,15)+4,w=b+Ma(t,l+5,31)+1;l+=14;for(var S=new Ia(w),Z=new Ia(19),x=0;x<G;++x)Z[nge[x]]=Ma(t,l+x*3,7);l+=G*3;for(var R=lB(Z),W=(1<<R)-1,M=zC(Z,R,1),x=0;x<w;){var N=M[Ma(t,l,W)];l+=N&15;var p=N>>>4;if(p<16)S[x++]=p;else{var X=0,E=0;for(p==16?(E=3+Ma(t,l,3),l+=2,X=S[x-1]):p==17?(E=3+Ma(t,l,7),l+=3):p==18&&(E=11+Ma(t,l,127),l+=7);E--;)S[x++]=X}}var Q=S.subarray(0,b),k=S.subarray(b);d=lB(Q),C=lB(k),g=zC(Q,d,1),u=zC(k,C,1)}else throw"invalid block type";else{var p=lge(l)+4,m=t[p-4]|t[p-3]<<8,A=p+m;if(A>i){if(o)throw"unexpected EOF";break}r&&a(c+m),e.set(t.subarray(p,A),c),n.b=c+=m,n.p=l=A*8;continue}if(l>f){if(o)throw"unexpected EOF";break}}r&&a(c+131072);for(var J=(1<<d)-1,F=(1<<C)-1,L=l;;L=l){var X=g[cB(t,l)&J],z=X>>>4;if(l+=X&15,l>f){if(o)throw"unexpected EOF";break}if(!X)throw"invalid length/literal";if(z<256)e[c++]=z;else if(z==256){L=l,g=null;break}else{var K=z-254;if(z>264){var x=z-257,O=TK[x];K=Ma(t,l,(1<<O)-1)+UK[x],l+=O}var j=u[cB(t,l)&F],P=j>>>4;if(!j)throw"invalid distance";l+=j&15;var k=oge[P];if(P>3){var O=_K[P];k+=cB(t,l)&(1<<O)-1,l+=O}if(l>f){if(o)throw"unexpected EOF";break}r&&a(c+131072);for(var $=c+K;c<$;c+=4)e[c]=e[c-k],e[c+1]=e[c+1-k],e[c+2]=e[c+2-k],e[c+3]=e[c+3-k];c=$}}n.l=g,n.p=L,n.b=c,g&&(s=1,n.m=d,n.d=u,n.n=C)}while(!s);return c==e.length?e:cge(e,0,c)},uge=new Ia(0),dge=function(t){if((t[0]&15)!=8||t[0]>>>4>7||(t[0]<<8|t[1])%31)throw"invalid zlib data";if(t[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function MA(t,e){return gge((dge(t),t.subarray(2,-4)),e)}var Ige=typeof TextDecoder<"u"&&new TextDecoder,Cge=0;try{Ige.decode(uge,{stream:!0}),Cge=1}catch{}const hge=t=>t&&t.isCubeTexture;class fge extends ti{constructor(e,n){var i,r;const o=hge(e),s=((r=o?(i=e.image[0])==null?void 0:i.width:e.image.width)!=null?r:1024)/4,l=Math.floor(Math.log2(s)),c=Math.pow(2,l),g=3*Math.max(c,16*7),u=4*c,d=[o?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/g}`,`#define CUBEUV_TEXEL_HEIGHT ${1/u}`,`#define CUBEUV_MAX_MIP ${l}.0`],C=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,f=d.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${LK>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,v={map:{value:e},height:{value:(n==null?void 0:n.height)||15},radius:{value:(n==null?void 0:n.radius)||100}},p=new hf(1,16),m=new bo({uniforms:v,fragmentShader:f,vertexShader:C,side:da});super(p,m)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var mge=Object.defineProperty,Age=(t,e,n)=>e in t?mge(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,pge=(t,e,n)=>(Age(t,e+"",n),n);class vge{constructor(){pge(this,"_listeners")}addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const o=r.indexOf(n);o!==-1&&r.splice(o,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let o=0,a=r.length;o<a;o++)r[o].call(this,e);e.target=null}}}var bge=Object.defineProperty,yge=(t,e,n)=>e in t?bge(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,gn=(t,e,n)=>(yge(t,typeof e!="symbol"?e+"":e,n),n);const NA=new kg,jF=new Us,Gge=Math.cos(70*(Math.PI/180)),$F=(t,e)=>(t%e+e)%e;let Bge=class extends vge{constructor(e,n){super(),gn(this,"object"),gn(this,"domElement"),gn(this,"enabled",!0),gn(this,"target",new ge),gn(this,"minDistance",0),gn(this,"maxDistance",1/0),gn(this,"minZoom",0),gn(this,"maxZoom",1/0),gn(this,"minPolarAngle",0),gn(this,"maxPolarAngle",Math.PI),gn(this,"minAzimuthAngle",-1/0),gn(this,"maxAzimuthAngle",1/0),gn(this,"enableDamping",!1),gn(this,"dampingFactor",.05),gn(this,"enableZoom",!0),gn(this,"zoomSpeed",1),gn(this,"enableRotate",!0),gn(this,"rotateSpeed",1),gn(this,"enablePan",!0),gn(this,"panSpeed",1),gn(this,"screenSpacePanning",!0),gn(this,"keyPanSpeed",7),gn(this,"zoomToCursor",!1),gn(this,"autoRotate",!1),gn(this,"autoRotateSpeed",2),gn(this,"reverseOrbit",!1),gn(this,"reverseHorizontalOrbit",!1),gn(this,"reverseVerticalOrbit",!1),gn(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),gn(this,"mouseButtons",{LEFT:Oc.ROTATE,MIDDLE:Oc.DOLLY,RIGHT:Oc.PAN}),gn(this,"touches",{ONE:Jc.ROTATE,TWO:Jc.DOLLY_PAN}),gn(this,"target0"),gn(this,"position0"),gn(this,"zoom0"),gn(this,"_domElementKeyEvents",null),gn(this,"getPolarAngle"),gn(this,"getAzimuthalAngle"),gn(this,"setPolarAngle"),gn(this,"setAzimuthalAngle"),gn(this,"getDistance"),gn(this,"getZoomScale"),gn(this,"listenToKeyEvents"),gn(this,"stopListenToKeyEvents"),gn(this,"saveState"),gn(this,"reset"),gn(this,"update"),gn(this,"connect"),gn(this,"dispose"),gn(this,"dollyIn"),gn(this,"dollyOut"),gn(this,"getScale"),gn(this,"setScale"),this.object=e,this.domElement=n,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>g.phi,this.getAzimuthalAngle=()=>g.theta,this.setPolarAngle=Ie=>{let Te=$F(Ie,2*Math.PI),ue=g.phi;ue<0&&(ue+=2*Math.PI),Te<0&&(Te+=2*Math.PI);let Pe=Math.abs(Te-ue);2*Math.PI-Pe<Pe&&(Te<ue?Te+=2*Math.PI:ue+=2*Math.PI),u.phi=Te-ue,i.update()},this.setAzimuthalAngle=Ie=>{let Te=$F(Ie,2*Math.PI),ue=g.theta;ue<0&&(ue+=2*Math.PI),Te<0&&(Te+=2*Math.PI);let Pe=Math.abs(Te-ue);2*Math.PI-Pe<Pe&&(Te<ue?Te+=2*Math.PI:ue+=2*Math.PI),u.theta=Te-ue,i.update()},this.getDistance=()=>i.object.position.distanceTo(i.target),this.listenToKeyEvents=Ie=>{Ie.addEventListener("keydown",Ee),this._domElementKeyEvents=Ie},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Ee),this._domElementKeyEvents=null},this.saveState=()=>{i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=()=>{i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(r),i.update(),l=s.NONE},this.update=(()=>{const Ie=new ge,Te=new ge(0,1,0),ue=new sr().setFromUnitVectors(e.up,Te),Pe=ue.clone().invert(),be=new ge,Le=new sr,ct=2*Math.PI;return function(){const It=i.object.position;ue.setFromUnitVectors(e.up,Te),Pe.copy(ue).invert(),Ie.copy(It).sub(i.target),Ie.applyQuaternion(ue),g.setFromVector3(Ie),i.autoRotate&&l===s.NONE&&E(N()),i.enableDamping?(g.theta+=u.theta*i.dampingFactor,g.phi+=u.phi*i.dampingFactor):(g.theta+=u.theta,g.phi+=u.phi);let Vt=i.minAzimuthAngle,vt=i.maxAzimuthAngle;isFinite(Vt)&&isFinite(vt)&&(Vt<-Math.PI?Vt+=ct:Vt>Math.PI&&(Vt-=ct),vt<-Math.PI?vt+=ct:vt>Math.PI&&(vt-=ct),Vt<=vt?g.theta=Math.max(Vt,Math.min(vt,g.theta)):g.theta=g.theta>(Vt+vt)/2?Math.max(Vt,g.theta):Math.min(vt,g.theta)),g.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,g.phi)),g.makeSafe(),i.enableDamping===!0?i.target.addScaledVector(C,i.dampingFactor):i.target.add(C),i.zoomToCursor&&R||i.object.isOrthographicCamera?g.radius=j(g.radius):g.radius=j(g.radius*d),Ie.setFromSpherical(g),Ie.applyQuaternion(Pe),It.copy(i.target).add(Ie),i.object.matrixAutoUpdate||i.object.updateMatrix(),i.object.lookAt(i.target),i.enableDamping===!0?(u.theta*=1-i.dampingFactor,u.phi*=1-i.dampingFactor,C.multiplyScalar(1-i.dampingFactor)):(u.set(0,0,0),C.set(0,0,0));let et=!1;if(i.zoomToCursor&&R){let rt=null;if(i.object instanceof Ri&&i.object.isPerspectiveCamera){const ut=Ie.length();rt=j(ut*d);const Tt=ut-rt;i.object.position.addScaledVector(Z,Tt),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const ut=new ge(x.x,x.y,0);ut.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/d)),i.object.updateProjectionMatrix(),et=!0;const Tt=new ge(x.x,x.y,0);Tt.unproject(i.object),i.object.position.sub(Tt).add(ut),i.object.updateMatrixWorld(),rt=Ie.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;rt!==null&&(i.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(rt).add(i.object.position):(NA.origin.copy(i.object.position),NA.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(NA.direction))<Gge?e.lookAt(i.target):(jF.setFromNormalAndCoplanarPoint(i.object.up,i.target),NA.intersectPlane(jF,i.target))))}else i.object instanceof il&&i.object.isOrthographicCamera&&(et=d!==1,et&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/d)),i.object.updateProjectionMatrix()));return d=1,R=!1,et||be.distanceToSquared(i.object.position)>c||8*(1-Le.dot(i.object.quaternion))>c?(i.dispatchEvent(r),be.copy(i.object.position),Le.copy(i.object.quaternion),et=!1,!0):!1}})(),this.connect=Ie=>{i.domElement=Ie,i.domElement.style.touchAction="none",i.domElement.addEventListener("contextmenu",$e),i.domElement.addEventListener("pointerdown",Ce),i.domElement.addEventListener("pointercancel",fe),i.domElement.addEventListener("wheel",Fe)},this.dispose=()=>{var Ie,Te,ue,Pe,be,Le;i.domElement&&(i.domElement.style.touchAction="auto"),(Ie=i.domElement)==null||Ie.removeEventListener("contextmenu",$e),(Te=i.domElement)==null||Te.removeEventListener("pointerdown",Ce),(ue=i.domElement)==null||ue.removeEventListener("pointercancel",fe),(Pe=i.domElement)==null||Pe.removeEventListener("wheel",Fe),(be=i.domElement)==null||be.ownerDocument.removeEventListener("pointermove",se),(Le=i.domElement)==null||Le.ownerDocument.removeEventListener("pointerup",fe),i._domElementKeyEvents!==null&&i._domElementKeyEvents.removeEventListener("keydown",Ee)};const i=this,r={type:"change"},o={type:"start"},a={type:"end"},s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=s.NONE;const c=1e-6,g=new ES,u=new ES;let d=1;const C=new ge,f=new gt,v=new gt,p=new gt,m=new gt,A=new gt,b=new gt,G=new gt,w=new gt,S=new gt,Z=new ge,x=new gt;let R=!1;const W=[],M={};function N(){return 2*Math.PI/60/60*i.autoRotateSpeed}function X(){return Math.pow(.95,i.zoomSpeed)}function E(Ie){i.reverseOrbit||i.reverseHorizontalOrbit?u.theta+=Ie:u.theta-=Ie}function Q(Ie){i.reverseOrbit||i.reverseVerticalOrbit?u.phi+=Ie:u.phi-=Ie}const k=(()=>{const Ie=new ge;return function(ue,Pe){Ie.setFromMatrixColumn(Pe,0),Ie.multiplyScalar(-ue),C.add(Ie)}})(),J=(()=>{const Ie=new ge;return function(ue,Pe){i.screenSpacePanning===!0?Ie.setFromMatrixColumn(Pe,1):(Ie.setFromMatrixColumn(Pe,0),Ie.crossVectors(i.object.up,Ie)),Ie.multiplyScalar(ue),C.add(Ie)}})(),F=(()=>{const Ie=new ge;return function(ue,Pe){const be=i.domElement;if(be&&i.object instanceof Ri&&i.object.isPerspectiveCamera){const Le=i.object.position;Ie.copy(Le).sub(i.target);let ct=Ie.length();ct*=Math.tan(i.object.fov/2*Math.PI/180),k(2*ue*ct/be.clientHeight,i.object.matrix),J(2*Pe*ct/be.clientHeight,i.object.matrix)}else be&&i.object instanceof il&&i.object.isOrthographicCamera?(k(ue*(i.object.right-i.object.left)/i.object.zoom/be.clientWidth,i.object.matrix),J(Pe*(i.object.top-i.object.bottom)/i.object.zoom/be.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}})();function L(Ie){i.object instanceof Ri&&i.object.isPerspectiveCamera||i.object instanceof il&&i.object.isOrthographicCamera?d=Ie:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function z(Ie){L(d/Ie)}function K(Ie){L(d*Ie)}function O(Ie){if(!i.zoomToCursor||!i.domElement)return;R=!0;const Te=i.domElement.getBoundingClientRect(),ue=Ie.clientX-Te.left,Pe=Ie.clientY-Te.top,be=Te.width,Le=Te.height;x.x=ue/be*2-1,x.y=-(Pe/Le)*2+1,Z.set(x.x,x.y,1).unproject(i.object).sub(i.object.position).normalize()}function j(Ie){return Math.max(i.minDistance,Math.min(i.maxDistance,Ie))}function P(Ie){f.set(Ie.clientX,Ie.clientY)}function $(Ie){O(Ie),G.set(Ie.clientX,Ie.clientY)}function oe(Ie){m.set(Ie.clientX,Ie.clientY)}function ie(Ie){v.set(Ie.clientX,Ie.clientY),p.subVectors(v,f).multiplyScalar(i.rotateSpeed);const Te=i.domElement;Te&&(E(2*Math.PI*p.x/Te.clientHeight),Q(2*Math.PI*p.y/Te.clientHeight)),f.copy(v),i.update()}function de(Ie){w.set(Ie.clientX,Ie.clientY),S.subVectors(w,G),S.y>0?z(X()):S.y<0&&K(X()),G.copy(w),i.update()}function Ve(Ie){A.set(Ie.clientX,Ie.clientY),b.subVectors(A,m).multiplyScalar(i.panSpeed),F(b.x,b.y),m.copy(A),i.update()}function Se(Ie){O(Ie),Ie.deltaY<0?K(X()):Ie.deltaY>0&&z(X()),i.update()}function me(Ie){let Te=!1;switch(Ie.code){case i.keys.UP:F(0,i.keyPanSpeed),Te=!0;break;case i.keys.BOTTOM:F(0,-i.keyPanSpeed),Te=!0;break;case i.keys.LEFT:F(i.keyPanSpeed,0),Te=!0;break;case i.keys.RIGHT:F(-i.keyPanSpeed,0),Te=!0;break}Te&&(Ie.preventDefault(),i.update())}function T(){if(W.length==1)f.set(W[0].pageX,W[0].pageY);else{const Ie=.5*(W[0].pageX+W[1].pageX),Te=.5*(W[0].pageY+W[1].pageY);f.set(Ie,Te)}}function Ge(){if(W.length==1)m.set(W[0].pageX,W[0].pageY);else{const Ie=.5*(W[0].pageX+W[1].pageX),Te=.5*(W[0].pageY+W[1].pageY);m.set(Ie,Te)}}function ne(){const Ie=W[0].pageX-W[1].pageX,Te=W[0].pageY-W[1].pageY,ue=Math.sqrt(Ie*Ie+Te*Te);G.set(0,ue)}function he(){i.enableZoom&&ne(),i.enablePan&&Ge()}function ae(){i.enableZoom&&ne(),i.enableRotate&&T()}function He(Ie){if(W.length==1)v.set(Ie.pageX,Ie.pageY);else{const ue=je(Ie),Pe=.5*(Ie.pageX+ue.x),be=.5*(Ie.pageY+ue.y);v.set(Pe,be)}p.subVectors(v,f).multiplyScalar(i.rotateSpeed);const Te=i.domElement;Te&&(E(2*Math.PI*p.x/Te.clientHeight),Q(2*Math.PI*p.y/Te.clientHeight)),f.copy(v)}function ve(Ie){if(W.length==1)A.set(Ie.pageX,Ie.pageY);else{const Te=je(Ie),ue=.5*(Ie.pageX+Te.x),Pe=.5*(Ie.pageY+Te.y);A.set(ue,Pe)}b.subVectors(A,m).multiplyScalar(i.panSpeed),F(b.x,b.y),m.copy(A)}function Me(Ie){const Te=je(Ie),ue=Ie.pageX-Te.x,Pe=Ie.pageY-Te.y,be=Math.sqrt(ue*ue+Pe*Pe);w.set(0,be),S.set(0,Math.pow(w.y/G.y,i.zoomSpeed)),z(S.y),G.copy(w)}function q(Ie){i.enableZoom&&Me(Ie),i.enablePan&&ve(Ie)}function Y(Ie){i.enableZoom&&Me(Ie),i.enableRotate&&He(Ie)}function Ce(Ie){var Te,ue;i.enabled!==!1&&(W.length===0&&((Te=i.domElement)==null||Te.ownerDocument.addEventListener("pointermove",se),(ue=i.domElement)==null||ue.ownerDocument.addEventListener("pointerup",fe)),st(Ie),Ie.pointerType==="touch"?Qe(Ie):Ze(Ie))}function se(Ie){i.enabled!==!1&&(Ie.pointerType==="touch"?Ye(Ie):Oe(Ie))}function fe(Ie){var Te,ue,Pe;Ue(Ie),W.length===0&&((Te=i.domElement)==null||Te.releasePointerCapture(Ie.pointerId),(ue=i.domElement)==null||ue.ownerDocument.removeEventListener("pointermove",se),(Pe=i.domElement)==null||Pe.ownerDocument.removeEventListener("pointerup",fe)),i.dispatchEvent(a),l=s.NONE}function Ze(Ie){let Te;switch(Ie.button){case 0:Te=i.mouseButtons.LEFT;break;case 1:Te=i.mouseButtons.MIDDLE;break;case 2:Te=i.mouseButtons.RIGHT;break;default:Te=-1}switch(Te){case Oc.DOLLY:if(i.enableZoom===!1)return;$(Ie),l=s.DOLLY;break;case Oc.ROTATE:if(Ie.ctrlKey||Ie.metaKey||Ie.shiftKey){if(i.enablePan===!1)return;oe(Ie),l=s.PAN}else{if(i.enableRotate===!1)return;P(Ie),l=s.ROTATE}break;case Oc.PAN:if(Ie.ctrlKey||Ie.metaKey||Ie.shiftKey){if(i.enableRotate===!1)return;P(Ie),l=s.ROTATE}else{if(i.enablePan===!1)return;oe(Ie),l=s.PAN}break;default:l=s.NONE}l!==s.NONE&&i.dispatchEvent(o)}function Oe(Ie){if(i.enabled!==!1)switch(l){case s.ROTATE:if(i.enableRotate===!1)return;ie(Ie);break;case s.DOLLY:if(i.enableZoom===!1)return;de(Ie);break;case s.PAN:if(i.enablePan===!1)return;Ve(Ie);break}}function Fe(Ie){i.enabled===!1||i.enableZoom===!1||l!==s.NONE&&l!==s.ROTATE||(Ie.preventDefault(),i.dispatchEvent(o),Se(Ie),i.dispatchEvent(a))}function Ee(Ie){i.enabled===!1||i.enablePan===!1||me(Ie)}function Qe(Ie){switch(Ne(Ie),W.length){case 1:switch(i.touches.ONE){case Jc.ROTATE:if(i.enableRotate===!1)return;T(),l=s.TOUCH_ROTATE;break;case Jc.PAN:if(i.enablePan===!1)return;Ge(),l=s.TOUCH_PAN;break;default:l=s.NONE}break;case 2:switch(i.touches.TWO){case Jc.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;he(),l=s.TOUCH_DOLLY_PAN;break;case Jc.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;ae(),l=s.TOUCH_DOLLY_ROTATE;break;default:l=s.NONE}break;default:l=s.NONE}l!==s.NONE&&i.dispatchEvent(o)}function Ye(Ie){switch(Ne(Ie),l){case s.TOUCH_ROTATE:if(i.enableRotate===!1)return;He(Ie),i.update();break;case s.TOUCH_PAN:if(i.enablePan===!1)return;ve(Ie),i.update();break;case s.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;q(Ie),i.update();break;case s.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;Y(Ie),i.update();break;default:l=s.NONE}}function $e(Ie){i.enabled!==!1&&Ie.preventDefault()}function st(Ie){W.push(Ie)}function Ue(Ie){delete M[Ie.pointerId];for(let Te=0;Te<W.length;Te++)if(W[Te].pointerId==Ie.pointerId){W.splice(Te,1);return}}function Ne(Ie){let Te=M[Ie.pointerId];Te===void 0&&(Te=new gt,M[Ie.pointerId]=Te),Te.set(Ie.pageX,Ie.pageY)}function je(Ie){const Te=Ie.pointerId===W[0].pointerId?W[1]:W[0];return M[Te.pointerId]}this.dollyIn=(Ie=X())=>{K(Ie),i.update()},this.dollyOut=(Ie=X())=>{z(Ie),i.update()},this.getScale=()=>d,this.setScale=Ie=>{L(Ie),i.update()},this.getZoomScale=()=>X(),n!==void 0&&this.connect(n),this.update()}};class Sge extends v1{constructor(e){super(e),this.type=or}parse(e){const a=function(x,R){switch(x){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(R||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(R||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(R||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(R||""))}},g=`
`,u=function(x,R,W){R=R||1024;let N=x.pos,X=-1,E=0,Q="",k=String.fromCharCode.apply(null,new Uint16Array(x.subarray(N,N+128)));for(;0>(X=k.indexOf(g))&&E<R&&N<x.byteLength;)Q+=k,E+=k.length,N+=128,k+=String.fromCharCode.apply(null,new Uint16Array(x.subarray(N,N+128)));return-1<X?(x.pos+=E+X+1,Q+k.slice(0,X)):!1},d=function(x){const R=/^#\?(\S+)/,W=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,M=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,N=/^\s*FORMAT=(\S+)\s*$/,X=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,E={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let Q,k;for((x.pos>=x.byteLength||!(Q=u(x)))&&a(1,"no header found"),(k=Q.match(R))||a(3,"bad initial token"),E.valid|=1,E.programtype=k[1],E.string+=Q+`
`;Q=u(x),Q!==!1;){if(E.string+=Q+`
`,Q.charAt(0)==="#"){E.comments+=Q+`
`;continue}if((k=Q.match(W))&&(E.gamma=parseFloat(k[1])),(k=Q.match(M))&&(E.exposure=parseFloat(k[1])),(k=Q.match(N))&&(E.valid|=2,E.format=k[1]),(k=Q.match(X))&&(E.valid|=4,E.height=parseInt(k[1],10),E.width=parseInt(k[2],10)),E.valid&2&&E.valid&4)break}return E.valid&2||a(3,"missing format specifier"),E.valid&4||a(3,"missing image size specifier"),E},C=function(x,R,W){const M=R;if(M<8||M>32767||x[0]!==2||x[1]!==2||x[2]&128)return new Uint8Array(x);M!==(x[2]<<8|x[3])&&a(3,"wrong scanline width");const N=new Uint8Array(4*R*W);N.length||a(4,"unable to allocate buffer space");let X=0,E=0;const Q=4*M,k=new Uint8Array(4),J=new Uint8Array(Q);let F=W;for(;F>0&&E<x.byteLength;){E+4>x.byteLength&&a(1),k[0]=x[E++],k[1]=x[E++],k[2]=x[E++],k[3]=x[E++],(k[0]!=2||k[1]!=2||(k[2]<<8|k[3])!=M)&&a(3,"bad rgbe scanline format");let L=0,z;for(;L<Q&&E<x.byteLength;){z=x[E++];const O=z>128;if(O&&(z-=128),(z===0||L+z>Q)&&a(3,"bad scanline data"),O){const j=x[E++];for(let P=0;P<z;P++)J[L++]=j}else J.set(x.subarray(E,E+z),L),L+=z,E+=z}const K=M;for(let O=0;O<K;O++){let j=0;N[X]=J[O+j],j+=M,N[X+1]=J[O+j],j+=M,N[X+2]=J[O+j],j+=M,N[X+3]=J[O+j],X+=4}F--}return N},f=function(x,R,W,M){const N=x[R+3],X=Math.pow(2,N-128)/255;W[M+0]=x[R+0]*X,W[M+1]=x[R+1]*X,W[M+2]=x[R+2]*X,W[M+3]=1},v=function(x,R,W,M){const N=x[R+3],X=Math.pow(2,N-128)/255;W[M+0]=dg.toHalfFloat(Math.min(x[R+0]*X,65504)),W[M+1]=dg.toHalfFloat(Math.min(x[R+1]*X,65504)),W[M+2]=dg.toHalfFloat(Math.min(x[R+2]*X,65504)),W[M+3]=dg.toHalfFloat(1)},p=new Uint8Array(e);p.pos=0;const m=d(p),A=m.width,b=m.height,G=C(p.subarray(p.pos),A,b);let w,S,Z;switch(this.type){case hi:Z=G.length/4;const x=new Float32Array(Z*4);for(let W=0;W<Z;W++)f(G,W*4,x,W*4);w=x,S=hi;break;case or:Z=G.length/4;const R=new Uint16Array(Z*4);for(let W=0;W<Z;W++)v(G,W*4,R,W*4);w=R,S=or;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:A,height:b,data:w,header:m.string,gamma:m.gamma,exposure:m.exposure,type:S}}setDataType(e){return this.type=e,this}load(e,n,i,r){function o(a,s){switch(a.type){case hi:case or:"colorSpace"in a?a.colorSpace="srgb-linear":a.encoding=3e3,a.minFilter=Kn,a.magFilter=Kn,a.generateMipmaps=!1,a.flipY=!0;break}n&&n(a,s)}return super.load(e,o,i,r)}}const qI=LK>=152;class wge extends v1{constructor(e){super(e),this.type=or}parse(e){const R=Math.pow(2.7182818,2.2);function W(U,ee){for(var Be=0,_=0;_<65536;++_)(_==0||U[_>>3]&1<<(_&7))&&(ee[Be++]=_);for(var te=Be-1;Be<65536;)ee[Be++]=0;return te}function M(U){for(var ee=0;ee<16384;ee++)U[ee]={},U[ee].len=0,U[ee].lit=0,U[ee].p=null}const N={l:0,c:0,lc:0};function X(U,ee,Be,_,te){for(;Be<U;)ee=ee<<8|je(_,te),Be+=8;Be-=U,N.l=ee>>Be&(1<<U)-1,N.c=ee,N.lc=Be}const E=new Array(59);function Q(U){for(var ee=0;ee<=58;++ee)E[ee]=0;for(var ee=0;ee<65537;++ee)E[U[ee]]+=1;for(var Be=0,ee=58;ee>0;--ee){var _=Be+E[ee]>>1;E[ee]=Be,Be=_}for(var ee=0;ee<65537;++ee){var te=U[ee];te>0&&(U[ee]=te|E[te]++<<6)}}function k(U,ee,Be,_,te,ce,le){for(var re=Be,xe=0,Xe=0;te<=ce;te++){if(re.value-Be.value>_)return!1;X(6,xe,Xe,U,re);var _e=N.l;if(xe=N.c,Xe=N.lc,le[te]=_e,_e==63){if(re.value-Be.value>_)throw"Something wrong with hufUnpackEncTable";X(8,xe,Xe,U,re);var We=N.l+6;if(xe=N.c,Xe=N.lc,te+We>ce+1)throw"Something wrong with hufUnpackEncTable";for(;We--;)le[te++]=0;te--}else if(_e>=59){var We=_e-59+2;if(te+We>ce+1)throw"Something wrong with hufUnpackEncTable";for(;We--;)le[te++]=0;te--}}Q(le)}function J(U){return U&63}function F(U){return U>>6}function L(U,ee,Be,_){for(;ee<=Be;ee++){var te=F(U[ee]),ce=J(U[ee]);if(te>>ce)throw"Invalid table entry";if(ce>14){var le=_[te>>ce-14];if(le.len)throw"Invalid table entry";if(le.lit++,le.p){var re=le.p;le.p=new Array(le.lit);for(var xe=0;xe<le.lit-1;++xe)le.p[xe]=re[xe]}else le.p=new Array(1);le.p[le.lit-1]=ee}else if(ce)for(var Xe=0,xe=1<<14-ce;xe>0;xe--){var le=_[(te<<14-ce)+Xe];if(le.len||le.p)throw"Invalid table entry";le.len=ce,le.lit=ee,Xe++}}return!0}const z={c:0,lc:0};function K(U,ee,Be,_){U=U<<8|je(Be,_),ee+=8,z.c=U,z.lc=ee}const O={c:0,lc:0};function j(U,ee,Be,_,te,ce,le,re,xe,Xe){if(U==ee){_<8&&(K(Be,_,te,le),Be=z.c,_=z.lc),_-=8;var _e=Be>>_,_e=new Uint8Array([_e])[0];if(xe.value+_e>Xe)return!1;for(var We=re[xe.value-1];_e-- >0;)re[xe.value++]=We}else if(xe.value<Xe)re[xe.value++]=U;else return!1;O.c=Be,O.lc=_}function P(U){return U&65535}function $(U){var ee=P(U);return ee>32767?ee-65536:ee}const oe={a:0,b:0};function ie(U,ee){var Be=$(U),_=$(ee),te=_,ce=Be+(te&1)+(te>>1),le=ce,re=ce-te;oe.a=le,oe.b=re}function de(U,ee){var Be=P(U),_=P(ee),te=Be-(_>>1)&65535,ce=_+te-32768&65535;oe.a=ce,oe.b=te}function Ve(U,ee,Be,_,te,ce,le){for(var re=le<16384,xe=Be>te?te:Be,Xe=1,_e;Xe<=xe;)Xe<<=1;for(Xe>>=1,_e=Xe,Xe>>=1;Xe>=1;){for(var We=0,pt=We+ce*(te-_e),lt=ce*Xe,nt=ce*_e,wt=_*Xe,ot=_*_e,bt,Wt,yt,ht;We<=pt;We+=nt){for(var Qt=We,zt=We+_*(Be-_e);Qt<=zt;Qt+=ot){var Pt=Qt+wt,dn=Qt+lt,un=dn+wt;re?(ie(U[Qt+ee],U[dn+ee]),bt=oe.a,yt=oe.b,ie(U[Pt+ee],U[un+ee]),Wt=oe.a,ht=oe.b,ie(bt,Wt),U[Qt+ee]=oe.a,U[Pt+ee]=oe.b,ie(yt,ht),U[dn+ee]=oe.a,U[un+ee]=oe.b):(de(U[Qt+ee],U[dn+ee]),bt=oe.a,yt=oe.b,de(U[Pt+ee],U[un+ee]),Wt=oe.a,ht=oe.b,de(bt,Wt),U[Qt+ee]=oe.a,U[Pt+ee]=oe.b,de(yt,ht),U[dn+ee]=oe.a,U[un+ee]=oe.b)}if(Be&Xe){var dn=Qt+lt;re?ie(U[Qt+ee],U[dn+ee]):de(U[Qt+ee],U[dn+ee]),bt=oe.a,U[dn+ee]=oe.b,U[Qt+ee]=bt}}if(te&Xe)for(var Qt=We,zt=We+_*(Be-_e);Qt<=zt;Qt+=ot){var Pt=Qt+wt;re?ie(U[Qt+ee],U[Pt+ee]):de(U[Qt+ee],U[Pt+ee]),bt=oe.a,U[Pt+ee]=oe.b,U[Qt+ee]=bt}_e=Xe,Xe>>=1}return We}function Se(U,ee,Be,_,te,ce,le,re,xe,Xe){for(var _e=0,We=0,pt=re,lt=Math.trunc(te.value+(ce+7)/8);te.value<lt;)for(K(_e,We,Be,te),_e=z.c,We=z.lc;We>=14;){var nt=_e>>We-14&16383,wt=ee[nt];if(wt.len)We-=wt.len,j(wt.lit,le,_e,We,Be,_,te,xe,Xe,pt),_e=O.c,We=O.lc;else{if(!wt.p)throw"hufDecode issues";var ot;for(ot=0;ot<wt.lit;ot++){for(var bt=J(U[wt.p[ot]]);We<bt&&te.value<lt;)K(_e,We,Be,te),_e=z.c,We=z.lc;if(We>=bt&&F(U[wt.p[ot]])==(_e>>We-bt&(1<<bt)-1)){We-=bt,j(wt.p[ot],le,_e,We,Be,_,te,xe,Xe,pt),_e=O.c,We=O.lc;break}}if(ot==wt.lit)throw"hufDecode issues"}}var Wt=8-ce&7;for(_e>>=Wt,We-=Wt;We>0;){var wt=ee[_e<<14-We&16383];if(wt.len)We-=wt.len,j(wt.lit,le,_e,We,Be,_,te,xe,Xe,pt),_e=O.c,We=O.lc;else throw"hufDecode issues"}return!0}function me(U,ee,Be,_,te,ce){var le={value:0},re=Be.value,xe=Ne(ee,Be),Xe=Ne(ee,Be);Be.value+=4;var _e=Ne(ee,Be);if(Be.value+=4,xe<0||xe>=65537||Xe<0||Xe>=65537)throw"Something wrong with HUF_ENCSIZE";var We=new Array(65537),pt=new Array(16384);M(pt);var lt=_-(Be.value-re);if(k(U,ee,Be,lt,xe,Xe,We),_e>8*(_-(Be.value-re)))throw"Something wrong with hufUncompress";L(We,xe,Xe,pt),Se(We,pt,U,ee,Be,_e,Xe,ce,te,le)}function T(U,ee,Be){for(var _=0;_<Be;++_)ee[_]=U[ee[_]]}function Ge(U){for(var ee=1;ee<U.length;ee++){var Be=U[ee-1]+U[ee]-128;U[ee]=Be}}function ne(U,ee){for(var Be=0,_=Math.floor((U.length+1)/2),te=0,ce=U.length-1;!(te>ce||(ee[te++]=U[Be++],te>ce));)ee[te++]=U[_++]}function he(U){for(var ee=U.byteLength,Be=new Array,_=0,te=new DataView(U);ee>0;){var ce=te.getInt8(_++);if(ce<0){var le=-ce;ee-=le+1;for(var re=0;re<le;re++)Be.push(te.getUint8(_++))}else{var le=ce;ee-=2;for(var xe=te.getUint8(_++),re=0;re<le+1;re++)Be.push(xe)}}return Be}function ae(U,ee,Be,_,te,ce){var Pt=new DataView(ce.buffer),le=Be[U.idx[0]].width,re=Be[U.idx[0]].height,xe=3,Xe=Math.floor(le/8),_e=Math.ceil(le/8),We=Math.ceil(re/8),pt=le-(_e-1)*8,lt=re-(We-1)*8,nt={value:0},wt=new Array(xe),ot=new Array(xe),bt=new Array(xe),Wt=new Array(xe),yt=new Array(xe);for(let mt=0;mt<xe;++mt)yt[mt]=ee[U.idx[mt]],wt[mt]=mt<1?0:wt[mt-1]+_e*We,ot[mt]=new Float32Array(64),bt[mt]=new Uint16Array(64),Wt[mt]=new Uint16Array(_e*64);for(let mt=0;mt<We;++mt){var ht=8;mt==We-1&&(ht=lt);var Qt=8;for(let Rt=0;Rt<_e;++Rt){Rt==_e-1&&(Qt=pt);for(let Xt=0;Xt<xe;++Xt)bt[Xt].fill(0),bt[Xt][0]=te[wt[Xt]++],He(nt,_,bt[Xt]),ve(bt[Xt],ot[Xt]),Me(ot[Xt]);q(ot);for(let Xt=0;Xt<xe;++Xt)Y(ot[Xt],Wt[Xt],Rt*64)}let Lt=0;for(let Rt=0;Rt<xe;++Rt){const Xt=Be[U.idx[Rt]].type;for(let en=8*mt;en<8*mt+ht;++en){Lt=yt[Rt][en];for(let Rn=0;Rn<Xe;++Rn){const bn=Rn*64+(en&7)*8;Pt.setUint16(Lt+0*2*Xt,Wt[Rt][bn+0],!0),Pt.setUint16(Lt+1*2*Xt,Wt[Rt][bn+1],!0),Pt.setUint16(Lt+2*2*Xt,Wt[Rt][bn+2],!0),Pt.setUint16(Lt+3*2*Xt,Wt[Rt][bn+3],!0),Pt.setUint16(Lt+4*2*Xt,Wt[Rt][bn+4],!0),Pt.setUint16(Lt+5*2*Xt,Wt[Rt][bn+5],!0),Pt.setUint16(Lt+6*2*Xt,Wt[Rt][bn+6],!0),Pt.setUint16(Lt+7*2*Xt,Wt[Rt][bn+7],!0),Lt+=8*2*Xt}}if(Xe!=_e)for(let en=8*mt;en<8*mt+ht;++en){const Rn=yt[Rt][en]+8*Xe*2*Xt,bn=Xe*64+(en&7)*8;for(let On=0;On<Qt;++On)Pt.setUint16(Rn+On*2*Xt,Wt[Rt][bn+On],!0)}}}for(var zt=new Uint16Array(le),Pt=new DataView(ce.buffer),dn=0;dn<xe;++dn){Be[U.idx[dn]].decoded=!0;var un=Be[U.idx[dn]].type;if(Be[dn].type==2)for(var In=0;In<re;++In){const mt=yt[dn][In];for(var Ht=0;Ht<le;++Ht)zt[Ht]=Pt.getUint16(mt+Ht*2*un,!0);for(var Ht=0;Ht<le;++Ht)Pt.setFloat32(mt+Ht*2*un,be(zt[Ht]),!0)}}}function He(U,ee,Be){for(var _,te=1;te<64;)_=ee[U.value],_==65280?te=64:_>>8==255?te+=_&255:(Be[te]=_,te++),U.value++}function ve(U,ee){ee[0]=be(U[0]),ee[1]=be(U[1]),ee[2]=be(U[5]),ee[3]=be(U[6]),ee[4]=be(U[14]),ee[5]=be(U[15]),ee[6]=be(U[27]),ee[7]=be(U[28]),ee[8]=be(U[2]),ee[9]=be(U[4]),ee[10]=be(U[7]),ee[11]=be(U[13]),ee[12]=be(U[16]),ee[13]=be(U[26]),ee[14]=be(U[29]),ee[15]=be(U[42]),ee[16]=be(U[3]),ee[17]=be(U[8]),ee[18]=be(U[12]),ee[19]=be(U[17]),ee[20]=be(U[25]),ee[21]=be(U[30]),ee[22]=be(U[41]),ee[23]=be(U[43]),ee[24]=be(U[9]),ee[25]=be(U[11]),ee[26]=be(U[18]),ee[27]=be(U[24]),ee[28]=be(U[31]),ee[29]=be(U[40]),ee[30]=be(U[44]),ee[31]=be(U[53]),ee[32]=be(U[10]),ee[33]=be(U[19]),ee[34]=be(U[23]),ee[35]=be(U[32]),ee[36]=be(U[39]),ee[37]=be(U[45]),ee[38]=be(U[52]),ee[39]=be(U[54]),ee[40]=be(U[20]),ee[41]=be(U[22]),ee[42]=be(U[33]),ee[43]=be(U[38]),ee[44]=be(U[46]),ee[45]=be(U[51]),ee[46]=be(U[55]),ee[47]=be(U[60]),ee[48]=be(U[21]),ee[49]=be(U[34]),ee[50]=be(U[37]),ee[51]=be(U[47]),ee[52]=be(U[50]),ee[53]=be(U[56]),ee[54]=be(U[59]),ee[55]=be(U[61]),ee[56]=be(U[35]),ee[57]=be(U[36]),ee[58]=be(U[48]),ee[59]=be(U[49]),ee[60]=be(U[57]),ee[61]=be(U[58]),ee[62]=be(U[62]),ee[63]=be(U[63])}function Me(U){const ee=.5*Math.cos(.7853975),Be=.5*Math.cos(3.14159/16),_=.5*Math.cos(3.14159/8),te=.5*Math.cos(3*3.14159/16),ce=.5*Math.cos(5*3.14159/16),le=.5*Math.cos(3*3.14159/8),re=.5*Math.cos(7*3.14159/16);for(var xe=new Array(4),Xe=new Array(4),_e=new Array(4),We=new Array(4),pt=0;pt<8;++pt){var lt=pt*8;xe[0]=_*U[lt+2],xe[1]=le*U[lt+2],xe[2]=_*U[lt+6],xe[3]=le*U[lt+6],Xe[0]=Be*U[lt+1]+te*U[lt+3]+ce*U[lt+5]+re*U[lt+7],Xe[1]=te*U[lt+1]-re*U[lt+3]-Be*U[lt+5]-ce*U[lt+7],Xe[2]=ce*U[lt+1]-Be*U[lt+3]+re*U[lt+5]+te*U[lt+7],Xe[3]=re*U[lt+1]-ce*U[lt+3]+te*U[lt+5]-Be*U[lt+7],_e[0]=ee*(U[lt+0]+U[lt+4]),_e[3]=ee*(U[lt+0]-U[lt+4]),_e[1]=xe[0]+xe[3],_e[2]=xe[1]-xe[2],We[0]=_e[0]+_e[1],We[1]=_e[3]+_e[2],We[2]=_e[3]-_e[2],We[3]=_e[0]-_e[1],U[lt+0]=We[0]+Xe[0],U[lt+1]=We[1]+Xe[1],U[lt+2]=We[2]+Xe[2],U[lt+3]=We[3]+Xe[3],U[lt+4]=We[3]-Xe[3],U[lt+5]=We[2]-Xe[2],U[lt+6]=We[1]-Xe[1],U[lt+7]=We[0]-Xe[0]}for(var nt=0;nt<8;++nt)xe[0]=_*U[16+nt],xe[1]=le*U[16+nt],xe[2]=_*U[48+nt],xe[3]=le*U[48+nt],Xe[0]=Be*U[8+nt]+te*U[24+nt]+ce*U[40+nt]+re*U[56+nt],Xe[1]=te*U[8+nt]-re*U[24+nt]-Be*U[40+nt]-ce*U[56+nt],Xe[2]=ce*U[8+nt]-Be*U[24+nt]+re*U[40+nt]+te*U[56+nt],Xe[3]=re*U[8+nt]-ce*U[24+nt]+te*U[40+nt]-Be*U[56+nt],_e[0]=ee*(U[nt]+U[32+nt]),_e[3]=ee*(U[nt]-U[32+nt]),_e[1]=xe[0]+xe[3],_e[2]=xe[1]-xe[2],We[0]=_e[0]+_e[1],We[1]=_e[3]+_e[2],We[2]=_e[3]-_e[2],We[3]=_e[0]-_e[1],U[0+nt]=We[0]+Xe[0],U[8+nt]=We[1]+Xe[1],U[16+nt]=We[2]+Xe[2],U[24+nt]=We[3]+Xe[3],U[32+nt]=We[3]-Xe[3],U[40+nt]=We[2]-Xe[2],U[48+nt]=We[1]-Xe[1],U[56+nt]=We[0]-Xe[0]}function q(U){for(var ee=0;ee<64;++ee){var Be=U[0][ee],_=U[1][ee],te=U[2][ee];U[0][ee]=Be+1.5747*te,U[1][ee]=Be-.1873*_-.4682*te,U[2][ee]=Be+1.8556*_}}function Y(U,ee,Be){for(var _=0;_<64;++_)ee[Be+_]=dg.toHalfFloat(Ce(U[_]))}function Ce(U){return U<=1?Math.sign(U)*Math.pow(Math.abs(U),2.2):Math.sign(U)*Math.pow(R,Math.abs(U)-1)}function se(U){return new DataView(U.array.buffer,U.offset.value,U.size)}function fe(U){var ee=U.viewer.buffer.slice(U.offset.value,U.offset.value+U.size),Be=new Uint8Array(he(ee)),_=new Uint8Array(Be.length);return Ge(Be),ne(Be,_),new DataView(_.buffer)}function Ze(U){var ee=U.array.slice(U.offset.value,U.offset.value+U.size),Be=MA(ee),_=new Uint8Array(Be.length);return Ge(Be),ne(Be,_),new DataView(_.buffer)}function Oe(U){for(var ee=U.viewer,Be={value:U.offset.value},_=new Uint16Array(U.width*U.scanlineBlockSize*(U.channels*U.type)),te=new Uint8Array(8192),ce=0,le=new Array(U.channels),re=0;re<U.channels;re++)le[re]={},le[re].start=ce,le[re].end=le[re].start,le[re].nx=U.width,le[re].ny=U.lines,le[re].size=U.type,ce+=le[re].nx*le[re].ny*le[re].size;var xe=Le(ee,Be),Xe=Le(ee,Be);if(Xe>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(xe<=Xe)for(var re=0;re<Xe-xe+1;re++)te[re+xe]=Ie(ee,Be);var _e=new Uint16Array(65536),We=W(te,_e),pt=Ne(ee,Be);me(U.array,ee,Be,pt,_,ce);for(var re=0;re<U.channels;++re)for(var lt=le[re],nt=0;nt<le[re].size;++nt)Ve(_,lt.start+nt,lt.nx,lt.size,lt.ny,lt.nx*lt.size,We);T(_e,_,ce);for(var wt=0,ot=new Uint8Array(_.buffer.byteLength),bt=0;bt<U.lines;bt++)for(var Wt=0;Wt<U.channels;Wt++){var lt=le[Wt],yt=lt.nx*lt.size,ht=new Uint8Array(_.buffer,lt.end*2,yt*2);ot.set(ht,wt),wt+=yt*2,lt.end+=yt}return new DataView(ot.buffer)}function Fe(U){var ee=U.array.slice(U.offset.value,U.offset.value+U.size),Be=MA(ee);const _=U.lines*U.channels*U.width,te=U.type==1?new Uint16Array(_):new Uint32Array(_);let ce=0,le=0;const re=new Array(4);for(let xe=0;xe<U.lines;xe++)for(let Xe=0;Xe<U.channels;Xe++){let _e=0;switch(U.type){case 1:re[0]=ce,re[1]=re[0]+U.width,ce=re[1]+U.width;for(let We=0;We<U.width;++We){const pt=Be[re[0]++]<<8|Be[re[1]++];_e+=pt,te[le]=_e,le++}break;case 2:re[0]=ce,re[1]=re[0]+U.width,re[2]=re[1]+U.width,ce=re[2]+U.width;for(let We=0;We<U.width;++We){const pt=Be[re[0]++]<<24|Be[re[1]++]<<16|Be[re[2]++]<<8;_e+=pt,te[le]=_e,le++}break}}return new DataView(te.buffer)}function Ee(U){var ee=U.viewer,Be={value:U.offset.value},_=new Uint8Array(U.width*U.lines*(U.channels*U.type*2)),te={version:Te(ee,Be),unknownUncompressedSize:Te(ee,Be),unknownCompressedSize:Te(ee,Be),acCompressedSize:Te(ee,Be),dcCompressedSize:Te(ee,Be),rleCompressedSize:Te(ee,Be),rleUncompressedSize:Te(ee,Be),rleRawSize:Te(ee,Be),totalAcUncompressedCount:Te(ee,Be),totalDcUncompressedCount:Te(ee,Be),acCompression:Te(ee,Be)};if(te.version<2)throw"EXRLoader.parse: "+Yt.compression+" version "+te.version+" is unsupported";for(var ce=new Array,le=Le(ee,Be)-2;le>0;){var re=Qe(ee.buffer,Be),xe=Ie(ee,Be),Xe=xe>>2&3,_e=(xe>>4)-1,We=new Int8Array([_e])[0],pt=Ie(ee,Be);ce.push({name:re,index:We,type:pt,compression:Xe}),le-=re.length+3}for(var lt=Yt.channels,nt=new Array(U.channels),wt=0;wt<U.channels;++wt){var ot=nt[wt]={},bt=lt[wt];ot.name=bt.name,ot.compression=0,ot.decoded=!1,ot.type=bt.pixelType,ot.pLinear=bt.pLinear,ot.width=U.width,ot.height=U.lines}for(var Wt={idx:new Array(3)},yt=0;yt<U.channels;++yt)for(var ot=nt[yt],wt=0;wt<ce.length;++wt){var ht=ce[wt];ot.name==ht.name&&(ot.compression=ht.compression,ht.index>=0&&(Wt.idx[ht.index]=yt),ot.offset=yt)}if(te.acCompressedSize>0)switch(te.acCompression){case 0:var Pt=new Uint16Array(te.totalAcUncompressedCount);me(U.array,ee,Be,te.acCompressedSize,Pt,te.totalAcUncompressedCount);break;case 1:var Qt=U.array.slice(Be.value,Be.value+te.totalAcUncompressedCount),zt=MA(Qt),Pt=new Uint16Array(zt.buffer);Be.value+=te.totalAcUncompressedCount;break}if(te.dcCompressedSize>0){var dn={array:U.array,offset:Be,size:te.dcCompressedSize},un=new Uint16Array(Ze(dn).buffer);Be.value+=te.dcCompressedSize}if(te.rleRawSize>0){var Qt=U.array.slice(Be.value,Be.value+te.rleCompressedSize),zt=MA(Qt),In=he(zt.buffer);Be.value+=te.rleCompressedSize}for(var Ht=0,mt=new Array(nt.length),wt=0;wt<mt.length;++wt)mt[wt]=new Array;for(var Lt=0;Lt<U.lines;++Lt)for(var Rt=0;Rt<nt.length;++Rt)mt[Rt].push(Ht),Ht+=nt[Rt].width*U.type*2;ae(Wt,mt,nt,Pt,un,_);for(var wt=0;wt<nt.length;++wt){var ot=nt[wt];if(!ot.decoded)switch(ot.compression){case 2:for(var Xt=0,en=0,Lt=0;Lt<U.lines;++Lt){for(var Rn=mt[wt][Xt],bn=0;bn<ot.width;++bn){for(var On=0;On<2*ot.type;++On)_[Rn++]=In[en+On*ot.width*ot.height];en++}Xt++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(_.buffer)}function Qe(U,ee){for(var Be=new Uint8Array(U),_=0;Be[ee.value+_]!=0;)_+=1;var te=new TextDecoder().decode(Be.slice(ee.value,ee.value+_));return ee.value=ee.value+_+1,te}function Ye(U,ee,Be){var _=new TextDecoder().decode(new Uint8Array(U).slice(ee.value,ee.value+Be));return ee.value=ee.value+Be,_}function $e(U,ee){var Be=Ue(U,ee),_=Ne(U,ee);return[Be,_]}function st(U,ee){var Be=Ne(U,ee),_=Ne(U,ee);return[Be,_]}function Ue(U,ee){var Be=U.getInt32(ee.value,!0);return ee.value=ee.value+4,Be}function Ne(U,ee){var Be=U.getUint32(ee.value,!0);return ee.value=ee.value+4,Be}function je(U,ee){var Be=U[ee.value];return ee.value=ee.value+1,Be}function Ie(U,ee){var Be=U.getUint8(ee.value);return ee.value=ee.value+1,Be}const Te=function(U,ee){let Be;return"getBigInt64"in DataView.prototype?Be=Number(U.getBigInt64(ee.value,!0)):Be=U.getUint32(ee.value+4,!0)+Number(U.getUint32(ee.value,!0)<<32),ee.value+=8,Be};function ue(U,ee){var Be=U.getFloat32(ee.value,!0);return ee.value+=4,Be}function Pe(U,ee){return dg.toHalfFloat(ue(U,ee))}function be(U){var ee=(U&31744)>>10,Be=U&1023;return(U>>15?-1:1)*(ee?ee===31?Be?NaN:1/0:Math.pow(2,ee-15)*(1+Be/1024):6103515625e-14*(Be/1024))}function Le(U,ee){var Be=U.getUint16(ee.value,!0);return ee.value+=2,Be}function ct(U,ee){return be(Le(U,ee))}function dt(U,ee,Be,_){for(var te=Be.value,ce=[];Be.value<te+_-1;){var le=Qe(ee,Be),re=Ue(U,Be),xe=Ie(U,Be);Be.value+=3;var Xe=Ue(U,Be),_e=Ue(U,Be);ce.push({name:le,pixelType:re,pLinear:xe,xSampling:Xe,ySampling:_e})}return Be.value+=1,ce}function It(U,ee){var Be=ue(U,ee),_=ue(U,ee),te=ue(U,ee),ce=ue(U,ee),le=ue(U,ee),re=ue(U,ee),xe=ue(U,ee),Xe=ue(U,ee);return{redX:Be,redY:_,greenX:te,greenY:ce,blueX:le,blueY:re,whiteX:xe,whiteY:Xe}}function Vt(U,ee){var Be=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],_=Ie(U,ee);return Be[_]}function vt(U,ee){var Be=Ne(U,ee),_=Ne(U,ee),te=Ne(U,ee),ce=Ne(U,ee);return{xMin:Be,yMin:_,xMax:te,yMax:ce}}function et(U,ee){var Be=["INCREASING_Y"],_=Ie(U,ee);return Be[_]}function rt(U,ee){var Be=ue(U,ee),_=ue(U,ee);return[Be,_]}function ut(U,ee){var Be=ue(U,ee),_=ue(U,ee),te=ue(U,ee);return[Be,_,te]}function Tt(U,ee,Be,_,te){if(_==="string"||_==="stringvector"||_==="iccProfile")return Ye(ee,Be,te);if(_==="chlist")return dt(U,ee,Be,te);if(_==="chromaticities")return It(U,Be);if(_==="compression")return Vt(U,Be);if(_==="box2i")return vt(U,Be);if(_==="lineOrder")return et(U,Be);if(_==="float")return ue(U,Be);if(_==="v2f")return rt(U,Be);if(_==="v3f")return ut(U,Be);if(_==="int")return Ue(U,Be);if(_==="rational")return $e(U,Be);if(_==="timecode")return st(U,Be);if(_==="preview")return Be.value+=te,"skipped";Be.value+=te}function Ft(U,ee,Be){const _={};if(U.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";_.version=U.getUint8(4);const te=U.getUint8(5);_.spec={singleTile:!!(te&2),longName:!!(te&4),deepFormat:!!(te&8),multiPart:!!(te&16)},Be.value=8;for(var ce=!0;ce;){var le=Qe(ee,Be);if(le==0)ce=!1;else{var re=Qe(ee,Be),xe=Ne(U,Be),Xe=Tt(U,ee,Be,re,xe);Xe===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${re}'.`):_[le]=Xe}}if(te&-5)throw console.error("EXRHeader:",_),"THREE.EXRLoader: provided file is currently unsupported.";return _}function ft(U,ee,Be,_,te){const ce={size:0,viewer:ee,array:Be,offset:_,width:U.dataWindow.xMax-U.dataWindow.xMin+1,height:U.dataWindow.yMax-U.dataWindow.yMin+1,channels:U.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:U.channels[0].pixelType,uncompress:null,getter:null,format:null,[qI?"colorSpace":"encoding"]:null};switch(U.compression){case"NO_COMPRESSION":ce.lines=1,ce.uncompress=se;break;case"RLE_COMPRESSION":ce.lines=1,ce.uncompress=fe;break;case"ZIPS_COMPRESSION":ce.lines=1,ce.uncompress=Ze;break;case"ZIP_COMPRESSION":ce.lines=16,ce.uncompress=Ze;break;case"PIZ_COMPRESSION":ce.lines=32,ce.uncompress=Oe;break;case"PXR24_COMPRESSION":ce.lines=16,ce.uncompress=Fe;break;case"DWAA_COMPRESSION":ce.lines=32,ce.uncompress=Ee;break;case"DWAB_COMPRESSION":ce.lines=256,ce.uncompress=Ee;break;default:throw"EXRLoader.parse: "+U.compression+" is unsupported"}if(ce.scanlineBlockSize=ce.lines,ce.type==1)switch(te){case hi:ce.getter=ct,ce.inputSize=2;break;case or:ce.getter=Le,ce.inputSize=2;break}else if(ce.type==2)switch(te){case hi:ce.getter=ue,ce.inputSize=4;break;case or:ce.getter=Pe,ce.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+ce.type+" for "+U.compression+".";ce.blockCount=(U.dataWindow.yMax+1)/ce.scanlineBlockSize;for(var le=0;le<ce.blockCount;le++)Te(ee,_);ce.outputChannels=ce.channels==3?4:ce.channels;const re=ce.width*ce.height*ce.outputChannels;switch(te){case hi:ce.byteArray=new Float32Array(re),ce.channels<ce.outputChannels&&ce.byteArray.fill(1,0,re);break;case or:ce.byteArray=new Uint16Array(re),ce.channels<ce.outputChannels&&ce.byteArray.fill(15360,0,re);break;default:console.error("THREE.EXRLoader: unsupported type: ",te);break}return ce.bytesPerLine=ce.width*ce.inputSize*ce.channels,ce.outputChannels==4?ce.format=Wi:ce.format=sf,qI?ce.colorSpace="srgb-linear":ce.encoding=3e3,ce}const At=new DataView(e),Gt=new Uint8Array(e),Bt={value:0},Yt=Ft(At,e,Bt),St=ft(Yt,At,Gt,Bt,this.type),sn={value:0},Ot={R:0,G:1,B:2,A:3,Y:0};for(let U=0;U<St.height/St.scanlineBlockSize;U++){const ee=Ne(At,Bt);St.size=Ne(At,Bt),St.lines=ee+St.scanlineBlockSize>St.height?St.height-ee:St.scanlineBlockSize;const _=St.size<St.lines*St.bytesPerLine?St.uncompress(St):se(St);Bt.value+=St.size;for(let te=0;te<St.scanlineBlockSize;te++){const ce=te+U*St.scanlineBlockSize;if(ce>=St.height)break;for(let le=0;le<St.channels;le++){const re=Ot[Yt.channels[le].name];for(let xe=0;xe<St.width;xe++){sn.value=(te*(St.channels*St.width)+le*St.width+xe)*St.inputSize;const Xe=(St.height-1-ce)*(St.width*St.outputChannels)+xe*St.outputChannels+re;St.byteArray[Xe]=St.getter(_,sn)}}}}return{header:Yt,width:St.width,height:St.height,data:St.byteArray,format:St.format,[qI?"colorSpace":"encoding"]:St[qI?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,n,i,r){function o(a,s){qI?a.colorSpace=s.colorSpace:a.encoding=s.encoding,a.minFilter=Kn,a.magFilter=Kn,a.generateMipmaps=!1,a.flipY=!1,n&&n(a,s)}return super.load(e,o,i,r)}}function Zge(){var t=Object.create(null);function e(r,o){var a=r.id,s=r.name,l=r.dependencies;l===void 0&&(l=[]);var c=r.init;c===void 0&&(c=function(){});var g=r.getTransferables;if(g===void 0&&(g=null),!t[a])try{l=l.map(function(d){return d&&d.isWorkerModule&&(e(d,function(C){if(C instanceof Error)throw C}),d=t[d.id].value),d}),c=i("<"+s+">.init",c),g&&(g=i("<"+s+">.getTransferables",g));var u=null;typeof c=="function"?u=c.apply(void 0,l):console.error("worker module init function failed to rehydrate"),t[a]={id:a,value:u,getTransferables:g},o(u)}catch(d){d&&d.noLog||console.error(d),o(d)}}function n(r,o){var a,s=r.id,l=r.args;(!t[s]||typeof t[s].value!="function")&&o(new Error("Worker module "+s+": not found or its 'init' did not return a function"));try{var c=(a=t[s]).value.apply(a,l);c&&typeof c.then=="function"?c.then(g,function(u){return o(u instanceof Error?u:new Error(""+u))}):g(c)}catch(u){o(u)}function g(u){try{var d=t[s].getTransferables&&t[s].getTransferables(u);(!d||!Array.isArray(d)||!d.length)&&(d=void 0),o(u,d)}catch(C){console.error(C),o(C)}}}function i(r,o){var a=void 0;self.troikaDefine=function(l){return a=l};var s=URL.createObjectURL(new Blob(["/** "+r.replace(/\*/g,"")+` **/

troikaDefine(
`+o+`
)`],{type:"application/javascript"}));try{importScripts(s)}catch(l){console.error(l)}return URL.revokeObjectURL(s),delete self.troikaDefine,a}self.addEventListener("message",function(r){var o=r.data,a=o.messageId,s=o.action,l=o.data;try{s==="registerModule"&&e(l,function(c){c instanceof Error?postMessage({messageId:a,success:!1,error:c.message}):postMessage({messageId:a,success:!0,result:{isCallable:typeof c=="function"}})}),s==="callModule"&&n(l,function(c,g){c instanceof Error?postMessage({messageId:a,success:!1,error:c.message}):postMessage({messageId:a,success:!0,result:c},g||void 0)})}catch(c){postMessage({messageId:a,success:!1,error:c.stack})}})}function xge(t){var e=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return e._getInitResult().then(function(r){if(typeof r=="function")return r.apply(void 0,n);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var n=t.dependencies,i=t.init;n=Array.isArray(n)?n.map(function(o){return o&&(o=o.onMainThread||o,o._getInitResult&&(o=o._getInitResult())),o}):[];var r=Promise.all(n).then(function(o){return i.apply(null,o)});return e._getInitResult=function(){return r},r},e}var OK=function(){var t=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),t=!0}catch(n){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+n.message+"]")}return OK=function(){return t},t},Rge=0,Wge=0,gB=!1,KC=Object.create(null),LC=Object.create(null),TS=Object.create(null);function iI(t){if((!t||typeof t.init!="function")&&!gB)throw new Error("requires `options.init` function");var e=t.dependencies,n=t.init,i=t.getTransferables,r=t.workerId,o=xge(t);r==null&&(r="#default");var a="workerModule"+ ++Rge,s=t.name||a,l=null;e=e&&e.map(function(g){return typeof g=="function"&&!g.workerModuleData&&(gB=!0,g=iI({workerId:r,name:"<"+s+"> function dependency: "+g.name,init:`function(){return (
`+hp(g)+`
)}`}),gB=!1),g&&g.workerModuleData&&(g=g.workerModuleData),g});function c(){for(var g=[],u=arguments.length;u--;)g[u]=arguments[u];if(!OK())return o.apply(void 0,g);if(!l){l=qF(r,"registerModule",c.workerModuleData);var d=function(){l=null,LC[r].delete(d)};(LC[r]||(LC[r]=new Set)).add(d)}return l.then(function(C){var f=C.isCallable;if(f)return qF(r,"callModule",{id:a,args:g});throw new Error("Worker module function was called but `init` did not return a callable function")})}return c.workerModuleData={isWorkerModule:!0,id:a,name:s,dependencies:e,init:hp(n),getTransferables:i&&hp(i)},c.onMainThread=o,c}function Vge(t){LC[t]&&LC[t].forEach(function(e){e()}),KC[t]&&(KC[t].terminate(),delete KC[t])}function hp(t){var e=t.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function Mge(t){var e=KC[t];if(!e){var n=hp(Zge);e=KC[t]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+t.replace(/\*/g,"")+` **/

;(`+n+")()"],{type:"application/javascript"}))),e.onmessage=function(i){var r=i.data,o=r.messageId,a=TS[o];if(!a)throw new Error("WorkerModule response with empty or unknown messageId");delete TS[o],a(r)}}return e}function qF(t,e,n){return new Promise(function(i,r){var o=++Wge;TS[o]=function(a){a.success?i(a.result):r(new Error("Error in worker "+e+" call: "+a.error))},Mge(t).postMessage({messageId:o,action:e,data:n})})}function JK(){var t=function(e){function n(L,z,K,O,j,P,$,oe){var ie=1-$;oe.x=ie*ie*L+2*ie*$*K+$*$*j,oe.y=ie*ie*z+2*ie*$*O+$*$*P}function i(L,z,K,O,j,P,$,oe,ie,de){var Ve=1-ie;de.x=Ve*Ve*Ve*L+3*Ve*Ve*ie*K+3*Ve*ie*ie*j+ie*ie*ie*$,de.y=Ve*Ve*Ve*z+3*Ve*Ve*ie*O+3*Ve*ie*ie*P+ie*ie*ie*oe}function r(L,z){for(var K=/([MLQCZ])([^MLQCZ]*)/g,O,j,P,$,oe;O=K.exec(L);){var ie=O[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(de){return parseFloat(de)});switch(O[1]){case"M":$=j=ie[0],oe=P=ie[1];break;case"L":(ie[0]!==$||ie[1]!==oe)&&z("L",$,oe,$=ie[0],oe=ie[1]);break;case"Q":{z("Q",$,oe,$=ie[2],oe=ie[3],ie[0],ie[1]);break}case"C":{z("C",$,oe,$=ie[4],oe=ie[5],ie[0],ie[1],ie[2],ie[3]);break}case"Z":($!==j||oe!==P)&&z("L",$,oe,j,P);break}}}function o(L,z,K){K===void 0&&(K=16);var O={x:0,y:0};r(L,function(j,P,$,oe,ie,de,Ve,Se,me){switch(j){case"L":z(P,$,oe,ie);break;case"Q":{for(var T=P,Ge=$,ne=1;ne<K;ne++)n(P,$,de,Ve,oe,ie,ne/(K-1),O),z(T,Ge,O.x,O.y),T=O.x,Ge=O.y;break}case"C":{for(var he=P,ae=$,He=1;He<K;He++)i(P,$,de,Ve,Se,me,oe,ie,He/(K-1),O),z(he,ae,O.x,O.y),he=O.x,ae=O.y;break}}})}var a="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",s="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",l=new WeakMap,c={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function g(L,z){var K=L.getContext?L.getContext("webgl",c):L,O=l.get(K);if(!O){let he=function(Y){var Ce=P[Y];if(!Ce&&(Ce=P[Y]=K.getExtension(Y),!Ce))throw new Error(Y+" not supported");return Ce},ae=function(Y,Ce){var se=K.createShader(Ce);return K.shaderSource(se,Y),K.compileShader(se),se},He=function(Y,Ce,se,fe){if(!$[Y]){var Ze={},Oe={},Fe=K.createProgram();K.attachShader(Fe,ae(Ce,K.VERTEX_SHADER)),K.attachShader(Fe,ae(se,K.FRAGMENT_SHADER)),K.linkProgram(Fe),$[Y]={program:Fe,transaction:function(Qe){K.useProgram(Fe),Qe({setUniform:function($e,st){for(var Ue=[],Ne=arguments.length-2;Ne-- >0;)Ue[Ne]=arguments[Ne+2];var je=Oe[st]||(Oe[st]=K.getUniformLocation(Fe,st));K["uniform"+$e].apply(K,[je].concat(Ue))},setAttribute:function($e,st,Ue,Ne,je){var Ie=Ze[$e];Ie||(Ie=Ze[$e]={buf:K.createBuffer(),loc:K.getAttribLocation(Fe,$e),data:null}),K.bindBuffer(K.ARRAY_BUFFER,Ie.buf),K.vertexAttribPointer(Ie.loc,st,K.FLOAT,!1,0,0),K.enableVertexAttribArray(Ie.loc),j?K.vertexAttribDivisor(Ie.loc,Ne):he("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(Ie.loc,Ne),je!==Ie.data&&(K.bufferData(K.ARRAY_BUFFER,je,Ue),Ie.data=je)}})}}}$[Y].transaction(fe)},ve=function(Y,Ce){ie++;try{K.activeTexture(K.TEXTURE0+ie);var se=oe[Y];se||(se=oe[Y]=K.createTexture(),K.bindTexture(K.TEXTURE_2D,se),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MIN_FILTER,K.NEAREST),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MAG_FILTER,K.NEAREST)),K.bindTexture(K.TEXTURE_2D,se),Ce(se,ie)}finally{ie--}},Me=function(Y,Ce,se){var fe=K.createFramebuffer();de.push(fe),K.bindFramebuffer(K.FRAMEBUFFER,fe),K.activeTexture(K.TEXTURE0+Ce),K.bindTexture(K.TEXTURE_2D,Y),K.framebufferTexture2D(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0,K.TEXTURE_2D,Y,0);try{se(fe)}finally{K.deleteFramebuffer(fe),K.bindFramebuffer(K.FRAMEBUFFER,de[--de.length-1]||null)}},q=function(){P={},$={},oe={},ie=-1,de.length=0};var Ve=he,Se=ae,me=He,T=ve,Ge=Me,ne=q,j=typeof WebGL2RenderingContext<"u"&&K instanceof WebGL2RenderingContext,P={},$={},oe={},ie=-1,de=[];K.canvas.addEventListener("webglcontextlost",function(Y){q(),Y.preventDefault()},!1),l.set(K,O={gl:K,isWebGL2:j,getExtension:he,withProgram:He,withTexture:ve,withTextureFramebuffer:Me,handleContextLoss:q})}z(O)}function u(L,z,K,O,j,P,$,oe){$===void 0&&($=15),oe===void 0&&(oe=null),g(L,function(ie){var de=ie.gl,Ve=ie.withProgram,Se=ie.withTexture;Se("copy",function(me,T){de.texImage2D(de.TEXTURE_2D,0,de.RGBA,j,P,0,de.RGBA,de.UNSIGNED_BYTE,z),Ve("copy",a,s,function(Ge){var ne=Ge.setUniform,he=Ge.setAttribute;he("aUV",2,de.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),ne("1i","image",T),de.bindFramebuffer(de.FRAMEBUFFER,oe||null),de.disable(de.BLEND),de.colorMask($&8,$&4,$&2,$&1),de.viewport(K,O,j,P),de.scissor(K,O,j,P),de.drawArrays(de.TRIANGLES,0,3)})})})}function d(L,z,K){var O=L.width,j=L.height;g(L,function(P){var $=P.gl,oe=new Uint8Array(O*j*4);$.readPixels(0,0,O,j,$.RGBA,$.UNSIGNED_BYTE,oe),L.width=z,L.height=K,u($,oe,0,0,O,j)})}var C=Object.freeze({__proto__:null,withWebGLContext:g,renderImageData:u,resizeWebGLCanvasWithoutClearing:d});function f(L,z,K,O,j,P){P===void 0&&(P=1);var $=new Uint8Array(L*z),oe=O[2]-O[0],ie=O[3]-O[1],de=[];o(K,function(he,ae,He,ve){de.push({x1:he,y1:ae,x2:He,y2:ve,minX:Math.min(he,He),minY:Math.min(ae,ve),maxX:Math.max(he,He),maxY:Math.max(ae,ve)})}),de.sort(function(he,ae){return he.maxX-ae.maxX});for(var Ve=0;Ve<L;Ve++)for(var Se=0;Se<z;Se++){var me=Ge(O[0]+oe*(Ve+.5)/L,O[1]+ie*(Se+.5)/z),T=Math.pow(1-Math.abs(me)/j,P)/2;me<0&&(T=1-T),T=Math.max(0,Math.min(255,Math.round(T*255))),$[Se*L+Ve]=T}return $;function Ge(he,ae){for(var He=1/0,ve=1/0,Me=de.length;Me--;){var q=de[Me];if(q.maxX+ve<=he)break;if(he+ve>q.minX&&ae-ve<q.maxY&&ae+ve>q.minY){var Y=m(he,ae,q.x1,q.y1,q.x2,q.y2);Y<He&&(He=Y,ve=Math.sqrt(He))}}return ne(he,ae)&&(ve=-ve),ve}function ne(he,ae){for(var He=0,ve=de.length;ve--;){var Me=de[ve];if(Me.maxX<=he)break;var q=Me.y1>ae!=Me.y2>ae&&he<(Me.x2-Me.x1)*(ae-Me.y1)/(Me.y2-Me.y1)+Me.x1;q&&(He+=Me.y1<Me.y2?1:-1)}return He!==0}}function v(L,z,K,O,j,P,$,oe,ie,de){P===void 0&&(P=1),oe===void 0&&(oe=0),ie===void 0&&(ie=0),de===void 0&&(de=0),p(L,z,K,O,j,P,$,null,oe,ie,de)}function p(L,z,K,O,j,P,$,oe,ie,de,Ve){P===void 0&&(P=1),ie===void 0&&(ie=0),de===void 0&&(de=0),Ve===void 0&&(Ve=0);for(var Se=f(L,z,K,O,j,P),me=new Uint8Array(Se.length*4),T=0;T<Se.length;T++)me[T*4+Ve]=Se[T];u($,me,ie,de,L,z,1<<3-Ve,oe)}function m(L,z,K,O,j,P){var $=j-K,oe=P-O,ie=$*$+oe*oe,de=ie?Math.max(0,Math.min(1,((L-K)*$+(z-O)*oe)/ie)):0,Ve=L-(K+de*$),Se=z-(O+de*oe);return Ve*Ve+Se*Se}var A=Object.freeze({__proto__:null,generate:f,generateIntoCanvas:v,generateIntoFramebuffer:p}),b="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",G="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",w="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",S=new Float32Array([0,0,2,0,0,2]),Z=null,x=!1,R={},W=new WeakMap;function M(L){if(!x&&!Q(L))throw new Error("WebGL generation not supported")}function N(L,z,K,O,j,P,$){if(P===void 0&&(P=1),$===void 0&&($=null),!$&&($=Z,!$)){var oe=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!oe)throw new Error("OffscreenCanvas or DOM canvas not supported");$=Z=oe.getContext("webgl",{depth:!1})}M($);var ie=new Uint8Array(L*z*4);g($,function(me){var T=me.gl,Ge=me.withTexture,ne=me.withTextureFramebuffer;Ge("readable",function(he,ae){T.texImage2D(T.TEXTURE_2D,0,T.RGBA,L,z,0,T.RGBA,T.UNSIGNED_BYTE,null),ne(he,ae,function(He){E(L,z,K,O,j,P,T,He,0,0,0),T.readPixels(0,0,L,z,T.RGBA,T.UNSIGNED_BYTE,ie)})})});for(var de=new Uint8Array(L*z),Ve=0,Se=0;Ve<ie.length;Ve+=4)de[Se++]=ie[Ve];return de}function X(L,z,K,O,j,P,$,oe,ie,de){P===void 0&&(P=1),oe===void 0&&(oe=0),ie===void 0&&(ie=0),de===void 0&&(de=0),E(L,z,K,O,j,P,$,null,oe,ie,de)}function E(L,z,K,O,j,P,$,oe,ie,de,Ve){P===void 0&&(P=1),ie===void 0&&(ie=0),de===void 0&&(de=0),Ve===void 0&&(Ve=0),M($);var Se=[];o(K,function(me,T,Ge,ne){Se.push(me,T,Ge,ne)}),Se=new Float32Array(Se),g($,function(me){var T=me.gl,Ge=me.isWebGL2,ne=me.getExtension,he=me.withProgram,ae=me.withTexture,He=me.withTextureFramebuffer,ve=me.handleContextLoss;if(ae("rawDistances",function(Me,q){(L!==Me._lastWidth||z!==Me._lastHeight)&&T.texImage2D(T.TEXTURE_2D,0,T.RGBA,Me._lastWidth=L,Me._lastHeight=z,0,T.RGBA,T.UNSIGNED_BYTE,null),he("main",b,G,function(Y){var Ce=Y.setAttribute,se=Y.setUniform,fe=!Ge&&ne("ANGLE_instanced_arrays"),Ze=!Ge&&ne("EXT_blend_minmax");Ce("aUV",2,T.STATIC_DRAW,0,S),Ce("aLineSegment",4,T.DYNAMIC_DRAW,1,Se),se.apply(void 0,["4f","uGlyphBounds"].concat(O)),se("1f","uMaxDistance",j),se("1f","uExponent",P),He(Me,q,function(Oe){T.enable(T.BLEND),T.colorMask(!0,!0,!0,!0),T.viewport(0,0,L,z),T.scissor(0,0,L,z),T.blendFunc(T.ONE,T.ONE),T.blendEquationSeparate(T.FUNC_ADD,Ge?T.MAX:Ze.MAX_EXT),T.clear(T.COLOR_BUFFER_BIT),Ge?T.drawArraysInstanced(T.TRIANGLES,0,3,Se.length/4):fe.drawArraysInstancedANGLE(T.TRIANGLES,0,3,Se.length/4)})}),he("post",a,w,function(Y){Y.setAttribute("aUV",2,T.STATIC_DRAW,0,S),Y.setUniform("1i","tex",q),T.bindFramebuffer(T.FRAMEBUFFER,oe),T.disable(T.BLEND),T.colorMask(Ve===0,Ve===1,Ve===2,Ve===3),T.viewport(ie,de,L,z),T.scissor(ie,de,L,z),T.drawArrays(T.TRIANGLES,0,3)})}),T.isContextLost())throw ve(),new Error("webgl context lost")})}function Q(L){var z=!L||L===Z?R:L.canvas||L,K=W.get(z);if(K===void 0){x=!0;var O=null;try{var j=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],P=N(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,L);K=P&&j.length===P.length&&P.every(function($,oe){return $===j[oe]}),K||(O="bad trial run results",console.info(j,P))}catch($){K=!1,O=$.message}O&&console.warn("WebGL SDF generation not supported:",O),x=!1,W.set(z,K)}return K}var k=Object.freeze({__proto__:null,generate:N,generateIntoCanvas:X,generateIntoFramebuffer:E,isSupported:Q});function J(L,z,K,O,j,P){j===void 0&&(j=Math.max(O[2]-O[0],O[3]-O[1])/2),P===void 0&&(P=1);try{return N.apply(k,arguments)}catch($){return console.info("WebGL SDF generation failed, falling back to JS",$),f.apply(A,arguments)}}function F(L,z,K,O,j,P,$,oe,ie,de){j===void 0&&(j=Math.max(O[2]-O[0],O[3]-O[1])/2),P===void 0&&(P=1),oe===void 0&&(oe=0),ie===void 0&&(ie=0),de===void 0&&(de=0);try{return X.apply(k,arguments)}catch(Ve){return console.info("WebGL SDF generation failed, falling back to JS",Ve),v.apply(A,arguments)}}return e.forEachPathCommand=r,e.generate=J,e.generateIntoCanvas=F,e.javascript=A,e.pathToLineSegments=o,e.webgl=k,e.webglUtils=C,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return t}function Nge(){var t=function(e){var n={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},i={},r={};i.L=1,r[1]="L",Object.keys(n).forEach(function(ve,Me){i[ve]=1<<Me+1,r[i[ve]]=ve}),Object.freeze(i);var o=i.LRI|i.RLI|i.FSI,a=i.L|i.R|i.AL,s=i.B|i.S|i.WS|i.ON|i.FSI|i.LRI|i.RLI|i.PDI,l=i.BN|i.RLE|i.LRE|i.RLO|i.LRO|i.PDF,c=i.S|i.WS|i.B|o|i.PDI|l,g=null;function u(){if(!g){g=new Map;var ve=function(q){if(n.hasOwnProperty(q)){var Y=0;n[q].split(",").forEach(function(Ce){var se=Ce.split("+"),fe=se[0],Ze=se[1];fe=parseInt(fe,36),Ze=Ze?parseInt(Ze,36):0,g.set(Y+=fe,i[q]);for(var Oe=0;Oe<Ze;Oe++)g.set(++Y,i[q])})}};for(var Me in n)ve(Me)}}function d(ve){return u(),g.get(ve.codePointAt(0))||i.L}function C(ve){return r[d(ve)]}var f={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function v(ve,Me){var q=36,Y=0,Ce=new Map,se=Me&&new Map,fe;return ve.split(",").forEach(function Ze(Oe){if(Oe.indexOf("+")!==-1)for(var Fe=+Oe;Fe--;)Ze(fe);else{fe=Oe;var Ee=Oe.split(">"),Qe=Ee[0],Ye=Ee[1];Qe=String.fromCodePoint(Y+=parseInt(Qe,q)),Ye=String.fromCodePoint(Y+=parseInt(Ye,q)),Ce.set(Qe,Ye),Me&&se.set(Ye,Qe)}}),{map:Ce,reverseMap:se}}var p,m,A;function b(){if(!p){var ve=v(f.pairs,!0),Me=ve.map,q=ve.reverseMap;p=Me,m=q,A=v(f.canonical,!1).map}}function G(ve){return b(),p.get(ve)||null}function w(ve){return b(),m.get(ve)||null}function S(ve){return b(),A.get(ve)||null}var Z=i.L,x=i.R,R=i.EN,W=i.ES,M=i.ET,N=i.AN,X=i.CS,E=i.B,Q=i.S,k=i.ON,J=i.BN,F=i.NSM,L=i.AL,z=i.LRO,K=i.RLO,O=i.LRE,j=i.RLE,P=i.PDF,$=i.LRI,oe=i.RLI,ie=i.FSI,de=i.PDI;function Ve(ve,Me){for(var q=125,Y=new Uint32Array(ve.length),Ce=0;Ce<ve.length;Ce++)Y[Ce]=d(ve[Ce]);var se=new Map;function fe(ji,Lr){var Gi=Y[ji];Y[ji]=Lr,se.set(Gi,se.get(Gi)-1),Gi&s&&se.set(s,se.get(s)-1),se.set(Lr,(se.get(Lr)||0)+1),Lr&s&&se.set(s,(se.get(s)||0)+1)}for(var Ze=new Uint8Array(ve.length),Oe=new Map,Fe=[],Ee=null,Qe=0;Qe<ve.length;Qe++)Ee||Fe.push(Ee={start:Qe,end:ve.length-1,level:Me==="rtl"?1:Me==="ltr"?0:Qg(Qe,!1)}),Y[Qe]&E&&(Ee.end=Qe,Ee=null);for(var Ye=j|O|K|z|o|de|P|E,$e=function(ji){return ji+(ji&1?1:2)},st=function(ji){return ji+(ji&1?2:1)},Ue=0;Ue<Fe.length;Ue++){Ee=Fe[Ue];var Ne=[{_level:Ee.level,_override:0,_isolate:0}],je=void 0,Ie=0,Te=0,ue=0;se.clear();for(var Pe=Ee.start;Pe<=Ee.end;Pe++){var be=Y[Pe];if(je=Ne[Ne.length-1],se.set(be,(se.get(be)||0)+1),be&s&&se.set(s,(se.get(s)||0)+1),be&Ye)if(be&(j|O)){Ze[Pe]=je._level;var Le=(be===j?st:$e)(je._level);Le<=q&&!Ie&&!Te?Ne.push({_level:Le,_override:0,_isolate:0}):Ie||Te++}else if(be&(K|z)){Ze[Pe]=je._level;var ct=(be===K?st:$e)(je._level);ct<=q&&!Ie&&!Te?Ne.push({_level:ct,_override:be&K?x:Z,_isolate:0}):Ie||Te++}else if(be&o){be&ie&&(be=Qg(Pe+1,!0)===1?oe:$),Ze[Pe]=je._level,je._override&&fe(Pe,je._override);var dt=(be===oe?st:$e)(je._level);dt<=q&&Ie===0&&Te===0?(ue++,Ne.push({_level:dt,_override:0,_isolate:1,_isolInitIndex:Pe})):Ie++}else if(be&de){if(Ie>0)Ie--;else if(ue>0){for(Te=0;!Ne[Ne.length-1]._isolate;)Ne.pop();var It=Ne[Ne.length-1]._isolInitIndex;It!=null&&(Oe.set(It,Pe),Oe.set(Pe,It)),Ne.pop(),ue--}je=Ne[Ne.length-1],Ze[Pe]=je._level,je._override&&fe(Pe,je._override)}else be&P?(Ie===0&&(Te>0?Te--:!je._isolate&&Ne.length>1&&(Ne.pop(),je=Ne[Ne.length-1])),Ze[Pe]=je._level):be&E&&(Ze[Pe]=Ee.level);else Ze[Pe]=je._level,je._override&&be!==J&&fe(Pe,je._override)}for(var Vt=[],vt=null,et=Ee.start;et<=Ee.end;et++){var rt=Y[et];if(!(rt&l)){var ut=Ze[et],Tt=rt&o,Ft=rt===de;vt&&ut===vt._level?(vt._end=et,vt._endsWithIsolInit=Tt):Vt.push(vt={_start:et,_end:et,_level:ut,_startsWithPDI:Ft,_endsWithIsolInit:Tt})}}for(var ft=[],At=0;At<Vt.length;At++){var Gt=Vt[At];if(!Gt._startsWithPDI||Gt._startsWithPDI&&!Oe.has(Gt._start)){for(var Bt=[vt=Gt],Yt=void 0;vt&&vt._endsWithIsolInit&&(Yt=Oe.get(vt._end))!=null;)for(var St=At+1;St<Vt.length;St++)if(Vt[St]._start===Yt){Bt.push(vt=Vt[St]);break}for(var sn=[],Ot=0;Ot<Bt.length;Ot++)for(var U=Bt[Ot],ee=U._start;ee<=U._end;ee++)sn.push(ee);for(var Be=Ze[sn[0]],_=Ee.level,te=sn[0]-1;te>=0;te--)if(!(Y[te]&l)){_=Ze[te];break}var ce=sn[sn.length-1],le=Ze[ce],re=Ee.level;if(!(Y[ce]&o)){for(var xe=ce+1;xe<=Ee.end;xe++)if(!(Y[xe]&l)){re=Ze[xe];break}}ft.push({_seqIndices:sn,_sosType:Math.max(_,Be)%2?x:Z,_eosType:Math.max(re,le)%2?x:Z})}}for(var Xe=0;Xe<ft.length;Xe++){var _e=ft[Xe],We=_e._seqIndices,pt=_e._sosType,lt=_e._eosType,nt=Ze[We[0]]&1?x:Z;if(se.get(F))for(var wt=0;wt<We.length;wt++){var ot=We[wt];if(Y[ot]&F){for(var bt=pt,Wt=wt-1;Wt>=0;Wt--)if(!(Y[We[Wt]]&l)){bt=Y[We[Wt]];break}fe(ot,bt&(o|de)?k:bt)}}if(se.get(R))for(var yt=0;yt<We.length;yt++){var ht=We[yt];if(Y[ht]&R)for(var Qt=yt-1;Qt>=-1;Qt--){var zt=Qt===-1?pt:Y[We[Qt]];if(zt&a){zt===L&&fe(ht,N);break}}}if(se.get(L))for(var Pt=0;Pt<We.length;Pt++){var dn=We[Pt];Y[dn]&L&&fe(dn,x)}if(se.get(W)||se.get(X))for(var un=1;un<We.length-1;un++){var In=We[un];if(Y[In]&(W|X)){for(var Ht=0,mt=0,Lt=un-1;Lt>=0&&(Ht=Y[We[Lt]],!!(Ht&l));Lt--);for(var Rt=un+1;Rt<We.length&&(mt=Y[We[Rt]],!!(mt&l));Rt++);Ht===mt&&(Y[In]===W?Ht===R:Ht&(R|N))&&fe(In,Ht)}}if(se.get(R))for(var Xt=0;Xt<We.length;Xt++){var en=We[Xt];if(Y[en]&R){for(var Rn=Xt-1;Rn>=0&&Y[We[Rn]]&(M|l);Rn--)fe(We[Rn],R);for(Xt++;Xt<We.length&&Y[We[Xt]]&(M|l|R);Xt++)Y[We[Xt]]!==R&&fe(We[Xt],R)}}if(se.get(M)||se.get(W)||se.get(X))for(var bn=0;bn<We.length;bn++){var On=We[bn];if(Y[On]&(M|W|X)){fe(On,k);for(var gi=bn-1;gi>=0&&Y[We[gi]]&l;gi--)fe(We[gi],k);for(var ni=bn+1;ni<We.length&&Y[We[ni]]&l;ni++)fe(We[ni],k)}}if(se.get(R))for(var ai=0,Vi=pt;ai<We.length;ai++){var jo=We[ai],mr=Y[jo];mr&R?Vi===Z&&fe(jo,Z):mr&a&&(Vi=mr)}if(se.get(s)){var Go=x|R|N,Vs=Go|Z,Yr=[];{for(var ui=[],Ji=0;Ji<We.length;Ji++)if(Y[We[Ji]]&s){var Cn=ve[We[Ji]],Bo=void 0;if(G(Cn)!==null)if(ui.length<63)ui.push({char:Cn,seqIndex:Ji});else break;else if((Bo=w(Cn))!==null)for(var Ar=ui.length-1;Ar>=0;Ar--){var Ba=ui[Ar].char;if(Ba===Bo||Ba===w(S(Cn))||G(S(Ba))===Cn){Yr.push([ui[Ar].seqIndex,Ji]),ui.length=Ar;break}}}Yr.sort(function(ji,Lr){return ji[0]-Lr[0]})}for(var ns=0;ns<Yr.length;ns++){for(var Jt=Yr[ns],Ut=Jt[0],Hn=Jt[1],Qn=!1,Gn=0,$o=Ut+1;$o<Hn;$o++){var Sa=We[$o];if(Y[Sa]&Vs){Qn=!0;var pr=Y[Sa]&Go?x:Z;if(pr===nt){Gn=pr;break}}}if(Qn&&!Gn){Gn=pt;for(var is=Ut-1;is>=0;is--){var yf=We[is];if(Y[yf]&Vs){var So=Y[yf]&Go?x:Z;So!==nt?Gn=So:Gn=nt;break}}}if(Gn){if(Y[We[Ut]]=Y[We[Hn]]=Gn,Gn!==nt){for(var zr=Ut+1;zr<We.length;zr++)if(!(Y[We[zr]]&l)){d(ve[We[zr]])&F&&(Y[We[zr]]=Gn);break}}if(Gn!==nt){for(var rs=Hn+1;rs<We.length;rs++)if(!(Y[We[rs]]&l)){d(ve[We[rs]])&F&&(Y[We[rs]]=Gn);break}}}}for(var qo=0;qo<We.length;qo++)if(Y[We[qo]]&s){for(var rI=qo,oI=qo,oo=pt,pc=qo-1;pc>=0;pc--)if(Y[We[pc]]&l)rI=pc;else{oo=Y[We[pc]]&Go?x:Z;break}for(var vc=lt,bc=qo+1;bc<We.length;bc++)if(Y[We[bc]]&(s|l))oI=bc;else{vc=Y[We[bc]]&Go?x:Z;break}for(var Kr=rI;Kr<=oI;Kr++)Y[We[Kr]]=oo===vc?oo:nt;qo=oI}}}for(var Qi=Ee.start;Qi<=Ee.end;Qi++){var Jg=Ze[Qi],wa=Y[Qi];if(Jg&1?wa&(Z|R|N)&&Ze[Qi]++:wa&x?Ze[Qi]++:wa&(N|R)&&(Ze[Qi]+=2),wa&l&&(Ze[Qi]=Qi===0?Ee.level:Ze[Qi-1]),Qi===Ee.end||d(ve[Qi])&(Q|E))for(var fl=Qi;fl>=0&&d(ve[fl])&c;fl--)Ze[fl]=Ee.level}}return{levels:Ze,paragraphs:Fe};function Qg(ji,Lr){for(var Gi=ji;Gi<ve.length;Gi++){var Bi=Y[Gi];if(Bi&(x|L))return 1;if(Bi&(E|Z)||Lr&&Bi===de)return 0;if(Bi&o){var wo=Gf(Gi);Gi=wo===-1?ve.length:wo}}return 0}function Gf(ji){for(var Lr=1,Gi=ji+1;Gi<ve.length;Gi++){var Bi=Y[Gi];if(Bi&E)break;if(Bi&de){if(--Lr===0)return Gi}else Bi&o&&Lr++}return-1}}var Se="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",me;function T(){if(!me){var ve=v(Se,!0),Me=ve.map,q=ve.reverseMap;q.forEach(function(Y,Ce){Me.set(Ce,Y)}),me=Me}}function Ge(ve){return T(),me.get(ve)||null}function ne(ve,Me,q,Y){var Ce=ve.length;q=Math.max(0,q==null?0:+q),Y=Math.min(Ce-1,Y==null?Ce-1:+Y);for(var se=new Map,fe=q;fe<=Y;fe++)if(Me[fe]&1){var Ze=Ge(ve[fe]);Ze!==null&&se.set(fe,Ze)}return se}function he(ve,Me,q,Y){var Ce=ve.length;q=Math.max(0,q==null?0:+q),Y=Math.min(Ce-1,Y==null?Ce-1:+Y);var se=[];return Me.paragraphs.forEach(function(fe){var Ze=Math.max(q,fe.start),Oe=Math.min(Y,fe.end);if(Ze<Oe){for(var Fe=Me.levels.slice(Ze,Oe+1),Ee=Oe;Ee>=Ze&&d(ve[Ee])&c;Ee--)Fe[Ee]=fe.level;for(var Qe=fe.level,Ye=1/0,$e=0;$e<Fe.length;$e++){var st=Fe[$e];st>Qe&&(Qe=st),st<Ye&&(Ye=st|1)}for(var Ue=Qe;Ue>=Ye;Ue--)for(var Ne=0;Ne<Fe.length;Ne++)if(Fe[Ne]>=Ue){for(var je=Ne;Ne+1<Fe.length&&Fe[Ne+1]>=Ue;)Ne++;Ne>je&&se.push([je+Ze,Ne+Ze])}}}),se}function ae(ve,Me,q,Y){var Ce=He(ve,Me,q,Y),se=[].concat(ve);return Ce.forEach(function(fe,Ze){se[Ze]=(Me.levels[fe]&1?Ge(ve[fe]):null)||ve[fe]}),se.join("")}function He(ve,Me,q,Y){for(var Ce=he(ve,Me,q,Y),se=[],fe=0;fe<ve.length;fe++)se[fe]=fe;return Ce.forEach(function(Ze){for(var Oe=Ze[0],Fe=Ze[1],Ee=se.slice(Oe,Fe+1),Qe=Ee.length;Qe--;)se[Fe-Qe]=Ee[Qe]}),se}return e.closingToOpeningBracket=w,e.getBidiCharType=d,e.getBidiCharTypeName=C,e.getCanonicalBracket=S,e.getEmbeddingLevels=Ve,e.getMirroredCharacter=Ge,e.getMirroredCharactersMap=ne,e.getReorderSegments=he,e.getReorderedIndices=He,e.getReorderedString=ae,e.openingToClosingBracket=G,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return t}const QK=/\bvoid\s+main\s*\(\s*\)\s*{/g;function _S(t){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function n(i,r){let o=pn[r];return o?_S(o):i}return t.replace(e,n)}const cr=[];for(let t=0;t<256;t++)cr[t]=(t<16?"0":"")+t.toString(16);function Fge(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(cr[t&255]+cr[t>>8&255]+cr[t>>16&255]+cr[t>>24&255]+"-"+cr[e&255]+cr[e>>8&255]+"-"+cr[e>>16&15|64]+cr[e>>24&255]+"-"+cr[n&63|128]+cr[n>>8&255]+"-"+cr[n>>16&255]+cr[n>>24&255]+cr[i&255]+cr[i>>8&255]+cr[i>>16&255]+cr[i>>24&255]).toUpperCase()}const Pc=Object.assign||function(){let t=arguments[0];for(let e=1,n=arguments.length;e<n;e++){let i=arguments[e];if(i)for(let r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},Hge=Date.now(),e3=new WeakMap,t3=new Map;let Xge=1e10;function kS(t,e){const n=Kge(e);let i=e3.get(t);if(i||e3.set(t,i=Object.create(null)),i[n])return new i[n];const r=`_onBeforeCompile${n}`,o=function(c,g){t.onBeforeCompile.call(this,c,g);const u=this.customProgramCacheKey()+"|"+c.vertexShader+"|"+c.fragmentShader;let d=t3[u];if(!d){const C=Ege(this,c,e,n);d=t3[u]=C}c.vertexShader=d.vertexShader,c.fragmentShader=d.fragmentShader,Pc(c.uniforms,this.uniforms),e.timeUniform&&(c.uniforms[e.timeUniform]={get value(){return Date.now()-Hge}}),this[r]&&this[r](c)},a=function(){return s(e.chained?t:t.clone())},s=function(c){const g=Object.create(c,l);return Object.defineProperty(g,"baseMaterial",{value:t}),Object.defineProperty(g,"id",{value:Xge++}),g.uuid=Fge(),g.uniforms=Pc({},c.uniforms,e.uniforms),g.defines=Pc({},c.defines,e.defines),g.defines[`TROIKA_DERIVED_MATERIAL_${n}`]="",g.extensions=Pc({},c.extensions,e.extensions),g._listeners=void 0,g},l={constructor:{value:a},isDerivedMaterial:{value:!0},type:{get:()=>t.type,set:c=>{t.type=c}},isDerivedFrom:{writable:!0,configurable:!0,value:function(c){const g=this.baseMaterial;return c===g||g.isDerivedMaterial&&g.isDerivedFrom(c)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return t.customProgramCacheKey()+"|"+n}},onBeforeCompile:{get(){return o},set(c){this[r]=c}},copy:{writable:!0,configurable:!0,value:function(c){return t.copy.call(this,c),!t.isShaderMaterial&&!t.isDerivedMaterial&&(Pc(this.extensions,c.extensions),Pc(this.defines,c.defines),Pc(this.uniforms,n1.clone(c.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const c=new t.constructor;return s(c).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let c=this._depthMaterial;return c||(c=this._depthMaterial=kS(t.isDerivedMaterial?t.getDepthMaterial():new Kv({depthPacking:QZ}),e),c.defines.IS_DEPTH_MATERIAL="",c.uniforms=this.uniforms),c}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let c=this._distanceMaterial;return c||(c=this._distanceMaterial=kS(t.isDerivedMaterial?t.getDistanceMaterial():new Lv,e),c.defines.IS_DISTANCE_MATERIAL="",c.uniforms=this.uniforms),c}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:c,_distanceMaterial:g}=this;c&&c.dispose(),g&&g.dispose(),t.dispose.call(this)}}};return i[n]=a,new a}function Ege(t,{vertexShader:e,fragmentShader:n},i,r){let{vertexDefs:o,vertexMainIntro:a,vertexMainOutro:s,vertexTransform:l,fragmentDefs:c,fragmentMainIntro:g,fragmentMainOutro:u,fragmentColorTransform:d,customRewriter:C,timeUniform:f}=i;if(o=o||"",a=a||"",s=s||"",c=c||"",g=g||"",u=u||"",(l||C)&&(e=_S(e)),(d||C)&&(n=n.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),n=_S(n)),C){let v=C({vertexShader:e,fragmentShader:n});e=v.vertexShader,n=v.fragmentShader}if(d){let v=[];n=n.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,p=>(v.push(p),"")),u=`${d}
${v.join(`
`)}
${u}`}if(f){const v=`
uniform float ${f};
`;o=v+o,c=v+c}return l&&(e=`vec3 troika_position_${r};
vec3 troika_normal_${r};
vec2 troika_uv_${r};
${e}
`,o=`${o}
void troikaVertexTransform${r}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${l}
}
`,a=`
troika_position_${r} = vec3(position);
troika_normal_${r} = vec3(normal);
troika_uv_${r} = vec2(uv);
troikaVertexTransform${r}(troika_position_${r}, troika_normal_${r}, troika_uv_${r});
${a}
`,e=e.replace(/\b(position|normal|uv)\b/g,(v,p,m,A)=>/\battribute\s+vec[23]\s+$/.test(A.substr(0,m))?p:`troika_${p}_${r}`),t.map&&t.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${r}`))),e=n3(e,r,o,a,s),n=n3(n,r,c,g,u),{vertexShader:e,fragmentShader:n}}function n3(t,e,n,i,r){return(i||r||n)&&(t=t.replace(QK,`
${n}
void troikaOrigMain${e}() {`),t+=`
void main() {
  ${i}
  troikaOrigMain${e}();
  ${r}
}`),t}function Yge(t,e){return t==="uniforms"?void 0:typeof e=="function"?e.toString():e}let zge=0;const i3=new Map;function Kge(t){const e=JSON.stringify(t,Yge);let n=i3.get(e);return n==null&&i3.set(e,n=++zge),n}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function Lge(){return typeof window>"u"&&(self.window=self),function(t){var e={parse:function(r){var o=e._bin,a=new Uint8Array(r);if(o.readASCII(a,0,4)=="ttcf"){var s=4;o.readUshort(a,s),s+=2,o.readUshort(a,s),s+=2;var l=o.readUint(a,s);s+=4;for(var c=[],g=0;g<l;g++){var u=o.readUint(a,s);s+=4,c.push(e._readFont(a,u))}return c}return[e._readFont(a,0)]},_readFont:function(r,o){var a=e._bin,s=o;a.readFixed(r,o),o+=4;var l=a.readUshort(r,o);o+=2,a.readUshort(r,o),o+=2,a.readUshort(r,o),o+=2,a.readUshort(r,o),o+=2;for(var c=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],g={_data:r,_offset:s},u={},d=0;d<l;d++){var C=a.readASCII(r,o,4);o+=4,a.readUint(r,o),o+=4;var f=a.readUint(r,o);o+=4;var v=a.readUint(r,o);o+=4,u[C]={offset:f,length:v}}for(d=0;d<c.length;d++){var p=c[d];u[p]&&(g[p.trim()]=e[p.trim()].parse(r,u[p].offset,u[p].length,g))}return g},_tabOffset:function(r,o,a){for(var s=e._bin,l=s.readUshort(r,a+4),c=a+12,g=0;g<l;g++){var u=s.readASCII(r,c,4);c+=4,s.readUint(r,c),c+=4;var d=s.readUint(r,c);if(c+=4,s.readUint(r,c),c+=4,u==o)return d}return 0}};e._bin={readFixed:function(r,o){return(r[o]<<8|r[o+1])+(r[o+2]<<8|r[o+3])/65540},readF2dot14:function(r,o){return e._bin.readShort(r,o)/16384},readInt:function(r,o){return e._bin._view(r).getInt32(o)},readInt8:function(r,o){return e._bin._view(r).getInt8(o)},readShort:function(r,o){return e._bin._view(r).getInt16(o)},readUshort:function(r,o){return e._bin._view(r).getUint16(o)},readUshorts:function(r,o,a){for(var s=[],l=0;l<a;l++)s.push(e._bin.readUshort(r,o+2*l));return s},readUint:function(r,o){return e._bin._view(r).getUint32(o)},readUint64:function(r,o){return 4294967296*e._bin.readUint(r,o)+e._bin.readUint(r,o+4)},readASCII:function(r,o,a){for(var s="",l=0;l<a;l++)s+=String.fromCharCode(r[o+l]);return s},readUnicode:function(r,o,a){for(var s="",l=0;l<a;l++){var c=r[o++]<<8|r[o++];s+=String.fromCharCode(c)}return s},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(r,o,a){var s=e._bin._tdec;return s&&o==0&&a==r.length?s.decode(r):e._bin.readASCII(r,o,a)},readBytes:function(r,o,a){for(var s=[],l=0;l<a;l++)s.push(r[o+l]);return s},readASCIIArray:function(r,o,a){for(var s=[],l=0;l<a;l++)s.push(String.fromCharCode(r[o+l]));return s},_view:function(r){return r._dataView||(r._dataView=r.buffer?new DataView(r.buffer,r.byteOffset,r.byteLength):new DataView(new Uint8Array(r).buffer))}},e._lctf={},e._lctf.parse=function(r,o,a,s,l){var c=e._bin,g={},u=o;c.readFixed(r,o),o+=4;var d=c.readUshort(r,o);o+=2;var C=c.readUshort(r,o);o+=2;var f=c.readUshort(r,o);return o+=2,g.scriptList=e._lctf.readScriptList(r,u+d),g.featureList=e._lctf.readFeatureList(r,u+C),g.lookupList=e._lctf.readLookupList(r,u+f,l),g},e._lctf.readLookupList=function(r,o,a){var s=e._bin,l=o,c=[],g=s.readUshort(r,o);o+=2;for(var u=0;u<g;u++){var d=s.readUshort(r,o);o+=2;var C=e._lctf.readLookupTable(r,l+d,a);c.push(C)}return c},e._lctf.readLookupTable=function(r,o,a){var s=e._bin,l=o,c={tabs:[]};c.ltype=s.readUshort(r,o),o+=2,c.flag=s.readUshort(r,o),o+=2;var g=s.readUshort(r,o);o+=2;for(var u=c.ltype,d=0;d<g;d++){var C=s.readUshort(r,o);o+=2;var f=a(r,u,l+C,c);c.tabs.push(f)}return c},e._lctf.numOfOnes=function(r){for(var o=0,a=0;a<32;a++)r>>>a&1&&o++;return o},e._lctf.readClassDef=function(r,o){var a=e._bin,s=[],l=a.readUshort(r,o);if(o+=2,l==1){var c=a.readUshort(r,o);o+=2;var g=a.readUshort(r,o);o+=2;for(var u=0;u<g;u++)s.push(c+u),s.push(c+u),s.push(a.readUshort(r,o)),o+=2}if(l==2){var d=a.readUshort(r,o);for(o+=2,u=0;u<d;u++)s.push(a.readUshort(r,o)),o+=2,s.push(a.readUshort(r,o)),o+=2,s.push(a.readUshort(r,o)),o+=2}return s},e._lctf.getInterval=function(r,o){for(var a=0;a<r.length;a+=3){var s=r[a],l=r[a+1];if(r[a+2],s<=o&&o<=l)return a}return-1},e._lctf.readCoverage=function(r,o){var a=e._bin,s={};s.fmt=a.readUshort(r,o),o+=2;var l=a.readUshort(r,o);return o+=2,s.fmt==1&&(s.tab=a.readUshorts(r,o,l)),s.fmt==2&&(s.tab=a.readUshorts(r,o,3*l)),s},e._lctf.coverageIndex=function(r,o){var a=r.tab;if(r.fmt==1)return a.indexOf(o);if(r.fmt==2){var s=e._lctf.getInterval(a,o);if(s!=-1)return a[s+2]+(o-a[s])}return-1},e._lctf.readFeatureList=function(r,o){var a=e._bin,s=o,l=[],c=a.readUshort(r,o);o+=2;for(var g=0;g<c;g++){var u=a.readASCII(r,o,4);o+=4;var d=a.readUshort(r,o);o+=2;var C=e._lctf.readFeatureTable(r,s+d);C.tag=u.trim(),l.push(C)}return l},e._lctf.readFeatureTable=function(r,o){var a=e._bin,s=o,l={},c=a.readUshort(r,o);o+=2,c>0&&(l.featureParams=s+c);var g=a.readUshort(r,o);o+=2,l.tab=[];for(var u=0;u<g;u++)l.tab.push(a.readUshort(r,o+2*u));return l},e._lctf.readScriptList=function(r,o){var a=e._bin,s=o,l={},c=a.readUshort(r,o);o+=2;for(var g=0;g<c;g++){var u=a.readASCII(r,o,4);o+=4;var d=a.readUshort(r,o);o+=2,l[u.trim()]=e._lctf.readScriptTable(r,s+d)}return l},e._lctf.readScriptTable=function(r,o){var a=e._bin,s=o,l={},c=a.readUshort(r,o);o+=2,c>0&&(l.default=e._lctf.readLangSysTable(r,s+c));var g=a.readUshort(r,o);o+=2;for(var u=0;u<g;u++){var d=a.readASCII(r,o,4);o+=4;var C=a.readUshort(r,o);o+=2,l[d.trim()]=e._lctf.readLangSysTable(r,s+C)}return l},e._lctf.readLangSysTable=function(r,o){var a=e._bin,s={};a.readUshort(r,o),o+=2,s.reqFeature=a.readUshort(r,o),o+=2;var l=a.readUshort(r,o);return o+=2,s.features=a.readUshorts(r,o,l),s},e.CFF={},e.CFF.parse=function(r,o,a){var s=e._bin;(r=new Uint8Array(r.buffer,o,a))[o=0],r[++o],r[++o],r[++o],o++;var l=[];o=e.CFF.readIndex(r,o,l);for(var c=[],g=0;g<l.length-1;g++)c.push(s.readASCII(r,o+l[g],l[g+1]-l[g]));o+=l[l.length-1];var u=[];o=e.CFF.readIndex(r,o,u);var d=[];for(g=0;g<u.length-1;g++)d.push(e.CFF.readDict(r,o+u[g],o+u[g+1]));o+=u[u.length-1];var C=d[0],f=[];o=e.CFF.readIndex(r,o,f);var v=[];for(g=0;g<f.length-1;g++)v.push(s.readASCII(r,o+f[g],f[g+1]-f[g]));if(o+=f[f.length-1],e.CFF.readSubrs(r,o,C),C.CharStrings){o=C.CharStrings,f=[],o=e.CFF.readIndex(r,o,f);var p=[];for(g=0;g<f.length-1;g++)p.push(s.readBytes(r,o+f[g],f[g+1]-f[g]));C.CharStrings=p}if(C.ROS){o=C.FDArray;var m=[];for(o=e.CFF.readIndex(r,o,m),C.FDArray=[],g=0;g<m.length-1;g++){var A=e.CFF.readDict(r,o+m[g],o+m[g+1]);e.CFF._readFDict(r,A,v),C.FDArray.push(A)}o+=m[m.length-1],o=C.FDSelect,C.FDSelect=[];var b=r[o];if(o++,b!=3)throw b;var G=s.readUshort(r,o);for(o+=2,g=0;g<G+1;g++)C.FDSelect.push(s.readUshort(r,o),r[o+2]),o+=3}return C.Encoding&&(C.Encoding=e.CFF.readEncoding(r,C.Encoding,C.CharStrings.length)),C.charset&&(C.charset=e.CFF.readCharset(r,C.charset,C.CharStrings.length)),e.CFF._readFDict(r,C,v),C},e.CFF._readFDict=function(r,o,a){var s;for(var l in o.Private&&(s=o.Private[1],o.Private=e.CFF.readDict(r,s,s+o.Private[0]),o.Private.Subrs&&e.CFF.readSubrs(r,s+o.Private.Subrs,o.Private)),o)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(l)!=-1&&(o[l]=a[o[l]-426+35])},e.CFF.readSubrs=function(r,o,a){var s=e._bin,l=[];o=e.CFF.readIndex(r,o,l);var c,g=l.length;c=g<1240?107:g<33900?1131:32768,a.Bias=c,a.Subrs=[];for(var u=0;u<l.length-1;u++)a.Subrs.push(s.readBytes(r,o+l[u],l[u+1]-l[u]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(r,o){for(var a=0;a<r.charset.length;a++)if(r.charset[a]==o)return a;return-1},e.CFF.glyphBySE=function(r,o){return o<0||o>255?-1:e.CFF.glyphByUnicode(r,e.CFF.tableSE[o])},e.CFF.readEncoding=function(r,o,a){e._bin;var s=[".notdef"],l=r[o];if(o++,l!=0)throw"error: unknown encoding format: "+l;var c=r[o];o++;for(var g=0;g<c;g++)s.push(r[o+g]);return s},e.CFF.readCharset=function(r,o,a){var s=e._bin,l=[".notdef"],c=r[o];if(o++,c==0)for(var g=0;g<a;g++){var u=s.readUshort(r,o);o+=2,l.push(u)}else{if(c!=1&&c!=2)throw"error: format: "+c;for(;l.length<a;){u=s.readUshort(r,o),o+=2;var d=0;for(c==1?(d=r[o],o++):(d=s.readUshort(r,o),o+=2),g=0;g<=d;g++)l.push(u),u++}}return l},e.CFF.readIndex=function(r,o,a){var s=e._bin,l=s.readUshort(r,o)+1,c=r[o+=2];if(o++,c==1)for(var g=0;g<l;g++)a.push(r[o+g]);else if(c==2)for(g=0;g<l;g++)a.push(s.readUshort(r,o+2*g));else if(c==3)for(g=0;g<l;g++)a.push(16777215&s.readUint(r,o+3*g-1));else if(l!=1)throw"unsupported offset size: "+c+", count: "+l;return(o+=l*c)-1},e.CFF.getCharString=function(r,o,a){var s=e._bin,l=r[o],c=r[o+1];r[o+2],r[o+3],r[o+4];var g=1,u=null,d=null;l<=20&&(u=l,g=1),l==12&&(u=100*l+c,g=2),21<=l&&l<=27&&(u=l,g=1),l==28&&(d=s.readShort(r,o+1),g=3),29<=l&&l<=31&&(u=l,g=1),32<=l&&l<=246&&(d=l-139,g=1),247<=l&&l<=250&&(d=256*(l-247)+c+108,g=2),251<=l&&l<=254&&(d=256*-(l-251)-c-108,g=2),l==255&&(d=s.readInt(r,o+1)/65535,g=5),a.val=d??"o"+u,a.size=g},e.CFF.readCharString=function(r,o,a){for(var s=o+a,l=e._bin,c=[];o<s;){var g=r[o],u=r[o+1];r[o+2],r[o+3],r[o+4];var d=1,C=null,f=null;g<=20&&(C=g,d=1),g==12&&(C=100*g+u,d=2),g!=19&&g!=20||(C=g,d=2),21<=g&&g<=27&&(C=g,d=1),g==28&&(f=l.readShort(r,o+1),d=3),29<=g&&g<=31&&(C=g,d=1),32<=g&&g<=246&&(f=g-139,d=1),247<=g&&g<=250&&(f=256*(g-247)+u+108,d=2),251<=g&&g<=254&&(f=256*-(g-251)-u-108,d=2),g==255&&(f=l.readInt(r,o+1)/65535,d=5),c.push(f??"o"+C),o+=d}return c},e.CFF.readDict=function(r,o,a){for(var s=e._bin,l={},c=[];o<a;){var g=r[o],u=r[o+1];r[o+2],r[o+3],r[o+4];var d=1,C=null,f=null;if(g==28&&(f=s.readShort(r,o+1),d=3),g==29&&(f=s.readInt(r,o+1),d=5),32<=g&&g<=246&&(f=g-139,d=1),247<=g&&g<=250&&(f=256*(g-247)+u+108,d=2),251<=g&&g<=254&&(f=256*-(g-251)-u-108,d=2),g==255)throw f=s.readInt(r,o+1)/65535,d=5,"unknown number";if(g==30){var v=[];for(d=1;;){var p=r[o+d];d++;var m=p>>4,A=15&p;if(m!=15&&v.push(m),A!=15&&v.push(A),A==15)break}for(var b="",G=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],w=0;w<v.length;w++)b+=G[v[w]];f=parseFloat(b)}g<=21&&(C=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][g],d=1,g==12&&(C=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][u],d=2)),C!=null?(l[C]=c.length==1?c[0]:c,c=[]):c.push(f),o+=d}return l},e.cmap={},e.cmap.parse=function(r,o,a){r=new Uint8Array(r.buffer,o,a),o=0;var s=e._bin,l={};s.readUshort(r,o),o+=2;var c=s.readUshort(r,o);o+=2;var g=[];l.tables=[];for(var u=0;u<c;u++){var d=s.readUshort(r,o);o+=2;var C=s.readUshort(r,o);o+=2;var f=s.readUint(r,o);o+=4;var v="p"+d+"e"+C,p=g.indexOf(f);if(p==-1){var m;p=l.tables.length,g.push(f);var A=s.readUshort(r,f);A==0?m=e.cmap.parse0(r,f):A==4?m=e.cmap.parse4(r,f):A==6?m=e.cmap.parse6(r,f):A==12?m=e.cmap.parse12(r,f):console.debug("unknown format: "+A,d,C,f),l.tables.push(m)}if(l[v]!=null)throw"multiple tables for one platform+encoding";l[v]=p}return l},e.cmap.parse0=function(r,o){var a=e._bin,s={};s.format=a.readUshort(r,o),o+=2;var l=a.readUshort(r,o);o+=2,a.readUshort(r,o),o+=2,s.map=[];for(var c=0;c<l-6;c++)s.map.push(r[o+c]);return s},e.cmap.parse4=function(r,o){var a=e._bin,s=o,l={};l.format=a.readUshort(r,o),o+=2;var c=a.readUshort(r,o);o+=2,a.readUshort(r,o),o+=2;var g=a.readUshort(r,o);o+=2;var u=g/2;l.searchRange=a.readUshort(r,o),o+=2,l.entrySelector=a.readUshort(r,o),o+=2,l.rangeShift=a.readUshort(r,o),o+=2,l.endCount=a.readUshorts(r,o,u),o+=2*u,o+=2,l.startCount=a.readUshorts(r,o,u),o+=2*u,l.idDelta=[];for(var d=0;d<u;d++)l.idDelta.push(a.readShort(r,o)),o+=2;for(l.idRangeOffset=a.readUshorts(r,o,u),o+=2*u,l.glyphIdArray=[];o<s+c;)l.glyphIdArray.push(a.readUshort(r,o)),o+=2;return l},e.cmap.parse6=function(r,o){var a=e._bin,s={};s.format=a.readUshort(r,o),o+=2,a.readUshort(r,o),o+=2,a.readUshort(r,o),o+=2,s.firstCode=a.readUshort(r,o),o+=2;var l=a.readUshort(r,o);o+=2,s.glyphIdArray=[];for(var c=0;c<l;c++)s.glyphIdArray.push(a.readUshort(r,o)),o+=2;return s},e.cmap.parse12=function(r,o){var a=e._bin,s={};s.format=a.readUshort(r,o),o+=2,o+=2,a.readUint(r,o),o+=4,a.readUint(r,o),o+=4;var l=a.readUint(r,o);o+=4,s.groups=[];for(var c=0;c<l;c++){var g=o+12*c,u=a.readUint(r,g+0),d=a.readUint(r,g+4),C=a.readUint(r,g+8);s.groups.push([u,d,C])}return s},e.glyf={},e.glyf.parse=function(r,o,a,s){for(var l=[],c=0;c<s.maxp.numGlyphs;c++)l.push(null);return l},e.glyf._parseGlyf=function(r,o){var a=e._bin,s=r._data,l=e._tabOffset(s,"glyf",r._offset)+r.loca[o];if(r.loca[o]==r.loca[o+1])return null;var c={};if(c.noc=a.readShort(s,l),l+=2,c.xMin=a.readShort(s,l),l+=2,c.yMin=a.readShort(s,l),l+=2,c.xMax=a.readShort(s,l),l+=2,c.yMax=a.readShort(s,l),l+=2,c.xMin>=c.xMax||c.yMin>=c.yMax)return null;if(c.noc>0){c.endPts=[];for(var g=0;g<c.noc;g++)c.endPts.push(a.readUshort(s,l)),l+=2;var u=a.readUshort(s,l);if(l+=2,s.length-l<u)return null;c.instructions=a.readBytes(s,l,u),l+=u;var d=c.endPts[c.noc-1]+1;for(c.flags=[],g=0;g<d;g++){var C=s[l];if(l++,c.flags.push(C),(8&C)!=0){var f=s[l];l++;for(var v=0;v<f;v++)c.flags.push(C),g++}}for(c.xs=[],g=0;g<d;g++){var p=(2&c.flags[g])!=0,m=(16&c.flags[g])!=0;p?(c.xs.push(m?s[l]:-s[l]),l++):m?c.xs.push(0):(c.xs.push(a.readShort(s,l)),l+=2)}for(c.ys=[],g=0;g<d;g++)p=(4&c.flags[g])!=0,m=(32&c.flags[g])!=0,p?(c.ys.push(m?s[l]:-s[l]),l++):m?c.ys.push(0):(c.ys.push(a.readShort(s,l)),l+=2);var A=0,b=0;for(g=0;g<d;g++)A+=c.xs[g],b+=c.ys[g],c.xs[g]=A,c.ys[g]=b}else{var G;c.parts=[];do{G=a.readUshort(s,l),l+=2;var w={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(c.parts.push(w),w.glyphIndex=a.readUshort(s,l),l+=2,1&G){var S=a.readShort(s,l);l+=2;var Z=a.readShort(s,l);l+=2}else S=a.readInt8(s,l),l++,Z=a.readInt8(s,l),l++;2&G?(w.m.tx=S,w.m.ty=Z):(w.p1=S,w.p2=Z),8&G?(w.m.a=w.m.d=a.readF2dot14(s,l),l+=2):64&G?(w.m.a=a.readF2dot14(s,l),l+=2,w.m.d=a.readF2dot14(s,l),l+=2):128&G&&(w.m.a=a.readF2dot14(s,l),l+=2,w.m.b=a.readF2dot14(s,l),l+=2,w.m.c=a.readF2dot14(s,l),l+=2,w.m.d=a.readF2dot14(s,l),l+=2)}while(32&G);if(256&G){var x=a.readUshort(s,l);for(l+=2,c.instr=[],g=0;g<x;g++)c.instr.push(s[l]),l++}}return c},e.GDEF={},e.GDEF.parse=function(r,o,a,s){var l=o;o+=4;var c=e._bin.readUshort(r,o);return{glyphClassDef:c===0?null:e._lctf.readClassDef(r,l+c)}},e.GPOS={},e.GPOS.parse=function(r,o,a,s){return e._lctf.parse(r,o,a,s,e.GPOS.subt)},e.GPOS.subt=function(r,o,a,s){var l=e._bin,c=a,g={};if(g.fmt=l.readUshort(r,a),a+=2,o==1||o==2||o==3||o==7||o==8&&g.fmt<=2){var u=l.readUshort(r,a);a+=2,g.coverage=e._lctf.readCoverage(r,u+c)}if(o==1&&g.fmt==1){var d=l.readUshort(r,a);a+=2,d!=0&&(g.pos=e.GPOS.readValueRecord(r,a,d))}else if(o==2&&g.fmt>=1&&g.fmt<=2){d=l.readUshort(r,a),a+=2;var C=l.readUshort(r,a);a+=2;var f=e._lctf.numOfOnes(d),v=e._lctf.numOfOnes(C);if(g.fmt==1){g.pairsets=[];var p=l.readUshort(r,a);a+=2;for(var m=0;m<p;m++){var A=c+l.readUshort(r,a);a+=2;var b=l.readUshort(r,A);A+=2;for(var G=[],w=0;w<b;w++){var S=l.readUshort(r,A);A+=2,d!=0&&(N=e.GPOS.readValueRecord(r,A,d),A+=2*f),C!=0&&(X=e.GPOS.readValueRecord(r,A,C),A+=2*v),G.push({gid2:S,val1:N,val2:X})}g.pairsets.push(G)}}if(g.fmt==2){var Z=l.readUshort(r,a);a+=2;var x=l.readUshort(r,a);a+=2;var R=l.readUshort(r,a);a+=2;var W=l.readUshort(r,a);for(a+=2,g.classDef1=e._lctf.readClassDef(r,c+Z),g.classDef2=e._lctf.readClassDef(r,c+x),g.matrix=[],m=0;m<R;m++){var M=[];for(w=0;w<W;w++){var N=null,X=null;d!=0&&(N=e.GPOS.readValueRecord(r,a,d),a+=2*f),C!=0&&(X=e.GPOS.readValueRecord(r,a,C),a+=2*v),M.push({val1:N,val2:X})}g.matrix.push(M)}}}else if(o==4&&g.fmt==1)g.markCoverage=e._lctf.readCoverage(r,l.readUshort(r,a)+c),g.baseCoverage=e._lctf.readCoverage(r,l.readUshort(r,a+2)+c),g.markClassCount=l.readUshort(r,a+4),g.markArray=e.GPOS.readMarkArray(r,l.readUshort(r,a+6)+c),g.baseArray=e.GPOS.readBaseArray(r,l.readUshort(r,a+8)+c,g.markClassCount);else if(o==6&&g.fmt==1)g.mark1Coverage=e._lctf.readCoverage(r,l.readUshort(r,a)+c),g.mark2Coverage=e._lctf.readCoverage(r,l.readUshort(r,a+2)+c),g.markClassCount=l.readUshort(r,a+4),g.mark1Array=e.GPOS.readMarkArray(r,l.readUshort(r,a+6)+c),g.mark2Array=e.GPOS.readBaseArray(r,l.readUshort(r,a+8)+c,g.markClassCount);else{if(o==9&&g.fmt==1){var E=l.readUshort(r,a);a+=2;var Q=l.readUint(r,a);if(a+=4,s.ltype==9)s.ltype=E;else if(s.ltype!=E)throw"invalid extension substitution";return e.GPOS.subt(r,s.ltype,c+Q)}console.debug("unsupported GPOS table LookupType",o,"format",g.fmt)}return g},e.GPOS.readValueRecord=function(r,o,a){var s=e._bin,l=[];return l.push(1&a?s.readShort(r,o):0),o+=1&a?2:0,l.push(2&a?s.readShort(r,o):0),o+=2&a?2:0,l.push(4&a?s.readShort(r,o):0),o+=4&a?2:0,l.push(8&a?s.readShort(r,o):0),o+=8&a?2:0,l},e.GPOS.readBaseArray=function(r,o,a){var s=e._bin,l=[],c=o,g=s.readUshort(r,o);o+=2;for(var u=0;u<g;u++){for(var d=[],C=0;C<a;C++)d.push(e.GPOS.readAnchorRecord(r,c+s.readUshort(r,o))),o+=2;l.push(d)}return l},e.GPOS.readMarkArray=function(r,o){var a=e._bin,s=[],l=o,c=a.readUshort(r,o);o+=2;for(var g=0;g<c;g++){var u=e.GPOS.readAnchorRecord(r,a.readUshort(r,o+2)+l);u.markClass=a.readUshort(r,o),s.push(u),o+=4}return s},e.GPOS.readAnchorRecord=function(r,o){var a=e._bin,s={};return s.fmt=a.readUshort(r,o),s.x=a.readShort(r,o+2),s.y=a.readShort(r,o+4),s},e.GSUB={},e.GSUB.parse=function(r,o,a,s){return e._lctf.parse(r,o,a,s,e.GSUB.subt)},e.GSUB.subt=function(r,o,a,s){var l=e._bin,c=a,g={};if(g.fmt=l.readUshort(r,a),a+=2,o!=1&&o!=2&&o!=4&&o!=5&&o!=6)return null;if(o==1||o==2||o==4||o==5&&g.fmt<=2||o==6&&g.fmt<=2){var u=l.readUshort(r,a);a+=2,g.coverage=e._lctf.readCoverage(r,c+u)}if(o==1&&g.fmt>=1&&g.fmt<=2){if(g.fmt==1)g.delta=l.readShort(r,a),a+=2;else if(g.fmt==2){var d=l.readUshort(r,a);a+=2,g.newg=l.readUshorts(r,a,d),a+=2*g.newg.length}}else if(o==2&&g.fmt==1){d=l.readUshort(r,a),a+=2,g.seqs=[];for(var C=0;C<d;C++){var f=l.readUshort(r,a)+c;a+=2;var v=l.readUshort(r,f);g.seqs.push(l.readUshorts(r,f+2,v))}}else if(o==4)for(g.vals=[],d=l.readUshort(r,a),a+=2,C=0;C<d;C++){var p=l.readUshort(r,a);a+=2,g.vals.push(e.GSUB.readLigatureSet(r,c+p))}else if(o==5&&g.fmt==2){if(g.fmt==2){var m=l.readUshort(r,a);a+=2,g.cDef=e._lctf.readClassDef(r,c+m),g.scset=[];var A=l.readUshort(r,a);for(a+=2,C=0;C<A;C++){var b=l.readUshort(r,a);a+=2,g.scset.push(b==0?null:e.GSUB.readSubClassSet(r,c+b))}}}else if(o==6&&g.fmt==3){if(g.fmt==3){for(C=0;C<3;C++){d=l.readUshort(r,a),a+=2;for(var G=[],w=0;w<d;w++)G.push(e._lctf.readCoverage(r,c+l.readUshort(r,a+2*w)));a+=2*d,C==0&&(g.backCvg=G),C==1&&(g.inptCvg=G),C==2&&(g.ahedCvg=G)}d=l.readUshort(r,a),a+=2,g.lookupRec=e.GSUB.readSubstLookupRecords(r,a,d)}}else{if(o==7&&g.fmt==1){var S=l.readUshort(r,a);a+=2;var Z=l.readUint(r,a);if(a+=4,s.ltype==9)s.ltype=S;else if(s.ltype!=S)throw"invalid extension substitution";return e.GSUB.subt(r,s.ltype,c+Z)}console.debug("unsupported GSUB table LookupType",o,"format",g.fmt)}return g},e.GSUB.readSubClassSet=function(r,o){var a=e._bin.readUshort,s=o,l=[],c=a(r,o);o+=2;for(var g=0;g<c;g++){var u=a(r,o);o+=2,l.push(e.GSUB.readSubClassRule(r,s+u))}return l},e.GSUB.readSubClassRule=function(r,o){var a=e._bin.readUshort,s={},l=a(r,o),c=a(r,o+=2);o+=2,s.input=[];for(var g=0;g<l-1;g++)s.input.push(a(r,o)),o+=2;return s.substLookupRecords=e.GSUB.readSubstLookupRecords(r,o,c),s},e.GSUB.readSubstLookupRecords=function(r,o,a){for(var s=e._bin.readUshort,l=[],c=0;c<a;c++)l.push(s(r,o),s(r,o+2)),o+=4;return l},e.GSUB.readChainSubClassSet=function(r,o){var a=e._bin,s=o,l=[],c=a.readUshort(r,o);o+=2;for(var g=0;g<c;g++){var u=a.readUshort(r,o);o+=2,l.push(e.GSUB.readChainSubClassRule(r,s+u))}return l},e.GSUB.readChainSubClassRule=function(r,o){for(var a=e._bin,s={},l=["backtrack","input","lookahead"],c=0;c<l.length;c++){var g=a.readUshort(r,o);o+=2,c==1&&g--,s[l[c]]=a.readUshorts(r,o,g),o+=2*s[l[c]].length}return g=a.readUshort(r,o),o+=2,s.subst=a.readUshorts(r,o,2*g),o+=2*s.subst.length,s},e.GSUB.readLigatureSet=function(r,o){var a=e._bin,s=o,l=[],c=a.readUshort(r,o);o+=2;for(var g=0;g<c;g++){var u=a.readUshort(r,o);o+=2,l.push(e.GSUB.readLigature(r,s+u))}return l},e.GSUB.readLigature=function(r,o){var a=e._bin,s={chain:[]};s.nglyph=a.readUshort(r,o),o+=2;var l=a.readUshort(r,o);o+=2;for(var c=0;c<l-1;c++)s.chain.push(a.readUshort(r,o)),o+=2;return s},e.head={},e.head.parse=function(r,o,a){var s=e._bin,l={};return s.readFixed(r,o),o+=4,l.fontRevision=s.readFixed(r,o),o+=4,s.readUint(r,o),o+=4,s.readUint(r,o),o+=4,l.flags=s.readUshort(r,o),o+=2,l.unitsPerEm=s.readUshort(r,o),o+=2,l.created=s.readUint64(r,o),o+=8,l.modified=s.readUint64(r,o),o+=8,l.xMin=s.readShort(r,o),o+=2,l.yMin=s.readShort(r,o),o+=2,l.xMax=s.readShort(r,o),o+=2,l.yMax=s.readShort(r,o),o+=2,l.macStyle=s.readUshort(r,o),o+=2,l.lowestRecPPEM=s.readUshort(r,o),o+=2,l.fontDirectionHint=s.readShort(r,o),o+=2,l.indexToLocFormat=s.readShort(r,o),o+=2,l.glyphDataFormat=s.readShort(r,o),o+=2,l},e.hhea={},e.hhea.parse=function(r,o,a){var s=e._bin,l={};return s.readFixed(r,o),o+=4,l.ascender=s.readShort(r,o),o+=2,l.descender=s.readShort(r,o),o+=2,l.lineGap=s.readShort(r,o),o+=2,l.advanceWidthMax=s.readUshort(r,o),o+=2,l.minLeftSideBearing=s.readShort(r,o),o+=2,l.minRightSideBearing=s.readShort(r,o),o+=2,l.xMaxExtent=s.readShort(r,o),o+=2,l.caretSlopeRise=s.readShort(r,o),o+=2,l.caretSlopeRun=s.readShort(r,o),o+=2,l.caretOffset=s.readShort(r,o),o+=2,o+=8,l.metricDataFormat=s.readShort(r,o),o+=2,l.numberOfHMetrics=s.readUshort(r,o),o+=2,l},e.hmtx={},e.hmtx.parse=function(r,o,a,s){for(var l=e._bin,c={aWidth:[],lsBearing:[]},g=0,u=0,d=0;d<s.maxp.numGlyphs;d++)d<s.hhea.numberOfHMetrics&&(g=l.readUshort(r,o),o+=2,u=l.readShort(r,o),o+=2),c.aWidth.push(g),c.lsBearing.push(u);return c},e.kern={},e.kern.parse=function(r,o,a,s){var l=e._bin,c=l.readUshort(r,o);if(o+=2,c==1)return e.kern.parseV1(r,o-2,a,s);var g=l.readUshort(r,o);o+=2;for(var u={glyph1:[],rval:[]},d=0;d<g;d++){o+=2,a=l.readUshort(r,o),o+=2;var C=l.readUshort(r,o);o+=2;var f=C>>>8;if((f&=15)!=0)throw"unknown kern table format: "+f;o=e.kern.readFormat0(r,o,u)}return u},e.kern.parseV1=function(r,o,a,s){var l=e._bin;l.readFixed(r,o),o+=4;var c=l.readUint(r,o);o+=4;for(var g={glyph1:[],rval:[]},u=0;u<c;u++){l.readUint(r,o),o+=4;var d=l.readUshort(r,o);o+=2,l.readUshort(r,o),o+=2;var C=d>>>8;if((C&=15)!=0)throw"unknown kern table format: "+C;o=e.kern.readFormat0(r,o,g)}return g},e.kern.readFormat0=function(r,o,a){var s=e._bin,l=-1,c=s.readUshort(r,o);o+=2,s.readUshort(r,o),o+=2,s.readUshort(r,o),o+=2,s.readUshort(r,o),o+=2;for(var g=0;g<c;g++){var u=s.readUshort(r,o);o+=2;var d=s.readUshort(r,o);o+=2;var C=s.readShort(r,o);o+=2,u!=l&&(a.glyph1.push(u),a.rval.push({glyph2:[],vals:[]}));var f=a.rval[a.rval.length-1];f.glyph2.push(d),f.vals.push(C),l=u}return o},e.loca={},e.loca.parse=function(r,o,a,s){var l=e._bin,c=[],g=s.head.indexToLocFormat,u=s.maxp.numGlyphs+1;if(g==0)for(var d=0;d<u;d++)c.push(l.readUshort(r,o+(d<<1))<<1);if(g==1)for(d=0;d<u;d++)c.push(l.readUint(r,o+(d<<2)));return c},e.maxp={},e.maxp.parse=function(r,o,a){var s=e._bin,l={},c=s.readUint(r,o);return o+=4,l.numGlyphs=s.readUshort(r,o),o+=2,c==65536&&(l.maxPoints=s.readUshort(r,o),o+=2,l.maxContours=s.readUshort(r,o),o+=2,l.maxCompositePoints=s.readUshort(r,o),o+=2,l.maxCompositeContours=s.readUshort(r,o),o+=2,l.maxZones=s.readUshort(r,o),o+=2,l.maxTwilightPoints=s.readUshort(r,o),o+=2,l.maxStorage=s.readUshort(r,o),o+=2,l.maxFunctionDefs=s.readUshort(r,o),o+=2,l.maxInstructionDefs=s.readUshort(r,o),o+=2,l.maxStackElements=s.readUshort(r,o),o+=2,l.maxSizeOfInstructions=s.readUshort(r,o),o+=2,l.maxComponentElements=s.readUshort(r,o),o+=2,l.maxComponentDepth=s.readUshort(r,o),o+=2),l},e.name={},e.name.parse=function(r,o,a){var s=e._bin,l={};s.readUshort(r,o),o+=2;var c=s.readUshort(r,o);o+=2,s.readUshort(r,o);for(var g,u=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],d=o+=2,C=0;C<c;C++){var f=s.readUshort(r,o);o+=2;var v=s.readUshort(r,o);o+=2;var p=s.readUshort(r,o);o+=2;var m=s.readUshort(r,o);o+=2;var A=s.readUshort(r,o);o+=2;var b=s.readUshort(r,o);o+=2;var G,w=u[m],S=d+12*c+b;if(f==0)G=s.readUnicode(r,S,A/2);else if(f==3&&v==0)G=s.readUnicode(r,S,A/2);else if(v==0)G=s.readASCII(r,S,A);else if(v==1)G=s.readUnicode(r,S,A/2);else if(v==3)G=s.readUnicode(r,S,A/2);else{if(f!=1)throw"unknown encoding "+v+", platformID: "+f;G=s.readASCII(r,S,A),console.debug("reading unknown MAC encoding "+v+" as ASCII")}var Z="p"+f+","+p.toString(16);l[Z]==null&&(l[Z]={}),l[Z][w!==void 0?w:m]=G,l[Z]._lang=p}for(var x in l)if(l[x].postScriptName!=null&&l[x]._lang==1033)return l[x];for(var x in l)if(l[x].postScriptName!=null&&l[x]._lang==0)return l[x];for(var x in l)if(l[x].postScriptName!=null&&l[x]._lang==3084)return l[x];for(var x in l)if(l[x].postScriptName!=null)return l[x];for(var x in l){g=x;break}return console.debug("returning name table with languageID "+l[g]._lang),l[g]},e["OS/2"]={},e["OS/2"].parse=function(r,o,a){var s=e._bin.readUshort(r,o);o+=2;var l={};if(s==0)e["OS/2"].version0(r,o,l);else if(s==1)e["OS/2"].version1(r,o,l);else if(s==2||s==3||s==4)e["OS/2"].version2(r,o,l);else{if(s!=5)throw"unknown OS/2 table version: "+s;e["OS/2"].version5(r,o,l)}return l},e["OS/2"].version0=function(r,o,a){var s=e._bin;return a.xAvgCharWidth=s.readShort(r,o),o+=2,a.usWeightClass=s.readUshort(r,o),o+=2,a.usWidthClass=s.readUshort(r,o),o+=2,a.fsType=s.readUshort(r,o),o+=2,a.ySubscriptXSize=s.readShort(r,o),o+=2,a.ySubscriptYSize=s.readShort(r,o),o+=2,a.ySubscriptXOffset=s.readShort(r,o),o+=2,a.ySubscriptYOffset=s.readShort(r,o),o+=2,a.ySuperscriptXSize=s.readShort(r,o),o+=2,a.ySuperscriptYSize=s.readShort(r,o),o+=2,a.ySuperscriptXOffset=s.readShort(r,o),o+=2,a.ySuperscriptYOffset=s.readShort(r,o),o+=2,a.yStrikeoutSize=s.readShort(r,o),o+=2,a.yStrikeoutPosition=s.readShort(r,o),o+=2,a.sFamilyClass=s.readShort(r,o),o+=2,a.panose=s.readBytes(r,o,10),o+=10,a.ulUnicodeRange1=s.readUint(r,o),o+=4,a.ulUnicodeRange2=s.readUint(r,o),o+=4,a.ulUnicodeRange3=s.readUint(r,o),o+=4,a.ulUnicodeRange4=s.readUint(r,o),o+=4,a.achVendID=[s.readInt8(r,o),s.readInt8(r,o+1),s.readInt8(r,o+2),s.readInt8(r,o+3)],o+=4,a.fsSelection=s.readUshort(r,o),o+=2,a.usFirstCharIndex=s.readUshort(r,o),o+=2,a.usLastCharIndex=s.readUshort(r,o),o+=2,a.sTypoAscender=s.readShort(r,o),o+=2,a.sTypoDescender=s.readShort(r,o),o+=2,a.sTypoLineGap=s.readShort(r,o),o+=2,a.usWinAscent=s.readUshort(r,o),o+=2,a.usWinDescent=s.readUshort(r,o),o+=2},e["OS/2"].version1=function(r,o,a){var s=e._bin;return o=e["OS/2"].version0(r,o,a),a.ulCodePageRange1=s.readUint(r,o),o+=4,a.ulCodePageRange2=s.readUint(r,o),o+=4},e["OS/2"].version2=function(r,o,a){var s=e._bin;return o=e["OS/2"].version1(r,o,a),a.sxHeight=s.readShort(r,o),o+=2,a.sCapHeight=s.readShort(r,o),o+=2,a.usDefault=s.readUshort(r,o),o+=2,a.usBreak=s.readUshort(r,o),o+=2,a.usMaxContext=s.readUshort(r,o),o+=2},e["OS/2"].version5=function(r,o,a){var s=e._bin;return o=e["OS/2"].version2(r,o,a),a.usLowerOpticalPointSize=s.readUshort(r,o),o+=2,a.usUpperOpticalPointSize=s.readUshort(r,o),o+=2},e.post={},e.post.parse=function(r,o,a){var s=e._bin,l={};return l.version=s.readFixed(r,o),o+=4,l.italicAngle=s.readFixed(r,o),o+=4,l.underlinePosition=s.readShort(r,o),o+=2,l.underlineThickness=s.readShort(r,o),o+=2,l},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(r,o){var a=r.cmap,s=-1;if(a.p0e4!=null?s=a.p0e4:a.p3e1!=null?s=a.p3e1:a.p1e0!=null?s=a.p1e0:a.p0e3!=null&&(s=a.p0e3),s==-1)throw"no familiar platform and encoding!";var l=a.tables[s];if(l.format==0)return o>=l.map.length?0:l.map[o];if(l.format==4){for(var c=-1,g=0;g<l.endCount.length;g++)if(o<=l.endCount[g]){c=g;break}return c==-1||l.startCount[c]>o?0:65535&(l.idRangeOffset[c]!=0?l.glyphIdArray[o-l.startCount[c]+(l.idRangeOffset[c]>>1)-(l.idRangeOffset.length-c)]:o+l.idDelta[c])}if(l.format==12){if(o>l.groups[l.groups.length-1][1])return 0;for(g=0;g<l.groups.length;g++){var u=l.groups[g];if(u[0]<=o&&o<=u[1])return u[2]+(o-u[0])}return 0}throw"unknown cmap table format "+l.format},e.U.glyphToPath=function(r,o){var a={cmds:[],crds:[]};if(r.SVG&&r.SVG.entries[o]){var s=r.SVG.entries[o];return s==null?a:(typeof s=="string"&&(s=e.SVG.toPath(s),r.SVG.entries[o]=s),s)}if(r.CFF){var l={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:r.CFF.Private?r.CFF.Private.defaultWidthX:0,open:!1},c=r.CFF,g=r.CFF.Private;if(c.ROS){for(var u=0;c.FDSelect[u+2]<=o;)u+=2;g=c.FDArray[c.FDSelect[u+1]].Private}e.U._drawCFF(r.CFF.CharStrings[o],l,c,g,a)}else r.glyf&&e.U._drawGlyf(o,r,a);return a},e.U._drawGlyf=function(r,o,a){var s=o.glyf[r];s==null&&(s=o.glyf[r]=e.glyf._parseGlyf(o,r)),s!=null&&(s.noc>-1?e.U._simpleGlyph(s,a):e.U._compoGlyph(s,o,a))},e.U._simpleGlyph=function(r,o){for(var a=0;a<r.noc;a++){for(var s=a==0?0:r.endPts[a-1]+1,l=r.endPts[a],c=s;c<=l;c++){var g=c==s?l:c-1,u=c==l?s:c+1,d=1&r.flags[c],C=1&r.flags[g],f=1&r.flags[u],v=r.xs[c],p=r.ys[c];if(c==s)if(d){if(!C){e.U.P.moveTo(o,v,p);continue}e.U.P.moveTo(o,r.xs[g],r.ys[g])}else C?e.U.P.moveTo(o,r.xs[g],r.ys[g]):e.U.P.moveTo(o,(r.xs[g]+v)/2,(r.ys[g]+p)/2);d?C&&e.U.P.lineTo(o,v,p):f?e.U.P.qcurveTo(o,v,p,r.xs[u],r.ys[u]):e.U.P.qcurveTo(o,v,p,(v+r.xs[u])/2,(p+r.ys[u])/2)}e.U.P.closePath(o)}},e.U._compoGlyph=function(r,o,a){for(var s=0;s<r.parts.length;s++){var l={cmds:[],crds:[]},c=r.parts[s];e.U._drawGlyf(c.glyphIndex,o,l);for(var g=c.m,u=0;u<l.crds.length;u+=2){var d=l.crds[u],C=l.crds[u+1];a.crds.push(d*g.a+C*g.b+g.tx),a.crds.push(d*g.c+C*g.d+g.ty)}for(u=0;u<l.cmds.length;u++)a.cmds.push(l.cmds[u])}},e.U._getGlyphClass=function(r,o){var a=e._lctf.getInterval(o,r);return a==-1?0:o[a+2]},e.U._applySubs=function(r,o,a,s){for(var l=r.length-o-1,c=0;c<a.tabs.length;c++)if(a.tabs[c]!=null){var g,u=a.tabs[c];if(!u.coverage||(g=e._lctf.coverageIndex(u.coverage,r[o]))!=-1){if(a.ltype==1)r[o],u.fmt==1?r[o]=r[o]+u.delta:r[o]=u.newg[g];else if(a.ltype==4)for(var d=u.vals[g],C=0;C<d.length;C++){var f=d[C],v=f.chain.length;if(!(v>l)){for(var p=!0,m=0,A=0;A<v;A++){for(;r[o+m+(1+A)]==-1;)m++;f.chain[A]!=r[o+m+(1+A)]&&(p=!1)}if(p){for(r[o]=f.nglyph,A=0;A<v+m;A++)r[o+A+1]=-1;break}}}else if(a.ltype==5&&u.fmt==2)for(var b=e._lctf.getInterval(u.cDef,r[o]),G=u.cDef[b+2],w=u.scset[G],S=0;S<w.length;S++){var Z=w[S],x=Z.input;if(!(x.length>l)){for(p=!0,A=0;A<x.length;A++){var R=e._lctf.getInterval(u.cDef,r[o+1+A]);if(b==-1&&u.cDef[R+2]!=x[A]){p=!1;break}}if(p){var W=Z.substLookupRecords;for(C=0;C<W.length;C+=2)W[C],W[C+1]}}}else if(a.ltype==6&&u.fmt==3){if(!e.U._glsCovered(r,u.backCvg,o-u.backCvg.length)||!e.U._glsCovered(r,u.inptCvg,o)||!e.U._glsCovered(r,u.ahedCvg,o+u.inptCvg.length))continue;var M=u.lookupRec;for(S=0;S<M.length;S+=2){b=M[S];var N=s[M[S+1]];e.U._applySubs(r,o+b,N,s)}}}}},e.U._glsCovered=function(r,o,a){for(var s=0;s<o.length;s++)if(e._lctf.coverageIndex(o[s],r[a+s])==-1)return!1;return!0},e.U.glyphsToPath=function(r,o,a){for(var s={cmds:[],crds:[]},l=0,c=0;c<o.length;c++){var g=o[c];if(g!=-1){for(var u=c<o.length-1&&o[c+1]!=-1?o[c+1]:0,d=e.U.glyphToPath(r,g),C=0;C<d.crds.length;C+=2)s.crds.push(d.crds[C]+l),s.crds.push(d.crds[C+1]);for(a&&s.cmds.push(a),C=0;C<d.cmds.length;C++)s.cmds.push(d.cmds[C]);a&&s.cmds.push("X"),l+=r.hmtx.aWidth[g],c<o.length-1&&(l+=e.U.getPairAdjustment(r,g,u))}}return s},e.U.P={},e.U.P.moveTo=function(r,o,a){r.cmds.push("M"),r.crds.push(o,a)},e.U.P.lineTo=function(r,o,a){r.cmds.push("L"),r.crds.push(o,a)},e.U.P.curveTo=function(r,o,a,s,l,c,g){r.cmds.push("C"),r.crds.push(o,a,s,l,c,g)},e.U.P.qcurveTo=function(r,o,a,s,l){r.cmds.push("Q"),r.crds.push(o,a,s,l)},e.U.P.closePath=function(r){r.cmds.push("Z")},e.U._drawCFF=function(r,o,a,s,l){for(var c=o.stack,g=o.nStems,u=o.haveWidth,d=o.width,C=o.open,f=0,v=o.x,p=o.y,m=0,A=0,b=0,G=0,w=0,S=0,Z=0,x=0,R=0,W=0,M={val:0,size:0};f<r.length;){e.CFF.getCharString(r,f,M);var N=M.val;if(f+=M.size,N=="o1"||N=="o18")c.length%2!=0&&!u&&(d=c.shift()+s.nominalWidthX),g+=c.length>>1,c.length=0,u=!0;else if(N=="o3"||N=="o23")c.length%2!=0&&!u&&(d=c.shift()+s.nominalWidthX),g+=c.length>>1,c.length=0,u=!0;else if(N=="o4")c.length>1&&!u&&(d=c.shift()+s.nominalWidthX,u=!0),C&&e.U.P.closePath(l),p+=c.pop(),e.U.P.moveTo(l,v,p),C=!0;else if(N=="o5")for(;c.length>0;)v+=c.shift(),p+=c.shift(),e.U.P.lineTo(l,v,p);else if(N=="o6"||N=="o7")for(var X=c.length,E=N=="o6",Q=0;Q<X;Q++){var k=c.shift();E?v+=k:p+=k,E=!E,e.U.P.lineTo(l,v,p)}else if(N=="o8"||N=="o24"){X=c.length;for(var J=0;J+6<=X;)m=v+c.shift(),A=p+c.shift(),b=m+c.shift(),G=A+c.shift(),v=b+c.shift(),p=G+c.shift(),e.U.P.curveTo(l,m,A,b,G,v,p),J+=6;N=="o24"&&(v+=c.shift(),p+=c.shift(),e.U.P.lineTo(l,v,p))}else{if(N=="o11")break;if(N=="o1234"||N=="o1235"||N=="o1236"||N=="o1237")N=="o1234"&&(A=p,b=(m=v+c.shift())+c.shift(),W=G=A+c.shift(),S=G,x=p,v=(Z=(w=(R=b+c.shift())+c.shift())+c.shift())+c.shift(),e.U.P.curveTo(l,m,A,b,G,R,W),e.U.P.curveTo(l,w,S,Z,x,v,p)),N=="o1235"&&(m=v+c.shift(),A=p+c.shift(),b=m+c.shift(),G=A+c.shift(),R=b+c.shift(),W=G+c.shift(),w=R+c.shift(),S=W+c.shift(),Z=w+c.shift(),x=S+c.shift(),v=Z+c.shift(),p=x+c.shift(),c.shift(),e.U.P.curveTo(l,m,A,b,G,R,W),e.U.P.curveTo(l,w,S,Z,x,v,p)),N=="o1236"&&(m=v+c.shift(),A=p+c.shift(),b=m+c.shift(),W=G=A+c.shift(),S=G,Z=(w=(R=b+c.shift())+c.shift())+c.shift(),x=S+c.shift(),v=Z+c.shift(),e.U.P.curveTo(l,m,A,b,G,R,W),e.U.P.curveTo(l,w,S,Z,x,v,p)),N=="o1237"&&(m=v+c.shift(),A=p+c.shift(),b=m+c.shift(),G=A+c.shift(),R=b+c.shift(),W=G+c.shift(),w=R+c.shift(),S=W+c.shift(),Z=w+c.shift(),x=S+c.shift(),Math.abs(Z-v)>Math.abs(x-p)?v=Z+c.shift():p=x+c.shift(),e.U.P.curveTo(l,m,A,b,G,R,W),e.U.P.curveTo(l,w,S,Z,x,v,p));else if(N=="o14"){if(c.length>0&&!u&&(d=c.shift()+a.nominalWidthX,u=!0),c.length==4){var F=c.shift(),L=c.shift(),z=c.shift(),K=c.shift(),O=e.CFF.glyphBySE(a,z),j=e.CFF.glyphBySE(a,K);e.U._drawCFF(a.CharStrings[O],o,a,s,l),o.x=F,o.y=L,e.U._drawCFF(a.CharStrings[j],o,a,s,l)}C&&(e.U.P.closePath(l),C=!1)}else if(N=="o19"||N=="o20")c.length%2!=0&&!u&&(d=c.shift()+s.nominalWidthX),g+=c.length>>1,c.length=0,u=!0,f+=g+7>>3;else if(N=="o21")c.length>2&&!u&&(d=c.shift()+s.nominalWidthX,u=!0),p+=c.pop(),v+=c.pop(),C&&e.U.P.closePath(l),e.U.P.moveTo(l,v,p),C=!0;else if(N=="o22")c.length>1&&!u&&(d=c.shift()+s.nominalWidthX,u=!0),v+=c.pop(),C&&e.U.P.closePath(l),e.U.P.moveTo(l,v,p),C=!0;else if(N=="o25"){for(;c.length>6;)v+=c.shift(),p+=c.shift(),e.U.P.lineTo(l,v,p);m=v+c.shift(),A=p+c.shift(),b=m+c.shift(),G=A+c.shift(),v=b+c.shift(),p=G+c.shift(),e.U.P.curveTo(l,m,A,b,G,v,p)}else if(N=="o26")for(c.length%2&&(v+=c.shift());c.length>0;)m=v,A=p+c.shift(),v=b=m+c.shift(),p=(G=A+c.shift())+c.shift(),e.U.P.curveTo(l,m,A,b,G,v,p);else if(N=="o27")for(c.length%2&&(p+=c.shift());c.length>0;)A=p,b=(m=v+c.shift())+c.shift(),G=A+c.shift(),v=b+c.shift(),p=G,e.U.P.curveTo(l,m,A,b,G,v,p);else if(N=="o10"||N=="o29"){var P=N=="o10"?s:a;if(c.length==0)console.debug("error: empty stack");else{var $=c.pop(),oe=P.Subrs[$+P.Bias];o.x=v,o.y=p,o.nStems=g,o.haveWidth=u,o.width=d,o.open=C,e.U._drawCFF(oe,o,a,s,l),v=o.x,p=o.y,g=o.nStems,u=o.haveWidth,d=o.width,C=o.open}}else if(N=="o30"||N=="o31"){var ie=c.length,de=(J=0,N=="o31");for(J+=ie-(X=-3&ie);J<X;)de?(A=p,b=(m=v+c.shift())+c.shift(),p=(G=A+c.shift())+c.shift(),X-J==5?(v=b+c.shift(),J++):v=b,de=!1):(m=v,A=p+c.shift(),b=m+c.shift(),G=A+c.shift(),v=b+c.shift(),X-J==5?(p=G+c.shift(),J++):p=G,de=!0),e.U.P.curveTo(l,m,A,b,G,v,p),J+=4}else{if((N+"").charAt(0)=="o")throw console.debug("Unknown operation: "+N,r),N;c.push(N)}}}o.x=v,o.y=p,o.nStems=g,o.haveWidth=u,o.width=d,o.open=C};var n=e,i={Typr:n};return t.Typr=n,t.default=i,Object.defineProperty(t,"__esModule",{value:!0}),t}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function Tge(){return function(t){var e=Uint8Array,n=Uint16Array,i=Uint32Array,r=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),o=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(N,X){for(var E=new n(31),Q=0;Q<31;++Q)E[Q]=X+=1<<N[Q-1];var k=new i(E[30]);for(Q=1;Q<30;++Q)for(var J=E[Q];J<E[Q+1];++J)k[J]=J-E[Q]<<5|Q;return[E,k]},l=s(r,2),c=l[0],g=l[1];c[28]=258,g[258]=28;for(var u=s(o,0)[0],d=new n(32768),C=0;C<32768;++C){var f=(43690&C)>>>1|(21845&C)<<1;f=(61680&(f=(52428&f)>>>2|(13107&f)<<2))>>>4|(3855&f)<<4,d[C]=((65280&f)>>>8|(255&f)<<8)>>>1}var v=function(N,X,E){for(var Q=N.length,k=0,J=new n(X);k<Q;++k)++J[N[k]-1];var F,L=new n(X);for(k=0;k<X;++k)L[k]=L[k-1]+J[k-1]<<1;{F=new n(1<<X);var z=15-X;for(k=0;k<Q;++k)if(N[k])for(var K=k<<4|N[k],O=X-N[k],j=L[N[k]-1]++<<O,P=j|(1<<O)-1;j<=P;++j)F[d[j]>>>z]=K}return F},p=new e(288);for(C=0;C<144;++C)p[C]=8;for(C=144;C<256;++C)p[C]=9;for(C=256;C<280;++C)p[C]=7;for(C=280;C<288;++C)p[C]=8;var m=new e(32);for(C=0;C<32;++C)m[C]=5;var A=v(p,9),b=v(m,5),G=function(N){for(var X=N[0],E=1;E<N.length;++E)N[E]>X&&(X=N[E]);return X},w=function(N,X,E){var Q=X/8|0;return(N[Q]|N[Q+1]<<8)>>(7&X)&E},S=function(N,X){var E=X/8|0;return(N[E]|N[E+1]<<8|N[E+2]<<16)>>(7&X)},Z=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],x=function(N,X,E){var Q=new Error(X||Z[N]);if(Q.code=N,Error.captureStackTrace&&Error.captureStackTrace(Q,x),!E)throw Q;return Q},R=function(N,X,E){var Q=N.length;if(!Q||E&&!E.l&&Q<5)return X||new e(0);var k=!X||E,J=!E||E.i;E||(E={}),X||(X=new e(3*Q));var F,L=function(je){var Ie=X.length;if(je>Ie){var Te=new e(Math.max(2*Ie,je));Te.set(X),X=Te}},z=E.f||0,K=E.p||0,O=E.b||0,j=E.l,P=E.d,$=E.m,oe=E.n,ie=8*Q;do{if(!j){E.f=z=w(N,K,1);var de=w(N,K+1,3);if(K+=3,!de){var Ve=N[(q=((F=K)/8|0)+(7&F&&1)+4)-4]|N[q-3]<<8,Se=q+Ve;if(Se>Q){J&&x(0);break}k&&L(O+Ve),X.set(N.subarray(q,Se),O),E.b=O+=Ve,E.p=K=8*Se;continue}if(de==1)j=A,P=b,$=9,oe=5;else if(de==2){var me=w(N,K,31)+257,T=w(N,K+10,15)+4,Ge=me+w(N,K+5,31)+1;K+=14;for(var ne=new e(Ge),he=new e(19),ae=0;ae<T;++ae)he[a[ae]]=w(N,K+3*ae,7);K+=3*T;var He=G(he),ve=(1<<He)-1,Me=v(he,He);for(ae=0;ae<Ge;){var q,Y=Me[w(N,K,ve)];if(K+=15&Y,(q=Y>>>4)<16)ne[ae++]=q;else{var Ce=0,se=0;for(q==16?(se=3+w(N,K,3),K+=2,Ce=ne[ae-1]):q==17?(se=3+w(N,K,7),K+=3):q==18&&(se=11+w(N,K,127),K+=7);se--;)ne[ae++]=Ce}}var fe=ne.subarray(0,me),Ze=ne.subarray(me);$=G(fe),oe=G(Ze),j=v(fe,$),P=v(Ze,oe)}else x(1);if(K>ie){J&&x(0);break}}k&&L(O+131072);for(var Oe=(1<<$)-1,Fe=(1<<oe)-1,Ee=K;;Ee=K){var Qe=(Ce=j[S(N,K)&Oe])>>>4;if((K+=15&Ce)>ie){J&&x(0);break}if(Ce||x(2),Qe<256)X[O++]=Qe;else{if(Qe==256){Ee=K,j=null;break}var Ye=Qe-254;if(Qe>264){var $e=r[ae=Qe-257];Ye=w(N,K,(1<<$e)-1)+c[ae],K+=$e}var st=P[S(N,K)&Fe],Ue=st>>>4;if(st||x(3),K+=15&st,Ze=u[Ue],Ue>3&&($e=o[Ue],Ze+=S(N,K)&(1<<$e)-1,K+=$e),K>ie){J&&x(0);break}k&&L(O+131072);for(var Ne=O+Ye;O<Ne;O+=4)X[O]=X[O-Ze],X[O+1]=X[O+1-Ze],X[O+2]=X[O+2-Ze],X[O+3]=X[O+3-Ze];O=Ne}}E.l=j,E.p=Ee,E.b=O,j&&(z=1,E.m=$,E.d=P,E.n=oe)}while(!z);return O==X.length?X:function(je,Ie,Te){(Te==null||Te>je.length)&&(Te=je.length);var ue=new(je instanceof n?n:je instanceof i?i:e)(Te-Ie);return ue.set(je.subarray(Ie,Te)),ue}(X,0,O)},W=new e(0),M=typeof TextDecoder<"u"&&new TextDecoder;try{M.decode(W,{stream:!0})}catch{}return t.convert_streams=function(N){var X=new DataView(N),E=0;function Q(){var me=X.getUint16(E);return E+=2,me}function k(){var me=X.getUint32(E);return E+=4,me}function J(me){Ve.setUint16(Se,me),Se+=2}function F(me){Ve.setUint32(Se,me),Se+=4}for(var L={signature:k(),flavor:k(),length:k(),numTables:Q(),reserved:Q(),totalSfntSize:k(),majorVersion:Q(),minorVersion:Q(),metaOffset:k(),metaLength:k(),metaOrigLength:k(),privOffset:k(),privLength:k()},z=0;Math.pow(2,z)<=L.numTables;)z++;z--;for(var K=16*Math.pow(2,z),O=16*L.numTables-K,j=12,P=[],$=0;$<L.numTables;$++)P.push({tag:k(),offset:k(),compLength:k(),origLength:k(),origChecksum:k()}),j+=16;var oe,ie=new Uint8Array(12+16*P.length+P.reduce(function(me,T){return me+T.origLength+4},0)),de=ie.buffer,Ve=new DataView(de),Se=0;return F(L.flavor),J(L.numTables),J(K),J(z),J(O),P.forEach(function(me){F(me.tag),F(me.origChecksum),F(j),F(me.origLength),me.outOffset=j,(j+=me.origLength)%4!=0&&(j+=4-j%4)}),P.forEach(function(me){var T,Ge=N.slice(me.offset,me.offset+me.compLength);if(me.compLength!=me.origLength){var ne=new Uint8Array(me.origLength);T=new Uint8Array(Ge,2),R(T,ne)}else ne=new Uint8Array(Ge);ie.set(ne,me.outOffset);var he=0;(j=me.outOffset+me.origLength)%4!=0&&(he=4-j%4),ie.set(new Uint8Array(he).buffer,me.outOffset+me.origLength),oe=j+he}),de.slice(0,oe)},Object.defineProperty(t,"__esModule",{value:!0}),t}({}).convert_streams}function _ge(t,e){const n={M:2,L:2,Q:4,C:6,Z:0},i={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},r=1,o=2,a=4,s=8,l=16,c=32;let g;function u(Z){if(!g){const x={R:o,L:r,D:a,C:l,U:c,T:s};g=new Map;for(let R in i){let W=0;i[R].split(",").forEach(M=>{let[N,X]=M.split("+");N=parseInt(N,36),X=X?parseInt(X,36):0,g.set(W+=N,x[R]);for(let E=X;E--;)g.set(++W,x[R])})}}return g.get(Z)||c}const d=1,C=2,f=3,v=4,p=[null,"isol","init","fina","medi"];function m(Z){const x=new Uint8Array(Z.length);let R=c,W=d,M=-1;for(let N=0;N<Z.length;N++){const X=Z.codePointAt(N);let E=u(X)|0,Q=d;E&s||(R&(r|a|l)?E&(o|a|l)?(Q=f,(W===d||W===f)&&x[M]++):E&(r|c)&&(W===C||W===v)&&x[M]--:R&(o|c)&&(W===C||W===v)&&x[M]--,W=x[N]=Q,R=E,M=N,X>65535&&N++)}return x}function A(Z,x){const R=[];for(let M=0;M<x.length;M++){const N=x.codePointAt(M);N>65535&&M++,R.push(t.U.codeToGlyph(Z,N))}const W=Z.GSUB;if(W){const{lookupList:M,featureList:N}=W;let X;const E=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,Q=[];N.forEach(k=>{if(E.test(k.tag))for(let J=0;J<k.tab.length;J++){if(Q[k.tab[J]])continue;Q[k.tab[J]]=!0;const F=M[k.tab[J]],L=/^(isol|init|fina|medi)$/.test(k.tag);L&&!X&&(X=m(x));for(let z=0;z<R.length;z++)(!X||!L||p[X[z]]===k.tag)&&t.U._applySubs(R,z,F,M)}})}return R}function b(Z,x){const R=new Int16Array(x.length*3);let W=0;for(;W<x.length;W++){const E=x[W];if(E===-1)continue;R[W*3+2]=Z.hmtx.aWidth[E];const Q=Z.GPOS;if(Q){const k=Q.lookupList;for(let J=0;J<k.length;J++){const F=k[J];for(let L=0;L<F.tabs.length;L++){const z=F.tabs[L];if(F.ltype===1){if(t._lctf.coverageIndex(z.coverage,E)!==-1&&z.pos){X(z.pos,W);break}}else if(F.ltype===2){let K=null,O=M();if(O!==-1){const j=t._lctf.coverageIndex(z.coverage,x[O]);if(j!==-1){if(z.fmt===1){const P=z.pairsets[j];for(let $=0;$<P.length;$++)P[$].gid2===E&&(K=P[$])}else if(z.fmt===2){const P=t.U._getGlyphClass(x[O],z.classDef1),$=t.U._getGlyphClass(E,z.classDef2);K=z.matrix[P][$]}if(K){K.val1&&X(K.val1,O),K.val2&&X(K.val2,W);break}}}}else if(F.ltype===4){const K=t._lctf.coverageIndex(z.markCoverage,E);if(K!==-1){const O=M(N),j=O===-1?-1:t._lctf.coverageIndex(z.baseCoverage,x[O]);if(j!==-1){const P=z.markArray[K],$=z.baseArray[j][P.markClass];R[W*3]=$.x-P.x+R[O*3]-R[O*3+2],R[W*3+1]=$.y-P.y+R[O*3+1];break}}}else if(F.ltype===6){const K=t._lctf.coverageIndex(z.mark1Coverage,E);if(K!==-1){const O=M();if(O!==-1){const j=x[O];if(G(Z,j)===3){const P=t._lctf.coverageIndex(z.mark2Coverage,j);if(P!==-1){const $=z.mark1Array[K],oe=z.mark2Array[P][$.markClass];R[W*3]=oe.x-$.x+R[O*3]-R[O*3+2],R[W*3+1]=oe.y-$.y+R[O*3+1];break}}}}}}}}else if(Z.kern&&!Z.cff){const k=M();if(k!==-1){const J=Z.kern.glyph1.indexOf(x[k]);if(J!==-1){const F=Z.kern.rval[J].glyph2.indexOf(E);F!==-1&&(R[k*3+2]+=Z.kern.rval[J].vals[F])}}}}return R;function M(E){for(let Q=W-1;Q>=0;Q--)if(x[Q]!==-1&&(!E||E(x[Q])))return Q;return-1}function N(E){return G(Z,E)===1}function X(E,Q){for(let k=0;k<3;k++)R[Q*3+k]+=E[k]||0}}function G(Z,x){const R=Z.GDEF&&Z.GDEF.glyphClassDef;return R?t.U._getGlyphClass(x,R):0}function w(...Z){for(let x=0;x<Z.length;x++)if(typeof Z[x]=="number")return Z[x]}function S(Z){const x=Object.create(null),R=Z["OS/2"],W=Z.hhea,M=Z.head.unitsPerEm,N=w(R&&R.sTypoAscender,W&&W.ascender,M),X={unitsPerEm:M,ascender:N,descender:w(R&&R.sTypoDescender,W&&W.descender,0),capHeight:w(R&&R.sCapHeight,N),xHeight:w(R&&R.sxHeight,N),lineGap:w(R&&R.sTypoLineGap,W&&W.lineGap),supportsCodePoint(E){return t.U.codeToGlyph(Z,E)>0},forEachGlyph(E,Q,k,J){let F=0;const L=1/X.unitsPerEm*Q,z=A(Z,E);let K=0;const O=b(Z,z);return z.forEach((j,P)=>{if(j!==-1){let $=x[j];if(!$){const{cmds:oe,crds:ie}=t.U.glyphToPath(Z,j);let de="",Ve=0;for(let ne=0,he=oe.length;ne<he;ne++){const ae=n[oe[ne]];de+=oe[ne];for(let He=1;He<=ae;He++)de+=(He>1?",":"")+ie[Ve++]}let Se,me,T,Ge;if(ie.length){Se=me=1/0,T=Ge=-1/0;for(let ne=0,he=ie.length;ne<he;ne+=2){let ae=ie[ne],He=ie[ne+1];ae<Se&&(Se=ae),He<me&&(me=He),ae>T&&(T=ae),He>Ge&&(Ge=He)}}else Se=T=me=Ge=0;$=x[j]={index:j,advanceWidth:Z.hmtx.aWidth[j],xMin:Se,yMin:me,xMax:T,yMax:Ge,path:de}}J.call(null,$,F+O[P*3]*L,O[P*3+1]*L,K),F+=O[P*3+2]*L,k&&(F+=k*Q)}K+=E.codePointAt(K)>65535?2:1}),F}};return X}return function(x){const R=new Uint8Array(x,0,4),W=t._bin.readASCII(R,0,4);if(W==="wOFF")x=e(x);else if(W==="wOF2")throw new Error("woff2 fonts not supported");return S(t.parse(x)[0])}}const kge=iI({name:"Typr Font Parser",dependencies:[Lge,Tge,_ge],init(t,e,n){const i=t(),r=e();return n(i,r)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function Pge(){return function(t){var e=function(){this.buckets=new Map};e.prototype.add=function(b){var G=b>>5;this.buckets.set(G,(this.buckets.get(G)||0)|1<<(31&b))},e.prototype.has=function(b){var G=this.buckets.get(b>>5);return G!==void 0&&(G&1<<(31&b))!=0},e.prototype.serialize=function(){var b=[];return this.buckets.forEach(function(G,w){b.push((+w).toString(36)+":"+G.toString(36))}),b.join(",")},e.prototype.deserialize=function(b){var G=this;this.buckets.clear(),b.split(",").forEach(function(w){var S=w.split(":");G.buckets.set(parseInt(S[0],36),parseInt(S[1],36))})};var n=Math.pow(2,8),i=n-1,r=~i;function o(b){var G=function(S){return S&r}(b).toString(16),w=function(S){return(S&r)+n-1}(b).toString(16);return"codepoint-index/plane"+(b>>16)+"/"+G+"-"+w+".json"}function a(b,G){var w=b&i,S=G.codePointAt(w/6|0);return((S=(S||48)-48)&1<<w%6)!=0}function s(b,G){var w;(w=b,w.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(S){return S.split("-").map(function(Z){return parseInt(Z.trim(),16)})})).forEach(function(S){var Z=S[0],x=S[1];x===void 0&&(x=Z),G(Z,x)})}function l(b,G){s(b,function(w,S){for(var Z=w;Z<=S;Z++)G(Z)})}var c={},g={},u=new WeakMap,d="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function C(b){var G=u.get(b);return G||(G=new e,l(b.ranges,function(w){return G.add(w)}),u.set(b,G)),G}var f,v=new Map;function p(b,G,w){return b[G]?G:b[w]?w:function(S){for(var Z in S)return Z}(b)}function m(b,G){var w=G;if(!b.includes(w)){w=1/0;for(var S=0;S<b.length;S++)Math.abs(b[S]-G)<Math.abs(w-G)&&(w=b[S])}return w}function A(b){return f||(f=new Set,l("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(G){f.add(G)})),f.has(b)}return t.CodePointSet=e,t.clearCache=function(){c={},g={}},t.getFontsForString=function(b,G){G===void 0&&(G={});var w,S=G.lang;S===void 0&&(S=new RegExp("\\p{Script=Hangul}","u").test(w=b)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(w)?"ja":"en");var Z=G.category;Z===void 0&&(Z="sans-serif");var x=G.style;x===void 0&&(x="normal");var R=G.weight;R===void 0&&(R=400);var W=(G.dataUrl||d).replace(/\/$/g,""),M=new Map,N=new Uint8Array(b.length),X={},E={},Q=new Array(b.length),k=new Map,J=!1;function F(K){var O=v.get(K);return O||(O=fetch(W+"/"+K).then(function(j){if(!j.ok)throw new Error(j.statusText);return j.json().then(function(P){if(!Array.isArray(P)||P[0]!==1)throw new Error("Incorrect schema version; need 1, got "+P[0]);return P[1]})}).catch(function(j){if(W!==d)return J||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+W+'", trying default CDN. '+j.message),J=!0),W=d,v.delete(K),F(K);throw j}),v.set(K,O)),O}for(var L=function(K){var O=b.codePointAt(K),j=o(O);Q[K]=j,c[j]||k.has(j)||k.set(j,F(j).then(function(P){c[j]=P})),O>65535&&(K++,z=K)},z=0;z<b.length;z++)L(z);return Promise.all(k.values()).then(function(){k.clear();for(var K=function(j){var P=b.codePointAt(j),$=null,oe=c[Q[j]],ie=void 0;for(var de in oe){var Ve=E[de];if(Ve===void 0&&(Ve=E[de]=new RegExp(de).test(S||"en")),Ve){for(var Se in ie=de,oe[de])if(a(P,oe[de][Se])){$=Se;break}break}}if(!$){e:for(var me in oe)if(me!==ie){for(var T in oe[me])if(a(P,oe[me][T])){$=T;break e}}}$||(console.debug("No font coverage for U+"+P.toString(16)),$="latin"),Q[j]=$,g[$]||k.has($)||k.set($,F("font-meta/"+$+".json").then(function(Ge){g[$]=Ge})),P>65535&&(j++,O=j)},O=0;O<b.length;O++)K(O);return Promise.all(k.values())}).then(function(){for(var K,O=null,j=0;j<b.length;j++){var P=b.codePointAt(j);if(O&&(A(P)||C(O).has(P)))N[j]=N[j-1];else{O=g[Q[j]];var $=X[O.id];if(!$){var oe=O.typeforms,ie=p(oe,Z,"sans-serif"),de=p(oe[ie],x,"normal"),Ve=m((K=oe[ie])===null||K===void 0?void 0:K[de],R);$=X[O.id]=W+"/font-files/"+O.id+"/"+ie+"."+de+"."+Ve+".woff"}var Se=M.get($);Se==null&&(Se=M.size,M.set($,Se)),N[j]=Se}P>65535&&(j++,N[j]=N[j-1])}return{fontUrls:Array.from(M.keys()),chars:N}})},Object.defineProperty(t,"__esModule",{value:!0}),t}({})}function Uge(t,e){const n=Object.create(null),i=Object.create(null);function r(a,s){const l=c=>{console.error(`Failure loading font ${a}`,c)};try{const c=new XMLHttpRequest;c.open("get",a,!0),c.responseType="arraybuffer",c.onload=function(){if(c.status>=400)l(new Error(c.statusText));else if(c.status>0)try{const g=t(c.response);g.src=a,s(g)}catch(g){l(g)}},c.onerror=l,c.send()}catch(c){l(c)}}function o(a,s){let l=n[a];l?s(l):i[a]?i[a].push(s):(i[a]=[s],r(a,c=>{c.src=a,n[a]=c,i[a].forEach(g=>g(c)),delete i[a]}))}return function(a,s,{lang:l,fonts:c=[],style:g="normal",weight:u="normal",unicodeFontsURL:d}={}){const C=new Uint8Array(a.length),f=[];a.length||A();const v=new Map,p=[];if(g!=="italic"&&(g="normal"),typeof u!="number"&&(u=u==="bold"?700:400),c&&!Array.isArray(c)&&(c=[c]),c=c.slice().filter(G=>!G.lang||G.lang.test(l)).reverse(),c.length){let Z=0;(function x(R=0){for(let W=R,M=a.length;W<M;W++){const N=a.codePointAt(W);if(Z===1&&f[C[W-1]].supportsCodePoint(N)||W>0&&/\s/.test(a[W]))C[W]=C[W-1],Z===2&&(p[p.length-1][1]=W);else for(let X=C[W],E=c.length;X<=E;X++)if(X===E){const Q=Z===2?p[p.length-1]:p[p.length]=[W,W];Q[1]=W,Z=2}else{C[W]=X;const{src:Q,unicodeRange:k}=c[X];if(!k||b(N,k)){const J=n[Q];if(!J){o(Q,()=>{x(W)});return}if(J.supportsCodePoint(N)){let F=v.get(J);typeof F!="number"&&(F=f.length,f.push(J),v.set(J,F)),C[W]=F,Z=1;break}}}N>65535&&W+1<M&&(C[W+1]=C[W],W++,Z===2&&(p[p.length-1][1]=W))}m()})()}else p.push([0,a.length-1]),m();function m(){if(p.length){const G=p.map(w=>a.substring(w[0],w[1]+1)).join(`
`);e.getFontsForString(G,{lang:l||void 0,style:g,weight:u,dataUrl:d}).then(({fontUrls:w,chars:S})=>{const Z=f.length;let x=0;p.forEach(W=>{for(let M=0,N=W[1]-W[0];M<=N;M++)C[W[0]+M]=S[x++]+Z;x++});let R=0;w.forEach((W,M)=>{o(W,N=>{f[M+Z]=N,++R===w.length&&A()})})})}else A()}function A(){s({chars:C,fonts:f})}function b(G,w){for(let S=0;S<w.length;S++){const[Z,x=Z]=w[S];if(Z<=G&&G<=x)return!0}return!1}}}const Dge=iI({name:"FontResolver",dependencies:[Uge,kge,Pge],init(t,e,n){return t(e,n())}});function Oge(t,e){const i=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,r="[^\\S\\u00A0]",o=new RegExp(`${r}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function a({text:f,lang:v,fonts:p,style:m,weight:A,preResolvedFonts:b,unicodeFontsURL:G},w){const S=({chars:Z,fonts:x})=>{let R,W;const M=[];for(let N=0;N<Z.length;N++)Z[N]!==W?(W=Z[N],M.push(R={start:N,end:N,fontObj:x[Z[N]]})):R.end=N;w(M)};b?S(b):t(f,S,{lang:v,fonts:p,style:m,weight:A,unicodeFontsURL:G})}function s({text:f="",font:v,lang:p,sdfGlyphSize:m=64,fontSize:A=400,fontWeight:b=1,fontStyle:G="normal",letterSpacing:w=0,lineHeight:S="normal",maxWidth:Z=1/0,direction:x,textAlign:R="left",textIndent:W=0,whiteSpace:M="normal",overflowWrap:N="normal",anchorX:X=0,anchorY:E=0,metricsOnly:Q=!1,unicodeFontsURL:k,preResolvedFonts:J=null,includeCaretPositions:F=!1,chunkedBoundsSize:L=8192,colorRanges:z=null},K){const O=u(),j={fontLoad:0,typesetting:0};f.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),f=f.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),A=+A,w=+w,Z=+Z,S=S||"normal",W=+W,a({text:f,lang:p,style:G,weight:b,fonts:typeof v=="string"?[{src:v}]:v,unicodeFontsURL:k,preResolvedFonts:J},P=>{j.fontLoad=u()-O;const $=isFinite(Z);let oe=null,ie=null,de=null,Ve=null,Se=null,me=null,T=null,Ge=null,ne=0,he=0,ae=M!=="nowrap";const He=new Map,ve=u();let Me=W,q=0,Y=new d;const Ce=[Y];P.forEach(Fe=>{const{fontObj:Ee}=Fe,{ascender:Qe,descender:Ye,unitsPerEm:$e,lineGap:st,capHeight:Ue,xHeight:Ne}=Ee;let je=He.get(Ee);if(!je){const be=A/$e,Le=S==="normal"?(Qe-Ye+st)*be:S*A,ct=(Le-(Qe-Ye)*be)/2,dt=Math.min(Le,(Qe-Ye)*be),It=(Qe+Ye)/2*be+dt/2;je={index:He.size,src:Ee.src,fontObj:Ee,fontSizeMult:be,unitsPerEm:$e,ascender:Qe*be,descender:Ye*be,capHeight:Ue*be,xHeight:Ne*be,lineHeight:Le,baseline:-ct-Qe*be,caretTop:It,caretBottom:It-dt},He.set(Ee,je)}const{fontSizeMult:Ie}=je,Te=f.slice(Fe.start,Fe.end+1);let ue,Pe;Ee.forEachGlyph(Te,A,w,(be,Le,ct,dt)=>{Le+=q,dt+=Fe.start,ue=Le,Pe=be;const It=f.charAt(dt),Vt=be.advanceWidth*Ie,vt=Y.count;let et;if("isEmpty"in be||(be.isWhitespace=!!It&&new RegExp(r).test(It),be.canBreakAfter=!!It&&o.test(It),be.isEmpty=be.xMin===be.xMax||be.yMin===be.yMax||i.test(It)),!be.isWhitespace&&!be.isEmpty&&he++,ae&&$&&!be.isWhitespace&&Le+Vt+Me>Z&&vt){if(Y.glyphAt(vt-1).glyphObj.canBreakAfter)et=new d,Me=-Le;else for(let ut=vt;ut--;)if(ut===0&&N==="break-word"){et=new d,Me=-Le;break}else if(Y.glyphAt(ut).glyphObj.canBreakAfter){et=Y.splitAt(ut+1);const Tt=et.glyphAt(0).x;Me-=Tt;for(let Ft=et.count;Ft--;)et.glyphAt(Ft).x-=Tt;break}et&&(Y.isSoftWrapped=!0,Y=et,Ce.push(Y),ne=Z)}let rt=Y.glyphAt(Y.count);rt.glyphObj=be,rt.x=Le+Me,rt.y=ct,rt.width=Vt,rt.charIndex=dt,rt.fontData=je,It===`
`&&(Y=new d,Ce.push(Y),Me=-(Le+Vt+w*A)+W)}),q=ue+Pe.advanceWidth*Ie+w*A});let se=0;Ce.forEach(Fe=>{let Ee=!0;for(let Qe=Fe.count;Qe--;){const Ye=Fe.glyphAt(Qe);Ee&&!Ye.glyphObj.isWhitespace&&(Fe.width=Ye.x+Ye.width,Fe.width>ne&&(ne=Fe.width),Ee=!1);let{lineHeight:$e,capHeight:st,xHeight:Ue,baseline:Ne}=Ye.fontData;$e>Fe.lineHeight&&(Fe.lineHeight=$e);const je=Ne-Fe.baseline;je<0&&(Fe.baseline+=je,Fe.cap+=je,Fe.ex+=je),Fe.cap=Math.max(Fe.cap,Fe.baseline+st),Fe.ex=Math.max(Fe.ex,Fe.baseline+Ue)}Fe.baseline-=se,Fe.cap-=se,Fe.ex-=se,se+=Fe.lineHeight});let fe=0,Ze=0;if(X&&(typeof X=="number"?fe=-X:typeof X=="string"&&(fe=-ne*(X==="left"?0:X==="center"?.5:X==="right"?1:c(X)))),E&&(typeof E=="number"?Ze=-E:typeof E=="string"&&(Ze=E==="top"?0:E==="top-baseline"?-Ce[0].baseline:E==="top-cap"?-Ce[0].cap:E==="top-ex"?-Ce[0].ex:E==="middle"?se/2:E==="bottom"?se:E==="bottom-baseline"?-Ce[Ce.length-1].baseline:c(E)*se)),!Q){const Fe=e.getEmbeddingLevels(f,x);oe=new Uint16Array(he),ie=new Uint8Array(he),de=new Float32Array(he*2),Ve={},T=[1/0,1/0,-1/0,-1/0],Ge=[],F&&(me=new Float32Array(f.length*4)),z&&(Se=new Uint8Array(he*3));let Ee=0,Qe=-1,Ye=-1,$e,st;if(Ce.forEach((Ue,Ne)=>{let{count:je,width:Ie}=Ue;if(je>0){let Te=0;for(let dt=je;dt--&&Ue.glyphAt(dt).glyphObj.isWhitespace;)Te++;let ue=0,Pe=0;if(R==="center")ue=(ne-Ie)/2;else if(R==="right")ue=ne-Ie;else if(R==="justify"&&Ue.isSoftWrapped){let dt=0;for(let It=je-Te;It--;)Ue.glyphAt(It).glyphObj.isWhitespace&&dt++;Pe=(ne-Ie)/dt}if(Pe||ue){let dt=0;for(let It=0;It<je;It++){let Vt=Ue.glyphAt(It);const vt=Vt.glyphObj;Vt.x+=ue+dt,Pe!==0&&vt.isWhitespace&&It<je-Te&&(dt+=Pe,Vt.width+=Pe)}}const be=e.getReorderSegments(f,Fe,Ue.glyphAt(0).charIndex,Ue.glyphAt(Ue.count-1).charIndex);for(let dt=0;dt<be.length;dt++){const[It,Vt]=be[dt];let vt=1/0,et=-1/0;for(let rt=0;rt<je;rt++)if(Ue.glyphAt(rt).charIndex>=It){let ut=rt,Tt=rt;for(;Tt<je;Tt++){let Ft=Ue.glyphAt(Tt);if(Ft.charIndex>Vt)break;Tt<je-Te&&(vt=Math.min(vt,Ft.x),et=Math.max(et,Ft.x+Ft.width))}for(let Ft=ut;Ft<Tt;Ft++){const ft=Ue.glyphAt(Ft);ft.x=et-(ft.x+ft.width-vt)}break}}let Le;const ct=dt=>Le=dt;for(let dt=0;dt<je;dt++){const It=Ue.glyphAt(dt);Le=It.glyphObj;const Vt=Le.index,vt=Fe.levels[It.charIndex]&1;if(vt){const et=e.getMirroredCharacter(f[It.charIndex]);et&&It.fontData.fontObj.forEachGlyph(et,0,0,ct)}if(F){const{charIndex:et,fontData:rt}=It,ut=It.x+fe,Tt=It.x+It.width+fe;me[et*4]=vt?Tt:ut,me[et*4+1]=vt?ut:Tt,me[et*4+2]=Ue.baseline+rt.caretBottom+Ze,me[et*4+3]=Ue.baseline+rt.caretTop+Ze;const Ft=et-Qe;Ft>1&&g(me,Qe,Ft),Qe=et}if(z){const{charIndex:et}=It;for(;et>Ye;)Ye++,z.hasOwnProperty(Ye)&&(st=z[Ye])}if(!Le.isWhitespace&&!Le.isEmpty){const et=Ee++,{fontSizeMult:rt,src:ut,index:Tt}=It.fontData,Ft=Ve[ut]||(Ve[ut]={});Ft[Vt]||(Ft[Vt]={path:Le.path,pathBounds:[Le.xMin,Le.yMin,Le.xMax,Le.yMax]});const ft=It.x+fe,At=It.y+Ue.baseline+Ze;de[et*2]=ft,de[et*2+1]=At;const Gt=ft+Le.xMin*rt,Bt=At+Le.yMin*rt,Yt=ft+Le.xMax*rt,St=At+Le.yMax*rt;Gt<T[0]&&(T[0]=Gt),Bt<T[1]&&(T[1]=Bt),Yt>T[2]&&(T[2]=Yt),St>T[3]&&(T[3]=St),et%L===0&&($e={start:et,end:et,rect:[1/0,1/0,-1/0,-1/0]},Ge.push($e)),$e.end++;const sn=$e.rect;if(Gt<sn[0]&&(sn[0]=Gt),Bt<sn[1]&&(sn[1]=Bt),Yt>sn[2]&&(sn[2]=Yt),St>sn[3]&&(sn[3]=St),oe[et]=Vt,ie[et]=Tt,z){const Ot=et*3;Se[Ot]=st>>16&255,Se[Ot+1]=st>>8&255,Se[Ot+2]=st&255}}}}}),me){const Ue=f.length-Qe;Ue>1&&g(me,Qe,Ue)}}const Oe=[];He.forEach(({index:Fe,src:Ee,unitsPerEm:Qe,ascender:Ye,descender:$e,lineHeight:st,capHeight:Ue,xHeight:Ne})=>{Oe[Fe]={src:Ee,unitsPerEm:Qe,ascender:Ye,descender:$e,lineHeight:st,capHeight:Ue,xHeight:Ne}}),j.typesetting=u()-ve,K({glyphIds:oe,glyphFontIndices:ie,glyphPositions:de,glyphData:Ve,fontData:Oe,caretPositions:me,glyphColors:Se,chunkedBounds:Ge,fontSize:A,topBaseline:Ze+Ce[0].baseline,blockBounds:[fe,Ze-se,fe+ne,Ze],visibleBounds:T,timings:j})})}function l(f,v){s({...f,metricsOnly:!0},p=>{const[m,A,b,G]=p.blockBounds;v({width:b-m,height:G-A})})}function c(f){let v=f.match(/^([\d.]+)%$/),p=v?parseFloat(v[1]):NaN;return isNaN(p)?0:p/100}function g(f,v,p){const m=f[v*4],A=f[v*4+1],b=f[v*4+2],G=f[v*4+3],w=(A-m)/p;for(let S=0;S<p;S++){const Z=(v+S)*4;f[Z]=m+w*S,f[Z+1]=m+w*(S+1),f[Z+2]=b,f[Z+3]=G}}function u(){return(self.performance||Date).now()}function d(){this.data=[]}const C=["glyphObj","x","y","width","charIndex","fontData"];return d.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/C.length)},glyphAt(f){let v=d.flyweight;return v.data=this.data,v.index=f,v},splitAt(f){let v=new d;return v.data=this.data.splice(f*C.length),v}},d.flyweight=C.reduce((f,v,p,m)=>(Object.defineProperty(f,v,{get(){return this.data[this.index*C.length+p]},set(A){this.data[this.index*C.length+p]=A}}),f),{data:null,index:0}),{typeset:s,measure:l}}const Gg=()=>(self.performance||Date).now(),lb=JK();let r3;function Jge(t,e,n,i,r,o,a,s,l,c,g=!0){return g?jge(t,e,n,i,r,o,a,s,l,c).then(null,u=>(r3||(console.warn("WebGL SDF generation failed, falling back to JS",u),r3=!0),a3(t,e,n,i,r,o,a,s,l,c))):a3(t,e,n,i,r,o,a,s,l,c)}const fp=[],Qge=5;let PS=0;function jK(){const t=Gg();for(;fp.length&&Gg()-t<Qge;)fp.shift()();PS=fp.length?setTimeout(jK,0):0}const jge=(...t)=>new Promise((e,n)=>{fp.push(()=>{const i=Gg();try{lb.webgl.generateIntoCanvas(...t),e({timing:Gg()-i})}catch(r){n(r)}}),PS||(PS=setTimeout(jK,0))}),$ge=4,qge=2e3,o3={};let eue=0;function a3(t,e,n,i,r,o,a,s,l,c){const g="TroikaTextSDFGenerator_JS_"+eue++%$ge;let u=o3[g];return u||(u=o3[g]={workerModule:iI({name:g,workerId:g,dependencies:[JK,Gg],init(d,C){const f=d().javascript.generate;return function(...v){const p=C();return{textureData:f(...v),timing:C()-p}}},getTransferables(d){return[d.textureData.buffer]}}),requests:0,idleTimer:null}),u.requests++,clearTimeout(u.idleTimer),u.workerModule(t,e,n,i,r,o).then(({textureData:d,timing:C})=>{const f=Gg(),v=new Uint8Array(d.length*4);for(let p=0;p<d.length;p++)v[p*4+c]=d[p];return lb.webglUtils.renderImageData(a,v,s,l,t,e,1<<3-c),C+=Gg()-f,--u.requests===0&&(u.idleTimer=setTimeout(()=>{Vge(g)},qge)),{timing:C}})}function tue(t){t._warm||(lb.webgl.isSupported(t),t._warm=!0)}const nue=lb.webglUtils.resizeWebGLCanvasWithoutClearing,Tu={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048,useWorker:!0},iue=new kt;function Yu(){return(self.performance||Date).now()}const s3=Object.create(null);function $K(t,e){t=aue({},t);const n=Yu(),{defaultFontURL:i}=Tu,r=[];if(i&&r.push({label:"default",src:l3(i)}),t.font&&r.push({label:"user",src:l3(t.font)}),t.font=r,t.text=""+t.text,t.sdfGlyphSize=t.sdfGlyphSize||Tu.sdfGlyphSize,t.unicodeFontsURL=t.unicodeFontsURL||Tu.unicodeFontsURL,t.colorRanges!=null){let C={};for(let f in t.colorRanges)if(t.colorRanges.hasOwnProperty(f)){let v=t.colorRanges[f];typeof v!="number"&&(v=iue.set(v).getHex()),C[f]=v}t.colorRanges=C}Object.freeze(t);const{textureWidth:o,sdfExponent:a}=Tu,{sdfGlyphSize:s}=t,l=o/s*4;let c=s3[s];if(!c){const C=document.createElement("canvas");C.width=o,C.height=s*256/l,c=s3[s]={glyphCount:0,sdfGlyphSize:s,sdfCanvas:C,sdfTexture:new Tn(C,void 0,void 0,void 0,Kn,Kn),contextLost:!1,glyphsByFont:new Map},c.sdfTexture.generateMipmaps=!1,rue(c)}const{sdfTexture:g,sdfCanvas:u}=c;tL(t).then(C=>{const{glyphIds:f,glyphFontIndices:v,fontData:p,glyphPositions:m,fontSize:A,timings:b}=C,G=[],w=new Float32Array(f.length*4);let S=0,Z=0;const x=Yu(),R=p.map(E=>{let Q=c.glyphsByFont.get(E.src);return Q||c.glyphsByFont.set(E.src,Q=new Map),Q});f.forEach((E,Q)=>{const k=v[Q],{src:J,unitsPerEm:F}=p[k];let L=R[k].get(E);if(!L){const{path:P,pathBounds:$}=C.glyphData[J][E],oe=Math.max($[2]-$[0],$[3]-$[1])/s*(Tu.sdfMargin*s+.5),ie=c.glyphCount++,de=[$[0]-oe,$[1]-oe,$[2]+oe,$[3]+oe];R[k].set(E,L={path:P,atlasIndex:ie,sdfViewBox:de}),G.push(L)}const{sdfViewBox:z}=L,K=m[Z++],O=m[Z++],j=A/F;w[S++]=K+z[0]*j,w[S++]=O+z[1]*j,w[S++]=K+z[2]*j,w[S++]=O+z[3]*j,f[Q]=L.atlasIndex}),b.quads=(b.quads||0)+(Yu()-x);const W=Yu();b.sdf={};const M=u.height,N=Math.ceil(c.glyphCount/l),X=Math.pow(2,Math.ceil(Math.log2(N*s)));X>M&&(console.info(`Increasing SDF texture size ${M}->${X}`),nue(u,o,X),g.dispose()),Promise.all(G.map(E=>qK(E,c,t.gpuAccelerateSDF).then(({timing:Q})=>{b.sdf[E.atlasIndex]=Q}))).then(()=>{G.length&&!c.contextLost&&(eL(c),g.needsUpdate=!0),b.sdfTotal=Yu()-W,b.total=Yu()-n,e(Object.freeze({parameters:t,sdfTexture:g,sdfGlyphSize:s,sdfExponent:a,glyphBounds:w,glyphAtlasIndices:f,glyphColors:C.glyphColors,caretPositions:C.caretPositions,chunkedBounds:C.chunkedBounds,ascender:C.ascender,descender:C.descender,lineHeight:C.lineHeight,capHeight:C.capHeight,xHeight:C.xHeight,topBaseline:C.topBaseline,blockBounds:C.blockBounds,visibleBounds:C.visibleBounds,timings:C.timings}))})}),Promise.resolve().then(()=>{c.contextLost||tue(u)})}function qK({path:t,atlasIndex:e,sdfViewBox:n},{sdfGlyphSize:i,sdfCanvas:r,contextLost:o},a){if(o)return Promise.resolve({timing:-1});const{textureWidth:s,sdfExponent:l}=Tu,c=Math.max(n[2]-n[0],n[3]-n[1]),g=Math.floor(e/4),u=g%(s/i)*i,d=Math.floor(g/(s/i))*i,C=e%4;return Jge(i,i,t,n,c,l,r,u,d,C,a)}function rue(t){const e=t.sdfCanvas;e.addEventListener("webglcontextlost",n=>{console.log("Context Lost",n),n.preventDefault(),t.contextLost=!0}),e.addEventListener("webglcontextrestored",n=>{console.log("Context Restored",n),t.contextLost=!1;const i=[];t.glyphsByFont.forEach(r=>{r.forEach(o=>{i.push(qK(o,t,!0))})}),Promise.all(i).then(()=>{eL(t),t.sdfTexture.needsUpdate=!0})})}function oue({font:t,characters:e,sdfGlyphSize:n},i){let r=Array.isArray(e)?e.join(`
`):""+e;$K({font:t,sdfGlyphSize:n,text:r},i)}function aue(t,e){for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}let FA;function l3(t){return FA||(FA=typeof document>"u"?{}:document.createElement("a")),FA.href=t,FA.href}function eL(t){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:n}=t,{width:i,height:r}=e,o=t.sdfCanvas.getContext("webgl");let a=n.image.data;(!a||a.length!==i*r*4)&&(a=new Uint8Array(i*r*4),n.image={width:i,height:r,data:a},n.flipY=!1,n.isDataTexture=!0),o.readPixels(0,0,i,r,o.RGBA,o.UNSIGNED_BYTE,a)}}const sue=iI({name:"Typesetter",dependencies:[Oge,Dge,Nge],init(t,e,n){return t(e,n())}}),tL=iI({name:"Typesetter",dependencies:[sue],init(t){return function(e){return new Promise(n=>{t.typeset(e,n)})}},getTransferables(t){const e=[];for(let n in t)t[n]&&t[n].buffer&&e.push(t[n].buffer);return e}});tL.onMainThread;const c3={};function lue(t){let e=c3[t];return e||(e=c3[t]=new qa(1,1,t,t).translate(.5,.5,0)),e}const cue="aTroikaGlyphBounds",g3="aTroikaGlyphIndex",gue="aTroikaGlyphColor";class uue extends y1{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new hr,this.boundingBox=new Cr}computeBoundingSphere(){}computeBoundingBox(){}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let n=lue(e);["position","normal","uv"].forEach(i=>{this.attributes[i]=n.attributes[i].clone()}),this.setIndex(n.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,n,i,r,o){this.updateAttributeData(cue,e,4),this.updateAttributeData(g3,n,1),this.updateAttributeData(gue,o,3),this._blockBounds=i,this._chunkedBounds=r,this.instanceCount=n.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:n,boundingBox:i}=this;if(n){const{PI:r,floor:o,min:a,max:s,sin:l,cos:c}=Math,g=r/2,u=r*2,d=Math.abs(n),C=e[0]/d,f=e[2]/d,v=o((C+g)/u)!==o((f+g)/u)?-d:a(l(C)*d,l(f)*d),p=o((C-g)/u)!==o((f-g)/u)?d:s(l(C)*d,l(f)*d),m=o((C+r)/u)!==o((f+r)/u)?d*2:s(d-c(C)*d,d-c(f)*d);i.min.set(v,e[1],n<0?-m:0),i.max.set(p,e[3],n<0?0:m)}else i.min.set(e[0],e[1],0),i.max.set(e[2],e[3],0);i.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let n=this.getAttribute(g3).count,i=this._chunkedBounds;if(i)for(let r=i.length;r--;){n=i[r].end;let o=i[r].rect;if(o[1]<e.w&&o[3]>e.y&&o[0]<e.z&&o[2]>e.x)break}this.instanceCount=n}updateAttributeData(e,n,i){const r=this.getAttribute(e);n?r&&r.array.length===n.length?(r.array.set(n),r.needsUpdate=!0):(this.setAttribute(e,new Hg(n,i)),delete this._maxInstanceCount,this.dispose()):r&&this.deleteAttribute(e)}}const due=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,Iue=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,Cue=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,hue=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function fue(t){const e=kS(t,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new gt},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new zn(0,0,0,0)},uTroikaClipRect:{value:new zn(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new gt},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new kt},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new mn},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:due,vertexTransform:Iue,fragmentDefs:Cue,fragmentColorTransform:hue,customRewriter({vertexShader:n,fragmentShader:i}){let r=/\buniform\s+vec3\s+diffuse\b/;return r.test(i)&&(i=i.replace(r,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),r.test(n)||(n=n.replace(QK,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:n,fragmentShader:i}}});return e.transparent=!0,e.forceSinglePass=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const H1=new Rs({color:16777215,side:da,transparent:!0}),u3=8421504,d3=new ln,HA=new ge,uB=new ge,eC=[],mue=new ge,dB="+x+y";function I3(t){return Array.isArray(t)?t[0]:t}let nL=()=>{const t=new ti(new qa(1,1),H1);return nL=()=>t,t},iL=()=>{const t=new ti(new qa(1,1,32,1),H1);return iL=()=>t,t};const Aue={type:"syncstart"},pue={type:"synccomplete"},rL=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],vue=rL.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let oL=class extends ti{constructor(){const e=new uue;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=u3,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=dB,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(Aue),$K({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},n=>{this._isSyncing=!1,this._textRenderInfo=n,this.geometry.updateGlyphs(n.glyphBounds,n.glyphAtlasIndices,n.blockBounds,n.chunkedBounds,n.glyphColors);const i=this._queuedSyncs;i&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{i.forEach(r=>r&&r())})),this.dispatchEvent(pue),e&&e()})))}onBeforeRender(e,n,i,r,o,a){this.sync(),o.isTroikaTextMaterial&&this._prepareForRender(o)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(e){return fue(e)}get material(){let e=this._derivedMaterial;const n=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=H1.clone());if((!e||!e.isDerivedFrom(n))&&(e=this._derivedMaterial=this.createDerivedMaterial(n),n.addEventListener("dispose",function i(){n.removeEventListener("dispose",i),e.dispose()})),this.hasOutline()){let i=e._outlineMtl;return i||(i=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),i.isTextOutlineMaterial=!0,i.depthWrite=!1,i.map=null,e.addEventListener("dispose",function r(){e.removeEventListener("dispose",r),i.dispose()})),[i,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return I3(this.material).getDepthMaterial()}set customDepthMaterial(e){}get customDistanceMaterial(){return I3(this.material).getDistanceMaterial()}set customDistanceMaterial(e){}_prepareForRender(e){const n=e.isTextOutlineMaterial,i=e.uniforms,r=this.textRenderInfo;if(r){const{sdfTexture:s,blockBounds:l}=r;i.uTroikaSDFTexture.value=s,i.uTroikaSDFTextureSize.value.set(s.image.width,s.image.height),i.uTroikaSDFGlyphSize.value=r.sdfGlyphSize,i.uTroikaSDFExponent.value=r.sdfExponent,i.uTroikaTotalBounds.value.fromArray(l),i.uTroikaUseGlyphColors.value=!n&&!!r.glyphColors;let c=0,g=0,u=0,d,C,f,v=0,p=0;if(n){let{outlineWidth:A,outlineOffsetX:b,outlineOffsetY:G,outlineBlur:w,outlineOpacity:S}=this;c=this._parsePercent(A)||0,g=Math.max(0,this._parsePercent(w)||0),d=S,v=this._parsePercent(b)||0,p=this._parsePercent(G)||0}else u=Math.max(0,this._parsePercent(this.strokeWidth)||0),u&&(f=this.strokeColor,i.uTroikaStrokeColor.value.set(f??u3),C=this.strokeOpacity,C==null&&(C=1)),d=this.fillOpacity;i.uTroikaEdgeOffset.value=c,i.uTroikaPositionOffset.value.set(v,p),i.uTroikaBlurRadius.value=g,i.uTroikaStrokeWidth.value=u,i.uTroikaStrokeOpacity.value=C,i.uTroikaFillOpacity.value=d??1,i.uTroikaCurveRadius.value=this.curveRadius||0;let m=this.clipRect;if(m&&Array.isArray(m)&&m.length===4)i.uTroikaClipRect.value.fromArray(m);else{const A=(this.fontSize||.1)*100;i.uTroikaClipRect.value.set(l[0]-A,l[1]-A,l[2]+A,l[3]+A)}this.geometry.applyClipRect(i.uTroikaClipRect.value)}i.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const o=n?this.outlineColor||0:this.color;if(o==null)delete e.color;else{const s=e.hasOwnProperty("color")?e.color:e.color=new kt;(o!==s._input||typeof o=="object")&&s.set(s._input=o)}let a=this.orientation||dB;if(a!==e._orientation){let s=i.uTroikaOrient.value;a=a.replace(/[^-+xyz]/g,"");let l=a!==dB&&a.match(/^([-+])([xyz])([-+])([xyz])$/);if(l){let[,c,g,u,d]=l;HA.set(0,0,0)[g]=c==="-"?1:-1,uB.set(0,0,0)[d]=u==="-"?-1:1,d3.lookAt(mue,HA.cross(uB),uB),s.setFromMatrix4(d3)}else s.identity();e._orientation=a}}_parsePercent(e){if(typeof e=="string"){let n=e.match(/^(-?[\d.]+)%$/),i=n?parseFloat(n[1]):NaN;e=(isNaN(i)?0:i/100)*this.fontSize}return e}localPositionToTextCoords(e,n=new gt){n.copy(e);const i=this.curveRadius;return i&&(n.x=Math.atan2(e.x,Math.abs(i)-Math.abs(e.z))*Math.abs(i)),n}worldPositionToTextCoords(e,n=new gt){return HA.copy(e),this.localPositionToTextCoords(this.worldToLocal(HA),n)}raycast(e,n){const{textRenderInfo:i,curveRadius:r}=this;if(i){const o=i.blockBounds,a=r?iL():nL(),s=a.geometry,{position:l,uv:c}=s.attributes;for(let g=0;g<c.count;g++){let u=o[0]+c.getX(g)*(o[2]-o[0]);const d=o[1]+c.getY(g)*(o[3]-o[1]);let C=0;r&&(C=r-Math.cos(u/r)*r,u=Math.sin(u/r)*r),l.setXYZ(g,u,d,C)}s.boundingSphere=this.geometry.boundingSphere,s.boundingBox=this.geometry.boundingBox,a.matrixWorld=this.matrixWorld,a.material.side=this.material.side,eC.length=0,a.raycast(e,eC);for(let g=0;g<eC.length;g++)eC[g].object=this,n.push(eC[g])}}copy(e){const n=this.geometry;return super.copy(e),this.geometry=n,vue.forEach(i=>{this[i]=e[i]}),this}clone(){return new this.constructor().copy(this)}};rL.forEach(t=>{const e="_private_"+t;Object.defineProperty(oL.prototype,t,{get(){return this[e]},set(n){n!==this[e]&&(this[e]=n,this._needsSync=!0)}})});new Cr;new kt;const bue=y.forwardRef(({sdfGlyphSize:t=64,anchorX:e="center",anchorY:n="middle",font:i,fontSize:r=1,children:o,characters:a,onSync:s,...l},c)=>{const g=Dr(({invalidate:f})=>f),[u]=y.useState(()=>new oL),[d,C]=y.useMemo(()=>{const f=[];let v="";return y.Children.forEach(o,p=>{typeof p=="string"||typeof p=="number"?v+=p:f.push(p)}),[f,v]},[o]);return vK(()=>new Promise(f=>oue({font:i,characters:a},f)),["troika-text",i,a]),y.useLayoutEffect(()=>void u.sync(()=>{g(),s&&s(u)})),y.useEffect(()=>()=>u.dispose(),[u]),y.createElement("primitive",Zt({object:u,ref:c,font:i,text:C,anchorX:e,anchorY:n,fontSize:r,sdfGlyphSize:t},l),d)}),yue=y.forwardRef(({makeDefault:t,camera:e,regress:n,domElement:i,enableDamping:r=!0,keyEvents:o=!1,onChange:a,onStart:s,onEnd:l,...c},g)=>{const u=Dr(S=>S.invalidate),d=Dr(S=>S.camera),C=Dr(S=>S.gl),f=Dr(S=>S.events),v=Dr(S=>S.setEvents),p=Dr(S=>S.set),m=Dr(S=>S.get),A=Dr(S=>S.performance),b=e||d,G=i||f.connected||C.domElement,w=y.useMemo(()=>new Bge(b),[b]);return N1(()=>{w.enabled&&w.update()},-1),y.useEffect(()=>(o&&w.connect(o===!0?G:o),w.connect(G),()=>void w.dispose()),[o,G,n,w,u]),y.useEffect(()=>{const S=R=>{u(),n&&A.regress(),a&&a(R)},Z=R=>{s&&s(R)},x=R=>{l&&l(R)};return w.addEventListener("change",S),w.addEventListener("start",Z),w.addEventListener("end",x),()=>{w.removeEventListener("start",Z),w.removeEventListener("end",x),w.removeEventListener("change",S)}},[a,s,l,w,u,v]),y.useEffect(()=>{if(t){const S=m().controls;return p({controls:w}),()=>p({controls:S})}},[t,w]),y.createElement("primitive",Zt({ref:g,object:w,enableDamping:r},c))}),Gue=3e3,Bue=3001,aL=(t,e,n)=>{let i;switch(t){case vo:i=new Uint8ClampedArray(e*n*4);break;case or:i=new Uint16Array(e*n*4);break;case ws:i=new Uint32Array(e*n*4);break;case Wv:i=new Int8Array(e*n*4);break;case Vv:i=new Int16Array(e*n*4);break;case af:i=new Int32Array(e*n*4);break;case hi:i=new Float32Array(e*n*4);break;default:throw new Error("Unsupported data type")}return i};let XA;const Sue=(t,e,n,i)=>{if(XA!==void 0)return XA;const r=new Do(1,1,i);e.setRenderTarget(r);const o=new ti(new qa,new Rs({color:16777215}));e.render(o,n),e.setRenderTarget(null);const a=aL(t,r.width,r.height);return e.readRenderTargetPixels(r,0,0,r.width,r.height,a),r.dispose(),o.geometry.dispose(),o.material.dispose(),XA=a[0]!==0,XA};class X1{constructor(e){var n,i,r,o,a,s,l,c,g,u,d,C,f,v,p,m;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(b){throw this._renderer.setRenderTarget(null),b}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const A={format:Wi,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((n=e.renderTargetOptions)===null||n===void 0?void 0:n.anisotropy)!==void 0?(i=e.renderTargetOptions)===null||i===void 0?void 0:i.anisotropy:1,generateMipmaps:((r=e.renderTargetOptions)===null||r===void 0?void 0:r.generateMipmaps)!==void 0?(o=e.renderTargetOptions)===null||o===void 0?void 0:o.generateMipmaps:!1,magFilter:((a=e.renderTargetOptions)===null||a===void 0?void 0:a.magFilter)!==void 0?(s=e.renderTargetOptions)===null||s===void 0?void 0:s.magFilter:Kn,minFilter:((l=e.renderTargetOptions)===null||l===void 0?void 0:l.minFilter)!==void 0?(c=e.renderTargetOptions)===null||c===void 0?void 0:c.minFilter:Kn,samples:((g=e.renderTargetOptions)===null||g===void 0?void 0:g.samples)!==void 0?(u=e.renderTargetOptions)===null||u===void 0?void 0:u.samples:void 0,wrapS:((d=e.renderTargetOptions)===null||d===void 0?void 0:d.wrapS)!==void 0?(C=e.renderTargetOptions)===null||C===void 0?void 0:C.wrapS:zi,wrapT:((f=e.renderTargetOptions)===null||f===void 0?void 0:f.wrapT)!==void 0?(v=e.renderTargetOptions)===null||v===void 0?void 0:v.wrapT:zi};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=X1.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new If,this._camera=new il,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!Sue(this._type,this._renderer,this._camera,A)){let b;switch(this._type){case or:b=this._renderer.extensions.has("EXT_color_buffer_float")?hi:void 0;break}b!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${hi}`),this._type=b):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new ti(new qa,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new Do(this.width,this.height,A),this._renderTarget.texture.mapping=((p=e.renderTargetOptions)===null||p===void 0?void 0:p.mapping)!==void 0?(m=e.renderTargetOptions)===null||m===void 0?void 0:m.mapping:cc}static instantiateRenderer(){const e=new a1;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=aL(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const n=new Oa(this.toArray(),this.width,this.height,Wi,this._type,(e==null?void 0:e.mapping)||cc,(e==null?void 0:e.wrapS)||zi,(e==null?void 0:e.wrapT)||zi,(e==null?void 0:e.magFilter)||Kn,(e==null?void 0:e.minFilter)||Kn,(e==null?void 0:e.anisotropy)||1,pa);return n.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,n}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof bo&&Object.values(this.material.uniforms).forEach(n=>{n.value instanceof Tn&&n.value.dispose()}),Object.values(this.material).forEach(n=>{n instanceof Tn&&n.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const wue=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,Zue=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class xue extends bo{constructor({gamma:e,offsetHdr:n,offsetSdr:i,gainMapMin:r,gainMapMax:o,maxDisplayBoost:a,hdrCapacityMin:s,hdrCapacityMax:l,sdr:c,gainMap:g}){super({name:"GainMapDecoderMaterial",vertexShader:wue,fragmentShader:Zue,uniforms:{sdr:{value:c},gainMap:{value:g},gamma:{value:new ge(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new ge().fromArray(n)},offsetSdr:{value:new ge().fromArray(i)},gainMapMin:{value:new ge().fromArray(r)},gainMapMax:{value:new ge().fromArray(o)},weightFactor:{value:(Math.log2(a)-s)/(l-s)}},blending:ys,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=a,this._hdrCapacityMin=s,this._hdrCapacityMax=l,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const n=this.uniforms.gamma.value;n.x=1/e[0],n.y=1/e[1],n.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class sL extends Error{}class lL extends Error{}const tC=(t,e,n)=>{const i=new RegExp(`${e}="([^"]*)"`,"i").exec(t);if(i)return i[1];const r=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(t);if(r){const o=r[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return o&&o.length===3?o.map(a=>a.replace(/<\/?rdf:li>/g,"")):r[1].trim()}if(n!==void 0)return n;throw new Error(`Can't find ${e} in gainmap metadata`)},Rue=t=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(t):e=t.toString();let n=e.indexOf("<x:xmpmeta");for(;n!==-1;){const i=e.indexOf("x:xmpmeta>",n),r=e.slice(n,i+10);try{const o=tC(r,"hdrgm:GainMapMin","0"),a=tC(r,"hdrgm:GainMapMax"),s=tC(r,"hdrgm:Gamma","1"),l=tC(r,"hdrgm:OffsetSDR","0.015625"),c=tC(r,"hdrgm:OffsetHDR","0.015625"),g=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(r),u=g?g[1]:"0",d=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(r);if(!d)throw new Error("Incomplete gainmap metadata");const C=d[1];return{gainMapMin:Array.isArray(o)?o.map(f=>parseFloat(f)):[parseFloat(o),parseFloat(o),parseFloat(o)],gainMapMax:Array.isArray(a)?a.map(f=>parseFloat(f)):[parseFloat(a),parseFloat(a),parseFloat(a)],gamma:Array.isArray(s)?s.map(f=>parseFloat(f)):[parseFloat(s),parseFloat(s),parseFloat(s)],offsetSdr:Array.isArray(l)?l.map(f=>parseFloat(f)):[parseFloat(l),parseFloat(l),parseFloat(l)],offsetHdr:Array.isArray(c)?c.map(f=>parseFloat(f)):[parseFloat(c),parseFloat(c),parseFloat(c)],hdrCapacityMin:parseFloat(u),hdrCapacityMax:parseFloat(C)}}catch{}n=e.indexOf("<x:xmpmeta",i)}};class Wue{constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((n,i)=>{const r=this.options.debug,o=new DataView(e.buffer);if(o.getUint16(0)!==65496){i(new Error("Not a valid jpeg"));return}const a=o.byteLength;let s=2,l=0,c;for(;s<a;){if(++l>250){i(new Error(`Found no marker after ${l} loops `));return}if(o.getUint8(s)!==255){i(new Error(`Not a valid marker at offset 0x${s.toString(16)}, found: 0x${o.getUint8(s).toString(16)}`));return}if(c=o.getUint8(s+1),r&&console.log(`Marker: ${c.toString(16)}`),c===226){r&&console.log("Found APP2 marker (0xffe2)");const g=s+4;if(o.getUint32(g)===1297106432){const u=g+4;let d;if(o.getUint16(u)===18761)d=!1;else if(o.getUint16(u)===19789)d=!0;else{i(new Error("No valid endianness marker found in TIFF header"));return}if(o.getUint16(u+2,!d)!==42){i(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const C=o.getUint32(u+4,!d);if(C<8){i(new Error("Not valid TIFF data! (First offset less than 8)"));return}const f=u+C,v=o.getUint16(f,!d),p=f+2;let m=0;for(let w=p;w<p+12*v;w+=12)o.getUint16(w,!d)===45057&&(m=o.getUint32(w+8,!d));const b=f+2+v*12+4,G=[];for(let w=b;w<b+m*16;w+=16){const S={MPType:o.getUint32(w,!d),size:o.getUint32(w+4,!d),dataOffset:o.getUint32(w+8,!d),dependantImages:o.getUint32(w+12,!d),start:-1,end:-1,isFII:!1};S.dataOffset?(S.start=u+S.dataOffset,S.isFII=!1):(S.start=0,S.isFII=!0),S.end=S.start+S.size,G.push(S)}if(this.options.extractNonFII&&G.length){const w=new Blob([o]),S=[];for(const Z of G){if(Z.isFII&&!this.options.extractFII)continue;const x=w.slice(Z.start,Z.end+1,"image/jpeg");S.push(x)}n(S)}}}s+=2+o.getUint16(s+2)}})}}const Vue=async t=>{const e=Rue(t);if(!e)throw new lL("Gain map XMP metadata not found");const i=await new Wue({extractFII:!0,extractNonFII:!0}).extract(t);if(i.length!==2)throw new sL("Gain map recovery image not found");return{sdr:new Uint8Array(await i[0].arrayBuffer()),gainMap:new Uint8Array(await i[1].arrayBuffer()),metadata:e}},C3=t=>new Promise((e,n)=>{const i=document.createElement("img");i.onload=()=>{e(i)},i.onerror=r=>{n(r)},i.src=URL.createObjectURL(t)});class cL extends ro{constructor(e,n){super(n),e&&(this._renderer=e),this._internalLoadingManager=new ab}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=new xue({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new Tn,sdr:new Tn});return new X1({width:16,height:16,type:or,colorSpace:pa,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,n,i,r){const o=r?new Blob([r],{type:"image/jpeg"}):void 0,a=new Blob([i],{type:"image/jpeg"});let s,l,c=!1;if(typeof createImageBitmap>"u"){const d=await Promise.all([o?C3(o):Promise.resolve(void 0),C3(a)]);l=d[0],s=d[1],c=!0}else{const d=await Promise.all([o?createImageBitmap(o,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(a,{imageOrientation:"flipY"})]);l=d[0],s=d[1]}const g=new Tn(l||new ImageData(2,2),cc,zi,zi,Kn,SS,Wi,vo,1,pa);g.flipY=c,g.needsUpdate=!0;const u=new Tn(s,cc,zi,zi,Kn,SS,Wi,vo,1,Yo);u.flipY=c,u.needsUpdate=!0,e.width=s.width,e.height=s.height,e.material.gainMap=g,e.material.sdr=u,e.material.gainMapMin=n.gainMapMin,e.material.gainMapMax=n.gainMapMax,e.material.offsetHdr=n.offsetHdr,e.material.offsetSdr=n.offsetSdr,e.material.gamma=n.gamma,e.material.hdrCapacityMin=n.hdrCapacityMin,e.material.hdrCapacityMax=n.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,n.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}}class Mue extends cL{load([e,n,i],r,o,a){const s=this.prepareQuadRenderer();let l,c,g;const u=async()=>{if(l&&c&&g){try{await this.render(s,g,l,c)}catch(R){this.manager.itemError(e),this.manager.itemError(n),this.manager.itemError(i),typeof a=="function"&&a(R),s.disposeOnDemandRenderer();return}typeof r=="function"&&r(s),this.manager.itemEnd(e),this.manager.itemEnd(n),this.manager.itemEnd(i),s.disposeOnDemandRenderer()}};let d=!0,C=0,f=0,v=!0,p=0,m=0,A=!0,b=0,G=0;const w=()=>{if(typeof o=="function"){const R=C+p+b,W=f+m+G,M=d&&v&&A;o(new ProgressEvent("progress",{lengthComputable:M,loaded:W,total:R}))}};this.manager.itemStart(e),this.manager.itemStart(n),this.manager.itemStart(i);const S=new Po(this._internalLoadingManager);S.setResponseType("arraybuffer"),S.setRequestHeader(this.requestHeader),S.setPath(this.path),S.setWithCredentials(this.withCredentials),S.load(e,async R=>{if(typeof R=="string")throw new Error("Invalid sdr buffer");l=R,await u()},R=>{d=R.lengthComputable,f=R.loaded,C=R.total,w()},R=>{this.manager.itemError(e),typeof a=="function"&&a(R)});const Z=new Po(this._internalLoadingManager);Z.setResponseType("arraybuffer"),Z.setRequestHeader(this.requestHeader),Z.setPath(this.path),Z.setWithCredentials(this.withCredentials),Z.load(n,async R=>{if(typeof R=="string")throw new Error("Invalid gainmap buffer");c=R,await u()},R=>{v=R.lengthComputable,m=R.loaded,p=R.total,w()},R=>{this.manager.itemError(n),typeof a=="function"&&a(R)});const x=new Po(this._internalLoadingManager);return x.setRequestHeader(this.requestHeader),x.setPath(this.path),x.setWithCredentials(this.withCredentials),x.load(i,async R=>{if(typeof R!="string")throw new Error("Invalid metadata string");g=JSON.parse(R),await u()},R=>{A=R.lengthComputable,G=R.loaded,b=R.total,w()},R=>{this.manager.itemError(i),typeof a=="function"&&a(R)}),s}}class Nue extends cL{load(e,n,i,r){const o=this.prepareQuadRenderer(),a=new Po(this._internalLoadingManager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(this.withCredentials),this.manager.itemStart(e),a.load(e,async s=>{if(typeof s=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const l=new Uint8Array(s);let c,g,u;try{const d=await Vue(l);c=d.sdr,g=d.gainMap,u=d.metadata}catch(d){if(d instanceof lL||d instanceof sL)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),u={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},c=l;else throw d}try{await this.render(o,u,c,g)}catch(d){this.manager.itemError(e),typeof r=="function"&&r(d),o.disposeOnDemandRenderer();return}typeof n=="function"&&n(o),this.manager.itemEnd(e),o.disposeOnDemandRenderer()},i,s=>{this.manager.itemError(e),typeof r=="function"&&r(s)}),o}}const zh={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},gL="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",bd=t=>Array.isArray(t),E1=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function cb({files:t=E1,path:e="",preset:n=void 0,encoding:i=void 0,extensions:r}={}){let o=null,a=!1;n&&(Y1(n),t=zh[n],e=gL),a=bd(t);const{extension:s,isCubemap:l}=z1(t);if(o=K1(s),!o)throw new Error("useEnvironment: Unrecognized file extension: "+t);const c=Dr(C=>C.gl);y.useLayoutEffect(()=>{if(s!=="webp"&&s!=="jpg"&&s!=="jpeg")return;function C(){Pd.clear(o,a?[t]:t)}c.domElement.addEventListener("webglcontextlost",C,{once:!0})},[t,c.domElement]);const g=Pd(o,a?[t]:t,C=>{(s==="webp"||s==="jpg"||s==="jpeg")&&C.setRenderer(c),C.setPath==null||C.setPath(e),r&&r(C)});let u=a?g[0]:g;if(s==="jpg"||s==="jpeg"||s==="webp"){var d;u=(d=u.renderTarget)==null?void 0:d.texture}return u.mapping=l?Ss:Ld,"colorSpace"in u?u.colorSpace=i??l?"srgb":"srgb-linear":u.encoding=i??l?Bue:Gue,u}const Fue={files:E1,path:"",preset:void 0,extensions:void 0};cb.preload=t=>{const e={...Fue,...t};let{files:n,path:i=""}=e;const{preset:r,extensions:o}=e;r&&(Y1(r),n=zh[r],i=gL);const{extension:a}=z1(n);if(a==="webp"||a==="jpg"||a==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const s=K1(a);if(!s)throw new Error("useEnvironment: Unrecognized file extension: "+n);Pd.preload(s,bd(n)?[n]:n,l=>{l.setPath==null||l.setPath(i),o&&o(l)})};const Hue={files:E1,preset:void 0};cb.clear=t=>{const e={...Hue,...t};let{files:n}=e;const{preset:i}=e;i&&(Y1(i),n=zh[i]);const{extension:r}=z1(n),o=K1(r);if(!o)throw new Error("useEnvironment: Unrecognized file extension: "+n);Pd.clear(o,bd(n)?[n]:n)};function Y1(t){if(!(t in zh))throw new Error("Preset must be one of: "+Object.keys(zh).join(", "))}function z1(t){var e;const n=bd(t)&&t.length===6,i=bd(t)&&t.length===3&&t.some(a=>a.endsWith("json")),r=bd(t)?t[0]:t;return{extension:n?"cube":i?"webp":r.startsWith("data:application/exr")?"exr":r.startsWith("data:application/hdr")?"hdr":r.startsWith("data:image/jpeg")?"jpg":(e=r.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:n,isGainmap:i}}function K1(t){return t==="cube"?nK:t==="hdr"?Sge:t==="exr"?wge:t==="jpg"||t==="jpeg"?Nue:t==="webp"?Mue:null}const Xue=t=>t.current&&t.current.isScene,Eue=t=>Xue(t)?t.current:t;function L1(t,e,n,i,r={}){var o,a,s,l;r={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...r};const c=Eue(e||n),g=c.background,u=c.environment,d={backgroundBlurriness:c.backgroundBlurriness,backgroundIntensity:c.backgroundIntensity,backgroundRotation:(o=(a=c.backgroundRotation)==null||a.clone==null?void 0:a.clone())!==null&&o!==void 0?o:[0,0,0],environmentIntensity:c.environmentIntensity,environmentRotation:(s=(l=c.environmentRotation)==null||l.clone==null?void 0:l.clone())!==null&&s!==void 0?s:[0,0,0]};return t!=="only"&&(c.environment=i),t&&(c.background=i),Kl(c,r),()=>{t!=="only"&&(c.environment=u),t&&(c.background=g),Kl(c,d)}}function T1({scene:t,background:e=!1,map:n,...i}){const r=Dr(o=>o.scene);return y.useLayoutEffect(()=>{if(n)return L1(e,t,r,n,i)}),null}function uL({background:t=!1,scene:e,blur:n,backgroundBlurriness:i,backgroundIntensity:r,backgroundRotation:o,environmentIntensity:a,environmentRotation:s,...l}){const c=cb(l),g=Dr(u=>u.scene);return y.useLayoutEffect(()=>L1(t,e,g,c,{backgroundBlurriness:n??i,backgroundIntensity:r,backgroundRotation:o,environmentIntensity:a,environmentRotation:s})),y.useEffect(()=>()=>{c.dispose()},[c]),null}function Yue({children:t,near:e=.1,far:n=1e3,resolution:i=256,frames:r=1,map:o,background:a=!1,blur:s,backgroundBlurriness:l,backgroundIntensity:c,backgroundRotation:g,environmentIntensity:u,environmentRotation:d,scene:C,files:f,path:v,preset:p=void 0,extensions:m}){const A=Dr(x=>x.gl),b=Dr(x=>x.scene),G=y.useRef(null),[w]=y.useState(()=>new If),S=y.useMemo(()=>{const x=new i1(i);return x.texture.type=or,x},[i]);y.useEffect(()=>()=>{S.dispose()},[S]),y.useLayoutEffect(()=>{if(r===1){const x=A.autoClear;A.autoClear=!0,G.current.update(A,w),A.autoClear=x}return L1(a,C,b,S.texture,{backgroundBlurriness:s??l,backgroundIntensity:c,backgroundRotation:g,environmentIntensity:u,environmentRotation:d})},[t,w,S.texture,C,b,a,r,A]);let Z=1;return N1(()=>{if(r===1/0||Z<r){const x=A.autoClear;A.autoClear=!0,G.current.update(A,w),A.autoClear=x,Z++}}),y.createElement(y.Fragment,null,Ece(y.createElement(y.Fragment,null,t,y.createElement("cubeCamera",{ref:G,args:[e,n,S]}),f||p?y.createElement(uL,{background:!0,files:f,preset:p,path:v,extensions:m}):o?y.createElement(T1,{background:!0,map:o,extensions:m}):null),w))}function zue(t){var e,n,i,r;const o=cb(t),a=t.map||o;y.useMemo(()=>BK({GroundProjectedEnvImpl:fge}),[]),y.useEffect(()=>()=>{o.dispose()},[o]);const s=y.useMemo(()=>[a],[a]),l=(e=t.ground)==null?void 0:e.height,c=(n=t.ground)==null?void 0:n.radius,g=(i=(r=t.ground)==null?void 0:r.scale)!==null&&i!==void 0?i:1e3;return y.createElement(y.Fragment,null,y.createElement(T1,Zt({},t,{map:a})),y.createElement("groundProjectedEnvImpl",{args:s,scale:g,height:l,radius:c}))}function Kue(t){return t.ground?y.createElement(zue,t):t.map?y.createElement(T1,t):t.children?y.createElement(Yue,t):y.createElement(uL,t)}var _1={exports:{}},yd=typeof Reflect=="object"?Reflect:null,h3=yd&&typeof yd.apply=="function"?yd.apply:function(e,n,i){return Function.prototype.apply.call(e,n,i)},mp;yd&&typeof yd.ownKeys=="function"?mp=yd.ownKeys:Object.getOwnPropertySymbols?mp=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:mp=function(e){return Object.getOwnPropertyNames(e)};function Lue(t){console&&console.warn&&console.warn(t)}var dL=Number.isNaN||function(e){return e!==e};function Dn(){Dn.init.call(this)}_1.exports=Dn;_1.exports.once=Pue;Dn.EventEmitter=Dn;Dn.prototype._events=void 0;Dn.prototype._eventsCount=0;Dn.prototype._maxListeners=void 0;var f3=10;function gb(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Dn,"defaultMaxListeners",{enumerable:!0,get:function(){return f3},set:function(t){if(typeof t!="number"||t<0||dL(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");f3=t}});Dn.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Dn.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||dL(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function IL(t){return t._maxListeners===void 0?Dn.defaultMaxListeners:t._maxListeners}Dn.prototype.getMaxListeners=function(){return IL(this)};Dn.prototype.emit=function(e){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var r=e==="error",o=this._events;if(o!==void 0)r=r&&o.error===void 0;else if(!r)return!1;if(r){var a;if(n.length>0&&(a=n[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=o[e];if(l===void 0)return!1;if(typeof l=="function")h3(l,this,n);else for(var c=l.length,g=AL(l,c),i=0;i<c;++i)h3(g[i],this,n);return!0};function CL(t,e,n,i){var r,o,a;if(gb(n),o=t._events,o===void 0?(o=t._events=Object.create(null),t._eventsCount=0):(o.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),a=o[e]),a===void 0)a=o[e]=n,++t._eventsCount;else if(typeof a=="function"?a=o[e]=i?[n,a]:[a,n]:i?a.unshift(n):a.push(n),r=IL(t),r>0&&a.length>r&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=e,s.count=a.length,Lue(s)}return t}Dn.prototype.addListener=function(e,n){return CL(this,e,n,!1)};Dn.prototype.on=Dn.prototype.addListener;Dn.prototype.prependListener=function(e,n){return CL(this,e,n,!0)};function Tue(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function hL(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=Tue.bind(i);return r.listener=n,i.wrapFn=r,r}Dn.prototype.once=function(e,n){return gb(n),this.on(e,hL(this,e,n)),this};Dn.prototype.prependOnceListener=function(e,n){return gb(n),this.prependListener(e,hL(this,e,n)),this};Dn.prototype.removeListener=function(e,n){var i,r,o,a,s;if(gb(n),r=this._events,r===void 0)return this;if(i=r[e],i===void 0)return this;if(i===n||i.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||n));else if(typeof i!="function"){for(o=-1,a=i.length-1;a>=0;a--)if(i[a]===n||i[a].listener===n){s=i[a].listener,o=a;break}if(o<0)return this;o===0?i.shift():_ue(i,o),i.length===1&&(r[e]=i[0]),r.removeListener!==void 0&&this.emit("removeListener",e,s||n)}return this};Dn.prototype.off=Dn.prototype.removeListener;Dn.prototype.removeAllListeners=function(e){var n,i,r;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var o=Object.keys(i),a;for(r=0;r<o.length;++r)a=o[r],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=i[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(r=n.length-1;r>=0;r--)this.removeListener(e,n[r]);return this};function fL(t,e,n){var i=t._events;if(i===void 0)return[];var r=i[e];return r===void 0?[]:typeof r=="function"?n?[r.listener||r]:[r]:n?kue(r):AL(r,r.length)}Dn.prototype.listeners=function(e){return fL(this,e,!0)};Dn.prototype.rawListeners=function(e){return fL(this,e,!1)};Dn.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):mL.call(t,e)};Dn.prototype.listenerCount=mL;function mL(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}Dn.prototype.eventNames=function(){return this._eventsCount>0?mp(this._events):[]};function AL(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function _ue(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function kue(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function Pue(t,e){return new Promise(function(n,i){function r(a){t.removeListener(e,o),i(a)}function o(){typeof t.removeListener=="function"&&t.removeListener("error",r),n([].slice.call(arguments))}pL(t,e,o,{once:!0}),e!=="error"&&Uue(t,r,{once:!0})})}function Uue(t,e,n){typeof t.on=="function"&&pL(t,"error",e,n)}function pL(t,e,n,i){if(typeof t.on=="function")i.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function r(o){i.once&&t.removeEventListener(e,r),n(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Due=_1.exports;function Oue(t,e){var n=atob(t);return n}function Jue(t,e,n){var i=Oue(t),r=i.indexOf(`
`,10)+1,o=i.substring(r)+"",a=new Blob([o],{type:"application/javascript"});return URL.createObjectURL(a)}function Que(t,e,n){var i;return function(o){return i=i||Jue(t),new Worker(i,o)}}var jue=Que("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyoqCiAgICogUmVjb3JkcyB3aGF0IG9iamVjdHMgYXJlIGNvbGxpZGluZyB3aXRoIGVhY2ggb3RoZXIKICAgKi8KCiAgLyoqCiAgICogQSAzeDMgbWF0cml4LgogICAqIEF1dGhvcmVkIGJ5IHtAbGluayBodHRwOi8vZ2l0aHViLmNvbS9zY2h0ZXBwZS8gc2NodGVwcGV9CiAgICovCiAgY2xhc3MgTWF0MyB7CiAgICAvKioKICAgICAqIEEgdmVjdG9yIG9mIGxlbmd0aCA5LCBjb250YWluaW5nIGFsbCBtYXRyaXggZWxlbWVudHMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEBwYXJhbSBlbGVtZW50cyBBIHZlY3RvciBvZiBsZW5ndGggOSwgY29udGFpbmluZyBhbGwgbWF0cml4IGVsZW1lbnRzLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihlbGVtZW50cykgewogICAgICBpZiAoZWxlbWVudHMgPT09IHZvaWQgMCkgewogICAgICAgIGVsZW1lbnRzID0gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdOwogICAgICB9CgogICAgICB0aGlzLmVsZW1lbnRzID0gZWxlbWVudHM7CiAgICB9CiAgICAvKioKICAgICAqIFNldHMgdGhlIG1hdHJpeCB0byBpZGVudGl0eQogICAgICogQHRvZG8gU2hvdWxkIHBlcmhhcHMgYmUgcmVuYW1lZCB0byBgc2V0SWRlbnRpdHkoKWAgdG8gYmUgbW9yZSBjbGVhci4KICAgICAqIEB0b2RvIENyZWF0ZSBhbm90aGVyIGZ1bmN0aW9uIHRoYXQgaW1tZWRpYXRlbHkgY3JlYXRlcyBhbiBpZGVudGl0eSBtYXRyaXggZWcuIGBleWUoKWAKICAgICAqLwoKCiAgICBpZGVudGl0eSgpIHsKICAgICAgY29uc3QgZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGVbMF0gPSAxOwogICAgICBlWzFdID0gMDsKICAgICAgZVsyXSA9IDA7CiAgICAgIGVbM10gPSAwOwogICAgICBlWzRdID0gMTsKICAgICAgZVs1XSA9IDA7CiAgICAgIGVbNl0gPSAwOwogICAgICBlWzddID0gMDsKICAgICAgZVs4XSA9IDE7CiAgICB9CiAgICAvKioKICAgICAqIFNldCBhbGwgZWxlbWVudHMgdG8gemVybwogICAgICovCgoKICAgIHNldFplcm8oKSB7CiAgICAgIGNvbnN0IGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICBlWzBdID0gMDsKICAgICAgZVsxXSA9IDA7CiAgICAgIGVbMl0gPSAwOwogICAgICBlWzNdID0gMDsKICAgICAgZVs0XSA9IDA7CiAgICAgIGVbNV0gPSAwOwogICAgICBlWzZdID0gMDsKICAgICAgZVs3XSA9IDA7CiAgICAgIGVbOF0gPSAwOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBtYXRyaXggZGlhZ29uYWwgZWxlbWVudHMgZnJvbSBhIFZlYzMKICAgICAqLwoKCiAgICBzZXRUcmFjZSh2ZWN0b3IpIHsKICAgICAgY29uc3QgZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGVbMF0gPSB2ZWN0b3IueDsKICAgICAgZVs0XSA9IHZlY3Rvci55OwogICAgICBlWzhdID0gdmVjdG9yLno7CiAgICB9CiAgICAvKioKICAgICAqIEdldHMgdGhlIG1hdHJpeCBkaWFnb25hbCBlbGVtZW50cwogICAgICovCgoKICAgIGdldFRyYWNlKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgdGFyZ2V0LnggPSBlWzBdOwogICAgICB0YXJnZXQueSA9IGVbNF07CiAgICAgIHRhcmdldC56ID0gZVs4XTsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTWF0cml4LVZlY3RvciBtdWx0aXBsaWNhdGlvbgogICAgICogQHBhcmFtIHYgVGhlIHZlY3RvciB0byBtdWx0aXBseSB3aXRoCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsLCB0YXJnZXQgdG8gc2F2ZSB0aGUgcmVzdWx0IGluLgogICAgICovCgoKICAgIHZtdWx0KHYsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgY29uc3QgeCA9IHYueDsKICAgICAgY29uc3QgeSA9IHYueTsKICAgICAgY29uc3QgeiA9IHYuejsKICAgICAgdGFyZ2V0LnggPSBlWzBdICogeCArIGVbMV0gKiB5ICsgZVsyXSAqIHo7CiAgICAgIHRhcmdldC55ID0gZVszXSAqIHggKyBlWzRdICogeSArIGVbNV0gKiB6OwogICAgICB0YXJnZXQueiA9IGVbNl0gKiB4ICsgZVs3XSAqIHkgKyBlWzhdICogejsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTWF0cml4LXNjYWxhciBtdWx0aXBsaWNhdGlvbgogICAgICovCgoKICAgIHNtdWx0KHMpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy5lbGVtZW50c1tpXSAqPSBzOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIE1hdHJpeCBtdWx0aXBsaWNhdGlvbgogICAgICogQHBhcmFtIG1hdHJpeCBNYXRyaXggdG8gbXVsdGlwbHkgd2l0aCBmcm9tIGxlZnQgc2lkZS4KICAgICAqLwoKCiAgICBtbXVsdChtYXRyaXgsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgTWF0MygpOwogICAgICB9CgogICAgICBjb25zdCBBID0gdGhpcy5lbGVtZW50czsKICAgICAgY29uc3QgQiA9IG1hdHJpeC5lbGVtZW50czsKICAgICAgY29uc3QgVCA9IHRhcmdldC5lbGVtZW50czsKICAgICAgY29uc3QgYTExID0gQVswXSwKICAgICAgICAgICAgYTEyID0gQVsxXSwKICAgICAgICAgICAgYTEzID0gQVsyXSwKICAgICAgICAgICAgYTIxID0gQVszXSwKICAgICAgICAgICAgYTIyID0gQVs0XSwKICAgICAgICAgICAgYTIzID0gQVs1XSwKICAgICAgICAgICAgYTMxID0gQVs2XSwKICAgICAgICAgICAgYTMyID0gQVs3XSwKICAgICAgICAgICAgYTMzID0gQVs4XTsKICAgICAgY29uc3QgYjExID0gQlswXSwKICAgICAgICAgICAgYjEyID0gQlsxXSwKICAgICAgICAgICAgYjEzID0gQlsyXSwKICAgICAgICAgICAgYjIxID0gQlszXSwKICAgICAgICAgICAgYjIyID0gQls0XSwKICAgICAgICAgICAgYjIzID0gQls1XSwKICAgICAgICAgICAgYjMxID0gQls2XSwKICAgICAgICAgICAgYjMyID0gQls3XSwKICAgICAgICAgICAgYjMzID0gQls4XTsKICAgICAgVFswXSA9IGExMSAqIGIxMSArIGExMiAqIGIyMSArIGExMyAqIGIzMTsKICAgICAgVFsxXSA9IGExMSAqIGIxMiArIGExMiAqIGIyMiArIGExMyAqIGIzMjsKICAgICAgVFsyXSA9IGExMSAqIGIxMyArIGExMiAqIGIyMyArIGExMyAqIGIzMzsKICAgICAgVFszXSA9IGEyMSAqIGIxMSArIGEyMiAqIGIyMSArIGEyMyAqIGIzMTsKICAgICAgVFs0XSA9IGEyMSAqIGIxMiArIGEyMiAqIGIyMiArIGEyMyAqIGIzMjsKICAgICAgVFs1XSA9IGEyMSAqIGIxMyArIGEyMiAqIGIyMyArIGEyMyAqIGIzMzsKICAgICAgVFs2XSA9IGEzMSAqIGIxMSArIGEzMiAqIGIyMSArIGEzMyAqIGIzMTsKICAgICAgVFs3XSA9IGEzMSAqIGIxMiArIGEzMiAqIGIyMiArIGEzMyAqIGIzMjsKICAgICAgVFs4XSA9IGEzMSAqIGIxMyArIGEzMiAqIGIyMyArIGEzMyAqIGIzMzsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogU2NhbGUgZWFjaCBjb2x1bW4gb2YgdGhlIG1hdHJpeAogICAgICovCgoKICAgIHNjYWxlKHZlY3RvciwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBNYXQzKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICBjb25zdCB0ID0gdGFyZ2V0LmVsZW1lbnRzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDM7IGkrKykgewogICAgICAgIHRbMyAqIGkgKyAwXSA9IHZlY3Rvci54ICogZVszICogaSArIDBdOwogICAgICAgIHRbMyAqIGkgKyAxXSA9IHZlY3Rvci55ICogZVszICogaSArIDFdOwogICAgICAgIHRbMyAqIGkgKyAyXSA9IHZlY3Rvci56ICogZVszICogaSArIDJdOwogICAgICB9CgogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBTb2x2ZSBBeD1iCiAgICAgKiBAcGFyYW0gYiBUaGUgcmlnaHQgaGFuZCBzaWRlCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsLiBUYXJnZXQgdmVjdG9yIHRvIHNhdmUgaW4uCiAgICAgKiBAcmV0dXJuIFRoZSBzb2x1dGlvbiB4CiAgICAgKiBAdG9kbyBzaG91bGQgcmV1c2UgYXJyYXlzCiAgICAgKi8KCgogICAgc29sdmUoYiwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIC8vIENvbnN0cnVjdCBlcXVhdGlvbnMKICAgICAgY29uc3QgbnIgPSAzOyAvLyBudW0gcm93cwoKICAgICAgY29uc3QgbmMgPSA0OyAvLyBudW0gY29scwoKICAgICAgY29uc3QgZXFucyA9IFtdOwogICAgICBsZXQgaTsKICAgICAgbGV0IGo7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgbnIgKiBuYzsgaSsrKSB7CiAgICAgICAgZXFucy5wdXNoKDApOwogICAgICB9CgogICAgICBmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7CiAgICAgICAgZm9yIChqID0gMDsgaiA8IDM7IGorKykgewogICAgICAgICAgZXFuc1tpICsgbmMgKiBqXSA9IHRoaXMuZWxlbWVudHNbaSArIDMgKiBqXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGVxbnNbMyArIDQgKiAwXSA9IGIueDsKICAgICAgZXFuc1szICsgNCAqIDFdID0gYi55OwogICAgICBlcW5zWzMgKyA0ICogMl0gPSBiLno7IC8vIENvbXB1dGUgcmlnaHQgdXBwZXIgdHJpYW5ndWxhciB2ZXJzaW9uIG9mIHRoZSBtYXRyaXggLSBHYXVzcyBlbGltaW5hdGlvbgoKICAgICAgbGV0IG4gPSAzOwogICAgICBjb25zdCBrID0gbjsKICAgICAgbGV0IG5wOwogICAgICBjb25zdCBrcCA9IDQ7IC8vIG51bSByb3dzCgogICAgICBsZXQgcDsKCiAgICAgIGRvIHsKICAgICAgICBpID0gayAtIG47CgogICAgICAgIGlmIChlcW5zW2kgKyBuYyAqIGldID09PSAwKSB7CiAgICAgICAgICAvLyB0aGUgcGl2b3QgaXMgbnVsbCwgc3dhcCBsaW5lcwogICAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBrOyBqKyspIHsKICAgICAgICAgICAgaWYgKGVxbnNbaSArIG5jICogal0gIT09IDApIHsKICAgICAgICAgICAgICBucCA9IGtwOwoKICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAvLyBkbyBsaWduZSggaSApID0gbGlnbmUoIGkgKSArIGxpZ25lKCBrICkKICAgICAgICAgICAgICAgIHAgPSBrcCAtIG5wOwogICAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBpXSArPSBlcW5zW3AgKyBuYyAqIGpdOwogICAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGVxbnNbaSArIG5jICogaV0gIT09IDApIHsKICAgICAgICAgIGZvciAoaiA9IGkgKyAxOyBqIDwgazsgaisrKSB7CiAgICAgICAgICAgIGNvbnN0IG11bHRpcGxpZXIgPSBlcW5zW2kgKyBuYyAqIGpdIC8gZXFuc1tpICsgbmMgKiBpXTsKICAgICAgICAgICAgbnAgPSBrcDsKCiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAvLyBkbyBsaWduZSggayApID0gbGlnbmUoIGsgKSAtIG11bHRpcGxpZXIgKiBsaWduZSggaSApCiAgICAgICAgICAgICAgcCA9IGtwIC0gbnA7CiAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBqXSA9IHAgPD0gaSA/IDAgOiBlcW5zW3AgKyBuYyAqIGpdIC0gZXFuc1twICsgbmMgKiBpXSAqIG11bHRpcGxpZXI7CiAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSB3aGlsZSAoLS1uKTsgLy8gR2V0IHRoZSBzb2x1dGlvbgoKCiAgICAgIHRhcmdldC56ID0gZXFuc1syICogbmMgKyAzXSAvIGVxbnNbMiAqIG5jICsgMl07CiAgICAgIHRhcmdldC55ID0gKGVxbnNbMSAqIG5jICsgM10gLSBlcW5zWzEgKiBuYyArIDJdICogdGFyZ2V0LnopIC8gZXFuc1sxICogbmMgKyAxXTsKICAgICAgdGFyZ2V0LnggPSAoZXFuc1swICogbmMgKyAzXSAtIGVxbnNbMCAqIG5jICsgMl0gKiB0YXJnZXQueiAtIGVxbnNbMCAqIG5jICsgMV0gKiB0YXJnZXQueSkgLyBlcW5zWzAgKiBuYyArIDBdOwoKICAgICAgaWYgKGlzTmFOKHRhcmdldC54KSB8fCBpc05hTih0YXJnZXQueSkgfHwgaXNOYU4odGFyZ2V0LnopIHx8IHRhcmdldC54ID09PSBJbmZpbml0eSB8fCB0YXJnZXQueSA9PT0gSW5maW5pdHkgfHwgdGFyZ2V0LnogPT09IEluZmluaXR5KSB7CiAgICAgICAgdGhyb3cgYENvdWxkIG5vdCBzb2x2ZSBlcXVhdGlvbiEgR290IHg9WyR7dGFyZ2V0LnRvU3RyaW5nKCl9XSwgYj1bJHtiLnRvU3RyaW5nKCl9XSwgQT1bJHt0aGlzLnRvU3RyaW5nKCl9XWA7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBlbGVtZW50IGluIHRoZSBtYXRyaXggYnkgaW5kZXguIEluZGV4IHN0YXJ0cyBhdCAwLCBub3QgMSEhIQogICAgICogQHBhcmFtIHZhbHVlIElmIHByb3ZpZGVkLCB0aGUgbWF0cml4IGVsZW1lbnQgd2lsbCBiZSBzZXQgdG8gdGhpcyB2YWx1ZS4KICAgICAqLwoKCiAgICBlKHJvdywgY29sdW1uLCB2YWx1ZSkgewogICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRzW2NvbHVtbiArIDMgKiByb3ddOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFNldCB2YWx1ZQogICAgICAgIHRoaXMuZWxlbWVudHNbY29sdW1uICsgMyAqIHJvd10gPSB2YWx1ZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDb3B5IGFub3RoZXIgbWF0cml4IGludG8gdGhpcyBtYXRyaXggb2JqZWN0LgogICAgICovCgoKICAgIGNvcHkobWF0cml4KSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWF0cml4LmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy5lbGVtZW50c1tpXSA9IG1hdHJpeC5lbGVtZW50c1tpXTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIG1hdHJpeC4KICAgICAqLwoKCiAgICB0b1N0cmluZygpIHsKICAgICAgbGV0IHIgPSAnJzsKICAgICAgY29uc3Qgc2VwID0gJywnOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA5OyBpKyspIHsKICAgICAgICByICs9IHRoaXMuZWxlbWVudHNbaV0gKyBzZXA7CiAgICAgIH0KCiAgICAgIHJldHVybiByOwogICAgfQogICAgLyoqCiAgICAgKiByZXZlcnNlIHRoZSBtYXRyaXgKICAgICAqIEBwYXJhbSB0YXJnZXQgVGFyZ2V0IG1hdHJpeCB0byBzYXZlIGluLgogICAgICogQHJldHVybiBUaGUgc29sdXRpb24geAogICAgICovCgoKICAgIHJldmVyc2UodGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBNYXQzKCk7CiAgICAgIH0KCiAgICAgIC8vIENvbnN0cnVjdCBlcXVhdGlvbnMKICAgICAgY29uc3QgbnIgPSAzOyAvLyBudW0gcm93cwoKICAgICAgY29uc3QgbmMgPSA2OyAvLyBudW0gY29scwoKICAgICAgY29uc3QgZXFucyA9IHJldmVyc2VfZXFuczsKICAgICAgbGV0IGk7CiAgICAgIGxldCBqOwoKICAgICAgZm9yIChpID0gMDsgaSA8IDM7IGkrKykgewogICAgICAgIGZvciAoaiA9IDA7IGogPCAzOyBqKyspIHsKICAgICAgICAgIGVxbnNbaSArIG5jICogal0gPSB0aGlzLmVsZW1lbnRzW2kgKyAzICogal07CiAgICAgICAgfQogICAgICB9CgogICAgICBlcW5zWzMgKyA2ICogMF0gPSAxOwogICAgICBlcW5zWzMgKyA2ICogMV0gPSAwOwogICAgICBlcW5zWzMgKyA2ICogMl0gPSAwOwogICAgICBlcW5zWzQgKyA2ICogMF0gPSAwOwogICAgICBlcW5zWzQgKyA2ICogMV0gPSAxOwogICAgICBlcW5zWzQgKyA2ICogMl0gPSAwOwogICAgICBlcW5zWzUgKyA2ICogMF0gPSAwOwogICAgICBlcW5zWzUgKyA2ICogMV0gPSAwOwogICAgICBlcW5zWzUgKyA2ICogMl0gPSAxOyAvLyBDb21wdXRlIHJpZ2h0IHVwcGVyIHRyaWFuZ3VsYXIgdmVyc2lvbiBvZiB0aGUgbWF0cml4IC0gR2F1c3MgZWxpbWluYXRpb24KCiAgICAgIGxldCBuID0gMzsKICAgICAgY29uc3QgayA9IG47CiAgICAgIGxldCBucDsKICAgICAgY29uc3Qga3AgPSBuYzsgLy8gbnVtIHJvd3MKCiAgICAgIGxldCBwOwoKICAgICAgZG8gewogICAgICAgIGkgPSBrIC0gbjsKCiAgICAgICAgaWYgKGVxbnNbaSArIG5jICogaV0gPT09IDApIHsKICAgICAgICAgIC8vIHRoZSBwaXZvdCBpcyBudWxsLCBzd2FwIGxpbmVzCiAgICAgICAgICBmb3IgKGogPSBpICsgMTsgaiA8IGs7IGorKykgewogICAgICAgICAgICBpZiAoZXFuc1tpICsgbmMgKiBqXSAhPT0gMCkgewogICAgICAgICAgICAgIG5wID0ga3A7CgogICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgIC8vIGRvIGxpbmUoIGkgKSA9IGxpbmUoIGkgKSArIGxpbmUoIGsgKQogICAgICAgICAgICAgICAgcCA9IGtwIC0gbnA7CiAgICAgICAgICAgICAgICBlcW5zW3AgKyBuYyAqIGldICs9IGVxbnNbcCArIG5jICogal07CiAgICAgICAgICAgICAgfSB3aGlsZSAoLS1ucCk7CgogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoZXFuc1tpICsgbmMgKiBpXSAhPT0gMCkgewogICAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBrOyBqKyspIHsKICAgICAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IGVxbnNbaSArIG5jICogal0gLyBlcW5zW2kgKyBuYyAqIGldOwogICAgICAgICAgICBucCA9IGtwOwoKICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgIC8vIGRvIGxpbmUoIGsgKSA9IGxpbmUoIGsgKSAtIG11bHRpcGxpZXIgKiBsaW5lKCBpICkKICAgICAgICAgICAgICBwID0ga3AgLSBucDsKICAgICAgICAgICAgICBlcW5zW3AgKyBuYyAqIGpdID0gcCA8PSBpID8gMCA6IGVxbnNbcCArIG5jICogal0gLSBlcW5zW3AgKyBuYyAqIGldICogbXVsdGlwbGllcjsKICAgICAgICAgICAgfSB3aGlsZSAoLS1ucCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IHdoaWxlICgtLW4pOyAvLyBlbGltaW5hdGUgdGhlIHVwcGVyIGxlZnQgdHJpYW5nbGUgb2YgdGhlIG1hdHJpeAoKCiAgICAgIGkgPSAyOwoKICAgICAgZG8gewogICAgICAgIGogPSBpIC0gMTsKCiAgICAgICAgZG8gewogICAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IGVxbnNbaSArIG5jICogal0gLyBlcW5zW2kgKyBuYyAqIGldOwogICAgICAgICAgbnAgPSBuYzsKCiAgICAgICAgICBkbyB7CiAgICAgICAgICAgIHAgPSBuYyAtIG5wOwogICAgICAgICAgICBlcW5zW3AgKyBuYyAqIGpdID0gZXFuc1twICsgbmMgKiBqXSAtIGVxbnNbcCArIG5jICogaV0gKiBtdWx0aXBsaWVyOwogICAgICAgICAgfSB3aGlsZSAoLS1ucCk7CiAgICAgICAgfSB3aGlsZSAoai0tKTsKICAgICAgfSB3aGlsZSAoLS1pKTsgLy8gb3BlcmF0aW9ucyBvbiB0aGUgZGlhZ29uYWwKCgogICAgICBpID0gMjsKCiAgICAgIGRvIHsKICAgICAgICBjb25zdCBtdWx0aXBsaWVyID0gMSAvIGVxbnNbaSArIG5jICogaV07CiAgICAgICAgbnAgPSBuYzsKCiAgICAgICAgZG8gewogICAgICAgICAgcCA9IG5jIC0gbnA7CiAgICAgICAgICBlcW5zW3AgKyBuYyAqIGldID0gZXFuc1twICsgbmMgKiBpXSAqIG11bHRpcGxpZXI7CiAgICAgICAgfSB3aGlsZSAoLS1ucCk7CiAgICAgIH0gd2hpbGUgKGktLSk7CgogICAgICBpID0gMjsKCiAgICAgIGRvIHsKICAgICAgICBqID0gMjsKCiAgICAgICAgZG8gewogICAgICAgICAgcCA9IGVxbnNbbnIgKyBqICsgbmMgKiBpXTsKCiAgICAgICAgICBpZiAoaXNOYU4ocCkgfHwgcCA9PT0gSW5maW5pdHkpIHsKICAgICAgICAgICAgdGhyb3cgYENvdWxkIG5vdCByZXZlcnNlISBBPVske3RoaXMudG9TdHJpbmcoKX1dYDsKICAgICAgICAgIH0KCiAgICAgICAgICB0YXJnZXQuZShpLCBqLCBwKTsKICAgICAgICB9IHdoaWxlIChqLS0pOwogICAgICB9IHdoaWxlIChpLS0pOwoKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBtYXRyaXggZnJvbSBhIHF1YXRlcmlvbgogICAgICovCgoKICAgIHNldFJvdGF0aW9uRnJvbVF1YXRlcm5pb24ocSkgewogICAgICBjb25zdCB4ID0gcS54OwogICAgICBjb25zdCB5ID0gcS55OwogICAgICBjb25zdCB6ID0gcS56OwogICAgICBjb25zdCB3ID0gcS53OwogICAgICBjb25zdCB4MiA9IHggKyB4OwogICAgICBjb25zdCB5MiA9IHkgKyB5OwogICAgICBjb25zdCB6MiA9IHogKyB6OwogICAgICBjb25zdCB4eCA9IHggKiB4MjsKICAgICAgY29uc3QgeHkgPSB4ICogeTI7CiAgICAgIGNvbnN0IHh6ID0geCAqIHoyOwogICAgICBjb25zdCB5eSA9IHkgKiB5MjsKICAgICAgY29uc3QgeXogPSB5ICogejI7CiAgICAgIGNvbnN0IHp6ID0geiAqIHoyOwogICAgICBjb25zdCB3eCA9IHcgKiB4MjsKICAgICAgY29uc3Qgd3kgPSB3ICogeTI7CiAgICAgIGNvbnN0IHd6ID0gdyAqIHoyOwogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgZVszICogMCArIDBdID0gMSAtICh5eSArIHp6KTsKICAgICAgZVszICogMCArIDFdID0geHkgLSB3ejsKICAgICAgZVszICogMCArIDJdID0geHogKyB3eTsKICAgICAgZVszICogMSArIDBdID0geHkgKyB3ejsKICAgICAgZVszICogMSArIDFdID0gMSAtICh4eCArIHp6KTsKICAgICAgZVszICogMSArIDJdID0geXogLSB3eDsKICAgICAgZVszICogMiArIDBdID0geHogLSB3eTsKICAgICAgZVszICogMiArIDFdID0geXogKyB3eDsKICAgICAgZVszICogMiArIDJdID0gMSAtICh4eCArIHl5KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFRyYW5zcG9zZSB0aGUgbWF0cml4CiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsLiBXaGVyZSB0byBzdG9yZSB0aGUgcmVzdWx0LgogICAgICogQHJldHVybiBUaGUgdGFyZ2V0IE1hdDMsIG9yIGEgbmV3IE1hdDMgaWYgdGFyZ2V0IHdhcyBvbWl0dGVkLgogICAgICovCgoKICAgIHRyYW5zcG9zZSh0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IE1hdDMoKTsKICAgICAgfQoKICAgICAgY29uc3QgTSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGNvbnN0IFQgPSB0YXJnZXQuZWxlbWVudHM7CiAgICAgIGxldCB0bXA7IC8vU2V0IGRpYWdvbmFscwoKICAgICAgVFswXSA9IE1bMF07CiAgICAgIFRbNF0gPSBNWzRdOwogICAgICBUWzhdID0gTVs4XTsKICAgICAgdG1wID0gTVsxXTsKICAgICAgVFsxXSA9IE1bM107CiAgICAgIFRbM10gPSB0bXA7CiAgICAgIHRtcCA9IE1bMl07CiAgICAgIFRbMl0gPSBNWzZdOwogICAgICBUWzZdID0gdG1wOwogICAgICB0bXAgPSBNWzVdOwogICAgICBUWzVdID0gTVs3XTsKICAgICAgVFs3XSA9IHRtcDsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KCiAgfQogIGNvbnN0IHJldmVyc2VfZXFucyA9IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXTsKCiAgLyoqCiAgICogMy1kaW1lbnNpb25hbCB2ZWN0b3IKICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCB2ID0gbmV3IFZlYzMoMSwgMiwgMykKICAgKiAgICAgY29uc29sZS5sb2coJ3g9JyArIHYueCkgLy8geD0xCiAgICovCgogIGNsYXNzIFZlYzMgewogICAgY29uc3RydWN0b3IoeCwgeSwgeikgewogICAgICBpZiAoeCA9PT0gdm9pZCAwKSB7CiAgICAgICAgeCA9IDAuMDsKICAgICAgfQoKICAgICAgaWYgKHkgPT09IHZvaWQgMCkgewogICAgICAgIHkgPSAwLjA7CiAgICAgIH0KCiAgICAgIGlmICh6ID09PSB2b2lkIDApIHsKICAgICAgICB6ID0gMC4wOwogICAgICB9CgogICAgICB0aGlzLnggPSB4OwogICAgICB0aGlzLnkgPSB5OwogICAgICB0aGlzLnogPSB6OwogICAgfQogICAgLyoqCiAgICAgKiBWZWN0b3IgY3Jvc3MgcHJvZHVjdAogICAgICogQHBhcmFtIHRhcmdldCBPcHRpb25hbCB0YXJnZXQgdG8gc2F2ZSBpbi4KICAgICAqLwoKCiAgICBjcm9zcyh2ZWN0b3IsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCB2eCA9IHZlY3Rvci54OwogICAgICBjb25zdCB2eSA9IHZlY3Rvci55OwogICAgICBjb25zdCB2eiA9IHZlY3Rvci56OwogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICB0YXJnZXQueCA9IHkgKiB2eiAtIHogKiB2eTsKICAgICAgdGFyZ2V0LnkgPSB6ICogdnggLSB4ICogdno7CiAgICAgIHRhcmdldC56ID0geCAqIHZ5IC0geSAqIHZ4OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIHZlY3RvcnMnIDMgZWxlbWVudHMKICAgICAqLwoKCiAgICBzZXQoeCwgeSwgeikgewogICAgICB0aGlzLnggPSB4OwogICAgICB0aGlzLnkgPSB5OwogICAgICB0aGlzLnogPSB6OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogU2V0IGFsbCBjb21wb25lbnRzIG9mIHRoZSB2ZWN0b3IgdG8gemVyby4KICAgICAqLwoKCiAgICBzZXRaZXJvKCkgewogICAgICB0aGlzLnggPSB0aGlzLnkgPSB0aGlzLnogPSAwOwogICAgfQogICAgLyoqCiAgICAgKiBWZWN0b3IgYWRkaXRpb24KICAgICAqLwoKCiAgICB2YWRkKHZlY3RvciwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQpIHsKICAgICAgICB0YXJnZXQueCA9IHZlY3Rvci54ICsgdGhpcy54OwogICAgICAgIHRhcmdldC55ID0gdmVjdG9yLnkgKyB0aGlzLnk7CiAgICAgICAgdGFyZ2V0LnogPSB2ZWN0b3IueiArIHRoaXMuejsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbmV3IFZlYzModGhpcy54ICsgdmVjdG9yLngsIHRoaXMueSArIHZlY3Rvci55LCB0aGlzLnogKyB2ZWN0b3Iueik7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVmVjdG9yIHN1YnRyYWN0aW9uCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsIHRhcmdldCB0byBzYXZlIGluLgogICAgICovCgoKICAgIHZzdWIodmVjdG9yLCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCkgewogICAgICAgIHRhcmdldC54ID0gdGhpcy54IC0gdmVjdG9yLng7CiAgICAgICAgdGFyZ2V0LnkgPSB0aGlzLnkgLSB2ZWN0b3IueTsKICAgICAgICB0YXJnZXQueiA9IHRoaXMueiAtIHZlY3Rvci56OwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBuZXcgVmVjMyh0aGlzLnggLSB2ZWN0b3IueCwgdGhpcy55IC0gdmVjdG9yLnksIHRoaXMueiAtIHZlY3Rvci56KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGNyb3NzIHByb2R1Y3QgbWF0cml4IGFfY3Jvc3MgZnJvbSBhIHZlY3Rvciwgc3VjaCB0aGF0IGEgeCBiID0gYV9jcm9zcyAqIGIgPSBjCiAgICAgKgogICAgICogU2VlIHtAbGluayBodHRwczovL3d3dzguY3MudW11LnNlL2t1cnNlci9UREJEMjQvVlQwNi9sZWN0dXJlcy9MZWN0dXJlNi5wZGYgVW1lw6UgVW5pdmVyc2l0eSBMZWN0dXJlfQogICAgICovCgoKICAgIGNyb3NzbWF0KCkgewogICAgICByZXR1cm4gbmV3IE1hdDMoWzAsIC10aGlzLnosIHRoaXMueSwgdGhpcy56LCAwLCAtdGhpcy54LCAtdGhpcy55LCB0aGlzLngsIDBdKTsKICAgIH0KICAgIC8qKgogICAgICogTm9ybWFsaXplIHRoZSB2ZWN0b3IuIE5vdGUgdGhhdCB0aGlzIGNoYW5nZXMgdGhlIHZhbHVlcyBpbiB0aGUgdmVjdG9yLgogICAgICAqIEByZXR1cm4gUmV0dXJucyB0aGUgbm9ybSBvZiB0aGUgdmVjdG9yCiAgICAgKi8KCgogICAgbm9ybWFsaXplKCkgewogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICBjb25zdCBuID0gTWF0aC5zcXJ0KHggKiB4ICsgeSAqIHkgKyB6ICogeik7CgogICAgICBpZiAobiA+IDAuMCkgewogICAgICAgIGNvbnN0IGludk4gPSAxIC8gbjsKICAgICAgICB0aGlzLnggKj0gaW52TjsKICAgICAgICB0aGlzLnkgKj0gaW52TjsKICAgICAgICB0aGlzLnogKj0gaW52TjsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBNYWtlIHNvbWV0aGluZyB1cAogICAgICAgIHRoaXMueCA9IDA7CiAgICAgICAgdGhpcy55ID0gMDsKICAgICAgICB0aGlzLnogPSAwOwogICAgICB9CgogICAgICByZXR1cm4gbjsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSB2ZXJzaW9uIG9mIHRoaXMgdmVjdG9yIHRoYXQgaXMgb2YgbGVuZ3RoIDEuCiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsIHRhcmdldCB0byBzYXZlIGluCiAgICAgKiBAcmV0dXJuIFJldHVybnMgdGhlIHVuaXQgdmVjdG9yCiAgICAgKi8KCgogICAgdW5pdCh0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgbGV0IG5pbnYgPSBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSArIHogKiB6KTsKCiAgICAgIGlmIChuaW52ID4gMC4wKSB7CiAgICAgICAgbmludiA9IDEuMCAvIG5pbnY7CiAgICAgICAgdGFyZ2V0LnggPSB4ICogbmludjsKICAgICAgICB0YXJnZXQueSA9IHkgKiBuaW52OwogICAgICAgIHRhcmdldC56ID0geiAqIG5pbnY7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGFyZ2V0LnggPSAxOwogICAgICAgIHRhcmdldC55ID0gMDsKICAgICAgICB0YXJnZXQueiA9IDA7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgbGVuZ3RoIG9mIHRoZSB2ZWN0b3IKICAgICAqLwoKCiAgICBsZW5ndGgoKSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIHJldHVybiBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSArIHogKiB6KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBzcXVhcmVkIGxlbmd0aCBvZiB0aGUgdmVjdG9yLgogICAgICovCgoKICAgIGxlbmd0aFNxdWFyZWQoKSB7CiAgICAgIHJldHVybiB0aGlzLmRvdCh0aGlzKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGRpc3RhbmNlIGZyb20gdGhpcyBwb2ludCB0byBhbm90aGVyIHBvaW50CiAgICAgKi8KCgogICAgZGlzdGFuY2VUbyhwKSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIGNvbnN0IHB4ID0gcC54OwogICAgICBjb25zdCBweSA9IHAueTsKICAgICAgY29uc3QgcHogPSBwLno7CiAgICAgIHJldHVybiBNYXRoLnNxcnQoKHB4IC0geCkgKiAocHggLSB4KSArIChweSAtIHkpICogKHB5IC0geSkgKyAocHogLSB6KSAqIChweiAtIHopKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHNxdWFyZWQgZGlzdGFuY2UgZnJvbSB0aGlzIHBvaW50IHRvIGFub3RoZXIgcG9pbnQKICAgICAqLwoKCiAgICBkaXN0YW5jZVNxdWFyZWQocCkgewogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICBjb25zdCBweCA9IHAueDsKICAgICAgY29uc3QgcHkgPSBwLnk7CiAgICAgIGNvbnN0IHB6ID0gcC56OwogICAgICByZXR1cm4gKHB4IC0geCkgKiAocHggLSB4KSArIChweSAtIHkpICogKHB5IC0geSkgKyAocHogLSB6KSAqIChweiAtIHopOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSBhbGwgdGhlIGNvbXBvbmVudHMgb2YgdGhlIHZlY3RvciB3aXRoIGEgc2NhbGFyLgogICAgICogQHBhcmFtIHRhcmdldCBUaGUgdmVjdG9yIHRvIHNhdmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBzY2FsZShzY2FsYXIsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICB0YXJnZXQueCA9IHNjYWxhciAqIHg7CiAgICAgIHRhcmdldC55ID0gc2NhbGFyICogeTsKICAgICAgdGFyZ2V0LnogPSBzY2FsYXIgKiB6OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB0aGUgdmVjdG9yIHdpdGggYW4gb3RoZXIgdmVjdG9yLCBjb21wb25lbnQtd2lzZS4KICAgICAqIEBwYXJhbSB0YXJnZXQgVGhlIHZlY3RvciB0byBzYXZlIHRoZSByZXN1bHQgaW4uCiAgICAgKi8KCgogICAgdm11bCh2ZWN0b3IsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQueCA9IHZlY3Rvci54ICogdGhpcy54OwogICAgICB0YXJnZXQueSA9IHZlY3Rvci55ICogdGhpcy55OwogICAgICB0YXJnZXQueiA9IHZlY3Rvci56ICogdGhpcy56OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBTY2FsZSBhIHZlY3RvciBhbmQgYWRkIGl0IHRvIHRoaXMgdmVjdG9yLiBTYXZlIHRoZSByZXN1bHQgaW4gInRhcmdldCIuICh0YXJnZXQgPSB0aGlzICsgdmVjdG9yICogc2NhbGFyKQogICAgICogQHBhcmFtIHRhcmdldCBUaGUgdmVjdG9yIHRvIHNhdmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBhZGRTY2FsZWRWZWN0b3Ioc2NhbGFyLCB2ZWN0b3IsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQueCA9IHRoaXMueCArIHNjYWxhciAqIHZlY3Rvci54OwogICAgICB0YXJnZXQueSA9IHRoaXMueSArIHNjYWxhciAqIHZlY3Rvci55OwogICAgICB0YXJnZXQueiA9IHRoaXMueiArIHNjYWxhciAqIHZlY3Rvci56OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBDYWxjdWxhdGUgZG90IHByb2R1Y3QKICAgICAqIEBwYXJhbSB2ZWN0b3IKICAgICAqLwoKCiAgICBkb3QodmVjdG9yKSB7CiAgICAgIHJldHVybiB0aGlzLnggKiB2ZWN0b3IueCArIHRoaXMueSAqIHZlY3Rvci55ICsgdGhpcy56ICogdmVjdG9yLno7CiAgICB9CgogICAgaXNaZXJvKCkgewogICAgICByZXR1cm4gdGhpcy54ID09PSAwICYmIHRoaXMueSA9PT0gMCAmJiB0aGlzLnogPT09IDA7CiAgICB9CiAgICAvKioKICAgICAqIE1ha2UgdGhlIHZlY3RvciBwb2ludCBpbiB0aGUgb3Bwb3NpdGUgZGlyZWN0aW9uLgogICAgICogQHBhcmFtIHRhcmdldCBPcHRpb25hbCB0YXJnZXQgdG8gc2F2ZSBpbgogICAgICovCgoKICAgIG5lZ2F0ZSh0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgdGFyZ2V0LnggPSAtdGhpcy54OwogICAgICB0YXJnZXQueSA9IC10aGlzLnk7CiAgICAgIHRhcmdldC56ID0gLXRoaXMuejsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0d28gYXJ0aWZpY2lhbCB0YW5nZW50cyB0byB0aGUgdmVjdG9yCiAgICAgKiBAcGFyYW0gdDEgVmVjdG9yIG9iamVjdCB0byBzYXZlIHRoZSBmaXJzdCB0YW5nZW50IGluCiAgICAgKiBAcGFyYW0gdDIgVmVjdG9yIG9iamVjdCB0byBzYXZlIHRoZSBzZWNvbmQgdGFuZ2VudCBpbgogICAgICovCgoKICAgIHRhbmdlbnRzKHQxLCB0MikgewogICAgICBjb25zdCBub3JtID0gdGhpcy5sZW5ndGgoKTsKCiAgICAgIGlmIChub3JtID4gMC4wKSB7CiAgICAgICAgY29uc3QgbiA9IFZlYzNfdGFuZ2VudHNfbjsKICAgICAgICBjb25zdCBpbm9ybSA9IDEgLyBub3JtOwogICAgICAgIG4uc2V0KHRoaXMueCAqIGlub3JtLCB0aGlzLnkgKiBpbm9ybSwgdGhpcy56ICogaW5vcm0pOwogICAgICAgIGNvbnN0IHJhbmRWZWMgPSBWZWMzX3RhbmdlbnRzX3JhbmRWZWM7CgogICAgICAgIGlmIChNYXRoLmFicyhuLngpIDwgMC45KSB7CiAgICAgICAgICByYW5kVmVjLnNldCgxLCAwLCAwKTsKICAgICAgICAgIG4uY3Jvc3MocmFuZFZlYywgdDEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByYW5kVmVjLnNldCgwLCAxLCAwKTsKICAgICAgICAgIG4uY3Jvc3MocmFuZFZlYywgdDEpOwogICAgICAgIH0KCiAgICAgICAgbi5jcm9zcyh0MSwgdDIpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRoZSBub3JtYWwgbGVuZ3RoIGlzIHplcm8sIG1ha2Ugc29tZXRoaW5nIHVwCiAgICAgICAgdDEuc2V0KDEsIDAsIDApOwogICAgICAgIHQyLnNldCgwLCAxLCAwKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0cyB0byBhIG1vcmUgcmVhZGFibGUgZm9ybWF0CiAgICAgKi8KCgogICAgdG9TdHJpbmcoKSB7CiAgICAgIHJldHVybiBgJHt0aGlzLnh9LCR7dGhpcy55fSwke3RoaXMuen1gOwogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0cyB0byBhbiBhcnJheQogICAgICovCgoKICAgIHRvQXJyYXkoKSB7CiAgICAgIHJldHVybiBbdGhpcy54LCB0aGlzLnksIHRoaXMuel07CiAgICB9CiAgICAvKioKICAgICAqIENvcGllcyB2YWx1ZSBvZiBzb3VyY2UgdG8gdGhpcyB2ZWN0b3IuCiAgICAgKi8KCgogICAgY29weSh2ZWN0b3IpIHsKICAgICAgdGhpcy54ID0gdmVjdG9yLng7CiAgICAgIHRoaXMueSA9IHZlY3Rvci55OwogICAgICB0aGlzLnogPSB2ZWN0b3IuejsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIERvIGEgbGluZWFyIGludGVycG9sYXRpb24gYmV0d2VlbiB0d28gdmVjdG9ycwogICAgICogQHBhcmFtIHQgQSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxLiAwIHdpbGwgbWFrZSB0aGlzIGZ1bmN0aW9uIHJldHVybiB1LCBhbmQgMSB3aWxsIG1ha2UgaXQgcmV0dXJuIHYuIE51bWJlcnMgaW4gYmV0d2VlbiB3aWxsIGdlbmVyYXRlIGEgdmVjdG9yIGluIGJldHdlZW4gdGhlbS4KICAgICAqLwoKCiAgICBsZXJwKHZlY3RvciwgdCwgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIHRhcmdldC54ID0geCArICh2ZWN0b3IueCAtIHgpICogdDsKICAgICAgdGFyZ2V0LnkgPSB5ICsgKHZlY3Rvci55IC0geSkgKiB0OwogICAgICB0YXJnZXQueiA9IHogKyAodmVjdG9yLnogLSB6KSAqIHQ7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGEgdmVjdG9yIGVxdWFscyBpcyBhbG1vc3QgZXF1YWwgdG8gYW5vdGhlciBvbmUuCiAgICAgKi8KCgogICAgYWxtb3N0RXF1YWxzKHZlY3RvciwgcHJlY2lzaW9uKSB7CiAgICAgIGlmIChwcmVjaXNpb24gPT09IHZvaWQgMCkgewogICAgICAgIHByZWNpc2lvbiA9IDFlLTY7CiAgICAgIH0KCiAgICAgIGlmIChNYXRoLmFicyh0aGlzLnggLSB2ZWN0b3IueCkgPiBwcmVjaXNpb24gfHwgTWF0aC5hYnModGhpcy55IC0gdmVjdG9yLnkpID4gcHJlY2lzaW9uIHx8IE1hdGguYWJzKHRoaXMueiAtIHZlY3Rvci56KSA+IHByZWNpc2lvbikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGEgdmVjdG9yIGlzIGFsbW9zdCB6ZXJvCiAgICAgKi8KCgogICAgYWxtb3N0WmVybyhwcmVjaXNpb24pIHsKICAgICAgaWYgKHByZWNpc2lvbiA9PT0gdm9pZCAwKSB7CiAgICAgICAgcHJlY2lzaW9uID0gMWUtNjsKICAgICAgfQoKICAgICAgaWYgKE1hdGguYWJzKHRoaXMueCkgPiBwcmVjaXNpb24gfHwgTWF0aC5hYnModGhpcy55KSA+IHByZWNpc2lvbiB8fCBNYXRoLmFicyh0aGlzLnopID4gcHJlY2lzaW9uKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIHZlY3RvciBpcyBhbnRpLXBhcmFsbGVsIHRvIGFub3RoZXIgdmVjdG9yLgogICAgICogQHBhcmFtIHByZWNpc2lvbiBTZXQgdG8gemVybyBmb3IgZXhhY3QgY29tcGFyaXNvbnMKICAgICAqLwoKCiAgICBpc0FudGlwYXJhbGxlbFRvKHZlY3RvciwgcHJlY2lzaW9uKSB7CiAgICAgIHRoaXMubmVnYXRlKGFudGlwX25lZyk7CiAgICAgIHJldHVybiBhbnRpcF9uZWcuYWxtb3N0RXF1YWxzKHZlY3RvciwgcHJlY2lzaW9uKTsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmUgdGhlIHZlY3RvcgogICAgICovCgoKICAgIGNsb25lKCkgewogICAgICByZXR1cm4gbmV3IFZlYzModGhpcy54LCB0aGlzLnksIHRoaXMueik7CiAgICB9CgogIH0KICBWZWMzLlpFUk8gPSBuZXcgVmVjMygwLCAwLCAwKTsKICBWZWMzLlVOSVRfWCA9IG5ldyBWZWMzKDEsIDAsIDApOwogIFZlYzMuVU5JVF9ZID0gbmV3IFZlYzMoMCwgMSwgMCk7CiAgVmVjMy5VTklUX1ogPSBuZXcgVmVjMygwLCAwLCAxKTsKICBjb25zdCBWZWMzX3RhbmdlbnRzX24gPSBuZXcgVmVjMygpOwogIGNvbnN0IFZlYzNfdGFuZ2VudHNfcmFuZFZlYyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYW50aXBfbmVnID0gbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQXhpcyBhbGlnbmVkIGJvdW5kaW5nIGJveCBjbGFzcy4KICAgKi8KICBjbGFzcyBBQUJCIHsKICAgIC8qKgogICAgICogVGhlIGxvd2VyIGJvdW5kIG9mIHRoZSBib3VuZGluZyBib3gKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHVwcGVyIGJvdW5kIG9mIHRoZSBib3VuZGluZyBib3gKICAgICAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICB0aGlzLmxvd2VyQm91bmQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnVwcGVyQm91bmQgPSBuZXcgVmVjMygpOwoKICAgICAgaWYgKG9wdGlvbnMubG93ZXJCb3VuZCkgewogICAgICAgIHRoaXMubG93ZXJCb3VuZC5jb3B5KG9wdGlvbnMubG93ZXJCb3VuZCk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLnVwcGVyQm91bmQpIHsKICAgICAgICB0aGlzLnVwcGVyQm91bmQuY29weShvcHRpb25zLnVwcGVyQm91bmQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgQUFCQiBib3VuZHMgZnJvbSBhIHNldCBvZiBwb2ludHMuCiAgICAgKiBAcGFyYW0gcG9pbnRzIEFuIGFycmF5IG9mIFZlYzMncy4KICAgICAqIEByZXR1cm4gVGhlIHNlbGYgb2JqZWN0CiAgICAgKi8KCgogICAgc2V0RnJvbVBvaW50cyhwb2ludHMsIHBvc2l0aW9uLCBxdWF0ZXJuaW9uLCBza2luU2l6ZSkgewogICAgICBjb25zdCBsID0gdGhpcy5sb3dlckJvdW5kOwogICAgICBjb25zdCB1ID0gdGhpcy51cHBlckJvdW5kOwogICAgICBjb25zdCBxID0gcXVhdGVybmlvbjsgLy8gU2V0IHRvIHRoZSBmaXJzdCBwb2ludAoKICAgICAgbC5jb3B5KHBvaW50c1swXSk7CgogICAgICBpZiAocSkgewogICAgICAgIHEudm11bHQobCwgbCk7CiAgICAgIH0KCiAgICAgIHUuY29weShsKTsKCiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgbGV0IHAgPSBwb2ludHNbaV07CgogICAgICAgIGlmIChxKSB7CiAgICAgICAgICBxLnZtdWx0KHAsIHRtcCQxKTsKICAgICAgICAgIHAgPSB0bXAkMTsKICAgICAgICB9CgogICAgICAgIGlmIChwLnggPiB1LngpIHsKICAgICAgICAgIHUueCA9IHAueDsKICAgICAgICB9CgogICAgICAgIGlmIChwLnggPCBsLngpIHsKICAgICAgICAgIGwueCA9IHAueDsKICAgICAgICB9CgogICAgICAgIGlmIChwLnkgPiB1LnkpIHsKICAgICAgICAgIHUueSA9IHAueTsKICAgICAgICB9CgogICAgICAgIGlmIChwLnkgPCBsLnkpIHsKICAgICAgICAgIGwueSA9IHAueTsKICAgICAgICB9CgogICAgICAgIGlmIChwLnogPiB1LnopIHsKICAgICAgICAgIHUueiA9IHAuejsKICAgICAgICB9CgogICAgICAgIGlmIChwLnogPCBsLnopIHsKICAgICAgICAgIGwueiA9IHAuejsKICAgICAgICB9CiAgICAgIH0gLy8gQWRkIG9mZnNldAoKCiAgICAgIGlmIChwb3NpdGlvbikgewogICAgICAgIHBvc2l0aW9uLnZhZGQobCwgbCk7CiAgICAgICAgcG9zaXRpb24udmFkZCh1LCB1KTsKICAgICAgfQoKICAgICAgaWYgKHNraW5TaXplKSB7CiAgICAgICAgbC54IC09IHNraW5TaXplOwogICAgICAgIGwueSAtPSBza2luU2l6ZTsKICAgICAgICBsLnogLT0gc2tpblNpemU7CiAgICAgICAgdS54ICs9IHNraW5TaXplOwogICAgICAgIHUueSArPSBza2luU2l6ZTsKICAgICAgICB1LnogKz0gc2tpblNpemU7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBDb3B5IGJvdW5kcyBmcm9tIGFuIEFBQkIgdG8gdGhpcyBBQUJCCiAgICAgKiBAcGFyYW0gYWFiYiBTb3VyY2UgdG8gY29weSBmcm9tCiAgICAgKiBAcmV0dXJuIFRoZSB0aGlzIG9iamVjdCwgZm9yIGNoYWluYWJpbGl0eQogICAgICovCgoKICAgIGNvcHkoYWFiYikgewogICAgICB0aGlzLmxvd2VyQm91bmQuY29weShhYWJiLmxvd2VyQm91bmQpOwogICAgICB0aGlzLnVwcGVyQm91bmQuY29weShhYWJiLnVwcGVyQm91bmQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmUgYW4gQUFCQgogICAgICovCgoKICAgIGNsb25lKCkgewogICAgICByZXR1cm4gbmV3IEFBQkIoKS5jb3B5KHRoaXMpOwogICAgfQogICAgLyoqCiAgICAgKiBFeHRlbmQgdGhpcyBBQUJCIHNvIHRoYXQgaXQgY292ZXJzIHRoZSBnaXZlbiBBQUJCIHRvby4KICAgICAqLwoKCiAgICBleHRlbmQoYWFiYikgewogICAgICB0aGlzLmxvd2VyQm91bmQueCA9IE1hdGgubWluKHRoaXMubG93ZXJCb3VuZC54LCBhYWJiLmxvd2VyQm91bmQueCk7CiAgICAgIHRoaXMudXBwZXJCb3VuZC54ID0gTWF0aC5tYXgodGhpcy51cHBlckJvdW5kLngsIGFhYmIudXBwZXJCb3VuZC54KTsKICAgICAgdGhpcy5sb3dlckJvdW5kLnkgPSBNYXRoLm1pbih0aGlzLmxvd2VyQm91bmQueSwgYWFiYi5sb3dlckJvdW5kLnkpOwogICAgICB0aGlzLnVwcGVyQm91bmQueSA9IE1hdGgubWF4KHRoaXMudXBwZXJCb3VuZC55LCBhYWJiLnVwcGVyQm91bmQueSk7CiAgICAgIHRoaXMubG93ZXJCb3VuZC56ID0gTWF0aC5taW4odGhpcy5sb3dlckJvdW5kLnosIGFhYmIubG93ZXJCb3VuZC56KTsKICAgICAgdGhpcy51cHBlckJvdW5kLnogPSBNYXRoLm1heCh0aGlzLnVwcGVyQm91bmQueiwgYWFiYi51cHBlckJvdW5kLnopOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIEFBQkIgb3ZlcmxhcHMgdGhpcyBBQUJCLgogICAgICovCgoKICAgIG92ZXJsYXBzKGFhYmIpIHsKICAgICAgY29uc3QgbDEgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUxID0gdGhpcy51cHBlckJvdW5kOwogICAgICBjb25zdCBsMiA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdTIgPSBhYWJiLnVwcGVyQm91bmQ7IC8vICAgICAgbDIgICAgICAgIHUyCiAgICAgIC8vICAgICAgfC0tLS0tLS0tLXwKICAgICAgLy8gfC0tLS0tLS0tfAogICAgICAvLyBsMSAgICAgICB1MQoKICAgICAgY29uc3Qgb3ZlcmxhcHNYID0gbDIueCA8PSB1MS54ICYmIHUxLnggPD0gdTIueCB8fCBsMS54IDw9IHUyLnggJiYgdTIueCA8PSB1MS54OwogICAgICBjb25zdCBvdmVybGFwc1kgPSBsMi55IDw9IHUxLnkgJiYgdTEueSA8PSB1Mi55IHx8IGwxLnkgPD0gdTIueSAmJiB1Mi55IDw9IHUxLnk7CiAgICAgIGNvbnN0IG92ZXJsYXBzWiA9IGwyLnogPD0gdTEueiAmJiB1MS56IDw9IHUyLnogfHwgbDEueiA8PSB1Mi56ICYmIHUyLnogPD0gdTEuejsKICAgICAgcmV0dXJuIG92ZXJsYXBzWCAmJiBvdmVybGFwc1kgJiYgb3ZlcmxhcHNaOwogICAgfSAvLyBNb3N0bHkgZm9yIGRlYnVnZ2luZwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIGNvbnN0IGwgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUgPSB0aGlzLnVwcGVyQm91bmQ7CiAgICAgIHJldHVybiAodS54IC0gbC54KSAqICh1LnkgLSBsLnkpICogKHUueiAtIGwueik7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gQUFCQiBpcyBmdWxseSBjb250YWluZWQgaW4gdGhpcyBBQUJCLgogICAgICovCgoKICAgIGNvbnRhaW5zKGFhYmIpIHsKICAgICAgY29uc3QgbDEgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUxID0gdGhpcy51cHBlckJvdW5kOwogICAgICBjb25zdCBsMiA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdTIgPSBhYWJiLnVwcGVyQm91bmQ7IC8vICAgICAgbDIgICAgICAgIHUyCiAgICAgIC8vICAgICAgfC0tLS0tLS0tLXwKICAgICAgLy8gfC0tLS0tLS0tLS0tLS0tLXwKICAgICAgLy8gbDEgICAgICAgICAgICAgIHUxCgogICAgICByZXR1cm4gbDEueCA8PSBsMi54ICYmIHUxLnggPj0gdTIueCAmJiBsMS55IDw9IGwyLnkgJiYgdTEueSA+PSB1Mi55ICYmIGwxLnogPD0gbDIueiAmJiB1MS56ID49IHUyLno7CiAgICB9CgogICAgZ2V0Q29ybmVycyhhLCBiLCBjLCBkLCBlLCBmLCBnLCBoKSB7CiAgICAgIGNvbnN0IGwgPSB0aGlzLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUgPSB0aGlzLnVwcGVyQm91bmQ7CiAgICAgIGEuY29weShsKTsKICAgICAgYi5zZXQodS54LCBsLnksIGwueik7CiAgICAgIGMuc2V0KHUueCwgdS55LCBsLnopOwogICAgICBkLnNldChsLngsIHUueSwgdS56KTsKICAgICAgZS5zZXQodS54LCBsLnksIHUueik7CiAgICAgIGYuc2V0KGwueCwgdS55LCBsLnopOwogICAgICBnLnNldChsLngsIGwueSwgdS56KTsKICAgICAgaC5jb3B5KHUpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHJlcHJlc2VudGF0aW9uIG9mIGFuIEFBQkIgaW4gYW5vdGhlciBmcmFtZS4KICAgICAqIEByZXR1cm4gVGhlICJ0YXJnZXQiIEFBQkIgb2JqZWN0LgogICAgICovCgoKICAgIHRvTG9jYWxGcmFtZShmcmFtZSwgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGNvcm5lcnMgPSB0cmFuc2Zvcm1JbnRvRnJhbWVfY29ybmVyczsKICAgICAgY29uc3QgYSA9IGNvcm5lcnNbMF07CiAgICAgIGNvbnN0IGIgPSBjb3JuZXJzWzFdOwogICAgICBjb25zdCBjID0gY29ybmVyc1syXTsKICAgICAgY29uc3QgZCA9IGNvcm5lcnNbM107CiAgICAgIGNvbnN0IGUgPSBjb3JuZXJzWzRdOwogICAgICBjb25zdCBmID0gY29ybmVyc1s1XTsKICAgICAgY29uc3QgZyA9IGNvcm5lcnNbNl07CiAgICAgIGNvbnN0IGggPSBjb3JuZXJzWzddOyAvLyBHZXQgY29ybmVycyBpbiBjdXJyZW50IGZyYW1lCgogICAgICB0aGlzLmdldENvcm5lcnMoYSwgYiwgYywgZCwgZSwgZiwgZywgaCk7IC8vIFRyYW5zZm9ybSB0aGVtIHRvIG5ldyBsb2NhbCBmcmFtZQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDg7IGkrKykgewogICAgICAgIGNvbnN0IGNvcm5lciA9IGNvcm5lcnNbaV07CiAgICAgICAgZnJhbWUucG9pbnRUb0xvY2FsKGNvcm5lciwgY29ybmVyKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRhcmdldC5zZXRGcm9tUG9pbnRzKGNvcm5lcnMpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHJlcHJlc2VudGF0aW9uIG9mIGFuIEFBQkIgaW4gdGhlIGdsb2JhbCBmcmFtZS4KICAgICAqIEByZXR1cm4gVGhlICJ0YXJnZXQiIEFBQkIgb2JqZWN0LgogICAgICovCgoKICAgIHRvV29ybGRGcmFtZShmcmFtZSwgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGNvcm5lcnMgPSB0cmFuc2Zvcm1JbnRvRnJhbWVfY29ybmVyczsKICAgICAgY29uc3QgYSA9IGNvcm5lcnNbMF07CiAgICAgIGNvbnN0IGIgPSBjb3JuZXJzWzFdOwogICAgICBjb25zdCBjID0gY29ybmVyc1syXTsKICAgICAgY29uc3QgZCA9IGNvcm5lcnNbM107CiAgICAgIGNvbnN0IGUgPSBjb3JuZXJzWzRdOwogICAgICBjb25zdCBmID0gY29ybmVyc1s1XTsKICAgICAgY29uc3QgZyA9IGNvcm5lcnNbNl07CiAgICAgIGNvbnN0IGggPSBjb3JuZXJzWzddOyAvLyBHZXQgY29ybmVycyBpbiBjdXJyZW50IGZyYW1lCgogICAgICB0aGlzLmdldENvcm5lcnMoYSwgYiwgYywgZCwgZSwgZiwgZywgaCk7IC8vIFRyYW5zZm9ybSB0aGVtIHRvIG5ldyBsb2NhbCBmcmFtZQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDg7IGkrKykgewogICAgICAgIGNvbnN0IGNvcm5lciA9IGNvcm5lcnNbaV07CiAgICAgICAgZnJhbWUucG9pbnRUb1dvcmxkKGNvcm5lciwgY29ybmVyKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRhcmdldC5zZXRGcm9tUG9pbnRzKGNvcm5lcnMpOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgQUFCQiBpcyBoaXQgYnkgYSByYXkuCiAgICAgKi8KCgogICAgb3ZlcmxhcHNSYXkocmF5KSB7CiAgICAgIGNvbnN0IHsKICAgICAgICBkaXJlY3Rpb24sCiAgICAgICAgZnJvbQogICAgICB9ID0gcmF5OyAvLyBjb25zdCB0ID0gMAogICAgICAvLyByYXkuZGlyZWN0aW9uIGlzIHVuaXQgZGlyZWN0aW9uIHZlY3RvciBvZiByYXkKCiAgICAgIGNvbnN0IGRpckZyYWNYID0gMSAvIGRpcmVjdGlvbi54OwogICAgICBjb25zdCBkaXJGcmFjWSA9IDEgLyBkaXJlY3Rpb24ueTsKICAgICAgY29uc3QgZGlyRnJhY1ogPSAxIC8gZGlyZWN0aW9uLno7IC8vIHRoaXMubG93ZXJCb3VuZCBpcyB0aGUgY29ybmVyIG9mIEFBQkIgd2l0aCBtaW5pbWFsIGNvb3JkaW5hdGVzIC0gbGVmdCBib3R0b20sIHJ0IGlzIG1heGltYWwgY29ybmVyCgogICAgICBjb25zdCB0MSA9ICh0aGlzLmxvd2VyQm91bmQueCAtIGZyb20ueCkgKiBkaXJGcmFjWDsKICAgICAgY29uc3QgdDIgPSAodGhpcy51cHBlckJvdW5kLnggLSBmcm9tLngpICogZGlyRnJhY1g7CiAgICAgIGNvbnN0IHQzID0gKHRoaXMubG93ZXJCb3VuZC55IC0gZnJvbS55KSAqIGRpckZyYWNZOwogICAgICBjb25zdCB0NCA9ICh0aGlzLnVwcGVyQm91bmQueSAtIGZyb20ueSkgKiBkaXJGcmFjWTsKICAgICAgY29uc3QgdDUgPSAodGhpcy5sb3dlckJvdW5kLnogLSBmcm9tLnopICogZGlyRnJhY1o7CiAgICAgIGNvbnN0IHQ2ID0gKHRoaXMudXBwZXJCb3VuZC56IC0gZnJvbS56KSAqIGRpckZyYWNaOyAvLyBjb25zdCB0bWluID0gTWF0aC5tYXgoTWF0aC5tYXgoTWF0aC5taW4odDEsIHQyKSwgTWF0aC5taW4odDMsIHQ0KSkpOwogICAgICAvLyBjb25zdCB0bWF4ID0gTWF0aC5taW4oTWF0aC5taW4oTWF0aC5tYXgodDEsIHQyKSwgTWF0aC5tYXgodDMsIHQ0KSkpOwoKICAgICAgY29uc3QgdG1pbiA9IE1hdGgubWF4KE1hdGgubWF4KE1hdGgubWluKHQxLCB0MiksIE1hdGgubWluKHQzLCB0NCkpLCBNYXRoLm1pbih0NSwgdDYpKTsKICAgICAgY29uc3QgdG1heCA9IE1hdGgubWluKE1hdGgubWluKE1hdGgubWF4KHQxLCB0MiksIE1hdGgubWF4KHQzLCB0NCkpLCBNYXRoLm1heCh0NSwgdDYpKTsgLy8gaWYgdG1heCA8IDAsIHJheSAobGluZSkgaXMgaW50ZXJzZWN0aW5nIEFBQkIsIGJ1dCB3aG9sZSBBQUJCIGlzIGJlaGluZyB1cwoKICAgICAgaWYgKHRtYXggPCAwKSB7CiAgICAgICAgLy90ID0gdG1heDsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gaWYgdG1pbiA+IHRtYXgsIHJheSBkb2Vzbid0IGludGVyc2VjdCBBQUJCCgoKICAgICAgaWYgKHRtaW4gPiB0bWF4KSB7CiAgICAgICAgLy90ID0gdG1heDsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICB9CiAgY29uc3QgdG1wJDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRyYW5zZm9ybUludG9GcmFtZV9jb3JuZXJzID0gW25ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCldOwoKICAvKioKICAgKiBDb2xsaXNpb24gIm1hdHJpeCIuCiAgICogSXQncyBhY3R1YWxseSBhIHRyaWFuZ3VsYXItc2hhcGVkIGFycmF5IG9mIHdoZXRoZXIgdHdvIGJvZGllcyBhcmUgdG91Y2hpbmcgdGhpcyBzdGVwLCBmb3IgcmVmZXJlbmNlIG5leHQgc3RlcAogICAqLwogIGNsYXNzIEFycmF5Q29sbGlzaW9uTWF0cml4IHsKICAgIC8qKgogICAgICogVGhlIG1hdHJpeCBzdG9yYWdlLgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy5tYXRyaXggPSBbXTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFuIGVsZW1lbnQKICAgICAqLwoKCiAgICBnZXQoYmksIGJqKSB7CiAgICAgIGxldCB7CiAgICAgICAgaW5kZXg6IGkKICAgICAgfSA9IGJpOwogICAgICBsZXQgewogICAgICAgIGluZGV4OiBqCiAgICAgIH0gPSBiajsKCiAgICAgIGlmIChqID4gaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5tYXRyaXhbKGkgKiAoaSArIDEpID4+IDEpICsgaiAtIDFdOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgYW4gZWxlbWVudAogICAgICovCgoKICAgIHNldChiaSwgYmosIHZhbHVlKSB7CiAgICAgIGxldCB7CiAgICAgICAgaW5kZXg6IGkKICAgICAgfSA9IGJpOwogICAgICBsZXQgewogICAgICAgIGluZGV4OiBqCiAgICAgIH0gPSBiajsKCiAgICAgIGlmIChqID4gaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICB0aGlzLm1hdHJpeFsoaSAqIChpICsgMSkgPj4gMSkgKyBqIC0gMV0gPSB2YWx1ZSA/IDEgOiAwOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIGFsbCBlbGVtZW50cyB0byB6ZXJvCiAgICAgKi8KCgogICAgcmVzZXQoKSB7CiAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5tYXRyaXgubGVuZ3RoOyBpICE9PSBsOyBpKyspIHsKICAgICAgICB0aGlzLm1hdHJpeFtpXSA9IDA7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogU2V0cyB0aGUgbWF4IG51bWJlciBvZiBvYmplY3RzCiAgICAgKi8KCgogICAgc2V0TnVtT2JqZWN0cyhuKSB7CiAgICAgIHRoaXMubWF0cml4Lmxlbmd0aCA9IG4gKiAobiAtIDEpID4+IDE7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQmFzZSBjbGFzcyBmb3Igb2JqZWN0cyB0aGF0IGRpc3BhdGNoZXMgZXZlbnRzLgogICAqLwogIGNsYXNzIEV2ZW50VGFyZ2V0IHsKICAgIC8qKgogICAgICogQWRkIGFuIGV2ZW50IGxpc3RlbmVyCiAgICAgKiBAcmV0dXJuIFRoZSBzZWxmIG9iamVjdCwgZm9yIGNoYWluYWJpbGl0eS4KICAgICAqLwogICAgYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikgewogICAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHsKICAgICAgICB0aGlzLl9saXN0ZW5lcnMgPSB7fTsKICAgICAgfQoKICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwoKICAgICAgaWYgKGxpc3RlbmVyc1t0eXBlXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgbGlzdGVuZXJzW3R5cGVdID0gW107CiAgICAgIH0KCiAgICAgIGlmICghbGlzdGVuZXJzW3R5cGVdLmluY2x1ZGVzKGxpc3RlbmVyKSkgewogICAgICAgIGxpc3RlbmVyc1t0eXBlXS5wdXNoKGxpc3RlbmVyKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGFuIGV2ZW50IGxpc3RlbmVyIGlzIGFkZGVkCiAgICAgKi8KCgogICAgaGFzRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikgewogICAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyczsKCiAgICAgIGlmIChsaXN0ZW5lcnNbdHlwZV0gIT09IHVuZGVmaW5lZCAmJiBsaXN0ZW5lcnNbdHlwZV0uaW5jbHVkZXMobGlzdGVuZXIpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgYW55IGV2ZW50IGxpc3RlbmVyIG9mIHRoZSBnaXZlbiB0eXBlIGlzIGFkZGVkCiAgICAgKi8KCgogICAgaGFzQW55RXZlbnRMaXN0ZW5lcih0eXBlKSB7CiAgICAgIGlmICh0aGlzLl9saXN0ZW5lcnMgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwogICAgICByZXR1cm4gbGlzdGVuZXJzW3R5cGVdICE9PSB1bmRlZmluZWQ7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZSBhbiBldmVudCBsaXN0ZW5lcgogICAgICogQHJldHVybiBUaGUgc2VsZiBvYmplY3QsIGZvciBjaGFpbmFiaWxpdHkuCiAgICAgKi8KCgogICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikgewogICAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQoKICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwoKICAgICAgaWYgKGxpc3RlbmVyc1t0eXBlXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIGNvbnN0IGluZGV4ID0gbGlzdGVuZXJzW3R5cGVdLmluZGV4T2YobGlzdGVuZXIpOwoKICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgIGxpc3RlbmVyc1t0eXBlXS5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogRW1pdCBhbiBldmVudC4KICAgICAqIEByZXR1cm4gVGhlIHNlbGYgb2JqZWN0LCBmb3IgY2hhaW5hYmlsaXR5LgogICAgICovCgoKICAgIGRpc3BhdGNoRXZlbnQoZXZlbnQpIHsKICAgICAgaWYgKHRoaXMuX2xpc3RlbmVycyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyczsKICAgICAgY29uc3QgbGlzdGVuZXJBcnJheSA9IGxpc3RlbmVyc1tldmVudC50eXBlXTsKCiAgICAgIGlmIChsaXN0ZW5lckFycmF5ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBldmVudC50YXJnZXQgPSB0aGlzOwoKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGxpc3RlbmVyQXJyYXkubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICBsaXN0ZW5lckFycmF5W2ldLmNhbGwodGhpcywgZXZlbnQpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQSBRdWF0ZXJuaW9uIGRlc2NyaWJlcyBhIHJvdGF0aW9uIGluIDNEIHNwYWNlLiBUaGUgUXVhdGVybmlvbiBpcyBtYXRoZW1hdGljYWxseSBkZWZpbmVkIGFzIFEgPSB4KmkgKyB5KmogKyB6KmsgKyB3LCB3aGVyZSAoaSxqLGspIGFyZSBpbWFnaW5hcnkgYmFzaXMgdmVjdG9ycy4gKHgseSx6KSBjYW4gYmUgc2VlbiBhcyBhIHZlY3RvciByZWxhdGVkIHRvIHRoZSBheGlzIG9mIHJvdGF0aW9uLCB3aGlsZSB0aGUgcmVhbCBtdWx0aXBsaWVyLCB3LCBpcyByZWxhdGVkIHRvIHRoZSBhbW91bnQgb2Ygcm90YXRpb24uCiAgICogQHBhcmFtIHggTXVsdGlwbGllciBvZiB0aGUgaW1hZ2luYXJ5IGJhc2lzIHZlY3RvciBpLgogICAqIEBwYXJhbSB5IE11bHRpcGxpZXIgb2YgdGhlIGltYWdpbmFyeSBiYXNpcyB2ZWN0b3Igai4KICAgKiBAcGFyYW0geiBNdWx0aXBsaWVyIG9mIHRoZSBpbWFnaW5hcnkgYmFzaXMgdmVjdG9yIGsuCiAgICogQHBhcmFtIHcgTXVsdGlwbGllciBvZiB0aGUgcmVhbCBwYXJ0LgogICAqIEBzZWUgaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9RdWF0ZXJuaW9uCiAgICovCgogIGNsYXNzIFF1YXRlcm5pb24gewogICAgY29uc3RydWN0b3IoeCwgeSwgeiwgdykgewogICAgICBpZiAoeCA9PT0gdm9pZCAwKSB7CiAgICAgICAgeCA9IDA7CiAgICAgIH0KCiAgICAgIGlmICh5ID09PSB2b2lkIDApIHsKICAgICAgICB5ID0gMDsKICAgICAgfQoKICAgICAgaWYgKHogPT09IHZvaWQgMCkgewogICAgICAgIHogPSAwOwogICAgICB9CgogICAgICBpZiAodyA9PT0gdm9pZCAwKSB7CiAgICAgICAgdyA9IDE7CiAgICAgIH0KCiAgICAgIHRoaXMueCA9IHg7CiAgICAgIHRoaXMueSA9IHk7CiAgICAgIHRoaXMueiA9IHo7CiAgICAgIHRoaXMudyA9IHc7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgdmFsdWUgb2YgdGhlIHF1YXRlcm5pb24uCiAgICAgKi8KCgogICAgc2V0KHgsIHksIHosIHcpIHsKICAgICAgdGhpcy54ID0geDsKICAgICAgdGhpcy55ID0geTsKICAgICAgdGhpcy56ID0gejsKICAgICAgdGhpcy53ID0gdzsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgdG8gYSByZWFkYWJsZSBmb3JtYXQKICAgICAqIEByZXR1cm4gIngseSx6LHciCiAgICAgKi8KCgogICAgdG9TdHJpbmcoKSB7CiAgICAgIHJldHVybiBgJHt0aGlzLnh9LCR7dGhpcy55fSwke3RoaXMuen0sJHt0aGlzLnd9YDsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCB0byBhbiBBcnJheQogICAgICogQHJldHVybiBbeCwgeSwgeiwgd10KICAgICAqLwoKCiAgICB0b0FycmF5KCkgewogICAgICByZXR1cm4gW3RoaXMueCwgdGhpcy55LCB0aGlzLnosIHRoaXMud107CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgcXVhdGVybmlvbiBjb21wb25lbnRzIGdpdmVuIGFuIGF4aXMgYW5kIGFuIGFuZ2xlIGluIHJhZGlhbnMuCiAgICAgKi8KCgogICAgc2V0RnJvbUF4aXNBbmdsZSh2ZWN0b3IsIGFuZ2xlKSB7CiAgICAgIGNvbnN0IHMgPSBNYXRoLnNpbihhbmdsZSAqIDAuNSk7CiAgICAgIHRoaXMueCA9IHZlY3Rvci54ICogczsKICAgICAgdGhpcy55ID0gdmVjdG9yLnkgKiBzOwogICAgICB0aGlzLnogPSB2ZWN0b3IueiAqIHM7CiAgICAgIHRoaXMudyA9IE1hdGguY29zKGFuZ2xlICogMC41KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnRzIHRoZSBxdWF0ZXJuaW9uIHRvIFsgYXhpcywgYW5nbGUgXSByZXByZXNlbnRhdGlvbi4KICAgICAqIEBwYXJhbSB0YXJnZXRBeGlzIEEgdmVjdG9yIG9iamVjdCB0byByZXVzZSBmb3Igc3RvcmluZyB0aGUgYXhpcy4KICAgICAqIEByZXR1cm4gQW4gYXJyYXksIGZpcnN0IGVsZW1lbnQgaXMgdGhlIGF4aXMgYW5kIHRoZSBzZWNvbmQgaXMgdGhlIGFuZ2xlIGluIHJhZGlhbnMuCiAgICAgKi8KCgogICAgdG9BeGlzQW5nbGUodGFyZ2V0QXhpcykgewogICAgICBpZiAodGFyZ2V0QXhpcyA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0QXhpcyA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMubm9ybWFsaXplKCk7IC8vIGlmIHc+MSBhY29zIGFuZCBzcXJ0IHdpbGwgcHJvZHVjZSBlcnJvcnMsIHRoaXMgY2FudCBoYXBwZW4gaWYgcXVhdGVybmlvbiBpcyBub3JtYWxpc2VkCgogICAgICBjb25zdCBhbmdsZSA9IDIgKiBNYXRoLmFjb3ModGhpcy53KTsKICAgICAgY29uc3QgcyA9IE1hdGguc3FydCgxIC0gdGhpcy53ICogdGhpcy53KTsgLy8gYXNzdW1pbmcgcXVhdGVybmlvbiBub3JtYWxpc2VkIHRoZW4gdyBpcyBsZXNzIHRoYW4gMSwgc28gdGVybSBhbHdheXMgcG9zaXRpdmUuCgogICAgICBpZiAocyA8IDAuMDAxKSB7CiAgICAgICAgLy8gdGVzdCB0byBhdm9pZCBkaXZpZGUgYnkgemVybywgcyBpcyBhbHdheXMgcG9zaXRpdmUgZHVlIHRvIHNxcnQKICAgICAgICAvLyBpZiBzIGNsb3NlIHRvIHplcm8gdGhlbiBkaXJlY3Rpb24gb2YgYXhpcyBub3QgaW1wb3J0YW50CiAgICAgICAgdGFyZ2V0QXhpcy54ID0gdGhpcy54OyAvLyBpZiBpdCBpcyBpbXBvcnRhbnQgdGhhdCBheGlzIGlzIG5vcm1hbGlzZWQgdGhlbiByZXBsYWNlIHdpdGggeD0xOyB5PXo9MDsKCiAgICAgICAgdGFyZ2V0QXhpcy55ID0gdGhpcy55OwogICAgICAgIHRhcmdldEF4aXMueiA9IHRoaXMuejsKICAgICAgfSBlbHNlIHsKICAgICAgICB0YXJnZXRBeGlzLnggPSB0aGlzLnggLyBzOyAvLyBub3JtYWxpc2UgYXhpcwoKICAgICAgICB0YXJnZXRBeGlzLnkgPSB0aGlzLnkgLyBzOwogICAgICAgIHRhcmdldEF4aXMueiA9IHRoaXMueiAvIHM7CiAgICAgIH0KCiAgICAgIHJldHVybiBbdGFyZ2V0QXhpcywgYW5nbGVdOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIHF1YXRlcm5pb24gdmFsdWUgZ2l2ZW4gdHdvIHZlY3RvcnMuIFRoZSByZXN1bHRpbmcgcm90YXRpb24gd2lsbCBiZSB0aGUgbmVlZGVkIHJvdGF0aW9uIHRvIHJvdGF0ZSB1IHRvIHYuCiAgICAgKi8KCgogICAgc2V0RnJvbVZlY3RvcnModSwgdikgewogICAgICBpZiAodS5pc0FudGlwYXJhbGxlbFRvKHYpKSB7CiAgICAgICAgY29uc3QgdDEgPSBzZnZfdDE7CiAgICAgICAgY29uc3QgdDIgPSBzZnZfdDI7CiAgICAgICAgdS50YW5nZW50cyh0MSwgdDIpOwogICAgICAgIHRoaXMuc2V0RnJvbUF4aXNBbmdsZSh0MSwgTWF0aC5QSSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgYSA9IHUuY3Jvc3Modik7CiAgICAgICAgdGhpcy54ID0gYS54OwogICAgICAgIHRoaXMueSA9IGEueTsKICAgICAgICB0aGlzLnogPSBhLno7CiAgICAgICAgdGhpcy53ID0gTWF0aC5zcXJ0KHUubGVuZ3RoKCkgKiogMiAqIHYubGVuZ3RoKCkgKiogMikgKyB1LmRvdCh2KTsKICAgICAgICB0aGlzLm5vcm1hbGl6ZSgpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogTXVsdGlwbHkgdGhlIHF1YXRlcm5pb24gd2l0aCBhbiBvdGhlciBxdWF0ZXJuaW9uLgogICAgICovCgoKICAgIG11bHQocXVhdCwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF4ID0gdGhpcy54OwogICAgICBjb25zdCBheSA9IHRoaXMueTsKICAgICAgY29uc3QgYXogPSB0aGlzLno7CiAgICAgIGNvbnN0IGF3ID0gdGhpcy53OwogICAgICBjb25zdCBieCA9IHF1YXQueDsKICAgICAgY29uc3QgYnkgPSBxdWF0Lnk7CiAgICAgIGNvbnN0IGJ6ID0gcXVhdC56OwogICAgICBjb25zdCBidyA9IHF1YXQudzsKICAgICAgdGFyZ2V0LnggPSBheCAqIGJ3ICsgYXcgKiBieCArIGF5ICogYnogLSBheiAqIGJ5OwogICAgICB0YXJnZXQueSA9IGF5ICogYncgKyBhdyAqIGJ5ICsgYXogKiBieCAtIGF4ICogYno7CiAgICAgIHRhcmdldC56ID0gYXogKiBidyArIGF3ICogYnogKyBheCAqIGJ5IC0gYXkgKiBieDsKICAgICAgdGFyZ2V0LncgPSBhdyAqIGJ3IC0gYXggKiBieCAtIGF5ICogYnkgLSBheiAqIGJ6OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGludmVyc2UgcXVhdGVybmlvbiByb3RhdGlvbi4KICAgICAqLwoKCiAgICBpbnZlcnNlKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgUXVhdGVybmlvbigpOwogICAgICB9CgogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICBjb25zdCB3ID0gdGhpcy53OwogICAgICB0aGlzLmNvbmp1Z2F0ZSh0YXJnZXQpOwogICAgICBjb25zdCBpbm9ybTIgPSAxIC8gKHggKiB4ICsgeSAqIHkgKyB6ICogeiArIHcgKiB3KTsKICAgICAgdGFyZ2V0LnggKj0gaW5vcm0yOwogICAgICB0YXJnZXQueSAqPSBpbm9ybTI7CiAgICAgIHRhcmdldC56ICo9IGlub3JtMjsKICAgICAgdGFyZ2V0LncgKj0gaW5vcm0yOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHF1YXRlcm5pb24gY29uanVnYXRlCiAgICAgKi8KCgogICAgY29uanVnYXRlKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgUXVhdGVybmlvbigpOwogICAgICB9CgogICAgICB0YXJnZXQueCA9IC10aGlzLng7CiAgICAgIHRhcmdldC55ID0gLXRoaXMueTsKICAgICAgdGFyZ2V0LnogPSAtdGhpcy56OwogICAgICB0YXJnZXQudyA9IHRoaXMudzsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTm9ybWFsaXplIHRoZSBxdWF0ZXJuaW9uLiBOb3RlIHRoYXQgdGhpcyBjaGFuZ2VzIHRoZSB2YWx1ZXMgb2YgdGhlIHF1YXRlcm5pb24uCiAgICAgKi8KCgogICAgbm9ybWFsaXplKCkgewogICAgICBsZXQgbCA9IE1hdGguc3FydCh0aGlzLnggKiB0aGlzLnggKyB0aGlzLnkgKiB0aGlzLnkgKyB0aGlzLnogKiB0aGlzLnogKyB0aGlzLncgKiB0aGlzLncpOwoKICAgICAgaWYgKGwgPT09IDApIHsKICAgICAgICB0aGlzLnggPSAwOwogICAgICAgIHRoaXMueSA9IDA7CiAgICAgICAgdGhpcy56ID0gMDsKICAgICAgICB0aGlzLncgPSAwOwogICAgICB9IGVsc2UgewogICAgICAgIGwgPSAxIC8gbDsKICAgICAgICB0aGlzLnggKj0gbDsKICAgICAgICB0aGlzLnkgKj0gbDsKICAgICAgICB0aGlzLnogKj0gbDsKICAgICAgICB0aGlzLncgKj0gbDsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIEFwcHJveGltYXRpb24gb2YgcXVhdGVybmlvbiBub3JtYWxpemF0aW9uLiBXb3JrcyBiZXN0IHdoZW4gcXVhdCBpcyBhbHJlYWR5IGFsbW9zdC1ub3JtYWxpemVkLgogICAgICogQGF1dGhvciB1bnBoYXNlZCwgaHR0cHM6Ly9naXRodWIuY29tL3VucGhhc2VkCiAgICAgKi8KCgogICAgbm9ybWFsaXplRmFzdCgpIHsKICAgICAgY29uc3QgZiA9ICgzLjAgLSAodGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55ICsgdGhpcy56ICogdGhpcy56ICsgdGhpcy53ICogdGhpcy53KSkgLyAyLjA7CgogICAgICBpZiAoZiA9PT0gMCkgewogICAgICAgIHRoaXMueCA9IDA7CiAgICAgICAgdGhpcy55ID0gMDsKICAgICAgICB0aGlzLnogPSAwOwogICAgICAgIHRoaXMudyA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy54ICo9IGY7CiAgICAgICAgdGhpcy55ICo9IGY7CiAgICAgICAgdGhpcy56ICo9IGY7CiAgICAgICAgdGhpcy53ICo9IGY7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB0aGUgcXVhdGVybmlvbiBieSBhIHZlY3RvcgogICAgICovCgoKICAgIHZtdWx0KHYsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBjb25zdCB4ID0gdi54OwogICAgICBjb25zdCB5ID0gdi55OwogICAgICBjb25zdCB6ID0gdi56OwogICAgICBjb25zdCBxeCA9IHRoaXMueDsKICAgICAgY29uc3QgcXkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHF6ID0gdGhpcy56OwogICAgICBjb25zdCBxdyA9IHRoaXMudzsgLy8gcSp2CgogICAgICBjb25zdCBpeCA9IHF3ICogeCArIHF5ICogeiAtIHF6ICogeTsKICAgICAgY29uc3QgaXkgPSBxdyAqIHkgKyBxeiAqIHggLSBxeCAqIHo7CiAgICAgIGNvbnN0IGl6ID0gcXcgKiB6ICsgcXggKiB5IC0gcXkgKiB4OwogICAgICBjb25zdCBpdyA9IC1xeCAqIHggLSBxeSAqIHkgLSBxeiAqIHo7CiAgICAgIHRhcmdldC54ID0gaXggKiBxdyArIGl3ICogLXF4ICsgaXkgKiAtcXogLSBpeiAqIC1xeTsKICAgICAgdGFyZ2V0LnkgPSBpeSAqIHF3ICsgaXcgKiAtcXkgKyBpeiAqIC1xeCAtIGl4ICogLXF6OwogICAgICB0YXJnZXQueiA9IGl6ICogcXcgKyBpdyAqIC1xeiArIGl4ICogLXF5IC0gaXkgKiAtcXg7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIENvcGllcyB2YWx1ZSBvZiBzb3VyY2UgdG8gdGhpcyBxdWF0ZXJuaW9uLgogICAgICogQHJldHVybiB0aGlzCiAgICAgKi8KCgogICAgY29weShxdWF0KSB7CiAgICAgIHRoaXMueCA9IHF1YXQueDsKICAgICAgdGhpcy55ID0gcXVhdC55OwogICAgICB0aGlzLnogPSBxdWF0Lno7CiAgICAgIHRoaXMudyA9IHF1YXQudzsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHF1YXRlcm5pb24gdG8gZXVsZXIgYW5nbGUgcmVwcmVzZW50YXRpb24uIE9yZGVyOiBZWlgsIGFzIHRoaXMgcGFnZSBkZXNjcmliZXM6IGh0dHBzOi8vd3d3LmV1Y2xpZGVhbnNwYWNlLmNvbS9tYXRocy9zdGFuZGFyZHMvaW5kZXguaHRtCiAgICAgKiBAcGFyYW0gb3JkZXIgVGhyZWUtY2hhcmFjdGVyIHN0cmluZywgZGVmYXVsdHMgdG8gIllaWCIKICAgICAqLwoKCiAgICB0b0V1bGVyKHRhcmdldCwgb3JkZXIpIHsKICAgICAgaWYgKG9yZGVyID09PSB2b2lkIDApIHsKICAgICAgICBvcmRlciA9ICdZWlgnOwogICAgICB9CgogICAgICBsZXQgaGVhZGluZzsKICAgICAgbGV0IGF0dGl0dWRlOwogICAgICBsZXQgYmFuazsKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgY29uc3QgdyA9IHRoaXMudzsKCiAgICAgIHN3aXRjaCAob3JkZXIpIHsKICAgICAgICBjYXNlICdZWlgnOgogICAgICAgICAgY29uc3QgdGVzdCA9IHggKiB5ICsgeiAqIHc7CgogICAgICAgICAgaWYgKHRlc3QgPiAwLjQ5OSkgewogICAgICAgICAgICAvLyBzaW5ndWxhcml0eSBhdCBub3J0aCBwb2xlCiAgICAgICAgICAgIGhlYWRpbmcgPSAyICogTWF0aC5hdGFuMih4LCB3KTsKICAgICAgICAgICAgYXR0aXR1ZGUgPSBNYXRoLlBJIC8gMjsKICAgICAgICAgICAgYmFuayA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRlc3QgPCAtMC40OTkpIHsKICAgICAgICAgICAgLy8gc2luZ3VsYXJpdHkgYXQgc291dGggcG9sZQogICAgICAgICAgICBoZWFkaW5nID0gLTIgKiBNYXRoLmF0YW4yKHgsIHcpOwogICAgICAgICAgICBhdHRpdHVkZSA9IC1NYXRoLlBJIC8gMjsKICAgICAgICAgICAgYmFuayA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGhlYWRpbmcgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjb25zdCBzcXggPSB4ICogeDsKICAgICAgICAgICAgY29uc3Qgc3F5ID0geSAqIHk7CiAgICAgICAgICAgIGNvbnN0IHNxeiA9IHogKiB6OwogICAgICAgICAgICBoZWFkaW5nID0gTWF0aC5hdGFuMigyICogeSAqIHcgLSAyICogeCAqIHosIDEgLSAyICogc3F5IC0gMiAqIHNxeik7IC8vIEhlYWRpbmcKCiAgICAgICAgICAgIGF0dGl0dWRlID0gTWF0aC5hc2luKDIgKiB0ZXN0KTsgLy8gYXR0aXR1ZGUKCiAgICAgICAgICAgIGJhbmsgPSBNYXRoLmF0YW4yKDIgKiB4ICogdyAtIDIgKiB5ICogeiwgMSAtIDIgKiBzcXggLSAyICogc3F6KTsgLy8gYmFuawogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFdWxlciBvcmRlciAke29yZGVyfSBub3Qgc3VwcG9ydGVkIHlldC5gKTsKICAgICAgfQoKICAgICAgdGFyZ2V0LnkgPSBoZWFkaW5nOwogICAgICB0YXJnZXQueiA9IGF0dGl0dWRlOwogICAgICB0YXJnZXQueCA9IGJhbms7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgcXVhdGVybmlvbiBjb21wb25lbnRzIGdpdmVuIEV1bGVyIGFuZ2xlIHJlcHJlc2VudGF0aW9uLgogICAgICoKICAgICAqIEBwYXJhbSBvcmRlciBUaGUgb3JkZXIgdG8gYXBwbHkgYW5nbGVzOiAnWFlaJyBvciAnWVhaJyBvciBhbnkgb3RoZXIgY29tYmluYXRpb24uCiAgICAgKgogICAgICogU2VlIHtAbGluayBodHRwczovL3d3dy5tYXRod29ya3MuY29tL21hdGxhYmNlbnRyYWwvZmlsZWV4Y2hhbmdlLzIwNjk2LWZ1bmN0aW9uLXRvLWNvbnZlcnQtYmV0d2Vlbi1kY20tZXVsZXItYW5nbGVzLXF1YXRlcm5pb25zLWFuZC1ldWxlci12ZWN0b3JzIE1hdGhXb3Jrc30gcmVmZXJlbmNlCiAgICAgKi8KCgogICAgc2V0RnJvbUV1bGVyKHgsIHksIHosIG9yZGVyKSB7CiAgICAgIGlmIChvcmRlciA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3JkZXIgPSAnWFlaJzsKICAgICAgfQoKICAgICAgY29uc3QgYzEgPSBNYXRoLmNvcyh4IC8gMik7CiAgICAgIGNvbnN0IGMyID0gTWF0aC5jb3MoeSAvIDIpOwogICAgICBjb25zdCBjMyA9IE1hdGguY29zKHogLyAyKTsKICAgICAgY29uc3QgczEgPSBNYXRoLnNpbih4IC8gMik7CiAgICAgIGNvbnN0IHMyID0gTWF0aC5zaW4oeSAvIDIpOwogICAgICBjb25zdCBzMyA9IE1hdGguc2luKHogLyAyKTsKCiAgICAgIGlmIChvcmRlciA9PT0gJ1hZWicpIHsKICAgICAgICB0aGlzLnggPSBzMSAqIGMyICogYzMgKyBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy55ID0gYzEgKiBzMiAqIGMzIC0gczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMueiA9IGMxICogYzIgKiBzMyArIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLncgPSBjMSAqIGMyICogYzMgLSBzMSAqIHMyICogczM7CiAgICAgIH0gZWxzZSBpZiAob3JkZXIgPT09ICdZWFonKSB7CiAgICAgICAgdGhpcy54ID0gczEgKiBjMiAqIGMzICsgYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMueSA9IGMxICogczIgKiBjMyAtIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLnogPSBjMSAqIGMyICogczMgLSBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy53ID0gYzEgKiBjMiAqIGMzICsgczEgKiBzMiAqIHMzOwogICAgICB9IGVsc2UgaWYgKG9yZGVyID09PSAnWlhZJykgewogICAgICAgIHRoaXMueCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLnkgPSBjMSAqIHMyICogYzMgKyBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy56ID0gYzEgKiBjMiAqIHMzICsgczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMudyA9IGMxICogYzIgKiBjMyAtIHMxICogczIgKiBzMzsKICAgICAgfSBlbHNlIGlmIChvcmRlciA9PT0gJ1pZWCcpIHsKICAgICAgICB0aGlzLnggPSBzMSAqIGMyICogYzMgLSBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy55ID0gYzEgKiBzMiAqIGMzICsgczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMueiA9IGMxICogYzIgKiBzMyAtIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLncgPSBjMSAqIGMyICogYzMgKyBzMSAqIHMyICogczM7CiAgICAgIH0gZWxzZSBpZiAob3JkZXIgPT09ICdZWlgnKSB7CiAgICAgICAgdGhpcy54ID0gczEgKiBjMiAqIGMzICsgYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMueSA9IGMxICogczIgKiBjMyArIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLnogPSBjMSAqIGMyICogczMgLSBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy53ID0gYzEgKiBjMiAqIGMzIC0gczEgKiBzMiAqIHMzOwogICAgICB9IGVsc2UgaWYgKG9yZGVyID09PSAnWFpZJykgewogICAgICAgIHRoaXMueCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLnkgPSBjMSAqIHMyICogYzMgLSBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy56ID0gYzEgKiBjMiAqIHMzICsgczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMudyA9IGMxICogYzIgKiBjMyArIHMxICogczIgKiBzMzsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgY2xvbmUoKSB7CiAgICAgIHJldHVybiBuZXcgUXVhdGVybmlvbih0aGlzLngsIHRoaXMueSwgdGhpcy56LCB0aGlzLncpOwogICAgfQogICAgLyoqCiAgICAgKiBQZXJmb3JtcyBhIHNwaGVyaWNhbCBsaW5lYXIgaW50ZXJwb2xhdGlvbiBiZXR3ZWVuIHR3byBxdWF0CiAgICAgKgogICAgICogQHBhcmFtIHRvUXVhdCBzZWNvbmQgb3BlcmFuZAogICAgICogQHBhcmFtIHQgaW50ZXJwb2xhdGlvbiBhbW91bnQgYmV0d2VlbiB0aGUgc2VsZiBxdWF0ZXJuaW9uIGFuZCB0b1F1YXQKICAgICAqIEBwYXJhbSB0YXJnZXQgQSBxdWF0ZXJuaW9uIHRvIHN0b3JlIHRoZSByZXN1bHQgaW4uIElmIG5vdCBwcm92aWRlZCwgYSBuZXcgb25lIHdpbGwgYmUgY3JlYXRlZC4KICAgICAqIEByZXR1cm5zIHtRdWF0ZXJuaW9ufSBUaGUgInRhcmdldCIgb2JqZWN0CiAgICAgKi8KCgogICAgc2xlcnAodG9RdWF0LCB0LCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgfQoKICAgICAgY29uc3QgYXggPSB0aGlzLng7CiAgICAgIGNvbnN0IGF5ID0gdGhpcy55OwogICAgICBjb25zdCBheiA9IHRoaXMuejsKICAgICAgY29uc3QgYXcgPSB0aGlzLnc7CiAgICAgIGxldCBieCA9IHRvUXVhdC54OwogICAgICBsZXQgYnkgPSB0b1F1YXQueTsKICAgICAgbGV0IGJ6ID0gdG9RdWF0Lno7CiAgICAgIGxldCBidyA9IHRvUXVhdC53OwogICAgICBsZXQgb21lZ2E7CiAgICAgIGxldCBjb3NvbTsKICAgICAgbGV0IHNpbm9tOwogICAgICBsZXQgc2NhbGUwOwogICAgICBsZXQgc2NhbGUxOyAvLyBjYWxjIGNvc2luZQoKICAgICAgY29zb20gPSBheCAqIGJ4ICsgYXkgKiBieSArIGF6ICogYnogKyBhdyAqIGJ3OyAvLyBhZGp1c3Qgc2lnbnMgKGlmIG5lY2Vzc2FyeSkKCiAgICAgIGlmIChjb3NvbSA8IDAuMCkgewogICAgICAgIGNvc29tID0gLWNvc29tOwogICAgICAgIGJ4ID0gLWJ4OwogICAgICAgIGJ5ID0gLWJ5OwogICAgICAgIGJ6ID0gLWJ6OwogICAgICAgIGJ3ID0gLWJ3OwogICAgICB9IC8vIGNhbGN1bGF0ZSBjb2VmZmljaWVudHMKCgogICAgICBpZiAoMS4wIC0gY29zb20gPiAwLjAwMDAwMSkgewogICAgICAgIC8vIHN0YW5kYXJkIGNhc2UgKHNsZXJwKQogICAgICAgIG9tZWdhID0gTWF0aC5hY29zKGNvc29tKTsKICAgICAgICBzaW5vbSA9IE1hdGguc2luKG9tZWdhKTsKICAgICAgICBzY2FsZTAgPSBNYXRoLnNpbigoMS4wIC0gdCkgKiBvbWVnYSkgLyBzaW5vbTsKICAgICAgICBzY2FsZTEgPSBNYXRoLnNpbih0ICogb21lZ2EpIC8gc2lub207CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gImZyb20iIGFuZCAidG8iIHF1YXRlcm5pb25zIGFyZSB2ZXJ5IGNsb3NlCiAgICAgICAgLy8gIC4uLiBzbyB3ZSBjYW4gZG8gYSBsaW5lYXIgaW50ZXJwb2xhdGlvbgogICAgICAgIHNjYWxlMCA9IDEuMCAtIHQ7CiAgICAgICAgc2NhbGUxID0gdDsKICAgICAgfSAvLyBjYWxjdWxhdGUgZmluYWwgdmFsdWVzCgoKICAgICAgdGFyZ2V0LnggPSBzY2FsZTAgKiBheCArIHNjYWxlMSAqIGJ4OwogICAgICB0YXJnZXQueSA9IHNjYWxlMCAqIGF5ICsgc2NhbGUxICogYnk7CiAgICAgIHRhcmdldC56ID0gc2NhbGUwICogYXogKyBzY2FsZTEgKiBiejsKICAgICAgdGFyZ2V0LncgPSBzY2FsZTAgKiBhdyArIHNjYWxlMSAqIGJ3OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBSb3RhdGUgYW4gYWJzb2x1dGUgb3JpZW50YXRpb24gcXVhdGVybmlvbiBnaXZlbiBhbiBhbmd1bGFyIHZlbG9jaXR5IGFuZCBhIHRpbWUgc3RlcC4KICAgICAqLwoKCiAgICBpbnRlZ3JhdGUoYW5ndWxhclZlbG9jaXR5LCBkdCwgYW5ndWxhckZhY3RvciwgdGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF4ID0gYW5ndWxhclZlbG9jaXR5LnggKiBhbmd1bGFyRmFjdG9yLngsCiAgICAgICAgICAgIGF5ID0gYW5ndWxhclZlbG9jaXR5LnkgKiBhbmd1bGFyRmFjdG9yLnksCiAgICAgICAgICAgIGF6ID0gYW5ndWxhclZlbG9jaXR5LnogKiBhbmd1bGFyRmFjdG9yLnosCiAgICAgICAgICAgIGJ4ID0gdGhpcy54LAogICAgICAgICAgICBieSA9IHRoaXMueSwKICAgICAgICAgICAgYnogPSB0aGlzLnosCiAgICAgICAgICAgIGJ3ID0gdGhpcy53OwogICAgICBjb25zdCBoYWxmX2R0ID0gZHQgKiAwLjU7CiAgICAgIHRhcmdldC54ICs9IGhhbGZfZHQgKiAoYXggKiBidyArIGF5ICogYnogLSBheiAqIGJ5KTsKICAgICAgdGFyZ2V0LnkgKz0gaGFsZl9kdCAqIChheSAqIGJ3ICsgYXogKiBieCAtIGF4ICogYnopOwogICAgICB0YXJnZXQueiArPSBoYWxmX2R0ICogKGF6ICogYncgKyBheCAqIGJ5IC0gYXkgKiBieCk7CiAgICAgIHRhcmdldC53ICs9IGhhbGZfZHQgKiAoLWF4ICogYnggLSBheSAqIGJ5IC0gYXogKiBieik7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CgogIH0KICBjb25zdCBzZnZfdDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNmdl90MiA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIFRoZSBhdmFpbGFibGUgc2hhcGUgdHlwZXMuCiAgICovCiAgY29uc3QgU0hBUEVfVFlQRVMgPSB7CiAgICAvKiogU1BIRVJFICovCiAgICBTUEhFUkU6IDEsCgogICAgLyoqIFBMQU5FICovCiAgICBQTEFORTogMiwKCiAgICAvKiogQk9YICovCiAgICBCT1g6IDQsCgogICAgLyoqIENPTVBPVU5EICovCiAgICBDT01QT1VORDogOCwKCiAgICAvKiogQ09OVkVYUE9MWUhFRFJPTiAqLwogICAgQ09OVkVYUE9MWUhFRFJPTjogMTYsCgogICAgLyoqIEhFSUdIVEZJRUxEICovCiAgICBIRUlHSFRGSUVMRDogMzIsCgogICAgLyoqIFBBUlRJQ0xFICovCiAgICBQQVJUSUNMRTogNjQsCgogICAgLyoqIENZTElOREVSICovCiAgICBDWUxJTkRFUjogMTI4LAoKICAgIC8qKiBUUklNRVNIICovCiAgICBUUklNRVNIOiAyNTYKICB9OwogIC8qKgogICAqIFNoYXBlVHlwZQogICAqLwoKICAvKioKICAgKiBCYXNlIGNsYXNzIGZvciBzaGFwZXMKICAgKi8KICBjbGFzcyBTaGFwZSB7CiAgICAvKioKICAgICAqIElkZW50aWZpZXIgb2YgdGhlIFNoYXBlLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgdHlwZSBvZiB0aGlzIHNoYXBlLiBNdXN0IGJlIHNldCB0byBhbiBpbnQgPiAwIGJ5IHN1YmNsYXNzZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBsb2NhbCBib3VuZGluZyBzcGhlcmUgcmFkaXVzIG9mIHRoaXMgc2hhcGUuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gcHJvZHVjZSBjb250YWN0IGZvcmNlcyB3aGVuIGluIGNvbnRhY3Qgd2l0aCBvdGhlciBib2RpZXMuIE5vdGUgdGhhdCBjb250YWN0cyB3aWxsIGJlIGdlbmVyYXRlZCwgYnV0IHRoZXkgd2lsbCBiZSBkaXNhYmxlZC4KICAgICAqIEBkZWZhdWx0IHRydWUKICAgICAqLwoKICAgIC8qKgogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBAZGVmYXVsdCAtMQogICAgICovCgogICAgLyoqCiAgICAgKiBPcHRpb25hbCBtYXRlcmlhbCBvZiB0aGUgc2hhcGUgdGhhdCByZWd1bGF0ZXMgY29udGFjdCBwcm9wZXJ0aWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgYm9keSB0byB3aGljaCB0aGUgc2hhcGUgaXMgYWRkZWQgdG8uCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFsbCB0aGUgU2hhcGUgdHlwZXMuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgdGhpcy5pZCA9IFNoYXBlLmlkQ291bnRlcisrOwogICAgICB0aGlzLnR5cGUgPSBvcHRpb25zLnR5cGUgfHwgMDsKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IDA7CiAgICAgIHRoaXMuY29sbGlzaW9uUmVzcG9uc2UgPSBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlID8gb3B0aW9ucy5jb2xsaXNpb25SZXNwb25zZSA6IHRydWU7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrID0gb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJNYXNrICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgOiAtMTsKICAgICAgdGhpcy5tYXRlcmlhbCA9IG9wdGlvbnMubWF0ZXJpYWwgPyBvcHRpb25zLm1hdGVyaWFsIDogbnVsbDsKICAgICAgdGhpcy5ib2R5ID0gbnVsbDsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZXMgdGhlIGJvdW5kaW5nIHNwaGVyZSByYWRpdXMuCiAgICAgKiBUaGUgcmVzdWx0IGlzIHN0b3JlZCBpbiB0aGUgcHJvcGVydHkgYC5ib3VuZGluZ1NwaGVyZVJhZGl1c2AKICAgICAqLwoKCiAgICB1cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIHsKICAgICAgdGhyb3cgYGNvbXB1dGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIG5vdCBpbXBsZW1lbnRlZCBmb3Igc2hhcGUgdHlwZSAke3RoaXMudHlwZX1gOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHZvbHVtZSBvZiB0aGlzIHNoYXBlCiAgICAgKi8KCgogICAgdm9sdW1lKCkgewogICAgICB0aHJvdyBgdm9sdW1lKCkgbm90IGltcGxlbWVudGVkIGZvciBzaGFwZSB0eXBlICR7dGhpcy50eXBlfWA7CiAgICB9CiAgICAvKioKICAgICAqIENhbGN1bGF0ZXMgdGhlIGluZXJ0aWEgaW4gdGhlIGxvY2FsIGZyYW1lIGZvciB0aGlzIHNoYXBlLgogICAgICogQHNlZSBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0xpc3Rfb2ZfbW9tZW50c19vZl9pbmVydGlhCiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICB0aHJvdyBgY2FsY3VsYXRlTG9jYWxJbmVydGlhKCkgbm90IGltcGxlbWVudGVkIGZvciBzaGFwZSB0eXBlICR7dGhpcy50eXBlfWA7CiAgICB9CiAgICAvKioKICAgICAqIEB0b2RvIHVzZSBhYnN0cmFjdCBmb3IgdGhlc2Uga2luZCBvZiBtZXRob2RzCiAgICAgKi8KCgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgdGhyb3cgYGNhbGN1bGF0ZVdvcmxkQUFCQigpIG5vdCBpbXBsZW1lbnRlZCBmb3Igc2hhcGUgdHlwZSAke3RoaXMudHlwZX1gOwogICAgfQoKICB9CiAgU2hhcGUuaWRDb3VudGVyID0gMDsKICBTaGFwZS50eXBlcyA9IFNIQVBFX1RZUEVTOwoKICAvKioKICAgKiBUcmFuc2Zvcm1hdGlvbiB1dGlsaXRpZXMuCiAgICovCiAgY2xhc3MgVHJhbnNmb3JtIHsKICAgIC8qKgogICAgICogcG9zaXRpb24KICAgICAqLwoKICAgIC8qKgogICAgICogcXVhdGVybmlvbgogICAgICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIHRoaXMucG9zaXRpb24gPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnF1YXRlcm5pb24gPSBuZXcgUXVhdGVybmlvbigpOwoKICAgICAgaWYgKG9wdGlvbnMucG9zaXRpb24pIHsKICAgICAgICB0aGlzLnBvc2l0aW9uLmNvcHkob3B0aW9ucy5wb3NpdGlvbik7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLnF1YXRlcm5pb24pIHsKICAgICAgICB0aGlzLnF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIGdsb2JhbCBwb2ludCBpbiBsb2NhbCB0cmFuc2Zvcm0gY29vcmRpbmF0ZXMuCiAgICAgKi8KCgogICAgcG9pbnRUb0xvY2FsKHdvcmxkUG9pbnQsIHJlc3VsdCkgewogICAgICByZXR1cm4gVHJhbnNmb3JtLnBvaW50VG9Mb2NhbEZyYW1lKHRoaXMucG9zaXRpb24sIHRoaXMucXVhdGVybmlvbiwgd29ybGRQb2ludCwgcmVzdWx0KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGEgbG9jYWwgcG9pbnQgaW4gZ2xvYmFsIHRyYW5zZm9ybSBjb29yZGluYXRlcy4KICAgICAqLwoKCiAgICBwb2ludFRvV29ybGQobG9jYWxQb2ludCwgcmVzdWx0KSB7CiAgICAgIHJldHVybiBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUodGhpcy5wb3NpdGlvbiwgdGhpcy5xdWF0ZXJuaW9uLCBsb2NhbFBvaW50LCByZXN1bHQpOwogICAgfQogICAgLyoqCiAgICAgKiB2ZWN0b3JUb1dvcmxkRnJhbWUKICAgICAqLwoKCiAgICB2ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxWZWN0b3IsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0aGlzLnF1YXRlcm5pb24udm11bHQobG9jYWxWZWN0b3IsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIHBvaW50VG9Mb2NhbEZyYW1lCiAgICAgKi8KCgogICAgc3RhdGljIHBvaW50VG9Mb2NhbEZyYW1lKHBvc2l0aW9uLCBxdWF0ZXJuaW9uLCB3b3JsZFBvaW50LCByZXN1bHQpIHsKICAgICAgaWYgKHJlc3VsdCA9PT0gdm9pZCAwKSB7CiAgICAgICAgcmVzdWx0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgd29ybGRQb2ludC52c3ViKHBvc2l0aW9uLCByZXN1bHQpOwogICAgICBxdWF0ZXJuaW9uLmNvbmp1Z2F0ZSh0bXBRdWF0JDEpOwogICAgICB0bXBRdWF0JDEudm11bHQocmVzdWx0LCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBwb2ludFRvV29ybGRGcmFtZQogICAgICovCgoKICAgIHN0YXRpYyBwb2ludFRvV29ybGRGcmFtZShwb3NpdGlvbiwgcXVhdGVybmlvbiwgbG9jYWxQb2ludCwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHF1YXRlcm5pb24udm11bHQobG9jYWxQb2ludCwgcmVzdWx0KTsKICAgICAgcmVzdWx0LnZhZGQocG9zaXRpb24sIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIHZlY3RvclRvV29ybGRGcmFtZQogICAgICovCgoKICAgIHN0YXRpYyB2ZWN0b3JUb1dvcmxkRnJhbWUocXVhdGVybmlvbiwgbG9jYWxWZWN0b3IsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBxdWF0ZXJuaW9uLnZtdWx0KGxvY2FsVmVjdG9yLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiB2ZWN0b3JUb0xvY2FsRnJhbWUKICAgICAqLwoKCiAgICBzdGF0aWMgdmVjdG9yVG9Mb2NhbEZyYW1lKHBvc2l0aW9uLCBxdWF0ZXJuaW9uLCB3b3JsZFZlY3RvciwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHF1YXRlcm5pb24udyAqPSAtMTsKICAgICAgcXVhdGVybmlvbi52bXVsdCh3b3JsZFZlY3RvciwgcmVzdWx0KTsKICAgICAgcXVhdGVybmlvbi53ICo9IC0xOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICB9CiAgY29uc3QgdG1wUXVhdCQxID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgLyoqCiAgICogQSBzZXQgb2YgcG9seWdvbnMgZGVzY3JpYmluZyBhIGNvbnZleCBzaGFwZS4KICAgKgogICAqIFRoZSBzaGFwZSBNVVNUIGJlIGNvbnZleCBmb3IgdGhlIGNvZGUgdG8gd29yayBwcm9wZXJseS4gTm8gcG9seWdvbnMgbWF5IGJlIGNvcGxhbmFyIChjb250YWluZWQKICAgKiBpbiB0aGUgc2FtZSAzRCBwbGFuZSksIGluc3RlYWQgdGhlc2Ugc2hvdWxkIGJlIG1lcmdlZCBpbnRvIG9uZSBwb2x5Z29uLgogICAqCiAgICogQGF1dGhvciBxaWFvIC8gaHR0cHM6Ly9naXRodWIuY29tL3FpYW8gKG9yaWdpbmFsIGF1dGhvciwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9xaWFvL3RocmVlLmpzL2NvbW1pdC84NTAyNmYwYzc2OWU0MDAwMTQ4YTY3ZDQ1YTllOWI5YzUxMDg4MzZmKQogICAqIEBhdXRob3Igc2NodGVwcGUgLyBodHRwczovL2dpdGh1Yi5jb20vc2NodGVwcGUKICAgKiBAc2VlIGh0dHBzOi8vd3d3LmFsdGRldmJsb2dhZGF5LmNvbS8yMDExLzA1LzEzL2NvbnRhY3QtZ2VuZXJhdGlvbi1iZXR3ZWVuLTNkLWNvbnZleC1tZXNoZXMvCiAgICoKICAgKiBAdG9kbyBNb3ZlIHRoZSBjbGlwcGluZyBmdW5jdGlvbnMgdG8gQ29udGFjdEdlbmVyYXRvcj8KICAgKiBAdG9kbyBBdXRvbWF0aWNhbGx5IG1lcmdlIGNvcGxhbmFyIHBvbHlnb25zIGluIGNvbnN0cnVjdG9yLgogICAqIEBleGFtcGxlCiAgICogICAgIGNvbnN0IGNvbnZleFNoYXBlID0gbmV3IENBTk5PTi5Db252ZXhQb2x5aGVkcm9uKHsgdmVydGljZXMsIGZhY2VzIH0pCiAgICogICAgIGNvbnN0IGNvbnZleEJvZHkgPSBuZXcgQ0FOTk9OLkJvZHkoeyBtYXNzOiAxLCBzaGFwZTogY29udmV4U2hhcGUgfSkKICAgKiAgICAgd29ybGQuYWRkQm9keShjb252ZXhCb2R5KQogICAqLwogIGNsYXNzIENvbnZleFBvbHloZWRyb24gZXh0ZW5kcyBTaGFwZSB7CiAgICAvKiogdmVydGljZXMgKi8KCiAgICAvKioKICAgICAqIEFycmF5IG9mIGludGVnZXIgYXJyYXlzLCBpbmRpY2F0aW5nIHdoaWNoIHZlcnRpY2VzIGVhY2ggZmFjZSBjb25zaXN0cyBvZgogICAgICovCgogICAgLyoqIGZhY2VOb3JtYWxzICovCgogICAgLyoqIHdvcmxkVmVydGljZXMgKi8KCiAgICAvKiogd29ybGRWZXJ0aWNlc05lZWRzVXBkYXRlICovCgogICAgLyoqIHdvcmxkRmFjZU5vcm1hbHMgKi8KCiAgICAvKiogd29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlICovCgogICAgLyoqCiAgICAgKiBJZiBnaXZlbiwgdGhlc2UgbG9jYWxseSBkZWZpbmVkLCBub3JtYWxpemVkIGF4ZXMgYXJlIHRoZSBvbmx5IG9uZXMgYmVpbmcgY2hlY2tlZCB3aGVuIGRvaW5nIHNlcGFyYXRpbmcgYXhpcyBjaGVjay4KICAgICAqLwoKICAgIC8qKiB1bmlxdWVFZGdlcyAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIHZlcnRpY2VzIEFuIGFycmF5IG9mIFZlYzMncwogICAgICogQHBhcmFtIGZhY2VzIEFycmF5IG9mIGludGVnZXIgYXJyYXlzLCBkZXNjcmliaW5nIHdoaWNoIHZlcnRpY2VzIHRoYXQgaXMgaW5jbHVkZWQgaW4gZWFjaCBmYWNlLgogICAgICovCiAgICBjb25zdHJ1Y3Rvcihwcm9wcykgewogICAgICBpZiAocHJvcHMgPT09IHZvaWQgMCkgewogICAgICAgIHByb3BzID0ge307CiAgICAgIH0KCiAgICAgIGNvbnN0IHsKICAgICAgICB2ZXJ0aWNlcyA9IFtdLAogICAgICAgIGZhY2VzID0gW10sCiAgICAgICAgbm9ybWFscyA9IFtdLAogICAgICAgIGF4ZXMsCiAgICAgICAgYm91bmRpbmdTcGhlcmVSYWRpdXMKICAgICAgfSA9IHByb3BzOwogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTgogICAgICB9KTsKICAgICAgdGhpcy52ZXJ0aWNlcyA9IHZlcnRpY2VzOwogICAgICB0aGlzLmZhY2VzID0gZmFjZXM7CiAgICAgIHRoaXMuZmFjZU5vcm1hbHMgPSBub3JtYWxzOwoKICAgICAgaWYgKHRoaXMuZmFjZU5vcm1hbHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgdGhpcy5jb21wdXRlTm9ybWFscygpOwogICAgICB9CgogICAgICBpZiAoIWJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSBib3VuZGluZ1NwaGVyZVJhZGl1czsKICAgICAgfQoKICAgICAgdGhpcy53b3JsZFZlcnRpY2VzID0gW107IC8vIFdvcmxkIHRyYW5zZm9ybWVkIHZlcnNpb24gb2YgLnZlcnRpY2VzCgogICAgICB0aGlzLndvcmxkVmVydGljZXNOZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgIHRoaXMud29ybGRGYWNlTm9ybWFscyA9IFtdOyAvLyBXb3JsZCB0cmFuc2Zvcm1lZCB2ZXJzaW9uIG9mIC5mYWNlTm9ybWFscwoKICAgICAgdGhpcy53b3JsZEZhY2VOb3JtYWxzTmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICB0aGlzLnVuaXF1ZUF4ZXMgPSBheGVzID8gYXhlcy5zbGljZSgpIDogbnVsbDsKICAgICAgdGhpcy51bmlxdWVFZGdlcyA9IFtdOwogICAgICB0aGlzLmNvbXB1dGVFZGdlcygpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyB1bmlxdWVFZGdlcwogICAgICovCgoKICAgIGNvbXB1dGVFZGdlcygpIHsKICAgICAgY29uc3QgZmFjZXMgPSB0aGlzLmZhY2VzOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIGNvbnN0IGVkZ2VzID0gdGhpcy51bmlxdWVFZGdlczsKICAgICAgZWRnZXMubGVuZ3RoID0gMDsKICAgICAgY29uc3QgZWRnZSA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbaV07CiAgICAgICAgY29uc3QgbnVtVmVydGljZXMgPSBmYWNlLmxlbmd0aDsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IG51bVZlcnRpY2VzOyBqKyspIHsKICAgICAgICAgIGNvbnN0IGsgPSAoaiArIDEpICUgbnVtVmVydGljZXM7CiAgICAgICAgICB2ZXJ0aWNlc1tmYWNlW2pdXS52c3ViKHZlcnRpY2VzW2ZhY2Vba11dLCBlZGdlKTsKICAgICAgICAgIGVkZ2Uubm9ybWFsaXplKCk7CiAgICAgICAgICBsZXQgZm91bmQgPSBmYWxzZTsKCiAgICAgICAgICBmb3IgKGxldCBwID0gMDsgcCAhPT0gZWRnZXMubGVuZ3RoOyBwKyspIHsKICAgICAgICAgICAgaWYgKGVkZ2VzW3BdLmFsbW9zdEVxdWFscyhlZGdlKSB8fCBlZGdlc1twXS5hbG1vc3RFcXVhbHMoZWRnZSkpIHsKICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIWZvdW5kKSB7CiAgICAgICAgICAgIGVkZ2VzLnB1c2goZWRnZS5jbG9uZSgpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbm9ybWFscyBvZiB0aGUgZmFjZXMuCiAgICAgKiBXaWxsIHJldXNlIGV4aXN0aW5nIFZlYzMgb2JqZWN0cyBpbiB0aGUgYGZhY2VOb3JtYWxzYCBhcnJheSBpZiB0aGV5IGV4aXN0LgogICAgICovCgoKICAgIGNvbXB1dGVOb3JtYWxzKCkgewogICAgICB0aGlzLmZhY2VOb3JtYWxzLmxlbmd0aCA9IHRoaXMuZmFjZXMubGVuZ3RoOyAvLyBHZW5lcmF0ZSBub3JtYWxzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAvLyBDaGVjayBzbyBhbGwgdmVydGljZXMgZXhpc3RzIGZvciB0aGlzIGZhY2UKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuZmFjZXNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGlmICghdGhpcy52ZXJ0aWNlc1t0aGlzLmZhY2VzW2ldW2pdXSkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFZlcnRleCAke3RoaXMuZmFjZXNbaV1bal19IG5vdCBmb3VuZCFgKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNvbnN0IG4gPSB0aGlzLmZhY2VOb3JtYWxzW2ldIHx8IG5ldyBWZWMzKCk7CiAgICAgICAgdGhpcy5nZXRGYWNlTm9ybWFsKGksIG4pOwogICAgICAgIG4ubmVnYXRlKG4pOwogICAgICAgIHRoaXMuZmFjZU5vcm1hbHNbaV0gPSBuOwogICAgICAgIGNvbnN0IHZlcnRleCA9IHRoaXMudmVydGljZXNbdGhpcy5mYWNlc1tpXVswXV07CgogICAgICAgIGlmIChuLmRvdCh2ZXJ0ZXgpIDwgMCkgewogICAgICAgICAgY29uc29sZS5lcnJvcihgLmZhY2VOb3JtYWxzWyR7aX1dID0gVmVjMygke24udG9TdHJpbmcoKX0pIGxvb2tzIGxpa2UgaXQgcG9pbnRzIGludG8gdGhlIHNoYXBlPyBUaGUgdmVydGljZXMgZm9sbG93LiBNYWtlIHN1cmUgdGhleSBhcmUgb3JkZXJlZCBDQ1cgYXJvdW5kIHRoZSBub3JtYWwsIHVzaW5nIHRoZSByaWdodCBoYW5kIHJ1bGUuYCk7CgogICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmZhY2VzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGNvbnNvbGUud2FybihgLnZlcnRpY2VzWyR7dGhpcy5mYWNlc1tpXVtqXX1dID0gVmVjMygke3RoaXMudmVydGljZXNbdGhpcy5mYWNlc1tpXVtqXV0udG9TdHJpbmcoKX0pYCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGUgdGhlIG5vcm1hbCBvZiBhIGZhY2UgZnJvbSBpdHMgdmVydGljZXMKICAgICAqLwoKCiAgICBnZXRGYWNlTm9ybWFsKGksIHRhcmdldCkgewogICAgICBjb25zdCBmID0gdGhpcy5mYWNlc1tpXTsKICAgICAgY29uc3QgdmEgPSB0aGlzLnZlcnRpY2VzW2ZbMF1dOwogICAgICBjb25zdCB2YiA9IHRoaXMudmVydGljZXNbZlsxXV07CiAgICAgIGNvbnN0IHZjID0gdGhpcy52ZXJ0aWNlc1tmWzJdXTsKICAgICAgQ29udmV4UG9seWhlZHJvbi5jb21wdXRlTm9ybWFsKHZhLCB2YiwgdmMsIHRhcmdldCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBmYWNlIG5vcm1hbCBnaXZlbiAzIHZlcnRpY2VzCiAgICAgKi8KCgogICAgc3RhdGljIGNvbXB1dGVOb3JtYWwodmEsIHZiLCB2YywgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGNiID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgYWIgPSBuZXcgVmVjMygpOwogICAgICB2Yi52c3ViKHZhLCBhYik7CiAgICAgIHZjLnZzdWIodmIsIGNiKTsKICAgICAgY2IuY3Jvc3MoYWIsIHRhcmdldCk7CgogICAgICBpZiAoIXRhcmdldC5pc1plcm8oKSkgewogICAgICAgIHRhcmdldC5ub3JtYWxpemUoKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBAcGFyYW0gbWluRGlzdCBDbGFtcCBkaXN0YW5jZQogICAgICogQHBhcmFtIHJlc3VsdCBUaGUgYW4gYXJyYXkgb2YgY29udGFjdCBwb2ludCBvYmplY3RzLCBzZWUgY2xpcEZhY2VBZ2FpbnN0SHVsbAogICAgICovCgoKICAgIGNsaXBBZ2FpbnN0SHVsbChwb3NBLCBxdWF0QSwgaHVsbEIsIHBvc0IsIHF1YXRCLCBzZXBhcmF0aW5nTm9ybWFsLCBtaW5EaXN0LCBtYXhEaXN0LCByZXN1bHQpIHsKICAgICAgY29uc3QgV29ybGROb3JtYWwgPSBuZXcgVmVjMygpOwogICAgICBsZXQgY2xvc2VzdEZhY2VCID0gLTE7CiAgICAgIGxldCBkbWF4ID0gLU51bWJlci5NQVhfVkFMVUU7CgogICAgICBmb3IgKGxldCBmYWNlID0gMDsgZmFjZSA8IGh1bGxCLmZhY2VzLmxlbmd0aDsgZmFjZSsrKSB7CiAgICAgICAgV29ybGROb3JtYWwuY29weShodWxsQi5mYWNlTm9ybWFsc1tmYWNlXSk7CiAgICAgICAgcXVhdEIudm11bHQoV29ybGROb3JtYWwsIFdvcmxkTm9ybWFsKTsKICAgICAgICBjb25zdCBkID0gV29ybGROb3JtYWwuZG90KHNlcGFyYXRpbmdOb3JtYWwpOwoKICAgICAgICBpZiAoZCA+IGRtYXgpIHsKICAgICAgICAgIGRtYXggPSBkOwogICAgICAgICAgY2xvc2VzdEZhY2VCID0gZmFjZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IHdvcmxkVmVydHNCMSA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBodWxsQi5mYWNlc1tjbG9zZXN0RmFjZUJdLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgYiA9IGh1bGxCLnZlcnRpY2VzW2h1bGxCLmZhY2VzW2Nsb3Nlc3RGYWNlQl1baV1dOwogICAgICAgIGNvbnN0IHdvcmxkYiA9IG5ldyBWZWMzKCk7CiAgICAgICAgd29ybGRiLmNvcHkoYik7CiAgICAgICAgcXVhdEIudm11bHQod29ybGRiLCB3b3JsZGIpOwogICAgICAgIHBvc0IudmFkZCh3b3JsZGIsIHdvcmxkYik7CiAgICAgICAgd29ybGRWZXJ0c0IxLnB1c2god29ybGRiKTsKICAgICAgfQoKICAgICAgaWYgKGNsb3Nlc3RGYWNlQiA+PSAwKSB7CiAgICAgICAgdGhpcy5jbGlwRmFjZUFnYWluc3RIdWxsKHNlcGFyYXRpbmdOb3JtYWwsIHBvc0EsIHF1YXRBLCB3b3JsZFZlcnRzQjEsIG1pbkRpc3QsIG1heERpc3QsIHJlc3VsdCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogRmluZCB0aGUgc2VwYXJhdGluZyBheGlzIGJldHdlZW4gdGhpcyBodWxsIGFuZCBhbm90aGVyCiAgICAgKiBAcGFyYW0gdGFyZ2V0IFRoZSB0YXJnZXQgdmVjdG9yIHRvIHNhdmUgdGhlIGF4aXMgaW4KICAgICAqIEByZXR1cm4gUmV0dXJucyBmYWxzZSBpZiBhIHNlcGFyYXRpb24gaXMgZm91bmQsIGVsc2UgdHJ1ZQogICAgICovCgoKICAgIGZpbmRTZXBhcmF0aW5nQXhpcyhodWxsQiwgcG9zQSwgcXVhdEEsIHBvc0IsIHF1YXRCLCB0YXJnZXQsIGZhY2VMaXN0QSwgZmFjZUxpc3RCKSB7CiAgICAgIGNvbnN0IGZhY2VBTm9ybWFsV1MzID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgV29ybGRub3JtYWwxID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgZGVsdGFDID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3Qgd29ybGRFZGdlMCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHdvcmxkRWRnZTEgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBDcm9zcyA9IG5ldyBWZWMzKCk7CiAgICAgIGxldCBkbWluID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgICAgY29uc3QgaHVsbEEgPSB0aGlzOwoKICAgICAgaWYgKCFodWxsQS51bmlxdWVBeGVzKSB7CiAgICAgICAgY29uc3QgbnVtRmFjZXNBID0gZmFjZUxpc3RBID8gZmFjZUxpc3RBLmxlbmd0aCA6IGh1bGxBLmZhY2VzLmxlbmd0aDsgLy8gVGVzdCBmYWNlIG5vcm1hbHMgZnJvbSBodWxsQQoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUZhY2VzQTsgaSsrKSB7CiAgICAgICAgICBjb25zdCBmaSA9IGZhY2VMaXN0QSA/IGZhY2VMaXN0QVtpXSA6IGk7IC8vIEdldCB3b3JsZCBmYWNlIG5vcm1hbAoKICAgICAgICAgIGZhY2VBTm9ybWFsV1MzLmNvcHkoaHVsbEEuZmFjZU5vcm1hbHNbZmldKTsKICAgICAgICAgIHF1YXRBLnZtdWx0KGZhY2VBTm9ybWFsV1MzLCBmYWNlQU5vcm1hbFdTMyk7CiAgICAgICAgICBjb25zdCBkID0gaHVsbEEudGVzdFNlcEF4aXMoZmFjZUFOb3JtYWxXUzMsIGh1bGxCLCBwb3NBLCBxdWF0QSwgcG9zQiwgcXVhdEIpOwoKICAgICAgICAgIGlmIChkID09PSBmYWxzZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGQgPCBkbWluKSB7CiAgICAgICAgICAgIGRtaW4gPSBkOwogICAgICAgICAgICB0YXJnZXQuY29weShmYWNlQU5vcm1hbFdTMyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRlc3QgdW5pcXVlIGF4ZXMKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gaHVsbEEudW5pcXVlQXhlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgLy8gR2V0IHdvcmxkIGF4aXMKICAgICAgICAgIHF1YXRBLnZtdWx0KGh1bGxBLnVuaXF1ZUF4ZXNbaV0sIGZhY2VBTm9ybWFsV1MzKTsKICAgICAgICAgIGNvbnN0IGQgPSBodWxsQS50ZXN0U2VwQXhpcyhmYWNlQU5vcm1hbFdTMywgaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0Qik7CgogICAgICAgICAgaWYgKGQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZCA8IGRtaW4pIHsKICAgICAgICAgICAgZG1pbiA9IGQ7CiAgICAgICAgICAgIHRhcmdldC5jb3B5KGZhY2VBTm9ybWFsV1MzKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghaHVsbEIudW5pcXVlQXhlcykgewogICAgICAgIC8vIFRlc3QgZmFjZSBub3JtYWxzIGZyb20gaHVsbEIKICAgICAgICBjb25zdCBudW1GYWNlc0IgPSBmYWNlTGlzdEIgPyBmYWNlTGlzdEIubGVuZ3RoIDogaHVsbEIuZmFjZXMubGVuZ3RoOwoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUZhY2VzQjsgaSsrKSB7CiAgICAgICAgICBjb25zdCBmaSA9IGZhY2VMaXN0QiA/IGZhY2VMaXN0QltpXSA6IGk7CiAgICAgICAgICBXb3JsZG5vcm1hbDEuY29weShodWxsQi5mYWNlTm9ybWFsc1tmaV0pOwogICAgICAgICAgcXVhdEIudm11bHQoV29ybGRub3JtYWwxLCBXb3JsZG5vcm1hbDEpOwogICAgICAgICAgY29uc3QgZCA9IGh1bGxBLnRlc3RTZXBBeGlzKFdvcmxkbm9ybWFsMSwgaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0Qik7CgogICAgICAgICAgaWYgKGQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZCA8IGRtaW4pIHsKICAgICAgICAgICAgZG1pbiA9IGQ7CiAgICAgICAgICAgIHRhcmdldC5jb3B5KFdvcmxkbm9ybWFsMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRlc3QgdW5pcXVlIGF4ZXMgaW4gQgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBodWxsQi51bmlxdWVBeGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBxdWF0Qi52bXVsdChodWxsQi51bmlxdWVBeGVzW2ldLCBXb3JsZG5vcm1hbDEpOwogICAgICAgICAgY29uc3QgZCA9IGh1bGxBLnRlc3RTZXBBeGlzKFdvcmxkbm9ybWFsMSwgaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0Qik7CgogICAgICAgICAgaWYgKGQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZCA8IGRtaW4pIHsKICAgICAgICAgICAgZG1pbiA9IGQ7CiAgICAgICAgICAgIHRhcmdldC5jb3B5KFdvcmxkbm9ybWFsMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIFRlc3QgZWRnZXMKCgogICAgICBmb3IgKGxldCBlMCA9IDA7IGUwICE9PSBodWxsQS51bmlxdWVFZGdlcy5sZW5ndGg7IGUwKyspIHsKICAgICAgICAvLyBHZXQgd29ybGQgZWRnZQogICAgICAgIHF1YXRBLnZtdWx0KGh1bGxBLnVuaXF1ZUVkZ2VzW2UwXSwgd29ybGRFZGdlMCk7CgogICAgICAgIGZvciAobGV0IGUxID0gMDsgZTEgIT09IGh1bGxCLnVuaXF1ZUVkZ2VzLmxlbmd0aDsgZTErKykgewogICAgICAgICAgLy8gR2V0IHdvcmxkIGVkZ2UgMgogICAgICAgICAgcXVhdEIudm11bHQoaHVsbEIudW5pcXVlRWRnZXNbZTFdLCB3b3JsZEVkZ2UxKTsKICAgICAgICAgIHdvcmxkRWRnZTAuY3Jvc3Mod29ybGRFZGdlMSwgQ3Jvc3MpOwoKICAgICAgICAgIGlmICghQ3Jvc3MuYWxtb3N0WmVybygpKSB7CiAgICAgICAgICAgIENyb3NzLm5vcm1hbGl6ZSgpOwogICAgICAgICAgICBjb25zdCBkaXN0ID0gaHVsbEEudGVzdFNlcEF4aXMoQ3Jvc3MsIGh1bGxCLCBwb3NBLCBxdWF0QSwgcG9zQiwgcXVhdEIpOwoKICAgICAgICAgICAgaWYgKGRpc3QgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZGlzdCA8IGRtaW4pIHsKICAgICAgICAgICAgICBkbWluID0gZGlzdDsKICAgICAgICAgICAgICB0YXJnZXQuY29weShDcm9zcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHBvc0IudnN1Yihwb3NBLCBkZWx0YUMpOwoKICAgICAgaWYgKGRlbHRhQy5kb3QodGFyZ2V0KSA+IDAuMCkgewogICAgICAgIHRhcmdldC5uZWdhdGUodGFyZ2V0KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIFRlc3Qgc2VwYXJhdGluZyBheGlzIGFnYWluc3QgdHdvIGh1bGxzLiBCb3RoIGh1bGxzIGFyZSBwcm9qZWN0ZWQgb250byB0aGUgYXhpcyBhbmQgdGhlIG92ZXJsYXAgc2l6ZSBpcyByZXR1cm5lZCBpZiB0aGVyZSBpcyBvbmUuCiAgICAgKiBAcmV0dXJuIFRoZSBvdmVybGFwIGRlcHRoLCBvciBGQUxTRSBpZiBubyBwZW5ldHJhdGlvbi4KICAgICAqLwoKCiAgICB0ZXN0U2VwQXhpcyhheGlzLCBodWxsQiwgcG9zQSwgcXVhdEEsIHBvc0IsIHF1YXRCKSB7CiAgICAgIGNvbnN0IGh1bGxBID0gdGhpczsKICAgICAgQ29udmV4UG9seWhlZHJvbi5wcm9qZWN0KGh1bGxBLCBheGlzLCBwb3NBLCBxdWF0QSwgbWF4bWluQSk7CiAgICAgIENvbnZleFBvbHloZWRyb24ucHJvamVjdChodWxsQiwgYXhpcywgcG9zQiwgcXVhdEIsIG1heG1pbkIpOwogICAgICBjb25zdCBtYXhBID0gbWF4bWluQVswXTsKICAgICAgY29uc3QgbWluQSA9IG1heG1pbkFbMV07CiAgICAgIGNvbnN0IG1heEIgPSBtYXhtaW5CWzBdOwogICAgICBjb25zdCBtaW5CID0gbWF4bWluQlsxXTsKCiAgICAgIGlmIChtYXhBIDwgbWluQiB8fCBtYXhCIDwgbWluQSkgewogICAgICAgIHJldHVybiBmYWxzZTsgLy8gU2VwYXJhdGVkCiAgICAgIH0KCiAgICAgIGNvbnN0IGQwID0gbWF4QSAtIG1pbkI7CiAgICAgIGNvbnN0IGQxID0gbWF4QiAtIG1pbkE7CiAgICAgIGNvbnN0IGRlcHRoID0gZDAgPCBkMSA/IGQwIDogZDE7CiAgICAgIHJldHVybiBkZXB0aDsKICAgIH0KICAgIC8qKgogICAgICogY2FsY3VsYXRlTG9jYWxJbmVydGlhCiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICAvLyBBcHByb3hpbWF0ZSB3aXRoIGJveCBpbmVydGlhCiAgICAgIC8vIEV4YWN0IGluZXJ0aWEgY2FsY3VsYXRpb24gaXMgb3ZlcmtpbGwsIGJ1dCBzZWUgaHR0cDovL2dlb21ldHJpY3Rvb2xzLmNvbS9Eb2N1bWVudGF0aW9uL1BvbHloZWRyYWxNYXNzUHJvcGVydGllcy5wZGYgZm9yIHRoZSBjb3JyZWN0IHdheSB0byBkbyBpdAogICAgICBjb25zdCBhYWJibWF4ID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgYWFiYm1pbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuY29tcHV0ZUxvY2FsQUFCQihhYWJibWluLCBhYWJibWF4KTsKICAgICAgY29uc3QgeCA9IGFhYmJtYXgueCAtIGFhYmJtaW4ueDsKICAgICAgY29uc3QgeSA9IGFhYmJtYXgueSAtIGFhYmJtaW4ueTsKICAgICAgY29uc3QgeiA9IGFhYmJtYXgueiAtIGFhYmJtaW4uejsKICAgICAgdGFyZ2V0LnggPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogeSAqIDIgKiB5ICsgMiAqIHogKiAyICogeik7CiAgICAgIHRhcmdldC55ID0gMS4wIC8gMTIuMCAqIG1hc3MgKiAoMiAqIHggKiAyICogeCArIDIgKiB6ICogMiAqIHopOwogICAgICB0YXJnZXQueiA9IDEuMCAvIDEyLjAgKiBtYXNzICogKDIgKiB5ICogMiAqIHkgKyAyICogeCAqIDIgKiB4KTsKICAgIH0KICAgIC8qKgogICAgICogQHBhcmFtIGZhY2VfaSBJbmRleCBvZiB0aGUgZmFjZQogICAgICovCgoKICAgIGdldFBsYW5lQ29uc3RhbnRPZkZhY2UoZmFjZV9pKSB7CiAgICAgIGNvbnN0IGYgPSB0aGlzLmZhY2VzW2ZhY2VfaV07CiAgICAgIGNvbnN0IG4gPSB0aGlzLmZhY2VOb3JtYWxzW2ZhY2VfaV07CiAgICAgIGNvbnN0IHYgPSB0aGlzLnZlcnRpY2VzW2ZbMF1dOwogICAgICBjb25zdCBjID0gLW4uZG90KHYpOwogICAgICByZXR1cm4gYzsKICAgIH0KICAgIC8qKgogICAgICogQ2xpcCBhIGZhY2UgYWdhaW5zdCBhIGh1bGwuCiAgICAgKiBAcGFyYW0gd29ybGRWZXJ0c0IxIEFuIGFycmF5IG9mIFZlYzMgd2l0aCB2ZXJ0aWNlcyBpbiB0aGUgd29ybGQgZnJhbWUuCiAgICAgKiBAcGFyYW0gbWluRGlzdCBEaXN0YW5jZSBjbGFtcGluZwogICAgICogQHBhcmFtIEFycmF5IHJlc3VsdCBBcnJheSB0byBzdG9yZSByZXN1bHRpbmcgY29udGFjdCBwb2ludHMgaW4uIFdpbGwgYmUgb2JqZWN0cyB3aXRoIHByb3BlcnRpZXM6IHBvaW50LCBkZXB0aCwgbm9ybWFsLiBUaGVzZSBhcmUgcmVwcmVzZW50ZWQgaW4gd29ybGQgY29vcmRpbmF0ZXMuCiAgICAgKi8KCgogICAgY2xpcEZhY2VBZ2FpbnN0SHVsbChzZXBhcmF0aW5nTm9ybWFsLCBwb3NBLCBxdWF0QSwgd29ybGRWZXJ0c0IxLCBtaW5EaXN0LCBtYXhEaXN0LCByZXN1bHQpIHsKICAgICAgY29uc3QgZmFjZUFOb3JtYWxXUyA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGVkZ2UwID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgV29ybGRFZGdlMCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHdvcmxkUGxhbmVBbm9ybWFsMSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHBsYW5lTm9ybWFsV1MxID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3Qgd29ybGRBMSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGxvY2FsUGxhbmVOb3JtYWwgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBwbGFuZU5vcm1hbFdTID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgaHVsbEEgPSB0aGlzOwogICAgICBjb25zdCB3b3JsZFZlcnRzQjIgPSBbXTsKICAgICAgY29uc3QgcFZ0eEluID0gd29ybGRWZXJ0c0IxOwogICAgICBjb25zdCBwVnR4T3V0ID0gd29ybGRWZXJ0c0IyOwogICAgICBsZXQgY2xvc2VzdEZhY2VBID0gLTE7CiAgICAgIGxldCBkbWluID0gTnVtYmVyLk1BWF9WQUxVRTsgLy8gRmluZCB0aGUgZmFjZSB3aXRoIG5vcm1hbCBjbG9zZXN0IHRvIHRoZSBzZXBhcmF0aW5nIGF4aXMKCiAgICAgIGZvciAobGV0IGZhY2UgPSAwOyBmYWNlIDwgaHVsbEEuZmFjZXMubGVuZ3RoOyBmYWNlKyspIHsKICAgICAgICBmYWNlQU5vcm1hbFdTLmNvcHkoaHVsbEEuZmFjZU5vcm1hbHNbZmFjZV0pOwogICAgICAgIHF1YXRBLnZtdWx0KGZhY2VBTm9ybWFsV1MsIGZhY2VBTm9ybWFsV1MpOwogICAgICAgIGNvbnN0IGQgPSBmYWNlQU5vcm1hbFdTLmRvdChzZXBhcmF0aW5nTm9ybWFsKTsKCiAgICAgICAgaWYgKGQgPCBkbWluKSB7CiAgICAgICAgICBkbWluID0gZDsKICAgICAgICAgIGNsb3Nlc3RGYWNlQSA9IGZhY2U7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoY2xvc2VzdEZhY2VBIDwgMCkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBHZXQgdGhlIGZhY2UgYW5kIGNvbnN0cnVjdCBjb25uZWN0ZWQgZmFjZXMKCgogICAgICBjb25zdCBwb2x5QSA9IGh1bGxBLmZhY2VzW2Nsb3Nlc3RGYWNlQV07CiAgICAgIHBvbHlBLmNvbm5lY3RlZEZhY2VzID0gW107CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGh1bGxBLmZhY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBodWxsQS5mYWNlc1tpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgaWYgKAogICAgICAgICAgLyogU2hhcmluZyBhIHZlcnRleCovCiAgICAgICAgICBwb2x5QS5pbmRleE9mKGh1bGxBLmZhY2VzW2ldW2pdKSAhPT0gLTEgJiYKICAgICAgICAgIC8qIE5vdCB0aGUgb25lIHdlIGFyZSBsb29raW5nIGZvciBjb25uZWN0aW9ucyBmcm9tICovCiAgICAgICAgICBpICE9PSBjbG9zZXN0RmFjZUEgJiYKICAgICAgICAgIC8qIE5vdCBhbHJlYWR5IGFkZGVkICovCiAgICAgICAgICBwb2x5QS5jb25uZWN0ZWRGYWNlcy5pbmRleE9mKGkpID09PSAtMSkgewogICAgICAgICAgICBwb2x5QS5jb25uZWN0ZWRGYWNlcy5wdXNoKGkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSAvLyBDbGlwIHRoZSBwb2x5Z29uIHRvIHRoZSBiYWNrIG9mIHRoZSBwbGFuZXMgb2YgYWxsIGZhY2VzIG9mIGh1bGwgQSwKICAgICAgLy8gdGhhdCBhcmUgYWRqYWNlbnQgdG8gdGhlIHdpdG5lc3MgZmFjZQoKCiAgICAgIGNvbnN0IG51bVZlcnRpY2VzQSA9IHBvbHlBLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtVmVydGljZXNBOyBpKyspIHsKICAgICAgICBjb25zdCBhID0gaHVsbEEudmVydGljZXNbcG9seUFbaV1dOwogICAgICAgIGNvbnN0IGIgPSBodWxsQS52ZXJ0aWNlc1twb2x5QVsoaSArIDEpICUgbnVtVmVydGljZXNBXV07CiAgICAgICAgYS52c3ViKGIsIGVkZ2UwKTsKICAgICAgICBXb3JsZEVkZ2UwLmNvcHkoZWRnZTApOwogICAgICAgIHF1YXRBLnZtdWx0KFdvcmxkRWRnZTAsIFdvcmxkRWRnZTApOwogICAgICAgIHBvc0EudmFkZChXb3JsZEVkZ2UwLCBXb3JsZEVkZ2UwKTsKICAgICAgICB3b3JsZFBsYW5lQW5vcm1hbDEuY29weSh0aGlzLmZhY2VOb3JtYWxzW2Nsb3Nlc3RGYWNlQV0pOwogICAgICAgIHF1YXRBLnZtdWx0KHdvcmxkUGxhbmVBbm9ybWFsMSwgd29ybGRQbGFuZUFub3JtYWwxKTsKICAgICAgICBwb3NBLnZhZGQod29ybGRQbGFuZUFub3JtYWwxLCB3b3JsZFBsYW5lQW5vcm1hbDEpOwogICAgICAgIFdvcmxkRWRnZTAuY3Jvc3Mod29ybGRQbGFuZUFub3JtYWwxLCBwbGFuZU5vcm1hbFdTMSk7CiAgICAgICAgcGxhbmVOb3JtYWxXUzEubmVnYXRlKHBsYW5lTm9ybWFsV1MxKTsKICAgICAgICB3b3JsZEExLmNvcHkoYSk7CiAgICAgICAgcXVhdEEudm11bHQod29ybGRBMSwgd29ybGRBMSk7CiAgICAgICAgcG9zQS52YWRkKHdvcmxkQTEsIHdvcmxkQTEpOwogICAgICAgIGNvbnN0IG90aGVyRmFjZSA9IHBvbHlBLmNvbm5lY3RlZEZhY2VzW2ldOwogICAgICAgIGxvY2FsUGxhbmVOb3JtYWwuY29weSh0aGlzLmZhY2VOb3JtYWxzW290aGVyRmFjZV0pOwogICAgICAgIGNvbnN0IGxvY2FsUGxhbmVFcSA9IHRoaXMuZ2V0UGxhbmVDb25zdGFudE9mRmFjZShvdGhlckZhY2UpOwogICAgICAgIHBsYW5lTm9ybWFsV1MuY29weShsb2NhbFBsYW5lTm9ybWFsKTsKICAgICAgICBxdWF0QS52bXVsdChwbGFuZU5vcm1hbFdTLCBwbGFuZU5vcm1hbFdTKTsKICAgICAgICBjb25zdCBwbGFuZUVxV1MgPSBsb2NhbFBsYW5lRXEgLSBwbGFuZU5vcm1hbFdTLmRvdChwb3NBKTsgLy8gQ2xpcCBmYWNlIGFnYWluc3Qgb3VyIGNvbnN0cnVjdGVkIHBsYW5lCgogICAgICAgIHRoaXMuY2xpcEZhY2VBZ2FpbnN0UGxhbmUocFZ0eEluLCBwVnR4T3V0LCBwbGFuZU5vcm1hbFdTLCBwbGFuZUVxV1MpOyAvLyBUaHJvdyBhd2F5IGFsbCBjbGlwcGVkIHBvaW50cywgYnV0IHNhdmUgdGhlIHJlbWFpbmluZyB1bnRpbCBuZXh0IGNsaXAKCiAgICAgICAgd2hpbGUgKHBWdHhJbi5sZW5ndGgpIHsKICAgICAgICAgIHBWdHhJbi5zaGlmdCgpOwogICAgICAgIH0KCiAgICAgICAgd2hpbGUgKHBWdHhPdXQubGVuZ3RoKSB7CiAgICAgICAgICBwVnR4SW4ucHVzaChwVnR4T3V0LnNoaWZ0KCkpOwogICAgICAgIH0KICAgICAgfSAvLyBvbmx5IGtlZXAgY29udGFjdCBwb2ludHMgdGhhdCBhcmUgYmVoaW5kIHRoZSB3aXRuZXNzIGZhY2UKCgogICAgICBsb2NhbFBsYW5lTm9ybWFsLmNvcHkodGhpcy5mYWNlTm9ybWFsc1tjbG9zZXN0RmFjZUFdKTsKICAgICAgY29uc3QgbG9jYWxQbGFuZUVxID0gdGhpcy5nZXRQbGFuZUNvbnN0YW50T2ZGYWNlKGNsb3Nlc3RGYWNlQSk7CiAgICAgIHBsYW5lTm9ybWFsV1MuY29weShsb2NhbFBsYW5lTm9ybWFsKTsKICAgICAgcXVhdEEudm11bHQocGxhbmVOb3JtYWxXUywgcGxhbmVOb3JtYWxXUyk7CiAgICAgIGNvbnN0IHBsYW5lRXFXUyA9IGxvY2FsUGxhbmVFcSAtIHBsYW5lTm9ybWFsV1MuZG90KHBvc0EpOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwVnR4SW4ubGVuZ3RoOyBpKyspIHsKICAgICAgICBsZXQgZGVwdGggPSBwbGFuZU5vcm1hbFdTLmRvdChwVnR4SW5baV0pICsgcGxhbmVFcVdTOyAvLyA/Pz8KCiAgICAgICAgaWYgKGRlcHRoIDw9IG1pbkRpc3QpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGBjbGFtcGVkOiBkZXB0aD0ke2RlcHRofSB0byBtaW5EaXN0PSR7bWluRGlzdH1gKTsKICAgICAgICAgIGRlcHRoID0gbWluRGlzdDsKICAgICAgICB9CgogICAgICAgIGlmIChkZXB0aCA8PSBtYXhEaXN0KSB7CiAgICAgICAgICBjb25zdCBwb2ludCA9IHBWdHhJbltpXTsKCiAgICAgICAgICBpZiAoZGVwdGggPD0gMWUtNikgewogICAgICAgICAgICBjb25zdCBwID0gewogICAgICAgICAgICAgIHBvaW50LAogICAgICAgICAgICAgIG5vcm1hbDogcGxhbmVOb3JtYWxXUywKICAgICAgICAgICAgICBkZXB0aAogICAgICAgICAgICB9OwogICAgICAgICAgICByZXN1bHQucHVzaChwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2xpcCBhIGZhY2UgaW4gYSBodWxsIGFnYWluc3QgdGhlIGJhY2sgb2YgYSBwbGFuZS4KICAgICAqIEBwYXJhbSBwbGFuZUNvbnN0YW50IFRoZSBjb25zdGFudCBpbiB0aGUgbWF0aGVtYXRpY2FsIHBsYW5lIGVxdWF0aW9uCiAgICAgKi8KCgogICAgY2xpcEZhY2VBZ2FpbnN0UGxhbmUoaW5WZXJ0aWNlcywgb3V0VmVydGljZXMsIHBsYW5lTm9ybWFsLCBwbGFuZUNvbnN0YW50KSB7CiAgICAgIGxldCBuX2RvdF9maXJzdDsKICAgICAgbGV0IG5fZG90X2xhc3Q7CiAgICAgIGNvbnN0IG51bVZlcnRzID0gaW5WZXJ0aWNlcy5sZW5ndGg7CgogICAgICBpZiAobnVtVmVydHMgPCAyKSB7CiAgICAgICAgcmV0dXJuIG91dFZlcnRpY2VzOwogICAgICB9CgogICAgICBsZXQgZmlyc3RWZXJ0ZXggPSBpblZlcnRpY2VzW2luVmVydGljZXMubGVuZ3RoIC0gMV07CiAgICAgIGxldCBsYXN0VmVydGV4ID0gaW5WZXJ0aWNlc1swXTsKICAgICAgbl9kb3RfZmlyc3QgPSBwbGFuZU5vcm1hbC5kb3QoZmlyc3RWZXJ0ZXgpICsgcGxhbmVDb25zdGFudDsKCiAgICAgIGZvciAobGV0IHZpID0gMDsgdmkgPCBudW1WZXJ0czsgdmkrKykgewogICAgICAgIGxhc3RWZXJ0ZXggPSBpblZlcnRpY2VzW3ZpXTsKICAgICAgICBuX2RvdF9sYXN0ID0gcGxhbmVOb3JtYWwuZG90KGxhc3RWZXJ0ZXgpICsgcGxhbmVDb25zdGFudDsKCiAgICAgICAgaWYgKG5fZG90X2ZpcnN0IDwgMCkgewogICAgICAgICAgaWYgKG5fZG90X2xhc3QgPCAwKSB7CiAgICAgICAgICAgIC8vIFN0YXJ0IDwgMCwgZW5kIDwgMCwgc28gb3V0cHV0IGxhc3RWZXJ0ZXgKICAgICAgICAgICAgY29uc3QgbmV3diA9IG5ldyBWZWMzKCk7CiAgICAgICAgICAgIG5ld3YuY29weShsYXN0VmVydGV4KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChuZXd2KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIFN0YXJ0IDwgMCwgZW5kID49IDAsIHNvIG91dHB1dCBpbnRlcnNlY3Rpb24KICAgICAgICAgICAgY29uc3QgbmV3diA9IG5ldyBWZWMzKCk7CiAgICAgICAgICAgIGZpcnN0VmVydGV4LmxlcnAobGFzdFZlcnRleCwgbl9kb3RfZmlyc3QgLyAobl9kb3RfZmlyc3QgLSBuX2RvdF9sYXN0KSwgbmV3dik7CiAgICAgICAgICAgIG91dFZlcnRpY2VzLnB1c2gobmV3dik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChuX2RvdF9sYXN0IDwgMCkgewogICAgICAgICAgICAvLyBTdGFydCA+PSAwLCBlbmQgPCAwIHNvIG91dHB1dCBpbnRlcnNlY3Rpb24gYW5kIGVuZAogICAgICAgICAgICBjb25zdCBuZXd2ID0gbmV3IFZlYzMoKTsKICAgICAgICAgICAgZmlyc3RWZXJ0ZXgubGVycChsYXN0VmVydGV4LCBuX2RvdF9maXJzdCAvIChuX2RvdF9maXJzdCAtIG5fZG90X2xhc3QpLCBuZXd2KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChuZXd2KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChsYXN0VmVydGV4KTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZpcnN0VmVydGV4ID0gbGFzdFZlcnRleDsKICAgICAgICBuX2RvdF9maXJzdCA9IG5fZG90X2xhc3Q7CiAgICAgIH0KCiAgICAgIHJldHVybiBvdXRWZXJ0aWNlczsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyBgLndvcmxkVmVydGljZXNgIGFuZCBzZXRzIGAud29ybGRWZXJ0aWNlc05lZWRzVXBkYXRlYCB0byBmYWxzZS4KICAgICAqLwoKCiAgICBjb21wdXRlV29ybGRWZXJ0aWNlcyhwb3NpdGlvbiwgcXVhdCkgewogICAgICB3aGlsZSAodGhpcy53b3JsZFZlcnRpY2VzLmxlbmd0aCA8IHRoaXMudmVydGljZXMubGVuZ3RoKSB7CiAgICAgICAgdGhpcy53b3JsZFZlcnRpY2VzLnB1c2gobmV3IFZlYzMoKSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsKICAgICAgY29uc3Qgd29ybGRWZXJ0cyA9IHRoaXMud29ybGRWZXJ0aWNlczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSB0aGlzLnZlcnRpY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgcXVhdC52bXVsdCh2ZXJ0c1tpXSwgd29ybGRWZXJ0c1tpXSk7CiAgICAgICAgcG9zaXRpb24udmFkZCh3b3JsZFZlcnRzW2ldLCB3b3JsZFZlcnRzW2ldKTsKICAgICAgfQoKICAgICAgdGhpcy53b3JsZFZlcnRpY2VzTmVlZHNVcGRhdGUgPSBmYWxzZTsKICAgIH0KCiAgICBjb21wdXRlTG9jYWxBQUJCKGFhYmJtaW4sIGFhYmJtYXgpIHsKICAgICAgY29uc3QgdmVydGljZXMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBhYWJibWluLnNldChOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFKTsKICAgICAgYWFiYm1heC5zZXQoLU51bWJlci5NQVhfVkFMVUUsIC1OdW1iZXIuTUFYX1ZBTFVFLCAtTnVtYmVyLk1BWF9WQUxVRSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudmVydGljZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gdmVydGljZXNbaV07CgogICAgICAgIGlmICh2LnggPCBhYWJibWluLngpIHsKICAgICAgICAgIGFhYmJtaW4ueCA9IHYueDsKICAgICAgICB9IGVsc2UgaWYgKHYueCA+IGFhYmJtYXgueCkgewogICAgICAgICAgYWFiYm1heC54ID0gdi54OwogICAgICAgIH0KCiAgICAgICAgaWYgKHYueSA8IGFhYmJtaW4ueSkgewogICAgICAgICAgYWFiYm1pbi55ID0gdi55OwogICAgICAgIH0gZWxzZSBpZiAodi55ID4gYWFiYm1heC55KSB7CiAgICAgICAgICBhYWJibWF4LnkgPSB2Lnk7CiAgICAgICAgfQoKICAgICAgICBpZiAodi56IDwgYWFiYm1pbi56KSB7CiAgICAgICAgICBhYWJibWluLnogPSB2Lno7CiAgICAgICAgfSBlbHNlIGlmICh2LnogPiBhYWJibWF4LnopIHsKICAgICAgICAgIGFhYmJtYXgueiA9IHYuejsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyBgd29ybGRWZXJ0aWNlc2AgYW5kIHNldHMgYHdvcmxkVmVydGljZXNOZWVkc1VwZGF0ZWAgdG8gZmFsc2UuCiAgICAgKi8KCgogICAgY29tcHV0ZVdvcmxkRmFjZU5vcm1hbHMocXVhdCkgewogICAgICBjb25zdCBOID0gdGhpcy5mYWNlTm9ybWFscy5sZW5ndGg7CgogICAgICB3aGlsZSAodGhpcy53b3JsZEZhY2VOb3JtYWxzLmxlbmd0aCA8IE4pIHsKICAgICAgICB0aGlzLndvcmxkRmFjZU5vcm1hbHMucHVzaChuZXcgVmVjMygpKTsKICAgICAgfQoKICAgICAgY29uc3Qgbm9ybWFscyA9IHRoaXMuZmFjZU5vcm1hbHM7CiAgICAgIGNvbnN0IHdvcmxkTm9ybWFscyA9IHRoaXMud29ybGRGYWNlTm9ybWFsczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBxdWF0LnZtdWx0KG5vcm1hbHNbaV0sIHdvcmxkTm9ybWFsc1tpXSk7CiAgICAgIH0KCiAgICAgIHRoaXMud29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIC8vIEFzc3VtZSBwb2ludHMgYXJlIGRpc3RyaWJ1dGVkIHdpdGggbG9jYWwgKDAsMCwwKSBhcyBjZW50ZXIKICAgICAgbGV0IG1heDIgPSAwOwogICAgICBjb25zdCB2ZXJ0cyA9IHRoaXMudmVydGljZXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBub3JtMiA9IHZlcnRzW2ldLmxlbmd0aFNxdWFyZWQoKTsKCiAgICAgICAgaWYgKG5vcm0yID4gbWF4MikgewogICAgICAgICAgbWF4MiA9IG5vcm0yOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IE1hdGguc3FydChtYXgyKTsKICAgIH0KICAgIC8qKgogICAgICogY2FsY3VsYXRlV29ybGRBQUJCCiAgICAgKi8KCgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgY29uc3QgdmVydHMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBsZXQgbWlueDsKICAgICAgbGV0IG1pbnk7CiAgICAgIGxldCBtaW56OwogICAgICBsZXQgbWF4eDsKICAgICAgbGV0IG1heHk7CiAgICAgIGxldCBtYXh6OwogICAgICBsZXQgdGVtcFdvcmxkVmVydGV4ID0gbmV3IFZlYzMoKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0ZW1wV29ybGRWZXJ0ZXguY29weSh2ZXJ0c1tpXSk7CiAgICAgICAgcXVhdC52bXVsdCh0ZW1wV29ybGRWZXJ0ZXgsIHRlbXBXb3JsZFZlcnRleCk7CiAgICAgICAgcG9zLnZhZGQodGVtcFdvcmxkVmVydGV4LCB0ZW1wV29ybGRWZXJ0ZXgpOwogICAgICAgIGNvbnN0IHYgPSB0ZW1wV29ybGRWZXJ0ZXg7CgogICAgICAgIGlmIChtaW54ID09PSB1bmRlZmluZWQgfHwgdi54IDwgbWlueCkgewogICAgICAgICAgbWlueCA9IHYueDsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh4ID09PSB1bmRlZmluZWQgfHwgdi54ID4gbWF4eCkgewogICAgICAgICAgbWF4eCA9IHYueDsKICAgICAgICB9CgogICAgICAgIGlmIChtaW55ID09PSB1bmRlZmluZWQgfHwgdi55IDwgbWlueSkgewogICAgICAgICAgbWlueSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh5ID09PSB1bmRlZmluZWQgfHwgdi55ID4gbWF4eSkgewogICAgICAgICAgbWF4eSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmIChtaW56ID09PSB1bmRlZmluZWQgfHwgdi56IDwgbWlueikgewogICAgICAgICAgbWlueiA9IHYuejsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh6ID09PSB1bmRlZmluZWQgfHwgdi56ID4gbWF4eikgewogICAgICAgICAgbWF4eiA9IHYuejsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG1pbi5zZXQobWlueCwgbWlueSwgbWlueik7CiAgICAgIG1heC5zZXQobWF4eCwgbWF4eSwgbWF4eik7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhcHByb3hpbWF0ZSBjb252ZXggdm9sdW1lCiAgICAgKi8KCgogICAgdm9sdW1lKCkgewogICAgICByZXR1cm4gNC4wICogTWF0aC5QSSAqIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgLyAzLjA7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBhdmVyYWdlIG9mIGFsbCB0aGUgdmVydGljZXMgcG9zaXRpb25zCiAgICAgKi8KCgogICAgZ2V0QXZlcmFnZVBvaW50TG9jYWwodGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQgPT09IHZvaWQgMCkgewogICAgICAgIHRhcmdldCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0YXJnZXQudmFkZCh2ZXJ0c1tpXSwgdGFyZ2V0KTsKICAgICAgfQoKICAgICAgdGFyZ2V0LnNjYWxlKDEgLyB2ZXJ0cy5sZW5ndGgsIHRhcmdldCk7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIFRyYW5zZm9ybSBhbGwgbG9jYWwgcG9pbnRzLiBXaWxsIGNoYW5nZSB0aGUgLnZlcnRpY2VzCiAgICAgKi8KCgogICAgdHJhbnNmb3JtQWxsUG9pbnRzKG9mZnNldCwgcXVhdCkgewogICAgICBjb25zdCBuID0gdGhpcy52ZXJ0aWNlcy5sZW5ndGg7CiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsgLy8gQXBwbHkgcm90YXRpb24KCiAgICAgIGlmIChxdWF0KSB7CiAgICAgICAgLy8gUm90YXRlIHZlcnRpY2VzCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHYgPSB2ZXJ0c1tpXTsKICAgICAgICAgIHF1YXQudm11bHQodiwgdik7CiAgICAgICAgfSAvLyBSb3RhdGUgZmFjZSBub3JtYWxzCgoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmFjZU5vcm1hbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHYgPSB0aGlzLmZhY2VOb3JtYWxzW2ldOwogICAgICAgICAgcXVhdC52bXVsdCh2LCB2KTsKICAgICAgICB9CiAgICAgICAgLyoKICAgICAgICAgICAgICAvLyBSb3RhdGUgZWRnZXMKICAgICAgICAgICAgICBmb3IobGV0IGk9MDsgaTx0aGlzLnVuaXF1ZUVkZ2VzLmxlbmd0aDsgaSsrKXsKICAgICAgICAgICAgICAgICAgY29uc3QgdiA9IHRoaXMudW5pcXVlRWRnZXNbaV07CiAgICAgICAgICAgICAgICAgIHF1YXQudm11bHQodix2KTsKICAgICAgICAgICAgICB9Ki8KCiAgICAgIH0gLy8gQXBwbHkgb2Zmc2V0CgoKICAgICAgaWYgKG9mZnNldCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICBjb25zdCB2ID0gdmVydHNbaV07CiAgICAgICAgICB2LnZhZGQob2Zmc2V0LCB2KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2hlY2tzIHdoZXRoZXIgcCBpcyBpbnNpZGUgdGhlIHBvbHloZWRyYS4gTXVzdCBiZSBpbiBsb2NhbCBjb29yZHMuCiAgICAgKiBUaGUgcG9pbnQgbGllcyBvdXRzaWRlIG9mIHRoZSBjb252ZXggaHVsbCBvZiB0aGUgb3RoZXIgcG9pbnRzIGlmIGFuZCBvbmx5IGlmIHRoZSBkaXJlY3Rpb24KICAgICAqIG9mIGFsbCB0aGUgdmVjdG9ycyBmcm9tIGl0IHRvIHRob3NlIG90aGVyIHBvaW50cyBhcmUgb24gbGVzcyB0aGFuIG9uZSBoYWxmIG9mIGEgc3BoZXJlIGFyb3VuZCBpdC4KICAgICAqIEBwYXJhbSBwIEEgcG9pbnQgZ2l2ZW4gaW4gbG9jYWwgY29vcmRpbmF0ZXMKICAgICAqLwoKCiAgICBwb2ludElzSW5zaWRlKHApIHsKICAgICAgY29uc3QgdmVydHMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBjb25zdCBmYWNlcyA9IHRoaXMuZmFjZXM7CiAgICAgIGNvbnN0IG5vcm1hbHMgPSB0aGlzLmZhY2VOb3JtYWxzOwogICAgICBjb25zdCBwb3NpdGl2ZVJlc3VsdCA9IG51bGw7CiAgICAgIGNvbnN0IHBvaW50SW5zaWRlID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5nZXRBdmVyYWdlUG9pbnRMb2NhbChwb2ludEluc2lkZSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBsZXQgbiA9IG5vcm1hbHNbaV07CiAgICAgICAgY29uc3QgdiA9IHZlcnRzW2ZhY2VzW2ldWzBdXTsgLy8gV2Ugb25seSBuZWVkIG9uZSBwb2ludCBpbiB0aGUgZmFjZQogICAgICAgIC8vIFRoaXMgZG90IHByb2R1Y3QgZGV0ZXJtaW5lcyB3aGljaCBzaWRlIG9mIHRoZSBlZGdlIHRoZSBwb2ludCBpcwoKICAgICAgICBjb25zdCB2VG9QID0gbmV3IFZlYzMoKTsKICAgICAgICBwLnZzdWIodiwgdlRvUCk7CiAgICAgICAgY29uc3QgcjEgPSBuLmRvdCh2VG9QKTsKICAgICAgICBjb25zdCB2VG9Qb2ludEluc2lkZSA9IG5ldyBWZWMzKCk7CiAgICAgICAgcG9pbnRJbnNpZGUudnN1Yih2LCB2VG9Qb2ludEluc2lkZSk7CiAgICAgICAgY29uc3QgcjIgPSBuLmRvdCh2VG9Qb2ludEluc2lkZSk7CgogICAgICAgIGlmIChyMSA8IDAgJiYgcjIgPiAwIHx8IHIxID4gMCAmJiByMiA8IDApIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gRW5jb3VudGVyZWQgc29tZSBvdGhlciBzaWduLiBFeGl0LgogICAgICAgIH0KICAgICAgfSAvLyBJZiB3ZSBnb3QgaGVyZSwgYWxsIGRvdCBwcm9kdWN0cyB3ZXJlIG9mIHRoZSBzYW1lIHNpZ24uCgoKICAgICAgcmV0dXJuIHBvc2l0aXZlUmVzdWx0ID8gMSA6IC0xOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgbWF4IGFuZCBtaW4gZG90IHByb2R1Y3Qgb2YgYSBjb252ZXggaHVsbCBhdCBwb3NpdGlvbiAocG9zLHF1YXQpIHByb2plY3RlZCBvbnRvIGFuIGF4aXMuCiAgICAgKiBSZXN1bHRzIGFyZSBzYXZlZCBpbiB0aGUgYXJyYXkgbWF4bWluLgogICAgICogQHBhcmFtIHJlc3VsdCByZXN1bHRbMF0gYW5kIHJlc3VsdFsxXSB3aWxsIGJlIHNldCB0byBtYXhpbXVtIGFuZCBtaW5pbXVtLCByZXNwZWN0aXZlbHkuCiAgICAgKi8KCgogICAgc3RhdGljIHByb2plY3Qoc2hhcGUsIGF4aXMsIHBvcywgcXVhdCwgcmVzdWx0KSB7CiAgICAgIGNvbnN0IG4gPSBzaGFwZS52ZXJ0aWNlcy5sZW5ndGg7CiAgICAgIGNvbnN0IGxvY2FsQXhpcyA9IHByb2plY3RfbG9jYWxBeGlzOwogICAgICBsZXQgbWF4ID0gMDsKICAgICAgbGV0IG1pbiA9IDA7CiAgICAgIGNvbnN0IGxvY2FsT3JpZ2luID0gcHJvamVjdF9sb2NhbE9yaWdpbjsKICAgICAgY29uc3QgdnMgPSBzaGFwZS52ZXJ0aWNlczsKICAgICAgbG9jYWxPcmlnaW4uc2V0WmVybygpOyAvLyBUcmFuc2Zvcm0gdGhlIGF4aXMgdG8gbG9jYWwKCiAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb0xvY2FsRnJhbWUocG9zLCBxdWF0LCBheGlzLCBsb2NhbEF4aXMpOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zLCBxdWF0LCBsb2NhbE9yaWdpbiwgbG9jYWxPcmlnaW4pOwogICAgICBjb25zdCBhZGQgPSBsb2NhbE9yaWdpbi5kb3QobG9jYWxBeGlzKTsKICAgICAgbWluID0gbWF4ID0gdnNbMF0uZG90KGxvY2FsQXhpcyk7CgogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IG47IGkrKykgewogICAgICAgIGNvbnN0IHZhbCA9IHZzW2ldLmRvdChsb2NhbEF4aXMpOwoKICAgICAgICBpZiAodmFsID4gbWF4KSB7CiAgICAgICAgICBtYXggPSB2YWw7CiAgICAgICAgfQoKICAgICAgICBpZiAodmFsIDwgbWluKSB7CiAgICAgICAgICBtaW4gPSB2YWw7CiAgICAgICAgfQogICAgICB9CgogICAgICBtaW4gLT0gYWRkOwogICAgICBtYXggLT0gYWRkOwoKICAgICAgaWYgKG1pbiA+IG1heCkgewogICAgICAgIC8vIEluY29uc2lzdGVudCAtIHN3YXAKICAgICAgICBjb25zdCB0ZW1wID0gbWluOwogICAgICAgIG1pbiA9IG1heDsKICAgICAgICBtYXggPSB0ZW1wOwogICAgICB9IC8vIE91dHB1dAoKCiAgICAgIHJlc3VsdFswXSA9IG1heDsKICAgICAgcmVzdWx0WzFdID0gbWluOwogICAgfQoKICB9CiAgY29uc3QgbWF4bWluQSA9IFtdOwogIGNvbnN0IG1heG1pbkIgPSBbXTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHByb2plY3RfbG9jYWxBeGlzID0gbmV3IFZlYzMoKTsKICBjb25zdCBwcm9qZWN0X2xvY2FsT3JpZ2luID0gbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQSAzZCBib3ggc2hhcGUuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3Qgc2l6ZSA9IDEKICAgKiAgICAgY29uc3QgaGFsZkV4dGVudHMgPSBuZXcgQ0FOTk9OLlZlYzMoc2l6ZSwgc2l6ZSwgc2l6ZSkKICAgKiAgICAgY29uc3QgYm94U2hhcGUgPSBuZXcgQ0FOTk9OLkJveChoYWxmRXh0ZW50cykKICAgKiAgICAgY29uc3QgYm94Qm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBib3hTaGFwZSB9KQogICAqICAgICB3b3JsZC5hZGRCb2R5KGJveEJvZHkpCiAgICovCiAgY2xhc3MgQm94IGV4dGVuZHMgU2hhcGUgewogICAgLyoqCiAgICAgKiBUaGUgaGFsZiBleHRlbnRzIG9mIHRoZSBib3guCiAgICAgKi8KCiAgICAvKioKICAgICAqIFVzZWQgYnkgdGhlIGNvbnRhY3QgZ2VuZXJhdG9yIHRvIG1ha2UgY29udGFjdHMgd2l0aCBvdGhlciBjb252ZXggcG9seWhlZHJhIGZvciBleGFtcGxlLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihoYWxmRXh0ZW50cykgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuQk9YCiAgICAgIH0pOwogICAgICB0aGlzLmhhbGZFeHRlbnRzID0gaGFsZkV4dGVudHM7CiAgICAgIHRoaXMuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uID0gbnVsbDsKICAgICAgdGhpcy51cGRhdGVDb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24oKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGVzIHRoZSBsb2NhbCBjb252ZXggcG9seWhlZHJvbiByZXByZXNlbnRhdGlvbiB1c2VkIGZvciBzb21lIGNvbGxpc2lvbnMuCiAgICAgKi8KCgogICAgdXBkYXRlQ29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uKCkgewogICAgICBjb25zdCBzeCA9IHRoaXMuaGFsZkV4dGVudHMueDsKICAgICAgY29uc3Qgc3kgPSB0aGlzLmhhbGZFeHRlbnRzLnk7CiAgICAgIGNvbnN0IHN6ID0gdGhpcy5oYWxmRXh0ZW50cy56OwogICAgICBjb25zdCBWID0gVmVjMzsKICAgICAgY29uc3QgdmVydGljZXMgPSBbbmV3IFYoLXN4LCAtc3ksIC1zeiksIG5ldyBWKHN4LCAtc3ksIC1zeiksIG5ldyBWKHN4LCBzeSwgLXN6KSwgbmV3IFYoLXN4LCBzeSwgLXN6KSwgbmV3IFYoLXN4LCAtc3ksIHN6KSwgbmV3IFYoc3gsIC1zeSwgc3opLCBuZXcgVihzeCwgc3ksIHN6KSwgbmV3IFYoLXN4LCBzeSwgc3opXTsKICAgICAgY29uc3QgZmFjZXMgPSBbWzMsIDIsIDEsIDBdLCAvLyAtegogICAgICBbNCwgNSwgNiwgN10sIC8vICt6CiAgICAgIFs1LCA0LCAwLCAxXSwgLy8gLXkKICAgICAgWzIsIDMsIDcsIDZdLCAvLyAreQogICAgICBbMCwgNCwgNywgM10sIC8vIC14CiAgICAgIFsxLCAyLCA2LCA1XSAvLyAreAogICAgICBdOwogICAgICBjb25zdCBheGVzID0gW25ldyBWKDAsIDAsIDEpLCBuZXcgVigwLCAxLCAwKSwgbmV3IFYoMSwgMCwgMCldOwogICAgICBjb25zdCBoID0gbmV3IENvbnZleFBvbHloZWRyb24oewogICAgICAgIHZlcnRpY2VzLAogICAgICAgIGZhY2VzLAogICAgICAgIGF4ZXMKICAgICAgfSk7CiAgICAgIHRoaXMuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uID0gaDsKICAgICAgaC5tYXRlcmlhbCA9IHRoaXMubWF0ZXJpYWw7CiAgICB9CiAgICAvKioKICAgICAqIENhbGN1bGF0ZSB0aGUgaW5lcnRpYSBvZiB0aGUgYm94LgogICAgICovCgoKICAgIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYShtYXNzLCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgQm94LmNhbGN1bGF0ZUluZXJ0aWEodGhpcy5oYWxmRXh0ZW50cywgbWFzcywgdGFyZ2V0KTsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KCiAgICBzdGF0aWMgY2FsY3VsYXRlSW5lcnRpYShoYWxmRXh0ZW50cywgbWFzcywgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGUgPSBoYWxmRXh0ZW50czsKICAgICAgdGFyZ2V0LnggPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS55ICogMiAqIGUueSArIDIgKiBlLnogKiAyICogZS56KTsKICAgICAgdGFyZ2V0LnkgPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS54ICogMiAqIGUueCArIDIgKiBlLnogKiAyICogZS56KTsKICAgICAgdGFyZ2V0LnogPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS55ICogMiAqIGUueSArIDIgKiBlLnggKiAyICogZS54KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBib3ggNiBzaWRlIG5vcm1hbHMKICAgICAqIEBwYXJhbSBzaXhUYXJnZXRWZWN0b3JzIEFuIGFycmF5IG9mIDYgdmVjdG9ycywgdG8gc3RvcmUgdGhlIHJlc3VsdGluZyBzaWRlIG5vcm1hbHMgaW4uCiAgICAgKiBAcGFyYW0gcXVhdCBPcmllbnRhdGlvbiB0byBhcHBseSB0byB0aGUgbm9ybWFsIHZlY3RvcnMuIElmIG5vdCBwcm92aWRlZCwgdGhlIHZlY3RvcnMgd2lsbCBiZSBpbiByZXNwZWN0IHRvIHRoZSBsb2NhbCBmcmFtZS4KICAgICAqLwoKCiAgICBnZXRTaWRlTm9ybWFscyhzaXhUYXJnZXRWZWN0b3JzLCBxdWF0KSB7CiAgICAgIGNvbnN0IHNpZGVzID0gc2l4VGFyZ2V0VmVjdG9yczsKICAgICAgY29uc3QgZXggPSB0aGlzLmhhbGZFeHRlbnRzOwogICAgICBzaWRlc1swXS5zZXQoZXgueCwgMCwgMCk7CiAgICAgIHNpZGVzWzFdLnNldCgwLCBleC55LCAwKTsKICAgICAgc2lkZXNbMl0uc2V0KDAsIDAsIGV4LnopOwogICAgICBzaWRlc1szXS5zZXQoLWV4LngsIDAsIDApOwogICAgICBzaWRlc1s0XS5zZXQoMCwgLWV4LnksIDApOwogICAgICBzaWRlc1s1XS5zZXQoMCwgMCwgLWV4LnopOwoKICAgICAgaWYgKHF1YXQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBzaWRlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgcXVhdC52bXVsdChzaWRlc1tpXSwgc2lkZXNbaV0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHNpZGVzOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSB2b2x1bWUgb2YgdGhlIGJveC4KICAgICAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA4LjAgKiB0aGlzLmhhbGZFeHRlbnRzLnggKiB0aGlzLmhhbGZFeHRlbnRzLnkgKiB0aGlzLmhhbGZFeHRlbnRzLno7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSB0aGlzLmhhbGZFeHRlbnRzLmxlbmd0aCgpOwogICAgfQogICAgLyoqCiAgICAgKiBmb3JFYWNoV29ybGRDb3JuZXIKICAgICAqLwoKCiAgICBmb3JFYWNoV29ybGRDb3JuZXIocG9zLCBxdWF0LCBjYWxsYmFjaykgewogICAgICBjb25zdCBlID0gdGhpcy5oYWxmRXh0ZW50czsKICAgICAgY29uc3QgY29ybmVycyA9IFtbZS54LCBlLnksIGUuel0sIFstZS54LCBlLnksIGUuel0sIFstZS54LCAtZS55LCBlLnpdLCBbLWUueCwgLWUueSwgLWUuel0sIFtlLngsIC1lLnksIC1lLnpdLCBbZS54LCBlLnksIC1lLnpdLCBbLWUueCwgZS55LCAtZS56XSwgW2UueCwgLWUueSwgZS56XV07CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvcm5lcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICB3b3JsZENvcm5lclRlbXBQb3Muc2V0KGNvcm5lcnNbaV1bMF0sIGNvcm5lcnNbaV1bMV0sIGNvcm5lcnNbaV1bMl0pOwogICAgICAgIHF1YXQudm11bHQod29ybGRDb3JuZXJUZW1wUG9zLCB3b3JsZENvcm5lclRlbXBQb3MpOwogICAgICAgIHBvcy52YWRkKHdvcmxkQ29ybmVyVGVtcFBvcywgd29ybGRDb3JuZXJUZW1wUG9zKTsKICAgICAgICBjYWxsYmFjayh3b3JsZENvcm5lclRlbXBQb3MueCwgd29ybGRDb3JuZXJUZW1wUG9zLnksIHdvcmxkQ29ybmVyVGVtcFBvcy56KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBjYWxjdWxhdGVXb3JsZEFBQkIKICAgICAqLwoKCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICBjb25zdCBlID0gdGhpcy5oYWxmRXh0ZW50czsKICAgICAgd29ybGRDb3JuZXJzVGVtcFswXS5zZXQoZS54LCBlLnksIGUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbMV0uc2V0KC1lLngsIGUueSwgZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFsyXS5zZXQoLWUueCwgLWUueSwgZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFszXS5zZXQoLWUueCwgLWUueSwgLWUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbNF0uc2V0KGUueCwgLWUueSwgLWUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbNV0uc2V0KGUueCwgZS55LCAtZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFs2XS5zZXQoLWUueCwgZS55LCAtZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFs3XS5zZXQoZS54LCAtZS55LCBlLnopOwogICAgICBjb25zdCB3YyA9IHdvcmxkQ29ybmVyc1RlbXBbMF07CiAgICAgIHF1YXQudm11bHQod2MsIHdjKTsKICAgICAgcG9zLnZhZGQod2MsIHdjKTsKICAgICAgbWF4LmNvcHkod2MpOwogICAgICBtaW4uY29weSh3Yyk7CgogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IDg7IGkrKykgewogICAgICAgIGNvbnN0IHdjID0gd29ybGRDb3JuZXJzVGVtcFtpXTsKICAgICAgICBxdWF0LnZtdWx0KHdjLCB3Yyk7CiAgICAgICAgcG9zLnZhZGQod2MsIHdjKTsKICAgICAgICBjb25zdCB4ID0gd2MueDsKICAgICAgICBjb25zdCB5ID0gd2MueTsKICAgICAgICBjb25zdCB6ID0gd2MuejsKCiAgICAgICAgaWYgKHggPiBtYXgueCkgewogICAgICAgICAgbWF4LnggPSB4OwogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPiBtYXgueSkgewogICAgICAgICAgbWF4LnkgPSB5OwogICAgICAgIH0KCiAgICAgICAgaWYgKHogPiBtYXgueikgewogICAgICAgICAgbWF4LnogPSB6OwogICAgICAgIH0KCiAgICAgICAgaWYgKHggPCBtaW4ueCkgewogICAgICAgICAgbWluLnggPSB4OwogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPCBtaW4ueSkgewogICAgICAgICAgbWluLnkgPSB5OwogICAgICAgIH0KCiAgICAgICAgaWYgKHogPCBtaW4ueikgewogICAgICAgICAgbWluLnogPSB6OwogICAgICAgIH0KICAgICAgfSAvLyBHZXQgZWFjaCBheGlzIG1heAogICAgICAvLyBtaW4uc2V0KEluZmluaXR5LEluZmluaXR5LEluZmluaXR5KTsKICAgICAgLy8gbWF4LnNldCgtSW5maW5pdHksLUluZmluaXR5LC1JbmZpbml0eSk7CiAgICAgIC8vIHRoaXMuZm9yRWFjaFdvcmxkQ29ybmVyKHBvcyxxdWF0LGZ1bmN0aW9uKHgseSx6KXsKICAgICAgLy8gICAgIGlmKHggPiBtYXgueCl7CiAgICAgIC8vICAgICAgICAgbWF4LnggPSB4OwogICAgICAvLyAgICAgfQogICAgICAvLyAgICAgaWYoeSA+IG1heC55KXsKICAgICAgLy8gICAgICAgICBtYXgueSA9IHk7CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgICBpZih6ID4gbWF4LnopewogICAgICAvLyAgICAgICAgIG1heC56ID0gejsKICAgICAgLy8gICAgIH0KICAgICAgLy8gICAgIGlmKHggPCBtaW4ueCl7CiAgICAgIC8vICAgICAgICAgbWluLnggPSB4OwogICAgICAvLyAgICAgfQogICAgICAvLyAgICAgaWYoeSA8IG1pbi55KXsKICAgICAgLy8gICAgICAgICBtaW4ueSA9IHk7CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgICBpZih6IDwgbWluLnopewogICAgICAvLyAgICAgICAgIG1pbi56ID0gejsKICAgICAgLy8gICAgIH0KICAgICAgLy8gfSk7CgogICAgfQoKICB9CiAgY29uc3Qgd29ybGRDb3JuZXJUZW1wUG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCB3b3JsZENvcm5lcnNUZW1wID0gW25ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCldOwoKICAvKioKICAgKiBCT0RZX1RZUEVTCiAgICovCiAgY29uc3QgQk9EWV9UWVBFUyA9IHsKICAgIC8qKiBEWU5BTUlDICovCiAgICBEWU5BTUlDOiAxLAoKICAgIC8qKiBTVEFUSUMgKi8KICAgIFNUQVRJQzogMiwKCiAgICAvKiogS0lORU1BVElDICovCiAgICBLSU5FTUFUSUM6IDQKICB9OwogIC8qKgogICAqIEJvZHlUeXBlCiAgICovCgogIC8qKgogICAqIEJPRFlfU0xFRVBfU1RBVEVTCiAgICovCiAgY29uc3QgQk9EWV9TTEVFUF9TVEFURVMgPSB7CiAgICAvKiogQVdBS0UgKi8KICAgIEFXQUtFOiAwLAoKICAgIC8qKiBTTEVFUFkgKi8KICAgIFNMRUVQWTogMSwKCiAgICAvKiogU0xFRVBJTkcgKi8KICAgIFNMRUVQSU5HOiAyCiAgfTsKICAvKioKICAgKiBCb2R5U2xlZXBTdGF0ZQogICAqLwoKICAvKioKICAgKiBCYXNlIGNsYXNzIGZvciBhbGwgYm9keSB0eXBlcy4KICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCBzaGFwZSA9IG5ldyBDQU5OT04uU3BoZXJlKDEpCiAgICogICAgIGNvbnN0IGJvZHkgPSBuZXcgQ0FOTk9OLkJvZHkoewogICAqICAgICAgIG1hc3M6IDEsCiAgICogICAgICAgc2hhcGUsCiAgICogICAgIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoYm9keSkKICAgKi8KICBjbGFzcyBCb2R5IGV4dGVuZHMgRXZlbnRUYXJnZXQgewogICAgLyoqCiAgICAgKiBEaXNwYXRjaGVkIGFmdGVyIHR3byBib2RpZXMgY29sbGlkZS4gVGhpcyBldmVudCBpcyBkaXNwYXRjaGVkIG9uIGVhY2gKICAgICAqIG9mIHRoZSB0d28gYm9kaWVzIGludm9sdmVkIGluIHRoZSBjb2xsaXNpb24uCiAgICAgKiBAZXZlbnQgY29sbGlkZQogICAgICogQHBhcmFtIGJvZHkgVGhlIGJvZHkgdGhhdCB3YXMgaW52b2x2ZWQgaW4gdGhlIGNvbGxpc2lvbi4KICAgICAqIEBwYXJhbSBjb250YWN0IFRoZSBkZXRhaWxzIG9mIHRoZSBjb2xsaXNpb24uCiAgICAgKi8KCiAgICAvKioKICAgICAqIEEgZHluYW1pYyBib2R5IGlzIGZ1bGx5IHNpbXVsYXRlZC4gQ2FuIGJlIG1vdmVkIG1hbnVhbGx5IGJ5IHRoZSB1c2VyLCBidXQgbm9ybWFsbHkgdGhleSBtb3ZlIGFjY29yZGluZyB0byBmb3JjZXMuIEEgZHluYW1pYyBib2R5IGNhbiBjb2xsaWRlIHdpdGggYWxsIGJvZHkgdHlwZXMuIEEgZHluYW1pYyBib2R5IGFsd2F5cyBoYXMgZmluaXRlLCBub24temVybyBtYXNzLgogICAgICovCgogICAgLyoqCiAgICAgKiBBIHN0YXRpYyBib2R5IGRvZXMgbm90IG1vdmUgZHVyaW5nIHNpbXVsYXRpb24gYW5kIGJlaGF2ZXMgYXMgaWYgaXQgaGFzIGluZmluaXRlIG1hc3MuIFN0YXRpYyBib2RpZXMgY2FuIGJlIG1vdmVkIG1hbnVhbGx5IGJ5IHNldHRpbmcgdGhlIHBvc2l0aW9uIG9mIHRoZSBib2R5LiBUaGUgdmVsb2NpdHkgb2YgYSBzdGF0aWMgYm9keSBpcyBhbHdheXMgemVyby4gU3RhdGljIGJvZGllcyBkbyBub3QgY29sbGlkZSB3aXRoIG90aGVyIHN0YXRpYyBvciBraW5lbWF0aWMgYm9kaWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBBIGtpbmVtYXRpYyBib2R5IG1vdmVzIHVuZGVyIHNpbXVsYXRpb24gYWNjb3JkaW5nIHRvIGl0cyB2ZWxvY2l0eS4gVGhleSBkbyBub3QgcmVzcG9uZCB0byBmb3JjZXMuIFRoZXkgY2FuIGJlIG1vdmVkIG1hbnVhbGx5LCBidXQgbm9ybWFsbHkgYSBraW5lbWF0aWMgYm9keSBpcyBtb3ZlZCBieSBzZXR0aW5nIGl0cyB2ZWxvY2l0eS4gQSBraW5lbWF0aWMgYm9keSBiZWhhdmVzIGFzIGlmIGl0IGhhcyBpbmZpbml0ZSBtYXNzLiBLaW5lbWF0aWMgYm9kaWVzIGRvIG5vdCBjb2xsaWRlIHdpdGggb3RoZXIgc3RhdGljIG9yIGtpbmVtYXRpYyBib2RpZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFXQUtFCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNMRUVQWQogICAgICovCgogICAgLyoqCiAgICAgKiBTTEVFUElORwogICAgICovCgogICAgLyoqCiAgICAgKiBEaXNwYXRjaGVkIGFmdGVyIGEgc2xlZXBpbmcgYm9keSBoYXMgd29rZW4gdXAuCiAgICAgKiBAZXZlbnQgd2FrZXVwCiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBnb25lIGluIHRvIHRoZSBzbGVlcHkgc3RhdGUuCiAgICAgKiBAZXZlbnQgc2xlZXB5CiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBmYWxsZW4gYXNsZWVwLgogICAgICogQGV2ZW50IHNsZWVwCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5pZCA9IEJvZHkuaWRDb3VudGVyKys7CiAgICAgIHRoaXMuaW5kZXggPSAtMTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICAgIHRoaXMudmxhbWJkYSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSB0eXBlb2Ygb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9PT0gJ251bWJlcicgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrID0gdHlwZW9mIG9wdGlvbnMuY29sbGlzaW9uRmlsdGVyTWFzayA9PT0gJ251bWJlcicgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgOiAtMTsKICAgICAgdGhpcy5jb2xsaXNpb25SZXNwb25zZSA9IHR5cGVvZiBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlID09PSAnYm9vbGVhbicgPyBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlIDogdHJ1ZTsKICAgICAgdGhpcy5wb3NpdGlvbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucHJldmlvdXNQb3NpdGlvbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaW50ZXJwb2xhdGVkUG9zaXRpb24gPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmluaXRQb3NpdGlvbiA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy5wb3NpdGlvbikgewogICAgICAgIHRoaXMucG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgICB0aGlzLnByZXZpb3VzUG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgICB0aGlzLmludGVycG9sYXRlZFBvc2l0aW9uLmNvcHkob3B0aW9ucy5wb3NpdGlvbik7CiAgICAgICAgdGhpcy5pbml0UG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgfQoKICAgICAgdGhpcy52ZWxvY2l0eSA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy52ZWxvY2l0eSkgewogICAgICAgIHRoaXMudmVsb2NpdHkuY29weShvcHRpb25zLnZlbG9jaXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5pbml0VmVsb2NpdHkgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmZvcmNlID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgbWFzcyA9IHR5cGVvZiBvcHRpb25zLm1hc3MgPT09ICdudW1iZXInID8gb3B0aW9ucy5tYXNzIDogMDsKICAgICAgdGhpcy5tYXNzID0gbWFzczsKICAgICAgdGhpcy5pbnZNYXNzID0gbWFzcyA+IDAgPyAxLjAgLyBtYXNzIDogMDsKICAgICAgdGhpcy5tYXRlcmlhbCA9IG9wdGlvbnMubWF0ZXJpYWwgfHwgbnVsbDsKICAgICAgdGhpcy5saW5lYXJEYW1waW5nID0gdHlwZW9mIG9wdGlvbnMubGluZWFyRGFtcGluZyA9PT0gJ251bWJlcicgPyBvcHRpb25zLmxpbmVhckRhbXBpbmcgOiAwLjAxOwogICAgICB0aGlzLnR5cGUgPSBtYXNzIDw9IDAuMCA/IEJvZHkuU1RBVElDIDogQm9keS5EWU5BTUlDOwoKICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnR5cGUgPT09IHR5cGVvZiBCb2R5LlNUQVRJQykgewogICAgICAgIHRoaXMudHlwZSA9IG9wdGlvbnMudHlwZTsKICAgICAgfQoKICAgICAgdGhpcy5hbGxvd1NsZWVwID0gdHlwZW9mIG9wdGlvbnMuYWxsb3dTbGVlcCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFsbG93U2xlZXAgOiB0cnVlOwogICAgICB0aGlzLnNsZWVwU3RhdGUgPSBCb2R5LkFXQUtFOwogICAgICB0aGlzLnNsZWVwU3BlZWRMaW1pdCA9IHR5cGVvZiBvcHRpb25zLnNsZWVwU3BlZWRMaW1pdCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLnNsZWVwU3BlZWRMaW1pdCA6IDAuMTsKICAgICAgdGhpcy5zbGVlcFRpbWVMaW1pdCA9IHR5cGVvZiBvcHRpb25zLnNsZWVwVGltZUxpbWl0ICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuc2xlZXBUaW1lTGltaXQgOiAxOwogICAgICB0aGlzLnRpbWVMYXN0U2xlZXB5ID0gMDsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CiAgICAgIHRoaXMudG9ycXVlID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5xdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgdGhpcy5pbml0UXVhdGVybmlvbiA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgdGhpcy5pbnRlcnBvbGF0ZWRRdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgICAgIGlmIChvcHRpb25zLnF1YXRlcm5pb24pIHsKICAgICAgICB0aGlzLnF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICAgIHRoaXMuaW5pdFF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uLmNvcHkob3B0aW9ucy5xdWF0ZXJuaW9uKTsKICAgICAgICB0aGlzLmludGVycG9sYXRlZFF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICB9CgogICAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eSA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy5hbmd1bGFyVmVsb2NpdHkpIHsKICAgICAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eS5jb3B5KG9wdGlvbnMuYW5ndWxhclZlbG9jaXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5pbml0QW5ndWxhclZlbG9jaXR5ID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5zaGFwZXMgPSBbXTsKICAgICAgdGhpcy5zaGFwZU9mZnNldHMgPSBbXTsKICAgICAgdGhpcy5zaGFwZU9yaWVudGF0aW9ucyA9IFtdOwogICAgICB0aGlzLmluZXJ0aWEgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWEgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWFXb3JsZCA9IG5ldyBNYXQzKCk7CiAgICAgIHRoaXMuaW52TWFzc1NvbHZlID0gMDsKICAgICAgdGhpcy5pbnZJbmVydGlhU29sdmUgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWFXb3JsZFNvbHZlID0gbmV3IE1hdDMoKTsKICAgICAgdGhpcy5maXhlZFJvdGF0aW9uID0gdHlwZW9mIG9wdGlvbnMuZml4ZWRSb3RhdGlvbiAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmZpeGVkUm90YXRpb24gOiBmYWxzZTsKICAgICAgdGhpcy5hbmd1bGFyRGFtcGluZyA9IHR5cGVvZiBvcHRpb25zLmFuZ3VsYXJEYW1waW5nICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuYW5ndWxhckRhbXBpbmcgOiAwLjAxOwogICAgICB0aGlzLmxpbmVhckZhY3RvciA9IG5ldyBWZWMzKDEsIDEsIDEpOwoKICAgICAgaWYgKG9wdGlvbnMubGluZWFyRmFjdG9yKSB7CiAgICAgICAgdGhpcy5saW5lYXJGYWN0b3IuY29weShvcHRpb25zLmxpbmVhckZhY3Rvcik7CiAgICAgIH0KCiAgICAgIHRoaXMuYW5ndWxhckZhY3RvciA9IG5ldyBWZWMzKDEsIDEsIDEpOwoKICAgICAgaWYgKG9wdGlvbnMuYW5ndWxhckZhY3RvcikgewogICAgICAgIHRoaXMuYW5ndWxhckZhY3Rvci5jb3B5KG9wdGlvbnMuYW5ndWxhckZhY3Rvcik7CiAgICAgIH0KCiAgICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7CiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgdGhpcy5ib3VuZGluZ1JhZGl1cyA9IDA7CiAgICAgIHRoaXMud2xhbWJkYSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaXNUcmlnZ2VyID0gQm9vbGVhbihvcHRpb25zLmlzVHJpZ2dlcik7CgogICAgICBpZiAob3B0aW9ucy5zaGFwZSkgewogICAgICAgIHRoaXMuYWRkU2hhcGUob3B0aW9ucy5zaGFwZSk7CiAgICAgIH0KCiAgICAgIHRoaXMudXBkYXRlTWFzc1Byb3BlcnRpZXMoKTsKICAgIH0KICAgIC8qKgogICAgICogV2FrZSB0aGUgYm9keSB1cC4KICAgICAqLwoKCiAgICB3YWtlVXAoKSB7CiAgICAgIGNvbnN0IHByZXZTdGF0ZSA9IHRoaXMuc2xlZXBTdGF0ZTsKICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5BV0FLRTsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CgogICAgICBpZiAocHJldlN0YXRlID09PSBCb2R5LlNMRUVQSU5HKSB7CiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KEJvZHkud2FrZXVwRXZlbnQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEZvcmNlIGJvZHkgc2xlZXAKICAgICAqLwoKCiAgICBzbGVlcCgpIHsKICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5TTEVFUElORzsKICAgICAgdGhpcy52ZWxvY2l0eS5zZXQoMCwgMCwgMCk7CiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LnNldCgwLCAwLCAwKTsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIENhbGxlZCBldmVyeSB0aW1lc3RlcCB0byB1cGRhdGUgaW50ZXJuYWwgc2xlZXAgdGltZXIgYW5kIGNoYW5nZSBzbGVlcCBzdGF0ZSBpZiBuZWVkZWQuCiAgICAgKiBAcGFyYW0gdGltZSBUaGUgd29ybGQgdGltZSBpbiBzZWNvbmRzCiAgICAgKi8KCgogICAgc2xlZXBUaWNrKHRpbWUpIHsKICAgICAgaWYgKHRoaXMuYWxsb3dTbGVlcCkgewogICAgICAgIGNvbnN0IHNsZWVwU3RhdGUgPSB0aGlzLnNsZWVwU3RhdGU7CiAgICAgICAgY29uc3Qgc3BlZWRTcXVhcmVkID0gdGhpcy52ZWxvY2l0eS5sZW5ndGhTcXVhcmVkKCkgKyB0aGlzLmFuZ3VsYXJWZWxvY2l0eS5sZW5ndGhTcXVhcmVkKCk7CiAgICAgICAgY29uc3Qgc3BlZWRMaW1pdFNxdWFyZWQgPSB0aGlzLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICBpZiAoc2xlZXBTdGF0ZSA9PT0gQm9keS5BV0FLRSAmJiBzcGVlZFNxdWFyZWQgPCBzcGVlZExpbWl0U3F1YXJlZCkgewogICAgICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5TTEVFUFk7IC8vIFNsZWVweQoKICAgICAgICAgIHRoaXMudGltZUxhc3RTbGVlcHkgPSB0aW1lOwogICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KEJvZHkuc2xlZXB5RXZlbnQpOwogICAgICAgIH0gZWxzZSBpZiAoc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUFkgJiYgc3BlZWRTcXVhcmVkID4gc3BlZWRMaW1pdFNxdWFyZWQpIHsKICAgICAgICAgIHRoaXMud2FrZVVwKCk7IC8vIFdha2UgdXAKICAgICAgICB9IGVsc2UgaWYgKHNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBZICYmIHRpbWUgLSB0aGlzLnRpbWVMYXN0U2xlZXB5ID4gdGhpcy5zbGVlcFRpbWVMaW1pdCkgewogICAgICAgICAgdGhpcy5zbGVlcCgpOyAvLyBTbGVlcGluZwoKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChCb2R5LnNsZWVwRXZlbnQpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBJZiB0aGUgYm9keSBpcyBzbGVlcGluZywgaXQgc2hvdWxkIGJlIGltbW92YWJsZSAvIGhhdmUgaW5maW5pdGUgbWFzcyBkdXJpbmcgc29sdmUuIFdlIHNvbHZlIGl0IGJ5IGhhdmluZyBhIHNlcGFyYXRlICJzb2x2ZSBtYXNzIi4KICAgICAqLwoKCiAgICB1cGRhdGVTb2x2ZU1hc3NQcm9wZXJ0aWVzKCkgewogICAgICBpZiAodGhpcy5zbGVlcFN0YXRlID09PSBCb2R5LlNMRUVQSU5HIHx8IHRoaXMudHlwZSA9PT0gQm9keS5LSU5FTUFUSUMpIHsKICAgICAgICB0aGlzLmludk1hc3NTb2x2ZSA9IDA7CiAgICAgICAgdGhpcy5pbnZJbmVydGlhU29sdmUuc2V0WmVybygpOwogICAgICAgIHRoaXMuaW52SW5lcnRpYVdvcmxkU29sdmUuc2V0WmVybygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaW52TWFzc1NvbHZlID0gdGhpcy5pbnZNYXNzOwogICAgICAgIHRoaXMuaW52SW5lcnRpYVNvbHZlLmNvcHkodGhpcy5pbnZJbmVydGlhKTsKICAgICAgICB0aGlzLmludkluZXJ0aWFXb3JsZFNvbHZlLmNvcHkodGhpcy5pbnZJbmVydGlhV29ybGQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgYSB3b3JsZCBwb2ludCB0byBsb2NhbCBib2R5IGZyYW1lLgogICAgICovCgoKICAgIHBvaW50VG9Mb2NhbEZyYW1lKHdvcmxkUG9pbnQsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB3b3JsZFBvaW50LnZzdWIodGhpcy5wb3NpdGlvbiwgcmVzdWx0KTsKICAgICAgdGhpcy5xdWF0ZXJuaW9uLmNvbmp1Z2F0ZSgpLnZtdWx0KHJlc3VsdCwgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCBhIHdvcmxkIHZlY3RvciB0byBsb2NhbCBib2R5IGZyYW1lLgogICAgICovCgoKICAgIHZlY3RvclRvTG9jYWxGcmFtZSh3b3JsZFZlY3RvciwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMucXVhdGVybmlvbi5jb25qdWdhdGUoKS52bXVsdCh3b3JsZFZlY3RvciwgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCBhIGxvY2FsIGJvZHkgcG9pbnQgdG8gd29ybGQgZnJhbWUuCiAgICAgKi8KCgogICAgcG9pbnRUb1dvcmxkRnJhbWUobG9jYWxQb2ludCwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMucXVhdGVybmlvbi52bXVsdChsb2NhbFBvaW50LCByZXN1bHQpOwogICAgICByZXN1bHQudmFkZCh0aGlzLnBvc2l0aW9uLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0IGEgbG9jYWwgYm9keSBwb2ludCB0byB3b3JsZCBmcmFtZS4KICAgICAqLwoKCiAgICB2ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxWZWN0b3IsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0aGlzLnF1YXRlcm5pb24udm11bHQobG9jYWxWZWN0b3IsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIEFkZCBhIHNoYXBlIHRvIHRoZSBib2R5IHdpdGggYSBsb2NhbCBvZmZzZXQgYW5kIG9yaWVudGF0aW9uLgogICAgICogQHJldHVybiBUaGUgYm9keSBvYmplY3QsIGZvciBjaGFpbmFiaWxpdHkuCiAgICAgKi8KCgogICAgYWRkU2hhcGUoc2hhcGUsIF9vZmZzZXQsIF9vcmllbnRhdGlvbikgewogICAgICBjb25zdCBvZmZzZXQgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBvcmllbnRhdGlvbiA9IG5ldyBRdWF0ZXJuaW9uKCk7CgogICAgICBpZiAoX29mZnNldCkgewogICAgICAgIG9mZnNldC5jb3B5KF9vZmZzZXQpOwogICAgICB9CgogICAgICBpZiAoX29yaWVudGF0aW9uKSB7CiAgICAgICAgb3JpZW50YXRpb24uY29weShfb3JpZW50YXRpb24pOwogICAgICB9CgogICAgICB0aGlzLnNoYXBlcy5wdXNoKHNoYXBlKTsKICAgICAgdGhpcy5zaGFwZU9mZnNldHMucHVzaChvZmZzZXQpOwogICAgICB0aGlzLnNoYXBlT3JpZW50YXRpb25zLnB1c2gob3JpZW50YXRpb24pOwogICAgICB0aGlzLnVwZGF0ZU1hc3NQcm9wZXJ0aWVzKCk7CiAgICAgIHRoaXMudXBkYXRlQm91bmRpbmdSYWRpdXMoKTsKICAgICAgdGhpcy5hYWJiTmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICBzaGFwZS5ib2R5ID0gdGhpczsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZSBhIHNoYXBlIGZyb20gdGhlIGJvZHkuCiAgICAgKiBAcmV0dXJuIFRoZSBib2R5IG9iamVjdCwgZm9yIGNoYWluYWJpbGl0eS4KICAgICAqLwoKCiAgICByZW1vdmVTaGFwZShzaGFwZSkgewogICAgICBjb25zdCBpbmRleCA9IHRoaXMuc2hhcGVzLmluZGV4T2Yoc2hhcGUpOwoKICAgICAgaWYgKGluZGV4ID09PSAtMSkgewogICAgICAgIGNvbnNvbGUud2FybignU2hhcGUgZG9lcyBub3QgYmVsb25nIHRvIHRoZSBib2R5Jyk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIHRoaXMuc2hhcGVzLnNwbGljZShpbmRleCwgMSk7CiAgICAgIHRoaXMuc2hhcGVPZmZzZXRzLnNwbGljZShpbmRleCwgMSk7CiAgICAgIHRoaXMuc2hhcGVPcmllbnRhdGlvbnMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgdGhpcy51cGRhdGVNYXNzUHJvcGVydGllcygpOwogICAgICB0aGlzLnVwZGF0ZUJvdW5kaW5nUmFkaXVzKCk7CiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgc2hhcGUuYm9keSA9IG51bGw7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgdGhlIGJvdW5kaW5nIHJhZGl1cyBvZiB0aGUgYm9keS4gU2hvdWxkIGJlIGRvbmUgaWYgYW55IG9mIHRoZSBzaGFwZXMgYXJlIGNoYW5nZWQuCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdSYWRpdXMoKSB7CiAgICAgIGNvbnN0IHNoYXBlcyA9IHRoaXMuc2hhcGVzOwogICAgICBjb25zdCBzaGFwZU9mZnNldHMgPSB0aGlzLnNoYXBlT2Zmc2V0czsKICAgICAgY29uc3QgTiA9IHNoYXBlcy5sZW5ndGg7CiAgICAgIGxldCByYWRpdXMgPSAwOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IHNoYXBlID0gc2hhcGVzW2ldOwogICAgICAgIHNoYXBlLnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7CiAgICAgICAgY29uc3Qgb2Zmc2V0ID0gc2hhcGVPZmZzZXRzW2ldLmxlbmd0aCgpOwogICAgICAgIGNvbnN0IHIgPSBzaGFwZS5ib3VuZGluZ1NwaGVyZVJhZGl1czsKCiAgICAgICAgaWYgKG9mZnNldCArIHIgPiByYWRpdXMpIHsKICAgICAgICAgIHJhZGl1cyA9IG9mZnNldCArIHI7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmJvdW5kaW5nUmFkaXVzID0gcmFkaXVzOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGVzIHRoZSAuYWFiYgogICAgICovCgoKICAgIHVwZGF0ZUFBQkIoKSB7CiAgICAgIGNvbnN0IHNoYXBlcyA9IHRoaXMuc2hhcGVzOwogICAgICBjb25zdCBzaGFwZU9mZnNldHMgPSB0aGlzLnNoYXBlT2Zmc2V0czsKICAgICAgY29uc3Qgc2hhcGVPcmllbnRhdGlvbnMgPSB0aGlzLnNoYXBlT3JpZW50YXRpb25zOwogICAgICBjb25zdCBOID0gc2hhcGVzLmxlbmd0aDsKICAgICAgY29uc3Qgb2Zmc2V0ID0gdG1wVmVjOwogICAgICBjb25zdCBvcmllbnRhdGlvbiA9IHRtcFF1YXQ7CiAgICAgIGNvbnN0IGJvZHlRdWF0ID0gdGhpcy5xdWF0ZXJuaW9uOwogICAgICBjb25zdCBhYWJiID0gdGhpcy5hYWJiOwogICAgICBjb25zdCBzaGFwZUFBQkIgPSB1cGRhdGVBQUJCX3NoYXBlQUFCQjsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBzaGFwZSA9IHNoYXBlc1tpXTsgLy8gR2V0IHNoYXBlIHdvcmxkIHBvc2l0aW9uCgogICAgICAgIGJvZHlRdWF0LnZtdWx0KHNoYXBlT2Zmc2V0c1tpXSwgb2Zmc2V0KTsKICAgICAgICBvZmZzZXQudmFkZCh0aGlzLnBvc2l0aW9uLCBvZmZzZXQpOyAvLyBHZXQgc2hhcGUgd29ybGQgcXVhdGVybmlvbgoKICAgICAgICBib2R5UXVhdC5tdWx0KHNoYXBlT3JpZW50YXRpb25zW2ldLCBvcmllbnRhdGlvbik7IC8vIEdldCBzaGFwZSBBQUJCCgogICAgICAgIHNoYXBlLmNhbGN1bGF0ZVdvcmxkQUFCQihvZmZzZXQsIG9yaWVudGF0aW9uLCBzaGFwZUFBQkIubG93ZXJCb3VuZCwgc2hhcGVBQUJCLnVwcGVyQm91bmQpOwoKICAgICAgICBpZiAoaSA9PT0gMCkgewogICAgICAgICAgYWFiYi5jb3B5KHNoYXBlQUFCQik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGFhYmIuZXh0ZW5kKHNoYXBlQUFCQik7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmFhYmJOZWVkc1VwZGF0ZSA9IGZhbHNlOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgYC5pbmVydGlhV29ybGRgIGFuZCBgLmludkluZXJ0aWFXb3JsZGAKICAgICAqLwoKCiAgICB1cGRhdGVJbmVydGlhV29ybGQoZm9yY2UpIHsKICAgICAgY29uc3QgSSA9IHRoaXMuaW52SW5lcnRpYTsKCiAgICAgIGlmIChJLnggPT09IEkueSAmJiBJLnkgPT09IEkueiAmJiAhZm9yY2UpIDsgZWxzZSB7CiAgICAgICAgY29uc3QgbTEgPSB1aXdfbTE7CiAgICAgICAgY29uc3QgbTIgPSB1aXdfbTI7CiAgICAgICAgbTEuc2V0Um90YXRpb25Gcm9tUXVhdGVybmlvbih0aGlzLnF1YXRlcm5pb24pOwogICAgICAgIG0xLnRyYW5zcG9zZShtMik7CiAgICAgICAgbTEuc2NhbGUoSSwgbTEpOwogICAgICAgIG0xLm1tdWx0KG0yLCB0aGlzLmludkluZXJ0aWFXb3JsZCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQXBwbHkgZm9yY2UgdG8gYSBwb2ludCBvZiB0aGUgYm9keS4gVGhpcyBjb3VsZCBmb3IgZXhhbXBsZSBiZSBhIHBvaW50IG9uIHRoZSBCb2R5IHN1cmZhY2UuCiAgICAgKiBBcHBseWluZyBmb3JjZSB0aGlzIHdheSB3aWxsIGFkZCB0byBCb2R5LmZvcmNlIGFuZCBCb2R5LnRvcnF1ZS4KICAgICAqIEBwYXJhbSBmb3JjZSBUaGUgYW1vdW50IG9mIGZvcmNlIHRvIGFkZC4KICAgICAqIEBwYXJhbSByZWxhdGl2ZVBvaW50IEEgcG9pbnQgcmVsYXRpdmUgdG8gdGhlIGNlbnRlciBvZiBtYXNzIHRvIGFwcGx5IHRoZSBmb3JjZSBvbi4KICAgICAqLwoKCiAgICBhcHBseUZvcmNlKGZvcmNlLCByZWxhdGl2ZVBvaW50KSB7CiAgICAgIGlmIChyZWxhdGl2ZVBvaW50ID09PSB2b2lkIDApIHsKICAgICAgICByZWxhdGl2ZVBvaW50ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgLy8gTmVlZGVkPwogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICB0aGlzLndha2VVcCgpOwogICAgICB9IC8vIENvbXB1dGUgcHJvZHVjZWQgcm90YXRpb25hbCBmb3JjZQoKCiAgICAgIGNvbnN0IHJvdEZvcmNlID0gQm9keV9hcHBseUZvcmNlX3JvdEZvcmNlOwogICAgICByZWxhdGl2ZVBvaW50LmNyb3NzKGZvcmNlLCByb3RGb3JjZSk7IC8vIEFkZCBsaW5lYXIgZm9yY2UKCiAgICAgIHRoaXMuZm9yY2UudmFkZChmb3JjZSwgdGhpcy5mb3JjZSk7IC8vIEFkZCByb3RhdGlvbmFsIGZvcmNlCgogICAgICB0aGlzLnRvcnF1ZS52YWRkKHJvdEZvcmNlLCB0aGlzLnRvcnF1ZSk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IGZvcmNlIHRvIGEgbG9jYWwgcG9pbnQgaW4gdGhlIGJvZHkuCiAgICAgKiBAcGFyYW0gZm9yY2UgVGhlIGZvcmNlIHZlY3RvciB0byBhcHBseSwgZGVmaW5lZCBsb2NhbGx5IGluIHRoZSBib2R5IGZyYW1lLgogICAgICogQHBhcmFtIGxvY2FsUG9pbnQgQSBsb2NhbCBwb2ludCBpbiB0aGUgYm9keSB0byBhcHBseSB0aGUgZm9yY2Ugb24uCiAgICAgKi8KCgogICAgYXBwbHlMb2NhbEZvcmNlKGxvY2FsRm9yY2UsIGxvY2FsUG9pbnQpIHsKICAgICAgaWYgKGxvY2FsUG9pbnQgPT09IHZvaWQgMCkgewogICAgICAgIGxvY2FsUG9pbnQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHdvcmxkRm9yY2UgPSBCb2R5X2FwcGx5TG9jYWxGb3JjZV93b3JsZEZvcmNlOwogICAgICBjb25zdCByZWxhdGl2ZVBvaW50V29ybGQgPSBCb2R5X2FwcGx5TG9jYWxGb3JjZV9yZWxhdGl2ZVBvaW50V29ybGQ7IC8vIFRyYW5zZm9ybSB0aGUgZm9yY2UgdmVjdG9yIHRvIHdvcmxkIHNwYWNlCgogICAgICB0aGlzLnZlY3RvclRvV29ybGRGcmFtZShsb2NhbEZvcmNlLCB3b3JsZEZvcmNlKTsKICAgICAgdGhpcy52ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxQb2ludCwgcmVsYXRpdmVQb2ludFdvcmxkKTsKICAgICAgdGhpcy5hcHBseUZvcmNlKHdvcmxkRm9yY2UsIHJlbGF0aXZlUG9pbnRXb3JsZCk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IHRvcnF1ZSB0byB0aGUgYm9keS4KICAgICAqIEBwYXJhbSB0b3JxdWUgVGhlIGFtb3VudCBvZiB0b3JxdWUgdG8gYWRkLgogICAgICovCgoKICAgIGFwcGx5VG9ycXVlKHRvcnF1ZSkgewogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICB0aGlzLndha2VVcCgpOwogICAgICB9IC8vIEFkZCByb3RhdGlvbmFsIGZvcmNlCgoKICAgICAgdGhpcy50b3JxdWUudmFkZCh0b3JxdWUsIHRoaXMudG9ycXVlKTsKICAgIH0KICAgIC8qKgogICAgICogQXBwbHkgaW1wdWxzZSB0byBhIHBvaW50IG9mIHRoZSBib2R5LiBUaGlzIGNvdWxkIGZvciBleGFtcGxlIGJlIGEgcG9pbnQgb24gdGhlIEJvZHkgc3VyZmFjZS4KICAgICAqIEFuIGltcHVsc2UgaXMgYSBmb3JjZSBhZGRlZCB0byBhIGJvZHkgZHVyaW5nIGEgc2hvcnQgcGVyaW9kIG9mIHRpbWUgKGltcHVsc2UgPSBmb3JjZSAqIHRpbWUpLgogICAgICogSW1wdWxzZXMgd2lsbCBiZSBhZGRlZCB0byBCb2R5LnZlbG9jaXR5IGFuZCBCb2R5LmFuZ3VsYXJWZWxvY2l0eS4KICAgICAqIEBwYXJhbSBpbXB1bHNlIFRoZSBhbW91bnQgb2YgaW1wdWxzZSB0byBhZGQuCiAgICAgKiBAcGFyYW0gcmVsYXRpdmVQb2ludCBBIHBvaW50IHJlbGF0aXZlIHRvIHRoZSBjZW50ZXIgb2YgbWFzcyB0byBhcHBseSB0aGUgZm9yY2Ugb24uCiAgICAgKi8KCgogICAgYXBwbHlJbXB1bHNlKGltcHVsc2UsIHJlbGF0aXZlUG9pbnQpIHsKICAgICAgaWYgKHJlbGF0aXZlUG9pbnQgPT09IHZvaWQgMCkgewogICAgICAgIHJlbGF0aXZlUG9pbnQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICB0aGlzLndha2VVcCgpOwogICAgICB9IC8vIENvbXB1dGUgcG9pbnQgcG9zaXRpb24gcmVsYXRpdmUgdG8gdGhlIGJvZHkgY2VudGVyCgoKICAgICAgY29uc3QgciA9IHJlbGF0aXZlUG9pbnQ7IC8vIENvbXB1dGUgcHJvZHVjZWQgY2VudHJhbCBpbXB1bHNlIHZlbG9jaXR5CgogICAgICBjb25zdCB2ZWxvID0gQm9keV9hcHBseUltcHVsc2VfdmVsbzsKICAgICAgdmVsby5jb3B5KGltcHVsc2UpOwogICAgICB2ZWxvLnNjYWxlKHRoaXMuaW52TWFzcywgdmVsbyk7IC8vIEFkZCBsaW5lYXIgaW1wdWxzZQoKICAgICAgdGhpcy52ZWxvY2l0eS52YWRkKHZlbG8sIHRoaXMudmVsb2NpdHkpOyAvLyBDb21wdXRlIHByb2R1Y2VkIHJvdGF0aW9uYWwgaW1wdWxzZSB2ZWxvY2l0eQoKICAgICAgY29uc3Qgcm90VmVsbyA9IEJvZHlfYXBwbHlJbXB1bHNlX3JvdFZlbG87CiAgICAgIHIuY3Jvc3MoaW1wdWxzZSwgcm90VmVsbyk7CiAgICAgIC8qCiAgICAgICByb3RWZWxvLnggKj0gdGhpcy5pbnZJbmVydGlhLng7CiAgICAgICByb3RWZWxvLnkgKj0gdGhpcy5pbnZJbmVydGlhLnk7CiAgICAgICByb3RWZWxvLnogKj0gdGhpcy5pbnZJbmVydGlhLno7CiAgICAgICAqLwoKICAgICAgdGhpcy5pbnZJbmVydGlhV29ybGQudm11bHQocm90VmVsbywgcm90VmVsbyk7IC8vIEFkZCByb3RhdGlvbmFsIEltcHVsc2UKCiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LnZhZGQocm90VmVsbywgdGhpcy5hbmd1bGFyVmVsb2NpdHkpOwogICAgfQogICAgLyoqCiAgICAgKiBBcHBseSBsb2NhbGx5LWRlZmluZWQgaW1wdWxzZSB0byBhIGxvY2FsIHBvaW50IGluIHRoZSBib2R5LgogICAgICogQHBhcmFtIGZvcmNlIFRoZSBmb3JjZSB2ZWN0b3IgdG8gYXBwbHksIGRlZmluZWQgbG9jYWxseSBpbiB0aGUgYm9keSBmcmFtZS4KICAgICAqIEBwYXJhbSBsb2NhbFBvaW50IEEgbG9jYWwgcG9pbnQgaW4gdGhlIGJvZHkgdG8gYXBwbHkgdGhlIGZvcmNlIG9uLgogICAgICovCgoKICAgIGFwcGx5TG9jYWxJbXB1bHNlKGxvY2FsSW1wdWxzZSwgbG9jYWxQb2ludCkgewogICAgICBpZiAobG9jYWxQb2ludCA9PT0gdm9pZCAwKSB7CiAgICAgICAgbG9jYWxQb2ludCA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnR5cGUgIT09IEJvZHkuRFlOQU1JQykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3Qgd29ybGRJbXB1bHNlID0gQm9keV9hcHBseUxvY2FsSW1wdWxzZV93b3JsZEltcHVsc2U7CiAgICAgIGNvbnN0IHJlbGF0aXZlUG9pbnRXb3JsZCA9IEJvZHlfYXBwbHlMb2NhbEltcHVsc2VfcmVsYXRpdmVQb2ludDsgLy8gVHJhbnNmb3JtIHRoZSBmb3JjZSB2ZWN0b3IgdG8gd29ybGQgc3BhY2UKCiAgICAgIHRoaXMudmVjdG9yVG9Xb3JsZEZyYW1lKGxvY2FsSW1wdWxzZSwgd29ybGRJbXB1bHNlKTsKICAgICAgdGhpcy52ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxQb2ludCwgcmVsYXRpdmVQb2ludFdvcmxkKTsKICAgICAgdGhpcy5hcHBseUltcHVsc2Uod29ybGRJbXB1bHNlLCByZWxhdGl2ZVBvaW50V29ybGQpOwogICAgfQogICAgLyoqCiAgICAgKiBTaG91bGQgYmUgY2FsbGVkIHdoZW5ldmVyIHlvdSBjaGFuZ2UgdGhlIGJvZHkgc2hhcGUgb3IgbWFzcy4KICAgICAqLwoKCiAgICB1cGRhdGVNYXNzUHJvcGVydGllcygpIHsKICAgICAgY29uc3QgaGFsZkV4dGVudHMgPSBCb2R5X3VwZGF0ZU1hc3NQcm9wZXJ0aWVzX2hhbGZFeHRlbnRzOwogICAgICB0aGlzLmludk1hc3MgPSB0aGlzLm1hc3MgPiAwID8gMS4wIC8gdGhpcy5tYXNzIDogMDsKICAgICAgY29uc3QgSSA9IHRoaXMuaW5lcnRpYTsKICAgICAgY29uc3QgZml4ZWQgPSB0aGlzLmZpeGVkUm90YXRpb247IC8vIEFwcHJveGltYXRlIHdpdGggQUFCQiBib3gKCiAgICAgIHRoaXMudXBkYXRlQUFCQigpOwogICAgICBoYWxmRXh0ZW50cy5zZXQoKHRoaXMuYWFiYi51cHBlckJvdW5kLnggLSB0aGlzLmFhYmIubG93ZXJCb3VuZC54KSAvIDIsICh0aGlzLmFhYmIudXBwZXJCb3VuZC55IC0gdGhpcy5hYWJiLmxvd2VyQm91bmQueSkgLyAyLCAodGhpcy5hYWJiLnVwcGVyQm91bmQueiAtIHRoaXMuYWFiYi5sb3dlckJvdW5kLnopIC8gMik7CiAgICAgIEJveC5jYWxjdWxhdGVJbmVydGlhKGhhbGZFeHRlbnRzLCB0aGlzLm1hc3MsIEkpOwogICAgICB0aGlzLmludkluZXJ0aWEuc2V0KEkueCA+IDAgJiYgIWZpeGVkID8gMS4wIC8gSS54IDogMCwgSS55ID4gMCAmJiAhZml4ZWQgPyAxLjAgLyBJLnkgOiAwLCBJLnogPiAwICYmICFmaXhlZCA/IDEuMCAvIEkueiA6IDApOwogICAgICB0aGlzLnVwZGF0ZUluZXJ0aWFXb3JsZCh0cnVlKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHdvcmxkIHZlbG9jaXR5IG9mIGEgcG9pbnQgaW4gdGhlIGJvZHkuCiAgICAgKiBAcGFyYW0gd29ybGRQb2ludAogICAgICogQHBhcmFtIHJlc3VsdAogICAgICogQHJldHVybiBUaGUgcmVzdWx0IHZlY3Rvci4KICAgICAqLwoKCiAgICBnZXRWZWxvY2l0eUF0V29ybGRQb2ludCh3b3JsZFBvaW50LCByZXN1bHQpIHsKICAgICAgY29uc3QgciA9IG5ldyBWZWMzKCk7CiAgICAgIHdvcmxkUG9pbnQudnN1Yih0aGlzLnBvc2l0aW9uLCByKTsKICAgICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkuY3Jvc3MociwgcmVzdWx0KTsKICAgICAgdGhpcy52ZWxvY2l0eS52YWRkKHJlc3VsdCwgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogTW92ZSB0aGUgYm9keSBmb3J3YXJkIGluIHRpbWUuCiAgICAgKiBAcGFyYW0gZHQgVGltZSBzdGVwCiAgICAgKiBAcGFyYW0gcXVhdE5vcm1hbGl6ZSBTZXQgdG8gdHJ1ZSB0byBub3JtYWxpemUgdGhlIGJvZHkgcXVhdGVybmlvbgogICAgICogQHBhcmFtIHF1YXROb3JtYWxpemVGYXN0IElmIHRoZSBxdWF0ZXJuaW9uIHNob3VsZCBiZSBub3JtYWxpemVkIHVzaW5nICJmYXN0IiBxdWF0ZXJuaW9uIG5vcm1hbGl6YXRpb24KICAgICAqLwoKCiAgICBpbnRlZ3JhdGUoZHQsIHF1YXROb3JtYWxpemUsIHF1YXROb3JtYWxpemVGYXN0KSB7CiAgICAgIC8vIFNhdmUgcHJldmlvdXMgcG9zaXRpb24KICAgICAgdGhpcy5wcmV2aW91c1Bvc2l0aW9uLmNvcHkodGhpcy5wb3NpdGlvbik7CiAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uLmNvcHkodGhpcy5xdWF0ZXJuaW9uKTsKCiAgICAgIGlmICghKHRoaXMudHlwZSA9PT0gQm9keS5EWU5BTUlDIHx8IHRoaXMudHlwZSA9PT0gQm9keS5LSU5FTUFUSUMpIHx8IHRoaXMuc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORykgewogICAgICAgIC8vIE9ubHkgZm9yIGR5bmFtaWMKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlbG8gPSB0aGlzLnZlbG9jaXR5OwogICAgICBjb25zdCBhbmd1bGFyVmVsbyA9IHRoaXMuYW5ndWxhclZlbG9jaXR5OwogICAgICBjb25zdCBwb3MgPSB0aGlzLnBvc2l0aW9uOwogICAgICBjb25zdCBmb3JjZSA9IHRoaXMuZm9yY2U7CiAgICAgIGNvbnN0IHRvcnF1ZSA9IHRoaXMudG9ycXVlOwogICAgICBjb25zdCBxdWF0ID0gdGhpcy5xdWF0ZXJuaW9uOwogICAgICBjb25zdCBpbnZNYXNzID0gdGhpcy5pbnZNYXNzOwogICAgICBjb25zdCBpbnZJbmVydGlhID0gdGhpcy5pbnZJbmVydGlhV29ybGQ7CiAgICAgIGNvbnN0IGxpbmVhckZhY3RvciA9IHRoaXMubGluZWFyRmFjdG9yOwogICAgICBjb25zdCBpTWR0ID0gaW52TWFzcyAqIGR0OwogICAgICB2ZWxvLnggKz0gZm9yY2UueCAqIGlNZHQgKiBsaW5lYXJGYWN0b3IueDsKICAgICAgdmVsby55ICs9IGZvcmNlLnkgKiBpTWR0ICogbGluZWFyRmFjdG9yLnk7CiAgICAgIHZlbG8ueiArPSBmb3JjZS56ICogaU1kdCAqIGxpbmVhckZhY3Rvci56OwogICAgICBjb25zdCBlID0gaW52SW5lcnRpYS5lbGVtZW50czsKICAgICAgY29uc3QgYW5ndWxhckZhY3RvciA9IHRoaXMuYW5ndWxhckZhY3RvcjsKICAgICAgY29uc3QgdHggPSB0b3JxdWUueCAqIGFuZ3VsYXJGYWN0b3IueDsKICAgICAgY29uc3QgdHkgPSB0b3JxdWUueSAqIGFuZ3VsYXJGYWN0b3IueTsKICAgICAgY29uc3QgdHogPSB0b3JxdWUueiAqIGFuZ3VsYXJGYWN0b3IuejsKICAgICAgYW5ndWxhclZlbG8ueCArPSBkdCAqIChlWzBdICogdHggKyBlWzFdICogdHkgKyBlWzJdICogdHopOwogICAgICBhbmd1bGFyVmVsby55ICs9IGR0ICogKGVbM10gKiB0eCArIGVbNF0gKiB0eSArIGVbNV0gKiB0eik7CiAgICAgIGFuZ3VsYXJWZWxvLnogKz0gZHQgKiAoZVs2XSAqIHR4ICsgZVs3XSAqIHR5ICsgZVs4XSAqIHR6KTsgLy8gVXNlIG5ldyB2ZWxvY2l0eSAgLSBsZWFwIGZyb2cKCiAgICAgIHBvcy54ICs9IHZlbG8ueCAqIGR0OwogICAgICBwb3MueSArPSB2ZWxvLnkgKiBkdDsKICAgICAgcG9zLnogKz0gdmVsby56ICogZHQ7CiAgICAgIHF1YXQuaW50ZWdyYXRlKHRoaXMuYW5ndWxhclZlbG9jaXR5LCBkdCwgdGhpcy5hbmd1bGFyRmFjdG9yLCBxdWF0KTsKCiAgICAgIGlmIChxdWF0Tm9ybWFsaXplKSB7CiAgICAgICAgaWYgKHF1YXROb3JtYWxpemVGYXN0KSB7CiAgICAgICAgICBxdWF0Lm5vcm1hbGl6ZUZhc3QoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcXVhdC5ub3JtYWxpemUoKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsgLy8gVXBkYXRlIHdvcmxkIGluZXJ0aWEKCiAgICAgIHRoaXMudXBkYXRlSW5lcnRpYVdvcmxkKCk7CiAgICB9CgogIH0KICBCb2R5LmlkQ291bnRlciA9IDA7CiAgQm9keS5DT0xMSURFX0VWRU5UX05BTUUgPSAnY29sbGlkZSc7CiAgQm9keS5EWU5BTUlDID0gQk9EWV9UWVBFUy5EWU5BTUlDOwogIEJvZHkuU1RBVElDID0gQk9EWV9UWVBFUy5TVEFUSUM7CiAgQm9keS5LSU5FTUFUSUMgPSBCT0RZX1RZUEVTLktJTkVNQVRJQzsKICBCb2R5LkFXQUtFID0gQk9EWV9TTEVFUF9TVEFURVMuQVdBS0U7CiAgQm9keS5TTEVFUFkgPSBCT0RZX1NMRUVQX1NUQVRFUy5TTEVFUFk7CiAgQm9keS5TTEVFUElORyA9IEJPRFlfU0xFRVBfU1RBVEVTLlNMRUVQSU5HOwogIEJvZHkud2FrZXVwRXZlbnQgPSB7CiAgICB0eXBlOiAnd2FrZXVwJwogIH07CiAgQm9keS5zbGVlcHlFdmVudCA9IHsKICAgIHR5cGU6ICdzbGVlcHknCiAgfTsKICBCb2R5LnNsZWVwRXZlbnQgPSB7CiAgICB0eXBlOiAnc2xlZXAnCiAgfTsKICBjb25zdCB0bXBWZWMgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFF1YXQgPSBuZXcgUXVhdGVybmlvbigpOwogIGNvbnN0IHVwZGF0ZUFBQkJfc2hhcGVBQUJCID0gbmV3IEFBQkIoKTsKICBjb25zdCB1aXdfbTEgPSBuZXcgTWF0MygpOwogIGNvbnN0IHVpd19tMiA9IG5ldyBNYXQzKCk7CiAgbmV3IE1hdDMoKTsKICBjb25zdCBCb2R5X2FwcGx5Rm9yY2Vfcm90Rm9yY2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEZvcmNlX3dvcmxkRm9yY2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEZvcmNlX3JlbGF0aXZlUG9pbnRXb3JsZCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUltcHVsc2VfdmVsbyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUltcHVsc2Vfcm90VmVsbyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUxvY2FsSW1wdWxzZV93b3JsZEltcHVsc2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEltcHVsc2VfcmVsYXRpdmVQb2ludCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV91cGRhdGVNYXNzUHJvcGVydGllc19oYWxmRXh0ZW50cyA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIEJhc2UgY2xhc3MgZm9yIGJyb2FkcGhhc2UgaW1wbGVtZW50YXRpb25zCiAgICogQGF1dGhvciBzY2h0ZXBwZQogICAqLwogIGNsYXNzIEJyb2FkcGhhc2UgewogICAgLyoqCiAgICAgKiBUaGUgd29ybGQgdG8gc2VhcmNoIGZvciBjb2xsaXNpb25zIGluLgogICAgICovCgogICAgLyoqCiAgICAgKiBJZiBzZXQgdG8gdHJ1ZSwgdGhlIGJyb2FkcGhhc2UgdXNlcyBib3VuZGluZyBib3hlcyBmb3IgaW50ZXJzZWN0aW9uIHRlc3RzLCBlbHNlIGl0IHVzZXMgYm91bmRpbmcgc3BoZXJlcy4KICAgICAqLwoKICAgIC8qKgogICAgICogU2V0IHRvIHRydWUgaWYgdGhlIG9iamVjdHMgaW4gdGhlIHdvcmxkIG1vdmVkLgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICAgIHRoaXMudXNlQm91bmRpbmdCb3hlcyA9IGZhbHNlOwogICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBjb2xsaXNpb24gcGFpcnMgZnJvbSB0aGUgd29ybGQKICAgICAqIEBwYXJhbSB3b3JsZCBUaGUgd29ybGQgdG8gc2VhcmNoIGluCiAgICAgKiBAcGFyYW0gcDEgRW1wdHkgYXJyYXkgdG8gYmUgZmlsbGVkIHdpdGggYm9keSBvYmplY3RzCiAgICAgKiBAcGFyYW0gcDIgRW1wdHkgYXJyYXkgdG8gYmUgZmlsbGVkIHdpdGggYm9keSBvYmplY3RzCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHAxLCBwMikgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvbGxpc2lvblBhaXJzIG5vdCBpbXBsZW1lbnRlZCBmb3IgdGhpcyBCcm9hZFBoYXNlIGNsYXNzIScpOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiBhIGJvZHkgcGFpciBuZWVkcyB0byBiZSBpbnRlcnNlY3Rpb24gdGVzdGVkIGF0IGFsbC4KICAgICAqLwoKCiAgICBuZWVkQnJvYWRwaGFzZUNvbGxpc2lvbihib2R5QSwgYm9keUIpIHsKICAgICAgLy8gQ2hlY2sgY29sbGlzaW9uIGZpbHRlciBtYXNrcwogICAgICBpZiAoKGJvZHlBLmNvbGxpc2lvbkZpbHRlckdyb3VwICYgYm9keUIuY29sbGlzaW9uRmlsdGVyTWFzaykgPT09IDAgfHwgKGJvZHlCLmNvbGxpc2lvbkZpbHRlckdyb3VwICYgYm9keUEuY29sbGlzaW9uRmlsdGVyTWFzaykgPT09IDApIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gQ2hlY2sgdHlwZXMKCgogICAgICBpZiAoKChib2R5QS50eXBlICYgQm9keS5TVEFUSUMpICE9PSAwIHx8IGJvZHlBLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpICYmICgoYm9keUIudHlwZSAmIEJvZHkuU1RBVElDKSAhPT0gMCB8fCBib2R5Qi5zbGVlcFN0YXRlID09PSBCb2R5LlNMRUVQSU5HKSkgewogICAgICAgIC8vIEJvdGggYm9kaWVzIGFyZSBzdGF0aWMgb3Igc2xlZXBpbmcuIFNraXAuCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIGJvdW5kaW5nIHZvbHVtZXMgb2YgdHdvIGJvZGllcyBpbnRlcnNlY3QuCiAgICAgKi8KCgogICAgaW50ZXJzZWN0aW9uVGVzdChib2R5QSwgYm9keUIsIHBhaXJzMSwgcGFpcnMyKSB7CiAgICAgIGlmICh0aGlzLnVzZUJvdW5kaW5nQm94ZXMpIHsKICAgICAgICB0aGlzLmRvQm91bmRpbmdCb3hCcm9hZHBoYXNlKGJvZHlBLCBib2R5QiwgcGFpcnMxLCBwYWlyczIpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZG9Cb3VuZGluZ1NwaGVyZUJyb2FkcGhhc2UoYm9keUEsIGJvZHlCLCBwYWlyczEsIHBhaXJzMik7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIGJvdW5kaW5nIHNwaGVyZXMgb2YgdHdvIGJvZGllcyBhcmUgaW50ZXJzZWN0aW5nLgogICAgICogQHBhcmFtIHBhaXJzMSBib2R5QSBpcyBhcHBlbmRlZCB0byB0aGlzIGFycmF5IGlmIGludGVyc2VjdGlvbgogICAgICogQHBhcmFtIHBhaXJzMiBib2R5QiBpcyBhcHBlbmRlZCB0byB0aGlzIGFycmF5IGlmIGludGVyc2VjdGlvbgogICAgICovCgoKICAgIGRvQm91bmRpbmdTcGhlcmVCcm9hZHBoYXNlKGJvZHlBLCBib2R5QiwgcGFpcnMxLCBwYWlyczIpIHsKICAgICAgY29uc3QgciA9IEJyb2FkcGhhc2VfY29sbGlzaW9uUGFpcnNfcjsKICAgICAgYm9keUIucG9zaXRpb24udnN1Yihib2R5QS5wb3NpdGlvbiwgcik7CiAgICAgIGNvbnN0IGJvdW5kaW5nUmFkaXVzU3VtMiA9IChib2R5QS5ib3VuZGluZ1JhZGl1cyArIGJvZHlCLmJvdW5kaW5nUmFkaXVzKSAqKiAyOwogICAgICBjb25zdCBub3JtMiA9IHIubGVuZ3RoU3F1YXJlZCgpOwoKICAgICAgaWYgKG5vcm0yIDwgYm91bmRpbmdSYWRpdXNTdW0yKSB7CiAgICAgICAgcGFpcnMxLnB1c2goYm9keUEpOwogICAgICAgIHBhaXJzMi5wdXNoKGJvZHlCKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRpbmcgYm94ZXMgb2YgdHdvIGJvZGllcyBhcmUgaW50ZXJzZWN0aW5nLgogICAgICovCgoKICAgIGRvQm91bmRpbmdCb3hCcm9hZHBoYXNlKGJvZHlBLCBib2R5QiwgcGFpcnMxLCBwYWlyczIpIHsKICAgICAgaWYgKGJvZHlBLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgIGJvZHlBLnVwZGF0ZUFBQkIoKTsKICAgICAgfQoKICAgICAgaWYgKGJvZHlCLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgIGJvZHlCLnVwZGF0ZUFBQkIoKTsKICAgICAgfSAvLyBDaGVjayBBQUJCIC8gQUFCQgoKCiAgICAgIGlmIChib2R5QS5hYWJiLm92ZXJsYXBzKGJvZHlCLmFhYmIpKSB7CiAgICAgICAgcGFpcnMxLnB1c2goYm9keUEpOwogICAgICAgIHBhaXJzMi5wdXNoKGJvZHlCKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmVzIGR1cGxpY2F0ZSBwYWlycyBmcm9tIHRoZSBwYWlyIGFycmF5cy4KICAgICAqLwoKCiAgICBtYWtlUGFpcnNVbmlxdWUocGFpcnMxLCBwYWlyczIpIHsKICAgICAgY29uc3QgdCA9IEJyb2FkcGhhc2VfbWFrZVBhaXJzVW5pcXVlX3RlbXA7CiAgICAgIGNvbnN0IHAxID0gQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfcDE7CiAgICAgIGNvbnN0IHAyID0gQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfcDI7CiAgICAgIGNvbnN0IE4gPSBwYWlyczEubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIHAxW2ldID0gcGFpcnMxW2ldOwogICAgICAgIHAyW2ldID0gcGFpcnMyW2ldOwogICAgICB9CgogICAgICBwYWlyczEubGVuZ3RoID0gMDsKICAgICAgcGFpcnMyLmxlbmd0aCA9IDA7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgaWQxID0gcDFbaV0uaWQ7CiAgICAgICAgY29uc3QgaWQyID0gcDJbaV0uaWQ7CiAgICAgICAgY29uc3Qga2V5ID0gaWQxIDwgaWQyID8gYCR7aWQxfSwke2lkMn1gIDogYCR7aWQyfSwke2lkMX1gOwogICAgICAgIHRba2V5XSA9IGk7CiAgICAgICAgdC5rZXlzLnB1c2goa2V5KTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IHQua2V5cy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGtleSA9IHQua2V5cy5wb3AoKTsKICAgICAgICBjb25zdCBwYWlySW5kZXggPSB0W2tleV07CiAgICAgICAgcGFpcnMxLnB1c2gocDFbcGFpckluZGV4XSk7CiAgICAgICAgcGFpcnMyLnB1c2gocDJbcGFpckluZGV4XSk7CiAgICAgICAgZGVsZXRlIHRba2V5XTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBUbyBiZSBpbXBsZW1lbnRlZCBieSBzdWJjYXNzZXMKICAgICAqLwoKCiAgICBzZXRXb3JsZCh3b3JsZCkge30KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIGJvdW5kaW5nIHNwaGVyZXMgb2YgdHdvIGJvZGllcyBvdmVybGFwLgogICAgICovCgoKICAgIHN0YXRpYyBib3VuZGluZ1NwaGVyZUNoZWNrKGJvZHlBLCBib2R5QikgewogICAgICBjb25zdCBkaXN0ID0gbmV3IFZlYzMoKTsgLy8gYnNjX2Rpc3Q7CgogICAgICBib2R5QS5wb3NpdGlvbi52c3ViKGJvZHlCLnBvc2l0aW9uLCBkaXN0KTsKICAgICAgY29uc3Qgc2EgPSBib2R5QS5zaGFwZXNbMF07CiAgICAgIGNvbnN0IHNiID0gYm9keUIuc2hhcGVzWzBdOwogICAgICByZXR1cm4gTWF0aC5wb3coc2EuYm91bmRpbmdTcGhlcmVSYWRpdXMgKyBzYi5ib3VuZGluZ1NwaGVyZVJhZGl1cywgMikgPiBkaXN0Lmxlbmd0aFNxdWFyZWQoKTsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyBhbGwgdGhlIGJvZGllcyB3aXRoaW4gdGhlIEFBQkIuCiAgICAgKi8KCgogICAgYWFiYlF1ZXJ5KHdvcmxkLCBhYWJiLCByZXN1bHQpIHsKICAgICAgY29uc29sZS53YXJuKCcuYWFiYlF1ZXJ5IGlzIG5vdCBpbXBsZW1lbnRlZCBpbiB0aGlzIEJyb2FkcGhhc2Ugc3ViY2xhc3MuJyk7CiAgICAgIHJldHVybiBbXTsKICAgIH0KCiAgfSAvLyBUZW1wIG9iamVjdHMKCiAgY29uc3QgQnJvYWRwaGFzZV9jb2xsaXNpb25QYWlyc19yID0gbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIG5ldyBRdWF0ZXJuaW9uKCk7CiAgbmV3IFZlYzMoKTsKICBjb25zdCBCcm9hZHBoYXNlX21ha2VQYWlyc1VuaXF1ZV90ZW1wID0gewogICAga2V5czogW10KICB9OwogIGNvbnN0IEJyb2FkcGhhc2VfbWFrZVBhaXJzVW5pcXVlX3AxID0gW107CiAgY29uc3QgQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfcDIgPSBbXTsKICBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogTmFpdmUgYnJvYWRwaGFzZSBpbXBsZW1lbnRhdGlvbiwgdXNlZCBpbiBsYWNrIG9mIGJldHRlciBvbmVzLgogICAqCiAgICogVGhlIG5haXZlIGJyb2FkcGhhc2UgbG9va3MgYXQgYWxsIHBvc3NpYmxlIHBhaXJzIHdpdGhvdXQgcmVzdHJpY3Rpb24sIHRoZXJlZm9yZSBpdCBoYXMgY29tcGxleGl0eSBOXjIgXyh3aGljaCBpcyBiYWQpXwogICAqLwogIGNsYXNzIE5haXZlQnJvYWRwaGFzZSBleHRlbmRzIEJyb2FkcGhhc2UgewogICAgLyoqCiAgICAgKiBAdG9kbyBSZW1vdmUgdXNlbGVzcyBjb25zdHJ1Y3RvcgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFsbCB0aGUgY29sbGlzaW9uIHBhaXJzIGluIHRoZSBwaHlzaWNzIHdvcmxkCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHBhaXJzMSwgcGFpcnMyKSB7CiAgICAgIGNvbnN0IGJvZGllcyA9IHdvcmxkLmJvZGllczsKICAgICAgY29uc3QgbiA9IGJvZGllcy5sZW5ndGg7CiAgICAgIGxldCBiaTsKICAgICAgbGV0IGJqOyAvLyBOYWl2ZSBOXjIgZnR3IQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IG47IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBpOyBqKyspIHsKICAgICAgICAgIGJpID0gYm9kaWVzW2ldOwogICAgICAgICAgYmogPSBib2RpZXNbal07CgogICAgICAgICAgaWYgKCF0aGlzLm5lZWRCcm9hZHBoYXNlQ29sbGlzaW9uKGJpLCBiaikpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5pbnRlcnNlY3Rpb25UZXN0KGJpLCBiaiwgcGFpcnMxLCBwYWlyczIpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFsbCB0aGUgYm9kaWVzIHdpdGhpbiBhbiBBQUJCLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSByZXN1bHRpbmcgYm9kaWVzIGluLgogICAgICovCgoKICAgIGFhYmJRdWVyeSh3b3JsZCwgYWFiYiwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IFtdOwogICAgICB9CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdvcmxkLmJvZGllcy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGIgPSB3b3JsZC5ib2RpZXNbaV07CgogICAgICAgIGlmIChiLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgICAgYi51cGRhdGVBQUJCKCk7CiAgICAgICAgfSAvLyBVZ2x5IGhhY2sgdW50aWwgQm9keSBnZXRzIGFhYmIKCgogICAgICAgIGlmIChiLmFhYmIub3ZlcmxhcHMoYWFiYikpIHsKICAgICAgICAgIHJlc3VsdC5wdXNoKGIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgfQoKICAvKioKICAgKiBTdG9yYWdlIGZvciBSYXkgY2FzdGluZyBkYXRhCiAgICovCiAgY2xhc3MgUmF5Y2FzdFJlc3VsdCB7CiAgICAvKioKICAgICAqIHJheUZyb21Xb3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiByYXlUb1dvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIGhpdE5vcm1hbFdvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIGhpdFBvaW50V29ybGQKICAgICAqLwoKICAgIC8qKgogICAgICogaGFzSGl0CiAgICAgKi8KCiAgICAvKioKICAgICAqIHNoYXBlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGJvZHkKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGluZGV4IG9mIHRoZSBoaXQgdHJpYW5nbGUsIGlmIHRoZSBoaXQgc2hhcGUgd2FzIGEgdHJpbWVzaAogICAgICovCgogICAgLyoqCiAgICAgKiBEaXN0YW5jZSB0byB0aGUgaGl0LiBXaWxsIGJlIHNldCB0byAtMSBpZiB0aGVyZSB3YXMgbm8gaGl0CiAgICAgKi8KCiAgICAvKioKICAgICAqIElmIHRoZSByYXkgc2hvdWxkIHN0b3AgdHJhdmVyc2luZyB0aGUgYm9kaWVzCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICB0aGlzLnJheUZyb21Xb3JsZCA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucmF5VG9Xb3JsZCA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaGl0Tm9ybWFsV29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmhpdFBvaW50V29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmhhc0hpdCA9IGZhbHNlOwogICAgICB0aGlzLnNoYXBlID0gbnVsbDsKICAgICAgdGhpcy5ib2R5ID0gbnVsbDsKICAgICAgdGhpcy5oaXRGYWNlSW5kZXggPSAtMTsKICAgICAgdGhpcy5kaXN0YW5jZSA9IC0xOwogICAgICB0aGlzLnNob3VsZFN0b3AgPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogUmVzZXQgYWxsIHJlc3VsdCBkYXRhLgogICAgICovCgoKICAgIHJlc2V0KCkgewogICAgICB0aGlzLnJheUZyb21Xb3JsZC5zZXRaZXJvKCk7CiAgICAgIHRoaXMucmF5VG9Xb3JsZC5zZXRaZXJvKCk7CiAgICAgIHRoaXMuaGl0Tm9ybWFsV29ybGQuc2V0WmVybygpOwogICAgICB0aGlzLmhpdFBvaW50V29ybGQuc2V0WmVybygpOwogICAgICB0aGlzLmhhc0hpdCA9IGZhbHNlOwogICAgICB0aGlzLnNoYXBlID0gbnVsbDsKICAgICAgdGhpcy5ib2R5ID0gbnVsbDsKICAgICAgdGhpcy5oaXRGYWNlSW5kZXggPSAtMTsKICAgICAgdGhpcy5kaXN0YW5jZSA9IC0xOwogICAgICB0aGlzLnNob3VsZFN0b3AgPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogYWJvcnQKICAgICAqLwoKCiAgICBhYm9ydCgpIHsKICAgICAgdGhpcy5zaG91bGRTdG9wID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHJlc3VsdCBkYXRhLgogICAgICovCgoKICAgIHNldChyYXlGcm9tV29ybGQsIHJheVRvV29ybGQsIGhpdE5vcm1hbFdvcmxkLCBoaXRQb2ludFdvcmxkLCBzaGFwZSwgYm9keSwgZGlzdGFuY2UpIHsKICAgICAgdGhpcy5yYXlGcm9tV29ybGQuY29weShyYXlGcm9tV29ybGQpOwogICAgICB0aGlzLnJheVRvV29ybGQuY29weShyYXlUb1dvcmxkKTsKICAgICAgdGhpcy5oaXROb3JtYWxXb3JsZC5jb3B5KGhpdE5vcm1hbFdvcmxkKTsKICAgICAgdGhpcy5oaXRQb2ludFdvcmxkLmNvcHkoaGl0UG9pbnRXb3JsZCk7CiAgICAgIHRoaXMuc2hhcGUgPSBzaGFwZTsKICAgICAgdGhpcy5ib2R5ID0gYm9keTsKICAgICAgdGhpcy5kaXN0YW5jZSA9IGRpc3RhbmNlOwogICAgfQoKICB9CgogIGxldCBfU2hhcGUkdHlwZXMkU1BIRVJFLCBfU2hhcGUkdHlwZXMkUExBTkUsIF9TaGFwZSR0eXBlcyRCT1gsIF9TaGFwZSR0eXBlcyRDWUxJTkRFUiwgX1NoYXBlJHR5cGVzJENPTlZFWFBPLCBfU2hhcGUkdHlwZXMkSEVJR0hURkksIF9TaGFwZSR0eXBlcyRUUklNRVNIOwoKICAvKioKICAgKiBSQVlfTU9ERVMKICAgKi8KICBjb25zdCBSQVlfTU9ERVMgPSB7CiAgICAvKiogQ0xPU0VTVCAqLwogICAgQ0xPU0VTVDogMSwKCiAgICAvKiogQU5ZICovCiAgICBBTlk6IDIsCgogICAgLyoqIEFMTCAqLwogICAgQUxMOiA0CiAgfTsKICAvKioKICAgKiBSYXlNb2RlCiAgICovCgogIF9TaGFwZSR0eXBlcyRTUEhFUkUgPSBTaGFwZS50eXBlcy5TUEhFUkU7CiAgX1NoYXBlJHR5cGVzJFBMQU5FID0gU2hhcGUudHlwZXMuUExBTkU7CiAgX1NoYXBlJHR5cGVzJEJPWCA9IFNoYXBlLnR5cGVzLkJPWDsKICBfU2hhcGUkdHlwZXMkQ1lMSU5ERVIgPSBTaGFwZS50eXBlcy5DWUxJTkRFUjsKICBfU2hhcGUkdHlwZXMkQ09OVkVYUE8gPSBTaGFwZS50eXBlcy5DT05WRVhQT0xZSEVEUk9OOwogIF9TaGFwZSR0eXBlcyRIRUlHSFRGSSA9IFNoYXBlLnR5cGVzLkhFSUdIVEZJRUxEOwogIF9TaGFwZSR0eXBlcyRUUklNRVNIID0gU2hhcGUudHlwZXMuVFJJTUVTSDsKCiAgLyoqCiAgICogQSBsaW5lIGluIDNEIHNwYWNlIHRoYXQgaW50ZXJzZWN0cyBib2RpZXMgYW5kIHJldHVybiBwb2ludHMuCiAgICovCiAgY2xhc3MgUmF5IHsKICAgIC8qKgogICAgICogZnJvbQogICAgICovCgogICAgLyoqCiAgICAgKiB0bwogICAgICovCgogICAgLyoqCiAgICAgKiBkaXJlY3Rpb24KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHByZWNpc2lvbiBvZiB0aGUgcmF5LiBVc2VkIHdoZW4gY2hlY2tpbmcgcGFyYWxsZWxpdHkgZXRjLgogICAgICogQGRlZmF1bHQgMC4wMDAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNldCB0byBgZmFsc2VgIGlmIHlvdSBkb24ndCB3YW50IHRoZSBSYXkgdG8gdGFrZSBgY29sbGlzaW9uUmVzcG9uc2VgIGZsYWdzIGludG8gYWNjb3VudCBvbiBib2RpZXMgYW5kIHNoYXBlcy4KICAgICAqIEBkZWZhdWx0IHRydWUKICAgICAqLwoKICAgIC8qKgogICAgICogSWYgc2V0IHRvIGB0cnVlYCwgdGhlIHJheSBza2lwcyBhbnkgaGl0cyB3aXRoIG5vcm1hbC5kb3QocmF5RGlyZWN0aW9uKSA8IDAuCiAgICAgKiBAZGVmYXVsdCBmYWxzZQogICAgICovCgogICAgLyoqCiAgICAgKiBjb2xsaXNpb25GaWx0ZXJNYXNrCiAgICAgKiBAZGVmYXVsdCAtMQogICAgICovCgogICAgLyoqCiAgICAgKiBjb2xsaXNpb25GaWx0ZXJHcm91cAogICAgICogQGRlZmF1bHQgLTEKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGludGVyc2VjdGlvbiBtb2RlLiBTaG91bGQgYmUgUmF5LkFOWSwgUmF5LkFMTCBvciBSYXkuQ0xPU0VTVC4KICAgICAqIEBkZWZhdWx0IFJBWS5BTlkKICAgICAqLwoKICAgIC8qKgogICAgICogQ3VycmVudCByZXN1bHQgb2JqZWN0LgogICAgICovCgogICAgLyoqCiAgICAgKiBXaWxsIGJlIHNldCB0byBgdHJ1ZWAgZHVyaW5nIGludGVyc2VjdFdvcmxkKCkgaWYgdGhlIHJheSBoaXQgYW55dGhpbmcuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFVzZXItcHJvdmlkZWQgcmVzdWx0IGNhbGxiYWNrLiBXaWxsIGJlIHVzZWQgaWYgbW9kZSBpcyBSYXkuQUxMLgogICAgICovCgogICAgLyoqCiAgICAgKiBDTE9TRVNUCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFOWQogICAgICovCgogICAgLyoqCiAgICAgKiBBTEwKICAgICAqLwogICAgZ2V0IFtfU2hhcGUkdHlwZXMkU1BIRVJFXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdFNwaGVyZTsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRQTEFORV0oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RQbGFuZTsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRCT1hdKCkgewogICAgICByZXR1cm4gdGhpcy5faW50ZXJzZWN0Qm94OwogICAgfQoKICAgIGdldCBbX1NoYXBlJHR5cGVzJENZTElOREVSXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdENvbnZleDsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRDT05WRVhQT10oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RDb252ZXg7CiAgICB9CgogICAgZ2V0IFtfU2hhcGUkdHlwZXMkSEVJR0hURkldKCkgewogICAgICByZXR1cm4gdGhpcy5faW50ZXJzZWN0SGVpZ2h0ZmllbGQ7CiAgICB9CgogICAgZ2V0IFtfU2hhcGUkdHlwZXMkVFJJTUVTSF0oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RUcmltZXNoOwogICAgfQoKICAgIGNvbnN0cnVjdG9yKGZyb20sIHRvKSB7CiAgICAgIGlmIChmcm9tID09PSB2b2lkIDApIHsKICAgICAgICBmcm9tID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgaWYgKHRvID09PSB2b2lkIDApIHsKICAgICAgICB0byA9IG5ldyBWZWMzKCk7CiAgICAgIH0KCiAgICAgIHRoaXMuZnJvbSA9IGZyb20uY2xvbmUoKTsKICAgICAgdGhpcy50byA9IHRvLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5wcmVjaXNpb24gPSAwLjAwMDE7CiAgICAgIHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHRydWU7CiAgICAgIHRoaXMuc2tpcEJhY2tmYWNlcyA9IGZhbHNlOwogICAgICB0aGlzLmNvbGxpc2lvbkZpbHRlck1hc2sgPSAtMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9IC0xOwogICAgICB0aGlzLm1vZGUgPSBSYXkuQU5ZOwogICAgICB0aGlzLnJlc3VsdCA9IG5ldyBSYXljYXN0UmVzdWx0KCk7CiAgICAgIHRoaXMuaGFzSGl0ID0gZmFsc2U7CgogICAgICB0aGlzLmNhbGxiYWNrID0gcmVzdWx0ID0+IHt9OwogICAgfQogICAgLyoqCiAgICAgKiBEbyBpdGVyc2VjdGlvbiBhZ2FpbnN0IGFsbCBib2RpZXMgaW4gdGhlIGdpdmVuIFdvcmxkLgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSByYXkgaGl0IGFueXRoaW5nLCBvdGhlcndpc2UgZmFsc2UuCiAgICAgKi8KCgogICAgaW50ZXJzZWN0V29ybGQod29ybGQsIG9wdGlvbnMpIHsKICAgICAgdGhpcy5tb2RlID0gb3B0aW9ucy5tb2RlIHx8IFJheS5BTlk7CiAgICAgIHRoaXMucmVzdWx0ID0gb3B0aW9ucy5yZXN1bHQgfHwgbmV3IFJheWNhc3RSZXN1bHQoKTsKICAgICAgdGhpcy5za2lwQmFja2ZhY2VzID0gISFvcHRpb25zLnNraXBCYWNrZmFjZXM7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyTWFzayA9IHR5cGVvZiBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJNYXNrIDogLTE7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSB0eXBlb2Ygb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJHcm91cCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogLTE7CiAgICAgIHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHR5cGVvZiBvcHRpb25zLmNoZWNrQ29sbGlzaW9uUmVzcG9uc2UgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5jaGVja0NvbGxpc2lvblJlc3BvbnNlIDogdHJ1ZTsKCiAgICAgIGlmIChvcHRpb25zLmZyb20pIHsKICAgICAgICB0aGlzLmZyb20uY29weShvcHRpb25zLmZyb20pOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy50bykgewogICAgICAgIHRoaXMudG8uY29weShvcHRpb25zLnRvKTsKICAgICAgfQoKICAgICAgdGhpcy5jYWxsYmFjayA9IG9wdGlvbnMuY2FsbGJhY2sgfHwgKCgpID0+IHt9KTsKCiAgICAgIHRoaXMuaGFzSGl0ID0gZmFsc2U7CiAgICAgIHRoaXMucmVzdWx0LnJlc2V0KCk7CiAgICAgIHRoaXMudXBkYXRlRGlyZWN0aW9uKCk7CiAgICAgIHRoaXMuZ2V0QUFCQih0bXBBQUJCJDEpOwogICAgICB0bXBBcnJheS5sZW5ndGggPSAwOwogICAgICB3b3JsZC5icm9hZHBoYXNlLmFhYmJRdWVyeSh3b3JsZCwgdG1wQUFCQiQxLCB0bXBBcnJheSk7CiAgICAgIHRoaXMuaW50ZXJzZWN0Qm9kaWVzKHRtcEFycmF5KTsKICAgICAgcmV0dXJuIHRoaXMuaGFzSGl0OwogICAgfQogICAgLyoqCiAgICAgKiBTaG9vdCBhIHJheSBhdCBhIGJvZHksIGdldCBiYWNrIGluZm9ybWF0aW9uIGFib3V0IHRoZSBoaXQuCiAgICAgKiBAZGVwcmVjYXRlZCBAcGFyYW0gcmVzdWx0IHNldCB0aGUgcmVzdWx0IHByb3BlcnR5IG9mIHRoZSBSYXkgaW5zdGVhZC4KICAgICAqLwoKCiAgICBpbnRlcnNlY3RCb2R5KGJvZHksIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgICAgdGhpcy51cGRhdGVEaXJlY3Rpb24oKTsKICAgICAgfQoKICAgICAgY29uc3QgY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZTsKCiAgICAgIGlmIChjaGVja0NvbGxpc2lvblJlc3BvbnNlICYmICFib2R5LmNvbGxpc2lvblJlc3BvbnNlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoKHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgJiBib2R5LmNvbGxpc2lvbkZpbHRlck1hc2spID09PSAwIHx8IChib2R5LmNvbGxpc2lvbkZpbHRlckdyb3VwICYgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrKSA9PT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3QgeGkgPSBpbnRlcnNlY3RCb2R5X3hpOwogICAgICBjb25zdCBxaSA9IGludGVyc2VjdEJvZHlfcWk7CgogICAgICBmb3IgKGxldCBpID0gMCwgTiA9IGJvZHkuc2hhcGVzLmxlbmd0aDsgaSA8IE47IGkrKykgewogICAgICAgIGNvbnN0IHNoYXBlID0gYm9keS5zaGFwZXNbaV07CgogICAgICAgIGlmIChjaGVja0NvbGxpc2lvblJlc3BvbnNlICYmICFzaGFwZS5jb2xsaXNpb25SZXNwb25zZSkgewogICAgICAgICAgY29udGludWU7IC8vIFNraXAKICAgICAgICB9CgogICAgICAgIGJvZHkucXVhdGVybmlvbi5tdWx0KGJvZHkuc2hhcGVPcmllbnRhdGlvbnNbaV0sIHFpKTsKICAgICAgICBib2R5LnF1YXRlcm5pb24udm11bHQoYm9keS5zaGFwZU9mZnNldHNbaV0sIHhpKTsKICAgICAgICB4aS52YWRkKGJvZHkucG9zaXRpb24sIHhpKTsKICAgICAgICB0aGlzLmludGVyc2VjdFNoYXBlKHNoYXBlLCBxaSwgeGksIGJvZHkpOwoKICAgICAgICBpZiAodGhpcy5yZXN1bHQuc2hvdWxkU3RvcCkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFNob290IGEgcmF5IGF0IGFuIGFycmF5IGJvZGllcywgZ2V0IGJhY2sgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGhpdC4KICAgICAqIEBwYXJhbSBib2RpZXMgQW4gYXJyYXkgb2YgQm9keSBvYmplY3RzLgogICAgICogQGRlcHJlY2F0ZWQgQHBhcmFtIHJlc3VsdCBzZXQgdGhlIHJlc3VsdCBwcm9wZXJ0eSBvZiB0aGUgUmF5IGluc3RlYWQuCiAgICAgKgogICAgICovCgoKICAgIGludGVyc2VjdEJvZGllcyhib2RpZXMsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgICAgdGhpcy51cGRhdGVEaXJlY3Rpb24oKTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBib2RpZXMubGVuZ3RoOyAhdGhpcy5yZXN1bHQuc2hvdWxkU3RvcCAmJiBpIDwgbDsgaSsrKSB7CiAgICAgICAgdGhpcy5pbnRlcnNlY3RCb2R5KGJvZGllc1tpXSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyB0aGUgZGlyZWN0aW9uIHZlY3Rvci4KICAgICAqLwoKCiAgICB1cGRhdGVEaXJlY3Rpb24oKSB7CiAgICAgIHRoaXMudG8udnN1Yih0aGlzLmZyb20sIHRoaXMuZGlyZWN0aW9uKTsKICAgICAgdGhpcy5kaXJlY3Rpb24ubm9ybWFsaXplKCk7CiAgICB9CgogICAgaW50ZXJzZWN0U2hhcGUoc2hhcGUsIHF1YXQsIHBvc2l0aW9uLCBib2R5KSB7CiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207IC8vIENoZWNraW5nIGJvdW5kaW5nU3BoZXJlCgogICAgICBjb25zdCBkaXN0YW5jZSA9IGRpc3RhbmNlRnJvbUludGVyc2VjdGlvbihmcm9tLCB0aGlzLmRpcmVjdGlvbiwgcG9zaXRpb24pOwoKICAgICAgaWYgKGRpc3RhbmNlID4gc2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGludGVyc2VjdE1ldGhvZCA9IHRoaXNbc2hhcGUudHlwZV07CgogICAgICBpZiAoaW50ZXJzZWN0TWV0aG9kKSB7CiAgICAgICAgaW50ZXJzZWN0TWV0aG9kLmNhbGwodGhpcywgc2hhcGUsIHF1YXQsIHBvc2l0aW9uLCBib2R5LCBzaGFwZSk7CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0Qm94KGJveCwgcXVhdCwgcG9zaXRpb24sIGJvZHksIHJlcG9ydGVkU2hhcGUpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdENvbnZleChib3guY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSk7CiAgICB9CgogICAgX2ludGVyc2VjdFBsYW5lKHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSkgewogICAgICBjb25zdCBmcm9tID0gdGhpcy5mcm9tOwogICAgICBjb25zdCB0byA9IHRoaXMudG87CiAgICAgIGNvbnN0IGRpcmVjdGlvbiA9IHRoaXMuZGlyZWN0aW9uOyAvLyBHZXQgcGxhbmUgbm9ybWFsCgogICAgICBjb25zdCB3b3JsZE5vcm1hbCA9IG5ldyBWZWMzKDAsIDAsIDEpOwogICAgICBxdWF0LnZtdWx0KHdvcmxkTm9ybWFsLCB3b3JsZE5vcm1hbCk7CiAgICAgIGNvbnN0IGxlbiA9IG5ldyBWZWMzKCk7CiAgICAgIGZyb20udnN1Yihwb3NpdGlvbiwgbGVuKTsKICAgICAgY29uc3QgcGxhbmVUb0Zyb20gPSBsZW4uZG90KHdvcmxkTm9ybWFsKTsKICAgICAgdG8udnN1Yihwb3NpdGlvbiwgbGVuKTsKICAgICAgY29uc3QgcGxhbmVUb1RvID0gbGVuLmRvdCh3b3JsZE5vcm1hbCk7CgogICAgICBpZiAocGxhbmVUb0Zyb20gKiBwbGFuZVRvVG8gPiAwKSB7CiAgICAgICAgLy8gImZyb20iIGFuZCAidG8iIGFyZSBvbiB0aGUgc2FtZSBzaWRlIG9mIHRoZSBwbGFuZS4uLiBiYWlsIG91dAogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGZyb20uZGlzdGFuY2VUbyh0bykgPCBwbGFuZVRvRnJvbSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3Qgbl9kb3RfZGlyID0gd29ybGROb3JtYWwuZG90KGRpcmVjdGlvbik7CgogICAgICBpZiAoTWF0aC5hYnMobl9kb3RfZGlyKSA8IHRoaXMucHJlY2lzaW9uKSB7CiAgICAgICAgLy8gTm8gaW50ZXJzZWN0aW9uCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBwbGFuZVBvaW50VG9Gcm9tID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgZGlyX3NjYWxlZF93aXRoX3QgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBoaXRQb2ludFdvcmxkID0gbmV3IFZlYzMoKTsKICAgICAgZnJvbS52c3ViKHBvc2l0aW9uLCBwbGFuZVBvaW50VG9Gcm9tKTsKICAgICAgY29uc3QgdCA9IC13b3JsZE5vcm1hbC5kb3QocGxhbmVQb2ludFRvRnJvbSkgLyBuX2RvdF9kaXI7CiAgICAgIGRpcmVjdGlvbi5zY2FsZSh0LCBkaXJfc2NhbGVkX3dpdGhfdCk7CiAgICAgIGZyb20udmFkZChkaXJfc2NhbGVkX3dpdGhfdCwgaGl0UG9pbnRXb3JsZCk7CiAgICAgIHRoaXMucmVwb3J0SW50ZXJzZWN0aW9uKHdvcmxkTm9ybWFsLCBoaXRQb2ludFdvcmxkLCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgd29ybGQgQUFCQiBvZiB0aGUgcmF5LgogICAgICovCgoKICAgIGdldEFBQkIoYWFiYikgewogICAgICBjb25zdCB7CiAgICAgICAgbG93ZXJCb3VuZCwKICAgICAgICB1cHBlckJvdW5kCiAgICAgIH0gPSBhYWJiOwogICAgICBjb25zdCB0byA9IHRoaXMudG87CiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207CiAgICAgIGxvd2VyQm91bmQueCA9IE1hdGgubWluKHRvLngsIGZyb20ueCk7CiAgICAgIGxvd2VyQm91bmQueSA9IE1hdGgubWluKHRvLnksIGZyb20ueSk7CiAgICAgIGxvd2VyQm91bmQueiA9IE1hdGgubWluKHRvLnosIGZyb20ueik7CiAgICAgIHVwcGVyQm91bmQueCA9IE1hdGgubWF4KHRvLngsIGZyb20ueCk7CiAgICAgIHVwcGVyQm91bmQueSA9IE1hdGgubWF4KHRvLnksIGZyb20ueSk7CiAgICAgIHVwcGVyQm91bmQueiA9IE1hdGgubWF4KHRvLnosIGZyb20ueik7CiAgICB9CgogICAgX2ludGVyc2VjdEhlaWdodGZpZWxkKHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSkgewogICAgICBzaGFwZS5kYXRhOwogICAgICBzaGFwZS5lbGVtZW50U2l6ZTsgLy8gQ29udmVydCB0aGUgcmF5IHRvIGxvY2FsIGhlaWdodGZpZWxkIGNvb3JkaW5hdGVzCgogICAgICBjb25zdCBsb2NhbFJheSA9IGludGVyc2VjdEhlaWdodGZpZWxkX2xvY2FsUmF5OyAvL25ldyBSYXkodGhpcy5mcm9tLCB0aGlzLnRvKTsKCiAgICAgIGxvY2FsUmF5LmZyb20uY29weSh0aGlzLmZyb20pOwogICAgICBsb2NhbFJheS50by5jb3B5KHRoaXMudG8pOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXQsIGxvY2FsUmF5LmZyb20sIGxvY2FsUmF5LmZyb20pOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXQsIGxvY2FsUmF5LnRvLCBsb2NhbFJheS50byk7CiAgICAgIGxvY2FsUmF5LnVwZGF0ZURpcmVjdGlvbigpOyAvLyBHZXQgdGhlIGluZGV4IG9mIHRoZSBkYXRhIHBvaW50cyB0byB0ZXN0IGFnYWluc3QKCiAgICAgIGNvbnN0IGluZGV4ID0gaW50ZXJzZWN0SGVpZ2h0ZmllbGRfaW5kZXg7CiAgICAgIGxldCBpTWluWDsKICAgICAgbGV0IGlNaW5ZOwogICAgICBsZXQgaU1heFg7CiAgICAgIGxldCBpTWF4WTsgLy8gU2V0IHRvIG1heAoKICAgICAgaU1pblggPSBpTWluWSA9IDA7CiAgICAgIGlNYXhYID0gaU1heFkgPSBzaGFwZS5kYXRhLmxlbmd0aCAtIDE7CiAgICAgIGNvbnN0IGFhYmIgPSBuZXcgQUFCQigpOwogICAgICBsb2NhbFJheS5nZXRBQUJCKGFhYmIpOwogICAgICBzaGFwZS5nZXRJbmRleE9mUG9zaXRpb24oYWFiYi5sb3dlckJvdW5kLngsIGFhYmIubG93ZXJCb3VuZC55LCBpbmRleCwgdHJ1ZSk7CiAgICAgIGlNaW5YID0gTWF0aC5tYXgoaU1pblgsIGluZGV4WzBdKTsKICAgICAgaU1pblkgPSBNYXRoLm1heChpTWluWSwgaW5kZXhbMV0pOwogICAgICBzaGFwZS5nZXRJbmRleE9mUG9zaXRpb24oYWFiYi51cHBlckJvdW5kLngsIGFhYmIudXBwZXJCb3VuZC55LCBpbmRleCwgdHJ1ZSk7CiAgICAgIGlNYXhYID0gTWF0aC5taW4oaU1heFgsIGluZGV4WzBdICsgMSk7CiAgICAgIGlNYXhZID0gTWF0aC5taW4oaU1heFksIGluZGV4WzFdICsgMSk7CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPCBpTWF4WDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IGlNaW5ZOyBqIDwgaU1heFk7IGorKykgewogICAgICAgICAgaWYgKHRoaXMucmVzdWx0LnNob3VsZFN0b3ApIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIHNoYXBlLmdldEFhYmJBdEluZGV4KGksIGosIGFhYmIpOwoKICAgICAgICAgIGlmICghYWFiYi5vdmVybGFwc1JheShsb2NhbFJheSkpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9IC8vIExvd2VyIHRyaWFuZ2xlCgoKICAgICAgICAgIHNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIGZhbHNlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShwb3NpdGlvbiwgcXVhdCwgc2hhcGUucGlsbGFyT2Zmc2V0LCB3b3JsZFBpbGxhck9mZnNldCk7CgogICAgICAgICAgdGhpcy5faW50ZXJzZWN0Q29udmV4KHNoYXBlLnBpbGxhckNvbnZleCwgcXVhdCwgd29ybGRQaWxsYXJPZmZzZXQsIGJvZHksIHJlcG9ydGVkU2hhcGUsIGludGVyc2VjdENvbnZleE9wdGlvbnMpOwoKICAgICAgICAgIGlmICh0aGlzLnJlc3VsdC5zaG91bGRTdG9wKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0gLy8gVXBwZXIgdHJpYW5nbGUKCgogICAgICAgICAgc2hhcGUuZ2V0Q29udmV4VHJpYW5nbGVQaWxsYXIoaSwgaiwgdHJ1ZSk7CiAgICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zaXRpb24sIHF1YXQsIHNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIHRoaXMuX2ludGVyc2VjdENvbnZleChzaGFwZS5waWxsYXJDb252ZXgsIHF1YXQsIHdvcmxkUGlsbGFyT2Zmc2V0LCBib2R5LCByZXBvcnRlZFNoYXBlLCBpbnRlcnNlY3RDb252ZXhPcHRpb25zKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0U3BoZXJlKHNwaGVyZSwgcXVhdCwgcG9zaXRpb24sIGJvZHksIHJlcG9ydGVkU2hhcGUpIHsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCByID0gc3BoZXJlLnJhZGl1czsKICAgICAgY29uc3QgYSA9ICh0by54IC0gZnJvbS54KSAqKiAyICsgKHRvLnkgLSBmcm9tLnkpICoqIDIgKyAodG8ueiAtIGZyb20ueikgKiogMjsKICAgICAgY29uc3QgYiA9IDIgKiAoKHRvLnggLSBmcm9tLngpICogKGZyb20ueCAtIHBvc2l0aW9uLngpICsgKHRvLnkgLSBmcm9tLnkpICogKGZyb20ueSAtIHBvc2l0aW9uLnkpICsgKHRvLnogLSBmcm9tLnopICogKGZyb20ueiAtIHBvc2l0aW9uLnopKTsKICAgICAgY29uc3QgYyA9IChmcm9tLnggLSBwb3NpdGlvbi54KSAqKiAyICsgKGZyb20ueSAtIHBvc2l0aW9uLnkpICoqIDIgKyAoZnJvbS56IC0gcG9zaXRpb24ueikgKiogMiAtIHIgKiogMjsKICAgICAgY29uc3QgZGVsdGEgPSBiICoqIDIgLSA0ICogYSAqIGM7CiAgICAgIGNvbnN0IGludGVyc2VjdGlvblBvaW50ID0gUmF5X2ludGVyc2VjdFNwaGVyZV9pbnRlcnNlY3Rpb25Qb2ludDsKICAgICAgY29uc3Qgbm9ybWFsID0gUmF5X2ludGVyc2VjdFNwaGVyZV9ub3JtYWw7CgogICAgICBpZiAoZGVsdGEgPCAwKSB7CiAgICAgICAgLy8gTm8gaW50ZXJzZWN0aW9uCiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKGRlbHRhID09PSAwKSB7CiAgICAgICAgLy8gc2luZ2xlIGludGVyc2VjdGlvbiBwb2ludAogICAgICAgIGZyb20ubGVycCh0bywgZGVsdGEsIGludGVyc2VjdGlvblBvaW50KTsKICAgICAgICBpbnRlcnNlY3Rpb25Qb2ludC52c3ViKHBvc2l0aW9uLCBub3JtYWwpOwogICAgICAgIG5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdGlvblBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgZDEgPSAoLWIgLSBNYXRoLnNxcnQoZGVsdGEpKSAvICgyICogYSk7CiAgICAgICAgY29uc3QgZDIgPSAoLWIgKyBNYXRoLnNxcnQoZGVsdGEpKSAvICgyICogYSk7CgogICAgICAgIGlmIChkMSA+PSAwICYmIGQxIDw9IDEpIHsKICAgICAgICAgIGZyb20ubGVycCh0bywgZDEsIGludGVyc2VjdGlvblBvaW50KTsKICAgICAgICAgIGludGVyc2VjdGlvblBvaW50LnZzdWIocG9zaXRpb24sIG5vcm1hbCk7CiAgICAgICAgICBub3JtYWwubm9ybWFsaXplKCk7CiAgICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdGlvblBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5yZXN1bHQuc2hvdWxkU3RvcCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKGQyID49IDAgJiYgZDIgPD0gMSkgewogICAgICAgICAgZnJvbS5sZXJwKHRvLCBkMiwgaW50ZXJzZWN0aW9uUG9pbnQpOwogICAgICAgICAgaW50ZXJzZWN0aW9uUG9pbnQudnN1Yihwb3NpdGlvbiwgbm9ybWFsKTsKICAgICAgICAgIG5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgICAgIHRoaXMucmVwb3J0SW50ZXJzZWN0aW9uKG5vcm1hbCwgaW50ZXJzZWN0aW9uUG9pbnQsIHJlcG9ydGVkU2hhcGUsIGJvZHksIC0xKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0Q29udmV4KHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSwgb3B0aW9ucykgewogICAgICBjb25zdCBub3JtYWwgPSBpbnRlcnNlY3RDb252ZXhfbm9ybWFsOwogICAgICBjb25zdCB2ZWN0b3IgPSBpbnRlcnNlY3RDb252ZXhfdmVjdG9yOwogICAgICBjb25zdCBmYWNlTGlzdCA9IG9wdGlvbnMgJiYgb3B0aW9ucy5mYWNlTGlzdCB8fCBudWxsOyAvLyBDaGVja2luZyBmYWNlcwoKICAgICAgY29uc3QgZmFjZXMgPSBzaGFwZS5mYWNlczsKICAgICAgY29uc3QgdmVydGljZXMgPSBzaGFwZS52ZXJ0aWNlczsKICAgICAgY29uc3Qgbm9ybWFscyA9IHNoYXBlLmZhY2VOb3JtYWxzOwogICAgICBjb25zdCBkaXJlY3Rpb24gPSB0aGlzLmRpcmVjdGlvbjsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCBmcm9tVG9EaXN0YW5jZSA9IGZyb20uZGlzdGFuY2VUbyh0byk7CiAgICAgIGNvbnN0IE5mYWNlcyA9IGZhY2VMaXN0ID8gZmFjZUxpc3QubGVuZ3RoIDogZmFjZXMubGVuZ3RoOwogICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnJlc3VsdDsKCiAgICAgIGZvciAobGV0IGogPSAwOyAhcmVzdWx0LnNob3VsZFN0b3AgJiYgaiA8IE5mYWNlczsgaisrKSB7CiAgICAgICAgY29uc3QgZmkgPSBmYWNlTGlzdCA/IGZhY2VMaXN0W2pdIDogajsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbZmldOwogICAgICAgIGNvbnN0IGZhY2VOb3JtYWwgPSBub3JtYWxzW2ZpXTsKICAgICAgICBjb25zdCBxID0gcXVhdDsKICAgICAgICBjb25zdCB4ID0gcG9zaXRpb247IC8vIGRldGVybWluZSBpZiByYXkgaW50ZXJzZWN0cyB0aGUgcGxhbmUgb2YgdGhlIGZhY2UKICAgICAgICAvLyBub3RlOiB0aGlzIHdvcmtzIHJlZ2FyZGxlc3Mgb2YgdGhlIGRpcmVjdGlvbiBvZiB0aGUgZmFjZSBub3JtYWwKICAgICAgICAvLyBHZXQgcGxhbmUgcG9pbnQgaW4gd29ybGQgY29vcmRpbmF0ZXMuLi4KCiAgICAgICAgdmVjdG9yLmNvcHkodmVydGljZXNbZmFjZVswXV0pOwogICAgICAgIHEudm11bHQodmVjdG9yLCB2ZWN0b3IpOwogICAgICAgIHZlY3Rvci52YWRkKHgsIHZlY3Rvcik7IC8vIC4uLmJ1dCBtYWtlIGl0IHJlbGF0aXZlIHRvIHRoZSByYXkgZnJvbS4gV2UnbGwgZml4IHRoaXMgbGF0ZXIuCgogICAgICAgIHZlY3Rvci52c3ViKGZyb20sIHZlY3Rvcik7IC8vIEdldCBwbGFuZSBub3JtYWwKCiAgICAgICAgcS52bXVsdChmYWNlTm9ybWFsLCBub3JtYWwpOyAvLyBJZiB0aGlzIGRvdCBwcm9kdWN0IGlzIG5lZ2F0aXZlLCB3ZSBoYXZlIHNvbWV0aGluZyBpbnRlcmVzdGluZwoKICAgICAgICBjb25zdCBkb3QgPSBkaXJlY3Rpb24uZG90KG5vcm1hbCk7IC8vIEJhaWwgb3V0IGlmIHJheSBhbmQgcGxhbmUgYXJlIHBhcmFsbGVsCgogICAgICAgIGlmIChNYXRoLmFicyhkb3QpIDwgdGhpcy5wcmVjaXNpb24pIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0gLy8gY2FsYyBkaXN0YW5jZSB0byBwbGFuZQoKCiAgICAgICAgY29uc3Qgc2NhbGFyID0gbm9ybWFsLmRvdCh2ZWN0b3IpIC8gZG90OyAvLyBpZiBuZWdhdGl2ZSBkaXN0YW5jZSwgdGhlbiBwbGFuZSBpcyBiZWhpbmQgcmF5CgogICAgICAgIGlmIChzY2FsYXIgPCAwKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9IC8vIGlmIChkb3QgPCAwKSB7CiAgICAgICAgLy8gSW50ZXJzZWN0aW9uIHBvaW50IGlzIGZyb20gKyBkaXJlY3Rpb24gKiBzY2FsYXIKCgogICAgICAgIGRpcmVjdGlvbi5zY2FsZShzY2FsYXIsIGludGVyc2VjdFBvaW50KTsKICAgICAgICBpbnRlcnNlY3RQb2ludC52YWRkKGZyb20sIGludGVyc2VjdFBvaW50KTsgLy8gYSBpcyB0aGUgcG9pbnQgd2UgY29tcGFyZSBwb2ludHMgYiBhbmQgYyB3aXRoLgoKICAgICAgICBhLmNvcHkodmVydGljZXNbZmFjZVswXV0pOwogICAgICAgIHEudm11bHQoYSwgYSk7CiAgICAgICAgeC52YWRkKGEsIGEpOwoKICAgICAgICBmb3IgKGxldCBpID0gMTsgIXJlc3VsdC5zaG91bGRTdG9wICYmIGkgPCBmYWNlLmxlbmd0aCAtIDE7IGkrKykgewogICAgICAgICAgLy8gVHJhbnNmb3JtIDMgdmVydGljZXMgdG8gd29ybGQgY29vcmRzCiAgICAgICAgICBiLmNvcHkodmVydGljZXNbZmFjZVtpXV0pOwogICAgICAgICAgYy5jb3B5KHZlcnRpY2VzW2ZhY2VbaSArIDFdXSk7CiAgICAgICAgICBxLnZtdWx0KGIsIGIpOwogICAgICAgICAgcS52bXVsdChjLCBjKTsKICAgICAgICAgIHgudmFkZChiLCBiKTsKICAgICAgICAgIHgudmFkZChjLCBjKTsKICAgICAgICAgIGNvbnN0IGRpc3RhbmNlID0gaW50ZXJzZWN0UG9pbnQuZGlzdGFuY2VUbyhmcm9tKTsKCiAgICAgICAgICBpZiAoIShSYXkucG9pbnRJblRyaWFuZ2xlKGludGVyc2VjdFBvaW50LCBhLCBiLCBjKSB8fCBSYXkucG9pbnRJblRyaWFuZ2xlKGludGVyc2VjdFBvaW50LCBiLCBhLCBjKSkgfHwgZGlzdGFuY2UgPiBmcm9tVG9EaXN0YW5jZSkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdFBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCBmaSk7CiAgICAgICAgfSAvLyB9CgogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEB0b2RvIE9wdGltaXplIGJ5IHRyYW5zZm9ybWluZyB0aGUgd29ybGQgdG8gbG9jYWwgc3BhY2UgZmlyc3QuCiAgICAgKiBAdG9kbyBVc2UgT2N0cmVlIGxvb2t1cAogICAgICovCgoKICAgIF9pbnRlcnNlY3RUcmltZXNoKG1lc2gsIHF1YXQsIHBvc2l0aW9uLCBib2R5LCByZXBvcnRlZFNoYXBlLCBvcHRpb25zKSB7CiAgICAgIGNvbnN0IG5vcm1hbCA9IGludGVyc2VjdFRyaW1lc2hfbm9ybWFsOwogICAgICBjb25zdCB0cmlhbmdsZXMgPSBpbnRlcnNlY3RUcmltZXNoX3RyaWFuZ2xlczsKICAgICAgY29uc3QgdHJlZVRyYW5zZm9ybSA9IGludGVyc2VjdFRyaW1lc2hfdHJlZVRyYW5zZm9ybTsKICAgICAgY29uc3QgdmVjdG9yID0gaW50ZXJzZWN0Q29udmV4X3ZlY3RvcjsKICAgICAgY29uc3QgbG9jYWxEaXJlY3Rpb24gPSBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRGlyZWN0aW9uOwogICAgICBjb25zdCBsb2NhbEZyb20gPSBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRnJvbTsKICAgICAgY29uc3QgbG9jYWxUbyA9IGludGVyc2VjdFRyaW1lc2hfbG9jYWxUbzsKICAgICAgY29uc3Qgd29ybGRJbnRlcnNlY3RQb2ludCA9IGludGVyc2VjdFRyaW1lc2hfd29ybGRJbnRlcnNlY3RQb2ludDsKICAgICAgY29uc3Qgd29ybGROb3JtYWwgPSBpbnRlcnNlY3RUcmltZXNoX3dvcmxkTm9ybWFsOyAvLyBDaGVja2luZyBmYWNlcwoKICAgICAgY29uc3QgaW5kaWNlcyA9IG1lc2guaW5kaWNlczsKICAgICAgbWVzaC52ZXJ0aWNlczsgLy8gY29uc3Qgbm9ybWFscyA9IG1lc2guZmFjZU5vcm1hbHMKCiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207CiAgICAgIGNvbnN0IHRvID0gdGhpcy50bzsKICAgICAgY29uc3QgZGlyZWN0aW9uID0gdGhpcy5kaXJlY3Rpb247CiAgICAgIHRyZWVUcmFuc2Zvcm0ucG9zaXRpb24uY29weShwb3NpdGlvbik7CiAgICAgIHRyZWVUcmFuc2Zvcm0ucXVhdGVybmlvbi5jb3B5KHF1YXQpOyAvLyBUcmFuc2Zvcm0gcmF5IHRvIGxvY2FsIHNwYWNlIQoKICAgICAgVHJhbnNmb3JtLnZlY3RvclRvTG9jYWxGcmFtZShwb3NpdGlvbiwgcXVhdCwgZGlyZWN0aW9uLCBsb2NhbERpcmVjdGlvbik7CiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZShwb3NpdGlvbiwgcXVhdCwgZnJvbSwgbG9jYWxGcm9tKTsKICAgICAgVHJhbnNmb3JtLnBvaW50VG9Mb2NhbEZyYW1lKHBvc2l0aW9uLCBxdWF0LCB0bywgbG9jYWxUbyk7CiAgICAgIGxvY2FsVG8ueCAqPSBtZXNoLnNjYWxlLng7CiAgICAgIGxvY2FsVG8ueSAqPSBtZXNoLnNjYWxlLnk7CiAgICAgIGxvY2FsVG8ueiAqPSBtZXNoLnNjYWxlLno7CiAgICAgIGxvY2FsRnJvbS54ICo9IG1lc2guc2NhbGUueDsKICAgICAgbG9jYWxGcm9tLnkgKj0gbWVzaC5zY2FsZS55OwogICAgICBsb2NhbEZyb20ueiAqPSBtZXNoLnNjYWxlLno7CiAgICAgIGxvY2FsVG8udnN1Yihsb2NhbEZyb20sIGxvY2FsRGlyZWN0aW9uKTsKICAgICAgbG9jYWxEaXJlY3Rpb24ubm9ybWFsaXplKCk7CiAgICAgIGNvbnN0IGZyb21Ub0Rpc3RhbmNlU3F1YXJlZCA9IGxvY2FsRnJvbS5kaXN0YW5jZVNxdWFyZWQobG9jYWxUbyk7CiAgICAgIG1lc2gudHJlZS5yYXlRdWVyeSh0aGlzLCB0cmVlVHJhbnNmb3JtLCB0cmlhbmdsZXMpOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIE4gPSB0cmlhbmdsZXMubGVuZ3RoOyAhdGhpcy5yZXN1bHQuc2hvdWxkU3RvcCAmJiBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCB0cmlhbmdsZXNJbmRleCA9IHRyaWFuZ2xlc1tpXTsKICAgICAgICBtZXNoLmdldE5vcm1hbCh0cmlhbmdsZXNJbmRleCwgbm9ybWFsKTsgLy8gZGV0ZXJtaW5lIGlmIHJheSBpbnRlcnNlY3RzIHRoZSBwbGFuZSBvZiB0aGUgZmFjZQogICAgICAgIC8vIG5vdGU6IHRoaXMgd29ya3MgcmVnYXJkbGVzcyBvZiB0aGUgZGlyZWN0aW9uIG9mIHRoZSBmYWNlIG5vcm1hbAogICAgICAgIC8vIEdldCBwbGFuZSBwb2ludCBpbiB3b3JsZCBjb29yZGluYXRlcy4uLgoKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogM10sIGEpOyAvLyAuLi5idXQgbWFrZSBpdCByZWxhdGl2ZSB0byB0aGUgcmF5IGZyb20uIFdlJ2xsIGZpeCB0aGlzIGxhdGVyLgoKICAgICAgICBhLnZzdWIobG9jYWxGcm9tLCB2ZWN0b3IpOyAvLyBJZiB0aGlzIGRvdCBwcm9kdWN0IGlzIG5lZ2F0aXZlLCB3ZSBoYXZlIHNvbWV0aGluZyBpbnRlcmVzdGluZwoKICAgICAgICBjb25zdCBkb3QgPSBsb2NhbERpcmVjdGlvbi5kb3Qobm9ybWFsKTsgLy8gQmFpbCBvdXQgaWYgcmF5IGFuZCBwbGFuZSBhcmUgcGFyYWxsZWwKICAgICAgICAvLyBpZiAoTWF0aC5hYnMoIGRvdCApIDwgdGhpcy5wcmVjaXNpb24pewogICAgICAgIC8vICAgICBjb250aW51ZTsKICAgICAgICAvLyB9CiAgICAgICAgLy8gY2FsYyBkaXN0YW5jZSB0byBwbGFuZQoKICAgICAgICBjb25zdCBzY2FsYXIgPSBub3JtYWwuZG90KHZlY3RvcikgLyBkb3Q7IC8vIGlmIG5lZ2F0aXZlIGRpc3RhbmNlLCB0aGVuIHBsYW5lIGlzIGJlaGluZCByYXkKCiAgICAgICAgaWYgKHNjYWxhciA8IDApIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0gLy8gSW50ZXJzZWN0aW9uIHBvaW50IGlzIGZyb20gKyBkaXJlY3Rpb24gKiBzY2FsYXIKCgogICAgICAgIGxvY2FsRGlyZWN0aW9uLnNjYWxlKHNjYWxhciwgaW50ZXJzZWN0UG9pbnQpOwogICAgICAgIGludGVyc2VjdFBvaW50LnZhZGQobG9jYWxGcm9tLCBpbnRlcnNlY3RQb2ludCk7IC8vIEdldCB0cmlhbmdsZSB2ZXJ0aWNlcwoKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogMyArIDFdLCBiKTsKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogMyArIDJdLCBjKTsKICAgICAgICBjb25zdCBzcXVhcmVkRGlzdGFuY2UgPSBpbnRlcnNlY3RQb2ludC5kaXN0YW5jZVNxdWFyZWQobG9jYWxGcm9tKTsKCiAgICAgICAgaWYgKCEoUmF5LnBvaW50SW5UcmlhbmdsZShpbnRlcnNlY3RQb2ludCwgYiwgYSwgYykgfHwgUmF5LnBvaW50SW5UcmlhbmdsZShpbnRlcnNlY3RQb2ludCwgYSwgYiwgYykpIHx8IHNxdWFyZWREaXN0YW5jZSA+IGZyb21Ub0Rpc3RhbmNlU3F1YXJlZCkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfSAvLyB0cmFuc2Zvcm0gaW50ZXJzZWN0cG9pbnQgYW5kIG5vcm1hbCB0byB3b3JsZAoKCiAgICAgICAgVHJhbnNmb3JtLnZlY3RvclRvV29ybGRGcmFtZShxdWF0LCBub3JtYWwsIHdvcmxkTm9ybWFsKTsKICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zaXRpb24sIHF1YXQsIGludGVyc2VjdFBvaW50LCB3b3JsZEludGVyc2VjdFBvaW50KTsKICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbih3b3JsZE5vcm1hbCwgd29ybGRJbnRlcnNlY3RQb2ludCwgcmVwb3J0ZWRTaGFwZSwgYm9keSwgdHJpYW5nbGVzSW5kZXgpOwogICAgICB9CgogICAgICB0cmlhbmdsZXMubGVuZ3RoID0gMDsKICAgIH0KICAgIC8qKgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSBpbnRlcnNlY3Rpb25zIHNob3VsZCBjb250aW51ZQogICAgICovCgoKICAgIHJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGhpdFBvaW50V29ybGQsIHNoYXBlLCBib2R5LCBoaXRGYWNlSW5kZXgpIHsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCBkaXN0YW5jZSA9IGZyb20uZGlzdGFuY2VUbyhoaXRQb2ludFdvcmxkKTsKICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5yZXN1bHQ7IC8vIFNraXAgYmFjayBmYWNlcz8KCiAgICAgIGlmICh0aGlzLnNraXBCYWNrZmFjZXMgJiYgbm9ybWFsLmRvdCh0aGlzLmRpcmVjdGlvbikgPiAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICByZXN1bHQuaGl0RmFjZUluZGV4ID0gdHlwZW9mIGhpdEZhY2VJbmRleCAhPT0gJ3VuZGVmaW5lZCcgPyBoaXRGYWNlSW5kZXggOiAtMTsKCiAgICAgIHN3aXRjaCAodGhpcy5tb2RlKSB7CiAgICAgICAgY2FzZSBSYXkuQUxMOgogICAgICAgICAgdGhpcy5oYXNIaXQgPSB0cnVlOwogICAgICAgICAgcmVzdWx0LnNldChmcm9tLCB0bywgbm9ybWFsLCBoaXRQb2ludFdvcmxkLCBzaGFwZSwgYm9keSwgZGlzdGFuY2UpOwogICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICB0aGlzLmNhbGxiYWNrKHJlc3VsdCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBSYXkuQ0xPU0VTVDoKICAgICAgICAgIC8vIFN0b3JlIGlmIGNsb3NlciB0aGFuIGN1cnJlbnQgY2xvc2VzdAogICAgICAgICAgaWYgKGRpc3RhbmNlIDwgcmVzdWx0LmRpc3RhbmNlIHx8ICFyZXN1bHQuaGFzSGl0KSB7CiAgICAgICAgICAgIHRoaXMuaGFzSGl0ID0gdHJ1ZTsKICAgICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICAgIHJlc3VsdC5zZXQoZnJvbSwgdG8sIG5vcm1hbCwgaGl0UG9pbnRXb3JsZCwgc2hhcGUsIGJvZHksIGRpc3RhbmNlKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBSYXkuQU5ZOgogICAgICAgICAgLy8gUmVwb3J0IGFuZCBzdG9wLgogICAgICAgICAgdGhpcy5oYXNIaXQgPSB0cnVlOwogICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICByZXN1bHQuc2V0KGZyb20sIHRvLCBub3JtYWwsIGhpdFBvaW50V29ybGQsIHNoYXBlLCBib2R5LCBkaXN0YW5jZSk7CiAgICAgICAgICByZXN1bHQuc2hvdWxkU3RvcCA9IHRydWU7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBBcyBwZXIgIkJhcnljZW50cmljIFRlY2huaXF1ZSIgYXMgbmFtZWQKICAgICAqIHtAbGluayBodHRwczovL3d3dy5ibGFja3Bhd24uY29tL3RleHRzL3BvaW50aW5wb2x5L2RlZmF1bHQuaHRtbCBoZXJlfSBidXQgd2l0aG91dCB0aGUgZGl2aXNpb24KICAgICAqLwoKCiAgICBzdGF0aWMgcG9pbnRJblRyaWFuZ2xlKHAsIGEsIGIsIGMpIHsKICAgICAgYy52c3ViKGEsIHYwKTsKICAgICAgYi52c3ViKGEsIHYxKTsKICAgICAgcC52c3ViKGEsIHYyKTsKICAgICAgY29uc3QgZG90MDAgPSB2MC5kb3QodjApOwogICAgICBjb25zdCBkb3QwMSA9IHYwLmRvdCh2MSk7CiAgICAgIGNvbnN0IGRvdDAyID0gdjAuZG90KHYyKTsKICAgICAgY29uc3QgZG90MTEgPSB2MS5kb3QodjEpOwogICAgICBjb25zdCBkb3QxMiA9IHYxLmRvdCh2Mik7CiAgICAgIGxldCB1OwogICAgICBsZXQgdjsKICAgICAgcmV0dXJuICh1ID0gZG90MTEgKiBkb3QwMiAtIGRvdDAxICogZG90MTIpID49IDAgJiYgKHYgPSBkb3QwMCAqIGRvdDEyIC0gZG90MDEgKiBkb3QwMikgPj0gMCAmJiB1ICsgdiA8IGRvdDAwICogZG90MTEgLSBkb3QwMSAqIGRvdDAxOwogICAgfQoKICB9CiAgUmF5LkNMT1NFU1QgPSBSQVlfTU9ERVMuQ0xPU0VTVDsKICBSYXkuQU5ZID0gUkFZX01PREVTLkFOWTsKICBSYXkuQUxMID0gUkFZX01PREVTLkFMTDsKICBjb25zdCB0bXBBQUJCJDEgPSBuZXcgQUFCQigpOwogIGNvbnN0IHRtcEFycmF5ID0gW107CiAgY29uc3QgdjEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHYyID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RCb2R5X3hpID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RCb2R5X3FpID0gbmV3IFF1YXRlcm5pb24oKTsKICBjb25zdCBpbnRlcnNlY3RQb2ludCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYyA9IG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgUmF5Y2FzdFJlc3VsdCgpOwogIGNvbnN0IGludGVyc2VjdENvbnZleE9wdGlvbnMgPSB7CiAgICBmYWNlTGlzdDogWzBdCiAgfTsKICBjb25zdCB3b3JsZFBpbGxhck9mZnNldCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0SGVpZ2h0ZmllbGRfbG9jYWxSYXkgPSBuZXcgUmF5KCk7CiAgY29uc3QgaW50ZXJzZWN0SGVpZ2h0ZmllbGRfaW5kZXggPSBbXTsKICBjb25zdCBSYXlfaW50ZXJzZWN0U3BoZXJlX2ludGVyc2VjdGlvblBvaW50ID0gbmV3IFZlYzMoKTsKICBjb25zdCBSYXlfaW50ZXJzZWN0U3BoZXJlX25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0Q29udmV4X25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdENvbnZleF92ZWN0b3IgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdFRyaW1lc2hfbm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRGlyZWN0aW9uID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRnJvbSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0VHJpbWVzaF9sb2NhbFRvID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX3dvcmxkTm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX3dvcmxkSW50ZXJzZWN0UG9pbnQgPSBuZXcgVmVjMygpOwogIG5ldyBBQUJCKCk7CiAgY29uc3QgaW50ZXJzZWN0VHJpbWVzaF90cmlhbmdsZXMgPSBbXTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX3RyZWVUcmFuc2Zvcm0gPSBuZXcgVHJhbnNmb3JtKCk7CiAgY29uc3QgdjAgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdCA9IG5ldyBWZWMzKCk7CgogIGZ1bmN0aW9uIGRpc3RhbmNlRnJvbUludGVyc2VjdGlvbihmcm9tLCBkaXJlY3Rpb24sIHBvc2l0aW9uKSB7CiAgICAvLyB2MCBpcyB2ZWN0b3IgZnJvbSBmcm9tIHRvIHBvc2l0aW9uCiAgICBwb3NpdGlvbi52c3ViKGZyb20sIHYwKTsKICAgIGNvbnN0IGRvdCA9IHYwLmRvdChkaXJlY3Rpb24pOyAvLyBpbnRlcnNlY3QgPSBkaXJlY3Rpb24qZG90ICsgZnJvbQoKICAgIGRpcmVjdGlvbi5zY2FsZShkb3QsIGludGVyc2VjdCk7CiAgICBpbnRlcnNlY3QudmFkZChmcm9tLCBpbnRlcnNlY3QpOwogICAgY29uc3QgZGlzdGFuY2UgPSBwb3NpdGlvbi5kaXN0YW5jZVRvKGludGVyc2VjdCk7CiAgICByZXR1cm4gZGlzdGFuY2U7CiAgfQoKICAvKioKICAgKiBTd2VlcCBhbmQgcHJ1bmUgYnJvYWRwaGFzZSBhbG9uZyBvbmUgYXhpcy4KICAgKi8KICBjbGFzcyBTQVBCcm9hZHBoYXNlIGV4dGVuZHMgQnJvYWRwaGFzZSB7CiAgICAvKioKICAgICAqIExpc3Qgb2YgYm9kaWVzIGN1cnJlbnRseSBpbiB0aGUgYnJvYWRwaGFzZS4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHdvcmxkIHRvIHNlYXJjaCBpbi4KICAgICAqLwoKICAgIC8qKgogICAgICogQXhpcyB0byBzb3J0IHRoZSBib2RpZXMgYWxvbmcuCiAgICAgKiBTZXQgdG8gMCBmb3IgeCBheGlzLCBhbmQgMSBmb3IgeSBheGlzLgogICAgICogRm9yIGJlc3QgcGVyZm9ybWFuY2UsIHBpY2sgdGhlIGF4aXMgd2hlcmUgYm9kaWVzIGFyZSBtb3N0IGRpc3RyaWJ1dGVkLgogICAgICovCgogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRzIG9mIHR3byBib2RpZXMgb3ZlcmxhcCwgYWxvbmcgdGhlIGdpdmVuIFNBUCBheGlzLgogICAgICovCiAgICBzdGF0aWMgY2hlY2tCb3VuZHMoYmksIGJqLCBheGlzSW5kZXgpIHsKICAgICAgbGV0IGJpUG9zOwogICAgICBsZXQgYmpQb3M7CgogICAgICBpZiAoYXhpc0luZGV4ID09PSAwKSB7CiAgICAgICAgYmlQb3MgPSBiaS5wb3NpdGlvbi54OwogICAgICAgIGJqUG9zID0gYmoucG9zaXRpb24ueDsKICAgICAgfSBlbHNlIGlmIChheGlzSW5kZXggPT09IDEpIHsKICAgICAgICBiaVBvcyA9IGJpLnBvc2l0aW9uLnk7CiAgICAgICAgYmpQb3MgPSBiai5wb3NpdGlvbi55OwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMikgewogICAgICAgIGJpUG9zID0gYmkucG9zaXRpb24uejsKICAgICAgICBialBvcyA9IGJqLnBvc2l0aW9uLno7CiAgICAgIH0KCiAgICAgIGNvbnN0IHJpID0gYmkuYm91bmRpbmdSYWRpdXMsCiAgICAgICAgICAgIHJqID0gYmouYm91bmRpbmdSYWRpdXMsCiAgICAgICAgICAgIGJvdW5kQTIgPSBiaVBvcyArIHJpLAogICAgICAgICAgICBib3VuZEIxID0gYmpQb3MgLSByajsKICAgICAgcmV0dXJuIGJvdW5kQjEgPCBib3VuZEEyOwogICAgfSAvLyBOb3RlOiB0aGVzZSBhcmUgaWRlbnRpY2FsLCBzYXZlIGZvciB4L3kveiBsb3dlcmJvdW5kCgogICAgLyoqCiAgICAgKiBpbnNlcnRpb25Tb3J0WAogICAgICovCgoKICAgIHN0YXRpYyBpbnNlcnRpb25Tb3J0WChhKSB7CiAgICAgIGZvciAobGV0IGkgPSAxLCBsID0gYS5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gYVtpXTsKICAgICAgICBsZXQgajsKCiAgICAgICAgZm9yIChqID0gaSAtIDE7IGogPj0gMDsgai0tKSB7CiAgICAgICAgICBpZiAoYVtqXS5hYWJiLmxvd2VyQm91bmQueCA8PSB2LmFhYmIubG93ZXJCb3VuZC54KSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGFbaiArIDFdID0gYVtqXTsKICAgICAgICB9CgogICAgICAgIGFbaiArIDFdID0gdjsKICAgICAgfQoKICAgICAgcmV0dXJuIGE7CiAgICB9CiAgICAvKioKICAgICAqIGluc2VydGlvblNvcnRZCiAgICAgKi8KCgogICAgc3RhdGljIGluc2VydGlvblNvcnRZKGEpIHsKICAgICAgZm9yIChsZXQgaSA9IDEsIGwgPSBhLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGNvbnN0IHYgPSBhW2ldOwogICAgICAgIGxldCBqOwoKICAgICAgICBmb3IgKGogPSBpIC0gMTsgaiA+PSAwOyBqLS0pIHsKICAgICAgICAgIGlmIChhW2pdLmFhYmIubG93ZXJCb3VuZC55IDw9IHYuYWFiYi5sb3dlckJvdW5kLnkpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgYVtqICsgMV0gPSBhW2pdOwogICAgICAgIH0KCiAgICAgICAgYVtqICsgMV0gPSB2OwogICAgICB9CgogICAgICByZXR1cm4gYTsKICAgIH0KICAgIC8qKgogICAgICogaW5zZXJ0aW9uU29ydFoKICAgICAqLwoKCiAgICBzdGF0aWMgaW5zZXJ0aW9uU29ydFooYSkgewogICAgICBmb3IgKGxldCBpID0gMSwgbCA9IGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgY29uc3QgdiA9IGFbaV07CiAgICAgICAgbGV0IGo7CgogICAgICAgIGZvciAoaiA9IGkgLSAxOyBqID49IDA7IGotLSkgewogICAgICAgICAgaWYgKGFbal0uYWFiYi5sb3dlckJvdW5kLnogPD0gdi5hYWJiLmxvd2VyQm91bmQueikgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBhW2ogKyAxXSA9IGFbal07CiAgICAgICAgfQoKICAgICAgICBhW2ogKyAxXSA9IHY7CiAgICAgIH0KCiAgICAgIHJldHVybiBhOwogICAgfQoKICAgIGNvbnN0cnVjdG9yKHdvcmxkKSB7CiAgICAgIHN1cGVyKCk7CiAgICAgIHRoaXMuYXhpc0xpc3QgPSBbXTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICAgIHRoaXMuYXhpc0luZGV4ID0gMDsKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwoKICAgICAgdGhpcy5fYWRkQm9keUhhbmRsZXIgPSBldmVudCA9PiB7CiAgICAgICAgYXhpc0xpc3QucHVzaChldmVudC5ib2R5KTsKICAgICAgfTsKCiAgICAgIHRoaXMuX3JlbW92ZUJvZHlIYW5kbGVyID0gZXZlbnQgPT4gewogICAgICAgIGNvbnN0IGlkeCA9IGF4aXNMaXN0LmluZGV4T2YoZXZlbnQuYm9keSk7CgogICAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgICBheGlzTGlzdC5zcGxpY2UoaWR4LCAxKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAod29ybGQpIHsKICAgICAgICB0aGlzLnNldFdvcmxkKHdvcmxkKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDaGFuZ2UgdGhlIHdvcmxkCiAgICAgKi8KCgogICAgc2V0V29ybGQod29ybGQpIHsKICAgICAgLy8gQ2xlYXIgdGhlIG9sZCBheGlzIGFycmF5CiAgICAgIHRoaXMuYXhpc0xpc3QubGVuZ3RoID0gMDsgLy8gQWRkIGFsbCBib2RpZXMgZnJvbSB0aGUgbmV3IHdvcmxkCgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdvcmxkLmJvZGllcy5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMuYXhpc0xpc3QucHVzaCh3b3JsZC5ib2RpZXNbaV0pOwogICAgICB9IC8vIFJlbW92ZSBvbGQgaGFuZGxlcnMsIGlmIGFueQoKCiAgICAgIHdvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2FkZEJvZHknLCB0aGlzLl9hZGRCb2R5SGFuZGxlcik7CiAgICAgIHdvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3JlbW92ZUJvZHknLCB0aGlzLl9yZW1vdmVCb2R5SGFuZGxlcik7IC8vIEFkZCBoYW5kbGVycyB0byB1cGRhdGUgdGhlIGxpc3Qgb2YgYm9kaWVzLgoKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcignYWRkQm9keScsIHRoaXMuX2FkZEJvZHlIYW5kbGVyKTsKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncmVtb3ZlQm9keScsIHRoaXMuX3JlbW92ZUJvZHlIYW5kbGVyKTsKICAgICAgdGhpcy53b3JsZCA9IHdvcmxkOwogICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQ29sbGVjdCBhbGwgY29sbGlzaW9uIHBhaXJzCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHAxLCBwMikgewogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmF4aXNMaXN0OwogICAgICBjb25zdCBOID0gYm9kaWVzLmxlbmd0aDsKICAgICAgY29uc3QgYXhpc0luZGV4ID0gdGhpcy5heGlzSW5kZXg7CiAgICAgIGxldCBpOwogICAgICBsZXQgajsKCiAgICAgIGlmICh0aGlzLmRpcnR5KSB7CiAgICAgICAgdGhpcy5zb3J0TGlzdCgpOwogICAgICAgIHRoaXMuZGlydHkgPSBmYWxzZTsKICAgICAgfSAvLyBMb29rIHRocm91Z2ggdGhlIGxpc3QKCgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKCiAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBOOyBqKyspIHsKICAgICAgICAgIGNvbnN0IGJqID0gYm9kaWVzW2pdOwoKICAgICAgICAgIGlmICghdGhpcy5uZWVkQnJvYWRwaGFzZUNvbGxpc2lvbihiaSwgYmopKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghU0FQQnJvYWRwaGFzZS5jaGVja0JvdW5kcyhiaSwgYmosIGF4aXNJbmRleCkpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5pbnRlcnNlY3Rpb25UZXN0KGJpLCBiaiwgcDEsIHAyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBzb3J0TGlzdCgpIHsKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwogICAgICBjb25zdCBheGlzSW5kZXggPSB0aGlzLmF4aXNJbmRleDsKICAgICAgY29uc3QgTiA9IGF4aXNMaXN0Lmxlbmd0aDsgLy8gVXBkYXRlIEFBQkJzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYmkgPSBheGlzTGlzdFtpXTsKCiAgICAgICAgaWYgKGJpLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgICAgYmkudXBkYXRlQUFCQigpOwogICAgICAgIH0KICAgICAgfSAvLyBTb3J0IHRoZSBsaXN0CgoKICAgICAgaWYgKGF4aXNJbmRleCA9PT0gMCkgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFgoYXhpc0xpc3QpOwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMSkgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFkoYXhpc0xpc3QpOwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMikgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFooYXhpc0xpc3QpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIHRoZSB2YXJpYW5jZSBvZiB0aGUgYm9keSBwb3NpdGlvbnMgYW5kIGVzdGltYXRlcyB0aGUgYmVzdCBheGlzIHRvIHVzZS4KICAgICAqIFdpbGwgYXV0b21hdGljYWxseSBzZXQgcHJvcGVydHkgYGF4aXNJbmRleGAuCiAgICAgKi8KCgogICAgYXV0b0RldGVjdEF4aXMoKSB7CiAgICAgIGxldCBzdW1YID0gMDsKICAgICAgbGV0IHN1bVgyID0gMDsKICAgICAgbGV0IHN1bVkgPSAwOwogICAgICBsZXQgc3VtWTIgPSAwOwogICAgICBsZXQgc3VtWiA9IDA7CiAgICAgIGxldCBzdW1aMiA9IDA7CiAgICAgIGNvbnN0IGJvZGllcyA9IHRoaXMuYXhpc0xpc3Q7CiAgICAgIGNvbnN0IE4gPSBib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBpbnZOID0gMSAvIE47CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYiA9IGJvZGllc1tpXTsKICAgICAgICBjb25zdCBjZW50ZXJYID0gYi5wb3NpdGlvbi54OwogICAgICAgIHN1bVggKz0gY2VudGVyWDsKICAgICAgICBzdW1YMiArPSBjZW50ZXJYICogY2VudGVyWDsKICAgICAgICBjb25zdCBjZW50ZXJZID0gYi5wb3NpdGlvbi55OwogICAgICAgIHN1bVkgKz0gY2VudGVyWTsKICAgICAgICBzdW1ZMiArPSBjZW50ZXJZICogY2VudGVyWTsKICAgICAgICBjb25zdCBjZW50ZXJaID0gYi5wb3NpdGlvbi56OwogICAgICAgIHN1bVogKz0gY2VudGVyWjsKICAgICAgICBzdW1aMiArPSBjZW50ZXJaICogY2VudGVyWjsKICAgICAgfQoKICAgICAgY29uc3QgdmFyaWFuY2VYID0gc3VtWDIgLSBzdW1YICogc3VtWCAqIGludk47CiAgICAgIGNvbnN0IHZhcmlhbmNlWSA9IHN1bVkyIC0gc3VtWSAqIHN1bVkgKiBpbnZOOwogICAgICBjb25zdCB2YXJpYW5jZVogPSBzdW1aMiAtIHN1bVogKiBzdW1aICogaW52TjsKCiAgICAgIGlmICh2YXJpYW5jZVggPiB2YXJpYW5jZVkpIHsKICAgICAgICBpZiAodmFyaWFuY2VYID4gdmFyaWFuY2VaKSB7CiAgICAgICAgICB0aGlzLmF4aXNJbmRleCA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuYXhpc0luZGV4ID0gMjsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodmFyaWFuY2VZID4gdmFyaWFuY2VaKSB7CiAgICAgICAgdGhpcy5heGlzSW5kZXggPSAxOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYXhpc0luZGV4ID0gMjsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFsbCB0aGUgYm9kaWVzIHdpdGhpbiBhbiBBQUJCLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSByZXN1bHRpbmcgYm9kaWVzIGluLgogICAgICovCgoKICAgIGFhYmJRdWVyeSh3b3JsZCwgYWFiYiwgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgewogICAgICAgIHJlc3VsdCA9IFtdOwogICAgICB9CgogICAgICBpZiAodGhpcy5kaXJ0eSkgewogICAgICAgIHRoaXMuc29ydExpc3QoKTsKICAgICAgICB0aGlzLmRpcnR5ID0gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF4aXNJbmRleCA9IHRoaXMuYXhpc0luZGV4OwogICAgICBsZXQgYXhpcyA9ICd4JzsKCiAgICAgIGlmIChheGlzSW5kZXggPT09IDEpIHsKICAgICAgICBheGlzID0gJ3knOwogICAgICB9CgogICAgICBpZiAoYXhpc0luZGV4ID09PSAyKSB7CiAgICAgICAgYXhpcyA9ICd6JzsKICAgICAgfQoKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwogICAgICBhYWJiLmxvd2VyQm91bmRbYXhpc107CiAgICAgIGFhYmIudXBwZXJCb3VuZFtheGlzXTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXhpc0xpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBiID0gYXhpc0xpc3RbaV07CgogICAgICAgIGlmIChiLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgICAgYi51cGRhdGVBQUJCKCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoYi5hYWJiLm92ZXJsYXBzKGFhYmIpKSB7CiAgICAgICAgICByZXN1bHQucHVzaChiKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogIH0KCiAgY2xhc3MgVXRpbHMgewogICAgLyoqCiAgICAgKiBFeHRlbmQgYW4gb3B0aW9ucyBvYmplY3Qgd2l0aCBkZWZhdWx0IHZhbHVlcy4KICAgICAqIEBwYXJhbSBvcHRpb25zIFRoZSBvcHRpb25zIG9iamVjdC4gTWF5IGJlIGZhbHN5OiBpbiB0aGlzIGNhc2UsIGEgbmV3IG9iamVjdCBpcyBjcmVhdGVkIGFuZCByZXR1cm5lZC4KICAgICAqIEBwYXJhbSBkZWZhdWx0cyBBbiBvYmplY3QgY29udGFpbmluZyBkZWZhdWx0IHZhbHVlcy4KICAgICAqIEByZXR1cm4gVGhlIG1vZGlmaWVkIG9wdGlvbnMgb2JqZWN0LgogICAgICovCiAgICBzdGF0aWMgZGVmYXVsdHMob3B0aW9ucywgZGVmYXVsdHMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgZm9yIChsZXQga2V5IGluIGRlZmF1bHRzKSB7CiAgICAgICAgaWYgKCEoa2V5IGluIG9wdGlvbnMpKSB7CiAgICAgICAgICBvcHRpb25zW2tleV0gPSBkZWZhdWx0c1trZXldOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG9wdGlvbnM7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQ29uc3RyYWludCBiYXNlIGNsYXNzCiAgICovCiAgY2xhc3MgQ29uc3RyYWludCB7CiAgICAvKioKICAgICAqIEVxdWF0aW9ucyB0byBiZSBzb2x2ZWQgaW4gdGhpcyBjb25zdHJhaW50LgogICAgICovCgogICAgLyoqCiAgICAgKiBCb2R5IEEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEJvZHkgQi4KICAgICAqLwoKICAgIC8qKgogICAgICogU2V0IHRvIGZhbHNlIGlmIHlvdSBkb24ndCB3YW50IHRoZSBib2RpZXMgdG8gY29sbGlkZSB3aGVuIHRoZXkgYXJlIGNvbm5lY3RlZC4KICAgICAqLwogICAgY29uc3RydWN0b3IoYm9keUEsIGJvZHlCLCBvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIG9wdGlvbnMgPSBVdGlscy5kZWZhdWx0cyhvcHRpb25zLCB7CiAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdHJ1ZSwKICAgICAgICB3YWtlVXBCb2RpZXM6IHRydWUKICAgICAgfSk7CiAgICAgIHRoaXMuZXF1YXRpb25zID0gW107CiAgICAgIHRoaXMuYm9keUEgPSBib2R5QTsKICAgICAgdGhpcy5ib2R5QiA9IGJvZHlCOwogICAgICB0aGlzLmlkID0gQ29uc3RyYWludC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5jb2xsaWRlQ29ubmVjdGVkID0gb3B0aW9ucy5jb2xsaWRlQ29ubmVjdGVkOwoKICAgICAgaWYgKG9wdGlvbnMud2FrZVVwQm9kaWVzKSB7CiAgICAgICAgaWYgKGJvZHlBKSB7CiAgICAgICAgICBib2R5QS53YWtlVXAoKTsKICAgICAgICB9CgogICAgICAgIGlmIChib2R5QikgewogICAgICAgICAgYm9keUIud2FrZVVwKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFVwZGF0ZSBhbGwgdGhlIGVxdWF0aW9ucyB3aXRoIGRhdGEuCiAgICAgKi8KCgogICAgdXBkYXRlKCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ21ldGhvZCB1cGRhdGUoKSBub3QgaW1wbG1lbWVudGVkIGluIHRoaXMgQ29uc3RyYWludCBzdWJjbGFzcyEnKTsKICAgIH0KICAgIC8qKgogICAgICogRW5hYmxlcyBhbGwgZXF1YXRpb25zIGluIHRoZSBjb25zdHJhaW50LgogICAgICovCgoKICAgIGVuYWJsZSgpIHsKICAgICAgY29uc3QgZXFzID0gdGhpcy5lcXVhdGlvbnM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVxcy5sZW5ndGg7IGkrKykgewogICAgICAgIGVxc1tpXS5lbmFibGVkID0gdHJ1ZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBEaXNhYmxlcyBhbGwgZXF1YXRpb25zIGluIHRoZSBjb25zdHJhaW50LgogICAgICovCgoKICAgIGRpc2FibGUoKSB7CiAgICAgIGNvbnN0IGVxcyA9IHRoaXMuZXF1YXRpb25zOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlcXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBlcXNbaV0uZW5hYmxlZCA9IGZhbHNlOwogICAgICB9CiAgICB9CgogIH0KICBDb25zdHJhaW50LmlkQ291bnRlciA9IDA7CgogIC8qKgogICAqIEFuIGVsZW1lbnQgY29udGFpbmluZyA2IGVudHJpZXMsIDMgc3BhdGlhbCBhbmQgMyByb3RhdGlvbmFsIGRlZ3JlZXMgb2YgZnJlZWRvbS4KICAgKi8KCiAgY2xhc3MgSmFjb2JpYW5FbGVtZW50IHsKICAgIC8qKgogICAgICogc3BhdGlhbAogICAgICovCgogICAgLyoqCiAgICAgKiByb3RhdGlvbmFsCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICB0aGlzLnNwYXRpYWwgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnJvdGF0aW9uYWwgPSBuZXcgVmVjMygpOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB3aXRoIG90aGVyIEphY29iaWFuRWxlbWVudAogICAgICovCgoKICAgIG11bHRpcGx5RWxlbWVudChlbGVtZW50KSB7CiAgICAgIHJldHVybiBlbGVtZW50LnNwYXRpYWwuZG90KHRoaXMuc3BhdGlhbCkgKyBlbGVtZW50LnJvdGF0aW9uYWwuZG90KHRoaXMucm90YXRpb25hbCk7CiAgICB9CiAgICAvKioKICAgICAqIE11bHRpcGx5IHdpdGggdHdvIHZlY3RvcnMKICAgICAqLwoKCiAgICBtdWx0aXBseVZlY3RvcnMoc3BhdGlhbCwgcm90YXRpb25hbCkgewogICAgICByZXR1cm4gc3BhdGlhbC5kb3QodGhpcy5zcGF0aWFsKSArIHJvdGF0aW9uYWwuZG90KHRoaXMucm90YXRpb25hbCk7CiAgICB9CgogIH0KCiAgLyoqCiAgICogRXF1YXRpb24gYmFzZSBjbGFzcy4KICAgKgogICAqIGBhYCwgYGJgIGFuZCBgZXBzYCBhcmUge0BsaW5rIGh0dHBzOi8vd3d3OC5jcy51bXUuc2Uva3Vyc2VyLzVEVjA1OC9WVDE1L2xlY3R1cmVzL1NQT09LbGFibm90ZXMucGRmIFNQT09LfSBwYXJhbWV0ZXJzIHRoYXQgZGVmYXVsdCB0byBgMC4wYC4gU2VlIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vc2NodGVwcGUvY2Fubm9uLmpzL2lzc3Vlcy8yMzgjaXNzdWVjb21tZW50LTE0NzE3MjMyNyB0aGlzIGV4Y2hhbmdlfSBmb3IgbW9yZSBkZXRhaWxzIG9uIENhbm5vbidzIHBoeXNpY3MgaW1wbGVtZW50YXRpb24uCiAgICovCiAgY2xhc3MgRXF1YXRpb24gewogICAgLyoqCiAgICAgKiBNaW5pbXVtIChyZWFkOiBuZWdhdGl2ZSBtYXgpIGZvcmNlIHRvIGJlIGFwcGxpZWQgYnkgdGhlIGNvbnN0cmFpbnQuCiAgICAgKi8KCiAgICAvKioKICAgICAqIE1heGltdW0gKHJlYWQ6IHBvc2l0aXZlIG1heCkgZm9yY2UgdG8gYmUgYXBwbGllZCBieSB0aGUgY29uc3RyYWludC4KICAgICAqLwoKICAgIC8qKgogICAgICogU1BPT0sgcGFyYW1ldGVyCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNQT09LIHBhcmFtZXRlcgogICAgICovCgogICAgLyoqCiAgICAgKiBTUE9PSyBwYXJhbWV0ZXIKICAgICAqLwoKICAgIC8qKgogICAgICogQSBudW1iZXIsIHByb3BvcnRpb25hbCB0byB0aGUgZm9yY2UgYWRkZWQgdG8gdGhlIGJvZGllcy4KICAgICAqLwogICAgY29uc3RydWN0b3IoYmksIGJqLCBtaW5Gb3JjZSwgbWF4Rm9yY2UpIHsKICAgICAgaWYgKG1pbkZvcmNlID09PSB2b2lkIDApIHsKICAgICAgICBtaW5Gb3JjZSA9IC0xZTY7CiAgICAgIH0KCiAgICAgIGlmIChtYXhGb3JjZSA9PT0gdm9pZCAwKSB7CiAgICAgICAgbWF4Rm9yY2UgPSAxZTY7CiAgICAgIH0KCiAgICAgIHRoaXMuaWQgPSBFcXVhdGlvbi5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5taW5Gb3JjZSA9IG1pbkZvcmNlOwogICAgICB0aGlzLm1heEZvcmNlID0gbWF4Rm9yY2U7CiAgICAgIHRoaXMuYmkgPSBiaTsKICAgICAgdGhpcy5iaiA9IGJqOwogICAgICB0aGlzLmEgPSAwLjA7IC8vIFNQT09LIHBhcmFtZXRlcgoKICAgICAgdGhpcy5iID0gMC4wOyAvLyBTUE9PSyBwYXJhbWV0ZXIKCiAgICAgIHRoaXMuZXBzID0gMC4wOyAvLyBTUE9PSyBwYXJhbWV0ZXIKCiAgICAgIHRoaXMuamFjb2JpYW5FbGVtZW50QSA9IG5ldyBKYWNvYmlhbkVsZW1lbnQoKTsKICAgICAgdGhpcy5qYWNvYmlhbkVsZW1lbnRCID0gbmV3IEphY29iaWFuRWxlbWVudCgpOwogICAgICB0aGlzLmVuYWJsZWQgPSB0cnVlOwogICAgICB0aGlzLm11bHRpcGxpZXIgPSAwOwogICAgICB0aGlzLnNldFNwb29rUGFyYW1zKDFlNywgNCwgMSAvIDYwKTsgLy8gU2V0IHR5cGljYWwgc3Bvb2sgcGFyYW1zCiAgICB9CiAgICAvKioKICAgICAqIFJlY2FsY3VsYXRlcyBhLCBiLCBhbmQgZXBzLgogICAgICoKICAgICAqIFRoZSBFcXVhdGlvbiBjb25zdHJ1Y3RvciBzZXRzIHR5cGljYWwgU1BPT0sgcGFyYW1ldGVycyBhcyBzdWNoOgogICAgICogKiBgc3RpZmZuZXNzYCA9IDFlNwogICAgICogKiBgcmVsYXhhdGlvbmAgPSA0CiAgICAgKiAqIGB0aW1lU3RlcGA9IDEgLyA2MCwgX25vdGUgdGhlIGhhcmRjb2RlZCByZWZyZXNoIHJhdGUuXwogICAgICovCgoKICAgIHNldFNwb29rUGFyYW1zKHN0aWZmbmVzcywgcmVsYXhhdGlvbiwgdGltZVN0ZXApIHsKICAgICAgY29uc3QgZCA9IHJlbGF4YXRpb247CiAgICAgIGNvbnN0IGsgPSBzdGlmZm5lc3M7CiAgICAgIGNvbnN0IGggPSB0aW1lU3RlcDsKICAgICAgdGhpcy5hID0gNC4wIC8gKGggKiAoMSArIDQgKiBkKSk7CiAgICAgIHRoaXMuYiA9IDQuMCAqIGQgLyAoMSArIDQgKiBkKTsKICAgICAgdGhpcy5lcHMgPSA0LjAgLyAoaCAqIGggKiBrICogKDEgKyA0ICogZCkpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyB0aGUgcmlnaHQgaGFuZCBzaWRlIG9mIHRoZSBTUE9PSyBlcXVhdGlvbgogICAgICovCgoKICAgIGNvbXB1dGVCKGEsIGIsIGgpIHsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHcSA9IHRoaXMuY29tcHV0ZUdxKCk7CiAgICAgIGNvbnN0IEdpTWYgPSB0aGlzLmNvbXB1dGVHaU1mKCk7CiAgICAgIHJldHVybiAtR3EgKiBhIC0gR1cgKiBiIC0gR2lNZiAqIGg7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIEcqcSwgd2hlcmUgcSBhcmUgdGhlIGdlbmVyYWxpemVkIGJvZHkgY29vcmRpbmF0ZXMKICAgICAqLwoKCiAgICBjb21wdXRlR3EoKSB7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgY29uc3QgYmkgPSB0aGlzLmJpOwogICAgICBjb25zdCBiaiA9IHRoaXMuYmo7CiAgICAgIGNvbnN0IHhpID0gYmkucG9zaXRpb247CiAgICAgIGNvbnN0IHhqID0gYmoucG9zaXRpb247CiAgICAgIHJldHVybiBHQS5zcGF0aWFsLmRvdCh4aSkgKyBHQi5zcGF0aWFsLmRvdCh4aik7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIEcqVywgd2hlcmUgVyBhcmUgdGhlIGJvZHkgdmVsb2NpdGllcwogICAgICovCgoKICAgIGNvbXB1dGVHVygpIHsKICAgICAgY29uc3QgR0EgPSB0aGlzLmphY29iaWFuRWxlbWVudEE7CiAgICAgIGNvbnN0IEdCID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRCOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgdmkgPSBiaS52ZWxvY2l0eTsKICAgICAgY29uc3QgdmogPSBiai52ZWxvY2l0eTsKICAgICAgY29uc3Qgd2kgPSBiaS5hbmd1bGFyVmVsb2NpdHk7CiAgICAgIGNvbnN0IHdqID0gYmouYW5ndWxhclZlbG9jaXR5OwogICAgICByZXR1cm4gR0EubXVsdGlwbHlWZWN0b3JzKHZpLCB3aSkgKyBHQi5tdWx0aXBseVZlY3RvcnModmosIHdqKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZXMgRypXbGFtYmRhLCB3aGVyZSBXIGFyZSB0aGUgYm9keSB2ZWxvY2l0aWVzCiAgICAgKi8KCgogICAgY29tcHV0ZUdXbGFtYmRhKCkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCB2aSA9IGJpLnZsYW1iZGE7CiAgICAgIGNvbnN0IHZqID0gYmoudmxhbWJkYTsKICAgICAgY29uc3Qgd2kgPSBiaS53bGFtYmRhOwogICAgICBjb25zdCB3aiA9IGJqLndsYW1iZGE7CiAgICAgIHJldHVybiBHQS5tdWx0aXBseVZlY3RvcnModmksIHdpKSArIEdCLm11bHRpcGx5VmVjdG9ycyh2aiwgd2opOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyBHKmludihNKSpmLCB3aGVyZSBNIGlzIHRoZSBtYXNzIG1hdHJpeCB3aXRoIGRpYWdvbmFsIGJsb2NrcyBmb3IgZWFjaCBib2R5LCBhbmQgZiBhcmUgdGhlIGZvcmNlcyBvbiB0aGUgYm9kaWVzLgogICAgICovCgoKICAgIGNvbXB1dGVHaU1mKCkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCBmaSA9IGJpLmZvcmNlOwogICAgICBjb25zdCB0aSA9IGJpLnRvcnF1ZTsKICAgICAgY29uc3QgZmogPSBiai5mb3JjZTsKICAgICAgY29uc3QgdGogPSBiai50b3JxdWU7CiAgICAgIGNvbnN0IGludk1hc3NpID0gYmkuaW52TWFzc1NvbHZlOwogICAgICBjb25zdCBpbnZNYXNzaiA9IGJqLmludk1hc3NTb2x2ZTsKICAgICAgZmkuc2NhbGUoaW52TWFzc2ksIGlNZmkpOwogICAgICBmai5zY2FsZShpbnZNYXNzaiwgaU1maik7CiAgICAgIGJpLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KHRpLCBpbnZJaV92bXVsdF90YXVpKTsKICAgICAgYmouaW52SW5lcnRpYVdvcmxkU29sdmUudm11bHQodGosIGludklqX3ZtdWx0X3RhdWopOwogICAgICByZXR1cm4gR0EubXVsdGlwbHlWZWN0b3JzKGlNZmksIGludklpX3ZtdWx0X3RhdWkpICsgR0IubXVsdGlwbHlWZWN0b3JzKGlNZmosIGludklqX3ZtdWx0X3RhdWopOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyBHKmludihNKSpHJwogICAgICovCgoKICAgIGNvbXB1dGVHaU1HdCgpIHsKICAgICAgY29uc3QgR0EgPSB0aGlzLmphY29iaWFuRWxlbWVudEE7CiAgICAgIGNvbnN0IEdCID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRCOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgaW52TWFzc2kgPSBiaS5pbnZNYXNzU29sdmU7CiAgICAgIGNvbnN0IGludk1hc3NqID0gYmouaW52TWFzc1NvbHZlOwogICAgICBjb25zdCBpbnZJaSA9IGJpLmludkluZXJ0aWFXb3JsZFNvbHZlOwogICAgICBjb25zdCBpbnZJaiA9IGJqLmludkluZXJ0aWFXb3JsZFNvbHZlOwogICAgICBsZXQgcmVzdWx0ID0gaW52TWFzc2kgKyBpbnZNYXNzajsKICAgICAgaW52SWkudm11bHQoR0Eucm90YXRpb25hbCwgdG1wKTsKICAgICAgcmVzdWx0ICs9IHRtcC5kb3QoR0Eucm90YXRpb25hbCk7CiAgICAgIGludklqLnZtdWx0KEdCLnJvdGF0aW9uYWwsIHRtcCk7CiAgICAgIHJlc3VsdCArPSB0bXAuZG90KEdCLnJvdGF0aW9uYWwpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgY29uc3RyYWludCB2ZWxvY2l0eSB0byB0aGUgYm9kaWVzLgogICAgICovCgoKICAgIGFkZFRvV2xhbWJkYShkZWx0YWxhbWJkYSkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCB0ZW1wID0gYWRkVG9XbGFtYmRhX3RlbXA7IC8vIEFkZCB0byBsaW5lYXIgdmVsb2NpdHkKICAgICAgLy8gdl9sYW1iZGEgKz0gaW52KE0pICogZGVsdGFfbGFtYmEgKiBHCgogICAgICBiaS52bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihiaS5pbnZNYXNzU29sdmUgKiBkZWx0YWxhbWJkYSwgR0Euc3BhdGlhbCwgYmkudmxhbWJkYSk7CiAgICAgIGJqLnZsYW1iZGEuYWRkU2NhbGVkVmVjdG9yKGJqLmludk1hc3NTb2x2ZSAqIGRlbHRhbGFtYmRhLCBHQi5zcGF0aWFsLCBiai52bGFtYmRhKTsgLy8gQWRkIHRvIGFuZ3VsYXIgdmVsb2NpdHkKCiAgICAgIGJpLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KEdBLnJvdGF0aW9uYWwsIHRlbXApOwogICAgICBiaS53bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihkZWx0YWxhbWJkYSwgdGVtcCwgYmkud2xhbWJkYSk7CiAgICAgIGJqLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KEdCLnJvdGF0aW9uYWwsIHRlbXApOwogICAgICBiai53bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihkZWx0YWxhbWJkYSwgdGVtcCwgYmoud2xhbWJkYSk7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGUgdGhlIGRlbm9taW5hdG9yIHBhcnQgb2YgdGhlIFNQT09LIGVxdWF0aW9uOiBDID0gRyppbnYoTSkqRycgKyBlcHMKICAgICAqLwoKCiAgICBjb21wdXRlQygpIHsKICAgICAgcmV0dXJuIHRoaXMuY29tcHV0ZUdpTUd0KCkgKyB0aGlzLmVwczsKICAgIH0KCiAgfQogIEVxdWF0aW9uLmlkQ291bnRlciA9IDA7CiAgY29uc3QgaU1maSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaU1maiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW52SWlfdm11bHRfdGF1aSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW52SWpfdm11bHRfdGF1aiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wID0gbmV3IFZlYzMoKTsKICBjb25zdCBhZGRUb1dsYW1iZGFfdGVtcCA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIENvbnRhY3Qvbm9uLXBlbmV0cmF0aW9uIGNvbnN0cmFpbnQgZXF1YXRpb24KICAgKi8KICBjbGFzcyBDb250YWN0RXF1YXRpb24gZXh0ZW5kcyBFcXVhdGlvbiB7CiAgICAvKioKICAgICAqICJib3VuY2luZXNzIjogdTEgPSAtZSp1MAogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZC1vcmllbnRlZCB2ZWN0b3IgdGhhdCBnb2VzIGZyb20gdGhlIGNlbnRlciBvZiBiaSB0byB0aGUgY29udGFjdCBwb2ludC4KICAgICAqLwoKICAgIC8qKgogICAgICogV29ybGQtb3JpZW50ZWQgdmVjdG9yIHRoYXQgc3RhcnRzIGluIGJvZHkgaiBwb3NpdGlvbiBhbmQgZ29lcyB0byB0aGUgY29udGFjdCBwb2ludC4KICAgICAqLwoKICAgIC8qKgogICAgICogQ29udGFjdCBub3JtYWwsIHBvaW50aW5nIG91dCBvZiBib2R5IGkuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5QiwgbWF4Rm9yY2UpIHsKICAgICAgaWYgKG1heEZvcmNlID09PSB2b2lkIDApIHsKICAgICAgICBtYXhGb3JjZSA9IDFlNjsKICAgICAgfQoKICAgICAgc3VwZXIoYm9keUEsIGJvZHlCLCAwLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMucmVzdGl0dXRpb24gPSAwLjA7CiAgICAgIHRoaXMucmkgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnJqID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5uaSA9IG5ldyBWZWMzKCk7CiAgICB9CgogICAgY29tcHV0ZUIoaCkgewogICAgICBjb25zdCBhID0gdGhpcy5hOwogICAgICBjb25zdCBiID0gdGhpcy5iOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgcmkgPSB0aGlzLnJpOwogICAgICBjb25zdCByaiA9IHRoaXMucmo7CiAgICAgIGNvbnN0IHJpeG4gPSBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDE7CiAgICAgIGNvbnN0IHJqeG4gPSBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDI7CiAgICAgIGNvbnN0IHZpID0gYmkudmVsb2NpdHk7CiAgICAgIGNvbnN0IHdpID0gYmkuYW5ndWxhclZlbG9jaXR5OwogICAgICBiaS5mb3JjZTsKICAgICAgYmkudG9ycXVlOwogICAgICBjb25zdCB2aiA9IGJqLnZlbG9jaXR5OwogICAgICBjb25zdCB3aiA9IGJqLmFuZ3VsYXJWZWxvY2l0eTsKICAgICAgYmouZm9yY2U7CiAgICAgIGJqLnRvcnF1ZTsKICAgICAgY29uc3QgcGVuZXRyYXRpb25WZWMgPSBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDM7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgY29uc3QgbiA9IHRoaXMubmk7IC8vIENhbHVjbGF0ZSBjcm9zcyBwcm9kdWN0cwoKICAgICAgcmkuY3Jvc3Mobiwgcml4bik7CiAgICAgIHJqLmNyb3NzKG4sIHJqeG4pOyAvLyBnID0geGorcmogLSh4aStyaSkKICAgICAgLy8gRyA9IFsgLW5pICAtcml4biAgbmkgIHJqeG4gXQoKICAgICAgbi5uZWdhdGUoR0Euc3BhdGlhbCk7CiAgICAgIHJpeG4ubmVnYXRlKEdBLnJvdGF0aW9uYWwpOwogICAgICBHQi5zcGF0aWFsLmNvcHkobik7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShyanhuKTsgLy8gQ2FsY3VsYXRlIHRoZSBwZW5ldHJhdGlvbiB2ZWN0b3IKCiAgICAgIHBlbmV0cmF0aW9uVmVjLmNvcHkoYmoucG9zaXRpb24pOwogICAgICBwZW5ldHJhdGlvblZlYy52YWRkKHJqLCBwZW5ldHJhdGlvblZlYyk7CiAgICAgIHBlbmV0cmF0aW9uVmVjLnZzdWIoYmkucG9zaXRpb24sIHBlbmV0cmF0aW9uVmVjKTsKICAgICAgcGVuZXRyYXRpb25WZWMudnN1YihyaSwgcGVuZXRyYXRpb25WZWMpOwogICAgICBjb25zdCBnID0gbi5kb3QocGVuZXRyYXRpb25WZWMpOyAvLyBDb21wdXRlIGl0ZXJhdGlvbgoKICAgICAgY29uc3QgZVBsdXNPbmUgPSB0aGlzLnJlc3RpdHV0aW9uICsgMTsKICAgICAgY29uc3QgR1cgPSBlUGx1c09uZSAqIHZqLmRvdChuKSAtIGVQbHVzT25lICogdmkuZG90KG4pICsgd2ouZG90KHJqeG4pIC0gd2kuZG90KHJpeG4pOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLWcgKiBhIC0gR1cgKiBiIC0gaCAqIEdpTWY7CiAgICAgIHJldHVybiBCOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgcmVsYXRpdmUgdmVsb2NpdHkgaW4gdGhlIGNvbnRhY3QgcG9pbnQuCiAgICAgKi8KCgogICAgZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbCgpIHsKICAgICAgY29uc3QgdmkgPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF92aTsKICAgICAgY29uc3QgdmogPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF92ajsKICAgICAgY29uc3QgeGkgPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF94aTsKICAgICAgY29uc3QgeGogPSBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF94ajsKICAgICAgY29uc3QgcmVsVmVsID0gQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfcmVsVmVsOwogICAgICB0aGlzLmJpLnBvc2l0aW9uLnZhZGQodGhpcy5yaSwgeGkpOwogICAgICB0aGlzLmJqLnBvc2l0aW9uLnZhZGQodGhpcy5yaiwgeGopOwogICAgICB0aGlzLmJpLmdldFZlbG9jaXR5QXRXb3JsZFBvaW50KHhpLCB2aSk7CiAgICAgIHRoaXMuYmouZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQoeGosIHZqKTsKICAgICAgdmkudnN1Yih2aiwgcmVsVmVsKTsKICAgICAgcmV0dXJuIHRoaXMubmkuZG90KHJlbFZlbCk7CiAgICB9CgogIH0KICBjb25zdCBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDEgPSBuZXcgVmVjMygpOyAvLyBUZW1wIHZlY3RvcnMKCiAgY29uc3QgQ29udGFjdEVxdWF0aW9uX2NvbXB1dGVCX3RlbXAyID0gbmV3IFZlYzMoKTsKICBjb25zdCBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDMgPSBuZXcgVmVjMygpOwogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsX3ZpID0gbmV3IFZlYzMoKTsKICBjb25zdCBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF92aiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfeGkgPSBuZXcgVmVjMygpOwogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsX3hqID0gbmV3IFZlYzMoKTsKICBjb25zdCBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF9yZWxWZWwgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBDb25uZWN0cyB0d28gYm9kaWVzIGF0IGdpdmVuIG9mZnNldCBwb2ludHMuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgYm9keUEgPSBuZXcgQm9keSh7IG1hc3M6IDEgfSkKICAgKiAgICAgY29uc3QgYm9keUIgPSBuZXcgQm9keSh7IG1hc3M6IDEgfSkKICAgKiAgICAgYm9keUEucG9zaXRpb24uc2V0KC0xLCAwLCAwKQogICAqICAgICBib2R5Qi5wb3NpdGlvbi5zZXQoMSwgMCwgMCkKICAgKiAgICAgYm9keUEuYWRkU2hhcGUoc2hhcGVBKQogICAqICAgICBib2R5Qi5hZGRTaGFwZShzaGFwZUIpCiAgICogICAgIHdvcmxkLmFkZEJvZHkoYm9keUEpCiAgICogICAgIHdvcmxkLmFkZEJvZHkoYm9keUIpCiAgICogICAgIGNvbnN0IGxvY2FsUGl2b3RBID0gbmV3IFZlYzMoMSwgMCwgMCkKICAgKiAgICAgY29uc3QgbG9jYWxQaXZvdEIgPSBuZXcgVmVjMygtMSwgMCwgMCkKICAgKiAgICAgY29uc3QgY29uc3RyYWludCA9IG5ldyBQb2ludFRvUG9pbnRDb25zdHJhaW50KGJvZHlBLCBsb2NhbFBpdm90QSwgYm9keUIsIGxvY2FsUGl2b3RCKQogICAqICAgICB3b3JsZC5hZGRDb25zdHJhaW50KGNvbnN0cmFpbnQpCiAgICovCiAgY2xhc3MgUG9pbnRUb1BvaW50Q29uc3RyYWludCBleHRlbmRzIENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBQaXZvdCwgZGVmaW5lZCBsb2NhbGx5IGluIGJvZHlBLgogICAgICovCgogICAgLyoqCiAgICAgKiBQaXZvdCwgZGVmaW5lZCBsb2NhbGx5IGluIGJvZHlCLgogICAgICovCgogICAgLyoqCiAgICAgKiBAcGFyYW0gcGl2b3RBIFRoZSBwb2ludCByZWxhdGl2ZSB0byB0aGUgY2VudGVyIG9mIG1hc3Mgb2YgYm9keUEgd2hpY2ggYm9keUEgaXMgY29uc3RyYWluZWQgdG8uCiAgICAgKiBAcGFyYW0gYm9keUIgQm9keSB0aGF0IHdpbGwgYmUgY29uc3RyYWluZWQgaW4gYSBzaW1pbGFyIHdheSB0byB0aGUgc2FtZSBwb2ludCBhcyBib2R5QS4gV2Ugd2lsbCB0aGVyZWZvcmUgZ2V0IGEgbGluayBiZXR3ZWVuIGJvZHlBIGFuZCBib2R5Qi4gSWYgbm90IHNwZWNpZmllZCwgYm9keUEgd2lsbCBiZSBjb25zdHJhaW5lZCB0byBhIHN0YXRpYyBwb2ludC4KICAgICAqIEBwYXJhbSBwaXZvdEIgVGhlIHBvaW50IHJlbGF0aXZlIHRvIHRoZSBjZW50ZXIgb2YgbWFzcyBvZiBib2R5QiB3aGljaCBib2R5QiBpcyBjb25zdHJhaW5lZCB0by4KICAgICAqIEBwYXJhbSBtYXhGb3JjZSBUaGUgbWF4aW11bSBmb3JjZSB0aGF0IHNob3VsZCBiZSBhcHBsaWVkIHRvIGNvbnN0cmFpbiB0aGUgYm9kaWVzLgogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgcGl2b3RBLCBib2R5QiwgcGl2b3RCLCBtYXhGb3JjZSkgewogICAgICBpZiAocGl2b3RBID09PSB2b2lkIDApIHsKICAgICAgICBwaXZvdEEgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAocGl2b3RCID09PSB2b2lkIDApIHsKICAgICAgICBwaXZvdEIgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICBpZiAobWF4Rm9yY2UgPT09IHZvaWQgMCkgewogICAgICAgIG1heEZvcmNlID0gMWU2OwogICAgICB9CgogICAgICBzdXBlcihib2R5QSwgYm9keUIpOwogICAgICB0aGlzLnBpdm90QSA9IHBpdm90QS5jbG9uZSgpOwogICAgICB0aGlzLnBpdm90QiA9IHBpdm90Qi5jbG9uZSgpOwogICAgICBjb25zdCB4ID0gdGhpcy5lcXVhdGlvblggPSBuZXcgQ29udGFjdEVxdWF0aW9uKGJvZHlBLCBib2R5Qik7CiAgICAgIGNvbnN0IHkgPSB0aGlzLmVxdWF0aW9uWSA9IG5ldyBDb250YWN0RXF1YXRpb24oYm9keUEsIGJvZHlCKTsKICAgICAgY29uc3QgeiA9IHRoaXMuZXF1YXRpb25aID0gbmV3IENvbnRhY3RFcXVhdGlvbihib2R5QSwgYm9keUIpOyAvLyBFcXVhdGlvbnMgdG8gYmUgZmVkIHRvIHRoZSBzb2x2ZXIKCiAgICAgIHRoaXMuZXF1YXRpb25zLnB1c2goeCwgeSwgeik7IC8vIE1ha2UgdGhlIGVxdWF0aW9ucyBiaWRpcmVjdGlvbmFsCgogICAgICB4Lm1pbkZvcmNlID0geS5taW5Gb3JjZSA9IHoubWluRm9yY2UgPSAtbWF4Rm9yY2U7CiAgICAgIHgubWF4Rm9yY2UgPSB5Lm1heEZvcmNlID0gei5tYXhGb3JjZSA9IG1heEZvcmNlOwogICAgICB4Lm5pLnNldCgxLCAwLCAwKTsKICAgICAgeS5uaS5zZXQoMCwgMSwgMCk7CiAgICAgIHoubmkuc2V0KDAsIDAsIDEpOwogICAgfQoKICAgIHVwZGF0ZSgpIHsKICAgICAgY29uc3QgYm9keUEgPSB0aGlzLmJvZHlBOwogICAgICBjb25zdCBib2R5QiA9IHRoaXMuYm9keUI7CiAgICAgIGNvbnN0IHggPSB0aGlzLmVxdWF0aW9uWDsKICAgICAgY29uc3QgeSA9IHRoaXMuZXF1YXRpb25ZOwogICAgICBjb25zdCB6ID0gdGhpcy5lcXVhdGlvblo7IC8vIFJvdGF0ZSB0aGUgcGl2b3RzIHRvIHdvcmxkIHNwYWNlCgogICAgICBib2R5QS5xdWF0ZXJuaW9uLnZtdWx0KHRoaXMucGl2b3RBLCB4LnJpKTsKICAgICAgYm9keUIucXVhdGVybmlvbi52bXVsdCh0aGlzLnBpdm90QiwgeC5yaik7CiAgICAgIHkucmkuY29weSh4LnJpKTsKICAgICAgeS5yai5jb3B5KHgucmopOwogICAgICB6LnJpLmNvcHkoeC5yaSk7CiAgICAgIHoucmouY29weSh4LnJqKTsKICAgIH0KCiAgfQoKICAvKioKICAgKiBDb25lIGVxdWF0aW9uLiBXb3JrcyB0byBrZWVwIHRoZSBnaXZlbiBib2R5IHdvcmxkIHZlY3RvcnMgYWxpZ25lZCwgb3IgdGlsdGVkIHdpdGhpbiBhIGdpdmVuIGFuZ2xlIGZyb20gZWFjaCBvdGhlci4KICAgKi8KICBjbGFzcyBDb25lRXF1YXRpb24gZXh0ZW5kcyBFcXVhdGlvbiB7CiAgICAvKioKICAgICAqIExvY2FsIGF4aXMgaW4gQQogICAgICovCgogICAgLyoqCiAgICAgKiBMb2NhbCBheGlzIGluIEIKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlICJjb25lIGFuZ2xlIiB0byBrZWVwCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLW1heEZvcmNlLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMCwgMSwgMCk7CiAgICAgIHRoaXMuYW5nbGUgPSB0eXBlb2Ygb3B0aW9ucy5hbmdsZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFuZ2xlIDogMDsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIGNvbnN0IGEgPSB0aGlzLmE7CiAgICAgIGNvbnN0IGIgPSB0aGlzLmI7CiAgICAgIGNvbnN0IG5pID0gdGhpcy5heGlzQTsKICAgICAgY29uc3QgbmogPSB0aGlzLmF4aXNCOwogICAgICBjb25zdCBuaXhuaiA9IHRtcFZlYzEkMjsKICAgICAgY29uc3Qgbmp4bmkgPSB0bXBWZWMyJDI7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gQ2FsdWNsYXRlIGNyb3NzIHByb2R1Y3RzCgogICAgICBuaS5jcm9zcyhuaiwgbml4bmopOwogICAgICBuai5jcm9zcyhuaSwgbmp4bmkpOyAvLyBUaGUgYW5nbGUgYmV0d2VlbiB0d28gdmVjdG9yIGlzOgogICAgICAvLyBjb3ModGhldGEpID0gYSAqIGIgLyAobGVuZ3RoKGEpICogbGVuZ3RoKGIpID0geyBsZW4oYSkgPSBsZW4oYikgPSAxIH0gPSBhICogYgogICAgICAvLyBnID0gYSAqIGIKICAgICAgLy8gZ2RvdCA9IChiIHggYSkgKiB3aSArIChhIHggYikgKiB3agogICAgICAvLyBHID0gWzAgYnhhIDAgYXhiXQogICAgICAvLyBXID0gW3ZpIHdpIHZqIHdqXQoKICAgICAgR0Eucm90YXRpb25hbC5jb3B5KG5qeG5pKTsKICAgICAgR0Iucm90YXRpb25hbC5jb3B5KG5peG5qKTsKICAgICAgY29uc3QgZyA9IE1hdGguY29zKHRoaXMuYW5nbGUpIC0gbmkuZG90KG5qKTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLWcgKiBhIC0gR1cgKiBiIC0gaCAqIEdpTWY7CiAgICAgIHJldHVybiBCOwogICAgfQoKICB9CiAgY29uc3QgdG1wVmVjMSQyID0gbmV3IFZlYzMoKTsKICBjb25zdCB0bXBWZWMyJDIgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBSb3RhdGlvbmFsIGNvbnN0cmFpbnQuIFdvcmtzIHRvIGtlZXAgdGhlIGxvY2FsIHZlY3RvcnMgb3J0aG9nb25hbCB0byBlYWNoIG90aGVyIGluIHdvcmxkIHNwYWNlLgogICAqLwogIGNsYXNzIFJvdGF0aW9uYWxFcXVhdGlvbiBleHRlbmRzIEVxdWF0aW9uIHsKICAgIC8qKgogICAgICogV29ybGQgb3JpZW50ZWQgcm90YXRpb25hbCBheGlzLgogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZCBvcmllbnRlZCByb3RhdGlvbmFsIGF4aXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIG1heEFuZ2xlCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLW1heEZvcmNlLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMCwgMSwgMCk7CiAgICAgIHRoaXMubWF4QW5nbGUgPSBNYXRoLlBJIC8gMjsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIGNvbnN0IGEgPSB0aGlzLmE7CiAgICAgIGNvbnN0IGIgPSB0aGlzLmI7CiAgICAgIGNvbnN0IG5pID0gdGhpcy5heGlzQTsKICAgICAgY29uc3QgbmogPSB0aGlzLmF4aXNCOwogICAgICBjb25zdCBuaXhuaiA9IHRtcFZlYzEkMTsKICAgICAgY29uc3Qgbmp4bmkgPSB0bXBWZWMyJDE7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gQ2FsdWNsYXRlIGNyb3NzIHByb2R1Y3RzCgogICAgICBuaS5jcm9zcyhuaiwgbml4bmopOwogICAgICBuai5jcm9zcyhuaSwgbmp4bmkpOyAvLyBnID0gbmkgKiBuagogICAgICAvLyBnZG90ID0gKG5qIHggbmkpICogd2kgKyAobmkgeCBuaikgKiB3agogICAgICAvLyBHID0gWzAgbmp4bmkgMCBuaXhual0KICAgICAgLy8gVyA9IFt2aSB3aSB2aiB3al0KCiAgICAgIEdBLnJvdGF0aW9uYWwuY29weShuanhuaSk7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShuaXhuaik7CiAgICAgIGNvbnN0IGcgPSBNYXRoLmNvcyh0aGlzLm1heEFuZ2xlKSAtIG5pLmRvdChuaik7CiAgICAgIGNvbnN0IEdXID0gdGhpcy5jb21wdXRlR1coKTsKICAgICAgY29uc3QgR2lNZiA9IHRoaXMuY29tcHV0ZUdpTWYoKTsKICAgICAgY29uc3QgQiA9IC1nICogYSAtIEdXICogYiAtIGggKiBHaU1mOwogICAgICByZXR1cm4gQjsKICAgIH0KCiAgfQogIGNvbnN0IHRtcFZlYzEkMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wVmVjMiQxID0gbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQSBDb25lIFR3aXN0IGNvbnN0cmFpbnQsIHVzZWZ1bCBmb3IgcmFnZG9sbHMuCiAgICovCiAgY2xhc3MgQ29uZVR3aXN0Q29uc3RyYWludCBleHRlbmRzIFBvaW50VG9Qb2ludENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBUaGUgYXhpcyBkaXJlY3Rpb24gZm9yIHRoZSBjb25zdHJhaW50IG9mIHRoZSBib2R5IEEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBheGlzIGRpcmVjdGlvbiBmb3IgdGhlIGNvbnN0cmFpbnQgb2YgdGhlIGJvZHkgQi4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGFwZXJ0dXJlIGFuZ2xlIG9mIHRoZSBjb25lLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgdHdpc3QgYW5nbGUgb2YgdGhlIGpvaW50LgogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgYm9keUIsIG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgY29uc3QgbWF4Rm9yY2UgPSB0eXBlb2Ygb3B0aW9ucy5tYXhGb3JjZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLm1heEZvcmNlIDogMWU2OyAvLyBTZXQgcGl2b3QgcG9pbnQgaW4gYmV0d2VlbgoKICAgICAgY29uc3QgcGl2b3RBID0gb3B0aW9ucy5waXZvdEEgPyBvcHRpb25zLnBpdm90QS5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGl2b3RCID0gb3B0aW9ucy5waXZvdEIgPyBvcHRpb25zLnBpdm90Qi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOwogICAgICB0aGlzLmF4aXNBID0gb3B0aW9ucy5heGlzQSA/IG9wdGlvbnMuYXhpc0EuY2xvbmUoKSA6IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgdGhpcy5jb2xsaWRlQ29ubmVjdGVkID0gISFvcHRpb25zLmNvbGxpZGVDb25uZWN0ZWQ7CiAgICAgIHRoaXMuYW5nbGUgPSB0eXBlb2Ygb3B0aW9ucy5hbmdsZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFuZ2xlIDogMDsKICAgICAgY29uc3QgYyA9IHRoaXMuY29uZUVxdWF0aW9uID0gbmV3IENvbmVFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICBjb25zdCB0ID0gdGhpcy50d2lzdEVxdWF0aW9uID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICB0aGlzLnR3aXN0QW5nbGUgPSB0eXBlb2Ygb3B0aW9ucy50d2lzdEFuZ2xlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMudHdpc3RBbmdsZSA6IDA7IC8vIE1ha2UgdGhlIGNvbmUgZXF1YXRpb24gcHVzaCB0aGUgYm9kaWVzIHRvd2FyZCB0aGUgY29uZSBheGlzLCBub3Qgb3V0d2FyZAoKICAgICAgYy5tYXhGb3JjZSA9IDA7CiAgICAgIGMubWluRm9yY2UgPSAtbWF4Rm9yY2U7IC8vIE1ha2UgdGhlIHR3aXN0IGVxdWF0aW9uIGFkZCB0b3JxdWUgdG93YXJkIHRoZSBpbml0aWFsIHBvc2l0aW9uCgogICAgICB0Lm1heEZvcmNlID0gMDsKICAgICAgdC5taW5Gb3JjZSA9IC1tYXhGb3JjZTsKICAgICAgdGhpcy5lcXVhdGlvbnMucHVzaChjLCB0KTsKICAgIH0KCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICBjb25zdCBjb25lID0gdGhpcy5jb25lRXF1YXRpb247CiAgICAgIGNvbnN0IHR3aXN0ID0gdGhpcy50d2lzdEVxdWF0aW9uOwogICAgICBzdXBlci51cGRhdGUoKTsgLy8gVXBkYXRlIHRoZSBheGVzIHRvIHRoZSBjb25lIGNvbnN0cmFpbnQKCiAgICAgIGJvZHlBLnZlY3RvclRvV29ybGRGcmFtZSh0aGlzLmF4aXNBLCBjb25lLmF4aXNBKTsKICAgICAgYm9keUIudmVjdG9yVG9Xb3JsZEZyYW1lKHRoaXMuYXhpc0IsIGNvbmUuYXhpc0IpOyAvLyBVcGRhdGUgdGhlIHdvcmxkIGF4ZXMgaW4gdGhlIHR3aXN0IGNvbnN0cmFpbnQKCiAgICAgIHRoaXMuYXhpc0EudGFuZ2VudHModHdpc3QuYXhpc0EsIHR3aXN0LmF4aXNBKTsKICAgICAgYm9keUEudmVjdG9yVG9Xb3JsZEZyYW1lKHR3aXN0LmF4aXNBLCB0d2lzdC5heGlzQSk7CiAgICAgIHRoaXMuYXhpc0IudGFuZ2VudHModHdpc3QuYXhpc0IsIHR3aXN0LmF4aXNCKTsKICAgICAgYm9keUIudmVjdG9yVG9Xb3JsZEZyYW1lKHR3aXN0LmF4aXNCLCB0d2lzdC5heGlzQik7CiAgICAgIGNvbmUuYW5nbGUgPSB0aGlzLmFuZ2xlOwogICAgICB0d2lzdC5tYXhBbmdsZSA9IHRoaXMudHdpc3RBbmdsZTsKICAgIH0KCiAgfQogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQ29uc3RyYWlucyB0d28gYm9kaWVzIHRvIGJlIGF0IGEgY29uc3RhbnQgZGlzdGFuY2UgZnJvbSBlYWNoIG90aGVycyBjZW50ZXIgb2YgbWFzcy4KICAgKi8KICBjbGFzcyBEaXN0YW5jZUNvbnN0cmFpbnQgZXh0ZW5kcyBDb25zdHJhaW50IHsKICAgIC8qKgogICAgICogVGhlIGRpc3RhbmNlIHRvIGtlZXAuIElmIHVuZGVmaW5lZCwgaXQgd2lsbCBiZSBzZXQgdG8gdGhlIGN1cnJlbnQgZGlzdGFuY2UgYmV0d2VlbiBib2R5QSBhbmQgYm9keUIKICAgICAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIGRpc3RhbmNlIFRoZSBkaXN0YW5jZSB0byBrZWVwLiBJZiB1bmRlZmluZWQsIGl0IHdpbGwgYmUgc2V0IHRvIHRoZSBjdXJyZW50IGRpc3RhbmNlIGJldHdlZW4gYm9keUEgYW5kIGJvZHlCLgogICAgICogQHBhcmFtIG1heEZvcmNlIFRoZSBtYXhpbXVtIGZvcmNlIHRoYXQgc2hvdWxkIGJlIGFwcGxpZWQgdG8gY29uc3RyYWluIHRoZSBib2RpZXMuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5QiwgZGlzdGFuY2UsIG1heEZvcmNlKSB7CiAgICAgIGlmIChtYXhGb3JjZSA9PT0gdm9pZCAwKSB7CiAgICAgICAgbWF4Rm9yY2UgPSAxZTY7CiAgICAgIH0KCiAgICAgIHN1cGVyKGJvZHlBLCBib2R5Qik7CgogICAgICBpZiAodHlwZW9mIGRpc3RhbmNlID09PSAndW5kZWZpbmVkJykgewogICAgICAgIGRpc3RhbmNlID0gYm9keUEucG9zaXRpb24uZGlzdGFuY2VUbyhib2R5Qi5wb3NpdGlvbik7CiAgICAgIH0KCiAgICAgIHRoaXMuZGlzdGFuY2UgPSBkaXN0YW5jZTsKICAgICAgY29uc3QgZXEgPSB0aGlzLmRpc3RhbmNlRXF1YXRpb24gPSBuZXcgQ29udGFjdEVxdWF0aW9uKGJvZHlBLCBib2R5Qik7CiAgICAgIHRoaXMuZXF1YXRpb25zLnB1c2goZXEpOyAvLyBNYWtlIGl0IGJpZGlyZWN0aW9uYWwKCiAgICAgIGVxLm1pbkZvcmNlID0gLW1heEZvcmNlOwogICAgICBlcS5tYXhGb3JjZSA9IG1heEZvcmNlOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICBjb25zdCBlcSA9IHRoaXMuZGlzdGFuY2VFcXVhdGlvbjsKICAgICAgY29uc3QgaGFsZkRpc3QgPSB0aGlzLmRpc3RhbmNlICogMC41OwogICAgICBjb25zdCBub3JtYWwgPSBlcS5uaTsKICAgICAgYm9keUIucG9zaXRpb24udnN1Yihib2R5QS5wb3NpdGlvbiwgbm9ybWFsKTsKICAgICAgbm9ybWFsLm5vcm1hbGl6ZSgpOwogICAgICBub3JtYWwuc2NhbGUoaGFsZkRpc3QsIGVxLnJpKTsKICAgICAgbm9ybWFsLnNjYWxlKC1oYWxmRGlzdCwgZXEucmopOwogICAgfQoKICB9CgogIC8qKgogICAqIExvY2sgY29uc3RyYWludC4gV2lsbCByZW1vdmUgYWxsIGRlZ3JlZXMgb2YgZnJlZWRvbSBiZXR3ZWVuIHRoZSBib2RpZXMuCiAgICovCiAgY2xhc3MgTG9ja0NvbnN0cmFpbnQgZXh0ZW5kcyBQb2ludFRvUG9pbnRDb25zdHJhaW50IHsKICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7IC8vIFNldCBwaXZvdCBwb2ludCBpbiBiZXR3ZWVuCgogICAgICBjb25zdCBwaXZvdEEgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBwaXZvdEIgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBoYWxmV2F5ID0gbmV3IFZlYzMoKTsKICAgICAgYm9keUEucG9zaXRpb24udmFkZChib2R5Qi5wb3NpdGlvbiwgaGFsZldheSk7CiAgICAgIGhhbGZXYXkuc2NhbGUoMC41LCBoYWxmV2F5KTsKICAgICAgYm9keUIucG9pbnRUb0xvY2FsRnJhbWUoaGFsZldheSwgcGl2b3RCKTsKICAgICAgYm9keUEucG9pbnRUb0xvY2FsRnJhbWUoaGFsZldheSwgcGl2b3RBKTsgLy8gVGhlIHBvaW50LXRvLXBvaW50IGNvbnN0cmFpbnQgd2lsbCBrZWVwIGEgcG9pbnQgc2hhcmVkIGJldHdlZW4gdGhlIGJvZGllcwoKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOyAvLyBTdG9yZSBpbml0aWFsIHJvdGF0aW9uIG9mIHRoZSBib2RpZXMgYXMgdW5pdCB2ZWN0b3JzIGluIHRoZSBsb2NhbCBib2R5IHNwYWNlcwoKICAgICAgdGhpcy54QSA9IGJvZHlBLnZlY3RvclRvTG9jYWxGcmFtZShWZWMzLlVOSVRfWCk7CiAgICAgIHRoaXMueEIgPSBib2R5Qi52ZWN0b3JUb0xvY2FsRnJhbWUoVmVjMy5VTklUX1gpOwogICAgICB0aGlzLnlBID0gYm9keUEudmVjdG9yVG9Mb2NhbEZyYW1lKFZlYzMuVU5JVF9ZKTsKICAgICAgdGhpcy55QiA9IGJvZHlCLnZlY3RvclRvTG9jYWxGcmFtZShWZWMzLlVOSVRfWSk7CiAgICAgIHRoaXMuekEgPSBib2R5QS52ZWN0b3JUb0xvY2FsRnJhbWUoVmVjMy5VTklUX1opOwogICAgICB0aGlzLnpCID0gYm9keUIudmVjdG9yVG9Mb2NhbEZyYW1lKFZlYzMuVU5JVF9aKTsgLy8gLi4uYW5kIHRoZSBmb2xsb3dpbmcgcm90YXRpb25hbCBlcXVhdGlvbnMgd2lsbCBrZWVwIGFsbCByb3RhdGlvbmFsIERPRidzIGluIHBsYWNlCgogICAgICBjb25zdCByMSA9IHRoaXMucm90YXRpb25hbEVxdWF0aW9uMSA9IG5ldyBSb3RhdGlvbmFsRXF1YXRpb24oYm9keUEsIGJvZHlCLCBvcHRpb25zKTsKICAgICAgY29uc3QgcjIgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjIgPSBuZXcgUm90YXRpb25hbEVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIGNvbnN0IHIzID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24zID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICB0aGlzLmVxdWF0aW9ucy5wdXNoKHIxLCByMiwgcjMpOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICB0aGlzLm1vdG9yRXF1YXRpb247CiAgICAgIGNvbnN0IHIxID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24xOwogICAgICBjb25zdCByMiA9IHRoaXMucm90YXRpb25hbEVxdWF0aW9uMjsKICAgICAgY29uc3QgcjMgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjM7CiAgICAgIHN1cGVyLnVwZGF0ZSgpOyAvLyBUaGVzZSB2ZWN0b3IgcGFpcnMgbXVzdCBiZSBvcnRob2dvbmFsCgogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy54QSwgcjEuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy55QiwgcjEuYXhpc0IpOwogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy55QSwgcjIuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy56QiwgcjIuYXhpc0IpOwogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy56QSwgcjMuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy54QiwgcjMuYXhpc0IpOwogICAgfQoKICB9CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwoKICAvKioKICAgKiBSb3RhdGlvbmFsIG1vdG9yIGNvbnN0cmFpbnQuIFRyaWVzIHRvIGtlZXAgdGhlIHJlbGF0aXZlIGFuZ3VsYXIgdmVsb2NpdHkgb2YgdGhlIGJvZGllcyB0byBhIGdpdmVuIHZhbHVlLgogICAqLwogIGNsYXNzIFJvdGF0aW9uYWxNb3RvckVxdWF0aW9uIGV4dGVuZHMgRXF1YXRpb24gewogICAgLyoqCiAgICAgKiBXb3JsZCBvcmllbnRlZCByb3RhdGlvbmFsIGF4aXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdvcmxkIG9yaWVudGVkIHJvdGF0aW9uYWwgYXhpcy4KICAgICAqLwoKICAgIC8qKgogICAgICogTW90b3IgdmVsb2NpdHkuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5QiwgbWF4Rm9yY2UpIHsKICAgICAgaWYgKG1heEZvcmNlID09PSB2b2lkIDApIHsKICAgICAgICBtYXhGb3JjZSA9IDFlNjsKICAgICAgfQoKICAgICAgc3VwZXIoYm9keUEsIGJvZHlCLCAtbWF4Rm9yY2UsIG1heEZvcmNlKTsKICAgICAgdGhpcy5heGlzQSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuYXhpc0IgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnRhcmdldFZlbG9jaXR5ID0gMDsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIHRoaXMuYTsKICAgICAgY29uc3QgYiA9IHRoaXMuYjsKICAgICAgdGhpcy5iaTsKICAgICAgdGhpcy5iajsKICAgICAgY29uc3QgYXhpc0EgPSB0aGlzLmF4aXNBOwogICAgICBjb25zdCBheGlzQiA9IHRoaXMuYXhpc0I7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gZyA9IDAKICAgICAgLy8gZ2RvdCA9IGF4aXNBICogd2kgLSBheGlzQiAqIHdqCiAgICAgIC8vIGdkb3QgPSBHICogVyA9IEcgKiBbdmkgd2kgdmogd2pdCiAgICAgIC8vID0+CiAgICAgIC8vIEcgPSBbMCBheGlzQSAwIC1heGlzQl0KCiAgICAgIEdBLnJvdGF0aW9uYWwuY29weShheGlzQSk7CiAgICAgIGF4aXNCLm5lZ2F0ZShHQi5yb3RhdGlvbmFsKTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpIC0gdGhpcy50YXJnZXRWZWxvY2l0eTsKICAgICAgY29uc3QgR2lNZiA9IHRoaXMuY29tcHV0ZUdpTWYoKTsKICAgICAgY29uc3QgQiA9IC1HVyAqIGIgLSBoICogR2lNZjsKICAgICAgcmV0dXJuIEI7CiAgICB9CgogIH0KCiAgLyoqCiAgICogSGluZ2UgY29uc3RyYWludC4gVGhpbmsgb2YgaXQgYXMgYSBkb29yIGhpbmdlLiBJdCB0cmllcyB0byBrZWVwIHRoZSBkb29yIGluIHRoZSBjb3JyZWN0IHBsYWNlIGFuZCB3aXRoIHRoZSBjb3JyZWN0IG9yaWVudGF0aW9uLgogICAqLwogIGNsYXNzIEhpbmdlQ29uc3RyYWludCBleHRlbmRzIFBvaW50VG9Qb2ludENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBSb3RhdGlvbiBheGlzLCBkZWZpbmVkIGxvY2FsbHkgaW4gYm9keUEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFJvdGF0aW9uIGF4aXMsIGRlZmluZWQgbG9jYWxseSBpbiBib2R5Qi4KICAgICAqLwogICAgY29uc3RydWN0b3IoYm9keUEsIGJvZHlCLCBvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIGNvbnN0IG1heEZvcmNlID0gdHlwZW9mIG9wdGlvbnMubWF4Rm9yY2UgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5tYXhGb3JjZSA6IDFlNjsKICAgICAgY29uc3QgcGl2b3RBID0gb3B0aW9ucy5waXZvdEEgPyBvcHRpb25zLnBpdm90QS5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGl2b3RCID0gb3B0aW9ucy5waXZvdEIgPyBvcHRpb25zLnBpdm90Qi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOwogICAgICBjb25zdCBheGlzQSA9IHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIGF4aXNBLm5vcm1hbGl6ZSgpOwogICAgICBjb25zdCBheGlzQiA9IHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIGF4aXNCLm5vcm1hbGl6ZSgpOwogICAgICB0aGlzLmNvbGxpZGVDb25uZWN0ZWQgPSAhIW9wdGlvbnMuY29sbGlkZUNvbm5lY3RlZDsKICAgICAgY29uc3Qgcm90YXRpb25hbDEgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjEgPSBuZXcgUm90YXRpb25hbEVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIGNvbnN0IHJvdGF0aW9uYWwyID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24yID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICBjb25zdCBtb3RvciA9IHRoaXMubW90b3JFcXVhdGlvbiA9IG5ldyBSb3RhdGlvbmFsTW90b3JFcXVhdGlvbihib2R5QSwgYm9keUIsIG1heEZvcmNlKTsKICAgICAgbW90b3IuZW5hYmxlZCA9IGZhbHNlOyAvLyBOb3QgZW5hYmxlZCBieSBkZWZhdWx0CiAgICAgIC8vIEVxdWF0aW9ucyB0byBiZSBmZWQgdG8gdGhlIHNvbHZlcgoKICAgICAgdGhpcy5lcXVhdGlvbnMucHVzaChyb3RhdGlvbmFsMSwgcm90YXRpb25hbDIsIG1vdG9yKTsKICAgIH0KICAgIC8qKgogICAgICogZW5hYmxlTW90b3IKICAgICAqLwoKCiAgICBlbmFibGVNb3RvcigpIHsKICAgICAgdGhpcy5tb3RvckVxdWF0aW9uLmVuYWJsZWQgPSB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBkaXNhYmxlTW90b3IKICAgICAqLwoKCiAgICBkaXNhYmxlTW90b3IoKSB7CiAgICAgIHRoaXMubW90b3JFcXVhdGlvbi5lbmFibGVkID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIHNldE1vdG9yU3BlZWQKICAgICAqLwoKCiAgICBzZXRNb3RvclNwZWVkKHNwZWVkKSB7CiAgICAgIHRoaXMubW90b3JFcXVhdGlvbi50YXJnZXRWZWxvY2l0eSA9IHNwZWVkOwogICAgfQogICAgLyoqCiAgICAgKiBzZXRNb3Rvck1heEZvcmNlCiAgICAgKi8KCgogICAgc2V0TW90b3JNYXhGb3JjZShtYXhGb3JjZSkgewogICAgICB0aGlzLm1vdG9yRXF1YXRpb24ubWF4Rm9yY2UgPSBtYXhGb3JjZTsKICAgICAgdGhpcy5tb3RvckVxdWF0aW9uLm1pbkZvcmNlID0gLW1heEZvcmNlOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICBjb25zdCBtb3RvciA9IHRoaXMubW90b3JFcXVhdGlvbjsKICAgICAgY29uc3QgcjEgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjE7CiAgICAgIGNvbnN0IHIyID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24yOwogICAgICBjb25zdCB3b3JsZEF4aXNBID0gSGluZ2VDb25zdHJhaW50X3VwZGF0ZV90bXBWZWMxOwogICAgICBjb25zdCB3b3JsZEF4aXNCID0gSGluZ2VDb25zdHJhaW50X3VwZGF0ZV90bXBWZWMyOwogICAgICBjb25zdCBheGlzQSA9IHRoaXMuYXhpc0E7CiAgICAgIGNvbnN0IGF4aXNCID0gdGhpcy5heGlzQjsKICAgICAgc3VwZXIudXBkYXRlKCk7IC8vIEdldCB3b3JsZCBheGVzCgogICAgICBib2R5QS5xdWF0ZXJuaW9uLnZtdWx0KGF4aXNBLCB3b3JsZEF4aXNBKTsKICAgICAgYm9keUIucXVhdGVybmlvbi52bXVsdChheGlzQiwgd29ybGRBeGlzQik7CiAgICAgIHdvcmxkQXhpc0EudGFuZ2VudHMocjEuYXhpc0EsIHIyLmF4aXNBKTsKICAgICAgcjEuYXhpc0IuY29weSh3b3JsZEF4aXNCKTsKICAgICAgcjIuYXhpc0IuY29weSh3b3JsZEF4aXNCKTsKCiAgICAgIGlmICh0aGlzLm1vdG9yRXF1YXRpb24uZW5hYmxlZCkgewogICAgICAgIGJvZHlBLnF1YXRlcm5pb24udm11bHQodGhpcy5heGlzQSwgbW90b3IuYXhpc0EpOwogICAgICAgIGJvZHlCLnF1YXRlcm5pb24udm11bHQodGhpcy5heGlzQiwgbW90b3IuYXhpc0IpOwogICAgICB9CiAgICB9CgogIH0KICBjb25zdCBIaW5nZUNvbnN0cmFpbnRfdXBkYXRlX3RtcFZlYzEgPSBuZXcgVmVjMygpOwogIGNvbnN0IEhpbmdlQ29uc3RyYWludF91cGRhdGVfdG1wVmVjMiA9IG5ldyBWZWMzKCk7CgogIC8qKgogICAqIENvbnN0cmFpbnMgdGhlIHNsaXBwaW5nIGluIGEgY29udGFjdCBhbG9uZyBhIHRhbmdlbnQKICAgKi8KICBjbGFzcyBGcmljdGlvbkVxdWF0aW9uIGV4dGVuZHMgRXF1YXRpb24gewogICAgLy8gVGFuZ2VudAoKICAgIC8qKgogICAgICogQHBhcmFtIHNsaXBGb3JjZSBzaG91bGQgYmUgKy1GX2ZyaWN0aW9uID0gKy1tdSAqIEZfbm9ybWFsID0gKy1tdSAqIG0gKiBnCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgc2xpcEZvcmNlKSB7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLXNsaXBGb3JjZSwgc2xpcEZvcmNlKTsKICAgICAgdGhpcy5yaSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucmogPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnQgPSBuZXcgVmVjMygpOwogICAgfQoKICAgIGNvbXB1dGVCKGgpIHsKICAgICAgdGhpcy5hOwogICAgICBjb25zdCBiID0gdGhpcy5iOwogICAgICB0aGlzLmJpOwogICAgICB0aGlzLmJqOwogICAgICBjb25zdCByaSA9IHRoaXMucmk7CiAgICAgIGNvbnN0IHJqID0gdGhpcy5yajsKICAgICAgY29uc3Qgcml4dCA9IEZyaWN0aW9uRXF1YXRpb25fY29tcHV0ZUJfdGVtcDE7CiAgICAgIGNvbnN0IHJqeHQgPSBGcmljdGlvbkVxdWF0aW9uX2NvbXB1dGVCX3RlbXAyOwogICAgICBjb25zdCB0ID0gdGhpcy50OyAvLyBDYWx1Y2xhdGUgY3Jvc3MgcHJvZHVjdHMKCiAgICAgIHJpLmNyb3NzKHQsIHJpeHQpOwogICAgICByai5jcm9zcyh0LCByanh0KTsgLy8gRyA9IFstdCAtcml4dCB0IHJqeHRdCiAgICAgIC8vIEFuZCByZW1lbWJlciwgdGhpcyBpcyBhIHB1cmUgdmVsb2NpdHkgY29uc3RyYWludCwgZyBpcyBhbHdheXMgemVybyEKCiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgdC5uZWdhdGUoR0Euc3BhdGlhbCk7CiAgICAgIHJpeHQubmVnYXRlKEdBLnJvdGF0aW9uYWwpOwogICAgICBHQi5zcGF0aWFsLmNvcHkodCk7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShyanh0KTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLUdXICogYiAtIGggKiBHaU1mOwogICAgICByZXR1cm4gQjsKICAgIH0KCiAgfQogIGNvbnN0IEZyaWN0aW9uRXF1YXRpb25fY29tcHV0ZUJfdGVtcDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IEZyaWN0aW9uRXF1YXRpb25fY29tcHV0ZUJfdGVtcDIgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBEZWZpbmVzIHdoYXQgaGFwcGVucyB3aGVuIHR3byBtYXRlcmlhbHMgbWVldC4KICAgKiBAdG9kbyBSZWZhY3RvciBtYXRlcmlhbHMgdG8gbWF0ZXJpYWxBIGFuZCBtYXRlcmlhbEIKICAgKi8KICBjbGFzcyBDb250YWN0TWF0ZXJpYWwgewogICAgLyoqCiAgICAgKiBJZGVudGlmaWVyIG9mIHRoaXMgbWF0ZXJpYWwuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFBhcnRpY2lwYXRpbmcgbWF0ZXJpYWxzLgogICAgICovCgogICAgLyoqCiAgICAgKiBGcmljdGlvbiBjb2VmZmljaWVudC4KICAgICAqIEBkZWZhdWx0IDAuMwogICAgICovCgogICAgLyoqCiAgICAgKiBSZXN0aXR1dGlvbiBjb2VmZmljaWVudC4KICAgICAqIEBkZWZhdWx0IDAuMwogICAgICovCgogICAgLyoqCiAgICAgKiBTdGlmZm5lc3Mgb2YgdGhlIHByb2R1Y2VkIGNvbnRhY3QgZXF1YXRpb25zLgogICAgICogQGRlZmF1bHQgMWU3CiAgICAgKi8KCiAgICAvKioKICAgICAqIFJlbGF4YXRpb24gdGltZSBvZiB0aGUgcHJvZHVjZWQgY29udGFjdCBlcXVhdGlvbnMuCiAgICAgKiBAZGVmYXVsdCAzCiAgICAgKi8KCiAgICAvKioKICAgICAqIFN0aWZmbmVzcyBvZiB0aGUgcHJvZHVjZWQgZnJpY3Rpb24gZXF1YXRpb25zLgogICAgICogQGRlZmF1bHQgMWU3CiAgICAgKi8KCiAgICAvKioKICAgICAqIFJlbGF4YXRpb24gdGltZSBvZiB0aGUgcHJvZHVjZWQgZnJpY3Rpb24gZXF1YXRpb25zCiAgICAgKiBAZGVmYXVsdCAzCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG0xLCBtMiwgb3B0aW9ucykgewogICAgICBvcHRpb25zID0gVXRpbHMuZGVmYXVsdHMob3B0aW9ucywgewogICAgICAgIGZyaWN0aW9uOiAwLjMsCiAgICAgICAgcmVzdGl0dXRpb246IDAuMywKICAgICAgICBjb250YWN0RXF1YXRpb25TdGlmZm5lc3M6IDFlNywKICAgICAgICBjb250YWN0RXF1YXRpb25SZWxheGF0aW9uOiAzLAogICAgICAgIGZyaWN0aW9uRXF1YXRpb25TdGlmZm5lc3M6IDFlNywKICAgICAgICBmcmljdGlvbkVxdWF0aW9uUmVsYXhhdGlvbjogMwogICAgICB9KTsKICAgICAgdGhpcy5pZCA9IENvbnRhY3RNYXRlcmlhbC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5tYXRlcmlhbHMgPSBbbTEsIG0yXTsKICAgICAgdGhpcy5mcmljdGlvbiA9IG9wdGlvbnMuZnJpY3Rpb247CiAgICAgIHRoaXMucmVzdGl0dXRpb24gPSBvcHRpb25zLnJlc3RpdHV0aW9uOwogICAgICB0aGlzLmNvbnRhY3RFcXVhdGlvblN0aWZmbmVzcyA9IG9wdGlvbnMuY29udGFjdEVxdWF0aW9uU3RpZmZuZXNzOwogICAgICB0aGlzLmNvbnRhY3RFcXVhdGlvblJlbGF4YXRpb24gPSBvcHRpb25zLmNvbnRhY3RFcXVhdGlvblJlbGF4YXRpb247CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcyA9IG9wdGlvbnMuZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzczsKICAgICAgdGhpcy5mcmljdGlvbkVxdWF0aW9uUmVsYXhhdGlvbiA9IG9wdGlvbnMuZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb247CiAgICB9CgogIH0KICBDb250YWN0TWF0ZXJpYWwuaWRDb3VudGVyID0gMDsKCiAgLyoqCiAgICogRGVmaW5lcyBhIHBoeXNpY3MgbWF0ZXJpYWwuCiAgICovCiAgY2xhc3MgTWF0ZXJpYWwgewogICAgLyoqCiAgICAgKiBNYXRlcmlhbCBuYW1lLgogICAgICogSWYgb3B0aW9ucyBpcyBhIHN0cmluZywgbmFtZSB3aWxsIGJlIHNldCB0byB0aGF0IHN0cmluZy4KICAgICAqIEB0b2RvIERlcHJlY2F0ZSB0aGlzCiAgICAgKi8KCiAgICAvKiogTWF0ZXJpYWwgaWQuICovCgogICAgLyoqCiAgICAgKiBGcmljdGlvbiBmb3IgdGhpcyBtYXRlcmlhbC4KICAgICAqIElmIG5vbi1uZWdhdGl2ZSwgaXQgd2lsbCBiZSB1c2VkIGluc3RlYWQgb2YgdGhlIGZyaWN0aW9uIGdpdmVuIGJ5IENvbnRhY3RNYXRlcmlhbHMuIElmIHRoZXJlJ3Mgbm8gbWF0Y2hpbmcgQ29udGFjdE1hdGVyaWFsLCB0aGUgdmFsdWUgZnJvbSBgZGVmYXVsdENvbnRhY3RNYXRlcmlhbGAgaW4gdGhlIFdvcmxkIHdpbGwgYmUgdXNlZC4KICAgICAqLwoKICAgIC8qKgogICAgICogUmVzdGl0dXRpb24gZm9yIHRoaXMgbWF0ZXJpYWwuCiAgICAgKiBJZiBub24tbmVnYXRpdmUsIGl0IHdpbGwgYmUgdXNlZCBpbnN0ZWFkIG9mIHRoZSByZXN0aXR1dGlvbiBnaXZlbiBieSBDb250YWN0TWF0ZXJpYWxzLiBJZiB0aGVyZSdzIG5vIG1hdGNoaW5nIENvbnRhY3RNYXRlcmlhbCwgdGhlIHZhbHVlIGZyb20gYGRlZmF1bHRDb250YWN0TWF0ZXJpYWxgIGluIHRoZSBXb3JsZCB3aWxsIGJlIHVzZWQuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgfQoKICAgICAgbGV0IG5hbWUgPSAnJzsgLy8gQmFja3dhcmRzIGNvbXBhdGliaWxpdHkgZml4CgogICAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgLy9jb25zb2xlLndhcm4oYFBhc3NpbmcgYSBzdHJpbmcgdG8gTWF0ZXJpYWxPcHRpb25zIGlzIGRlcHJlY2F0ZWQsIGFuZCBoYXMgbm8gZWZmZWN0YCkKICAgICAgICBuYW1lID0gb3B0aW9uczsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIHRoaXMubmFtZSA9IG5hbWU7CiAgICAgIHRoaXMuaWQgPSBNYXRlcmlhbC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5mcmljdGlvbiA9IHR5cGVvZiBvcHRpb25zLmZyaWN0aW9uICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuZnJpY3Rpb24gOiAtMTsKICAgICAgdGhpcy5yZXN0aXR1dGlvbiA9IHR5cGVvZiBvcHRpb25zLnJlc3RpdHV0aW9uICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMucmVzdGl0dXRpb24gOiAtMTsKICAgIH0KCiAgfQogIE1hdGVyaWFsLmlkQ291bnRlciA9IDA7CgogIC8qKgogICAqIEEgc3ByaW5nLCBjb25uZWN0aW5nIHR3byBib2RpZXMuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3Qgc3ByaW5nID0gbmV3IFNwcmluZyhib3hCb2R5LCBzcGhlcmVCb2R5LCB7CiAgICogICAgICAgcmVzdExlbmd0aDogMCwKICAgKiAgICAgICBzdGlmZm5lc3M6IDUwLAogICAqICAgICAgIGRhbXBpbmc6IDEsCiAgICogICAgIH0pCiAgICoKICAgKiAgICAgLy8gQ29tcHV0ZSB0aGUgZm9yY2UgYWZ0ZXIgZWFjaCBzdGVwCiAgICogICAgIHdvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgKGV2ZW50KSA9PiB7CiAgICogICAgICAgc3ByaW5nLmFwcGx5Rm9yY2UoKQogICAqICAgICB9KQogICAqLwogIGNsYXNzIFNwcmluZyB7CiAgICAvKioKICAgICAqIFJlc3QgbGVuZ3RoIG9mIHRoZSBzcHJpbmcuIEEgbnVtYmVyID4gMC4KICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogU3RpZmZuZXNzIG9mIHRoZSBzcHJpbmcuIEEgbnVtYmVyID49IDAuCiAgICAgKiBAZGVmYXVsdCAxMDAKICAgICAqLwoKICAgIC8qKgogICAgICogRGFtcGluZyBvZiB0aGUgc3ByaW5nLiBBIG51bWJlciA+PSAwLgogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBGaXJzdCBjb25uZWN0ZWQgYm9keS4KICAgICAqLwoKICAgIC8qKgogICAgICogU2Vjb25kIGNvbm5lY3RlZCBib2R5LgogICAgICovCgogICAgLyoqCiAgICAgKiBBbmNob3IgZm9yIGJvZHlBIGluIGxvY2FsIGJvZHlBIGNvb3JkaW5hdGVzLgogICAgICogV2hlcmUgdG8gaG9vayB0aGUgc3ByaW5nIHRvIGJvZHkgQSwgaW4gbG9jYWwgYm9keSBjb29yZGluYXRlcy4KICAgICAqIEBkZWZhdWx0IG5ldyBWZWMzKCkKICAgICAqLwoKICAgIC8qKgogICAgICogQW5jaG9yIGZvciBib2R5QiBpbiBsb2NhbCBib2R5QiBjb29yZGluYXRlcy4KICAgICAqIFdoZXJlIHRvIGhvb2sgdGhlIHNwcmluZyB0byBib2R5IEIsIGluIGxvY2FsIGJvZHkgY29vcmRpbmF0ZXMuCiAgICAgKiBAZGVmYXVsdCBuZXcgVmVjMygpCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICB0aGlzLnJlc3RMZW5ndGggPSB0eXBlb2Ygb3B0aW9ucy5yZXN0TGVuZ3RoID09PSAnbnVtYmVyJyA/IG9wdGlvbnMucmVzdExlbmd0aCA6IDE7CiAgICAgIHRoaXMuc3RpZmZuZXNzID0gb3B0aW9ucy5zdGlmZm5lc3MgfHwgMTAwOwogICAgICB0aGlzLmRhbXBpbmcgPSBvcHRpb25zLmRhbXBpbmcgfHwgMTsKICAgICAgdGhpcy5ib2R5QSA9IGJvZHlBOwogICAgICB0aGlzLmJvZHlCID0gYm9keUI7CiAgICAgIHRoaXMubG9jYWxBbmNob3JBID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5sb2NhbEFuY2hvckIgPSBuZXcgVmVjMygpOwoKICAgICAgaWYgKG9wdGlvbnMubG9jYWxBbmNob3JBKSB7CiAgICAgICAgdGhpcy5sb2NhbEFuY2hvckEuY29weShvcHRpb25zLmxvY2FsQW5jaG9yQSk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLmxvY2FsQW5jaG9yQikgewogICAgICAgIHRoaXMubG9jYWxBbmNob3JCLmNvcHkob3B0aW9ucy5sb2NhbEFuY2hvckIpOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy53b3JsZEFuY2hvckEpIHsKICAgICAgICB0aGlzLnNldFdvcmxkQW5jaG9yQShvcHRpb25zLndvcmxkQW5jaG9yQSk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLndvcmxkQW5jaG9yQikgewogICAgICAgIHRoaXMuc2V0V29ybGRBbmNob3JCKG9wdGlvbnMud29ybGRBbmNob3JCKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIGFuY2hvciBwb2ludCBvbiBib2R5IEEsIHVzaW5nIHdvcmxkIGNvb3JkaW5hdGVzLgogICAgICovCgoKICAgIHNldFdvcmxkQW5jaG9yQSh3b3JsZEFuY2hvckEpIHsKICAgICAgdGhpcy5ib2R5QS5wb2ludFRvTG9jYWxGcmFtZSh3b3JsZEFuY2hvckEsIHRoaXMubG9jYWxBbmNob3JBKTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBhbmNob3IgcG9pbnQgb24gYm9keSBCLCB1c2luZyB3b3JsZCBjb29yZGluYXRlcy4KICAgICAqLwoKCiAgICBzZXRXb3JsZEFuY2hvckIod29ybGRBbmNob3JCKSB7CiAgICAgIHRoaXMuYm9keUIucG9pbnRUb0xvY2FsRnJhbWUod29ybGRBbmNob3JCLCB0aGlzLmxvY2FsQW5jaG9yQik7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgYW5jaG9yIHBvaW50IG9uIGJvZHkgQSwgaW4gd29ybGQgY29vcmRpbmF0ZXMuCiAgICAgKiBAcGFyYW0gcmVzdWx0IFRoZSB2ZWN0b3IgdG8gc3RvcmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBnZXRXb3JsZEFuY2hvckEocmVzdWx0KSB7CiAgICAgIHRoaXMuYm9keUEucG9pbnRUb1dvcmxkRnJhbWUodGhpcy5sb2NhbEFuY2hvckEsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgYW5jaG9yIHBvaW50IG9uIGJvZHkgQiwgaW4gd29ybGQgY29vcmRpbmF0ZXMuCiAgICAgKiBAcGFyYW0gcmVzdWx0IFRoZSB2ZWN0b3IgdG8gc3RvcmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBnZXRXb3JsZEFuY2hvckIocmVzdWx0KSB7CiAgICAgIHRoaXMuYm9keUIucG9pbnRUb1dvcmxkRnJhbWUodGhpcy5sb2NhbEFuY2hvckIsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IHRoZSBzcHJpbmcgZm9yY2UgdG8gdGhlIGNvbm5lY3RlZCBib2RpZXMuCiAgICAgKi8KCgogICAgYXBwbHlGb3JjZSgpIHsKICAgICAgY29uc3QgayA9IHRoaXMuc3RpZmZuZXNzOwogICAgICBjb25zdCBkID0gdGhpcy5kYW1waW5nOwogICAgICBjb25zdCBsID0gdGhpcy5yZXN0TGVuZ3RoOwogICAgICBjb25zdCBib2R5QSA9IHRoaXMuYm9keUE7CiAgICAgIGNvbnN0IGJvZHlCID0gdGhpcy5ib2R5QjsKICAgICAgY29uc3QgciA9IGFwcGx5Rm9yY2VfcjsKICAgICAgY29uc3Qgcl91bml0ID0gYXBwbHlGb3JjZV9yX3VuaXQ7CiAgICAgIGNvbnN0IHUgPSBhcHBseUZvcmNlX3U7CiAgICAgIGNvbnN0IGYgPSBhcHBseUZvcmNlX2Y7CiAgICAgIGNvbnN0IHRtcCA9IGFwcGx5Rm9yY2VfdG1wOwogICAgICBjb25zdCB3b3JsZEFuY2hvckEgPSBhcHBseUZvcmNlX3dvcmxkQW5jaG9yQTsKICAgICAgY29uc3Qgd29ybGRBbmNob3JCID0gYXBwbHlGb3JjZV93b3JsZEFuY2hvckI7CiAgICAgIGNvbnN0IHJpID0gYXBwbHlGb3JjZV9yaTsKICAgICAgY29uc3QgcmogPSBhcHBseUZvcmNlX3JqOwogICAgICBjb25zdCByaV94X2YgPSBhcHBseUZvcmNlX3JpX3hfZjsKICAgICAgY29uc3QgcmpfeF9mID0gYXBwbHlGb3JjZV9yal94X2Y7IC8vIEdldCB3b3JsZCBhbmNob3JzCgogICAgICB0aGlzLmdldFdvcmxkQW5jaG9yQSh3b3JsZEFuY2hvckEpOwogICAgICB0aGlzLmdldFdvcmxkQW5jaG9yQih3b3JsZEFuY2hvckIpOyAvLyBHZXQgb2Zmc2V0IHBvaW50cwoKICAgICAgd29ybGRBbmNob3JBLnZzdWIoYm9keUEucG9zaXRpb24sIHJpKTsKICAgICAgd29ybGRBbmNob3JCLnZzdWIoYm9keUIucG9zaXRpb24sIHJqKTsgLy8gQ29tcHV0ZSBkaXN0YW5jZSB2ZWN0b3IgYmV0d2VlbiB3b3JsZCBhbmNob3IgcG9pbnRzCgogICAgICB3b3JsZEFuY2hvckIudnN1Yih3b3JsZEFuY2hvckEsIHIpOwogICAgICBjb25zdCBybGVuID0gci5sZW5ndGgoKTsKICAgICAgcl91bml0LmNvcHkocik7CiAgICAgIHJfdW5pdC5ub3JtYWxpemUoKTsgLy8gQ29tcHV0ZSByZWxhdGl2ZSB2ZWxvY2l0eSBvZiB0aGUgYW5jaG9yIHBvaW50cywgdQoKICAgICAgYm9keUIudmVsb2NpdHkudnN1Yihib2R5QS52ZWxvY2l0eSwgdSk7IC8vIEFkZCByb3RhdGlvbmFsIHZlbG9jaXR5CgogICAgICBib2R5Qi5hbmd1bGFyVmVsb2NpdHkuY3Jvc3MocmosIHRtcCk7CiAgICAgIHUudmFkZCh0bXAsIHUpOwogICAgICBib2R5QS5hbmd1bGFyVmVsb2NpdHkuY3Jvc3MocmksIHRtcCk7CiAgICAgIHUudnN1Yih0bXAsIHUpOyAvLyBGID0gLSBrICogKCB4IC0gTCApIC0gRCAqICggdSApCgogICAgICByX3VuaXQuc2NhbGUoLWsgKiAocmxlbiAtIGwpIC0gZCAqIHUuZG90KHJfdW5pdCksIGYpOyAvLyBBZGQgZm9yY2VzIHRvIGJvZGllcwoKICAgICAgYm9keUEuZm9yY2UudnN1YihmLCBib2R5QS5mb3JjZSk7CiAgICAgIGJvZHlCLmZvcmNlLnZhZGQoZiwgYm9keUIuZm9yY2UpOyAvLyBBbmd1bGFyIGZvcmNlCgogICAgICByaS5jcm9zcyhmLCByaV94X2YpOwogICAgICByai5jcm9zcyhmLCByal94X2YpOwogICAgICBib2R5QS50b3JxdWUudnN1YihyaV94X2YsIGJvZHlBLnRvcnF1ZSk7CiAgICAgIGJvZHlCLnRvcnF1ZS52YWRkKHJqX3hfZiwgYm9keUIudG9ycXVlKTsKICAgIH0KCiAgfQogIGNvbnN0IGFwcGx5Rm9yY2VfciA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV9yX3VuaXQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfdSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV9mID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX3dvcmxkQW5jaG9yQSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV93b3JsZEFuY2hvckIgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfcmkgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfcmogPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfcmlfeF9mID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX3JqX3hfZiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV90bXAgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBXaGVlbEluZm8KICAgKi8KICBjbGFzcyBXaGVlbEluZm8gewogICAgLyoqCiAgICAgKiBNYXggdHJhdmVsIGRpc3RhbmNlIG9mIHRoZSBzdXNwZW5zaW9uLCBpbiBtZXRlcnMuCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNwZWVkIHRvIGFwcGx5IHRvIHRoZSB3aGVlbCByb3RhdGlvbiB3aGVuIHRoZSB3aGVlbCBpcyBzbGlkaW5nLgogICAgICogQGRlZmF1bHQgLTAuMQogICAgICovCgogICAgLyoqCiAgICAgKiBJZiB0aGUgY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZCBzaG91bGQgYmUgdXNlZC4KICAgICAqIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIHNsaWRpbmcKICAgICAqLwoKICAgIC8qKgogICAgICogQ29ubmVjdGlvbiBwb2ludCwgZGVmaW5lZCBsb2NhbGx5IGluIHRoZSBjaGFzc2lzIGJvZHkgZnJhbWUuCiAgICAgKi8KCiAgICAvKioKICAgICAqIGNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiBkaXJlY3Rpb25Mb2NhbAogICAgICovCgogICAgLyoqCiAgICAgKiBkaXJlY3Rpb25Xb3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiBheGxlTG9jYWwKICAgICAqLwoKICAgIC8qKgogICAgICogYXhsZVdvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25SZXN0TGVuZ3RoCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25NYXhMZW5ndGgKICAgICAqIEBkZWZhdWx0IDIKICAgICAqLwoKICAgIC8qKgogICAgICogcmFkaXVzCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25TdGlmZm5lc3MKICAgICAqIEBkZWZhdWx0IDEwMAogICAgICovCgogICAgLyoqCiAgICAgKiBkYW1waW5nQ29tcHJlc3Npb24KICAgICAqIEBkZWZhdWx0IDEwCiAgICAgKi8KCiAgICAvKioKICAgICAqIGRhbXBpbmdSZWxheGF0aW9uCiAgICAgKiBAZGVmYXVsdCAxMAogICAgICovCgogICAgLyoqCiAgICAgKiBmcmljdGlvblNsaXAKICAgICAqIEBkZWZhdWx0IDEwLjUKICAgICAqLwoKICAgIC8qKiBmb3J3YXJkQWNjZWxlcmF0aW9uICovCgogICAgLyoqIHNpZGVBY2NlbGVyYXRpb24gKi8KCiAgICAvKioKICAgICAqIHN0ZWVyaW5nCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIFJvdGF0aW9uIHZhbHVlLCBpbiByYWRpYW5zLgogICAgICogQGRlZmF1bHQgMAogICAgICovCgogICAgLyoqCiAgICAgKiBkZWx0YVJvdGF0aW9uCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIHJvbGxJbmZsdWVuY2UKICAgICAqIEBkZWZhdWx0IDAuMDEKICAgICAqLwoKICAgIC8qKgogICAgICogbWF4U3VzcGVuc2lvbkZvcmNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGVuZ2luZUZvcmNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGJyYWtlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGlzRnJvbnRXaGVlbAogICAgICogQGRlZmF1bHQgdHJ1ZQogICAgICovCgogICAgLyoqCiAgICAgKiBjbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24KICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkKICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvbkZvcmNlCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIHNsaXBJbmZvCiAgICAgKi8KCiAgICAvKioKICAgICAqIHNraWRJbmZvCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIHN1c3BlbnNpb25MZW5ndGgKICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogc2lkZUltcHVsc2UKICAgICAqLwoKICAgIC8qKgogICAgICogZm9yd2FyZEltcHVsc2UKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHJlc3VsdCBmcm9tIHJheWNhc3RpbmcuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZWVsIHdvcmxkIHRyYW5zZm9ybS4KICAgICAqLwoKICAgIC8qKgogICAgICogaXNJbkNvbnRhY3QKICAgICAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBvcHRpb25zID0gVXRpbHMuZGVmYXVsdHMob3B0aW9ucywgewogICAgICAgIGNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbDogbmV3IFZlYzMoKSwKICAgICAgICBjaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQ6IG5ldyBWZWMzKCksCiAgICAgICAgZGlyZWN0aW9uTG9jYWw6IG5ldyBWZWMzKCksCiAgICAgICAgZGlyZWN0aW9uV29ybGQ6IG5ldyBWZWMzKCksCiAgICAgICAgYXhsZUxvY2FsOiBuZXcgVmVjMygpLAogICAgICAgIGF4bGVXb3JsZDogbmV3IFZlYzMoKSwKICAgICAgICBzdXNwZW5zaW9uUmVzdExlbmd0aDogMSwKICAgICAgICBzdXNwZW5zaW9uTWF4TGVuZ3RoOiAyLAogICAgICAgIHJhZGl1czogMSwKICAgICAgICBzdXNwZW5zaW9uU3RpZmZuZXNzOiAxMDAsCiAgICAgICAgZGFtcGluZ0NvbXByZXNzaW9uOiAxMCwKICAgICAgICBkYW1waW5nUmVsYXhhdGlvbjogMTAsCiAgICAgICAgZnJpY3Rpb25TbGlwOiAxMC41LAogICAgICAgIGZvcndhcmRBY2NlbGVyYXRpb246IDEsCiAgICAgICAgc2lkZUFjY2VsZXJhdGlvbjogMSwKICAgICAgICBzdGVlcmluZzogMCwKICAgICAgICByb3RhdGlvbjogMCwKICAgICAgICBkZWx0YVJvdGF0aW9uOiAwLAogICAgICAgIHJvbGxJbmZsdWVuY2U6IDAuMDEsCiAgICAgICAgbWF4U3VzcGVuc2lvbkZvcmNlOiBOdW1iZXIuTUFYX1ZBTFVFLAogICAgICAgIGlzRnJvbnRXaGVlbDogdHJ1ZSwKICAgICAgICBjbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb246IDEsCiAgICAgICAgc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHk6IDAsCiAgICAgICAgc3VzcGVuc2lvbkZvcmNlOiAwLAogICAgICAgIHNsaXBJbmZvOiAwLAogICAgICAgIHNraWRJbmZvOiAwLAogICAgICAgIHN1c3BlbnNpb25MZW5ndGg6IDAsCiAgICAgICAgbWF4U3VzcGVuc2lvblRyYXZlbDogMSwKICAgICAgICB1c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOiBmYWxzZSwKICAgICAgICBjdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOiAtMC4xCiAgICAgIH0pOwogICAgICB0aGlzLm1heFN1c3BlbnNpb25UcmF2ZWwgPSBvcHRpb25zLm1heFN1c3BlbnNpb25UcmF2ZWw7CiAgICAgIHRoaXMuY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZCA9IG9wdGlvbnMuY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZDsKICAgICAgdGhpcy51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkID0gb3B0aW9ucy51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOwogICAgICB0aGlzLnNsaWRpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5jaGFzc2lzQ29ubmVjdGlvblBvaW50TG9jYWwgPSBvcHRpb25zLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbC5jbG9uZSgpOwogICAgICB0aGlzLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZCA9IG9wdGlvbnMuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uTG9jYWwgPSBvcHRpb25zLmRpcmVjdGlvbkxvY2FsLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uV29ybGQgPSBvcHRpb25zLmRpcmVjdGlvbldvcmxkLmNsb25lKCk7CiAgICAgIHRoaXMuYXhsZUxvY2FsID0gb3B0aW9ucy5heGxlTG9jYWwuY2xvbmUoKTsKICAgICAgdGhpcy5heGxlV29ybGQgPSBvcHRpb25zLmF4bGVXb3JsZC5jbG9uZSgpOwogICAgICB0aGlzLnN1c3BlbnNpb25SZXN0TGVuZ3RoID0gb3B0aW9ucy5zdXNwZW5zaW9uUmVzdExlbmd0aDsKICAgICAgdGhpcy5zdXNwZW5zaW9uTWF4TGVuZ3RoID0gb3B0aW9ucy5zdXNwZW5zaW9uTWF4TGVuZ3RoOwogICAgICB0aGlzLnJhZGl1cyA9IG9wdGlvbnMucmFkaXVzOwogICAgICB0aGlzLnN1c3BlbnNpb25TdGlmZm5lc3MgPSBvcHRpb25zLnN1c3BlbnNpb25TdGlmZm5lc3M7CiAgICAgIHRoaXMuZGFtcGluZ0NvbXByZXNzaW9uID0gb3B0aW9ucy5kYW1waW5nQ29tcHJlc3Npb247CiAgICAgIHRoaXMuZGFtcGluZ1JlbGF4YXRpb24gPSBvcHRpb25zLmRhbXBpbmdSZWxheGF0aW9uOwogICAgICB0aGlzLmZyaWN0aW9uU2xpcCA9IG9wdGlvbnMuZnJpY3Rpb25TbGlwOwogICAgICB0aGlzLmZvcndhcmRBY2NlbGVyYXRpb24gPSBvcHRpb25zLmZvcndhcmRBY2NlbGVyYXRpb247CiAgICAgIHRoaXMuc2lkZUFjY2VsZXJhdGlvbiA9IG9wdGlvbnMuc2lkZUFjY2VsZXJhdGlvbjsKICAgICAgdGhpcy5zdGVlcmluZyA9IDA7CiAgICAgIHRoaXMucm90YXRpb24gPSAwOwogICAgICB0aGlzLmRlbHRhUm90YXRpb24gPSAwOwogICAgICB0aGlzLnJvbGxJbmZsdWVuY2UgPSBvcHRpb25zLnJvbGxJbmZsdWVuY2U7CiAgICAgIHRoaXMubWF4U3VzcGVuc2lvbkZvcmNlID0gb3B0aW9ucy5tYXhTdXNwZW5zaW9uRm9yY2U7CiAgICAgIHRoaXMuZW5naW5lRm9yY2UgPSAwOwogICAgICB0aGlzLmJyYWtlID0gMDsKICAgICAgdGhpcy5pc0Zyb250V2hlZWwgPSBvcHRpb25zLmlzRnJvbnRXaGVlbDsKICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxOwogICAgICB0aGlzLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMDsKICAgICAgdGhpcy5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICB0aGlzLnNsaXBJbmZvID0gMDsKICAgICAgdGhpcy5za2lkSW5mbyA9IDA7CiAgICAgIHRoaXMuc3VzcGVuc2lvbkxlbmd0aCA9IDA7CiAgICAgIHRoaXMuc2lkZUltcHVsc2UgPSAwOwogICAgICB0aGlzLmZvcndhcmRJbXB1bHNlID0gMDsKICAgICAgdGhpcy5yYXljYXN0UmVzdWx0ID0gbmV3IFJheWNhc3RSZXN1bHQoKTsKICAgICAgdGhpcy53b3JsZFRyYW5zZm9ybSA9IG5ldyBUcmFuc2Zvcm0oKTsKICAgICAgdGhpcy5pc0luQ29udGFjdCA9IGZhbHNlOwogICAgfQoKICAgIHVwZGF0ZVdoZWVsKGNoYXNzaXMpIHsKICAgICAgY29uc3QgcmF5Y2FzdFJlc3VsdCA9IHRoaXMucmF5Y2FzdFJlc3VsdDsKCiAgICAgIGlmICh0aGlzLmlzSW5Db250YWN0KSB7CiAgICAgICAgY29uc3QgcHJvamVjdCA9IHJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KHJheWNhc3RSZXN1bHQuZGlyZWN0aW9uV29ybGQpOwogICAgICAgIHJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGNoYXNzaXMucG9zaXRpb24sIHJlbHBvcyk7CiAgICAgICAgY2hhc3Npcy5nZXRWZWxvY2l0eUF0V29ybGRQb2ludChyZWxwb3MsIGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50KTsKICAgICAgICBjb25zdCBwcm9qVmVsID0gcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZC5kb3QoY2hhc3Npc192ZWxvY2l0eV9hdF9jb250YWN0UG9pbnQpOwoKICAgICAgICBpZiAocHJvamVjdCA+PSAtMC4xKSB7CiAgICAgICAgICB0aGlzLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMC4wOwogICAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjAgLyAwLjE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGludiA9IC0xIC8gcHJvamVjdDsKICAgICAgICAgIHRoaXMuc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkgPSBwcm9qVmVsICogaW52OwogICAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSBpbnY7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIE5vdCBpbiBjb250YWN0IDogcG9zaXRpb24gd2hlZWwgaW4gYSBuaWNlIChyZXN0IGxlbmd0aCkgcG9zaXRpb24KICAgICAgICByYXljYXN0UmVzdWx0LnN1c3BlbnNpb25MZW5ndGggPSB0aGlzLnN1c3BlbnNpb25SZXN0TGVuZ3RoOwogICAgICAgIHRoaXMuc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkgPSAwLjA7CiAgICAgICAgcmF5Y2FzdFJlc3VsdC5kaXJlY3Rpb25Xb3JsZC5zY2FsZSgtMSwgcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZCk7CiAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjA7CiAgICAgIH0KICAgIH0KCiAgfQogIGNvbnN0IGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50ID0gbmV3IFZlYzMoKTsKICBjb25zdCByZWxwb3MgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBWZWhpY2xlIGhlbHBlciBjbGFzcyB0aGF0IGNhc3RzIHJheXMgZnJvbSB0aGUgd2hlZWwgcG9zaXRpb25zIHRvd2FyZHMgdGhlIGdyb3VuZCBhbmQgYXBwbGllcyBmb3JjZXMuCiAgICovCiAgY2xhc3MgUmF5Y2FzdFZlaGljbGUgewogICAgLyoqIFRoZSBjYXIgY2hhc3NpcyBib2R5LiAqLwoKICAgIC8qKiBUaGUgd2hlZWxzLiAqLwoKICAgIC8qKiBXaWxsIGJlIHNldCB0byB0cnVlIGlmIHRoZSBjYXIgaXMgc2xpZGluZy4gKi8KCiAgICAvKiogSW5kZXggb2YgdGhlIHJpZ2h0IGF4aXMuIHg9MCwgeT0xLCB6PTIgKi8KCiAgICAvKiogSW5kZXggb2YgdGhlIGZvcndhcmQgYXhpcy4geD0wLCB5PTEsIHo9MiAqLwoKICAgIC8qKiBJbmRleCBvZiB0aGUgdXAgYXhpcy4geD0wLCB5PTEsIHo9MiAqLwoKICAgIC8qKiBUaGUgY29uc3RyYWludHMuICovCgogICAgLyoqIE9wdGlvbmFsIHByZS1zdGVwIGNhbGxiYWNrLiAqLwoKICAgIC8qKiBOdW1iZXIgb2Ygd2hlZWxzIG9uIHRoZSBncm91bmQuICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7CiAgICAgIHRoaXMuY2hhc3Npc0JvZHkgPSBvcHRpb25zLmNoYXNzaXNCb2R5OwogICAgICB0aGlzLndoZWVsSW5mb3MgPSBbXTsKICAgICAgdGhpcy5zbGlkaW5nID0gZmFsc2U7CiAgICAgIHRoaXMud29ybGQgPSBudWxsOwogICAgICB0aGlzLmluZGV4UmlnaHRBeGlzID0gdHlwZW9mIG9wdGlvbnMuaW5kZXhSaWdodEF4aXMgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5pbmRleFJpZ2h0QXhpcyA6IDI7CiAgICAgIHRoaXMuaW5kZXhGb3J3YXJkQXhpcyA9IHR5cGVvZiBvcHRpb25zLmluZGV4Rm9yd2FyZEF4aXMgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5pbmRleEZvcndhcmRBeGlzIDogMDsKICAgICAgdGhpcy5pbmRleFVwQXhpcyA9IHR5cGVvZiBvcHRpb25zLmluZGV4VXBBeGlzICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuaW5kZXhVcEF4aXMgOiAxOwogICAgICB0aGlzLmNvbnN0cmFpbnRzID0gW107CgogICAgICB0aGlzLnByZVN0ZXBDYWxsYmFjayA9ICgpID0+IHt9OwoKICAgICAgdGhpcy5jdXJyZW50VmVoaWNsZVNwZWVkS21Ib3VyID0gMDsKICAgICAgdGhpcy5udW1XaGVlbHNPbkdyb3VuZCA9IDA7CiAgICB9CiAgICAvKioKICAgICAqIEFkZCBhIHdoZWVsLiBGb3IgaW5mb3JtYXRpb24gYWJvdXQgdGhlIG9wdGlvbnMsIHNlZSBgV2hlZWxJbmZvYC4KICAgICAqLwoKCiAgICBhZGRXaGVlbChvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIGNvbnN0IGluZm8gPSBuZXcgV2hlZWxJbmZvKG9wdGlvbnMpOwogICAgICBjb25zdCBpbmRleCA9IHRoaXMud2hlZWxJbmZvcy5sZW5ndGg7CiAgICAgIHRoaXMud2hlZWxJbmZvcy5wdXNoKGluZm8pOwogICAgICByZXR1cm4gaW5kZXg7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgc3RlZXJpbmcgdmFsdWUgb2YgYSB3aGVlbC4KICAgICAqLwoKCiAgICBzZXRTdGVlcmluZ1ZhbHVlKHZhbHVlLCB3aGVlbEluZGV4KSB7CiAgICAgIGNvbnN0IHdoZWVsID0gdGhpcy53aGVlbEluZm9zW3doZWVsSW5kZXhdOwogICAgICB3aGVlbC5zdGVlcmluZyA9IHZhbHVlOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIHdoZWVsIGZvcmNlIHRvIGFwcGx5IG9uIG9uZSBvZiB0aGUgd2hlZWxzIGVhY2ggdGltZSBzdGVwCiAgICAgKi8KCgogICAgYXBwbHlFbmdpbmVGb3JjZSh2YWx1ZSwgd2hlZWxJbmRleCkgewogICAgICB0aGlzLndoZWVsSW5mb3Nbd2hlZWxJbmRleF0uZW5naW5lRm9yY2UgPSB2YWx1ZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBicmFraW5nIGZvcmNlIG9mIGEgd2hlZWwKICAgICAqLwoKCiAgICBzZXRCcmFrZShicmFrZSwgd2hlZWxJbmRleCkgewogICAgICB0aGlzLndoZWVsSW5mb3Nbd2hlZWxJbmRleF0uYnJha2UgPSBicmFrZTsKICAgIH0KICAgIC8qKgogICAgICogQWRkIHRoZSB2ZWhpY2xlIGluY2x1ZGluZyBpdHMgY29uc3RyYWludHMgdG8gdGhlIHdvcmxkLgogICAgICovCgoKICAgIGFkZFRvV29ybGQod29ybGQpIHsKICAgICAgd29ybGQuYWRkQm9keSh0aGlzLmNoYXNzaXNCb2R5KTsKICAgICAgY29uc3QgdGhhdCA9IHRoaXM7CgogICAgICB0aGlzLnByZVN0ZXBDYWxsYmFjayA9ICgpID0+IHsKICAgICAgICB0aGF0LnVwZGF0ZVZlaGljbGUod29ybGQuZHQpOwogICAgICB9OwoKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHRoaXMucHJlU3RlcENhbGxiYWNrKTsKICAgICAgdGhpcy53b3JsZCA9IHdvcmxkOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgb25lIG9mIHRoZSB3aGVlbCBheGxlcywgd29ybGQtb3JpZW50ZWQuCiAgICAgKi8KCgogICAgZ2V0VmVoaWNsZUF4aXNXb3JsZChheGlzSW5kZXgsIHJlc3VsdCkgewogICAgICByZXN1bHQuc2V0KGF4aXNJbmRleCA9PT0gMCA/IDEgOiAwLCBheGlzSW5kZXggPT09IDEgPyAxIDogMCwgYXhpc0luZGV4ID09PSAyID8gMSA6IDApOwogICAgICB0aGlzLmNoYXNzaXNCb2R5LnZlY3RvclRvV29ybGRGcmFtZShyZXN1bHQsIHJlc3VsdCk7CiAgICB9CgogICAgdXBkYXRlVmVoaWNsZSh0aW1lU3RlcCkgewogICAgICBjb25zdCB3aGVlbEluZm9zID0gdGhpcy53aGVlbEluZm9zOwogICAgICBjb25zdCBudW1XaGVlbHMgPSB3aGVlbEluZm9zLmxlbmd0aDsKICAgICAgY29uc3QgY2hhc3Npc0JvZHkgPSB0aGlzLmNoYXNzaXNCb2R5OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIHRoaXMudXBkYXRlV2hlZWxUcmFuc2Zvcm0oaSk7CiAgICAgIH0KCiAgICAgIHRoaXMuY3VycmVudFZlaGljbGVTcGVlZEttSG91ciA9IDMuNiAqIGNoYXNzaXNCb2R5LnZlbG9jaXR5Lmxlbmd0aCgpOwogICAgICBjb25zdCBmb3J3YXJkV29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmdldFZlaGljbGVBeGlzV29ybGQodGhpcy5pbmRleEZvcndhcmRBeGlzLCBmb3J3YXJkV29ybGQpOwoKICAgICAgaWYgKGZvcndhcmRXb3JsZC5kb3QoY2hhc3Npc0JvZHkudmVsb2NpdHkpIDwgMCkgewogICAgICAgIHRoaXMuY3VycmVudFZlaGljbGVTcGVlZEttSG91ciAqPSAtMTsKICAgICAgfSAvLyBzaW11bGF0ZSBzdXNwZW5zaW9uCgoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIHRoaXMuY2FzdFJheSh3aGVlbEluZm9zW2ldKTsKICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVTdXNwZW5zaW9uKHRpbWVTdGVwKTsKICAgICAgY29uc3QgaW1wdWxzZSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHJlbHBvcyA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVdoZWVsczsgaSsrKSB7CiAgICAgICAgLy9hcHBseSBzdXNwZW5zaW9uIGZvcmNlCiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW2ldOwogICAgICAgIGxldCBzdXNwZW5zaW9uRm9yY2UgPSB3aGVlbC5zdXNwZW5zaW9uRm9yY2U7CgogICAgICAgIGlmIChzdXNwZW5zaW9uRm9yY2UgPiB3aGVlbC5tYXhTdXNwZW5zaW9uRm9yY2UpIHsKICAgICAgICAgIHN1c3BlbnNpb25Gb3JjZSA9IHdoZWVsLm1heFN1c3BlbnNpb25Gb3JjZTsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuc2NhbGUoc3VzcGVuc2lvbkZvcmNlICogdGltZVN0ZXAsIGltcHVsc2UpOwogICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGNoYXNzaXNCb2R5LnBvc2l0aW9uLCByZWxwb3MpOwogICAgICAgIGNoYXNzaXNCb2R5LmFwcGx5SW1wdWxzZShpbXB1bHNlLCByZWxwb3MpOwogICAgICB9CgogICAgICB0aGlzLnVwZGF0ZUZyaWN0aW9uKHRpbWVTdGVwKTsKICAgICAgY29uc3QgaGl0Tm9ybWFsV29ybGRTY2FsZWRXaXRoUHJvaiA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGZ3ZCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHZlbCA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVdoZWVsczsgaSsrKSB7CiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW2ldOyAvL2NvbnN0IHJlbHBvcyA9IG5ldyBWZWMzKCk7CiAgICAgICAgLy93aGVlbC5jaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQudnN1YihjaGFzc2lzQm9keS5wb3NpdGlvbiwgcmVscG9zKTsKCiAgICAgICAgY2hhc3Npc0JvZHkuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLCB2ZWwpOyAvLyBIYWNrIHRvIGdldCB0aGUgcm90YXRpb24gaW4gdGhlIGNvcnJlY3QgZGlyZWN0aW9uCgogICAgICAgIGxldCBtID0gMTsKCiAgICAgICAgc3dpdGNoICh0aGlzLmluZGV4VXBBeGlzKSB7CiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIG0gPSAtMTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAod2hlZWwuaXNJbkNvbnRhY3QpIHsKICAgICAgICAgIHRoaXMuZ2V0VmVoaWNsZUF4aXNXb3JsZCh0aGlzLmluZGV4Rm9yd2FyZEF4aXMsIGZ3ZCk7CiAgICAgICAgICBjb25zdCBwcm9qID0gZndkLmRvdCh3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkKTsKICAgICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuc2NhbGUocHJvaiwgaGl0Tm9ybWFsV29ybGRTY2FsZWRXaXRoUHJvaik7CiAgICAgICAgICBmd2QudnN1YihoaXROb3JtYWxXb3JsZFNjYWxlZFdpdGhQcm9qLCBmd2QpOwogICAgICAgICAgY29uc3QgcHJvajIgPSBmd2QuZG90KHZlbCk7CiAgICAgICAgICB3aGVlbC5kZWx0YVJvdGF0aW9uID0gbSAqIHByb2oyICogdGltZVN0ZXAgLyB3aGVlbC5yYWRpdXM7CiAgICAgICAgfQoKICAgICAgICBpZiAoKHdoZWVsLnNsaWRpbmcgfHwgIXdoZWVsLmlzSW5Db250YWN0KSAmJiB3aGVlbC5lbmdpbmVGb3JjZSAhPT0gMCAmJiB3aGVlbC51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkKSB7CiAgICAgICAgICAvLyBBcHBseSBjdXN0b20gcm90YXRpb24gd2hlbiBhY2NlbGVyYXRpbmcgYW5kIHNsaWRpbmcKICAgICAgICAgIHdoZWVsLmRlbHRhUm90YXRpb24gPSAod2hlZWwuZW5naW5lRm9yY2UgPiAwID8gMSA6IC0xKSAqIHdoZWVsLmN1c3RvbVNsaWRpbmdSb3RhdGlvbmFsU3BlZWQgKiB0aW1lU3RlcDsKICAgICAgICB9IC8vIExvY2sgd2hlZWxzCgoKICAgICAgICBpZiAoTWF0aC5hYnMod2hlZWwuYnJha2UpID4gTWF0aC5hYnMod2hlZWwuZW5naW5lRm9yY2UpKSB7CiAgICAgICAgICB3aGVlbC5kZWx0YVJvdGF0aW9uID0gMDsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnJvdGF0aW9uICs9IHdoZWVsLmRlbHRhUm90YXRpb247IC8vIFVzZSB0aGUgb2xkIHZhbHVlCgogICAgICAgIHdoZWVsLmRlbHRhUm90YXRpb24gKj0gMC45OTsgLy8gZGFtcGluZyBvZiByb3RhdGlvbiB3aGVuIG5vdCBpbiBjb250YWN0CiAgICAgIH0KICAgIH0KCiAgICB1cGRhdGVTdXNwZW5zaW9uKGRlbHRhVGltZSkgewogICAgICBjb25zdCBjaGFzc2lzQm9keSA9IHRoaXMuY2hhc3Npc0JvZHk7CiAgICAgIGNvbnN0IGNoYXNzaXNNYXNzID0gY2hhc3Npc0JvZHkubWFzczsKICAgICAgY29uc3Qgd2hlZWxJbmZvcyA9IHRoaXMud2hlZWxJbmZvczsKICAgICAgY29uc3QgbnVtV2hlZWxzID0gd2hlZWxJbmZvcy5sZW5ndGg7CgogICAgICBmb3IgKGxldCB3X2l0ID0gMDsgd19pdCA8IG51bVdoZWVsczsgd19pdCsrKSB7CiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW3dfaXRdOwoKICAgICAgICBpZiAod2hlZWwuaXNJbkNvbnRhY3QpIHsKICAgICAgICAgIGxldCBmb3JjZTsgLy8gU3ByaW5nCgogICAgICAgICAgY29uc3Qgc3VzcF9sZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aDsKICAgICAgICAgIGNvbnN0IGN1cnJlbnRfbGVuZ3RoID0gd2hlZWwuc3VzcGVuc2lvbkxlbmd0aDsKICAgICAgICAgIGNvbnN0IGxlbmd0aF9kaWZmID0gc3VzcF9sZW5ndGggLSBjdXJyZW50X2xlbmd0aDsKICAgICAgICAgIGZvcmNlID0gd2hlZWwuc3VzcGVuc2lvblN0aWZmbmVzcyAqIGxlbmd0aF9kaWZmICogd2hlZWwuY2xpcHBlZEludkNvbnRhY3REb3RTdXNwZW5zaW9uOyAvLyBEYW1wZXIKCiAgICAgICAgICBjb25zdCBwcm9qZWN0ZWRfcmVsX3ZlbCA9IHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5OwogICAgICAgICAgbGV0IHN1c3BfZGFtcGluZzsKCiAgICAgICAgICBpZiAocHJvamVjdGVkX3JlbF92ZWwgPCAwKSB7CiAgICAgICAgICAgIHN1c3BfZGFtcGluZyA9IHdoZWVsLmRhbXBpbmdDb21wcmVzc2lvbjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN1c3BfZGFtcGluZyA9IHdoZWVsLmRhbXBpbmdSZWxheGF0aW9uOwogICAgICAgICAgfQoKICAgICAgICAgIGZvcmNlIC09IHN1c3BfZGFtcGluZyAqIHByb2plY3RlZF9yZWxfdmVsOwogICAgICAgICAgd2hlZWwuc3VzcGVuc2lvbkZvcmNlID0gZm9yY2UgKiBjaGFzc2lzTWFzczsKCiAgICAgICAgICBpZiAod2hlZWwuc3VzcGVuc2lvbkZvcmNlIDwgMCkgewogICAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgdGhlIHZlaGljbGUgaW5jbHVkaW5nIGl0cyBjb25zdHJhaW50cyBmcm9tIHRoZSB3b3JsZC4KICAgICAqLwoKCiAgICByZW1vdmVGcm9tV29ybGQod29ybGQpIHsKICAgICAgdGhpcy5jb25zdHJhaW50czsKICAgICAgd29ybGQucmVtb3ZlQm9keSh0aGlzLmNoYXNzaXNCb2R5KTsKICAgICAgd29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHRoaXMucHJlU3RlcENhbGxiYWNrKTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICB9CgogICAgY2FzdFJheSh3aGVlbCkgewogICAgICBjb25zdCByYXl2ZWN0b3IgPSBjYXN0UmF5X3JheXZlY3RvcjsKICAgICAgY29uc3QgdGFyZ2V0ID0gY2FzdFJheV90YXJnZXQ7CiAgICAgIHRoaXMudXBkYXRlV2hlZWxUcmFuc2Zvcm1Xb3JsZCh3aGVlbCk7CiAgICAgIGNvbnN0IGNoYXNzaXNCb2R5ID0gdGhpcy5jaGFzc2lzQm9keTsKICAgICAgbGV0IGRlcHRoID0gLTE7CiAgICAgIGNvbnN0IHJheWxlbiA9IHdoZWVsLnN1c3BlbnNpb25SZXN0TGVuZ3RoICsgd2hlZWwucmFkaXVzOwogICAgICB3aGVlbC5kaXJlY3Rpb25Xb3JsZC5zY2FsZShyYXlsZW4sIHJheXZlY3Rvcik7CiAgICAgIGNvbnN0IHNvdXJjZSA9IHdoZWVsLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZDsKICAgICAgc291cmNlLnZhZGQocmF5dmVjdG9yLCB0YXJnZXQpOwogICAgICBjb25zdCByYXljYXN0UmVzdWx0ID0gd2hlZWwucmF5Y2FzdFJlc3VsdDsKICAgICAgcmF5Y2FzdFJlc3VsdC5yZXNldCgpOyAvLyBUdXJuIG9mZiByYXkgY29sbGlzaW9uIHdpdGggdGhlIGNoYXNzaXMgdGVtcG9yYXJpbHkKCiAgICAgIGNvbnN0IG9sZFN0YXRlID0gY2hhc3Npc0JvZHkuY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIGNoYXNzaXNCb2R5LmNvbGxpc2lvblJlc3BvbnNlID0gZmFsc2U7IC8vIENhc3QgcmF5IGFnYWluc3Qgd29ybGQKCiAgICAgIHRoaXMud29ybGQucmF5VGVzdChzb3VyY2UsIHRhcmdldCwgcmF5Y2FzdFJlc3VsdCk7CiAgICAgIGNoYXNzaXNCb2R5LmNvbGxpc2lvblJlc3BvbnNlID0gb2xkU3RhdGU7CiAgICAgIGNvbnN0IG9iamVjdCA9IHJheWNhc3RSZXN1bHQuYm9keTsKICAgICAgd2hlZWwucmF5Y2FzdFJlc3VsdC5ncm91bmRPYmplY3QgPSAwOwoKICAgICAgaWYgKG9iamVjdCkgewogICAgICAgIGRlcHRoID0gcmF5Y2FzdFJlc3VsdC5kaXN0YW5jZTsKICAgICAgICB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkID0gcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZDsKICAgICAgICB3aGVlbC5pc0luQ29udGFjdCA9IHRydWU7CiAgICAgICAgY29uc3QgaGl0RGlzdGFuY2UgPSByYXljYXN0UmVzdWx0LmRpc3RhbmNlOwogICAgICAgIHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPSBoaXREaXN0YW5jZSAtIHdoZWVsLnJhZGl1czsgLy8gY2xhbXAgb24gbWF4IHN1c3BlbnNpb24gdHJhdmVsCgogICAgICAgIGNvbnN0IG1pblN1c3BlbnNpb25MZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aCAtIHdoZWVsLm1heFN1c3BlbnNpb25UcmF2ZWw7CiAgICAgICAgY29uc3QgbWF4U3VzcGVuc2lvbkxlbmd0aCA9IHdoZWVsLnN1c3BlbnNpb25SZXN0TGVuZ3RoICsgd2hlZWwubWF4U3VzcGVuc2lvblRyYXZlbDsKCiAgICAgICAgaWYgKHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPCBtaW5TdXNwZW5zaW9uTGVuZ3RoKSB7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uTGVuZ3RoID0gbWluU3VzcGVuc2lvbkxlbmd0aDsKICAgICAgICB9CgogICAgICAgIGlmICh3aGVlbC5zdXNwZW5zaW9uTGVuZ3RoID4gbWF4U3VzcGVuc2lvbkxlbmd0aCkgewogICAgICAgICAgd2hlZWwuc3VzcGVuc2lvbkxlbmd0aCA9IG1heFN1c3BlbnNpb25MZW5ndGg7CiAgICAgICAgICB3aGVlbC5yYXljYXN0UmVzdWx0LnJlc2V0KCk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBkZW5vbWluYXRvciA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KHdoZWVsLmRpcmVjdGlvbldvcmxkKTsKICAgICAgICBjb25zdCBjaGFzc2lzX3ZlbG9jaXR5X2F0X2NvbnRhY3RQb2ludCA9IG5ldyBWZWMzKCk7CiAgICAgICAgY2hhc3Npc0JvZHkuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLCBjaGFzc2lzX3ZlbG9jaXR5X2F0X2NvbnRhY3RQb2ludCk7CiAgICAgICAgY29uc3QgcHJvalZlbCA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50KTsKCiAgICAgICAgaWYgKGRlbm9taW5hdG9yID49IC0wLjEpIHsKICAgICAgICAgIHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMDsKICAgICAgICAgIHdoZWVsLmNsaXBwZWRJbnZDb250YWN0RG90U3VzcGVuc2lvbiA9IDEgLyAwLjE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGludiA9IC0xIC8gZGVub21pbmF0b3I7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uUmVsYXRpdmVWZWxvY2l0eSA9IHByb2pWZWwgKiBpbnY7CiAgICAgICAgICB3aGVlbC5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSBpbnY7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vcHV0IHdoZWVsIGluZm8gYXMgaW4gcmVzdCBwb3NpdGlvbgogICAgICAgIHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aCArIDAgKiB3aGVlbC5tYXhTdXNwZW5zaW9uVHJhdmVsOwogICAgICAgIHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMC4wOwogICAgICAgIHdoZWVsLmRpcmVjdGlvbldvcmxkLnNjYWxlKC0xLCB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkKTsKICAgICAgICB3aGVlbC5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjA7CiAgICAgIH0KCiAgICAgIHJldHVybiBkZXB0aDsKICAgIH0KCiAgICB1cGRhdGVXaGVlbFRyYW5zZm9ybVdvcmxkKHdoZWVsKSB7CiAgICAgIHdoZWVsLmlzSW5Db250YWN0ID0gZmFsc2U7CiAgICAgIGNvbnN0IGNoYXNzaXNCb2R5ID0gdGhpcy5jaGFzc2lzQm9keTsKICAgICAgY2hhc3Npc0JvZHkucG9pbnRUb1dvcmxkRnJhbWUod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludExvY2FsLCB3aGVlbC5jaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQpOwogICAgICBjaGFzc2lzQm9keS52ZWN0b3JUb1dvcmxkRnJhbWUod2hlZWwuZGlyZWN0aW9uTG9jYWwsIHdoZWVsLmRpcmVjdGlvbldvcmxkKTsKICAgICAgY2hhc3Npc0JvZHkudmVjdG9yVG9Xb3JsZEZyYW1lKHdoZWVsLmF4bGVMb2NhbCwgd2hlZWwuYXhsZVdvcmxkKTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIG9uZSBvZiB0aGUgd2hlZWwgdHJhbnNmb3JtLgogICAgICogTm90ZSB3aGVuIHJlbmRlcmluZyB3aGVlbHM6IGR1cmluZyBlYWNoIHN0ZXAsIHdoZWVsIHRyYW5zZm9ybXMgYXJlIHVwZGF0ZWQgQkVGT1JFIHRoZSBjaGFzc2lzOyBpZS4gdGhlaXIgcG9zaXRpb24gYmVjb21lcyBpbnZhbGlkIGFmdGVyIHRoZSBzdGVwLiBUaHVzIHdoZW4geW91IHJlbmRlciB3aGVlbHMsIHlvdSBtdXN0IHVwZGF0ZSB3aGVlbCB0cmFuc2Zvcm1zIGJlZm9yZSByZW5kZXJpbmcgdGhlbS4gU2VlIHJheWNhc3RWZWhpY2xlIGRlbW8gZm9yIGFuIGV4YW1wbGUuCiAgICAgKiBAcGFyYW0gd2hlZWxJbmRleCBUaGUgd2hlZWwgaW5kZXggdG8gdXBkYXRlLgogICAgICovCgoKICAgIHVwZGF0ZVdoZWVsVHJhbnNmb3JtKHdoZWVsSW5kZXgpIHsKICAgICAgY29uc3QgdXAgPSB0bXBWZWM0OwogICAgICBjb25zdCByaWdodCA9IHRtcFZlYzU7CiAgICAgIGNvbnN0IGZ3ZCA9IHRtcFZlYzY7CiAgICAgIGNvbnN0IHdoZWVsID0gdGhpcy53aGVlbEluZm9zW3doZWVsSW5kZXhdOwogICAgICB0aGlzLnVwZGF0ZVdoZWVsVHJhbnNmb3JtV29ybGQod2hlZWwpOwogICAgICB3aGVlbC5kaXJlY3Rpb25Mb2NhbC5zY2FsZSgtMSwgdXApOwogICAgICByaWdodC5jb3B5KHdoZWVsLmF4bGVMb2NhbCk7CiAgICAgIHVwLmNyb3NzKHJpZ2h0LCBmd2QpOwogICAgICBmd2Qubm9ybWFsaXplKCk7CiAgICAgIHJpZ2h0Lm5vcm1hbGl6ZSgpOyAvLyBSb3RhdGUgYXJvdW5kIHN0ZWVyaW5nIG92ZXIgdGhlIHdoZWVsQXhsZQoKICAgICAgY29uc3Qgc3RlZXJpbmcgPSB3aGVlbC5zdGVlcmluZzsKICAgICAgY29uc3Qgc3RlZXJpbmdPcm4gPSBuZXcgUXVhdGVybmlvbigpOwogICAgICBzdGVlcmluZ09ybi5zZXRGcm9tQXhpc0FuZ2xlKHVwLCBzdGVlcmluZyk7CiAgICAgIGNvbnN0IHJvdGF0aW5nT3JuID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgcm90YXRpbmdPcm4uc2V0RnJvbUF4aXNBbmdsZShyaWdodCwgd2hlZWwucm90YXRpb24pOyAvLyBXb3JsZCByb3RhdGlvbiBvZiB0aGUgd2hlZWwKCiAgICAgIGNvbnN0IHEgPSB3aGVlbC53b3JsZFRyYW5zZm9ybS5xdWF0ZXJuaW9uOwogICAgICB0aGlzLmNoYXNzaXNCb2R5LnF1YXRlcm5pb24ubXVsdChzdGVlcmluZ09ybiwgcSk7CiAgICAgIHEubXVsdChyb3RhdGluZ09ybiwgcSk7CiAgICAgIHEubm9ybWFsaXplKCk7IC8vIHdvcmxkIHBvc2l0aW9uIG9mIHRoZSB3aGVlbAoKICAgICAgY29uc3QgcCA9IHdoZWVsLndvcmxkVHJhbnNmb3JtLnBvc2l0aW9uOwogICAgICBwLmNvcHkod2hlZWwuZGlyZWN0aW9uV29ybGQpOwogICAgICBwLnNjYWxlKHdoZWVsLnN1c3BlbnNpb25MZW5ndGgsIHApOwogICAgICBwLnZhZGQod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLCBwKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSB3b3JsZCB0cmFuc2Zvcm0gb2Ygb25lIG9mIHRoZSB3aGVlbHMKICAgICAqLwoKCiAgICBnZXRXaGVlbFRyYW5zZm9ybVdvcmxkKHdoZWVsSW5kZXgpIHsKICAgICAgcmV0dXJuIHRoaXMud2hlZWxJbmZvc1t3aGVlbEluZGV4XS53b3JsZFRyYW5zZm9ybTsKICAgIH0KCiAgICB1cGRhdGVGcmljdGlvbih0aW1lU3RlcCkgewogICAgICBjb25zdCBzdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2ogPSB1cGRhdGVGcmljdGlvbl9zdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2o7IC8vY2FsY3VsYXRlIHRoZSBpbXB1bHNlLCBzbyB0aGF0IHRoZSB3aGVlbHMgZG9uJ3QgbW92ZSBzaWRld2FyZHMKCiAgICAgIGNvbnN0IHdoZWVsSW5mb3MgPSB0aGlzLndoZWVsSW5mb3M7CiAgICAgIGNvbnN0IG51bVdoZWVscyA9IHdoZWVsSW5mb3MubGVuZ3RoOwogICAgICBjb25zdCBjaGFzc2lzQm9keSA9IHRoaXMuY2hhc3Npc0JvZHk7CiAgICAgIGNvbnN0IGZvcndhcmRXUyA9IHVwZGF0ZUZyaWN0aW9uX2ZvcndhcmRXUzsKICAgICAgY29uc3QgYXhsZSA9IHVwZGF0ZUZyaWN0aW9uX2F4bGU7CiAgICAgIHRoaXMubnVtV2hlZWxzT25Hcm91bmQgPSAwOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKICAgICAgICBjb25zdCBncm91bmRPYmplY3QgPSB3aGVlbC5yYXljYXN0UmVzdWx0LmJvZHk7CgogICAgICAgIGlmIChncm91bmRPYmplY3QpIHsKICAgICAgICAgIHRoaXMubnVtV2hlZWxzT25Hcm91bmQrKzsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlID0gMDsKICAgICAgICB3aGVlbC5mb3J3YXJkSW1wdWxzZSA9IDA7CgogICAgICAgIGlmICghZm9yd2FyZFdTW2ldKSB7CiAgICAgICAgICBmb3J3YXJkV1NbaV0gPSBuZXcgVmVjMygpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFheGxlW2ldKSB7CiAgICAgICAgICBheGxlW2ldID0gbmV3IFZlYzMoKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICBjb25zdCB3aGVlbCA9IHdoZWVsSW5mb3NbaV07CiAgICAgICAgY29uc3QgZ3JvdW5kT2JqZWN0ID0gd2hlZWwucmF5Y2FzdFJlc3VsdC5ib2R5OwoKICAgICAgICBpZiAoZ3JvdW5kT2JqZWN0KSB7CiAgICAgICAgICBjb25zdCBheGxlaSA9IGF4bGVbaV07CiAgICAgICAgICBjb25zdCB3aGVlbFRyYW5zID0gdGhpcy5nZXRXaGVlbFRyYW5zZm9ybVdvcmxkKGkpOyAvLyBHZXQgd29ybGQgYXhsZQoKICAgICAgICAgIHdoZWVsVHJhbnMudmVjdG9yVG9Xb3JsZEZyYW1lKGRpcmVjdGlvbnNbdGhpcy5pbmRleFJpZ2h0QXhpc10sIGF4bGVpKTsKICAgICAgICAgIGNvbnN0IHN1cmZOb3JtYWxXUyA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQ7CiAgICAgICAgICBjb25zdCBwcm9qID0gYXhsZWkuZG90KHN1cmZOb3JtYWxXUyk7CiAgICAgICAgICBzdXJmTm9ybWFsV1Muc2NhbGUocHJvaiwgc3VyZk5vcm1hbFdTX3NjYWxlZF9wcm9qKTsKICAgICAgICAgIGF4bGVpLnZzdWIoc3VyZk5vcm1hbFdTX3NjYWxlZF9wcm9qLCBheGxlaSk7CiAgICAgICAgICBheGxlaS5ub3JtYWxpemUoKTsKICAgICAgICAgIHN1cmZOb3JtYWxXUy5jcm9zcyhheGxlaSwgZm9yd2FyZFdTW2ldKTsKICAgICAgICAgIGZvcndhcmRXU1tpXS5ub3JtYWxpemUoKTsKICAgICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlID0gcmVzb2x2ZVNpbmdsZUJpbGF0ZXJhbChjaGFzc2lzQm9keSwgd2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLCBncm91bmRPYmplY3QsIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZCwgYXhsZWkpOwogICAgICAgICAgd2hlZWwuc2lkZUltcHVsc2UgKj0gc2lkZUZyaWN0aW9uU3RpZmZuZXNzMjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IHNpZGVGYWN0b3IgPSAxOwogICAgICBjb25zdCBmd2RGYWN0b3IgPSAwLjU7CiAgICAgIHRoaXMuc2xpZGluZyA9IGZhbHNlOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKICAgICAgICBjb25zdCBncm91bmRPYmplY3QgPSB3aGVlbC5yYXljYXN0UmVzdWx0LmJvZHk7CiAgICAgICAgbGV0IHJvbGxpbmdGcmljdGlvbiA9IDA7CiAgICAgICAgd2hlZWwuc2xpcEluZm8gPSAxOwoKICAgICAgICBpZiAoZ3JvdW5kT2JqZWN0KSB7CiAgICAgICAgICBjb25zdCBkZWZhdWx0Um9sbGluZ0ZyaWN0aW9uSW1wdWxzZSA9IDA7CiAgICAgICAgICBjb25zdCBtYXhJbXB1bHNlID0gd2hlZWwuYnJha2UgPyB3aGVlbC5icmFrZSA6IGRlZmF1bHRSb2xsaW5nRnJpY3Rpb25JbXB1bHNlOyAvLyBidFdoZWVsQ29udGFjdFBvaW50IGNvbnRhY3RQdChjaGFzc2lzQm9keSxncm91bmRPYmplY3Qsd2hlZWxJbmZyYXljYXN0SW5mby5oaXRQb2ludFdvcmxkLGZvcndhcmRXU1t3aGVlbF0sbWF4SW1wdWxzZSk7CiAgICAgICAgICAvLyByb2xsaW5nRnJpY3Rpb24gPSBjYWxjUm9sbGluZ0ZyaWN0aW9uKGNvbnRhY3RQdCk7CgogICAgICAgICAgcm9sbGluZ0ZyaWN0aW9uID0gY2FsY1JvbGxpbmdGcmljdGlvbihjaGFzc2lzQm9keSwgZ3JvdW5kT2JqZWN0LCB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdFBvaW50V29ybGQsIGZvcndhcmRXU1tpXSwgbWF4SW1wdWxzZSk7CiAgICAgICAgICByb2xsaW5nRnJpY3Rpb24gKz0gd2hlZWwuZW5naW5lRm9yY2UgKiB0aW1lU3RlcDsgLy8gcm9sbGluZ0ZyaWN0aW9uID0gMDsKCiAgICAgICAgICBjb25zdCBmYWN0b3IgPSBtYXhJbXB1bHNlIC8gcm9sbGluZ0ZyaWN0aW9uOwogICAgICAgICAgd2hlZWwuc2xpcEluZm8gKj0gZmFjdG9yOwogICAgICAgIH0gLy9zd2l0Y2ggYmV0d2VlbiBhY3RpdmUgcm9sbGluZyAodGhyb3R0bGUpLCBicmFraW5nIGFuZCBub24tYWN0aXZlIHJvbGxpbmcgZnJpY3Rpb24gKG50aHJvdHRsZS9icmVhaykKCgogICAgICAgIHdoZWVsLmZvcndhcmRJbXB1bHNlID0gMDsKICAgICAgICB3aGVlbC5za2lkSW5mbyA9IDE7CgogICAgICAgIGlmIChncm91bmRPYmplY3QpIHsKICAgICAgICAgIHdoZWVsLnNraWRJbmZvID0gMTsKICAgICAgICAgIGNvbnN0IG1heGltcCA9IHdoZWVsLnN1c3BlbnNpb25Gb3JjZSAqIHRpbWVTdGVwICogd2hlZWwuZnJpY3Rpb25TbGlwOwogICAgICAgICAgY29uc3QgbWF4aW1wU2lkZSA9IG1heGltcDsKICAgICAgICAgIGNvbnN0IG1heGltcFNxdWFyZWQgPSBtYXhpbXAgKiBtYXhpbXBTaWRlOwogICAgICAgICAgd2hlZWwuZm9yd2FyZEltcHVsc2UgPSByb2xsaW5nRnJpY3Rpb247IC8vd2hlZWxJbmZvLmVuZ2luZUZvcmNlKiB0aW1lU3RlcDsKCiAgICAgICAgICBjb25zdCB4ID0gd2hlZWwuZm9yd2FyZEltcHVsc2UgKiBmd2RGYWN0b3IgLyB3aGVlbC5mb3J3YXJkQWNjZWxlcmF0aW9uOwogICAgICAgICAgY29uc3QgeSA9IHdoZWVsLnNpZGVJbXB1bHNlICogc2lkZUZhY3RvciAvIHdoZWVsLnNpZGVBY2NlbGVyYXRpb247CiAgICAgICAgICBjb25zdCBpbXB1bHNlU3F1YXJlZCA9IHggKiB4ICsgeSAqIHk7CiAgICAgICAgICB3aGVlbC5zbGlkaW5nID0gZmFsc2U7CgogICAgICAgICAgaWYgKGltcHVsc2VTcXVhcmVkID4gbWF4aW1wU3F1YXJlZCkgewogICAgICAgICAgICB0aGlzLnNsaWRpbmcgPSB0cnVlOwogICAgICAgICAgICB3aGVlbC5zbGlkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgY29uc3QgZmFjdG9yID0gbWF4aW1wIC8gTWF0aC5zcXJ0KGltcHVsc2VTcXVhcmVkKTsKICAgICAgICAgICAgd2hlZWwuc2tpZEluZm8gKj0gZmFjdG9yOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMuc2xpZGluZykgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKCiAgICAgICAgICBpZiAod2hlZWwuc2lkZUltcHVsc2UgIT09IDApIHsKICAgICAgICAgICAgaWYgKHdoZWVsLnNraWRJbmZvIDwgMSkgewogICAgICAgICAgICAgIHdoZWVsLmZvcndhcmRJbXB1bHNlICo9IHdoZWVsLnNraWRJbmZvOwogICAgICAgICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlICo9IHdoZWVsLnNraWRJbmZvOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIGFwcGx5IHRoZSBpbXB1bHNlcwoKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICBjb25zdCB3aGVlbCA9IHdoZWVsSW5mb3NbaV07CiAgICAgICAgY29uc3QgcmVsX3BvcyA9IG5ldyBWZWMzKCk7CiAgICAgICAgd2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLnZzdWIoY2hhc3Npc0JvZHkucG9zaXRpb24sIHJlbF9wb3MpOyAvLyBjYW5ub25zIGFwcGx5aW1wdWxzZSBpcyB1c2luZyB3b3JsZCBjb29yZCBmb3IgdGhlIHBvc2l0aW9uCiAgICAgICAgLy9yZWxfcG9zLmNvcHkod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkKTsKCiAgICAgICAgaWYgKHdoZWVsLmZvcndhcmRJbXB1bHNlICE9PSAwKSB7CiAgICAgICAgICBjb25zdCBpbXB1bHNlID0gbmV3IFZlYzMoKTsKICAgICAgICAgIGZvcndhcmRXU1tpXS5zY2FsZSh3aGVlbC5mb3J3YXJkSW1wdWxzZSwgaW1wdWxzZSk7CiAgICAgICAgICBjaGFzc2lzQm9keS5hcHBseUltcHVsc2UoaW1wdWxzZSwgcmVsX3Bvcyk7CiAgICAgICAgfQoKICAgICAgICBpZiAod2hlZWwuc2lkZUltcHVsc2UgIT09IDApIHsKICAgICAgICAgIGNvbnN0IGdyb3VuZE9iamVjdCA9IHdoZWVsLnJheWNhc3RSZXN1bHQuYm9keTsKICAgICAgICAgIGNvbnN0IHJlbF9wb3MyID0gbmV3IFZlYzMoKTsKICAgICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGdyb3VuZE9iamVjdC5wb3NpdGlvbiwgcmVsX3BvczIpOyAvL3JlbF9wb3MyLmNvcHkod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkKTsKCiAgICAgICAgICBjb25zdCBzaWRlSW1wID0gbmV3IFZlYzMoKTsKICAgICAgICAgIGF4bGVbaV0uc2NhbGUod2hlZWwuc2lkZUltcHVsc2UsIHNpZGVJbXApOyAvLyBTY2FsZSB0aGUgcmVsYXRpdmUgcG9zaXRpb24gaW4gdGhlIHVwIGRpcmVjdGlvbiB3aXRoIHJvbGxJbmZsdWVuY2UuCiAgICAgICAgICAvLyBJZiByb2xsSW5mbHVlbmNlIGlzIDEsIHRoZSBpbXB1bHNlIHdpbGwgYmUgYXBwbGllZCBvbiB0aGUgaGl0UG9pbnQgKGVhc3kgdG8gcm9sbCBvdmVyKSwgaWYgaXQgaXMgemVybyBpdCB3aWxsIGJlIGFwcGxpZWQgaW4gdGhlIHNhbWUgcGxhbmUgYXMgdGhlIGNlbnRlciBvZiBtYXNzIChub3QgZWFzeSB0byByb2xsIG92ZXIpLgoKICAgICAgICAgIGNoYXNzaXNCb2R5LnZlY3RvclRvTG9jYWxGcmFtZShyZWxfcG9zLCByZWxfcG9zKTsKICAgICAgICAgIHJlbF9wb3NbJ3h5eidbdGhpcy5pbmRleFVwQXhpc11dICo9IHdoZWVsLnJvbGxJbmZsdWVuY2U7CiAgICAgICAgICBjaGFzc2lzQm9keS52ZWN0b3JUb1dvcmxkRnJhbWUocmVsX3BvcywgcmVsX3Bvcyk7CiAgICAgICAgICBjaGFzc2lzQm9keS5hcHBseUltcHVsc2Uoc2lkZUltcCwgcmVsX3Bvcyk7IC8vYXBwbHkgZnJpY3Rpb24gaW1wdWxzZSBvbiB0aGUgZ3JvdW5kCgogICAgICAgICAgc2lkZUltcC5zY2FsZSgtMSwgc2lkZUltcCk7CiAgICAgICAgICBncm91bmRPYmplY3QuYXBwbHlJbXB1bHNlKHNpZGVJbXAsIHJlbF9wb3MyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgfQogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzQgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzUgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzYgPSBuZXcgVmVjMygpOwogIG5ldyBSYXkoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IGNhc3RSYXlfcmF5dmVjdG9yID0gbmV3IFZlYzMoKTsKICBjb25zdCBjYXN0UmF5X3RhcmdldCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZGlyZWN0aW9ucyA9IFtuZXcgVmVjMygxLCAwLCAwKSwgbmV3IFZlYzMoMCwgMSwgMCksIG5ldyBWZWMzKDAsIDAsIDEpXTsKICBjb25zdCB1cGRhdGVGcmljdGlvbl9zdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2ogPSBuZXcgVmVjMygpOwogIGNvbnN0IHVwZGF0ZUZyaWN0aW9uX2F4bGUgPSBbXTsKICBjb25zdCB1cGRhdGVGcmljdGlvbl9mb3J3YXJkV1MgPSBbXTsKICBjb25zdCBzaWRlRnJpY3Rpb25TdGlmZm5lc3MyID0gMTsKICBjb25zdCBjYWxjUm9sbGluZ0ZyaWN0aW9uX3ZlbDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNhbGNSb2xsaW5nRnJpY3Rpb25fdmVsMiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY2FsY1JvbGxpbmdGcmljdGlvbl92ZWwgPSBuZXcgVmVjMygpOwoKICBmdW5jdGlvbiBjYWxjUm9sbGluZ0ZyaWN0aW9uKGJvZHkwLCBib2R5MSwgZnJpY3Rpb25Qb3NXb3JsZCwgZnJpY3Rpb25EaXJlY3Rpb25Xb3JsZCwgbWF4SW1wdWxzZSkgewogICAgbGV0IGoxID0gMDsKICAgIGNvbnN0IGNvbnRhY3RQb3NXb3JsZCA9IGZyaWN0aW9uUG9zV29ybGQ7IC8vIGNvbnN0IHJlbF9wb3MxID0gbmV3IFZlYzMoKTsKICAgIC8vIGNvbnN0IHJlbF9wb3MyID0gbmV3IFZlYzMoKTsKCiAgICBjb25zdCB2ZWwxID0gY2FsY1JvbGxpbmdGcmljdGlvbl92ZWwxOwogICAgY29uc3QgdmVsMiA9IGNhbGNSb2xsaW5nRnJpY3Rpb25fdmVsMjsKICAgIGNvbnN0IHZlbCA9IGNhbGNSb2xsaW5nRnJpY3Rpb25fdmVsOyAvLyBjb250YWN0UG9zV29ybGQudnN1Yihib2R5MC5wb3NpdGlvbiwgcmVsX3BvczEpOwogICAgLy8gY29udGFjdFBvc1dvcmxkLnZzdWIoYm9keTEucG9zaXRpb24sIHJlbF9wb3MyKTsKCiAgICBib2R5MC5nZXRWZWxvY2l0eUF0V29ybGRQb2ludChjb250YWN0UG9zV29ybGQsIHZlbDEpOwogICAgYm9keTEuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQoY29udGFjdFBvc1dvcmxkLCB2ZWwyKTsKICAgIHZlbDEudnN1Yih2ZWwyLCB2ZWwpOwogICAgY29uc3QgdnJlbCA9IGZyaWN0aW9uRGlyZWN0aW9uV29ybGQuZG90KHZlbCk7CiAgICBjb25zdCBkZW5vbTAgPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yKGJvZHkwLCBmcmljdGlvblBvc1dvcmxkLCBmcmljdGlvbkRpcmVjdGlvbldvcmxkKTsKICAgIGNvbnN0IGRlbm9tMSA9IGNvbXB1dGVJbXB1bHNlRGVub21pbmF0b3IoYm9keTEsIGZyaWN0aW9uUG9zV29ybGQsIGZyaWN0aW9uRGlyZWN0aW9uV29ybGQpOwogICAgY29uc3QgcmVsYXhhdGlvbiA9IDE7CiAgICBjb25zdCBqYWNEaWFnQUJJbnYgPSByZWxheGF0aW9uIC8gKGRlbm9tMCArIGRlbm9tMSk7IC8vIGNhbGN1bGF0ZSBqIHRoYXQgbW92ZXMgdXMgdG8gemVybyByZWxhdGl2ZSB2ZWxvY2l0eQoKICAgIGoxID0gLXZyZWwgKiBqYWNEaWFnQUJJbnY7CgogICAgaWYgKG1heEltcHVsc2UgPCBqMSkgewogICAgICBqMSA9IG1heEltcHVsc2U7CiAgICB9CgogICAgaWYgKGoxIDwgLW1heEltcHVsc2UpIHsKICAgICAgajEgPSAtbWF4SW1wdWxzZTsKICAgIH0KCiAgICByZXR1cm4gajE7CiAgfQoKICBjb25zdCBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX3IwID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX2MwID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX3ZlYyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcl9tID0gbmV3IFZlYzMoKTsKCiAgZnVuY3Rpb24gY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcihib2R5LCBwb3MsIG5vcm1hbCkgewogICAgY29uc3QgcjAgPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX3IwOwogICAgY29uc3QgYzAgPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX2MwOwogICAgY29uc3QgdmVjID0gY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcl92ZWM7CiAgICBjb25zdCBtID0gY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcl9tOwogICAgcG9zLnZzdWIoYm9keS5wb3NpdGlvbiwgcjApOwogICAgcjAuY3Jvc3Mobm9ybWFsLCBjMCk7CiAgICBib2R5LmludkluZXJ0aWFXb3JsZC52bXVsdChjMCwgbSk7CiAgICBtLmNyb3NzKHIwLCB2ZWMpOwogICAgcmV0dXJuIGJvZHkuaW52TWFzcyArIG5vcm1hbC5kb3QodmVjKTsKICB9CgogIGNvbnN0IHJlc29sdmVTaW5nbGVCaWxhdGVyYWxfdmVsMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcmVzb2x2ZVNpbmdsZUJpbGF0ZXJhbF92ZWwyID0gbmV3IFZlYzMoKTsKICBjb25zdCByZXNvbHZlU2luZ2xlQmlsYXRlcmFsX3ZlbCA9IG5ldyBWZWMzKCk7IC8vIGJpbGF0ZXJhbCBjb25zdHJhaW50IGJldHdlZW4gdHdvIGR5bmFtaWMgb2JqZWN0cwoKICBmdW5jdGlvbiByZXNvbHZlU2luZ2xlQmlsYXRlcmFsKGJvZHkxLCBwb3MxLCBib2R5MiwgcG9zMiwgbm9ybWFsKSB7CiAgICBjb25zdCBub3JtYWxMZW5TcXIgPSBub3JtYWwubGVuZ3RoU3F1YXJlZCgpOwoKICAgIGlmIChub3JtYWxMZW5TcXIgPiAxLjEpIHsKICAgICAgcmV0dXJuIDA7IC8vIG5vIGltcHVsc2UKICAgIH0gLy8gY29uc3QgcmVsX3BvczEgPSBuZXcgVmVjMygpOwogICAgLy8gY29uc3QgcmVsX3BvczIgPSBuZXcgVmVjMygpOwogICAgLy8gcG9zMS52c3ViKGJvZHkxLnBvc2l0aW9uLCByZWxfcG9zMSk7CiAgICAvLyBwb3MyLnZzdWIoYm9keTIucG9zaXRpb24sIHJlbF9wb3MyKTsKCgogICAgY29uc3QgdmVsMSA9IHJlc29sdmVTaW5nbGVCaWxhdGVyYWxfdmVsMTsKICAgIGNvbnN0IHZlbDIgPSByZXNvbHZlU2luZ2xlQmlsYXRlcmFsX3ZlbDI7CiAgICBjb25zdCB2ZWwgPSByZXNvbHZlU2luZ2xlQmlsYXRlcmFsX3ZlbDsKICAgIGJvZHkxLmdldFZlbG9jaXR5QXRXb3JsZFBvaW50KHBvczEsIHZlbDEpOwogICAgYm9keTIuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQocG9zMiwgdmVsMik7CiAgICB2ZWwxLnZzdWIodmVsMiwgdmVsKTsKICAgIGNvbnN0IHJlbF92ZWwgPSBub3JtYWwuZG90KHZlbCk7CiAgICBjb25zdCBjb250YWN0RGFtcGluZyA9IDAuMjsKICAgIGNvbnN0IG1hc3NUZXJtID0gMSAvIChib2R5MS5pbnZNYXNzICsgYm9keTIuaW52TWFzcyk7CiAgICBjb25zdCBpbXB1bHNlID0gLWNvbnRhY3REYW1waW5nICogcmVsX3ZlbCAqIG1hc3NUZXJtOwogICAgcmV0dXJuIGltcHVsc2U7CiAgfQoKICAvKioKICAgKiBTcGhlcmljYWwgc2hhcGUKICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCByYWRpdXMgPSAxCiAgICogICAgIGNvbnN0IHNwaGVyZVNoYXBlID0gbmV3IENBTk5PTi5TcGhlcmUocmFkaXVzKQogICAqICAgICBjb25zdCBzcGhlcmVCb2R5ID0gbmV3IENBTk5PTi5Cb2R5KHsgbWFzczogMSwgc2hhcGU6IHNwaGVyZVNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoc3BoZXJlQm9keSkKICAgKi8KICBjbGFzcyBTcGhlcmUgZXh0ZW5kcyBTaGFwZSB7CiAgICAvKioKICAgICAqIFRoZSByYWRpdXMgb2YgdGhlIHNwaGVyZS4KICAgICAqLwoKICAgIC8qKgogICAgICoKICAgICAqIEBwYXJhbSByYWRpdXMgVGhlIHJhZGl1cyBvZiB0aGUgc3BoZXJlLCBhIG5vbi1uZWdhdGl2ZSBudW1iZXIuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKHJhZGl1cykgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuU1BIRVJFCiAgICAgIH0pOwogICAgICB0aGlzLnJhZGl1cyA9IHJhZGl1cyAhPT0gdW5kZWZpbmVkID8gcmFkaXVzIDogMS4wOwoKICAgICAgaWYgKHRoaXMucmFkaXVzIDwgMCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIHNwaGVyZSByYWRpdXMgY2Fubm90IGJlIG5lZ2F0aXZlLicpOwogICAgICB9CgogICAgICB0aGlzLnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7CiAgICB9CiAgICAvKiogY2FsY3VsYXRlTG9jYWxJbmVydGlhICovCgoKICAgIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYShtYXNzLCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICAgICAgfQoKICAgICAgY29uc3QgSSA9IDIuMCAqIG1hc3MgKiB0aGlzLnJhZGl1cyAqIHRoaXMucmFkaXVzIC8gNS4wOwogICAgICB0YXJnZXQueCA9IEk7CiAgICAgIHRhcmdldC55ID0gSTsKICAgICAgdGFyZ2V0LnogPSBJOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqIHZvbHVtZSAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA0LjAgKiBNYXRoLlBJICogTWF0aC5wb3codGhpcy5yYWRpdXMsIDMpIC8gMy4wOwogICAgfQoKICAgIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCkgewogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gdGhpcy5yYWRpdXM7CiAgICB9CgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgY29uc3QgciA9IHRoaXMucmFkaXVzOwogICAgICBjb25zdCBheGVzID0gWyd4JywgJ3knLCAneiddOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBheGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgYXggPSBheGVzW2ldOwogICAgICAgIG1pbltheF0gPSBwb3NbYXhdIC0gcjsKICAgICAgICBtYXhbYXhdID0gcG9zW2F4XSArIHI7CiAgICAgIH0KICAgIH0KCiAgfQogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOyAvLyBUZW1wIHZlY3RvcnMgZm9yIGNhbGN1bGF0aW9uCgogIG5ldyBWZWMzKCk7IC8vIFJlbGF0aXZlIHZlbG9jaXR5CgogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKCiAgLyoqCiAgICogQ3lsaW5kZXIgY2xhc3MuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgcmFkaXVzVG9wID0gMC41CiAgICogICAgIGNvbnN0IHJhZGl1c0JvdHRvbSA9IDAuNQogICAqICAgICBjb25zdCBoZWlnaHQgPSAyCiAgICogICAgIGNvbnN0IG51bVNlZ21lbnRzID0gMTIKICAgKiAgICAgY29uc3QgY3lsaW5kZXJTaGFwZSA9IG5ldyBDQU5OT04uQ3lsaW5kZXIocmFkaXVzVG9wLCByYWRpdXNCb3R0b20sIGhlaWdodCwgbnVtU2VnbWVudHMpCiAgICogICAgIGNvbnN0IGN5bGluZGVyQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBjeWxpbmRlclNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoY3lsaW5kZXJCb2R5KQogICAqLwoKICBjbGFzcyBDeWxpbmRlciBleHRlbmRzIENvbnZleFBvbHloZWRyb24gewogICAgLyoqIFRoZSByYWRpdXMgb2YgdGhlIHRvcCBvZiB0aGUgQ3lsaW5kZXIuICovCgogICAgLyoqIFRoZSByYWRpdXMgb2YgdGhlIGJvdHRvbSBvZiB0aGUgQ3lsaW5kZXIuICovCgogICAgLyoqIFRoZSBoZWlnaHQgb2YgdGhlIEN5bGluZGVyLiAqLwoKICAgIC8qKiBUaGUgbnVtYmVyIG9mIHNlZ21lbnRzIHRvIGJ1aWxkIHRoZSBjeWxpbmRlciBvdXQgb2YuICovCgogICAgLyoqCiAgICAgKiBAcGFyYW0gcmFkaXVzVG9wIFRoZSByYWRpdXMgb2YgdGhlIHRvcCBvZiB0aGUgQ3lsaW5kZXIuCiAgICAgKiBAcGFyYW0gcmFkaXVzQm90dG9tIFRoZSByYWRpdXMgb2YgdGhlIGJvdHRvbSBvZiB0aGUgQ3lsaW5kZXIuCiAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIEN5bGluZGVyLgogICAgICogQHBhcmFtIG51bVNlZ21lbnRzIFRoZSBudW1iZXIgb2Ygc2VnbWVudHMgdG8gYnVpbGQgdGhlIGN5bGluZGVyIG91dCBvZi4KICAgICAqLwogICAgY29uc3RydWN0b3IocmFkaXVzVG9wLCByYWRpdXNCb3R0b20sIGhlaWdodCwgbnVtU2VnbWVudHMpIHsKICAgICAgaWYgKHJhZGl1c1RvcCA9PT0gdm9pZCAwKSB7CiAgICAgICAgcmFkaXVzVG9wID0gMTsKICAgICAgfQoKICAgICAgaWYgKHJhZGl1c0JvdHRvbSA9PT0gdm9pZCAwKSB7CiAgICAgICAgcmFkaXVzQm90dG9tID0gMTsKICAgICAgfQoKICAgICAgaWYgKGhlaWdodCA9PT0gdm9pZCAwKSB7CiAgICAgICAgaGVpZ2h0ID0gMTsKICAgICAgfQoKICAgICAgaWYgKG51bVNlZ21lbnRzID09PSB2b2lkIDApIHsKICAgICAgICBudW1TZWdtZW50cyA9IDg7CiAgICAgIH0KCiAgICAgIGlmIChyYWRpdXNUb3AgPCAwKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgY3lsaW5kZXIgcmFkaXVzVG9wIGNhbm5vdCBiZSBuZWdhdGl2ZS4nKTsKICAgICAgfQoKICAgICAgaWYgKHJhZGl1c0JvdHRvbSA8IDApIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjeWxpbmRlciByYWRpdXNCb3R0b20gY2Fubm90IGJlIG5lZ2F0aXZlLicpOwogICAgICB9CgogICAgICBjb25zdCBOID0gbnVtU2VnbWVudHM7CiAgICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICAgIGNvbnN0IGF4ZXMgPSBbXTsKICAgICAgY29uc3QgZmFjZXMgPSBbXTsKICAgICAgY29uc3QgYm90dG9tZmFjZSA9IFtdOwogICAgICBjb25zdCB0b3BmYWNlID0gW107CiAgICAgIGNvbnN0IGNvcyA9IE1hdGguY29zOwogICAgICBjb25zdCBzaW4gPSBNYXRoLnNpbjsgLy8gRmlyc3QgYm90dG9tIHBvaW50CgogICAgICB2ZXJ0aWNlcy5wdXNoKG5ldyBWZWMzKC1yYWRpdXNCb3R0b20gKiBzaW4oMCksIC1oZWlnaHQgKiAwLjUsIHJhZGl1c0JvdHRvbSAqIGNvcygwKSkpOwogICAgICBib3R0b21mYWNlLnB1c2goMCk7IC8vIEZpcnN0IHRvcCBwb2ludAoKICAgICAgdmVydGljZXMucHVzaChuZXcgVmVjMygtcmFkaXVzVG9wICogc2luKDApLCBoZWlnaHQgKiAwLjUsIHJhZGl1c1RvcCAqIGNvcygwKSkpOwogICAgICB0b3BmYWNlLnB1c2goMSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE47IGkrKykgewogICAgICAgIGNvbnN0IHRoZXRhID0gMiAqIE1hdGguUEkgLyBOICogKGkgKyAxKTsKICAgICAgICBjb25zdCB0aGV0YU4gPSAyICogTWF0aC5QSSAvIE4gKiAoaSArIDAuNSk7CgogICAgICAgIGlmIChpIDwgTiAtIDEpIHsKICAgICAgICAgIC8vIEJvdHRvbQogICAgICAgICAgdmVydGljZXMucHVzaChuZXcgVmVjMygtcmFkaXVzQm90dG9tICogc2luKHRoZXRhKSwgLWhlaWdodCAqIDAuNSwgcmFkaXVzQm90dG9tICogY29zKHRoZXRhKSkpOwogICAgICAgICAgYm90dG9tZmFjZS5wdXNoKDIgKiBpICsgMik7IC8vIFRvcAoKICAgICAgICAgIHZlcnRpY2VzLnB1c2gobmV3IFZlYzMoLXJhZGl1c1RvcCAqIHNpbih0aGV0YSksIGhlaWdodCAqIDAuNSwgcmFkaXVzVG9wICogY29zKHRoZXRhKSkpOwogICAgICAgICAgdG9wZmFjZS5wdXNoKDIgKiBpICsgMyk7IC8vIEZhY2UKCiAgICAgICAgICBmYWNlcy5wdXNoKFsyICogaSwgMiAqIGkgKyAxLCAyICogaSArIDMsIDIgKiBpICsgMl0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmYWNlcy5wdXNoKFsyICogaSwgMiAqIGkgKyAxLCAxLCAwXSk7IC8vIENvbm5lY3QKICAgICAgICB9IC8vIEF4aXM6IHdlIGNhbiBjdXQgb2ZmIGhhbGYgb2YgdGhlbSBpZiB3ZSBoYXZlIGV2ZW4gbnVtYmVyIG9mIHNlZ21lbnRzCgoKICAgICAgICBpZiAoTiAlIDIgPT09IDEgfHwgaSA8IE4gLyAyKSB7CiAgICAgICAgICBheGVzLnB1c2gobmV3IFZlYzMoLXNpbih0aGV0YU4pLCAwLCBjb3ModGhldGFOKSkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZmFjZXMucHVzaChib3R0b21mYWNlKTsKICAgICAgYXhlcy5wdXNoKG5ldyBWZWMzKDAsIDEsIDApKTsgLy8gUmVvcmRlciB0b3AgZmFjZQoKICAgICAgY29uc3QgdGVtcCA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3BmYWNlLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGVtcC5wdXNoKHRvcGZhY2VbdG9wZmFjZS5sZW5ndGggLSBpIC0gMV0pOwogICAgICB9CgogICAgICBmYWNlcy5wdXNoKHRlbXApOwogICAgICBzdXBlcih7CiAgICAgICAgdmVydGljZXMsCiAgICAgICAgZmFjZXMsCiAgICAgICAgYXhlcwogICAgICB9KTsKICAgICAgdGhpcy50eXBlID0gU2hhcGUudHlwZXMuQ1lMSU5ERVI7CiAgICAgIHRoaXMucmFkaXVzVG9wID0gcmFkaXVzVG9wOwogICAgICB0aGlzLnJhZGl1c0JvdHRvbSA9IHJhZGl1c0JvdHRvbTsKICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgIHRoaXMubnVtU2VnbWVudHMgPSBudW1TZWdtZW50czsKICAgIH0KCiAgfQoKICAvKioKICAgKiBQYXJ0aWNsZSBzaGFwZS4KICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCBwYXJ0aWNsZVNoYXBlID0gbmV3IENBTk5PTi5QYXJ0aWNsZSgpCiAgICogICAgIGNvbnN0IHBhcnRpY2xlQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBwYXJ0aWNsZVNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkocGFydGljbGVCb2R5KQogICAqLwogIGNsYXNzIFBhcnRpY2xlIGV4dGVuZHMgU2hhcGUgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5QQVJUSUNMRQogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICogY2FsY3VsYXRlTG9jYWxJbmVydGlhCiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQuc2V0KDAsIDAsIDApOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSAwOwogICAgfQoKICAgIGNhbGN1bGF0ZVdvcmxkQUFCQihwb3MsIHF1YXQsIG1pbiwgbWF4KSB7CiAgICAgIC8vIEdldCBlYWNoIGF4aXMgbWF4CiAgICAgIG1pbi5jb3B5KHBvcyk7CiAgICAgIG1heC5jb3B5KHBvcyk7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQSBwbGFuZSwgZmFjaW5nIGluIHRoZSBaIGRpcmVjdGlvbi4gVGhlIHBsYW5lIGhhcyBpdHMgc3VyZmFjZSBhdCB6PTAgYW5kIGV2ZXJ5dGhpbmcgYmVsb3cgej0wIGlzIGFzc3VtZWQgdG8gYmUgc29saWQgcGxhbmUuIFRvIG1ha2UgdGhlIHBsYW5lIGZhY2UgaW4gc29tZSBvdGhlciBkaXJlY3Rpb24gdGhhbiB6LCB5b3UgbXVzdCBwdXQgaXQgaW5zaWRlIGEgQm9keSBhbmQgcm90YXRlIHRoYXQgYm9keS4gU2VlIHRoZSBkZW1vcy4KICAgKiBAZXhhbXBsZQogICAqICAgICBjb25zdCBwbGFuZVNoYXBlID0gbmV3IENBTk5PTi5QbGFuZSgpCiAgICogICAgIGNvbnN0IHBsYW5lQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDAsIHNoYXBlOiAgcGxhbmVTaGFwZSB9KQogICAqICAgICBwbGFuZUJvZHkucXVhdGVybmlvbi5zZXRGcm9tRXVsZXIoLU1hdGguUEkgLyAyLCAwLCAwKSAvLyBtYWtlIGl0IGZhY2UgdXAKICAgKiAgICAgd29ybGQuYWRkQm9keShwbGFuZUJvZHkpCiAgICovCiAgY2xhc3MgUGxhbmUgZXh0ZW5kcyBTaGFwZSB7CiAgICAvKiogd29ybGROb3JtYWwgKi8KCiAgICAvKiogd29ybGROb3JtYWxOZWVkc1VwZGF0ZSAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5QTEFORQogICAgICB9KTsgLy8gV29ybGQgb3JpZW50ZWQgbm9ybWFsCgogICAgICB0aGlzLndvcmxkTm9ybWFsID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy53b3JsZE5vcm1hbE5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IE51bWJlci5NQVhfVkFMVUU7CiAgICB9CiAgICAvKiogY29tcHV0ZVdvcmxkTm9ybWFsICovCgoKICAgIGNvbXB1dGVXb3JsZE5vcm1hbChxdWF0KSB7CiAgICAgIGNvbnN0IG4gPSB0aGlzLndvcmxkTm9ybWFsOwogICAgICBuLnNldCgwLCAwLCAxKTsKICAgICAgcXVhdC52bXVsdChuLCBuKTsKICAgICAgdGhpcy53b3JsZE5vcm1hbE5lZWRzVXBkYXRlID0gZmFsc2U7CiAgICB9CgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuICgvLyBUaGUgcGxhbmUgaXMgaW5maW5pdGUuLi4KICAgICAgICBOdW1iZXIuTUFYX1ZBTFVFCiAgICAgICk7CiAgICB9CgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgLy8gVGhlIHBsYW5lIEFBQkIgaXMgaW5maW5pdGUsIGV4Y2VwdCBpZiB0aGUgbm9ybWFsIGlzIHBvaW50aW5nIGFsb25nIGFueSBheGlzCiAgICAgIHRlbXBOb3JtYWwuc2V0KDAsIDAsIDEpOyAvLyBEZWZhdWx0IHBsYW5lIG5vcm1hbCBpcyB6CgogICAgICBxdWF0LnZtdWx0KHRlbXBOb3JtYWwsIHRlbXBOb3JtYWwpOwogICAgICBjb25zdCBtYXhWYWwgPSBOdW1iZXIuTUFYX1ZBTFVFOwogICAgICBtaW4uc2V0KC1tYXhWYWwsIC1tYXhWYWwsIC1tYXhWYWwpOwogICAgICBtYXguc2V0KG1heFZhbCwgbWF4VmFsLCBtYXhWYWwpOwoKICAgICAgaWYgKHRlbXBOb3JtYWwueCA9PT0gMSkgewogICAgICAgIG1heC54ID0gcG9zLng7CiAgICAgIH0gZWxzZSBpZiAodGVtcE5vcm1hbC54ID09PSAtMSkgewogICAgICAgIG1pbi54ID0gcG9zLng7CiAgICAgIH0KCiAgICAgIGlmICh0ZW1wTm9ybWFsLnkgPT09IDEpIHsKICAgICAgICBtYXgueSA9IHBvcy55OwogICAgICB9IGVsc2UgaWYgKHRlbXBOb3JtYWwueSA9PT0gLTEpIHsKICAgICAgICBtaW4ueSA9IHBvcy55OwogICAgICB9CgogICAgICBpZiAodGVtcE5vcm1hbC56ID09PSAxKSB7CiAgICAgICAgbWF4LnogPSBwb3MuejsKICAgICAgfSBlbHNlIGlmICh0ZW1wTm9ybWFsLnogPT09IC0xKSB7CiAgICAgICAgbWluLnogPSBwb3MuejsKICAgICAgfQogICAgfQoKICAgIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCkgewogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgIH0KCiAgfQogIGNvbnN0IHRlbXBOb3JtYWwgPSBuZXcgVmVjMygpOwoKICAvKioKICAgKiBIZWlnaHRmaWVsZCBzaGFwZSBjbGFzcy4gSGVpZ2h0IGRhdGEgaXMgZ2l2ZW4gYXMgYW4gYXJyYXkuIFRoZXNlIGRhdGEgcG9pbnRzIGFyZSBzcHJlYWQgb3V0IGV2ZW5seSB3aXRoIGEgZ2l2ZW4gZGlzdGFuY2UuCiAgICogQHRvZG8gU2hvdWxkIGJlIHBvc3NpYmxlIHRvIHVzZSBhbG9uZyBhbGwgYXhlcywgbm90IGp1c3QgeQogICAqIEB0b2RvIHNob3VsZCBiZSBwb3NzaWJsZSB0byBzY2FsZSBhbG9uZyBhbGwgYXhlcwogICAqIEB0b2RvIFJlZmFjdG9yIGVsZW1lbnRTaXplIHRvIGVsZW1lbnRTaXplWCBhbmQgZWxlbWVudFNpemVZCiAgICoKICAgKiBAZXhhbXBsZQogICAqICAgICAvLyBHZW5lcmF0ZSBzb21lIGhlaWdodCBkYXRhICh5LXZhbHVlcykuCiAgICogICAgIGNvbnN0IGRhdGEgPSBbXQogICAqICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDA7IGkrKykgewogICAqICAgICAgICAgY29uc3QgeSA9IDAuNSAqIE1hdGguY29zKDAuMiAqIGkpCiAgICogICAgICAgICBkYXRhLnB1c2goeSkKICAgKiAgICAgfQogICAqCiAgICogICAgIC8vIENyZWF0ZSB0aGUgaGVpZ2h0ZmllbGQgc2hhcGUKICAgKiAgICAgY29uc3QgaGVpZ2h0ZmllbGRTaGFwZSA9IG5ldyBDQU5OT04uSGVpZ2h0ZmllbGQoZGF0YSwgewogICAqICAgICAgICAgZWxlbWVudFNpemU6IDEgLy8gRGlzdGFuY2UgYmV0d2VlbiB0aGUgZGF0YSBwb2ludHMgaW4gWCBhbmQgWSBkaXJlY3Rpb25zCiAgICogICAgIH0pCiAgICogICAgIGNvbnN0IGhlaWdodGZpZWxkQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IHNoYXBlOiBoZWlnaHRmaWVsZFNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoaGVpZ2h0ZmllbGRCb2R5KQogICAqLwogIGNsYXNzIEhlaWdodGZpZWxkIGV4dGVuZHMgU2hhcGUgewogICAgLyoqCiAgICAgKiBBbiBhcnJheSBvZiBudW1iZXJzLCBvciBoZWlnaHQgdmFsdWVzLCB0aGF0IGFyZSBzcHJlYWQgb3V0IGFsb25nIHRoZSB4IGF4aXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIE1heCB2YWx1ZSBvZiB0aGUgZGF0YSBwb2ludHMgaW4gdGhlIGRhdGEgYXJyYXkuCiAgICAgKi8KCiAgICAvKioKICAgICAqIE1pbmltdW0gdmFsdWUgb2YgdGhlIGRhdGEgcG9pbnRzIGluIHRoZSBkYXRhIGFycmF5LgogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZCBzcGFjaW5nIGJldHdlZW4gdGhlIGRhdGEgcG9pbnRzIGluIFggYW5kIFkgZGlyZWN0aW9uLgogICAgICogQHRvZG8gZWxlbWVudFNpemVYIGFuZCBZCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIEBkZWZhdWx0IHRydWUKICAgICAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIGRhdGEgQW4gYXJyYXkgb2YgbnVtYmVycywgb3IgaGVpZ2h0IHZhbHVlcywgdGhhdCBhcmUgc3ByZWFkIG91dCBhbG9uZyB0aGUgeCBheGlzLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihkYXRhLCBvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIG9wdGlvbnMgPSBVdGlscy5kZWZhdWx0cyhvcHRpb25zLCB7CiAgICAgICAgbWF4VmFsdWU6IG51bGwsCiAgICAgICAgbWluVmFsdWU6IG51bGwsCiAgICAgICAgZWxlbWVudFNpemU6IDEKICAgICAgfSk7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5IRUlHSFRGSUVMRAogICAgICB9KTsKICAgICAgdGhpcy5kYXRhID0gZGF0YTsKICAgICAgdGhpcy5tYXhWYWx1ZSA9IG9wdGlvbnMubWF4VmFsdWU7CiAgICAgIHRoaXMubWluVmFsdWUgPSBvcHRpb25zLm1pblZhbHVlOwogICAgICB0aGlzLmVsZW1lbnRTaXplID0gb3B0aW9ucy5lbGVtZW50U2l6ZTsKCiAgICAgIGlmIChvcHRpb25zLm1pblZhbHVlID09PSBudWxsKSB7CiAgICAgICAgdGhpcy51cGRhdGVNaW5WYWx1ZSgpOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy5tYXhWYWx1ZSA9PT0gbnVsbCkgewogICAgICAgIHRoaXMudXBkYXRlTWF4VmFsdWUoKTsKICAgICAgfQoKICAgICAgdGhpcy5jYWNoZUVuYWJsZWQgPSB0cnVlOwogICAgICB0aGlzLnBpbGxhckNvbnZleCA9IG5ldyBDb252ZXhQb2x5aGVkcm9uKCk7CiAgICAgIHRoaXMucGlsbGFyT2Zmc2V0ID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOyAvLyAiaV9qX2lzVXBwZXIiID0+IHsgY29udmV4OiAuLi4sIG9mZnNldDogLi4uIH0KICAgICAgLy8gZm9yIGV4YW1wbGU6CiAgICAgIC8vIF9jYWNoZWRQaWxsYXJzWyIwXzJfMSJdCgogICAgICB0aGlzLl9jYWNoZWRQaWxsYXJzID0ge307CiAgICB9CiAgICAvKioKICAgICAqIENhbGwgd2hlbmV2ZXIgeW91IGNoYW5nZSB0aGUgZGF0YSBhcnJheS4KICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIHRoaXMuX2NhY2hlZFBpbGxhcnMgPSB7fTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIHRoZSBgbWluVmFsdWVgIHByb3BlcnR5CiAgICAgKi8KCgogICAgdXBkYXRlTWluVmFsdWUoKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGxldCBtaW5WYWx1ZSA9IGRhdGFbMF1bMF07CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBkYXRhW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCB2ID0gZGF0YVtpXVtqXTsKCiAgICAgICAgICBpZiAodiA8IG1pblZhbHVlKSB7CiAgICAgICAgICAgIG1pblZhbHVlID0gdjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMubWluVmFsdWUgPSBtaW5WYWx1ZTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIHRoZSBgbWF4VmFsdWVgIHByb3BlcnR5CiAgICAgKi8KCgogICAgdXBkYXRlTWF4VmFsdWUoKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGxldCBtYXhWYWx1ZSA9IGRhdGFbMF1bMF07CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBkYXRhW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCB2ID0gZGF0YVtpXVtqXTsKCiAgICAgICAgICBpZiAodiA+IG1heFZhbHVlKSB7CiAgICAgICAgICAgIG1heFZhbHVlID0gdjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMubWF4VmFsdWUgPSBtYXhWYWx1ZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBoZWlnaHQgdmFsdWUgYXQgYW4gaW5kZXguIERvbid0IGZvcmdldCB0byB1cGRhdGUgbWF4VmFsdWUgYW5kIG1pblZhbHVlIGFmdGVyIHlvdSdyZSBkb25lLgogICAgICovCgoKICAgIHNldEhlaWdodFZhbHVlQXRJbmRleCh4aSwgeWksIHZhbHVlKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGRhdGFbeGldW3lpXSA9IHZhbHVlOyAvLyBJbnZhbGlkYXRlIGNhY2hlCgogICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBmYWxzZSk7CgogICAgICBpZiAoeGkgPiAwKSB7CiAgICAgICAgdGhpcy5jbGVhckNhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpIC0gMSwgeWksIHRydWUpOwogICAgICAgIHRoaXMuY2xlYXJDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSAtIDEsIHlpLCBmYWxzZSk7CiAgICAgIH0KCiAgICAgIGlmICh5aSA+IDApIHsKICAgICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpIC0gMSwgdHJ1ZSk7CiAgICAgICAgdGhpcy5jbGVhckNhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSAtIDEsIGZhbHNlKTsKICAgICAgfQoKICAgICAgaWYgKHlpID4gMCAmJiB4aSA+IDApIHsKICAgICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGkgLSAxLCB5aSAtIDEsIHRydWUpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBtYXgvbWluIGluIGEgcmVjdGFuZ2xlIGluIHRoZSBtYXRyaXggZGF0YQogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSB0aGUgcmVzdWx0cyBpbi4KICAgICAqIEByZXR1cm4gVGhlIHJlc3VsdCBhcnJheSwgaWYgaXQgd2FzIHBhc3NlZCBpbi4gTWluaW11bSB3aWxsIGJlIGF0IHBvc2l0aW9uIDAgYW5kIG1heCBhdCAxLgogICAgICovCgoKICAgIGdldFJlY3RNaW5NYXgoaU1pblgsIGlNaW5ZLCBpTWF4WCwgaU1heFksIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHsKICAgICAgICByZXN1bHQgPSBbXTsKICAgICAgfQoKICAgICAgLy8gR2V0IG1heCBhbmQgbWluIG9mIHRoZSBkYXRhCiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7IC8vIFNldCBmaXJzdCB2YWx1ZQoKICAgICAgbGV0IG1heCA9IHRoaXMubWluVmFsdWU7CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPD0gaU1heFg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSBpTWluWTsgaiA8PSBpTWF4WTsgaisrKSB7CiAgICAgICAgICBjb25zdCBoZWlnaHQgPSBkYXRhW2ldW2pdOwoKICAgICAgICAgIGlmIChoZWlnaHQgPiBtYXgpIHsKICAgICAgICAgICAgbWF4ID0gaGVpZ2h0OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmVzdWx0WzBdID0gdGhpcy5taW5WYWx1ZTsKICAgICAgcmVzdWx0WzFdID0gbWF4OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGluZGV4IG9mIGEgbG9jYWwgcG9zaXRpb24gb24gdGhlIGhlaWdodGZpZWxkLiBUaGUgaW5kZXhlcyBpbmRpY2F0ZSB0aGUgcmVjdGFuZ2xlcywgc28gaWYgeW91ciB0ZXJyYWluIGlzIG1hZGUgb2YgTiB4IE4gaGVpZ2h0IGRhdGEgcG9pbnRzLCB5b3Ugd2lsbCBoYXZlIHJlY3RhbmdsZSBpbmRleGVzIHJhbmdpbmcgZnJvbSAwIHRvIE4tMS4KICAgICAqIEBwYXJhbSByZXN1bHQgVHdvLWVsZW1lbnQgYXJyYXkKICAgICAqIEBwYXJhbSBjbGFtcCBJZiB0aGUgcG9zaXRpb24gc2hvdWxkIGJlIGNsYW1wZWQgdG8gdGhlIGhlaWdodGZpZWxkIGVkZ2UuCiAgICAgKi8KCgogICAgZ2V0SW5kZXhPZlBvc2l0aW9uKHgsIHksIHJlc3VsdCwgY2xhbXApIHsKICAgICAgLy8gR2V0IHRoZSBpbmRleCBvZiB0aGUgZGF0YSBwb2ludHMgdG8gdGVzdCBhZ2FpbnN0CiAgICAgIGNvbnN0IHcgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBsZXQgeGkgPSBNYXRoLmZsb29yKHggLyB3KTsKICAgICAgbGV0IHlpID0gTWF0aC5mbG9vcih5IC8gdyk7CiAgICAgIHJlc3VsdFswXSA9IHhpOwogICAgICByZXN1bHRbMV0gPSB5aTsKCiAgICAgIGlmIChjbGFtcCkgewogICAgICAgIC8vIENsYW1wIGluZGV4IHRvIGVkZ2VzCiAgICAgICAgaWYgKHhpIDwgMCkgewogICAgICAgICAgeGkgPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKHlpIDwgMCkgewogICAgICAgICAgeWkgPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKHhpID49IGRhdGEubGVuZ3RoIC0gMSkgewogICAgICAgICAgeGkgPSBkYXRhLmxlbmd0aCAtIDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoeWkgPj0gZGF0YVswXS5sZW5ndGggLSAxKSB7CiAgICAgICAgICB5aSA9IGRhdGFbMF0ubGVuZ3RoIC0gMTsKICAgICAgICB9CiAgICAgIH0gLy8gQmFpbCBvdXQgaWYgd2UgYXJlIG91dCBvZiB0aGUgdGVycmFpbgoKCiAgICAgIGlmICh4aSA8IDAgfHwgeWkgPCAwIHx8IHhpID49IGRhdGEubGVuZ3RoIC0gMSB8fCB5aSA+PSBkYXRhWzBdLmxlbmd0aCAtIDEpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGdldFRyaWFuZ2xlQXQoeCwgeSwgZWRnZUNsYW1wLCBhLCBiLCBjKSB7CiAgICAgIGNvbnN0IGlkeCA9IGdldEhlaWdodEF0X2lkeDsKICAgICAgdGhpcy5nZXRJbmRleE9mUG9zaXRpb24oeCwgeSwgaWR4LCBlZGdlQ2xhbXApOwogICAgICBsZXQgeGkgPSBpZHhbMF07CiAgICAgIGxldCB5aSA9IGlkeFsxXTsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKCiAgICAgIGlmIChlZGdlQ2xhbXApIHsKICAgICAgICB4aSA9IE1hdGgubWluKGRhdGEubGVuZ3RoIC0gMiwgTWF0aC5tYXgoMCwgeGkpKTsKICAgICAgICB5aSA9IE1hdGgubWluKGRhdGFbMF0ubGVuZ3RoIC0gMiwgTWF0aC5tYXgoMCwgeWkpKTsKICAgICAgfQoKICAgICAgY29uc3QgZWxlbWVudFNpemUgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBsb3dlckRpc3QyID0gKHggLyBlbGVtZW50U2l6ZSAtIHhpKSAqKiAyICsgKHkgLyBlbGVtZW50U2l6ZSAtIHlpKSAqKiAyOwogICAgICBjb25zdCB1cHBlckRpc3QyID0gKHggLyBlbGVtZW50U2l6ZSAtICh4aSArIDEpKSAqKiAyICsgKHkgLyBlbGVtZW50U2l6ZSAtICh5aSArIDEpKSAqKiAyOwogICAgICBjb25zdCB1cHBlciA9IGxvd2VyRGlzdDIgPiB1cHBlckRpc3QyOwogICAgICB0aGlzLmdldFRyaWFuZ2xlKHhpLCB5aSwgdXBwZXIsIGEsIGIsIGMpOwogICAgICByZXR1cm4gdXBwZXI7CiAgICB9CgogICAgZ2V0Tm9ybWFsQXQoeCwgeSwgZWRnZUNsYW1wLCByZXN1bHQpIHsKICAgICAgY29uc3QgYSA9IGdldE5vcm1hbEF0X2E7CiAgICAgIGNvbnN0IGIgPSBnZXROb3JtYWxBdF9iOwogICAgICBjb25zdCBjID0gZ2V0Tm9ybWFsQXRfYzsKICAgICAgY29uc3QgZTAgPSBnZXROb3JtYWxBdF9lMDsKICAgICAgY29uc3QgZTEgPSBnZXROb3JtYWxBdF9lMTsKICAgICAgdGhpcy5nZXRUcmlhbmdsZUF0KHgsIHksIGVkZ2VDbGFtcCwgYSwgYiwgYyk7CiAgICAgIGIudnN1YihhLCBlMCk7CiAgICAgIGMudnN1YihhLCBlMSk7CiAgICAgIGUwLmNyb3NzKGUxLCByZXN1bHQpOwogICAgICByZXN1bHQubm9ybWFsaXplKCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBBQUJCIG9mIGEgc3F1YXJlIGluIHRoZSBoZWlnaHRmaWVsZAogICAgICogQHBhcmFtIHhpCiAgICAgKiBAcGFyYW0geWkKICAgICAqIEBwYXJhbSByZXN1bHQKICAgICAqLwoKCiAgICBnZXRBYWJiQXRJbmRleCh4aSwgeWksIF9yZWYpIHsKICAgICAgbGV0IHsKICAgICAgICBsb3dlckJvdW5kLAogICAgICAgIHVwcGVyQm91bmQKICAgICAgfSA9IF9yZWY7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IGVsZW1lbnRTaXplID0gdGhpcy5lbGVtZW50U2l6ZTsKICAgICAgbG93ZXJCb3VuZC5zZXQoeGkgKiBlbGVtZW50U2l6ZSwgeWkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWldKTsKICAgICAgdXBwZXJCb3VuZC5zZXQoKHhpICsgMSkgKiBlbGVtZW50U2l6ZSwgKHlpICsgMSkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aSArIDFdW3lpICsgMV0pOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGhlaWdodCBpbiB0aGUgaGVpZ2h0ZmllbGQgYXQgYSBnaXZlbiBwb3NpdGlvbgogICAgICovCgoKICAgIGdldEhlaWdodEF0KHgsIHksIGVkZ2VDbGFtcCkgewogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBjb25zdCBhID0gZ2V0SGVpZ2h0QXRfYTsKICAgICAgY29uc3QgYiA9IGdldEhlaWdodEF0X2I7CiAgICAgIGNvbnN0IGMgPSBnZXRIZWlnaHRBdF9jOwogICAgICBjb25zdCBpZHggPSBnZXRIZWlnaHRBdF9pZHg7CiAgICAgIHRoaXMuZ2V0SW5kZXhPZlBvc2l0aW9uKHgsIHksIGlkeCwgZWRnZUNsYW1wKTsKICAgICAgbGV0IHhpID0gaWR4WzBdOwogICAgICBsZXQgeWkgPSBpZHhbMV07CgogICAgICBpZiAoZWRnZUNsYW1wKSB7CiAgICAgICAgeGkgPSBNYXRoLm1pbihkYXRhLmxlbmd0aCAtIDIsIE1hdGgubWF4KDAsIHhpKSk7CiAgICAgICAgeWkgPSBNYXRoLm1pbihkYXRhWzBdLmxlbmd0aCAtIDIsIE1hdGgubWF4KDAsIHlpKSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHVwcGVyID0gdGhpcy5nZXRUcmlhbmdsZUF0KHgsIHksIGVkZ2VDbGFtcCwgYSwgYiwgYyk7CiAgICAgIGJhcnljZW50cmljV2VpZ2h0cyh4LCB5LCBhLngsIGEueSwgYi54LCBiLnksIGMueCwgYy55LCBnZXRIZWlnaHRBdF93ZWlnaHRzKTsKICAgICAgY29uc3QgdyA9IGdldEhlaWdodEF0X3dlaWdodHM7CgogICAgICBpZiAodXBwZXIpIHsKICAgICAgICAvLyBUb3AgdHJpYW5nbGUgdmVydHMKICAgICAgICByZXR1cm4gZGF0YVt4aSArIDFdW3lpICsgMV0gKiB3LnggKyBkYXRhW3hpXVt5aSArIDFdICogdy55ICsgZGF0YVt4aSArIDFdW3lpXSAqIHcuejsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBUb3AgdHJpYW5nbGUgdmVydHMKICAgICAgICByZXR1cm4gZGF0YVt4aV1beWldICogdy54ICsgZGF0YVt4aSArIDFdW3lpXSAqIHcueSArIGRhdGFbeGldW3lpICsgMV0gKiB3Lno7CiAgICAgIH0KICAgIH0KCiAgICBnZXRDYWNoZUNvbnZleFRyaWFuZ2xlUGlsbGFyS2V5KHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSkgewogICAgICByZXR1cm4gYCR7eGl9XyR7eWl9XyR7Z2V0VXBwZXJUcmlhbmdsZSA/IDEgOiAwfWA7CiAgICB9CgogICAgZ2V0Q2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKSB7CiAgICAgIHJldHVybiB0aGlzLl9jYWNoZWRQaWxsYXJzW3RoaXMuZ2V0Q2FjaGVDb252ZXhUcmlhbmdsZVBpbGxhcktleSh4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUpXTsKICAgIH0KCiAgICBzZXRDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUsIGNvbnZleCwgb2Zmc2V0KSB7CiAgICAgIHRoaXMuX2NhY2hlZFBpbGxhcnNbdGhpcy5nZXRDYWNoZUNvbnZleFRyaWFuZ2xlUGlsbGFyS2V5KHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSldID0gewogICAgICAgIGNvbnZleCwKICAgICAgICBvZmZzZXQKICAgICAgfTsKICAgIH0KCiAgICBjbGVhckNhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSkgewogICAgICBkZWxldGUgdGhpcy5fY2FjaGVkUGlsbGFyc1t0aGlzLmdldENhY2hlQ29udmV4VHJpYW5nbGVQaWxsYXJLZXkoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKV07CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIHRyaWFuZ2xlIGZyb20gdGhlIGhlaWdodGZpZWxkCiAgICAgKi8KCgogICAgZ2V0VHJpYW5nbGUoeGksIHlpLCB1cHBlciwgYSwgYiwgYykgewogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBjb25zdCBlbGVtZW50U2l6ZSA9IHRoaXMuZWxlbWVudFNpemU7CgogICAgICBpZiAodXBwZXIpIHsKICAgICAgICAvLyBUb3AgdHJpYW5nbGUgdmVydHMKICAgICAgICBhLnNldCgoeGkgKyAxKSAqIGVsZW1lbnRTaXplLCAoeWkgKyAxKSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpICsgMV1beWkgKyAxXSk7CiAgICAgICAgYi5zZXQoeGkgKiBlbGVtZW50U2l6ZSwgKHlpICsgMSkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWkgKyAxXSk7CiAgICAgICAgYy5zZXQoKHhpICsgMSkgKiBlbGVtZW50U2l6ZSwgeWkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aSArIDFdW3lpXSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gVG9wIHRyaWFuZ2xlIHZlcnRzCiAgICAgICAgYS5zZXQoeGkgKiBlbGVtZW50U2l6ZSwgeWkgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWldKTsKICAgICAgICBiLnNldCgoeGkgKyAxKSAqIGVsZW1lbnRTaXplLCB5aSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpICsgMV1beWldKTsKICAgICAgICBjLnNldCh4aSAqIGVsZW1lbnRTaXplLCAoeWkgKyAxKSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpXVt5aSArIDFdKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBHZXQgYSB0cmlhbmdsZSBpbiB0aGUgdGVycmFpbiBpbiB0aGUgZm9ybSBvZiBhIHRyaWFuZ3VsYXIgY29udmV4IHNoYXBlLgogICAgICovCgoKICAgIGdldENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSkgewogICAgICBsZXQgcmVzdWx0ID0gdGhpcy5waWxsYXJDb252ZXg7CiAgICAgIGxldCBvZmZzZXRSZXN1bHQgPSB0aGlzLnBpbGxhck9mZnNldDsKCiAgICAgIGlmICh0aGlzLmNhY2hlRW5hYmxlZCkgewogICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmdldENhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSk7CgogICAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgICB0aGlzLnBpbGxhckNvbnZleCA9IGRhdGEuY29udmV4OwogICAgICAgICAgdGhpcy5waWxsYXJPZmZzZXQgPSBkYXRhLm9mZnNldDsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHJlc3VsdCA9IG5ldyBDb252ZXhQb2x5aGVkcm9uKCk7CiAgICAgICAgb2Zmc2V0UmVzdWx0ID0gbmV3IFZlYzMoKTsKICAgICAgICB0aGlzLnBpbGxhckNvbnZleCA9IHJlc3VsdDsKICAgICAgICB0aGlzLnBpbGxhck9mZnNldCA9IG9mZnNldFJlc3VsdDsKICAgICAgfQoKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKICAgICAgY29uc3QgZWxlbWVudFNpemUgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBmYWNlcyA9IHJlc3VsdC5mYWNlczsgLy8gUmV1c2UgdmVydHMgaWYgcG9zc2libGUKCiAgICAgIHJlc3VsdC52ZXJ0aWNlcy5sZW5ndGggPSA2OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA2OyBpKyspIHsKICAgICAgICBpZiAoIXJlc3VsdC52ZXJ0aWNlc1tpXSkgewogICAgICAgICAgcmVzdWx0LnZlcnRpY2VzW2ldID0gbmV3IFZlYzMoKTsKICAgICAgICB9CiAgICAgIH0gLy8gUmV1c2UgZmFjZXMgaWYgcG9zc2libGUKCgogICAgICBmYWNlcy5sZW5ndGggPSA1OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA1OyBpKyspIHsKICAgICAgICBpZiAoIWZhY2VzW2ldKSB7CiAgICAgICAgICBmYWNlc1tpXSA9IFtdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgY29uc3QgdmVydHMgPSByZXN1bHQudmVydGljZXM7CiAgICAgIGNvbnN0IGggPSAoTWF0aC5taW4oZGF0YVt4aV1beWldLCBkYXRhW3hpICsgMV1beWldLCBkYXRhW3hpXVt5aSArIDFdLCBkYXRhW3hpICsgMV1beWkgKyAxXSkgLSB0aGlzLm1pblZhbHVlKSAvIDIgKyB0aGlzLm1pblZhbHVlOwoKICAgICAgaWYgKCFnZXRVcHBlclRyaWFuZ2xlKSB7CiAgICAgICAgLy8gQ2VudGVyIG9mIHRoZSB0cmlhbmdsZSBwaWxsYXIgLSBhbGwgcG9seWdvbnMgYXJlIGdpdmVuIHJlbGF0aXZlIHRvIHRoaXMgb25lCiAgICAgICAgb2Zmc2V0UmVzdWx0LnNldCgoeGkgKyAwLjI1KSAqIGVsZW1lbnRTaXplLCAvLyBzb3J0IG9mIGNlbnRlciBvZiBhIHRyaWFuZ2xlCiAgICAgICAgKHlpICsgMC4yNSkgKiBlbGVtZW50U2l6ZSwgaCAvLyB2ZXJ0aWNhbCBjZW50ZXIKICAgICAgICApOyAvLyBUb3AgdHJpYW5nbGUgdmVydHMKCiAgICAgICAgdmVydHNbMF0uc2V0KC0wLjI1ICogZWxlbWVudFNpemUsIC0wLjI1ICogZWxlbWVudFNpemUsIGRhdGFbeGldW3lpXSAtIGgpOwogICAgICAgIHZlcnRzWzFdLnNldCgwLjc1ICogZWxlbWVudFNpemUsIC0wLjI1ICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aV0gLSBoKTsKICAgICAgICB2ZXJ0c1syXS5zZXQoLTAuMjUgKiBlbGVtZW50U2l6ZSwgMC43NSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpXVt5aSArIDFdIC0gaCk7IC8vIGJvdHRvbSB0cmlhbmdsZSB2ZXJ0cwoKICAgICAgICB2ZXJ0c1szXS5zZXQoLTAuMjUgKiBlbGVtZW50U2l6ZSwgLTAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNF0uc2V0KDAuNzUgKiBlbGVtZW50U2l6ZSwgLTAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNV0uc2V0KC0wLjI1ICogZWxlbWVudFNpemUsIDAuNzUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7IC8vIHRvcCB0cmlhbmdsZQoKICAgICAgICBmYWNlc1swXVswXSA9IDA7CiAgICAgICAgZmFjZXNbMF1bMV0gPSAxOwogICAgICAgIGZhY2VzWzBdWzJdID0gMjsgLy8gYm90dG9tIHRyaWFuZ2xlCgogICAgICAgIGZhY2VzWzFdWzBdID0gNTsKICAgICAgICBmYWNlc1sxXVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbMV1bMl0gPSAzOyAvLyAteCBmYWNpbmcgcXVhZAoKICAgICAgICBmYWNlc1syXVswXSA9IDA7CiAgICAgICAgZmFjZXNbMl1bMV0gPSAyOwogICAgICAgIGZhY2VzWzJdWzJdID0gNTsKICAgICAgICBmYWNlc1syXVszXSA9IDM7IC8vIC15IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzNdWzBdID0gMTsKICAgICAgICBmYWNlc1szXVsxXSA9IDA7CiAgICAgICAgZmFjZXNbM11bMl0gPSAzOwogICAgICAgIGZhY2VzWzNdWzNdID0gNDsgLy8gK3h5IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzRdWzBdID0gNDsKICAgICAgICBmYWNlc1s0XVsxXSA9IDU7CiAgICAgICAgZmFjZXNbNF1bMl0gPSAyOwogICAgICAgIGZhY2VzWzRdWzNdID0gMTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBDZW50ZXIgb2YgdGhlIHRyaWFuZ2xlIHBpbGxhciAtIGFsbCBwb2x5Z29ucyBhcmUgZ2l2ZW4gcmVsYXRpdmUgdG8gdGhpcyBvbmUKICAgICAgICBvZmZzZXRSZXN1bHQuc2V0KCh4aSArIDAuNzUpICogZWxlbWVudFNpemUsIC8vIHNvcnQgb2YgY2VudGVyIG9mIGEgdHJpYW5nbGUKICAgICAgICAoeWkgKyAwLjc1KSAqIGVsZW1lbnRTaXplLCBoIC8vIHZlcnRpY2FsIGNlbnRlcgogICAgICAgICk7IC8vIFRvcCB0cmlhbmdsZSB2ZXJ0cwoKICAgICAgICB2ZXJ0c1swXS5zZXQoMC4yNSAqIGVsZW1lbnRTaXplLCAwLjI1ICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aSArIDFdIC0gaCk7CiAgICAgICAgdmVydHNbMV0uc2V0KC0wLjc1ICogZWxlbWVudFNpemUsIDAuMjUgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWkgKyAxXSAtIGgpOwogICAgICAgIHZlcnRzWzJdLnNldCgwLjI1ICogZWxlbWVudFNpemUsIC0wLjc1ICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aV0gLSBoKTsgLy8gYm90dG9tIHRyaWFuZ2xlIHZlcnRzCgogICAgICAgIHZlcnRzWzNdLnNldCgwLjI1ICogZWxlbWVudFNpemUsIDAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNF0uc2V0KC0wLjc1ICogZWxlbWVudFNpemUsIDAuMjUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7CiAgICAgICAgdmVydHNbNV0uc2V0KDAuMjUgKiBlbGVtZW50U2l6ZSwgLTAuNzUgKiBlbGVtZW50U2l6ZSwgLU1hdGguYWJzKGgpIC0gMSk7IC8vIFRvcCB0cmlhbmdsZQoKICAgICAgICBmYWNlc1swXVswXSA9IDA7CiAgICAgICAgZmFjZXNbMF1bMV0gPSAxOwogICAgICAgIGZhY2VzWzBdWzJdID0gMjsgLy8gYm90dG9tIHRyaWFuZ2xlCgogICAgICAgIGZhY2VzWzFdWzBdID0gNTsKICAgICAgICBmYWNlc1sxXVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbMV1bMl0gPSAzOyAvLyAreCBmYWNpbmcgcXVhZAoKICAgICAgICBmYWNlc1syXVswXSA9IDI7CiAgICAgICAgZmFjZXNbMl1bMV0gPSA1OwogICAgICAgIGZhY2VzWzJdWzJdID0gMzsKICAgICAgICBmYWNlc1syXVszXSA9IDA7IC8vICt5IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzNdWzBdID0gMzsKICAgICAgICBmYWNlc1szXVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbM11bMl0gPSAxOwogICAgICAgIGZhY2VzWzNdWzNdID0gMDsgLy8gLXh5IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzRdWzBdID0gMTsKICAgICAgICBmYWNlc1s0XVsxXSA9IDQ7CiAgICAgICAgZmFjZXNbNF1bMl0gPSA1OwogICAgICAgIGZhY2VzWzRdWzNdID0gMjsKICAgICAgfQoKICAgICAgcmVzdWx0LmNvbXB1dGVOb3JtYWxzKCk7CiAgICAgIHJlc3VsdC5jb21wdXRlRWRnZXMoKTsKICAgICAgcmVzdWx0LnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7CiAgICAgIHRoaXMuc2V0Q2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlLCByZXN1bHQsIG9mZnNldFJlc3VsdCk7CiAgICB9CgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB2b2lkIDApIHsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjMygpOwogICAgICB9CgogICAgICB0YXJnZXQuc2V0KDAsIDAsIDApOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuICgvLyBUaGUgdGVycmFpbiBpcyBpbmZpbml0ZQogICAgICAgIE51bWJlci5NQVhfVkFMVUUKICAgICAgKTsKICAgIH0KCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICAvKiogQFRPRE8gZG8gaXQgcHJvcGVybHkgKi8KICAgICAgbWluLnNldCgtTnVtYmVyLk1BWF9WQUxVRSwgLU51bWJlci5NQVhfVkFMVUUsIC1OdW1iZXIuTUFYX1ZBTFVFKTsKICAgICAgbWF4LnNldChOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFKTsKICAgIH0KCiAgICB1cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIHsKICAgICAgLy8gVXNlIHRoZSBib3VuZGluZyBib3ggb2YgdGhlIG1pbi9tYXggdmFsdWVzCiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IHMgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gbmV3IFZlYzMoZGF0YS5sZW5ndGggKiBzLCBkYXRhWzBdLmxlbmd0aCAqIHMsIE1hdGgubWF4KE1hdGguYWJzKHRoaXMubWF4VmFsdWUpLCBNYXRoLmFicyh0aGlzLm1pblZhbHVlKSkpLmxlbmd0aCgpOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBoZWlnaHQgdmFsdWVzIGZyb20gYW4gaW1hZ2UuIEN1cnJlbnRseSBvbmx5IHN1cHBvcnRlZCBpbiBicm93c2VyLgogICAgICovCgoKICAgIHNldEhlaWdodHNGcm9tSW1hZ2UoaW1hZ2UsIHNjYWxlKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICB4LAogICAgICAgIHosCiAgICAgICAgeQogICAgICB9ID0gc2NhbGU7CiAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOwogICAgICBjYW52YXMud2lkdGggPSBpbWFnZS53aWR0aDsKICAgICAgY2FudmFzLmhlaWdodCA9IGltYWdlLmhlaWdodDsKICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwogICAgICBjb250ZXh0LmRyYXdJbWFnZShpbWFnZSwgMCwgMCk7CiAgICAgIGNvbnN0IGltYWdlRGF0YSA9IGNvbnRleHQuZ2V0SW1hZ2VEYXRhKDAsIDAsIGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQpOwogICAgICBjb25zdCBtYXRyaXggPSB0aGlzLmRhdGE7CiAgICAgIG1hdHJpeC5sZW5ndGggPSAwOwogICAgICB0aGlzLmVsZW1lbnRTaXplID0gTWF0aC5hYnMoeCkgLyBpbWFnZURhdGEud2lkdGg7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGltYWdlRGF0YS5oZWlnaHQ7IGkrKykgewogICAgICAgIGNvbnN0IHJvdyA9IFtdOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGltYWdlRGF0YS53aWR0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCBhID0gaW1hZ2VEYXRhLmRhdGFbKGkgKiBpbWFnZURhdGEuaGVpZ2h0ICsgaikgKiA0XTsKICAgICAgICAgIGNvbnN0IGIgPSBpbWFnZURhdGEuZGF0YVsoaSAqIGltYWdlRGF0YS5oZWlnaHQgKyBqKSAqIDQgKyAxXTsKICAgICAgICAgIGNvbnN0IGMgPSBpbWFnZURhdGEuZGF0YVsoaSAqIGltYWdlRGF0YS5oZWlnaHQgKyBqKSAqIDQgKyAyXTsKICAgICAgICAgIGNvbnN0IGhlaWdodCA9IChhICsgYiArIGMpIC8gNCAvIDI1NSAqIHo7CgogICAgICAgICAgaWYgKHggPCAwKSB7CiAgICAgICAgICAgIHJvdy5wdXNoKGhlaWdodCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByb3cudW5zaGlmdChoZWlnaHQpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPCAwKSB7CiAgICAgICAgICBtYXRyaXgudW5zaGlmdChyb3cpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBtYXRyaXgucHVzaChyb3cpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVNYXhWYWx1ZSgpOwogICAgICB0aGlzLnVwZGF0ZU1pblZhbHVlKCk7CiAgICAgIHRoaXMudXBkYXRlKCk7CiAgICB9CgogIH0KICBjb25zdCBnZXRIZWlnaHRBdF9pZHggPSBbXTsKICBjb25zdCBnZXRIZWlnaHRBdF93ZWlnaHRzID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXRIZWlnaHRBdF9hID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXRIZWlnaHRBdF9iID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXRIZWlnaHRBdF9jID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9hID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9iID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9jID0gbmV3IFZlYzMoKTsKICBjb25zdCBnZXROb3JtYWxBdF9lMCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0Tm9ybWFsQXRfZTEgPSBuZXcgVmVjMygpOyAvLyBmcm9tIGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0JhcnljZW50cmljX2Nvb3JkaW5hdGVfc3lzdGVtCgogIGZ1bmN0aW9uIGJhcnljZW50cmljV2VpZ2h0cyh4LCB5LCBheCwgYXksIGJ4LCBieSwgY3gsIGN5LCByZXN1bHQpIHsKICAgIHJlc3VsdC54ID0gKChieSAtIGN5KSAqICh4IC0gY3gpICsgKGN4IC0gYngpICogKHkgLSBjeSkpIC8gKChieSAtIGN5KSAqIChheCAtIGN4KSArIChjeCAtIGJ4KSAqIChheSAtIGN5KSk7CiAgICByZXN1bHQueSA9ICgoY3kgLSBheSkgKiAoeCAtIGN4KSArIChheCAtIGN4KSAqICh5IC0gY3kpKSAvICgoYnkgLSBjeSkgKiAoYXggLSBjeCkgKyAoY3ggLSBieCkgKiAoYXkgLSBjeSkpOwogICAgcmVzdWx0LnogPSAxIC0gcmVzdWx0LnggLSByZXN1bHQueTsKICB9CgogIC8qKgogICAqIE9jdHJlZU5vZGUKICAgKi8KICBjbGFzcyBPY3RyZWVOb2RlIHsKICAgIC8qKiBUaGUgcm9vdCBub2RlICovCgogICAgLyoqIEJvdW5kYXJ5IG9mIHRoaXMgbm9kZSAqLwoKICAgIC8qKiBDb250YWluZWQgZGF0YSBhdCB0aGUgY3VycmVudCBub2RlIGxldmVsICovCgogICAgLyoqIENoaWxkcmVuIHRvIHRoaXMgbm9kZSAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICB0aGlzLnJvb3QgPSBvcHRpb25zLnJvb3QgfHwgbnVsbDsKICAgICAgdGhpcy5hYWJiID0gb3B0aW9ucy5hYWJiID8gb3B0aW9ucy5hYWJiLmNsb25lKCkgOiBuZXcgQUFCQigpOwogICAgICB0aGlzLmRhdGEgPSBbXTsKICAgICAgdGhpcy5jaGlsZHJlbiA9IFtdOwogICAgfQogICAgLyoqCiAgICAgKiByZXNldAogICAgICovCgoKICAgIHJlc2V0KCkgewogICAgICB0aGlzLmNoaWxkcmVuLmxlbmd0aCA9IHRoaXMuZGF0YS5sZW5ndGggPSAwOwogICAgfQogICAgLyoqCiAgICAgKiBJbnNlcnQgZGF0YSBpbnRvIHRoaXMgbm9kZQogICAgICogQHJldHVybiBUcnVlIGlmIHN1Y2Nlc3NmdWwsIG90aGVyd2lzZSBmYWxzZQogICAgICovCgoKICAgIGluc2VydChhYWJiLCBlbGVtZW50RGF0YSwgbGV2ZWwpIHsKICAgICAgaWYgKGxldmVsID09PSB2b2lkIDApIHsKICAgICAgICBsZXZlbCA9IDA7CiAgICAgIH0KCiAgICAgIGNvbnN0IG5vZGVEYXRhID0gdGhpcy5kYXRhOyAvLyBJZ25vcmUgb2JqZWN0cyB0aGF0IGRvIG5vdCBiZWxvbmcgaW4gdGhpcyBub2RlCgogICAgICBpZiAoIXRoaXMuYWFiYi5jb250YWlucyhhYWJiKSkgewogICAgICAgIHJldHVybiBmYWxzZTsgLy8gb2JqZWN0IGNhbm5vdCBiZSBhZGRlZAogICAgICB9CgogICAgICBjb25zdCBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47CiAgICAgIGNvbnN0IG1heERlcHRoID0gdGhpcy5tYXhEZXB0aCB8fCB0aGlzLnJvb3QubWF4RGVwdGg7CgogICAgICBpZiAobGV2ZWwgPCBtYXhEZXB0aCkgewogICAgICAgIC8vIFN1YmRpdmlkZSBpZiB0aGVyZSBhcmUgbm8gY2hpbGRyZW4geWV0CiAgICAgICAgbGV0IHN1YmRpdmlkZWQgPSBmYWxzZTsKCiAgICAgICAgaWYgKCFjaGlsZHJlbi5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuc3ViZGl2aWRlKCk7CiAgICAgICAgICBzdWJkaXZpZGVkID0gdHJ1ZTsKICAgICAgICB9IC8vIGFkZCB0byB3aGljaGV2ZXIgbm9kZSB3aWxsIGFjY2VwdCBpdAoKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDg7IGkrKykgewogICAgICAgICAgaWYgKGNoaWxkcmVuW2ldLmluc2VydChhYWJiLCBlbGVtZW50RGF0YSwgbGV2ZWwgKyAxKSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChzdWJkaXZpZGVkKSB7CiAgICAgICAgICAvLyBObyBjaGlsZHJlbiBhY2NlcHRlZCEgTWlnaHQgYXMgd2VsbCBqdXN0IHJlbW92ZSBlbSBzaW5jZSB0aGV5IGNvbnRhaW4gbm9uZQogICAgICAgICAgY2hpbGRyZW4ubGVuZ3RoID0gMDsKICAgICAgICB9CiAgICAgIH0gLy8gVG9vIGRlZXAsIG9yIGNoaWxkcmVuIGRpZG50IHdhbnQgaXQuIGFkZCBpdCBpbiBjdXJyZW50IG5vZGUKCgogICAgICBub2RlRGF0YS5wdXNoKGVsZW1lbnREYXRhKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIENyZWF0ZSA4IGVxdWFsbHkgc2l6ZWQgY2hpbGRyZW4gbm9kZXMgYW5kIHB1dCB0aGVtIGluIHRoZSBgY2hpbGRyZW5gIGFycmF5LgogICAgICovCgoKICAgIHN1YmRpdmlkZSgpIHsKICAgICAgY29uc3QgYWFiYiA9IHRoaXMuYWFiYjsKICAgICAgY29uc3QgbCA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IGFhYmIudXBwZXJCb3VuZDsKICAgICAgY29uc3QgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuOwogICAgICBjaGlsZHJlbi5wdXNoKG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygwLCAwLCAwKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMSwgMCwgMCkKICAgICAgICB9KQogICAgICB9KSwgbmV3IE9jdHJlZU5vZGUoewogICAgICAgIGFhYmI6IG5ldyBBQUJCKHsKICAgICAgICAgIGxvd2VyQm91bmQ6IG5ldyBWZWMzKDEsIDEsIDApCiAgICAgICAgfSkKICAgICAgfSksIG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygxLCAxLCAxKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMCwgMSwgMSkKICAgICAgICB9KQogICAgICB9KSwgbmV3IE9jdHJlZU5vZGUoewogICAgICAgIGFhYmI6IG5ldyBBQUJCKHsKICAgICAgICAgIGxvd2VyQm91bmQ6IG5ldyBWZWMzKDAsIDAsIDEpCiAgICAgICAgfSkKICAgICAgfSksIG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygxLCAwLCAxKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMCwgMSwgMCkKICAgICAgICB9KQogICAgICB9KSk7CiAgICAgIHUudnN1YihsLCBoYWxmRGlhZ29uYWwpOwogICAgICBoYWxmRGlhZ29uYWwuc2NhbGUoMC41LCBoYWxmRGlhZ29uYWwpOwogICAgICBjb25zdCByb290ID0gdGhpcy5yb290IHx8IHRoaXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gODsgaSsrKSB7CiAgICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZHJlbltpXTsgLy8gU2V0IGN1cnJlbnQgbm9kZSBhcyByb290CgogICAgICAgIGNoaWxkLnJvb3QgPSByb290OyAvLyBDb21wdXRlIGJvdW5kcwoKICAgICAgICBjb25zdCBsb3dlckJvdW5kID0gY2hpbGQuYWFiYi5sb3dlckJvdW5kOwogICAgICAgIGxvd2VyQm91bmQueCAqPSBoYWxmRGlhZ29uYWwueDsKICAgICAgICBsb3dlckJvdW5kLnkgKj0gaGFsZkRpYWdvbmFsLnk7CiAgICAgICAgbG93ZXJCb3VuZC56ICo9IGhhbGZEaWFnb25hbC56OwogICAgICAgIGxvd2VyQm91bmQudmFkZChsLCBsb3dlckJvdW5kKTsgLy8gVXBwZXIgYm91bmQgaXMgYWx3YXlzIGxvd2VyIGJvdW5kICsgaGFsZkRpYWdvbmFsCgogICAgICAgIGxvd2VyQm91bmQudmFkZChoYWxmRGlhZ29uYWwsIGNoaWxkLmFhYmIudXBwZXJCb3VuZCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogR2V0IGFsbCBkYXRhLCBwb3RlbnRpYWxseSB3aXRoaW4gYW4gQUFCQgogICAgICogQHJldHVybiBUaGUgInJlc3VsdCIgb2JqZWN0CiAgICAgKi8KCgogICAgYWFiYlF1ZXJ5KGFhYmIsIHJlc3VsdCkgewogICAgICB0aGlzLmRhdGE7IC8vIGFib3J0IGlmIHRoZSByYW5nZSBkb2VzIG5vdCBpbnRlcnNlY3QgdGhpcyBub2RlCiAgICAgIC8vIGlmICghdGhpcy5hYWJiLm92ZXJsYXBzKGFhYmIpKXsKICAgICAgLy8gICAgIHJldHVybiByZXN1bHQ7CiAgICAgIC8vIH0KICAgICAgLy8gQWRkIG9iamVjdHMgYXQgdGhpcyBsZXZlbAogICAgICAvLyBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShyZXN1bHQsIG5vZGVEYXRhKTsKICAgICAgLy8gQWRkIGNoaWxkIGRhdGEKICAgICAgLy8gQHRvZG8gdW53cmFwIHJlY3Vyc2lvbiBpbnRvIGEgcXVldWUgLyBsb29wLCB0aGF0J3MgZmFzdGVyIGluIEpTCgogICAgICB0aGlzLmNoaWxkcmVuOyAvLyBmb3IgKGxldCBpID0gMCwgTiA9IHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyBpICE9PSBOOyBpKyspIHsKICAgICAgLy8gICAgIGNoaWxkcmVuW2ldLmFhYmJRdWVyeShhYWJiLCByZXN1bHQpOwogICAgICAvLyB9CgogICAgICBjb25zdCBxdWV1ZSA9IFt0aGlzXTsKCiAgICAgIHdoaWxlIChxdWV1ZS5sZW5ndGgpIHsKICAgICAgICBjb25zdCBub2RlID0gcXVldWUucG9wKCk7CgogICAgICAgIGlmIChub2RlLmFhYmIub3ZlcmxhcHMoYWFiYikpIHsKICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHJlc3VsdCwgbm9kZS5kYXRhKTsKICAgICAgICB9CgogICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHF1ZXVlLCBub2RlLmNoaWxkcmVuKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFsbCBkYXRhLCBwb3RlbnRpYWxseSBpbnRlcnNlY3RlZCBieSBhIHJheS4KICAgICAqIEByZXR1cm4gVGhlICJyZXN1bHQiIG9iamVjdAogICAgICovCgoKICAgIHJheVF1ZXJ5KHJheSwgdHJlZVRyYW5zZm9ybSwgcmVzdWx0KSB7CiAgICAgIC8vIFVzZSBhYWJiIHF1ZXJ5IGZvciBub3cuCgogICAgICAvKiogQHRvZG8gaW1wbGVtZW50IHJlYWwgcmF5IHF1ZXJ5IHdoaWNoIG5lZWRzIGxlc3MgbG9va3VwcyAqLwogICAgICByYXkuZ2V0QUFCQih0bXBBQUJCKTsKICAgICAgdG1wQUFCQi50b0xvY2FsRnJhbWUodHJlZVRyYW5zZm9ybSwgdG1wQUFCQik7CiAgICAgIHRoaXMuYWFiYlF1ZXJ5KHRtcEFBQkIsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIHJlbW92ZUVtcHR5Tm9kZXMKICAgICAqLwoKCiAgICByZW1vdmVFbXB0eU5vZGVzKCkgewogICAgICBmb3IgKGxldCBpID0gdGhpcy5jaGlsZHJlbi5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgIHRoaXMuY2hpbGRyZW5baV0ucmVtb3ZlRW1wdHlOb2RlcygpOwoKICAgICAgICBpZiAoIXRoaXMuY2hpbGRyZW5baV0uY2hpbGRyZW4ubGVuZ3RoICYmICF0aGlzLmNoaWxkcmVuW2ldLmRhdGEubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmNoaWxkcmVuLnNwbGljZShpLCAxKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgfQogIC8qKgogICAqIE9jdHJlZQogICAqLwoKCiAgY2xhc3MgT2N0cmVlIGV4dGVuZHMgT2N0cmVlTm9kZSB7CiAgICAvKioKICAgICAqIE1heGltdW0gc3ViZGl2aXNpb24gZGVwdGgKICAgICAqIEBkZWZhdWx0IDgKICAgICAqLwoKICAgIC8qKgogICAgICogQHBhcmFtIGFhYmIgVGhlIHRvdGFsIEFBQkIgb2YgdGhlIHRyZWUKICAgICAqLwogICAgY29uc3RydWN0b3IoYWFiYiwgb3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBzdXBlcih7CiAgICAgICAgcm9vdDogbnVsbCwKICAgICAgICBhYWJiCiAgICAgIH0pOwogICAgICB0aGlzLm1heERlcHRoID0gdHlwZW9mIG9wdGlvbnMubWF4RGVwdGggIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5tYXhEZXB0aCA6IDg7CiAgICB9CgogIH0KICBjb25zdCBoYWxmRGlhZ29uYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcEFBQkIgPSBuZXcgQUFCQigpOwoKICAvKioKICAgKiBUcmltZXNoLgogICAqIEBleGFtcGxlCiAgICogICAgIC8vIEhvdyB0byBtYWtlIGEgbWVzaCB3aXRoIGEgc2luZ2xlIHRyaWFuZ2xlCiAgICogICAgIGNvbnN0IHZlcnRpY2VzID0gWwogICAqICAgICAgICAgMCwgMCwgMCwgLy8gdmVydGV4IDAKICAgKiAgICAgICAgIDEsIDAsIDAsIC8vIHZlcnRleCAxCiAgICogICAgICAgICAwLCAxLCAwICAvLyB2ZXJ0ZXggMgogICAqICAgICBdCiAgICogICAgIGNvbnN0IGluZGljZXMgPSBbCiAgICogICAgICAgICAwLCAxLCAyICAvLyB0cmlhbmdsZSAwCiAgICogICAgIF0KICAgKiAgICAgY29uc3QgdHJpbWVzaFNoYXBlID0gbmV3IENBTk5PTi5UcmltZXNoKHZlcnRpY2VzLCBpbmRpY2VzKQogICAqLwogIGNsYXNzIFRyaW1lc2ggZXh0ZW5kcyBTaGFwZSB7CiAgICAvKioKICAgICAqIHZlcnRpY2VzCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFycmF5IG9mIGludGVnZXJzLCBpbmRpY2F0aW5nIHdoaWNoIHZlcnRpY2VzIGVhY2ggdHJpYW5nbGUgY29uc2lzdHMgb2YuIFRoZSBsZW5ndGggb2YgdGhpcyBhcnJheSBpcyB0aHVzIDMgdGltZXMgdGhlIG51bWJlciBvZiB0cmlhbmdsZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBub3JtYWxzIGRhdGEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBsb2NhbCBBQUJCIG9mIHRoZSBtZXNoLgogICAgICovCgogICAgLyoqCiAgICAgKiBSZWZlcmVuY2VzIHRvIHZlcnRleCBwYWlycywgbWFraW5nIHVwIGFsbCB1bmlxdWUgZWRnZXMgaW4gdGhlIHRyaW1lc2guCiAgICAgKi8KCiAgICAvKioKICAgICAqIExvY2FsIHNjYWxpbmcgb2YgdGhlIG1lc2guIFVzZSAuc2V0U2NhbGUoKSB0byBzZXQgaXQuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBpbmRleGVkIHRyaWFuZ2xlcy4gVXNlIC51cGRhdGVUcmVlKCkgdG8gdXBkYXRlIGl0LgogICAgICovCiAgICBjb25zdHJ1Y3Rvcih2ZXJ0aWNlcywgaW5kaWNlcykgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuVFJJTUVTSAogICAgICB9KTsKICAgICAgdGhpcy52ZXJ0aWNlcyA9IG5ldyBGbG9hdDMyQXJyYXkodmVydGljZXMpOwogICAgICB0aGlzLmluZGljZXMgPSBuZXcgSW50MTZBcnJheShpbmRpY2VzKTsKICAgICAgdGhpcy5ub3JtYWxzID0gbmV3IEZsb2F0MzJBcnJheShpbmRpY2VzLmxlbmd0aCk7CiAgICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7CiAgICAgIHRoaXMuZWRnZXMgPSBudWxsOwogICAgICB0aGlzLnNjYWxlID0gbmV3IFZlYzMoMSwgMSwgMSk7CiAgICAgIHRoaXMudHJlZSA9IG5ldyBPY3RyZWUoKTsKICAgICAgdGhpcy51cGRhdGVFZGdlcygpOwogICAgICB0aGlzLnVwZGF0ZU5vcm1hbHMoKTsKICAgICAgdGhpcy51cGRhdGVBQUJCKCk7CiAgICAgIHRoaXMudXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKTsKICAgICAgdGhpcy51cGRhdGVUcmVlKCk7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZVRyZWUKICAgICAqLwoKCiAgICB1cGRhdGVUcmVlKCkgewogICAgICBjb25zdCB0cmVlID0gdGhpcy50cmVlOwogICAgICB0cmVlLnJlc2V0KCk7CiAgICAgIHRyZWUuYWFiYi5jb3B5KHRoaXMuYWFiYik7CiAgICAgIGNvbnN0IHNjYWxlID0gdGhpcy5zY2FsZTsgLy8gVGhlIGxvY2FsIG1lc2ggQUFCQiBpcyBzY2FsZWQsIGJ1dCB0aGUgb2N0cmVlIEFBQkIgc2hvdWxkIGJlIHVuc2NhbGVkCgogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC54ICo9IDEgLyBzY2FsZS54OwogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC55ICo9IDEgLyBzY2FsZS55OwogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC56ICo9IDEgLyBzY2FsZS56OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC54ICo9IDEgLyBzY2FsZS54OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC55ICo9IDEgLyBzY2FsZS55OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC56ICo9IDEgLyBzY2FsZS56OyAvLyBJbnNlcnQgYWxsIHRyaWFuZ2xlcwoKICAgICAgY29uc3QgdHJpYW5nbGVBQUJCID0gbmV3IEFBQkIoKTsKICAgICAgY29uc3QgYSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGIgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBjID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcG9pbnRzID0gW2EsIGIsIGNdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgLy90aGlzLmdldFRyaWFuZ2xlVmVydGljZXMoaSwgYSwgYiwgYyk7CiAgICAgICAgLy8gR2V0IHVuc2NhbGVkIHRyaWFuZ2xlIHZlcnRzCiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKCiAgICAgICAgdGhpcy5fZ2V0VW5zY2FsZWRWZXJ0ZXgodGhpcy5pbmRpY2VzW2kzXSwgYSk7CgogICAgICAgIHRoaXMuX2dldFVuc2NhbGVkVmVydGV4KHRoaXMuaW5kaWNlc1tpMyArIDFdLCBiKTsKCiAgICAgICAgdGhpcy5fZ2V0VW5zY2FsZWRWZXJ0ZXgodGhpcy5pbmRpY2VzW2kzICsgMl0sIGMpOwoKICAgICAgICB0cmlhbmdsZUFBQkIuc2V0RnJvbVBvaW50cyhwb2ludHMpOwogICAgICAgIHRyZWUuaW5zZXJ0KHRyaWFuZ2xlQUFCQiwgaSk7CiAgICAgIH0KCiAgICAgIHRyZWUucmVtb3ZlRW1wdHlOb2RlcygpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdHJpYW5nbGVzIGluIGEgbG9jYWwgQUFCQiBmcm9tIHRoZSB0cmltZXNoLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSBvZiBpbnRlZ2VycywgcmVmZXJlbmNpbmcgdGhlIHF1ZXJpZWQgdHJpYW5nbGVzLgogICAgICovCgoKICAgIGdldFRyaWFuZ2xlc0luQUFCQihhYWJiLCByZXN1bHQpIHsKICAgICAgdW5zY2FsZWRBQUJCLmNvcHkoYWFiYik7IC8vIFNjYWxlIGl0IHRvIGxvY2FsCgogICAgICBjb25zdCBzY2FsZSA9IHRoaXMuc2NhbGU7CiAgICAgIGNvbnN0IGlzeCA9IHNjYWxlLng7CiAgICAgIGNvbnN0IGlzeSA9IHNjYWxlLnk7CiAgICAgIGNvbnN0IGlzeiA9IHNjYWxlLno7CiAgICAgIGNvbnN0IGwgPSB1bnNjYWxlZEFBQkIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IHVuc2NhbGVkQUFCQi51cHBlckJvdW5kOwogICAgICBsLnggLz0gaXN4OwogICAgICBsLnkgLz0gaXN5OwogICAgICBsLnogLz0gaXN6OwogICAgICB1LnggLz0gaXN4OwogICAgICB1LnkgLz0gaXN5OwogICAgICB1LnogLz0gaXN6OwogICAgICByZXR1cm4gdGhpcy50cmVlLmFhYmJRdWVyeSh1bnNjYWxlZEFBQkIsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIHNldFNjYWxlCiAgICAgKi8KCgogICAgc2V0U2NhbGUoc2NhbGUpIHsKICAgICAgY29uc3Qgd2FzVW5pZm9ybSA9IHRoaXMuc2NhbGUueCA9PT0gdGhpcy5zY2FsZS55ICYmIHRoaXMuc2NhbGUueSA9PT0gdGhpcy5zY2FsZS56OwogICAgICBjb25zdCBpc1VuaWZvcm0gPSBzY2FsZS54ID09PSBzY2FsZS55ICYmIHNjYWxlLnkgPT09IHNjYWxlLno7CgogICAgICBpZiAoISh3YXNVbmlmb3JtICYmIGlzVW5pZm9ybSkpIHsKICAgICAgICAvLyBOb24tdW5pZm9ybSBzY2FsaW5nLiBOZWVkIHRvIHVwZGF0ZSBub3JtYWxzLgogICAgICAgIHRoaXMudXBkYXRlTm9ybWFscygpOwogICAgICB9CgogICAgICB0aGlzLnNjYWxlLmNvcHkoc2NhbGUpOwogICAgICB0aGlzLnVwZGF0ZUFBQkIoKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlIHRoZSBub3JtYWxzIG9mIHRoZSBmYWNlcy4gV2lsbCBzYXZlIGluIHRoZSBgLm5vcm1hbHNgIGFycmF5LgogICAgICovCgoKICAgIHVwZGF0ZU5vcm1hbHMoKSB7CiAgICAgIGNvbnN0IG4gPSBjb21wdXRlTm9ybWFsc19uOyAvLyBHZW5lcmF0ZSBub3JtYWxzCgogICAgICBjb25zdCBub3JtYWxzID0gdGhpcy5ub3JtYWxzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKICAgICAgICBjb25zdCBhID0gdGhpcy5pbmRpY2VzW2kzXTsKICAgICAgICBjb25zdCBiID0gdGhpcy5pbmRpY2VzW2kzICsgMV07CiAgICAgICAgY29uc3QgYyA9IHRoaXMuaW5kaWNlc1tpMyArIDJdOwogICAgICAgIHRoaXMuZ2V0VmVydGV4KGEsIHZhKTsKICAgICAgICB0aGlzLmdldFZlcnRleChiLCB2Yik7CiAgICAgICAgdGhpcy5nZXRWZXJ0ZXgoYywgdmMpOwogICAgICAgIFRyaW1lc2guY29tcHV0ZU5vcm1hbCh2YiwgdmEsIHZjLCBuKTsKICAgICAgICBub3JtYWxzW2kzXSA9IG4ueDsKICAgICAgICBub3JtYWxzW2kzICsgMV0gPSBuLnk7CiAgICAgICAgbm9ybWFsc1tpMyArIDJdID0gbi56OwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFVwZGF0ZSB0aGUgYC5lZGdlc2AgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVFZGdlcygpIHsKICAgICAgY29uc3QgZWRnZXMgPSB7fTsKCiAgICAgIGNvbnN0IGFkZCA9IChhLCBiKSA9PiB7CiAgICAgICAgY29uc3Qga2V5ID0gYSA8IGIgPyBgJHthfV8ke2J9YCA6IGAke2J9XyR7YX1gOwogICAgICAgIGVkZ2VzW2tleV0gPSB0cnVlOwogICAgICB9OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKICAgICAgICBjb25zdCBhID0gdGhpcy5pbmRpY2VzW2kzXTsKICAgICAgICBjb25zdCBiID0gdGhpcy5pbmRpY2VzW2kzICsgMV07CiAgICAgICAgY29uc3QgYyA9IHRoaXMuaW5kaWNlc1tpMyArIDJdOwogICAgICAgIGFkZChhLCBiKTsKICAgICAgICBhZGQoYiwgYyk7CiAgICAgICAgYWRkKGMsIGEpOwogICAgICB9CgogICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoZWRnZXMpOwogICAgICB0aGlzLmVkZ2VzID0gbmV3IEludDE2QXJyYXkoa2V5cy5sZW5ndGggKiAyKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGluZGljZXMgPSBrZXlzW2ldLnNwbGl0KCdfJyk7CiAgICAgICAgdGhpcy5lZGdlc1syICogaV0gPSBwYXJzZUludChpbmRpY2VzWzBdLCAxMCk7CiAgICAgICAgdGhpcy5lZGdlc1syICogaSArIDFdID0gcGFyc2VJbnQoaW5kaWNlc1sxXSwgMTApOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBlZGdlIHZlcnRleAogICAgICogQHBhcmFtIGZpcnN0T3JTZWNvbmQgMCBvciAxLCBkZXBlbmRpbmcgb24gd2hpY2ggb25lIG9mIHRoZSB2ZXJ0aWNlcyB5b3UgbmVlZC4KICAgICAqIEBwYXJhbSB2ZXJ0ZXhTdG9yZSBXaGVyZSB0byBzdG9yZSB0aGUgcmVzdWx0CiAgICAgKi8KCgogICAgZ2V0RWRnZVZlcnRleChlZGdlSW5kZXgsIGZpcnN0T3JTZWNvbmQsIHZlcnRleFN0b3JlKSB7CiAgICAgIGNvbnN0IHZlcnRleEluZGV4ID0gdGhpcy5lZGdlc1tlZGdlSW5kZXggKiAyICsgKGZpcnN0T3JTZWNvbmQgPyAxIDogMCldOwogICAgICB0aGlzLmdldFZlcnRleCh2ZXJ0ZXhJbmRleCwgdmVydGV4U3RvcmUpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgYSB2ZWN0b3IgYWxvbmcgYW4gZWRnZS4KICAgICAqLwoKCiAgICBnZXRFZGdlVmVjdG9yKGVkZ2VJbmRleCwgdmVjdG9yU3RvcmUpIHsKICAgICAgY29uc3QgdmEgPSBnZXRFZGdlVmVjdG9yX3ZhOwogICAgICBjb25zdCB2YiA9IGdldEVkZ2VWZWN0b3JfdmI7CiAgICAgIHRoaXMuZ2V0RWRnZVZlcnRleChlZGdlSW5kZXgsIDAsIHZhKTsKICAgICAgdGhpcy5nZXRFZGdlVmVydGV4KGVkZ2VJbmRleCwgMSwgdmIpOwogICAgICB2Yi52c3ViKHZhLCB2ZWN0b3JTdG9yZSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBmYWNlIG5vcm1hbCBnaXZlbiAzIHZlcnRpY2VzCiAgICAgKi8KCgogICAgc3RhdGljIGNvbXB1dGVOb3JtYWwodmEsIHZiLCB2YywgdGFyZ2V0KSB7CiAgICAgIHZiLnZzdWIodmEsIGFiKTsKICAgICAgdmMudnN1Yih2YiwgY2IpOwogICAgICBjYi5jcm9zcyhhYiwgdGFyZ2V0KTsKCiAgICAgIGlmICghdGFyZ2V0LmlzWmVybygpKSB7CiAgICAgICAgdGFyZ2V0Lm5vcm1hbGl6ZSgpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCB2ZXJ0ZXggaS4KICAgICAqIEByZXR1cm4gVGhlICJvdXQiIHZlY3RvciBvYmplY3QKICAgICAqLwoKCiAgICBnZXRWZXJ0ZXgoaSwgb3V0KSB7CiAgICAgIGNvbnN0IHNjYWxlID0gdGhpcy5zY2FsZTsKCiAgICAgIHRoaXMuX2dldFVuc2NhbGVkVmVydGV4KGksIG91dCk7CgogICAgICBvdXQueCAqPSBzY2FsZS54OwogICAgICBvdXQueSAqPSBzY2FsZS55OwogICAgICBvdXQueiAqPSBzY2FsZS56OwogICAgICByZXR1cm4gb3V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgcmF3IHZlcnRleCBpCiAgICAgKiBAcmV0dXJuIFRoZSAib3V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgX2dldFVuc2NhbGVkVmVydGV4KGksIG91dCkgewogICAgICBjb25zdCBpMyA9IGkgKiAzOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIHJldHVybiBvdXQuc2V0KHZlcnRpY2VzW2kzXSwgdmVydGljZXNbaTMgKyAxXSwgdmVydGljZXNbaTMgKyAyXSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIHZlcnRleCBmcm9tIHRoZSB0cmltZXNoLHRyYW5zZm9ybWVkIGJ5IHRoZSBnaXZlbiBwb3NpdGlvbiBhbmQgcXVhdGVybmlvbi4KICAgICAqIEByZXR1cm4gVGhlICJvdXQiIHZlY3RvciBvYmplY3QKICAgICAqLwoKCiAgICBnZXRXb3JsZFZlcnRleChpLCBwb3MsIHF1YXQsIG91dCkgewogICAgICB0aGlzLmdldFZlcnRleChpLCBvdXQpOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zLCBxdWF0LCBvdXQsIG91dCk7CiAgICAgIHJldHVybiBvdXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgdGhyZWUgdmVydGljZXMgZm9yIHRyaWFuZ2xlIGkuCiAgICAgKi8KCgogICAgZ2V0VHJpYW5nbGVWZXJ0aWNlcyhpLCBhLCBiLCBjKSB7CiAgICAgIGNvbnN0IGkzID0gaSAqIDM7CiAgICAgIHRoaXMuZ2V0VmVydGV4KHRoaXMuaW5kaWNlc1tpM10sIGEpOwogICAgICB0aGlzLmdldFZlcnRleCh0aGlzLmluZGljZXNbaTMgKyAxXSwgYik7CiAgICAgIHRoaXMuZ2V0VmVydGV4KHRoaXMuaW5kaWNlc1tpMyArIDJdLCBjKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbm9ybWFsIG9mIHRyaWFuZ2xlIGkuCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgZ2V0Tm9ybWFsKGksIHRhcmdldCkgewogICAgICBjb25zdCBpMyA9IGkgKiAzOwogICAgICByZXR1cm4gdGFyZ2V0LnNldCh0aGlzLm5vcm1hbHNbaTNdLCB0aGlzLm5vcm1hbHNbaTMgKyAxXSwgdGhpcy5ub3JtYWxzW2kzICsgMl0pOwogICAgfQogICAgLyoqCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICAvLyBBcHByb3hpbWF0ZSB3aXRoIGJveCBpbmVydGlhCiAgICAgIC8vIEV4YWN0IGluZXJ0aWEgY2FsY3VsYXRpb24gaXMgb3ZlcmtpbGwsIGJ1dCBzZWUgaHR0cDovL2dlb21ldHJpY3Rvb2xzLmNvbS9Eb2N1bWVudGF0aW9uL1BvbHloZWRyYWxNYXNzUHJvcGVydGllcy5wZGYgZm9yIHRoZSBjb3JyZWN0IHdheSB0byBkbyBpdAogICAgICB0aGlzLmNvbXB1dGVMb2NhbEFBQkIoY2xpX2FhYmIpOwogICAgICBjb25zdCB4ID0gY2xpX2FhYmIudXBwZXJCb3VuZC54IC0gY2xpX2FhYmIubG93ZXJCb3VuZC54OwogICAgICBjb25zdCB5ID0gY2xpX2FhYmIudXBwZXJCb3VuZC55IC0gY2xpX2FhYmIubG93ZXJCb3VuZC55OwogICAgICBjb25zdCB6ID0gY2xpX2FhYmIudXBwZXJCb3VuZC56IC0gY2xpX2FhYmIubG93ZXJCb3VuZC56OwogICAgICByZXR1cm4gdGFyZ2V0LnNldCgxLjAgLyAxMi4wICogbWFzcyAqICgyICogeSAqIDIgKiB5ICsgMiAqIHogKiAyICogeiksIDEuMCAvIDEyLjAgKiBtYXNzICogKDIgKiB4ICogMiAqIHggKyAyICogeiAqIDIgKiB6KSwgMS4wIC8gMTIuMCAqIG1hc3MgKiAoMiAqIHkgKiAyICogeSArIDIgKiB4ICogMiAqIHgpKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbG9jYWwgQUFCQiBmb3IgdGhlIHRyaW1lc2gKICAgICAqLwoKCiAgICBjb21wdXRlTG9jYWxBQUJCKGFhYmIpIHsKICAgICAgY29uc3QgbCA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IGFhYmIudXBwZXJCb3VuZDsKICAgICAgY29uc3QgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoOwogICAgICB0aGlzLnZlcnRpY2VzOwogICAgICBjb25zdCB2ID0gY29tcHV0ZUxvY2FsQUFCQl93b3JsZFZlcnQ7CiAgICAgIHRoaXMuZ2V0VmVydGV4KDAsIHYpOwogICAgICBsLmNvcHkodik7CiAgICAgIHUuY29weSh2KTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBuOyBpKyspIHsKICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKCiAgICAgICAgaWYgKHYueCA8IGwueCkgewogICAgICAgICAgbC54ID0gdi54OwogICAgICAgIH0gZWxzZSBpZiAodi54ID4gdS54KSB7CiAgICAgICAgICB1LnggPSB2Lng7CiAgICAgICAgfQoKICAgICAgICBpZiAodi55IDwgbC55KSB7CiAgICAgICAgICBsLnkgPSB2Lnk7CiAgICAgICAgfSBlbHNlIGlmICh2LnkgPiB1LnkpIHsKICAgICAgICAgIHUueSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmICh2LnogPCBsLnopIHsKICAgICAgICAgIGwueiA9IHYuejsKICAgICAgICB9IGVsc2UgaWYgKHYueiA+IHUueikgewogICAgICAgICAgdS56ID0gdi56OwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgdGhlIGAuYWFiYmAgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVBQUJCKCkgewogICAgICB0aGlzLmNvbXB1dGVMb2NhbEFBQkIodGhpcy5hYWJiKTsKICAgIH0KICAgIC8qKgogICAgICogV2lsbCB1cGRhdGUgdGhlIGAuYm91bmRpbmdTcGhlcmVSYWRpdXNgIHByb3BlcnR5CiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIC8vIEFzc3VtZSBwb2ludHMgYXJlIGRpc3RyaWJ1dGVkIHdpdGggbG9jYWwgKDAsMCwwKSBhcyBjZW50ZXIKICAgICAgbGV0IG1heDIgPSAwOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIGNvbnN0IHYgPSBuZXcgVmVjMygpOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIE4gPSB2ZXJ0aWNlcy5sZW5ndGggLyAzOyBpICE9PSBOOyBpKyspIHsKICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKICAgICAgICBjb25zdCBub3JtMiA9IHYubGVuZ3RoU3F1YXJlZCgpOwoKICAgICAgICBpZiAobm9ybTIgPiBtYXgyKSB7CiAgICAgICAgICBtYXgyID0gbm9ybTI7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gTWF0aC5zcXJ0KG1heDIpOwogICAgfQogICAgLyoqCiAgICAgKiBjYWxjdWxhdGVXb3JsZEFBQkIKICAgICAqLwoKCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICAvKgogICAgICAgICAgY29uc3QgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoIC8gMywKICAgICAgICAgICAgICB2ZXJ0cyA9IHRoaXMudmVydGljZXM7CiAgICAgICAgICBjb25zdCBtaW54LG1pbnksbWlueixtYXh4LG1heHksbWF4ejsKICAgICAgICAgICBjb25zdCB2ID0gdGVtcFdvcmxkVmVydGV4OwogICAgICAgICAgZm9yKGxldCBpPTA7IGk8bjsgaSsrKXsKICAgICAgICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKICAgICAgICAgICAgICBxdWF0LnZtdWx0KHYsIHYpOwogICAgICAgICAgICAgIHBvcy52YWRkKHYsIHYpOwogICAgICAgICAgICAgIGlmICh2LnggPCBtaW54IHx8IG1pbng9PT11bmRlZmluZWQpewogICAgICAgICAgICAgICAgICBtaW54ID0gdi54OwogICAgICAgICAgICAgIH0gZWxzZSBpZih2LnggPiBtYXh4IHx8IG1heHg9PT11bmRlZmluZWQpewogICAgICAgICAgICAgICAgICBtYXh4ID0gdi54OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgaWYgKHYueSA8IG1pbnkgfHwgbWlueT09PXVuZGVmaW5lZCl7CiAgICAgICAgICAgICAgICAgIG1pbnkgPSB2Lnk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmKHYueSA+IG1heHkgfHwgbWF4eT09PXVuZGVmaW5lZCl7CiAgICAgICAgICAgICAgICAgIG1heHkgPSB2Lnk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICBpZiAodi56IDwgbWlueiB8fCBtaW56PT09dW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgICAgbWlueiA9IHYuejsKICAgICAgICAgICAgICB9IGVsc2UgaWYodi56ID4gbWF4eiB8fCBtYXh6PT09dW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgICAgbWF4eiA9IHYuejsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBtaW4uc2V0KG1pbngsbWlueSxtaW56KTsKICAgICAgICAgIG1heC5zZXQobWF4eCxtYXh5LG1heHopOwogICAgICAgICAgKi8KICAgICAgLy8gRmFzdGVyIGFwcHJveGltYXRpb24gdXNpbmcgbG9jYWwgQUFCQgogICAgICBjb25zdCBmcmFtZSA9IGNhbGN1bGF0ZVdvcmxkQUFCQl9mcmFtZTsKICAgICAgY29uc3QgcmVzdWx0ID0gY2FsY3VsYXRlV29ybGRBQUJCX2FhYmI7CiAgICAgIGZyYW1lLnBvc2l0aW9uID0gcG9zOwogICAgICBmcmFtZS5xdWF0ZXJuaW9uID0gcXVhdDsKICAgICAgdGhpcy5hYWJiLnRvV29ybGRGcmFtZShmcmFtZSwgcmVzdWx0KTsKICAgICAgbWluLmNvcHkocmVzdWx0Lmxvd2VyQm91bmQpOwogICAgICBtYXguY29weShyZXN1bHQudXBwZXJCb3VuZCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhcHByb3hpbWF0ZSB2b2x1bWUKICAgICAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA0LjAgKiBNYXRoLlBJICogdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyAvIDMuMDsKICAgIH0KICAgIC8qKgogICAgICogQ3JlYXRlIGEgVHJpbWVzaCBpbnN0YW5jZSwgc2hhcGVkIGFzIGEgdG9ydXMuCiAgICAgKi8KCgogICAgc3RhdGljIGNyZWF0ZVRvcnVzKHJhZGl1cywgdHViZSwgcmFkaWFsU2VnbWVudHMsIHR1YnVsYXJTZWdtZW50cywgYXJjKSB7CiAgICAgIGlmIChyYWRpdXMgPT09IHZvaWQgMCkgewogICAgICAgIHJhZGl1cyA9IDE7CiAgICAgIH0KCiAgICAgIGlmICh0dWJlID09PSB2b2lkIDApIHsKICAgICAgICB0dWJlID0gMC41OwogICAgICB9CgogICAgICBpZiAocmFkaWFsU2VnbWVudHMgPT09IHZvaWQgMCkgewogICAgICAgIHJhZGlhbFNlZ21lbnRzID0gODsKICAgICAgfQoKICAgICAgaWYgKHR1YnVsYXJTZWdtZW50cyA9PT0gdm9pZCAwKSB7CiAgICAgICAgdHVidWxhclNlZ21lbnRzID0gNjsKICAgICAgfQoKICAgICAgaWYgKGFyYyA9PT0gdm9pZCAwKSB7CiAgICAgICAgYXJjID0gTWF0aC5QSSAqIDI7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICAgIGNvbnN0IGluZGljZXMgPSBbXTsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqIDw9IHJhZGlhbFNlZ21lbnRzOyBqKyspIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8PSB0dWJ1bGFyU2VnbWVudHM7IGkrKykgewogICAgICAgICAgY29uc3QgdSA9IGkgLyB0dWJ1bGFyU2VnbWVudHMgKiBhcmM7CiAgICAgICAgICBjb25zdCB2ID0gaiAvIHJhZGlhbFNlZ21lbnRzICogTWF0aC5QSSAqIDI7CiAgICAgICAgICBjb25zdCB4ID0gKHJhZGl1cyArIHR1YmUgKiBNYXRoLmNvcyh2KSkgKiBNYXRoLmNvcyh1KTsKICAgICAgICAgIGNvbnN0IHkgPSAocmFkaXVzICsgdHViZSAqIE1hdGguY29zKHYpKSAqIE1hdGguc2luKHUpOwogICAgICAgICAgY29uc3QgeiA9IHR1YmUgKiBNYXRoLnNpbih2KTsKICAgICAgICAgIHZlcnRpY2VzLnB1c2goeCwgeSwgeik7CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKGxldCBqID0gMTsgaiA8PSByYWRpYWxTZWdtZW50czsgaisrKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gdHVidWxhclNlZ21lbnRzOyBpKyspIHsKICAgICAgICAgIGNvbnN0IGEgPSAodHVidWxhclNlZ21lbnRzICsgMSkgKiBqICsgaSAtIDE7CiAgICAgICAgICBjb25zdCBiID0gKHR1YnVsYXJTZWdtZW50cyArIDEpICogKGogLSAxKSArIGkgLSAxOwogICAgICAgICAgY29uc3QgYyA9ICh0dWJ1bGFyU2VnbWVudHMgKyAxKSAqIChqIC0gMSkgKyBpOwogICAgICAgICAgY29uc3QgZCA9ICh0dWJ1bGFyU2VnbWVudHMgKyAxKSAqIGogKyBpOwogICAgICAgICAgaW5kaWNlcy5wdXNoKGEsIGIsIGQpOwogICAgICAgICAgaW5kaWNlcy5wdXNoKGIsIGMsIGQpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBUcmltZXNoKHZlcnRpY2VzLCBpbmRpY2VzKTsKICAgIH0KCiAgfQogIGNvbnN0IGNvbXB1dGVOb3JtYWxzX24gPSBuZXcgVmVjMygpOwogIGNvbnN0IHVuc2NhbGVkQUFCQiA9IG5ldyBBQUJCKCk7CiAgY29uc3QgZ2V0RWRnZVZlY3Rvcl92YSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0RWRnZVZlY3Rvcl92YiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY2IgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFiID0gbmV3IFZlYzMoKTsKICBjb25zdCB2YSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdmIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHZjID0gbmV3IFZlYzMoKTsKICBjb25zdCBjbGlfYWFiYiA9IG5ldyBBQUJCKCk7CiAgY29uc3QgY29tcHV0ZUxvY2FsQUFCQl93b3JsZFZlcnQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNhbGN1bGF0ZVdvcmxkQUFCQl9mcmFtZSA9IG5ldyBUcmFuc2Zvcm0oKTsKICBjb25zdCBjYWxjdWxhdGVXb3JsZEFBQkJfYWFiYiA9IG5ldyBBQUJCKCk7CgogIC8qKgogICAqIENvbnN0cmFpbnQgZXF1YXRpb24gc29sdmVyIGJhc2UgY2xhc3MuCiAgICovCiAgY2xhc3MgU29sdmVyIHsKICAgIC8qKgogICAgICogQWxsIGVxdWF0aW9ucyB0byBiZSBzb2x2ZWQKICAgICAqLwoKICAgIC8qKgogICAgICogQHRvZG8gcmVtb3ZlIHVzZWxlc3MgY29uc3RydWN0b3IKICAgICAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMuZXF1YXRpb25zID0gW107CiAgICB9CiAgICAvKioKICAgICAqIFNob3VsZCBiZSBpbXBsZW1lbnRlZCBpbiBzdWJjbGFzc2VzIQogICAgICogQHRvZG8gdXNlIGFic3RyYWN0CiAgICAgKiBAcmV0dXJuIG51bWJlciBvZiBpdGVyYXRpb25zIHBlcmZvcm1lZAogICAgICovCgoKICAgIHNvbHZlKGR0LCB3b3JsZCkgewogICAgICByZXR1cm4gKC8vIFNob3VsZCByZXR1cm4gdGhlIG51bWJlciBvZiBpdGVyYXRpb25zIGRvbmUhCiAgICAgICAgMAogICAgICApOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYW4gZXF1YXRpb24KICAgICAqLwoKCiAgICBhZGRFcXVhdGlvbihlcSkgewogICAgICBpZiAoZXEuZW5hYmxlZCAmJiAhZXEuYmkuaXNUcmlnZ2VyICYmICFlcS5iai5pc1RyaWdnZXIpIHsKICAgICAgICB0aGlzLmVxdWF0aW9ucy5wdXNoKGVxKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgYW4gZXF1YXRpb24KICAgICAqLwoKCiAgICByZW1vdmVFcXVhdGlvbihlcSkgewogICAgICBjb25zdCBlcXMgPSB0aGlzLmVxdWF0aW9uczsKICAgICAgY29uc3QgaSA9IGVxcy5pbmRleE9mKGVxKTsKCiAgICAgIGlmIChpICE9PSAtMSkgewogICAgICAgIGVxcy5zcGxpY2UoaSwgMSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQWRkIGFsbCBlcXVhdGlvbnMKICAgICAqLwoKCiAgICByZW1vdmVBbGxFcXVhdGlvbnMoKSB7CiAgICAgIHRoaXMuZXF1YXRpb25zLmxlbmd0aCA9IDA7CiAgICB9CgogIH0KCiAgLyoqCiAgICogQ29uc3RyYWludCBlcXVhdGlvbiBHYXVzcy1TZWlkZWwgc29sdmVyLgogICAqIEB0b2RvIFRoZSBzcG9vayBwYXJhbWV0ZXJzIHNob3VsZCBiZSBzcGVjaWZpZWQgZm9yIGVhY2ggY29uc3RyYWludCwgbm90IGdsb2JhbGx5LgogICAqIEBzZWUgaHR0cHM6Ly93d3c4LmNzLnVtdS5zZS9rdXJzZXIvNURWMDU4L1ZUMDkvbGVjdHVyZXMvc3Bvb2tub3Rlcy5wZGYKICAgKi8KICBjbGFzcyBHU1NvbHZlciBleHRlbmRzIFNvbHZlciB7CiAgICAvKioKICAgICAqIFRoZSBudW1iZXIgb2Ygc29sdmVyIGl0ZXJhdGlvbnMgZGV0ZXJtaW5lcyBxdWFsaXR5IG9mIHRoZSBjb25zdHJhaW50cyBpbiB0aGUgd29ybGQuCiAgICAgKiBUaGUgbW9yZSBpdGVyYXRpb25zLCB0aGUgbW9yZSBjb3JyZWN0IHNpbXVsYXRpb24uIE1vcmUgaXRlcmF0aW9ucyBuZWVkIG1vcmUgY29tcHV0YXRpb25zIHRob3VnaC4gSWYgeW91IGhhdmUgYSBsYXJnZSBncmF2aXR5IGZvcmNlIGluIHlvdXIgd29ybGQsIHlvdSB3aWxsIG5lZWQgbW9yZSBpdGVyYXRpb25zLgogICAgICovCgogICAgLyoqCiAgICAgKiBXaGVuIHRvbGVyYW5jZSBpcyByZWFjaGVkLCB0aGUgc3lzdGVtIGlzIGFzc3VtZWQgdG8gYmUgY29udmVyZ2VkLgogICAgICovCgogICAgLyoqCiAgICAgKiBAdG9kbyByZW1vdmUgdXNlbGVzcyBjb25zdHJ1Y3RvcgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5pdGVyYXRpb25zID0gMTA7CiAgICAgIHRoaXMudG9sZXJhbmNlID0gMWUtNzsKICAgIH0KICAgIC8qKgogICAgICogU29sdmUKICAgICAqIEByZXR1cm4gbnVtYmVyIG9mIGl0ZXJhdGlvbnMgcGVyZm9ybWVkCiAgICAgKi8KCgogICAgc29sdmUoZHQsIHdvcmxkKSB7CiAgICAgIGxldCBpdGVyID0gMDsKICAgICAgY29uc3QgbWF4SXRlciA9IHRoaXMuaXRlcmF0aW9uczsKICAgICAgY29uc3QgdG9sU3F1YXJlZCA9IHRoaXMudG9sZXJhbmNlICogdGhpcy50b2xlcmFuY2U7CiAgICAgIGNvbnN0IGVxdWF0aW9ucyA9IHRoaXMuZXF1YXRpb25zOwogICAgICBjb25zdCBOZXEgPSBlcXVhdGlvbnMubGVuZ3RoOwogICAgICBjb25zdCBib2RpZXMgPSB3b3JsZC5ib2RpZXM7CiAgICAgIGNvbnN0IE5ib2RpZXMgPSBib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBoID0gZHQ7CiAgICAgIGxldCBCOwogICAgICBsZXQgaW52QzsKICAgICAgbGV0IGRlbHRhbGFtYmRhOwogICAgICBsZXQgZGVsdGFsYW1iZGFUb3Q7CiAgICAgIGxldCBHV2xhbWJkYTsKICAgICAgbGV0IGxhbWJkYWo7IC8vIFVwZGF0ZSBzb2x2ZSBtYXNzCgogICAgICBpZiAoTmVxICE9PSAwKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5ib2RpZXM7IGkrKykgewogICAgICAgICAgYm9kaWVzW2ldLnVwZGF0ZVNvbHZlTWFzc1Byb3BlcnRpZXMoKTsKICAgICAgICB9CiAgICAgIH0gLy8gVGhpbmdzIHRoYXQgZG8gbm90IGNoYW5nZSBkdXJpbmcgaXRlcmF0aW9uIGNhbiBiZSBjb21wdXRlZCBvbmNlCgoKICAgICAgY29uc3QgaW52Q3MgPSBHU1NvbHZlcl9zb2x2ZV9pbnZDczsKICAgICAgY29uc3QgQnMgPSBHU1NvbHZlcl9zb2x2ZV9CczsKICAgICAgY29uc3QgbGFtYmRhID0gR1NTb2x2ZXJfc29sdmVfbGFtYmRhOwogICAgICBpbnZDcy5sZW5ndGggPSBOZXE7CiAgICAgIEJzLmxlbmd0aCA9IE5lcTsKICAgICAgbGFtYmRhLmxlbmd0aCA9IE5lcTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOZXE7IGkrKykgewogICAgICAgIGNvbnN0IGMgPSBlcXVhdGlvbnNbaV07CiAgICAgICAgbGFtYmRhW2ldID0gMC4wOwogICAgICAgIEJzW2ldID0gYy5jb21wdXRlQihoKTsKICAgICAgICBpbnZDc1tpXSA9IDEuMCAvIGMuY29tcHV0ZUMoKTsKICAgICAgfQoKICAgICAgaWYgKE5lcSAhPT0gMCkgewogICAgICAgIC8vIFJlc2V0IHZsYW1iZGEKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmJvZGllczsgaSsrKSB7CiAgICAgICAgICBjb25zdCBiID0gYm9kaWVzW2ldOwogICAgICAgICAgY29uc3QgdmxhbWJkYSA9IGIudmxhbWJkYTsKICAgICAgICAgIGNvbnN0IHdsYW1iZGEgPSBiLndsYW1iZGE7CiAgICAgICAgICB2bGFtYmRhLnNldCgwLCAwLCAwKTsKICAgICAgICAgIHdsYW1iZGEuc2V0KDAsIDAsIDApOwogICAgICAgIH0gLy8gSXRlcmF0ZSBvdmVyIGVxdWF0aW9ucwoKCiAgICAgICAgZm9yIChpdGVyID0gMDsgaXRlciAhPT0gbWF4SXRlcjsgaXRlcisrKSB7CiAgICAgICAgICAvLyBBY2N1bXVsYXRlIHRoZSB0b3RhbCBlcnJvciBmb3IgZWFjaCBpdGVyYXRpb24uCiAgICAgICAgICBkZWx0YWxhbWJkYVRvdCA9IDAuMDsKCiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiAhPT0gTmVxOyBqKyspIHsKICAgICAgICAgICAgY29uc3QgYyA9IGVxdWF0aW9uc1tqXTsgLy8gQ29tcHV0ZSBpdGVyYXRpb24KCiAgICAgICAgICAgIEIgPSBCc1tqXTsKICAgICAgICAgICAgaW52QyA9IGludkNzW2pdOwogICAgICAgICAgICBsYW1iZGFqID0gbGFtYmRhW2pdOwogICAgICAgICAgICBHV2xhbWJkYSA9IGMuY29tcHV0ZUdXbGFtYmRhKCk7CiAgICAgICAgICAgIGRlbHRhbGFtYmRhID0gaW52QyAqIChCIC0gR1dsYW1iZGEgLSBjLmVwcyAqIGxhbWJkYWopOyAvLyBDbGFtcCBpZiB3ZSBhcmUgbm90IHdpdGhpbiB0aGUgbWluL21heCBpbnRlcnZhbAoKICAgICAgICAgICAgaWYgKGxhbWJkYWogKyBkZWx0YWxhbWJkYSA8IGMubWluRm9yY2UpIHsKICAgICAgICAgICAgICBkZWx0YWxhbWJkYSA9IGMubWluRm9yY2UgLSBsYW1iZGFqOwogICAgICAgICAgICB9IGVsc2UgaWYgKGxhbWJkYWogKyBkZWx0YWxhbWJkYSA+IGMubWF4Rm9yY2UpIHsKICAgICAgICAgICAgICBkZWx0YWxhbWJkYSA9IGMubWF4Rm9yY2UgLSBsYW1iZGFqOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsYW1iZGFbal0gKz0gZGVsdGFsYW1iZGE7CiAgICAgICAgICAgIGRlbHRhbGFtYmRhVG90ICs9IGRlbHRhbGFtYmRhID4gMC4wID8gZGVsdGFsYW1iZGEgOiAtZGVsdGFsYW1iZGE7IC8vIGFicyhkZWx0YWxhbWJkYSkKCiAgICAgICAgICAgIGMuYWRkVG9XbGFtYmRhKGRlbHRhbGFtYmRhKTsKICAgICAgICAgIH0gLy8gSWYgdGhlIHRvdGFsIGVycm9yIGlzIHNtYWxsIGVub3VnaCAtIHN0b3AgaXRlcmF0ZQoKCiAgICAgICAgICBpZiAoZGVsdGFsYW1iZGFUb3QgKiBkZWx0YWxhbWJkYVRvdCA8IHRvbFNxdWFyZWQpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBBZGQgcmVzdWx0IHRvIHZlbG9jaXR5CgoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmJvZGllczsgaSsrKSB7CiAgICAgICAgICBjb25zdCBiID0gYm9kaWVzW2ldOwogICAgICAgICAgY29uc3QgdiA9IGIudmVsb2NpdHk7CiAgICAgICAgICBjb25zdCB3ID0gYi5hbmd1bGFyVmVsb2NpdHk7CiAgICAgICAgICBiLnZsYW1iZGEudm11bChiLmxpbmVhckZhY3RvciwgYi52bGFtYmRhKTsKICAgICAgICAgIHYudmFkZChiLnZsYW1iZGEsIHYpOwogICAgICAgICAgYi53bGFtYmRhLnZtdWwoYi5hbmd1bGFyRmFjdG9yLCBiLndsYW1iZGEpOwogICAgICAgICAgdy52YWRkKGIud2xhbWJkYSwgdyk7CiAgICAgICAgfSAvLyBTZXQgdGhlIGAubXVsdGlwbGllcmAgcHJvcGVydHkgb2YgZWFjaCBlcXVhdGlvbgoKCiAgICAgICAgbGV0IGwgPSBlcXVhdGlvbnMubGVuZ3RoOwogICAgICAgIGNvbnN0IGludkR0ID0gMSAvIGg7CgogICAgICAgIHdoaWxlIChsLS0pIHsKICAgICAgICAgIGVxdWF0aW9uc1tsXS5tdWx0aXBsaWVyID0gbGFtYmRhW2xdICogaW52RHQ7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gaXRlcjsKICAgIH0KCiAgfSAvLyBKdXN0IHRlbXBvcmFyeSBudW1iZXIgaG9sZGVycyB0aGF0IHdlIHdhbnQgdG8gcmV1c2UgZWFjaCBpdGVyYXRpb24uCgogIGNvbnN0IEdTU29sdmVyX3NvbHZlX2xhbWJkYSA9IFtdOwogIGNvbnN0IEdTU29sdmVyX3NvbHZlX2ludkNzID0gW107CiAgY29uc3QgR1NTb2x2ZXJfc29sdmVfQnMgPSBbXTsKCiAgLyoqCiAgICogU3BsaXRzIHRoZSBlcXVhdGlvbnMgaW50byBpc2xhbmRzIGFuZCBzb2x2ZXMgdGhlbSBpbmRlcGVuZGVudGx5LiBDYW4gaW1wcm92ZSBwZXJmb3JtYW5jZS4KICAgKi8KICBjbGFzcyBTcGxpdFNvbHZlciBleHRlbmRzIFNvbHZlciB7CiAgICAvKioKICAgICAqIFRoZSBudW1iZXIgb2Ygc29sdmVyIGl0ZXJhdGlvbnMgZGV0ZXJtaW5lcyBxdWFsaXR5IG9mIHRoZSBjb25zdHJhaW50cyBpbiB0aGUgd29ybGQuIFRoZSBtb3JlIGl0ZXJhdGlvbnMsIHRoZSBtb3JlIGNvcnJlY3Qgc2ltdWxhdGlvbi4gTW9yZSBpdGVyYXRpb25zIG5lZWQgbW9yZSBjb21wdXRhdGlvbnMgdGhvdWdoLiBJZiB5b3UgaGF2ZSBhIGxhcmdlIGdyYXZpdHkgZm9yY2UgaW4geW91ciB3b3JsZCwgeW91IHdpbGwgbmVlZCBtb3JlIGl0ZXJhdGlvbnMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZW4gdG9sZXJhbmNlIGlzIHJlYWNoZWQsIHRoZSBzeXN0ZW0gaXMgYXNzdW1lZCB0byBiZSBjb252ZXJnZWQuCiAgICAgKi8KCiAgICAvKiogc3Vic29sdmVyICovCiAgICBjb25zdHJ1Y3RvcihzdWJzb2x2ZXIpIHsKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5pdGVyYXRpb25zID0gMTA7CiAgICAgIHRoaXMudG9sZXJhbmNlID0gMWUtNzsKICAgICAgdGhpcy5zdWJzb2x2ZXIgPSBzdWJzb2x2ZXI7CiAgICAgIHRoaXMubm9kZXMgPSBbXTsKICAgICAgdGhpcy5ub2RlUG9vbCA9IFtdOyAvLyBDcmVhdGUgbmVlZGVkIG5vZGVzLCByZXVzZSBpZiBwb3NzaWJsZQoKICAgICAgd2hpbGUgKHRoaXMubm9kZVBvb2wubGVuZ3RoIDwgMTI4KSB7CiAgICAgICAgdGhpcy5ub2RlUG9vbC5wdXNoKHRoaXMuY3JlYXRlTm9kZSgpKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBjcmVhdGVOb2RlCiAgICAgKi8KCgogICAgY3JlYXRlTm9kZSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBib2R5OiBudWxsLAogICAgICAgIGNoaWxkcmVuOiBbXSwKICAgICAgICBlcXM6IFtdLAogICAgICAgIHZpc2l0ZWQ6IGZhbHNlCiAgICAgIH07CiAgICB9CiAgICAvKioKICAgICAqIFNvbHZlIHRoZSBzdWJzeXN0ZW1zCiAgICAgKiBAcmV0dXJuIG51bWJlciBvZiBpdGVyYXRpb25zIHBlcmZvcm1lZAogICAgICovCgoKICAgIHNvbHZlKGR0LCB3b3JsZCkgewogICAgICBjb25zdCBub2RlcyA9IFNwbGl0U29sdmVyX3NvbHZlX25vZGVzOwogICAgICBjb25zdCBub2RlUG9vbCA9IHRoaXMubm9kZVBvb2w7CiAgICAgIGNvbnN0IGJvZGllcyA9IHdvcmxkLmJvZGllczsKICAgICAgY29uc3QgZXF1YXRpb25zID0gdGhpcy5lcXVhdGlvbnM7CiAgICAgIGNvbnN0IE5lcSA9IGVxdWF0aW9ucy5sZW5ndGg7CiAgICAgIGNvbnN0IE5ib2RpZXMgPSBib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBzdWJzb2x2ZXIgPSB0aGlzLnN1YnNvbHZlcjsgLy8gQ3JlYXRlIG5lZWRlZCBub2RlcywgcmV1c2UgaWYgcG9zc2libGUKCiAgICAgIHdoaWxlIChub2RlUG9vbC5sZW5ndGggPCBOYm9kaWVzKSB7CiAgICAgICAgbm9kZVBvb2wucHVzaCh0aGlzLmNyZWF0ZU5vZGUoKSk7CiAgICAgIH0KCiAgICAgIG5vZGVzLmxlbmd0aCA9IE5ib2RpZXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE5ib2RpZXM7IGkrKykgewogICAgICAgIG5vZGVzW2ldID0gbm9kZVBvb2xbaV07CiAgICAgIH0gLy8gUmVzZXQgbm9kZSB2YWx1ZXMKCgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmJvZGllczsgaSsrKSB7CiAgICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldOwogICAgICAgIG5vZGUuYm9keSA9IGJvZGllc1tpXTsKICAgICAgICBub2RlLmNoaWxkcmVuLmxlbmd0aCA9IDA7CiAgICAgICAgbm9kZS5lcXMubGVuZ3RoID0gMDsKICAgICAgICBub2RlLnZpc2l0ZWQgPSBmYWxzZTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgayA9IDA7IGsgIT09IE5lcTsgaysrKSB7CiAgICAgICAgY29uc3QgZXEgPSBlcXVhdGlvbnNba107CiAgICAgICAgY29uc3QgaSA9IGJvZGllcy5pbmRleE9mKGVxLmJpKTsKICAgICAgICBjb25zdCBqID0gYm9kaWVzLmluZGV4T2YoZXEuYmopOwogICAgICAgIGNvbnN0IG5pID0gbm9kZXNbaV07CiAgICAgICAgY29uc3QgbmogPSBub2Rlc1tqXTsKICAgICAgICBuaS5jaGlsZHJlbi5wdXNoKG5qKTsKICAgICAgICBuaS5lcXMucHVzaChlcSk7CiAgICAgICAgbmouY2hpbGRyZW4ucHVzaChuaSk7CiAgICAgICAgbmouZXFzLnB1c2goZXEpOwogICAgICB9CgogICAgICBsZXQgY2hpbGQ7CiAgICAgIGxldCBuID0gMDsKICAgICAgbGV0IGVxcyA9IFNwbGl0U29sdmVyX3NvbHZlX2VxczsKICAgICAgc3Vic29sdmVyLnRvbGVyYW5jZSA9IHRoaXMudG9sZXJhbmNlOwogICAgICBzdWJzb2x2ZXIuaXRlcmF0aW9ucyA9IHRoaXMuaXRlcmF0aW9uczsKICAgICAgY29uc3QgZHVtbXlXb3JsZCA9IFNwbGl0U29sdmVyX3NvbHZlX2R1bW15V29ybGQ7CgogICAgICB3aGlsZSAoY2hpbGQgPSBnZXRVbnZpc2l0ZWROb2RlKG5vZGVzKSkgewogICAgICAgIGVxcy5sZW5ndGggPSAwOwogICAgICAgIGR1bW15V29ybGQuYm9kaWVzLmxlbmd0aCA9IDA7CiAgICAgICAgYmZzKGNoaWxkLCB2aXNpdEZ1bmMsIGR1bW15V29ybGQuYm9kaWVzLCBlcXMpOwogICAgICAgIGNvbnN0IE5lcXMgPSBlcXMubGVuZ3RoOwogICAgICAgIGVxcyA9IGVxcy5zb3J0KHNvcnRCeUlkKTsKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5lcXM7IGkrKykgewogICAgICAgICAgc3Vic29sdmVyLmFkZEVxdWF0aW9uKGVxc1tpXSk7CiAgICAgICAgfQoKICAgICAgICBzdWJzb2x2ZXIuc29sdmUoZHQsIGR1bW15V29ybGQpOwogICAgICAgIHN1YnNvbHZlci5yZW1vdmVBbGxFcXVhdGlvbnMoKTsKICAgICAgICBuKys7CiAgICAgIH0KCiAgICAgIHJldHVybiBuOwogICAgfQoKICB9IC8vIFJldHVybnMgdGhlIG51bWJlciBvZiBzdWJzeXN0ZW1zCgogIGNvbnN0IFNwbGl0U29sdmVyX3NvbHZlX25vZGVzID0gW107IC8vIEFsbCBhbGxvY2F0ZWQgbm9kZSBvYmplY3RzCgogIGNvbnN0IFNwbGl0U29sdmVyX3NvbHZlX2VxcyA9IFtdOyAvLyBUZW1wIGFycmF5CgogIGNvbnN0IFNwbGl0U29sdmVyX3NvbHZlX2R1bW15V29ybGQgPSB7CiAgICBib2RpZXM6IFtdCiAgfTsgLy8gVGVtcCBvYmplY3QKCiAgY29uc3QgU1RBVElDID0gQm9keS5TVEFUSUM7CgogIGZ1bmN0aW9uIGdldFVudmlzaXRlZE5vZGUobm9kZXMpIHsKICAgIGNvbnN0IE5ub2RlcyA9IG5vZGVzLmxlbmd0aDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTm5vZGVzOyBpKyspIHsKICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldOwoKICAgICAgaWYgKCFub2RlLnZpc2l0ZWQgJiYgIShub2RlLmJvZHkudHlwZSAmIFNUQVRJQykpIHsKICAgICAgICByZXR1cm4gbm9kZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGNvbnN0IHF1ZXVlID0gW107CgogIGZ1bmN0aW9uIGJmcyhyb290LCB2aXNpdEZ1bmMsIGJkcywgZXFzKSB7CiAgICBxdWV1ZS5wdXNoKHJvb3QpOwogICAgcm9vdC52aXNpdGVkID0gdHJ1ZTsKICAgIHZpc2l0RnVuYyhyb290LCBiZHMsIGVxcyk7CgogICAgd2hpbGUgKHF1ZXVlLmxlbmd0aCkgewogICAgICBjb25zdCBub2RlID0gcXVldWUucG9wKCk7IC8vIExvb3Agb3ZlciB1bnZpc2l0ZWQgY2hpbGQgbm9kZXMKCiAgICAgIGxldCBjaGlsZDsKCiAgICAgIHdoaWxlIChjaGlsZCA9IGdldFVudmlzaXRlZE5vZGUobm9kZS5jaGlsZHJlbikpIHsKICAgICAgICBjaGlsZC52aXNpdGVkID0gdHJ1ZTsKICAgICAgICB2aXNpdEZ1bmMoY2hpbGQsIGJkcywgZXFzKTsKICAgICAgICBxdWV1ZS5wdXNoKGNoaWxkKTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gdmlzaXRGdW5jKG5vZGUsIGJkcywgZXFzKSB7CiAgICBiZHMucHVzaChub2RlLmJvZHkpOwogICAgY29uc3QgTmVxcyA9IG5vZGUuZXFzLmxlbmd0aDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmVxczsgaSsrKSB7CiAgICAgIGNvbnN0IGVxID0gbm9kZS5lcXNbaV07CgogICAgICBpZiAoIWVxcy5pbmNsdWRlcyhlcSkpIHsKICAgICAgICBlcXMucHVzaChlcSk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHNvcnRCeUlkKGEsIGIpIHsKICAgIHJldHVybiBiLmlkIC0gYS5pZDsKICB9CgogIC8qKgogICAqIEZvciBwb29saW5nIG9iamVjdHMgdGhhdCBjYW4gYmUgcmV1c2VkLgogICAqLwogIGNsYXNzIFBvb2wgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMub2JqZWN0cyA9IFtdOwogICAgICB0aGlzLnR5cGUgPSBPYmplY3Q7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuIG9iamVjdCBhZnRlciB1c2UKICAgICAqLwogICAgcmVsZWFzZSgpIHsKICAgICAgY29uc3QgTmFyZ3MgPSBhcmd1bWVudHMubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5hcmdzOyBpKyspIHsKICAgICAgICB0aGlzLm9iamVjdHMucHVzaChpIDwgMCB8fCBhcmd1bWVudHMubGVuZ3RoIDw9IGkgPyB1bmRlZmluZWQgOiBhcmd1bWVudHNbaV0pOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFuIG9iamVjdAogICAgICovCgoKICAgIGdldCgpIHsKICAgICAgaWYgKHRoaXMub2JqZWN0cy5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3RPYmplY3QoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGhpcy5vYmplY3RzLnBvcCgpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbnN0cnVjdCBhbiBvYmplY3QuIFNob3VsZCBiZSBpbXBsZW1lbnRlZCBpbiBlYWNoIHN1YmNsYXNzLgogICAgICovCgoKICAgIGNvbnN0cnVjdE9iamVjdCgpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb25zdHJ1Y3RPYmplY3QoKSBub3QgaW1wbGVtZW50ZWQgaW4gdGhpcyBQb29sIHN1YmNsYXNzIHlldCEnKTsKICAgIH0KICAgIC8qKgogICAgICogQHJldHVybiBTZWxmLCBmb3IgY2hhaW5pbmcKICAgICAqLwoKCiAgICByZXNpemUoc2l6ZSkgewogICAgICBjb25zdCBvYmplY3RzID0gdGhpcy5vYmplY3RzOwoKICAgICAgd2hpbGUgKG9iamVjdHMubGVuZ3RoID4gc2l6ZSkgewogICAgICAgIG9iamVjdHMucG9wKCk7CiAgICAgIH0KCiAgICAgIHdoaWxlIChvYmplY3RzLmxlbmd0aCA8IHNpemUpIHsKICAgICAgICBvYmplY3RzLnB1c2godGhpcy5jb25zdHJ1Y3RPYmplY3QoKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICB9CgogIC8qKgogICAqIFZlYzNQb29sCiAgICovCgogIGNsYXNzIFZlYzNQb29sIGV4dGVuZHMgUG9vbCB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKTsKICAgICAgdGhpcy50eXBlID0gVmVjMzsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnN0cnVjdCBhIHZlY3RvcgogICAgICovCiAgICBjb25zdHJ1Y3RPYmplY3QoKSB7CiAgICAgIHJldHVybiBuZXcgVmVjMygpOwogICAgfQoKICB9CgogIC8vIE5hbWluZyBydWxlOiBiYXNlZCBvZiB0aGUgb3JkZXIgaW4gU0hBUEVfVFlQRVMsCiAgLy8gdGhlIGZpcnN0IHBhcnQgb2YgdGhlIG1ldGhvZCBpcyBmb3JtZWQgYnkgdGhlCiAgLy8gc2hhcGUgdHlwZSB0aGF0IGNvbWVzIGJlZm9yZSwgaW4gdGhlIHNlY29uZCBwYXJ0CiAgLy8gdGhlcmUgaXMgdGhlIHNoYXBlIHR5cGUgdGhhdCBjb21lcyBhZnRlciBpbiB0aGUgU0hBUEVfVFlQRVMgbGlzdAogIGNvbnN0IENPTExJU0lPTl9UWVBFUyA9IHsKICAgIHNwaGVyZVNwaGVyZTogU2hhcGUudHlwZXMuU1BIRVJFLAogICAgc3BoZXJlUGxhbmU6IFNoYXBlLnR5cGVzLlNQSEVSRSB8IFNoYXBlLnR5cGVzLlBMQU5FLAogICAgYm94Qm94OiBTaGFwZS50eXBlcy5CT1ggfCBTaGFwZS50eXBlcy5CT1gsCiAgICBzcGhlcmVCb3g6IFNoYXBlLnR5cGVzLlNQSEVSRSB8IFNoYXBlLnR5cGVzLkJPWCwKICAgIHBsYW5lQm94OiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLkJPWCwKICAgIGNvbnZleENvbnZleDogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiwKICAgIHNwaGVyZUNvbnZleDogU2hhcGUudHlwZXMuU1BIRVJFIHwgU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiwKICAgIHBsYW5lQ29udmV4OiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBib3hDb252ZXg6IFNoYXBlLnR5cGVzLkJPWCB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBzcGhlcmVIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuU1BIRVJFIHwgU2hhcGUudHlwZXMuSEVJR0hURklFTEQsCiAgICBib3hIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuQk9YIHwgU2hhcGUudHlwZXMuSEVJR0hURklFTEQsCiAgICBjb252ZXhIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiB8IFNoYXBlLnR5cGVzLkhFSUdIVEZJRUxELAogICAgc3BoZXJlUGFydGljbGU6IFNoYXBlLnR5cGVzLlBBUlRJQ0xFIHwgU2hhcGUudHlwZXMuU1BIRVJFLAogICAgcGxhbmVQYXJ0aWNsZTogU2hhcGUudHlwZXMuUExBTkUgfCBTaGFwZS50eXBlcy5QQVJUSUNMRSwKICAgIGJveFBhcnRpY2xlOiBTaGFwZS50eXBlcy5CT1ggfCBTaGFwZS50eXBlcy5QQVJUSUNMRSwKICAgIGNvbnZleFBhcnRpY2xlOiBTaGFwZS50eXBlcy5QQVJUSUNMRSB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBjeWxpbmRlckN5bGluZGVyOiBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHNwaGVyZUN5bGluZGVyOiBTaGFwZS50eXBlcy5TUEhFUkUgfCBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHBsYW5lQ3lsaW5kZXI6IFNoYXBlLnR5cGVzLlBMQU5FIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBib3hDeWxpbmRlcjogU2hhcGUudHlwZXMuQk9YIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBjb252ZXhDeWxpbmRlcjogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiB8IFNoYXBlLnR5cGVzLkNZTElOREVSLAogICAgaGVpZ2h0ZmllbGRDeWxpbmRlcjogU2hhcGUudHlwZXMuSEVJR0hURklFTEQgfCBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHBhcnRpY2xlQ3lsaW5kZXI6IFNoYXBlLnR5cGVzLlBBUlRJQ0xFIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBzcGhlcmVUcmltZXNoOiBTaGFwZS50eXBlcy5TUEhFUkUgfCBTaGFwZS50eXBlcy5UUklNRVNILAogICAgcGxhbmVUcmltZXNoOiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLlRSSU1FU0gKICB9OwoKICAvKioKICAgKiBIZWxwZXIgY2xhc3MgZm9yIHRoZSBXb3JsZC4gR2VuZXJhdGVzIENvbnRhY3RFcXVhdGlvbnMuCiAgICogQHRvZG8gU3BoZXJlLUNvbnZleFBvbHloZWRyb24gY29udGFjdHMKICAgKiBAdG9kbyBDb250YWN0IHJlZHVjdGlvbgogICAqIEB0b2RvIHNob3VsZCBtb3ZlIG1ldGhvZHMgdG8gcHJvdG90eXBlCiAgICovCiAgY2xhc3MgTmFycm93cGhhc2UgewogICAgLyoqCiAgICAgKiBJbnRlcm5hbCBzdG9yYWdlIG9mIHBvb2xlZCBjb250YWN0IHBvaW50cy4KICAgICAqLwoKICAgIC8qKgogICAgICogUG9vbGVkIHZlY3RvcnMuCiAgICAgKi8KICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZVNwaGVyZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLnNwaGVyZVNwaGVyZTsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5zcGhlcmVQbGFuZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLnNwaGVyZVBsYW5lOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmJveEJveF0oKSB7CiAgICAgIHJldHVybiB0aGlzLmJveEJveDsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5zcGhlcmVCb3hdKCkgewogICAgICByZXR1cm4gdGhpcy5zcGhlcmVCb3g7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMucGxhbmVCb3hdKCkgewogICAgICByZXR1cm4gdGhpcy5wbGFuZUJveDsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5jb252ZXhDb252ZXhdKCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuc3BoZXJlQ29udmV4XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlQ29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnBsYW5lQ29udmV4XSgpIHsKICAgICAgcmV0dXJuIHRoaXMucGxhbmVDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuYm94Q29udmV4XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuYm94Q29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZUhlaWdodGZpZWxkXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlSGVpZ2h0ZmllbGQ7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuYm94SGVpZ2h0ZmllbGRdKCkgewogICAgICByZXR1cm4gdGhpcy5ib3hIZWlnaHRmaWVsZDsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5jb252ZXhIZWlnaHRmaWVsZF0oKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleEhlaWdodGZpZWxkOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZVBhcnRpY2xlXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlUGFydGljbGU7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMucGxhbmVQYXJ0aWNsZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lUGFydGljbGU7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuYm94UGFydGljbGVdKCkgewogICAgICByZXR1cm4gdGhpcy5ib3hQYXJ0aWNsZTsKICAgIH0KCiAgICBnZXQgW0NPTExJU0lPTl9UWVBFUy5jb252ZXhQYXJ0aWNsZV0oKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleFBhcnRpY2xlOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmN5bGluZGVyQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMuc3BoZXJlQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5zcGhlcmVDb252ZXg7CiAgICB9CgogICAgZ2V0IFtDT0xMSVNJT05fVFlQRVMucGxhbmVDeWxpbmRlcl0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lQ29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmJveEN5bGluZGVyXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuYm94Q29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmNvbnZleEN5bGluZGVyXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuY29udmV4Q29udmV4OwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLmhlaWdodGZpZWxkQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5oZWlnaHRmaWVsZEN5bGluZGVyOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnBhcnRpY2xlQ3lsaW5kZXJdKCkgewogICAgICByZXR1cm4gdGhpcy5wYXJ0aWNsZUN5bGluZGVyOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnNwaGVyZVRyaW1lc2hdKCkgewogICAgICByZXR1cm4gdGhpcy5zcGhlcmVUcmltZXNoOwogICAgfQoKICAgIGdldCBbQ09MTElTSU9OX1RZUEVTLnBsYW5lVHJpbWVzaF0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lVHJpbWVzaDsKICAgIH0gLy8gZ2V0IFtDT0xMSVNJT05fVFlQRVMuY29udmV4VHJpbWVzaF0oKSB7CiAgICAvLyAgIHJldHVybiB0aGlzLmNvbnZleFRyaW1lc2gKICAgIC8vIH0KCgogICAgY29uc3RydWN0b3Iod29ybGQpIHsKICAgICAgdGhpcy5jb250YWN0UG9pbnRQb29sID0gW107CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblBvb2wgPSBbXTsKICAgICAgdGhpcy5yZXN1bHQgPSBbXTsKICAgICAgdGhpcy5mcmljdGlvblJlc3VsdCA9IFtdOwogICAgICB0aGlzLnYzcG9vbCA9IG5ldyBWZWMzUG9vbCgpOwogICAgICB0aGlzLndvcmxkID0gd29ybGQ7CiAgICAgIHRoaXMuY3VycmVudENvbnRhY3RNYXRlcmlhbCA9IHdvcmxkLmRlZmF1bHRDb250YWN0TWF0ZXJpYWw7CiAgICAgIHRoaXMuZW5hYmxlRnJpY3Rpb25SZWR1Y3Rpb24gPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogTWFrZSBhIGNvbnRhY3Qgb2JqZWN0LCBieSB1c2luZyB0aGUgaW50ZXJuYWwgcG9vbCBvciBjcmVhdGluZyBhIG5ldyBvbmUuCiAgICAgKi8KCgogICAgY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCBvdmVycmlkZVNoYXBlQSwgb3ZlcnJpZGVTaGFwZUIpIHsKICAgICAgbGV0IGM7CgogICAgICBpZiAodGhpcy5jb250YWN0UG9pbnRQb29sLmxlbmd0aCkgewogICAgICAgIGMgPSB0aGlzLmNvbnRhY3RQb2ludFBvb2wucG9wKCk7CiAgICAgICAgYy5iaSA9IGJpOwogICAgICAgIGMuYmogPSBiajsKICAgICAgfSBlbHNlIHsKICAgICAgICBjID0gbmV3IENvbnRhY3RFcXVhdGlvbihiaSwgYmopOwogICAgICB9CgogICAgICBjLmVuYWJsZWQgPSBiaS5jb2xsaXNpb25SZXNwb25zZSAmJiBiai5jb2xsaXNpb25SZXNwb25zZSAmJiBzaS5jb2xsaXNpb25SZXNwb25zZSAmJiBzai5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgY29uc3QgY20gPSB0aGlzLmN1cnJlbnRDb250YWN0TWF0ZXJpYWw7CiAgICAgIGMucmVzdGl0dXRpb24gPSBjbS5yZXN0aXR1dGlvbjsKICAgICAgYy5zZXRTcG9va1BhcmFtcyhjbS5jb250YWN0RXF1YXRpb25TdGlmZm5lc3MsIGNtLmNvbnRhY3RFcXVhdGlvblJlbGF4YXRpb24sIHRoaXMud29ybGQuZHQpOwogICAgICBjb25zdCBtYXRBID0gc2kubWF0ZXJpYWwgfHwgYmkubWF0ZXJpYWw7CiAgICAgIGNvbnN0IG1hdEIgPSBzai5tYXRlcmlhbCB8fCBiai5tYXRlcmlhbDsKCiAgICAgIGlmIChtYXRBICYmIG1hdEIgJiYgbWF0QS5yZXN0aXR1dGlvbiA+PSAwICYmIG1hdEIucmVzdGl0dXRpb24gPj0gMCkgewogICAgICAgIGMucmVzdGl0dXRpb24gPSBtYXRBLnJlc3RpdHV0aW9uICogbWF0Qi5yZXN0aXR1dGlvbjsKICAgICAgfQoKICAgICAgYy5zaSA9IG92ZXJyaWRlU2hhcGVBIHx8IHNpOwogICAgICBjLnNqID0gb3ZlcnJpZGVTaGFwZUIgfHwgc2o7CiAgICAgIHJldHVybiBjOwogICAgfQoKICAgIGNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QoY29udGFjdEVxdWF0aW9uLCBvdXRBcnJheSkgewogICAgICBjb25zdCBib2R5QSA9IGNvbnRhY3RFcXVhdGlvbi5iaTsKICAgICAgY29uc3QgYm9keUIgPSBjb250YWN0RXF1YXRpb24uYmo7CiAgICAgIGNvbnN0IHNoYXBlQSA9IGNvbnRhY3RFcXVhdGlvbi5zaTsKICAgICAgY29uc3Qgc2hhcGVCID0gY29udGFjdEVxdWF0aW9uLnNqOwogICAgICBjb25zdCB3b3JsZCA9IHRoaXMud29ybGQ7CiAgICAgIGNvbnN0IGNtID0gdGhpcy5jdXJyZW50Q29udGFjdE1hdGVyaWFsOyAvLyBJZiBmcmljdGlvbiBvciByZXN0aXR1dGlvbiB3ZXJlIHNwZWNpZmllZCBpbiB0aGUgbWF0ZXJpYWwsIHVzZSB0aGVtCgogICAgICBsZXQgZnJpY3Rpb24gPSBjbS5mcmljdGlvbjsKICAgICAgY29uc3QgbWF0QSA9IHNoYXBlQS5tYXRlcmlhbCB8fCBib2R5QS5tYXRlcmlhbDsKICAgICAgY29uc3QgbWF0QiA9IHNoYXBlQi5tYXRlcmlhbCB8fCBib2R5Qi5tYXRlcmlhbDsKCiAgICAgIGlmIChtYXRBICYmIG1hdEIgJiYgbWF0QS5mcmljdGlvbiA+PSAwICYmIG1hdEIuZnJpY3Rpb24gPj0gMCkgewogICAgICAgIGZyaWN0aW9uID0gbWF0QS5mcmljdGlvbiAqIG1hdEIuZnJpY3Rpb247CiAgICAgIH0KCiAgICAgIGlmIChmcmljdGlvbiA+IDApIHsKICAgICAgICAvLyBDcmVhdGUgMiB0YW5nZW50IGVxdWF0aW9ucwogICAgICAgIC8vIFVzZXJzIG1heSBwcm92aWRlIGEgZm9yY2UgZGlmZmVyZW50IGZyb20gZ2xvYmFsIGdyYXZpdHkgdG8gdXNlIHdoZW4gY29tcHV0aW5nIGNvbnRhY3QgZnJpY3Rpb24uCiAgICAgICAgY29uc3QgbXVnID0gZnJpY3Rpb24gKiAod29ybGQuZnJpY3Rpb25HcmF2aXR5IHx8IHdvcmxkLmdyYXZpdHkpLmxlbmd0aCgpOwogICAgICAgIGxldCByZWR1Y2VkTWFzcyA9IGJvZHlBLmludk1hc3MgKyBib2R5Qi5pbnZNYXNzOwoKICAgICAgICBpZiAocmVkdWNlZE1hc3MgPiAwKSB7CiAgICAgICAgICByZWR1Y2VkTWFzcyA9IDEgLyByZWR1Y2VkTWFzczsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHBvb2wgPSB0aGlzLmZyaWN0aW9uRXF1YXRpb25Qb29sOwogICAgICAgIGNvbnN0IGMxID0gcG9vbC5sZW5ndGggPyBwb29sLnBvcCgpIDogbmV3IEZyaWN0aW9uRXF1YXRpb24oYm9keUEsIGJvZHlCLCBtdWcgKiByZWR1Y2VkTWFzcyk7CiAgICAgICAgY29uc3QgYzIgPSBwb29sLmxlbmd0aCA/IHBvb2wucG9wKCkgOiBuZXcgRnJpY3Rpb25FcXVhdGlvbihib2R5QSwgYm9keUIsIG11ZyAqIHJlZHVjZWRNYXNzKTsKICAgICAgICBjMS5iaSA9IGMyLmJpID0gYm9keUE7CiAgICAgICAgYzEuYmogPSBjMi5iaiA9IGJvZHlCOwogICAgICAgIGMxLm1pbkZvcmNlID0gYzIubWluRm9yY2UgPSAtbXVnICogcmVkdWNlZE1hc3M7CiAgICAgICAgYzEubWF4Rm9yY2UgPSBjMi5tYXhGb3JjZSA9IG11ZyAqIHJlZHVjZWRNYXNzOyAvLyBDb3B5IG92ZXIgdGhlIHJlbGF0aXZlIHZlY3RvcnMKCiAgICAgICAgYzEucmkuY29weShjb250YWN0RXF1YXRpb24ucmkpOwogICAgICAgIGMxLnJqLmNvcHkoY29udGFjdEVxdWF0aW9uLnJqKTsKICAgICAgICBjMi5yaS5jb3B5KGNvbnRhY3RFcXVhdGlvbi5yaSk7CiAgICAgICAgYzIucmouY29weShjb250YWN0RXF1YXRpb24ucmopOyAvLyBDb25zdHJ1Y3QgdGFuZ2VudHMKCiAgICAgICAgY29udGFjdEVxdWF0aW9uLm5pLnRhbmdlbnRzKGMxLnQsIGMyLnQpOyAvLyBTZXQgc3Bvb2sgcGFyYW1zCgogICAgICAgIGMxLnNldFNwb29rUGFyYW1zKGNtLmZyaWN0aW9uRXF1YXRpb25TdGlmZm5lc3MsIGNtLmZyaWN0aW9uRXF1YXRpb25SZWxheGF0aW9uLCB3b3JsZC5kdCk7CiAgICAgICAgYzIuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIHdvcmxkLmR0KTsKICAgICAgICBjMS5lbmFibGVkID0gYzIuZW5hYmxlZCA9IGNvbnRhY3RFcXVhdGlvbi5lbmFibGVkOwogICAgICAgIG91dEFycmF5LnB1c2goYzEsIGMyKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgLyoqCiAgICAgKiBUYWtlIHRoZSBhdmVyYWdlIE4gbGF0ZXN0IGNvbnRhY3QgcG9pbnQgb24gdGhlIHBsYW5lLgogICAgICovCgoKICAgIGNyZWF0ZUZyaWN0aW9uRnJvbUF2ZXJhZ2UobnVtQ29udGFjdHMpIHsKICAgICAgLy8gVGhlIGxhc3QgY29udGFjdEVxdWF0aW9uCiAgICAgIGxldCBjID0gdGhpcy5yZXN1bHRbdGhpcy5yZXN1bHQubGVuZ3RoIC0gMV07IC8vIENyZWF0ZSB0aGUgcmVzdWx0OiB0d28gImF2ZXJhZ2UiIGZyaWN0aW9uIGVxdWF0aW9ucwoKICAgICAgaWYgKCF0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QoYywgdGhpcy5mcmljdGlvblJlc3VsdCkgfHwgbnVtQ29udGFjdHMgPT09IDEpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGYxID0gdGhpcy5mcmljdGlvblJlc3VsdFt0aGlzLmZyaWN0aW9uUmVzdWx0Lmxlbmd0aCAtIDJdOwogICAgICBjb25zdCBmMiA9IHRoaXMuZnJpY3Rpb25SZXN1bHRbdGhpcy5mcmljdGlvblJlc3VsdC5sZW5ndGggLSAxXTsKICAgICAgYXZlcmFnZU5vcm1hbC5zZXRaZXJvKCk7CiAgICAgIGF2ZXJhZ2VDb250YWN0UG9pbnRBLnNldFplcm8oKTsKICAgICAgYXZlcmFnZUNvbnRhY3RQb2ludEIuc2V0WmVybygpOwogICAgICBjb25zdCBib2R5QSA9IGMuYmk7CiAgICAgIGMuYmo7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gbnVtQ29udGFjdHM7IGkrKykgewogICAgICAgIGMgPSB0aGlzLnJlc3VsdFt0aGlzLnJlc3VsdC5sZW5ndGggLSAxIC0gaV07CgogICAgICAgIGlmIChjLmJpICE9PSBib2R5QSkgewogICAgICAgICAgYXZlcmFnZU5vcm1hbC52YWRkKGMubmksIGF2ZXJhZ2VOb3JtYWwpOwogICAgICAgICAgYXZlcmFnZUNvbnRhY3RQb2ludEEudmFkZChjLnJpLCBhdmVyYWdlQ29udGFjdFBvaW50QSk7CiAgICAgICAgICBhdmVyYWdlQ29udGFjdFBvaW50Qi52YWRkKGMucmosIGF2ZXJhZ2VDb250YWN0UG9pbnRCKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXZlcmFnZU5vcm1hbC52c3ViKGMubmksIGF2ZXJhZ2VOb3JtYWwpOwogICAgICAgICAgYXZlcmFnZUNvbnRhY3RQb2ludEEudmFkZChjLnJqLCBhdmVyYWdlQ29udGFjdFBvaW50QSk7CiAgICAgICAgICBhdmVyYWdlQ29udGFjdFBvaW50Qi52YWRkKGMucmksIGF2ZXJhZ2VDb250YWN0UG9pbnRCKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IGludk51bUNvbnRhY3RzID0gMSAvIG51bUNvbnRhY3RzOwogICAgICBhdmVyYWdlQ29udGFjdFBvaW50QS5zY2FsZShpbnZOdW1Db250YWN0cywgZjEucmkpOwogICAgICBhdmVyYWdlQ29udGFjdFBvaW50Qi5zY2FsZShpbnZOdW1Db250YWN0cywgZjEucmopOwogICAgICBmMi5yaS5jb3B5KGYxLnJpKTsgLy8gU2hvdWxkIGJlIHRoZSBzYW1lCgogICAgICBmMi5yai5jb3B5KGYxLnJqKTsKICAgICAgYXZlcmFnZU5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgYXZlcmFnZU5vcm1hbC50YW5nZW50cyhmMS50LCBmMi50KTsgLy8gcmV0dXJuIGVxOwogICAgfQogICAgLyoqCiAgICAgKiBHZW5lcmF0ZSBhbGwgY29udGFjdHMgYmV0d2VlbiBhIGxpc3Qgb2YgYm9keSBwYWlycwogICAgICogQHBhcmFtIHAxIEFycmF5IG9mIGJvZHkgaW5kaWNlcwogICAgICogQHBhcmFtIHAyIEFycmF5IG9mIGJvZHkgaW5kaWNlcwogICAgICogQHBhcmFtIHJlc3VsdCBBcnJheSB0byBzdG9yZSBnZW5lcmF0ZWQgY29udGFjdHMKICAgICAqIEBwYXJhbSBvbGRjb250YWN0cyBPcHRpb25hbC4gQXJyYXkgb2YgcmV1c2FibGUgY29udGFjdCBvYmplY3RzCiAgICAgKi8KCgogICAgZ2V0Q29udGFjdHMocDEsIHAyLCB3b3JsZCwgcmVzdWx0LCBvbGRjb250YWN0cywgZnJpY3Rpb25SZXN1bHQsIGZyaWN0aW9uUG9vbCkgewogICAgICAvLyBTYXZlIG9sZCBjb250YWN0IG9iamVjdHMKICAgICAgdGhpcy5jb250YWN0UG9pbnRQb29sID0gb2xkY29udGFjdHM7CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblBvb2wgPSBmcmljdGlvblBvb2w7CiAgICAgIHRoaXMucmVzdWx0ID0gcmVzdWx0OwogICAgICB0aGlzLmZyaWN0aW9uUmVzdWx0ID0gZnJpY3Rpb25SZXN1bHQ7CiAgICAgIGNvbnN0IHFpID0gdG1wUXVhdDE7CiAgICAgIGNvbnN0IHFqID0gdG1wUXVhdDI7CiAgICAgIGNvbnN0IHhpID0gdG1wVmVjMTsKICAgICAgY29uc3QgeGogPSB0bXBWZWMyOwoKICAgICAgZm9yIChsZXQgayA9IDAsIE4gPSBwMS5sZW5ndGg7IGsgIT09IE47IGsrKykgewogICAgICAgIC8vIEdldCBjdXJyZW50IGNvbGxpc2lvbiBib2RpZXMKICAgICAgICBjb25zdCBiaSA9IHAxW2tdOwogICAgICAgIGNvbnN0IGJqID0gcDJba107IC8vIEdldCBjb250YWN0IG1hdGVyaWFsCgogICAgICAgIGxldCBib2R5Q29udGFjdE1hdGVyaWFsID0gbnVsbDsKCiAgICAgICAgaWYgKGJpLm1hdGVyaWFsICYmIGJqLm1hdGVyaWFsKSB7CiAgICAgICAgICBib2R5Q29udGFjdE1hdGVyaWFsID0gd29ybGQuZ2V0Q29udGFjdE1hdGVyaWFsKGJpLm1hdGVyaWFsLCBiai5tYXRlcmlhbCkgfHwgbnVsbDsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGp1c3RUZXN0ID0gYmkudHlwZSAmIEJvZHkuS0lORU1BVElDICYmIGJqLnR5cGUgJiBCb2R5LlNUQVRJQyB8fCBiaS50eXBlICYgQm9keS5TVEFUSUMgJiYgYmoudHlwZSAmIEJvZHkuS0lORU1BVElDIHx8IGJpLnR5cGUgJiBCb2R5LktJTkVNQVRJQyAmJiBiai50eXBlICYgQm9keS5LSU5FTUFUSUM7CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmkuc2hhcGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBiaS5xdWF0ZXJuaW9uLm11bHQoYmkuc2hhcGVPcmllbnRhdGlvbnNbaV0sIHFpKTsKICAgICAgICAgIGJpLnF1YXRlcm5pb24udm11bHQoYmkuc2hhcGVPZmZzZXRzW2ldLCB4aSk7CiAgICAgICAgICB4aS52YWRkKGJpLnBvc2l0aW9uLCB4aSk7CiAgICAgICAgICBjb25zdCBzaSA9IGJpLnNoYXBlc1tpXTsKCiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJqLnNoYXBlcy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAvLyBDb21wdXRlIHdvcmxkIHRyYW5zZm9ybSBvZiBzaGFwZXMKICAgICAgICAgICAgYmoucXVhdGVybmlvbi5tdWx0KGJqLnNoYXBlT3JpZW50YXRpb25zW2pdLCBxaik7CiAgICAgICAgICAgIGJqLnF1YXRlcm5pb24udm11bHQoYmouc2hhcGVPZmZzZXRzW2pdLCB4aik7CiAgICAgICAgICAgIHhqLnZhZGQoYmoucG9zaXRpb24sIHhqKTsKICAgICAgICAgICAgY29uc3Qgc2ogPSBiai5zaGFwZXNbal07CgogICAgICAgICAgICBpZiAoIShzaS5jb2xsaXNpb25GaWx0ZXJNYXNrICYgc2ouY29sbGlzaW9uRmlsdGVyR3JvdXAgJiYgc2ouY29sbGlzaW9uRmlsdGVyTWFzayAmIHNpLmNvbGxpc2lvbkZpbHRlckdyb3VwKSkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoeGkuZGlzdGFuY2VUbyh4aikgPiBzaS5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNqLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0gLy8gR2V0IGNvbGxpc2lvbiBtYXRlcmlhbAoKCiAgICAgICAgICAgIGxldCBzaGFwZUNvbnRhY3RNYXRlcmlhbCA9IG51bGw7CgogICAgICAgICAgICBpZiAoc2kubWF0ZXJpYWwgJiYgc2oubWF0ZXJpYWwpIHsKICAgICAgICAgICAgICBzaGFwZUNvbnRhY3RNYXRlcmlhbCA9IHdvcmxkLmdldENvbnRhY3RNYXRlcmlhbChzaS5tYXRlcmlhbCwgc2oubWF0ZXJpYWwpIHx8IG51bGw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMuY3VycmVudENvbnRhY3RNYXRlcmlhbCA9IHNoYXBlQ29udGFjdE1hdGVyaWFsIHx8IGJvZHlDb250YWN0TWF0ZXJpYWwgfHwgd29ybGQuZGVmYXVsdENvbnRhY3RNYXRlcmlhbDsgLy8gR2V0IGNvbnRhY3RzCgogICAgICAgICAgICBjb25zdCByZXNvbHZlckluZGV4ID0gc2kudHlwZSB8IHNqLnR5cGU7CiAgICAgICAgICAgIGNvbnN0IHJlc29sdmVyID0gdGhpc1tyZXNvbHZlckluZGV4XTsKCiAgICAgICAgICAgIGlmIChyZXNvbHZlcikgewogICAgICAgICAgICAgIGxldCByZXR2YWwgPSBmYWxzZTsgLy8gVE8gRE86IGludmVzdGlnYXRlIHdoeSBzcGhlcmVQYXJ0aWNsZSBhbmQgY29udmV4UGFydGljbGUKICAgICAgICAgICAgICAvLyByZXNvbHZlcnMgZXhwZWN0IHNpIGFuZCBzaiBzaGFwZXMgdG8gYmUgaW4gcmV2ZXJzZSBvcmRlcgogICAgICAgICAgICAgIC8vIChpLmUuIGxhcmdlciBpbnRlZ2VyIHZhbHVlIHR5cGUgZmlyc3QgaW5zdGVhZCBvZiBzbWFsbGVyIGZpcnN0KQoKICAgICAgICAgICAgICBpZiAoc2kudHlwZSA8IHNqLnR5cGUpIHsKICAgICAgICAgICAgICAgIHJldHZhbCA9IHJlc29sdmVyLmNhbGwodGhpcywgc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dmFsID0gcmVzb2x2ZXIuY2FsbCh0aGlzLCBzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHNpLCBzaiwganVzdFRlc3QpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKHJldHZhbCAmJiBqdXN0VGVzdCkgewogICAgICAgICAgICAgICAgLy8gUmVnaXN0ZXIgb3ZlcmxhcAogICAgICAgICAgICAgICAgd29ybGQuc2hhcGVPdmVybGFwS2VlcGVyLnNldChzaS5pZCwgc2ouaWQpOwogICAgICAgICAgICAgICAgd29ybGQuYm9keU92ZXJsYXBLZWVwZXIuc2V0KGJpLmlkLCBiai5pZCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgc3BoZXJlU3BoZXJlKHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgIHJldHVybiB4aS5kaXN0YW5jZVNxdWFyZWQoeGopIDwgKHNpLnJhZGl1cyArIHNqLnJhZGl1cykgKiogMjsKICAgICAgfSAvLyBXZSB3aWxsIGhhdmUgb25seSBvbmUgY29udGFjdCBpbiB0aGlzIGNhc2UKCgogICAgICBjb25zdCBjb250YWN0RXEgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOyAvLyBDb250YWN0IG5vcm1hbAoKICAgICAgeGoudnN1Yih4aSwgY29udGFjdEVxLm5pKTsKICAgICAgY29udGFjdEVxLm5pLm5vcm1hbGl6ZSgpOyAvLyBDb250YWN0IHBvaW50IGxvY2F0aW9ucwoKICAgICAgY29udGFjdEVxLnJpLmNvcHkoY29udGFjdEVxLm5pKTsKICAgICAgY29udGFjdEVxLnJqLmNvcHkoY29udGFjdEVxLm5pKTsKICAgICAgY29udGFjdEVxLnJpLnNjYWxlKHNpLnJhZGl1cywgY29udGFjdEVxLnJpKTsKICAgICAgY29udGFjdEVxLnJqLnNjYWxlKC1zai5yYWRpdXMsIGNvbnRhY3RFcS5yaik7CiAgICAgIGNvbnRhY3RFcS5yaS52YWRkKHhpLCBjb250YWN0RXEucmkpOwogICAgICBjb250YWN0RXEucmkudnN1YihiaS5wb3NpdGlvbiwgY29udGFjdEVxLnJpKTsKICAgICAgY29udGFjdEVxLnJqLnZhZGQoeGosIGNvbnRhY3RFcS5yaik7CiAgICAgIGNvbnRhY3RFcS5yai52c3ViKGJqLnBvc2l0aW9uLCBjb250YWN0RXEucmopOwogICAgICB0aGlzLnJlc3VsdC5wdXNoKGNvbnRhY3RFcSk7CiAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChjb250YWN0RXEsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgfQoKICAgIHNwaGVyZVBsYW5lKHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIC8vIFdlIHdpbGwgaGF2ZSBvbmUgY29udGFjdCBpbiB0aGlzIGNhc2UKICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7IC8vIENvbnRhY3Qgbm9ybWFsCgogICAgICByLm5pLnNldCgwLCAwLCAxKTsKICAgICAgcWoudm11bHQoci5uaSwgci5uaSk7CiAgICAgIHIubmkubmVnYXRlKHIubmkpOyAvLyBib2R5IGkgaXMgdGhlIHNwaGVyZSwgZmxpcCBub3JtYWwKCiAgICAgIHIubmkubm9ybWFsaXplKCk7IC8vIE5lZWRlZD8KICAgICAgLy8gVmVjdG9yIGZyb20gc3BoZXJlIGNlbnRlciB0byBjb250YWN0IHBvaW50CgogICAgICByLm5pLnNjYWxlKHNpLnJhZGl1cywgci5yaSk7IC8vIFByb2plY3QgZG93biBzcGhlcmUgb24gcGxhbmUKCiAgICAgIHhpLnZzdWIoeGosIHBvaW50X29uX3BsYW5lX3RvX3NwaGVyZSk7CiAgICAgIHIubmkuc2NhbGUoci5uaS5kb3QocG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlKSwgcGxhbmVfdG9fc3BoZXJlX29ydGhvKTsKICAgICAgcG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlLnZzdWIocGxhbmVfdG9fc3BoZXJlX29ydGhvLCByLnJqKTsgLy8gVGhlIHNwaGVyZSBwb3NpdGlvbiBwcm9qZWN0ZWQgdG8gcGxhbmUKCiAgICAgIGlmICgtcG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlLmRvdChyLm5pKSA8PSBzaS5yYWRpdXMpIHsKICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gLy8gTWFrZSBpdCByZWxhdGl2ZSB0byB0aGUgYm9keQoKCiAgICAgICAgY29uc3QgcmkgPSByLnJpOwogICAgICAgIGNvbnN0IHJqID0gci5yajsKICAgICAgICByaS52YWRkKHhpLCByaSk7CiAgICAgICAgcmkudnN1YihiaS5wb3NpdGlvbiwgcmkpOwogICAgICAgIHJqLnZhZGQoeGosIHJqKTsKICAgICAgICByai52c3ViKGJqLnBvc2l0aW9uLCByaik7CiAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgIH0KICAgIH0KCiAgICBib3hCb3goc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2kubWF0ZXJpYWw7CiAgICAgIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5tYXRlcmlhbCA9IHNqLm1hdGVyaWFsOwogICAgICBzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uY29sbGlzaW9uUmVzcG9uc2UgPSBzaS5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgc2ouY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLmNvbGxpc2lvblJlc3BvbnNlID0gc2ouY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleENvbnZleChzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgc3BoZXJlQm94KHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGNvbnN0IHYzcG9vbCA9IHRoaXMudjNwb29sOyAvLyB3ZSByZWZlciB0byB0aGUgYm94IGFzIGJvZHkgagoKICAgICAgY29uc3Qgc2lkZXMgPSBzcGhlcmVCb3hfc2lkZXM7CiAgICAgIHhpLnZzdWIoeGosIGJveF90b19zcGhlcmUpOwogICAgICBzai5nZXRTaWRlTm9ybWFscyhzaWRlcywgcWopOwogICAgICBjb25zdCBSID0gc2kucmFkaXVzOwoKICAgICAgbGV0IGZvdW5kID0gZmFsc2U7IC8vIFN0b3JlIHRoZSByZXN1bHRpbmcgc2lkZSBwZW5ldHJhdGlvbiBpbmZvCgogICAgICBjb25zdCBzaWRlX25zID0gc3BoZXJlQm94X3NpZGVfbnM7CiAgICAgIGNvbnN0IHNpZGVfbnMxID0gc3BoZXJlQm94X3NpZGVfbnMxOwogICAgICBjb25zdCBzaWRlX25zMiA9IHNwaGVyZUJveF9zaWRlX25zMjsKICAgICAgbGV0IHNpZGVfaCA9IG51bGw7CiAgICAgIGxldCBzaWRlX3BlbmV0cmF0aW9ucyA9IDA7CiAgICAgIGxldCBzaWRlX2RvdDEgPSAwOwogICAgICBsZXQgc2lkZV9kb3QyID0gMDsKICAgICAgbGV0IHNpZGVfZGlzdGFuY2UgPSBudWxsOwoKICAgICAgZm9yIChsZXQgaWR4ID0gMCwgbnNpZGVzID0gc2lkZXMubGVuZ3RoOyBpZHggIT09IG5zaWRlcyAmJiBmb3VuZCA9PT0gZmFsc2U7IGlkeCsrKSB7CiAgICAgICAgLy8gR2V0IHRoZSBwbGFuZSBzaWRlIG5vcm1hbCAobnMpCiAgICAgICAgY29uc3QgbnMgPSBzcGhlcmVCb3hfbnM7CiAgICAgICAgbnMuY29weShzaWRlc1tpZHhdKTsKICAgICAgICBjb25zdCBoID0gbnMubGVuZ3RoKCk7CiAgICAgICAgbnMubm9ybWFsaXplKCk7IC8vIFRoZSBub3JtYWwvZGlzdGFuY2UgZG90IHByb2R1Y3QgdGVsbHMgd2hpY2ggc2lkZSBvZiB0aGUgcGxhbmUgd2UgYXJlCgogICAgICAgIGNvbnN0IGRvdCA9IGJveF90b19zcGhlcmUuZG90KG5zKTsKCiAgICAgICAgaWYgKGRvdCA8IGggKyBSICYmIGRvdCA+IDApIHsKICAgICAgICAgIC8vIEludGVyc2VjdHMgcGxhbmUuIE5vdyBjaGVjayB0aGUgb3RoZXIgdHdvIGRpbWVuc2lvbnMKICAgICAgICAgIGNvbnN0IG5zMSA9IHNwaGVyZUJveF9uczE7CiAgICAgICAgICBjb25zdCBuczIgPSBzcGhlcmVCb3hfbnMyOwogICAgICAgICAgbnMxLmNvcHkoc2lkZXNbKGlkeCArIDEpICUgM10pOwogICAgICAgICAgbnMyLmNvcHkoc2lkZXNbKGlkeCArIDIpICUgM10pOwogICAgICAgICAgY29uc3QgaDEgPSBuczEubGVuZ3RoKCk7CiAgICAgICAgICBjb25zdCBoMiA9IG5zMi5sZW5ndGgoKTsKICAgICAgICAgIG5zMS5ub3JtYWxpemUoKTsKICAgICAgICAgIG5zMi5ub3JtYWxpemUoKTsKICAgICAgICAgIGNvbnN0IGRvdDEgPSBib3hfdG9fc3BoZXJlLmRvdChuczEpOwogICAgICAgICAgY29uc3QgZG90MiA9IGJveF90b19zcGhlcmUuZG90KG5zMik7CgogICAgICAgICAgaWYgKGRvdDEgPCBoMSAmJiBkb3QxID4gLWgxICYmIGRvdDIgPCBoMiAmJiBkb3QyID4gLWgyKSB7CiAgICAgICAgICAgIGNvbnN0IGRpc3QgPSBNYXRoLmFicyhkb3QgLSBoIC0gUik7CgogICAgICAgICAgICBpZiAoc2lkZV9kaXN0YW5jZSA9PT0gbnVsbCB8fCBkaXN0IDwgc2lkZV9kaXN0YW5jZSkgewogICAgICAgICAgICAgIHNpZGVfZGlzdGFuY2UgPSBkaXN0OwogICAgICAgICAgICAgIHNpZGVfZG90MSA9IGRvdDE7CiAgICAgICAgICAgICAgc2lkZV9kb3QyID0gZG90MjsKICAgICAgICAgICAgICBzaWRlX2ggPSBoOwogICAgICAgICAgICAgIHNpZGVfbnMuY29weShucyk7CiAgICAgICAgICAgICAgc2lkZV9uczEuY29weShuczEpOwogICAgICAgICAgICAgIHNpZGVfbnMyLmNvcHkobnMyKTsKICAgICAgICAgICAgICBzaWRlX3BlbmV0cmF0aW9ucysrOwoKICAgICAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHNpZGVfcGVuZXRyYXRpb25zKSB7CiAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgIHNpZGVfbnMuc2NhbGUoLVIsIHIucmkpOyAvLyBTcGhlcmUgcgoKICAgICAgICByLm5pLmNvcHkoc2lkZV9ucyk7CiAgICAgICAgci5uaS5uZWdhdGUoci5uaSk7IC8vIE5vcm1hbCBzaG91bGQgYmUgb3V0IG9mIHNwaGVyZQoKICAgICAgICBzaWRlX25zLnNjYWxlKHNpZGVfaCwgc2lkZV9ucyk7CiAgICAgICAgc2lkZV9uczEuc2NhbGUoc2lkZV9kb3QxLCBzaWRlX25zMSk7CiAgICAgICAgc2lkZV9ucy52YWRkKHNpZGVfbnMxLCBzaWRlX25zKTsKICAgICAgICBzaWRlX25zMi5zY2FsZShzaWRlX2RvdDIsIHNpZGVfbnMyKTsKICAgICAgICBzaWRlX25zLnZhZGQoc2lkZV9uczIsIHIucmopOyAvLyBNYWtlIHJlbGF0aXZlIHRvIGJvZGllcwoKICAgICAgICByLnJpLnZhZGQoeGksIHIucmkpOwogICAgICAgIHIucmkudnN1YihiaS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgci5yai52YWRkKHhqLCByLnJqKTsKICAgICAgICByLnJqLnZzdWIoYmoucG9zaXRpb24sIHIucmopOwogICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICB9IC8vIENoZWNrIGNvcm5lcnMKCgogICAgICBsZXQgcmogPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IHNwaGVyZV90b19jb3JuZXIgPSBzcGhlcmVCb3hfc3BoZXJlX3RvX2Nvcm5lcjsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSAyICYmICFmb3VuZDsgaisrKSB7CiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgIT09IDIgJiYgIWZvdW5kOyBrKyspIHsKICAgICAgICAgIGZvciAobGV0IGwgPSAwOyBsICE9PSAyICYmICFmb3VuZDsgbCsrKSB7CiAgICAgICAgICAgIHJqLnNldCgwLCAwLCAwKTsKCiAgICAgICAgICAgIGlmIChqKSB7CiAgICAgICAgICAgICAgcmoudmFkZChzaWRlc1swXSwgcmopOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJqLnZzdWIoc2lkZXNbMF0sIHJqKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGspIHsKICAgICAgICAgICAgICByai52YWRkKHNpZGVzWzFdLCByaik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcmoudnN1YihzaWRlc1sxXSwgcmopOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAobCkgewogICAgICAgICAgICAgIHJqLnZhZGQoc2lkZXNbMl0sIHJqKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByai52c3ViKHNpZGVzWzJdLCByaik7CiAgICAgICAgICAgIH0gLy8gV29ybGQgcG9zaXRpb24gb2YgY29ybmVyCgoKICAgICAgICAgICAgeGoudmFkZChyaiwgc3BoZXJlX3RvX2Nvcm5lcik7CiAgICAgICAgICAgIHNwaGVyZV90b19jb3JuZXIudnN1Yih4aSwgc3BoZXJlX3RvX2Nvcm5lcik7CgogICAgICAgICAgICBpZiAoc3BoZXJlX3RvX2Nvcm5lci5sZW5ndGhTcXVhcmVkKCkgPCBSICogUikgewogICAgICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICAgICAgci5yaS5jb3B5KHNwaGVyZV90b19jb3JuZXIpOwogICAgICAgICAgICAgIHIucmkubm9ybWFsaXplKCk7CiAgICAgICAgICAgICAgci5uaS5jb3B5KHIucmkpOwogICAgICAgICAgICAgIHIucmkuc2NhbGUoUiwgci5yaSk7CiAgICAgICAgICAgICAgci5yai5jb3B5KHJqKTsgLy8gTWFrZSByZWxhdGl2ZSB0byBib2RpZXMKCiAgICAgICAgICAgICAgci5yaS52YWRkKHhpLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZzdWIoYmkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgICAgIHIucmoudmFkZCh4aiwgci5yaik7CiAgICAgICAgICAgICAgci5yai52c3ViKGJqLnBvc2l0aW9uLCByLnJqKTsKICAgICAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdjNwb29sLnJlbGVhc2UocmopOwogICAgICByaiA9IG51bGw7IC8vIENoZWNrIGVkZ2VzCgogICAgICBjb25zdCBlZGdlVGFuZ2VudCA9IHYzcG9vbC5nZXQoKTsKICAgICAgY29uc3QgZWRnZUNlbnRlciA9IHYzcG9vbC5nZXQoKTsKICAgICAgY29uc3QgciA9IHYzcG9vbC5nZXQoKTsgLy8gciA9IGVkZ2UgY2VudGVyIHRvIHNwaGVyZSBjZW50ZXIKCiAgICAgIGNvbnN0IG9ydGhvZ29uYWwgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IGRpc3QgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IE5zaWRlcyA9IHNpZGVzLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBOc2lkZXMgJiYgIWZvdW5kOyBqKyspIHsKICAgICAgICBmb3IgKGxldCBrID0gMDsgayAhPT0gTnNpZGVzICYmICFmb3VuZDsgaysrKSB7CiAgICAgICAgICBpZiAoaiAlIDMgIT09IGsgJSAzKSB7CiAgICAgICAgICAgIC8vIEdldCBlZGdlIHRhbmdlbnQKICAgICAgICAgICAgc2lkZXNba10uY3Jvc3Moc2lkZXNbal0sIGVkZ2VUYW5nZW50KTsKICAgICAgICAgICAgZWRnZVRhbmdlbnQubm9ybWFsaXplKCk7CiAgICAgICAgICAgIHNpZGVzW2pdLnZhZGQoc2lkZXNba10sIGVkZ2VDZW50ZXIpOwogICAgICAgICAgICByLmNvcHkoeGkpOwogICAgICAgICAgICByLnZzdWIoZWRnZUNlbnRlciwgcik7CiAgICAgICAgICAgIHIudnN1Yih4aiwgcik7CiAgICAgICAgICAgIGNvbnN0IG9ydGhvbm9ybSA9IHIuZG90KGVkZ2VUYW5nZW50KTsgLy8gZGlzdGFuY2UgZnJvbSBlZGdlIGNlbnRlciB0byBzcGhlcmUgY2VudGVyIGluIHRoZSB0YW5nZW50IGRpcmVjdGlvbgoKICAgICAgICAgICAgZWRnZVRhbmdlbnQuc2NhbGUob3J0aG9ub3JtLCBvcnRob2dvbmFsKTsgLy8gVmVjdG9yIGZyb20gZWRnZSBjZW50ZXIgdG8gc3BoZXJlIGNlbnRlciBpbiB0aGUgdGFuZ2VudCBkaXJlY3Rpb24KICAgICAgICAgICAgLy8gRmluZCB0aGUgdGhpcmQgc2lkZSBvcnRob2dvbmFsIHRvIHRoaXMgb25lCgogICAgICAgICAgICBsZXQgbCA9IDA7CgogICAgICAgICAgICB3aGlsZSAobCA9PT0gaiAlIDMgfHwgbCA9PT0gayAlIDMpIHsKICAgICAgICAgICAgICBsKys7CiAgICAgICAgICAgIH0gLy8gdmVjIGZyb20gZWRnZSBjZW50ZXIgdG8gc3BoZXJlIHByb2plY3RlZCB0byB0aGUgcGxhbmUgb3J0aG9nb25hbCB0byB0aGUgZWRnZSB0YW5nZW50CgoKICAgICAgICAgICAgZGlzdC5jb3B5KHhpKTsKICAgICAgICAgICAgZGlzdC52c3ViKG9ydGhvZ29uYWwsIGRpc3QpOwogICAgICAgICAgICBkaXN0LnZzdWIoZWRnZUNlbnRlciwgZGlzdCk7CiAgICAgICAgICAgIGRpc3QudnN1Yih4aiwgZGlzdCk7IC8vIERpc3RhbmNlcyBpbiB0YW5nZW50IGRpcmVjdGlvbiBhbmQgZGlzdGFuY2UgaW4gdGhlIHBsYW5lIG9ydGhvZ29uYWwgdG8gaXQKCiAgICAgICAgICAgIGNvbnN0IHRkaXN0ID0gTWF0aC5hYnMob3J0aG9ub3JtKTsKICAgICAgICAgICAgY29uc3QgbmRpc3QgPSBkaXN0Lmxlbmd0aCgpOwoKICAgICAgICAgICAgaWYgKHRkaXN0IDwgc2lkZXNbbF0ubGVuZ3RoKCkgJiYgbmRpc3QgPCBSKSB7CiAgICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgICBjb25zdCByZXMgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgICAgIGVkZ2VDZW50ZXIudmFkZChvcnRob2dvbmFsLCByZXMucmopOyAvLyBib3ggcmoKCiAgICAgICAgICAgICAgcmVzLnJqLmNvcHkocmVzLnJqKTsKICAgICAgICAgICAgICBkaXN0Lm5lZ2F0ZShyZXMubmkpOwogICAgICAgICAgICAgIHJlcy5uaS5ub3JtYWxpemUoKTsKICAgICAgICAgICAgICByZXMucmkuY29weShyZXMucmopOwogICAgICAgICAgICAgIHJlcy5yaS52YWRkKHhqLCByZXMucmkpOwogICAgICAgICAgICAgIHJlcy5yaS52c3ViKHhpLCByZXMucmkpOwogICAgICAgICAgICAgIHJlcy5yaS5ub3JtYWxpemUoKTsKICAgICAgICAgICAgICByZXMucmkuc2NhbGUoUiwgcmVzLnJpKTsgLy8gTWFrZSByZWxhdGl2ZSB0byBib2RpZXMKCiAgICAgICAgICAgICAgcmVzLnJpLnZhZGQoeGksIHJlcy5yaSk7CiAgICAgICAgICAgICAgcmVzLnJpLnZzdWIoYmkucG9zaXRpb24sIHJlcy5yaSk7CiAgICAgICAgICAgICAgcmVzLnJqLnZhZGQoeGosIHJlcy5yaik7CiAgICAgICAgICAgICAgcmVzLnJqLnZzdWIoYmoucG9zaXRpb24sIHJlcy5yaik7CiAgICAgICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyZXMpOwogICAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyZXMsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB2M3Bvb2wucmVsZWFzZShlZGdlVGFuZ2VudCwgZWRnZUNlbnRlciwgciwgb3J0aG9nb25hbCwgZGlzdCk7CiAgICB9CgogICAgcGxhbmVCb3goc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2ouY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2oubWF0ZXJpYWw7CiAgICAgIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNqLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICBzai5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uaWQgPSBzai5pZDsKICAgICAgcmV0dXJuIHRoaXMucGxhbmVDb252ZXgoc2ksIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgY29udmV4Q29udmV4KHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0LCBmYWNlTGlzdEEsIGZhY2VMaXN0QikgewogICAgICBjb25zdCBzZXBBeGlzID0gY29udmV4Q29udmV4X3NlcEF4aXM7CgogICAgICBpZiAoeGkuZGlzdGFuY2VUbyh4aikgPiBzaS5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNqLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoc2kuZmluZFNlcGFyYXRpbmdBeGlzKHNqLCB4aSwgcWksIHhqLCBxaiwgc2VwQXhpcywgZmFjZUxpc3RBLCBmYWNlTGlzdEIpKSB7CiAgICAgICAgY29uc3QgcmVzID0gW107CiAgICAgICAgY29uc3QgcSA9IGNvbnZleENvbnZleF9xOwogICAgICAgIHNpLmNsaXBBZ2FpbnN0SHVsbCh4aSwgcWksIHNqLCB4aiwgcWosIHNlcEF4aXMsIC0xMDAsIDEwMCwgcmVzKTsKICAgICAgICBsZXQgbnVtQ29udGFjdHMgPSAwOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiAhPT0gcmVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICBjb25zdCByaSA9IHIucmk7CiAgICAgICAgICBjb25zdCByaiA9IHIucmo7CiAgICAgICAgICBzZXBBeGlzLm5lZ2F0ZShyLm5pKTsKICAgICAgICAgIHJlc1tqXS5ub3JtYWwubmVnYXRlKHEpOwogICAgICAgICAgcS5zY2FsZShyZXNbal0uZGVwdGgsIHEpOwogICAgICAgICAgcmVzW2pdLnBvaW50LnZhZGQocSwgcmkpOwogICAgICAgICAgcmouY29weShyZXNbal0ucG9pbnQpOyAvLyBDb250YWN0IHBvaW50cyBhcmUgaW4gd29ybGQgY29vcmRpbmF0ZXMuIFRyYW5zZm9ybSBiYWNrIHRvIHJlbGF0aXZlCgogICAgICAgICAgcmkudnN1Yih4aSwgcmkpOwogICAgICAgICAgcmoudnN1Yih4aiwgcmopOyAvLyBNYWtlIHJlbGF0aXZlIHRvIGJvZGllcwoKICAgICAgICAgIHJpLnZhZGQoeGksIHJpKTsKICAgICAgICAgIHJpLnZzdWIoYmkucG9zaXRpb24sIHJpKTsKICAgICAgICAgIHJqLnZhZGQoeGosIHJqKTsKICAgICAgICAgIHJqLnZzdWIoYmoucG9zaXRpb24sIHJqKTsKICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICBudW1Db250YWN0cysrOwoKICAgICAgICAgIGlmICghdGhpcy5lbmFibGVGcmljdGlvblJlZHVjdGlvbikgewogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5lbmFibGVGcmljdGlvblJlZHVjdGlvbiAmJiBudW1Db250YWN0cykgewogICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkZyb21BdmVyYWdlKG51bUNvbnRhY3RzKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBzcGhlcmVDb252ZXgoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgY29uc3QgdjNwb29sID0gdGhpcy52M3Bvb2w7CiAgICAgIHhpLnZzdWIoeGosIGNvbnZleF90b19zcGhlcmUpOwogICAgICBjb25zdCBub3JtYWxzID0gc2ouZmFjZU5vcm1hbHM7CiAgICAgIGNvbnN0IGZhY2VzID0gc2ouZmFjZXM7CiAgICAgIGNvbnN0IHZlcnRzID0gc2oudmVydGljZXM7CiAgICAgIGNvbnN0IFIgPSBzaS5yYWRpdXM7CiAgICAgIC8vICAgICByZXR1cm47CiAgICAgIC8vIH0KCiAgICAgIGxldCBmb3VuZCA9IGZhbHNlOyAvLyBDaGVjayBjb3JuZXJzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gdmVydHNbaV07IC8vIFdvcmxkIHBvc2l0aW9uIG9mIGNvcm5lcgoKICAgICAgICBjb25zdCB3b3JsZENvcm5lciA9IHNwaGVyZUNvbnZleF93b3JsZENvcm5lcjsKICAgICAgICBxai52bXVsdCh2LCB3b3JsZENvcm5lcik7CiAgICAgICAgeGoudmFkZCh3b3JsZENvcm5lciwgd29ybGRDb3JuZXIpOwogICAgICAgIGNvbnN0IHNwaGVyZV90b19jb3JuZXIgPSBzcGhlcmVDb252ZXhfc3BoZXJlVG9Db3JuZXI7CiAgICAgICAgd29ybGRDb3JuZXIudnN1Yih4aSwgc3BoZXJlX3RvX2Nvcm5lcik7CgogICAgICAgIGlmIChzcGhlcmVfdG9fY29ybmVyLmxlbmd0aFNxdWFyZWQoKSA8IFIgKiBSKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICByLnJpLmNvcHkoc3BoZXJlX3RvX2Nvcm5lcik7CiAgICAgICAgICByLnJpLm5vcm1hbGl6ZSgpOwogICAgICAgICAgci5uaS5jb3B5KHIucmkpOwogICAgICAgICAgci5yaS5zY2FsZShSLCByLnJpKTsKICAgICAgICAgIHdvcmxkQ29ybmVyLnZzdWIoeGosIHIucmopOyAvLyBTaG91bGQgYmUgcmVsYXRpdmUgdG8gdGhlIGJvZHkuCgogICAgICAgICAgci5yaS52YWRkKHhpLCByLnJpKTsKICAgICAgICAgIHIucmkudnN1YihiaS5wb3NpdGlvbiwgci5yaSk7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICByLnJqLnZhZGQoeGosIHIucmopOwogICAgICAgICAgci5yai52c3ViKGJqLnBvc2l0aW9uLCByLnJqKTsKICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9IC8vIENoZWNrIHNpZGUgKHBsYW5lKSBpbnRlcnNlY3Rpb25zCgoKICAgICAgZm9yIChsZXQgaSA9IDAsIG5mYWNlcyA9IGZhY2VzLmxlbmd0aDsgaSAhPT0gbmZhY2VzICYmIGZvdW5kID09PSBmYWxzZTsgaSsrKSB7CiAgICAgICAgY29uc3Qgbm9ybWFsID0gbm9ybWFsc1tpXTsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbaV07IC8vIEdldCB3b3JsZC10cmFuc2Zvcm1lZCBub3JtYWwgb2YgdGhlIGZhY2UKCiAgICAgICAgY29uc3Qgd29ybGROb3JtYWwgPSBzcGhlcmVDb252ZXhfd29ybGROb3JtYWw7CiAgICAgICAgcWoudm11bHQobm9ybWFsLCB3b3JsZE5vcm1hbCk7IC8vIEdldCBhIHdvcmxkIHZlcnRleCBmcm9tIHRoZSBmYWNlCgogICAgICAgIGNvbnN0IHdvcmxkUG9pbnQgPSBzcGhlcmVDb252ZXhfd29ybGRQb2ludDsKICAgICAgICBxai52bXVsdCh2ZXJ0c1tmYWNlWzBdXSwgd29ybGRQb2ludCk7CiAgICAgICAgd29ybGRQb2ludC52YWRkKHhqLCB3b3JsZFBvaW50KTsgLy8gR2V0IGEgcG9pbnQgb24gdGhlIHNwaGVyZSwgY2xvc2VzdCB0byB0aGUgZmFjZSBub3JtYWwKCiAgICAgICAgY29uc3Qgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lID0gc3BoZXJlQ29udmV4X3dvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZTsKICAgICAgICB3b3JsZE5vcm1hbC5zY2FsZSgtUiwgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lKTsKICAgICAgICB4aS52YWRkKHdvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZSwgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lKTsgLy8gVmVjdG9yIGZyb20gYSBmYWNlIHBvaW50IHRvIHRoZSBjbG9zZXN0IHBvaW50IG9uIHRoZSBzcGhlcmUKCiAgICAgICAgY29uc3QgcGVuZXRyYXRpb25WZWMgPSBzcGhlcmVDb252ZXhfcGVuZXRyYXRpb25WZWM7CiAgICAgICAgd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lLnZzdWIod29ybGRQb2ludCwgcGVuZXRyYXRpb25WZWMpOyAvLyBUaGUgcGVuZXRyYXRpb24uIE5lZ2F0aXZlIHZhbHVlIG1lYW5zIG92ZXJsYXAuCgogICAgICAgIGNvbnN0IHBlbmV0cmF0aW9uID0gcGVuZXRyYXRpb25WZWMuZG90KHdvcmxkTm9ybWFsKTsKICAgICAgICBjb25zdCB3b3JsZFBvaW50VG9TcGhlcmUgPSBzcGhlcmVDb252ZXhfc3BoZXJlVG9Xb3JsZFBvaW50OwogICAgICAgIHhpLnZzdWIod29ybGRQb2ludCwgd29ybGRQb2ludFRvU3BoZXJlKTsKCiAgICAgICAgaWYgKHBlbmV0cmF0aW9uIDwgMCAmJiB3b3JsZFBvaW50VG9TcGhlcmUuZG90KHdvcmxkTm9ybWFsKSA+IDApIHsKICAgICAgICAgIC8vIEludGVyc2VjdHMgcGxhbmUuIE5vdyBjaGVjayBpZiB0aGUgc3BoZXJlIGlzIGluc2lkZSB0aGUgZmFjZSBwb2x5Z29uCiAgICAgICAgICBjb25zdCBmYWNlVmVydHMgPSBbXTsgLy8gRmFjZSB2ZXJ0aWNlcywgaW4gd29ybGQgY29vcmRzCgogICAgICAgICAgZm9yIChsZXQgaiA9IDAsIE52ZXJ0cyA9IGZhY2UubGVuZ3RoOyBqICE9PSBOdmVydHM7IGorKykgewogICAgICAgICAgICBjb25zdCB3b3JsZFZlcnRleCA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgcWoudm11bHQodmVydHNbZmFjZVtqXV0sIHdvcmxkVmVydGV4KTsKICAgICAgICAgICAgeGoudmFkZCh3b3JsZFZlcnRleCwgd29ybGRWZXJ0ZXgpOwogICAgICAgICAgICBmYWNlVmVydHMucHVzaCh3b3JsZFZlcnRleCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHBvaW50SW5Qb2x5Z29uKGZhY2VWZXJ0cywgd29ybGROb3JtYWwsIHhpKSkgewogICAgICAgICAgICAvLyBJcyB0aGUgc3BoZXJlIGNlbnRlciBpbiB0aGUgZmFjZSBwb2x5Z29uPwogICAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICAgICAgd29ybGROb3JtYWwuc2NhbGUoLVIsIHIucmkpOyAvLyBDb250YWN0IG9mZnNldCwgZnJvbSBzcGhlcmUgY2VudGVyIHRvIGNvbnRhY3QKCiAgICAgICAgICAgIHdvcmxkTm9ybWFsLm5lZ2F0ZShyLm5pKTsgLy8gTm9ybWFsIHBvaW50aW5nIG91dCBvZiBzcGhlcmUKCiAgICAgICAgICAgIGNvbnN0IHBlbmV0cmF0aW9uVmVjMiA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgd29ybGROb3JtYWwuc2NhbGUoLXBlbmV0cmF0aW9uLCBwZW5ldHJhdGlvblZlYzIpOwogICAgICAgICAgICBjb25zdCBwZW5ldHJhdGlvblNwaGVyZVBvaW50ID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICB3b3JsZE5vcm1hbC5zY2FsZSgtUiwgcGVuZXRyYXRpb25TcGhlcmVQb2ludCk7IC8veGkudnN1Yih4aikudmFkZChwZW5ldHJhdGlvblNwaGVyZVBvaW50KS52YWRkKHBlbmV0cmF0aW9uVmVjMiAsIHIucmopOwoKICAgICAgICAgICAgeGkudnN1Yih4aiwgci5yaik7CiAgICAgICAgICAgIHIucmoudmFkZChwZW5ldHJhdGlvblNwaGVyZVBvaW50LCByLnJqKTsKICAgICAgICAgICAgci5yai52YWRkKHBlbmV0cmF0aW9uVmVjMiwgci5yaik7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICAgIHIucmoudmFkZCh4aiwgci5yaik7CiAgICAgICAgICAgIHIucmoudnN1Yihiai5wb3NpdGlvbiwgci5yaik7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICAgIHIucmkudmFkZCh4aSwgci5yaSk7CiAgICAgICAgICAgIHIucmkudnN1YihiaS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHBlbmV0cmF0aW9uVmVjMik7CiAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHBlbmV0cmF0aW9uU3BoZXJlUG9pbnQpOwogICAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7IC8vIFJlbGVhc2Ugd29ybGQgdmVydGljZXMKCiAgICAgICAgICAgIGZvciAobGV0IGogPSAwLCBOZmFjZXZlcnRzID0gZmFjZVZlcnRzLmxlbmd0aDsgaiAhPT0gTmZhY2V2ZXJ0czsgaisrKSB7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UoZmFjZVZlcnRzW2pdKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuOyAvLyBXZSBvbmx5IGV4cGVjdCAqb25lKiBmYWNlIGNvbnRhY3QKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIEVkZ2U/CiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBmYWNlLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgLy8gR2V0IHR3byB3b3JsZCB0cmFuc2Zvcm1lZCB2ZXJ0aWNlcwogICAgICAgICAgICAgIGNvbnN0IHYxID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIGNvbnN0IHYyID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIHFqLnZtdWx0KHZlcnRzW2ZhY2VbKGogKyAxKSAlIGZhY2UubGVuZ3RoXV0sIHYxKTsKICAgICAgICAgICAgICBxai52bXVsdCh2ZXJ0c1tmYWNlWyhqICsgMikgJSBmYWNlLmxlbmd0aF1dLCB2Mik7CiAgICAgICAgICAgICAgeGoudmFkZCh2MSwgdjEpOwogICAgICAgICAgICAgIHhqLnZhZGQodjIsIHYyKTsgLy8gQ29uc3RydWN0IGVkZ2UgdmVjdG9yCgogICAgICAgICAgICAgIGNvbnN0IGVkZ2UgPSBzcGhlcmVDb252ZXhfZWRnZTsKICAgICAgICAgICAgICB2Mi52c3ViKHYxLCBlZGdlKTsgLy8gQ29uc3RydWN0IHRoZSBzYW1lIHZlY3RvciwgYnV0IG5vcm1hbGl6ZWQKCiAgICAgICAgICAgICAgY29uc3QgZWRnZVVuaXQgPSBzcGhlcmVDb252ZXhfZWRnZVVuaXQ7CiAgICAgICAgICAgICAgZWRnZS51bml0KGVkZ2VVbml0KTsgLy8gcCBpcyB4aSBwcm9qZWN0ZWQgb250byB0aGUgZWRnZQoKICAgICAgICAgICAgICBjb25zdCBwID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIGNvbnN0IHYxX3RvX3hpID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIHhpLnZzdWIodjEsIHYxX3RvX3hpKTsKICAgICAgICAgICAgICBjb25zdCBkb3QgPSB2MV90b194aS5kb3QoZWRnZVVuaXQpOwogICAgICAgICAgICAgIGVkZ2VVbml0LnNjYWxlKGRvdCwgcCk7CiAgICAgICAgICAgICAgcC52YWRkKHYxLCBwKTsgLy8gQ29tcHV0ZSBhIHZlY3RvciBmcm9tIHAgdG8gdGhlIGNlbnRlciBvZiB0aGUgc3BoZXJlCgogICAgICAgICAgICAgIGNvbnN0IHhpX3RvX3AgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgICAgICAgICAgcC52c3ViKHhpLCB4aV90b19wKTsgLy8gQ29sbGlzaW9uIGlmIHRoZSBlZGdlLXNwaGVyZSBkaXN0YW5jZSBpcyBsZXNzIHRoYW4gdGhlIHJhZGl1cwogICAgICAgICAgICAgIC8vIEFORCBpZiBwIGlzIGluIGJldHdlZW4gdjEgYW5kIHYyCgogICAgICAgICAgICAgIGlmIChkb3QgPiAwICYmIGRvdCAqIGRvdCA8IGVkZ2UubGVuZ3RoU3F1YXJlZCgpICYmIHhpX3RvX3AubGVuZ3RoU3F1YXJlZCgpIDwgUiAqIFIpIHsKICAgICAgICAgICAgICAgIC8vIENvbGxpc2lvbiBpZiB0aGUgZWRnZS1zcGhlcmUgZGlzdGFuY2UgaXMgbGVzcyB0aGFuIHRoZSByYWRpdXMKICAgICAgICAgICAgICAgIC8vIEVkZ2UgY29udGFjdCEKICAgICAgICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICAgICAgICAgIHAudnN1Yih4aiwgci5yaik7CiAgICAgICAgICAgICAgICBwLnZzdWIoeGksIHIubmkpOwogICAgICAgICAgICAgICAgci5uaS5ub3JtYWxpemUoKTsKICAgICAgICAgICAgICAgIHIubmkuc2NhbGUoUiwgci5yaSk7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICAgICAgICByLnJqLnZhZGQoeGosIHIucmopOwogICAgICAgICAgICAgICAgci5yai52c3ViKGJqLnBvc2l0aW9uLCByLnJqKTsgLy8gU2hvdWxkIGJlIHJlbGF0aXZlIHRvIHRoZSBib2R5LgoKICAgICAgICAgICAgICAgIHIucmkudmFkZCh4aSwgci5yaSk7CiAgICAgICAgICAgICAgICByLnJpLnZzdWIoYmkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsgLy8gUmVsZWFzZSB3b3JsZCB2ZXJ0aWNlcwoKICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwLCBOZmFjZXZlcnRzID0gZmFjZVZlcnRzLmxlbmd0aDsgaiAhPT0gTmZhY2V2ZXJ0czsgaisrKSB7CiAgICAgICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKGZhY2VWZXJ0c1tqXSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UodjEpOwogICAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UodjIpOwogICAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UocCk7CiAgICAgICAgICAgICAgICB2M3Bvb2wucmVsZWFzZSh4aV90b19wKTsKICAgICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHYxX3RvX3hpKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHYxKTsKICAgICAgICAgICAgICB2M3Bvb2wucmVsZWFzZSh2Mik7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UocCk7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UoeGlfdG9fcCk7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UodjFfdG9feGkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IC8vIFJlbGVhc2Ugd29ybGQgdmVydGljZXMKCgogICAgICAgICAgZm9yIChsZXQgaiA9IDAsIE5mYWNldmVydHMgPSBmYWNlVmVydHMubGVuZ3RoOyBqICE9PSBOZmFjZXZlcnRzOyBqKyspIHsKICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UoZmFjZVZlcnRzW2pdKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBwbGFuZUNvbnZleChwbGFuZVNoYXBlLCBjb252ZXhTaGFwZSwgcGxhbmVQb3NpdGlvbiwgY29udmV4UG9zaXRpb24sIHBsYW5lUXVhdCwgY29udmV4UXVhdCwgcGxhbmVCb2R5LCBjb252ZXhCb2R5LCBzaSwgc2osIGp1c3RUZXN0KSB7CiAgICAgIC8vIFNpbXBseSByZXR1cm4gdGhlIHBvaW50cyBiZWhpbmQgdGhlIHBsYW5lLgogICAgICBjb25zdCB3b3JsZFZlcnRleCA9IHBsYW5lQ29udmV4X3Y7CiAgICAgIGNvbnN0IHdvcmxkTm9ybWFsID0gcGxhbmVDb252ZXhfbm9ybWFsOwogICAgICB3b3JsZE5vcm1hbC5zZXQoMCwgMCwgMSk7CiAgICAgIHBsYW5lUXVhdC52bXVsdCh3b3JsZE5vcm1hbCwgd29ybGROb3JtYWwpOyAvLyBUdXJuIG5vcm1hbCBhY2NvcmRpbmcgdG8gcGxhbmUgb3JpZW50YXRpb24KCiAgICAgIGxldCBudW1Db250YWN0cyA9IDA7CiAgICAgIGNvbnN0IHJlbHBvcyA9IHBsYW5lQ29udmV4X3JlbHBvczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBjb252ZXhTaGFwZS52ZXJ0aWNlcy5sZW5ndGg7IGkrKykgewogICAgICAgIC8vIEdldCB3b3JsZCBjb252ZXggdmVydGV4CiAgICAgICAgd29ybGRWZXJ0ZXguY29weShjb252ZXhTaGFwZS52ZXJ0aWNlc1tpXSk7CiAgICAgICAgY29udmV4UXVhdC52bXVsdCh3b3JsZFZlcnRleCwgd29ybGRWZXJ0ZXgpOwogICAgICAgIGNvbnZleFBvc2l0aW9uLnZhZGQod29ybGRWZXJ0ZXgsIHdvcmxkVmVydGV4KTsKICAgICAgICB3b3JsZFZlcnRleC52c3ViKHBsYW5lUG9zaXRpb24sIHJlbHBvcyk7CiAgICAgICAgY29uc3QgZG90ID0gd29ybGROb3JtYWwuZG90KHJlbHBvcyk7CgogICAgICAgIGlmIChkb3QgPD0gMC4wKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKHBsYW5lQm9keSwgY29udmV4Qm9keSwgcGxhbmVTaGFwZSwgY29udmV4U2hhcGUsIHNpLCBzaik7IC8vIEdldCB2ZXJ0ZXggcG9zaXRpb24gcHJvamVjdGVkIG9uIHBsYW5lCgogICAgICAgICAgY29uc3QgcHJvamVjdGVkID0gcGxhbmVDb252ZXhfcHJvamVjdGVkOwogICAgICAgICAgd29ybGROb3JtYWwuc2NhbGUod29ybGROb3JtYWwuZG90KHJlbHBvcyksIHByb2plY3RlZCk7CiAgICAgICAgICB3b3JsZFZlcnRleC52c3ViKHByb2plY3RlZCwgcHJvamVjdGVkKTsKICAgICAgICAgIHByb2plY3RlZC52c3ViKHBsYW5lUG9zaXRpb24sIHIucmkpOyAvLyBGcm9tIHBsYW5lIHRvIHZlcnRleCBwcm9qZWN0ZWQgb24gcGxhbmUKCiAgICAgICAgICByLm5pLmNvcHkod29ybGROb3JtYWwpOyAvLyBDb250YWN0IG5vcm1hbCBpcyB0aGUgcGxhbmUgbm9ybWFsIG91dCBmcm9tIHBsYW5lCiAgICAgICAgICAvLyByaiBpcyBub3cganVzdCB0aGUgdmVjdG9yIGZyb20gdGhlIGNvbnZleCBjZW50ZXIgdG8gdGhlIHZlcnRleAoKICAgICAgICAgIHdvcmxkVmVydGV4LnZzdWIoY29udmV4UG9zaXRpb24sIHIucmopOyAvLyBNYWtlIGl0IHJlbGF0aXZlIHRvIHRoZSBib2R5CgogICAgICAgICAgci5yaS52YWRkKHBsYW5lUG9zaXRpb24sIHIucmkpOwogICAgICAgICAgci5yaS52c3ViKHBsYW5lQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICByLnJqLnZhZGQoY29udmV4UG9zaXRpb24sIHIucmopOwogICAgICAgICAgci5yai52c3ViKGNvbnZleEJvZHkucG9zaXRpb24sIHIucmopOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIG51bUNvbnRhY3RzKys7CgogICAgICAgICAgaWYgKCF0aGlzLmVuYWJsZUZyaWN0aW9uUmVkdWN0aW9uKSB7CiAgICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmVuYWJsZUZyaWN0aW9uUmVkdWN0aW9uICYmIG51bUNvbnRhY3RzKSB7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkZyb21BdmVyYWdlKG51bUNvbnRhY3RzKTsKICAgICAgfQogICAgfQoKICAgIGJveENvbnZleChzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24ubWF0ZXJpYWwgPSBzaS5tYXRlcmlhbDsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLmNvbGxpc2lvblJlc3BvbnNlID0gc2kuY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleENvbnZleChzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgIH0KCiAgICBzcGhlcmVIZWlnaHRmaWVsZChzcGhlcmVTaGFwZSwgaGZTaGFwZSwgc3BoZXJlUG9zLCBoZlBvcywgc3BoZXJlUXVhdCwgaGZRdWF0LCBzcGhlcmVCb2R5LCBoZkJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBjb25zdCBkYXRhID0gaGZTaGFwZS5kYXRhOwogICAgICBjb25zdCByYWRpdXMgPSBzcGhlcmVTaGFwZS5yYWRpdXM7CiAgICAgIGNvbnN0IHcgPSBoZlNoYXBlLmVsZW1lbnRTaXplOwogICAgICBjb25zdCB3b3JsZFBpbGxhck9mZnNldCA9IHNwaGVyZUhlaWdodGZpZWxkX3RtcDI7IC8vIEdldCBzcGhlcmUgcG9zaXRpb24gdG8gaGVpZ2h0ZmllbGQgbG9jYWwhCgogICAgICBjb25zdCBsb2NhbFNwaGVyZVBvcyA9IHNwaGVyZUhlaWdodGZpZWxkX3RtcDE7CiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZShoZlBvcywgaGZRdWF0LCBzcGhlcmVQb3MsIGxvY2FsU3BoZXJlUG9zKTsgLy8gR2V0IHRoZSBpbmRleCBvZiB0aGUgZGF0YSBwb2ludHMgdG8gdGVzdCBhZ2FpbnN0CgogICAgICBsZXQgaU1pblggPSBNYXRoLmZsb29yKChsb2NhbFNwaGVyZVBvcy54IC0gcmFkaXVzKSAvIHcpIC0gMTsKICAgICAgbGV0IGlNYXhYID0gTWF0aC5jZWlsKChsb2NhbFNwaGVyZVBvcy54ICsgcmFkaXVzKSAvIHcpICsgMTsKICAgICAgbGV0IGlNaW5ZID0gTWF0aC5mbG9vcigobG9jYWxTcGhlcmVQb3MueSAtIHJhZGl1cykgLyB3KSAtIDE7CiAgICAgIGxldCBpTWF4WSA9IE1hdGguY2VpbCgobG9jYWxTcGhlcmVQb3MueSArIHJhZGl1cykgLyB3KSArIDE7IC8vIEJhaWwgb3V0IGlmIHdlIGFyZSBvdXQgb2YgdGhlIHRlcnJhaW4KCiAgICAgIGlmIChpTWF4WCA8IDAgfHwgaU1heFkgPCAwIHx8IGlNaW5YID4gZGF0YS5sZW5ndGggfHwgaU1pblkgPiBkYXRhWzBdLmxlbmd0aCkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBDbGFtcCBpbmRleCB0byBlZGdlcwoKCiAgICAgIGlmIChpTWluWCA8IDApIHsKICAgICAgICBpTWluWCA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WCA8IDApIHsKICAgICAgICBpTWF4WCA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWSA8IDApIHsKICAgICAgICBpTWluWSA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WSA8IDApIHsKICAgICAgICBpTWF4WSA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWCA+PSBkYXRhLmxlbmd0aCkgewogICAgICAgIGlNaW5YID0gZGF0YS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBpZiAoaU1heFggPj0gZGF0YS5sZW5ndGgpIHsKICAgICAgICBpTWF4WCA9IGRhdGEubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgaWYgKGlNYXhZID49IGRhdGFbMF0ubGVuZ3RoKSB7CiAgICAgICAgaU1heFkgPSBkYXRhWzBdLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWSA+PSBkYXRhWzBdLmxlbmd0aCkgewogICAgICAgIGlNaW5ZID0gZGF0YVswXS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBjb25zdCBtaW5NYXggPSBbXTsKICAgICAgaGZTaGFwZS5nZXRSZWN0TWluTWF4KGlNaW5YLCBpTWluWSwgaU1heFgsIGlNYXhZLCBtaW5NYXgpOwogICAgICBjb25zdCBtaW4gPSBtaW5NYXhbMF07CiAgICAgIGNvbnN0IG1heCA9IG1pbk1heFsxXTsgLy8gQmFpbCBvdXQgaWYgd2UgY2FuJ3QgdG91Y2ggdGhlIGJvdW5kaW5nIGhlaWdodCBib3gKCiAgICAgIGlmIChsb2NhbFNwaGVyZVBvcy56IC0gcmFkaXVzID4gbWF4IHx8IGxvY2FsU3BoZXJlUG9zLnogKyByYWRpdXMgPCBtaW4pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMucmVzdWx0OwoKICAgICAgZm9yIChsZXQgaSA9IGlNaW5YOyBpIDwgaU1heFg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSBpTWluWTsgaiA8IGlNYXhZOyBqKyspIHsKICAgICAgICAgIGNvbnN0IG51bUNvbnRhY3RzQmVmb3JlID0gcmVzdWx0Lmxlbmd0aDsKICAgICAgICAgIGxldCBpbnRlcnNlY3RpbmcgPSBmYWxzZTsgLy8gTG93ZXIgdHJpYW5nbGUKCiAgICAgICAgICBoZlNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIGZhbHNlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShoZlBvcywgaGZRdWF0LCBoZlNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIGlmIChzcGhlcmVQb3MuZGlzdGFuY2VUbyh3b3JsZFBpbGxhck9mZnNldCkgPCBoZlNoYXBlLnBpbGxhckNvbnZleC5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNwaGVyZVNoYXBlLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgIGludGVyc2VjdGluZyA9IHRoaXMuc3BoZXJlQ29udmV4KHNwaGVyZVNoYXBlLCBoZlNoYXBlLnBpbGxhckNvbnZleCwgc3BoZXJlUG9zLCB3b3JsZFBpbGxhck9mZnNldCwgc3BoZXJlUXVhdCwgaGZRdWF0LCBzcGhlcmVCb2R5LCBoZkJvZHksIHNwaGVyZVNoYXBlLCBoZlNoYXBlLCBqdXN0VGVzdCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGp1c3RUZXN0ICYmIGludGVyc2VjdGluZykgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0gLy8gVXBwZXIgdHJpYW5nbGUKCgogICAgICAgICAgaGZTaGFwZS5nZXRDb252ZXhUcmlhbmdsZVBpbGxhcihpLCBqLCB0cnVlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShoZlBvcywgaGZRdWF0LCBoZlNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIGlmIChzcGhlcmVQb3MuZGlzdGFuY2VUbyh3b3JsZFBpbGxhck9mZnNldCkgPCBoZlNoYXBlLnBpbGxhckNvbnZleC5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNwaGVyZVNoYXBlLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgIGludGVyc2VjdGluZyA9IHRoaXMuc3BoZXJlQ29udmV4KHNwaGVyZVNoYXBlLCBoZlNoYXBlLnBpbGxhckNvbnZleCwgc3BoZXJlUG9zLCB3b3JsZFBpbGxhck9mZnNldCwgc3BoZXJlUXVhdCwgaGZRdWF0LCBzcGhlcmVCb2R5LCBoZkJvZHksIHNwaGVyZVNoYXBlLCBoZlNoYXBlLCBqdXN0VGVzdCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGp1c3RUZXN0ICYmIGludGVyc2VjdGluZykgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBudW1Db250YWN0cyA9IHJlc3VsdC5sZW5ndGggLSBudW1Db250YWN0c0JlZm9yZTsKCiAgICAgICAgICBpZiAobnVtQ29udGFjdHMgPiAyKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIC8qCiAgICAgICAgICAgIC8vIFNraXAgYWxsIGJ1dCAxCiAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgbnVtQ29udGFjdHMgLSAxOyBrKyspIHsKICAgICAgICAgICAgICAgIHJlc3VsdC5wb3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgKi8KCiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgYm94SGVpZ2h0ZmllbGQoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2kubWF0ZXJpYWw7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNpLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICByZXR1cm4gdGhpcy5jb252ZXhIZWlnaHRmaWVsZChzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgIH0KCiAgICBjb252ZXhIZWlnaHRmaWVsZChjb252ZXhTaGFwZSwgaGZTaGFwZSwgY29udmV4UG9zLCBoZlBvcywgY29udmV4UXVhdCwgaGZRdWF0LCBjb252ZXhCb2R5LCBoZkJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBjb25zdCBkYXRhID0gaGZTaGFwZS5kYXRhOwogICAgICBjb25zdCB3ID0gaGZTaGFwZS5lbGVtZW50U2l6ZTsKICAgICAgY29uc3QgcmFkaXVzID0gY29udmV4U2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXM7CiAgICAgIGNvbnN0IHdvcmxkUGlsbGFyT2Zmc2V0ID0gY29udmV4SGVpZ2h0ZmllbGRfdG1wMjsKICAgICAgY29uc3QgZmFjZUxpc3QgPSBjb252ZXhIZWlnaHRmaWVsZF9mYWNlTGlzdDsgLy8gR2V0IHNwaGVyZSBwb3NpdGlvbiB0byBoZWlnaHRmaWVsZCBsb2NhbCEKCiAgICAgIGNvbnN0IGxvY2FsQ29udmV4UG9zID0gY29udmV4SGVpZ2h0ZmllbGRfdG1wMTsKICAgICAgVHJhbnNmb3JtLnBvaW50VG9Mb2NhbEZyYW1lKGhmUG9zLCBoZlF1YXQsIGNvbnZleFBvcywgbG9jYWxDb252ZXhQb3MpOyAvLyBHZXQgdGhlIGluZGV4IG9mIHRoZSBkYXRhIHBvaW50cyB0byB0ZXN0IGFnYWluc3QKCiAgICAgIGxldCBpTWluWCA9IE1hdGguZmxvb3IoKGxvY2FsQ29udmV4UG9zLnggLSByYWRpdXMpIC8gdykgLSAxOwogICAgICBsZXQgaU1heFggPSBNYXRoLmNlaWwoKGxvY2FsQ29udmV4UG9zLnggKyByYWRpdXMpIC8gdykgKyAxOwogICAgICBsZXQgaU1pblkgPSBNYXRoLmZsb29yKChsb2NhbENvbnZleFBvcy55IC0gcmFkaXVzKSAvIHcpIC0gMTsKICAgICAgbGV0IGlNYXhZID0gTWF0aC5jZWlsKChsb2NhbENvbnZleFBvcy55ICsgcmFkaXVzKSAvIHcpICsgMTsgLy8gQmFpbCBvdXQgaWYgd2UgYXJlIG91dCBvZiB0aGUgdGVycmFpbgoKICAgICAgaWYgKGlNYXhYIDwgMCB8fCBpTWF4WSA8IDAgfHwgaU1pblggPiBkYXRhLmxlbmd0aCB8fCBpTWluWSA+IGRhdGFbMF0ubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIENsYW1wIGluZGV4IHRvIGVkZ2VzCgoKICAgICAgaWYgKGlNaW5YIDwgMCkgewogICAgICAgIGlNaW5YID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNYXhYIDwgMCkgewogICAgICAgIGlNYXhYID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNaW5ZIDwgMCkgewogICAgICAgIGlNaW5ZID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNYXhZIDwgMCkgewogICAgICAgIGlNYXhZID0gMDsKICAgICAgfQoKICAgICAgaWYgKGlNaW5YID49IGRhdGEubGVuZ3RoKSB7CiAgICAgICAgaU1pblggPSBkYXRhLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WCA+PSBkYXRhLmxlbmd0aCkgewogICAgICAgIGlNYXhYID0gZGF0YS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBpZiAoaU1heFkgPj0gZGF0YVswXS5sZW5ndGgpIHsKICAgICAgICBpTWF4WSA9IGRhdGFbMF0ubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgaWYgKGlNaW5ZID49IGRhdGFbMF0ubGVuZ3RoKSB7CiAgICAgICAgaU1pblkgPSBkYXRhWzBdLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGNvbnN0IG1pbk1heCA9IFtdOwogICAgICBoZlNoYXBlLmdldFJlY3RNaW5NYXgoaU1pblgsIGlNaW5ZLCBpTWF4WCwgaU1heFksIG1pbk1heCk7CiAgICAgIGNvbnN0IG1pbiA9IG1pbk1heFswXTsKICAgICAgY29uc3QgbWF4ID0gbWluTWF4WzFdOyAvLyBCYWlsIG91dCBpZiB3ZSdyZSBjYW50IHRvdWNoIHRoZSBib3VuZGluZyBoZWlnaHQgYm94CgogICAgICBpZiAobG9jYWxDb252ZXhQb3MueiAtIHJhZGl1cyA+IG1heCB8fCBsb2NhbENvbnZleFBvcy56ICsgcmFkaXVzIDwgbWluKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPCBpTWF4WDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IGlNaW5ZOyBqIDwgaU1heFk7IGorKykgewogICAgICAgICAgbGV0IGludGVyc2VjdGluZyA9IGZhbHNlOyAvLyBMb3dlciB0cmlhbmdsZQoKICAgICAgICAgIGhmU2hhcGUuZ2V0Q29udmV4VHJpYW5nbGVQaWxsYXIoaSwgaiwgZmFsc2UpOwogICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKGhmUG9zLCBoZlF1YXQsIGhmU2hhcGUucGlsbGFyT2Zmc2V0LCB3b3JsZFBpbGxhck9mZnNldCk7CgogICAgICAgICAgaWYgKGNvbnZleFBvcy5kaXN0YW5jZVRvKHdvcmxkUGlsbGFyT2Zmc2V0KSA8IGhmU2hhcGUucGlsbGFyQ29udmV4LmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgY29udmV4U2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICAgICAgaW50ZXJzZWN0aW5nID0gdGhpcy5jb252ZXhDb252ZXgoY29udmV4U2hhcGUsIGhmU2hhcGUucGlsbGFyQ29udmV4LCBjb252ZXhQb3MsIHdvcmxkUGlsbGFyT2Zmc2V0LCBjb252ZXhRdWF0LCBoZlF1YXQsIGNvbnZleEJvZHksIGhmQm9keSwgbnVsbCwgbnVsbCwganVzdFRlc3QsIGZhY2VMaXN0LCBudWxsKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoanVzdFRlc3QgJiYgaW50ZXJzZWN0aW5nKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfSAvLyBVcHBlciB0cmlhbmdsZQoKCiAgICAgICAgICBoZlNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIHRydWUpOwogICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKGhmUG9zLCBoZlF1YXQsIGhmU2hhcGUucGlsbGFyT2Zmc2V0LCB3b3JsZFBpbGxhck9mZnNldCk7CgogICAgICAgICAgaWYgKGNvbnZleFBvcy5kaXN0YW5jZVRvKHdvcmxkUGlsbGFyT2Zmc2V0KSA8IGhmU2hhcGUucGlsbGFyQ29udmV4LmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgY29udmV4U2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICAgICAgaW50ZXJzZWN0aW5nID0gdGhpcy5jb252ZXhDb252ZXgoY29udmV4U2hhcGUsIGhmU2hhcGUucGlsbGFyQ29udmV4LCBjb252ZXhQb3MsIHdvcmxkUGlsbGFyT2Zmc2V0LCBjb252ZXhRdWF0LCBoZlF1YXQsIGNvbnZleEJvZHksIGhmQm9keSwgbnVsbCwgbnVsbCwganVzdFRlc3QsIGZhY2VMaXN0LCBudWxsKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoanVzdFRlc3QgJiYgaW50ZXJzZWN0aW5nKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHNwaGVyZVBhcnRpY2xlKHNqLCBzaSwgeGosIHhpLCBxaiwgcWksIGJqLCBiaSwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIC8vIFRoZSBub3JtYWwgaXMgdGhlIHVuaXQgdmVjdG9yIGZyb20gc3BoZXJlIGNlbnRlciB0byBwYXJ0aWNsZSBjZW50ZXIKICAgICAgY29uc3Qgbm9ybWFsID0gcGFydGljbGVTcGhlcmVfbm9ybWFsOwogICAgICBub3JtYWwuc2V0KDAsIDAsIDEpOwogICAgICB4aS52c3ViKHhqLCBub3JtYWwpOwogICAgICBjb25zdCBsZW5ndGhTcXVhcmVkID0gbm9ybWFsLmxlbmd0aFNxdWFyZWQoKTsKCiAgICAgIGlmIChsZW5ndGhTcXVhcmVkIDw9IHNqLnJhZGl1cyAqIHNqLnJhZGl1cykgewogICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICBub3JtYWwubm9ybWFsaXplKCk7CiAgICAgICAgci5yai5jb3B5KG5vcm1hbCk7CiAgICAgICAgci5yai5zY2FsZShzai5yYWRpdXMsIHIucmopOwogICAgICAgIHIubmkuY29weShub3JtYWwpOyAvLyBDb250YWN0IG5vcm1hbAoKICAgICAgICByLm5pLm5lZ2F0ZShyLm5pKTsKICAgICAgICByLnJpLnNldCgwLCAwLCAwKTsgLy8gQ2VudGVyIG9mIHBhcnRpY2xlCgogICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICB9CiAgICB9CgogICAgcGxhbmVQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBjb25zdCBub3JtYWwgPSBwYXJ0aWNsZVBsYW5lX25vcm1hbDsKICAgICAgbm9ybWFsLnNldCgwLCAwLCAxKTsKICAgICAgYmoucXVhdGVybmlvbi52bXVsdChub3JtYWwsIG5vcm1hbCk7IC8vIFR1cm4gbm9ybWFsIGFjY29yZGluZyB0byBwbGFuZSBvcmllbnRhdGlvbgoKICAgICAgY29uc3QgcmVscG9zID0gcGFydGljbGVQbGFuZV9yZWxwb3M7CiAgICAgIHhpLnZzdWIoYmoucG9zaXRpb24sIHJlbHBvcyk7CiAgICAgIGNvbnN0IGRvdCA9IG5vcm1hbC5kb3QocmVscG9zKTsKCiAgICAgIGlmIChkb3QgPD0gMC4wKSB7CiAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgIHIubmkuY29weShub3JtYWwpOyAvLyBDb250YWN0IG5vcm1hbCBpcyB0aGUgcGxhbmUgbm9ybWFsCgogICAgICAgIHIubmkubmVnYXRlKHIubmkpOwogICAgICAgIHIucmkuc2V0KDAsIDAsIDApOyAvLyBDZW50ZXIgb2YgcGFydGljbGUKICAgICAgICAvLyBHZXQgcGFydGljbGUgcG9zaXRpb24gcHJvamVjdGVkIG9uIHBsYW5lCgogICAgICAgIGNvbnN0IHByb2plY3RlZCA9IHBhcnRpY2xlUGxhbmVfcHJvamVjdGVkOwogICAgICAgIG5vcm1hbC5zY2FsZShub3JtYWwuZG90KHhpKSwgcHJvamVjdGVkKTsKICAgICAgICB4aS52c3ViKHByb2plY3RlZCwgcHJvamVjdGVkKTsgLy9wcm9qZWN0ZWQudmFkZChiai5wb3NpdGlvbixwcm9qZWN0ZWQpOwogICAgICAgIC8vIHJqIGlzIG5vdyB0aGUgcHJvamVjdGVkIHdvcmxkIHBvc2l0aW9uIG1pbnVzIHBsYW5lIHBvc2l0aW9uCgogICAgICAgIHIucmouY29weShwcm9qZWN0ZWQpOwogICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICB9CiAgICB9CgogICAgYm94UGFydGljbGUoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2kubWF0ZXJpYWw7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNpLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICByZXR1cm4gdGhpcy5jb252ZXhQYXJ0aWNsZShzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgIH0KCiAgICBjb252ZXhQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBsZXQgcGVuZXRyYXRlZEZhY2VJbmRleCA9IC0xOwogICAgICBjb25zdCBwZW5ldHJhdGVkRmFjZU5vcm1hbCA9IGNvbnZleFBhcnRpY2xlX3BlbmV0cmF0ZWRGYWNlTm9ybWFsOwogICAgICBjb25zdCB3b3JsZFBlbmV0cmF0aW9uVmVjID0gY29udmV4UGFydGljbGVfd29ybGRQZW5ldHJhdGlvblZlYzsKICAgICAgbGV0IG1pblBlbmV0cmF0aW9uID0gbnVsbDsKCiAgICAgIGNvbnN0IGxvY2FsID0gY29udmV4UGFydGljbGVfbG9jYWw7CiAgICAgIGxvY2FsLmNvcHkoeGkpOwogICAgICBsb2NhbC52c3ViKHhqLCBsb2NhbCk7IC8vIENvbnZlcnQgcG9zaXRpb24gdG8gcmVsYXRpdmUgdGhlIGNvbnZleCBvcmlnaW4KCiAgICAgIHFqLmNvbmp1Z2F0ZShjcWopOwogICAgICBjcWoudm11bHQobG9jYWwsIGxvY2FsKTsKCiAgICAgIGlmIChzai5wb2ludElzSW5zaWRlKGxvY2FsKSkgewogICAgICAgIGlmIChzai53b3JsZFZlcnRpY2VzTmVlZHNVcGRhdGUpIHsKICAgICAgICAgIHNqLmNvbXB1dGVXb3JsZFZlcnRpY2VzKHhqLCBxaik7CiAgICAgICAgfQoKICAgICAgICBpZiAoc2oud29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlKSB7CiAgICAgICAgICBzai5jb21wdXRlV29ybGRGYWNlTm9ybWFscyhxaik7CiAgICAgICAgfSAvLyBGb3IgZWFjaCB3b3JsZCBwb2x5Z29uIGluIHRoZSBwb2x5aGVkcmEKCgogICAgICAgIGZvciAobGV0IGkgPSAwLCBuZmFjZXMgPSBzai5mYWNlcy5sZW5ndGg7IGkgIT09IG5mYWNlczsgaSsrKSB7CiAgICAgICAgICAvLyBDb25zdHJ1Y3Qgd29ybGQgZmFjZSB2ZXJ0aWNlcwogICAgICAgICAgY29uc3QgdmVydHMgPSBbc2oud29ybGRWZXJ0aWNlc1tzai5mYWNlc1tpXVswXV1dOwogICAgICAgICAgY29uc3Qgbm9ybWFsID0gc2oud29ybGRGYWNlTm9ybWFsc1tpXTsgLy8gQ2hlY2sgaG93IG11Y2ggdGhlIHBhcnRpY2xlIHBlbmV0cmF0ZXMgdGhlIHBvbHlnb24gcGxhbmUuCgogICAgICAgICAgeGkudnN1Yih2ZXJ0c1swXSwgY29udmV4UGFydGljbGVfdmVydGV4VG9QYXJ0aWNsZSk7CiAgICAgICAgICBjb25zdCBwZW5ldHJhdGlvbiA9IC1ub3JtYWwuZG90KGNvbnZleFBhcnRpY2xlX3ZlcnRleFRvUGFydGljbGUpOwoKICAgICAgICAgIGlmIChtaW5QZW5ldHJhdGlvbiA9PT0gbnVsbCB8fCBNYXRoLmFicyhwZW5ldHJhdGlvbikgPCBNYXRoLmFicyhtaW5QZW5ldHJhdGlvbikpIHsKICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG1pblBlbmV0cmF0aW9uID0gcGVuZXRyYXRpb247CiAgICAgICAgICAgIHBlbmV0cmF0ZWRGYWNlSW5kZXggPSBpOwogICAgICAgICAgICBwZW5ldHJhdGVkRmFjZU5vcm1hbC5jb3B5KG5vcm1hbCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAocGVuZXRyYXRlZEZhY2VJbmRleCAhPT0gLTEpIHsKICAgICAgICAgIC8vIFNldHVwIGNvbnRhY3QKICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgcGVuZXRyYXRlZEZhY2VOb3JtYWwuc2NhbGUobWluUGVuZXRyYXRpb24sIHdvcmxkUGVuZXRyYXRpb25WZWMpOyAvLyByaiBpcyB0aGUgcGFydGljbGUgcG9zaXRpb24gcHJvamVjdGVkIHRvIHRoZSBmYWNlCgogICAgICAgICAgd29ybGRQZW5ldHJhdGlvblZlYy52YWRkKHhpLCB3b3JsZFBlbmV0cmF0aW9uVmVjKTsKICAgICAgICAgIHdvcmxkUGVuZXRyYXRpb25WZWMudnN1Yih4aiwgd29ybGRQZW5ldHJhdGlvblZlYyk7CiAgICAgICAgICByLnJqLmNvcHkod29ybGRQZW5ldHJhdGlvblZlYyk7IC8vY29uc3QgcHJvamVjdGVkVG9GYWNlID0geGkudnN1Yih4aikudmFkZCh3b3JsZFBlbmV0cmF0aW9uVmVjKTsKICAgICAgICAgIC8vcHJvamVjdGVkVG9GYWNlLmNvcHkoci5yaik7CiAgICAgICAgICAvL3FqLnZtdWx0KHIucmosci5yaik7CgogICAgICAgICAgcGVuZXRyYXRlZEZhY2VOb3JtYWwubmVnYXRlKHIubmkpOyAvLyBDb250YWN0IG5vcm1hbAoKICAgICAgICAgIHIucmkuc2V0KDAsIDAsIDApOyAvLyBDZW50ZXIgb2YgcGFydGljbGUKCiAgICAgICAgICBjb25zdCByaSA9IHIucmk7CiAgICAgICAgICBjb25zdCByaiA9IHIucmo7IC8vIE1ha2UgcmVsYXRpdmUgdG8gYm9kaWVzCgogICAgICAgICAgcmkudmFkZCh4aSwgcmkpOwogICAgICAgICAgcmkudnN1YihiaS5wb3NpdGlvbiwgcmkpOwogICAgICAgICAgcmoudmFkZCh4aiwgcmopOwogICAgICAgICAgcmoudnN1Yihiai5wb3NpdGlvbiwgcmopOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS53YXJuKCdQb2ludCBmb3VuZCBpbnNpZGUgY29udmV4LCBidXQgZGlkIG5vdCBmaW5kIHBlbmV0cmF0aW5nIGZhY2UhJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaGVpZ2h0ZmllbGRDeWxpbmRlcihoZlNoYXBlLCBjb252ZXhTaGFwZSwgaGZQb3MsIGNvbnZleFBvcywgaGZRdWF0LCBjb252ZXhRdWF0LCBoZkJvZHksIGNvbnZleEJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhIZWlnaHRmaWVsZChjb252ZXhTaGFwZSwgaGZTaGFwZSwgY29udmV4UG9zLCBoZlBvcywgY29udmV4UXVhdCwgaGZRdWF0LCBjb252ZXhCb2R5LCBoZkJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgcGFydGljbGVDeWxpbmRlcihzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgc3BoZXJlVHJpbWVzaChzcGhlcmVTaGFwZSwgdHJpbWVzaFNoYXBlLCBzcGhlcmVQb3MsIHRyaW1lc2hQb3MsIHNwaGVyZVF1YXQsIHRyaW1lc2hRdWF0LCBzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGNvbnN0IGVkZ2VWZXJ0ZXhBID0gc3BoZXJlVHJpbWVzaF9lZGdlVmVydGV4QTsKICAgICAgY29uc3QgZWRnZVZlcnRleEIgPSBzcGhlcmVUcmltZXNoX2VkZ2VWZXJ0ZXhCOwogICAgICBjb25zdCBlZGdlVmVjdG9yID0gc3BoZXJlVHJpbWVzaF9lZGdlVmVjdG9yOwogICAgICBjb25zdCBlZGdlVmVjdG9yVW5pdCA9IHNwaGVyZVRyaW1lc2hfZWRnZVZlY3RvclVuaXQ7CiAgICAgIGNvbnN0IGxvY2FsU3BoZXJlUG9zID0gc3BoZXJlVHJpbWVzaF9sb2NhbFNwaGVyZVBvczsKICAgICAgY29uc3QgdG1wID0gc3BoZXJlVHJpbWVzaF90bXA7CiAgICAgIGNvbnN0IGxvY2FsU3BoZXJlQUFCQiA9IHNwaGVyZVRyaW1lc2hfbG9jYWxTcGhlcmVBQUJCOwogICAgICBjb25zdCB2MiA9IHNwaGVyZVRyaW1lc2hfdjI7CiAgICAgIGNvbnN0IHJlbHBvcyA9IHNwaGVyZVRyaW1lc2hfcmVscG9zOwogICAgICBjb25zdCB0cmlhbmdsZXMgPSBzcGhlcmVUcmltZXNoX3RyaWFuZ2xlczsgLy8gQ29udmVydCBzcGhlcmUgcG9zaXRpb24gdG8gbG9jYWwgaW4gdGhlIHRyaW1lc2gKCiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgc3BoZXJlUG9zLCBsb2NhbFNwaGVyZVBvcyk7IC8vIEdldCB0aGUgYWFiYiBvZiB0aGUgc3BoZXJlIGxvY2FsbHkgaW4gdGhlIHRyaW1lc2gKCiAgICAgIGNvbnN0IHNwaGVyZVJhZGl1cyA9IHNwaGVyZVNoYXBlLnJhZGl1czsKICAgICAgbG9jYWxTcGhlcmVBQUJCLmxvd2VyQm91bmQuc2V0KGxvY2FsU3BoZXJlUG9zLnggLSBzcGhlcmVSYWRpdXMsIGxvY2FsU3BoZXJlUG9zLnkgLSBzcGhlcmVSYWRpdXMsIGxvY2FsU3BoZXJlUG9zLnogLSBzcGhlcmVSYWRpdXMpOwogICAgICBsb2NhbFNwaGVyZUFBQkIudXBwZXJCb3VuZC5zZXQobG9jYWxTcGhlcmVQb3MueCArIHNwaGVyZVJhZGl1cywgbG9jYWxTcGhlcmVQb3MueSArIHNwaGVyZVJhZGl1cywgbG9jYWxTcGhlcmVQb3MueiArIHNwaGVyZVJhZGl1cyk7CiAgICAgIHRyaW1lc2hTaGFwZS5nZXRUcmlhbmdsZXNJbkFBQkIobG9jYWxTcGhlcmVBQUJCLCB0cmlhbmdsZXMpOyAvL2ZvciAobGV0IGkgPSAwOyBpIDwgdHJpbWVzaFNoYXBlLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB0cmlhbmdsZXMucHVzaChpKTsgLy8gQWxsCiAgICAgIC8vIFZlcnRpY2VzCgogICAgICBjb25zdCB2ID0gc3BoZXJlVHJpbWVzaF92OwogICAgICBjb25zdCByYWRpdXNTcXVhcmVkID0gc3BoZXJlU2hhcGUucmFkaXVzICogc3BoZXJlU2hhcGUucmFkaXVzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmlhbmdsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDM7IGorKykgewogICAgICAgICAgdHJpbWVzaFNoYXBlLmdldFZlcnRleCh0cmltZXNoU2hhcGUuaW5kaWNlc1t0cmlhbmdsZXNbaV0gKiAzICsgal0sIHYpOyAvLyBDaGVjayB2ZXJ0ZXggb3ZlcmxhcCBpbiBzcGhlcmUKCiAgICAgICAgICB2LnZzdWIobG9jYWxTcGhlcmVQb3MsIHJlbHBvcyk7CgogICAgICAgICAgaWYgKHJlbHBvcy5sZW5ndGhTcXVhcmVkKCkgPD0gcmFkaXVzU3F1YXJlZCkgewogICAgICAgICAgICAvLyBTYWZlIHVwCiAgICAgICAgICAgIHYyLmNvcHkodik7CiAgICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgdjIsIHYpOwogICAgICAgICAgICB2LnZzdWIoc3BoZXJlUG9zLCByZWxwb3MpOwoKICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oc3BoZXJlQm9keSwgdHJpbWVzaEJvZHksIHNwaGVyZVNoYXBlLCB0cmltZXNoU2hhcGUsIHJzaSwgcnNqKTsKICAgICAgICAgICAgci5uaS5jb3B5KHJlbHBvcyk7CiAgICAgICAgICAgIHIubmkubm9ybWFsaXplKCk7IC8vIHJpIGlzIHRoZSB2ZWN0b3IgZnJvbSBzcGhlcmUgY2VudGVyIHRvIHRoZSBzcGhlcmUgc3VyZmFjZQoKICAgICAgICAgICAgci5yaS5jb3B5KHIubmkpOwogICAgICAgICAgICByLnJpLnNjYWxlKHNwaGVyZVNoYXBlLnJhZGl1cywgci5yaSk7CiAgICAgICAgICAgIHIucmkudmFkZChzcGhlcmVQb3MsIHIucmkpOwogICAgICAgICAgICByLnJpLnZzdWIoc3BoZXJlQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgIHIucmouY29weSh2KTsKICAgICAgICAgICAgci5yai52c3ViKHRyaW1lc2hCb2R5LnBvc2l0aW9uLCByLnJqKTsgLy8gU3RvcmUgcmVzdWx0CgogICAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIENoZWNrIGFsbCBlZGdlcwoKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHJpYW5nbGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAzOyBqKyspIHsKICAgICAgICAgIHRyaW1lc2hTaGFwZS5nZXRWZXJ0ZXgodHJpbWVzaFNoYXBlLmluZGljZXNbdHJpYW5nbGVzW2ldICogMyArIGpdLCBlZGdlVmVydGV4QSk7CiAgICAgICAgICB0cmltZXNoU2hhcGUuZ2V0VmVydGV4KHRyaW1lc2hTaGFwZS5pbmRpY2VzW3RyaWFuZ2xlc1tpXSAqIDMgKyAoaiArIDEpICUgM10sIGVkZ2VWZXJ0ZXhCKTsKICAgICAgICAgIGVkZ2VWZXJ0ZXhCLnZzdWIoZWRnZVZlcnRleEEsIGVkZ2VWZWN0b3IpOyAvLyBQcm9qZWN0IHNwaGVyZSBwb3NpdGlvbiB0byB0aGUgZWRnZQoKICAgICAgICAgIGxvY2FsU3BoZXJlUG9zLnZzdWIoZWRnZVZlcnRleEIsIHRtcCk7CiAgICAgICAgICBjb25zdCBwb3NpdGlvbkFsb25nRWRnZUIgPSB0bXAuZG90KGVkZ2VWZWN0b3IpOwogICAgICAgICAgbG9jYWxTcGhlcmVQb3MudnN1YihlZGdlVmVydGV4QSwgdG1wKTsKICAgICAgICAgIGxldCBwb3NpdGlvbkFsb25nRWRnZUEgPSB0bXAuZG90KGVkZ2VWZWN0b3IpOwoKICAgICAgICAgIGlmIChwb3NpdGlvbkFsb25nRWRnZUEgPiAwICYmIHBvc2l0aW9uQWxvbmdFZGdlQiA8IDApIHsKICAgICAgICAgICAgLy8gTm93IGNoZWNrIHRoZSBvcnRob2dvbmFsIGRpc3RhbmNlIGZyb20gZWRnZSB0byBzcGhlcmUgY2VudGVyCiAgICAgICAgICAgIGxvY2FsU3BoZXJlUG9zLnZzdWIoZWRnZVZlcnRleEEsIHRtcCk7CiAgICAgICAgICAgIGVkZ2VWZWN0b3JVbml0LmNvcHkoZWRnZVZlY3Rvcik7CiAgICAgICAgICAgIGVkZ2VWZWN0b3JVbml0Lm5vcm1hbGl6ZSgpOwogICAgICAgICAgICBwb3NpdGlvbkFsb25nRWRnZUEgPSB0bXAuZG90KGVkZ2VWZWN0b3JVbml0KTsKICAgICAgICAgICAgZWRnZVZlY3RvclVuaXQuc2NhbGUocG9zaXRpb25BbG9uZ0VkZ2VBLCB0bXApOwogICAgICAgICAgICB0bXAudmFkZChlZGdlVmVydGV4QSwgdG1wKTsgLy8gdG1wIGlzIG5vdyB0aGUgc3BoZXJlIGNlbnRlciBwb3NpdGlvbiBwcm9qZWN0ZWQgdG8gdGhlIGVkZ2UsIGRlZmluZWQgbG9jYWxseSBpbiB0aGUgdHJpbWVzaCBmcmFtZQoKICAgICAgICAgICAgY29uc3QgZGlzdCA9IHRtcC5kaXN0YW5jZVRvKGxvY2FsU3BoZXJlUG9zKTsKCiAgICAgICAgICAgIGlmIChkaXN0IDwgc3BoZXJlU2hhcGUucmFkaXVzKSB7CiAgICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgc3BoZXJlU2hhcGUsIHRyaW1lc2hTaGFwZSwgcnNpLCByc2opOwogICAgICAgICAgICAgIHRtcC52c3ViKGxvY2FsU3BoZXJlUG9zLCByLm5pKTsKICAgICAgICAgICAgICByLm5pLm5vcm1hbGl6ZSgpOwogICAgICAgICAgICAgIHIubmkuc2NhbGUoc3BoZXJlU2hhcGUucmFkaXVzLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZhZGQoc3BoZXJlUG9zLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZzdWIoc3BoZXJlQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKHRyaW1lc2hQb3MsIHRyaW1lc2hRdWF0LCB0bXAsIHRtcCk7CiAgICAgICAgICAgICAgdG1wLnZzdWIodHJpbWVzaEJvZHkucG9zaXRpb24sIHIucmopOwogICAgICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIubmksIHIubmkpOwogICAgICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIucmksIHIucmkpOwogICAgICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIFRyaWFuZ2xlIGZhY2VzCgoKICAgICAgY29uc3QgdmEgPSBzcGhlcmVUcmltZXNoX3ZhOwogICAgICBjb25zdCB2YiA9IHNwaGVyZVRyaW1lc2hfdmI7CiAgICAgIGNvbnN0IHZjID0gc3BoZXJlVHJpbWVzaF92YzsKICAgICAgY29uc3Qgbm9ybWFsID0gc3BoZXJlVHJpbWVzaF9ub3JtYWw7CgogICAgICBmb3IgKGxldCBpID0gMCwgTiA9IHRyaWFuZ2xlcy5sZW5ndGg7IGkgIT09IE47IGkrKykgewogICAgICAgIHRyaW1lc2hTaGFwZS5nZXRUcmlhbmdsZVZlcnRpY2VzKHRyaWFuZ2xlc1tpXSwgdmEsIHZiLCB2Yyk7CiAgICAgICAgdHJpbWVzaFNoYXBlLmdldE5vcm1hbCh0cmlhbmdsZXNbaV0sIG5vcm1hbCk7CiAgICAgICAgbG9jYWxTcGhlcmVQb3MudnN1Yih2YSwgdG1wKTsKICAgICAgICBsZXQgZGlzdCA9IHRtcC5kb3Qobm9ybWFsKTsKICAgICAgICBub3JtYWwuc2NhbGUoZGlzdCwgdG1wKTsKICAgICAgICBsb2NhbFNwaGVyZVBvcy52c3ViKHRtcCwgdG1wKTsgLy8gdG1wIGlzIG5vdyB0aGUgc3BoZXJlIHBvc2l0aW9uIHByb2plY3RlZCB0byB0aGUgdHJpYW5nbGUgcGxhbmUKCiAgICAgICAgZGlzdCA9IHRtcC5kaXN0YW5jZVRvKGxvY2FsU3BoZXJlUG9zKTsKCiAgICAgICAgaWYgKFJheS5wb2ludEluVHJpYW5nbGUodG1wLCB2YSwgdmIsIHZjKSAmJiBkaXN0IDwgc3BoZXJlU2hhcGUucmFkaXVzKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgbGV0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgc3BoZXJlU2hhcGUsIHRyaW1lc2hTaGFwZSwgcnNpLCByc2opOwogICAgICAgICAgdG1wLnZzdWIobG9jYWxTcGhlcmVQb3MsIHIubmkpOwogICAgICAgICAgci5uaS5ub3JtYWxpemUoKTsKICAgICAgICAgIHIubmkuc2NhbGUoc3BoZXJlU2hhcGUucmFkaXVzLCByLnJpKTsKICAgICAgICAgIHIucmkudmFkZChzcGhlcmVQb3MsIHIucmkpOwogICAgICAgICAgci5yaS52c3ViKHNwaGVyZUJvZHkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKHRyaW1lc2hQb3MsIHRyaW1lc2hRdWF0LCB0bXAsIHRtcCk7CiAgICAgICAgICB0bXAudnN1Yih0cmltZXNoQm9keS5wb3NpdGlvbiwgci5yaik7CiAgICAgICAgICBUcmFuc2Zvcm0udmVjdG9yVG9Xb3JsZEZyYW1lKHRyaW1lc2hRdWF0LCByLm5pLCByLm5pKTsKICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIucmksIHIucmkpOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRyaWFuZ2xlcy5sZW5ndGggPSAwOwogICAgfQoKICAgIHBsYW5lVHJpbWVzaChwbGFuZVNoYXBlLCB0cmltZXNoU2hhcGUsIHBsYW5lUG9zLCB0cmltZXNoUG9zLCBwbGFuZVF1YXQsIHRyaW1lc2hRdWF0LCBwbGFuZUJvZHksIHRyaW1lc2hCb2R5LCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgLy8gTWFrZSBjb250YWN0cyEKICAgICAgY29uc3QgdiA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IG5vcm1hbCA9IHBsYW5lVHJpbWVzaF9ub3JtYWw7CiAgICAgIG5vcm1hbC5zZXQoMCwgMCwgMSk7CiAgICAgIHBsYW5lUXVhdC52bXVsdChub3JtYWwsIG5vcm1hbCk7IC8vIFR1cm4gbm9ybWFsIGFjY29yZGluZyB0byBwbGFuZQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmltZXNoU2hhcGUudmVydGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgLy8gR2V0IHdvcmxkIHZlcnRleCBmcm9tIHRyaW1lc2gKICAgICAgICB0cmltZXNoU2hhcGUuZ2V0VmVydGV4KGksIHYpOyAvLyBTYWZlIHVwCgogICAgICAgIGNvbnN0IHYyID0gbmV3IFZlYzMoKTsKICAgICAgICB2Mi5jb3B5KHYpOwogICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgdjIsIHYpOyAvLyBDaGVjayBwbGFuZSBzaWRlCgogICAgICAgIGNvbnN0IHJlbHBvcyA9IHBsYW5lVHJpbWVzaF9yZWxwb3M7CiAgICAgICAgdi52c3ViKHBsYW5lUG9zLCByZWxwb3MpOwogICAgICAgIGNvbnN0IGRvdCA9IG5vcm1hbC5kb3QocmVscG9zKTsKCiAgICAgICAgaWYgKGRvdCA8PSAwLjApIHsKICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24ocGxhbmVCb2R5LCB0cmltZXNoQm9keSwgcGxhbmVTaGFwZSwgdHJpbWVzaFNoYXBlLCByc2ksIHJzaik7CiAgICAgICAgICByLm5pLmNvcHkobm9ybWFsKTsgLy8gQ29udGFjdCBub3JtYWwgaXMgdGhlIHBsYW5lIG5vcm1hbAogICAgICAgICAgLy8gR2V0IHZlcnRleCBwb3NpdGlvbiBwcm9qZWN0ZWQgb24gcGxhbmUKCiAgICAgICAgICBjb25zdCBwcm9qZWN0ZWQgPSBwbGFuZVRyaW1lc2hfcHJvamVjdGVkOwogICAgICAgICAgbm9ybWFsLnNjYWxlKHJlbHBvcy5kb3Qobm9ybWFsKSwgcHJvamVjdGVkKTsKICAgICAgICAgIHYudnN1Yihwcm9qZWN0ZWQsIHByb2plY3RlZCk7IC8vIHJpIGlzIHRoZSBwcm9qZWN0ZWQgd29ybGQgcG9zaXRpb24gbWludXMgcGxhbmUgcG9zaXRpb24KCiAgICAgICAgICByLnJpLmNvcHkocHJvamVjdGVkKTsKICAgICAgICAgIHIucmkudnN1YihwbGFuZUJvZHkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgci5yai5jb3B5KHYpOwogICAgICAgICAgci5yai52c3ViKHRyaW1lc2hCb2R5LnBvc2l0aW9uLCByLnJqKTsgLy8gU3RvcmUgcmVzdWx0CgogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gLy8gY29udmV4VHJpbWVzaCgKICAgIC8vICAgc2k6IENvbnZleFBvbHloZWRyb24sIHNqOiBUcmltZXNoLCB4aTogVmVjMywgeGo6IFZlYzMsIHFpOiBRdWF0ZXJuaW9uLCBxajogUXVhdGVybmlvbiwKICAgIC8vICAgYmk6IEJvZHksIGJqOiBCb2R5LCByc2k/OiBTaGFwZSB8IG51bGwsIHJzaj86IFNoYXBlIHwgbnVsbCwKICAgIC8vICAgZmFjZUxpc3RBPzogbnVtYmVyW10gfCBudWxsLCBmYWNlTGlzdEI/OiBudW1iZXJbXSB8IG51bGwsCiAgICAvLyApIHsKICAgIC8vICAgY29uc3Qgc2VwQXhpcyA9IGNvbnZleENvbnZleF9zZXBBeGlzOwogICAgLy8gICBpZih4aS5kaXN0YW5jZVRvKHhqKSA+IHNpLmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgc2ouYm91bmRpbmdTcGhlcmVSYWRpdXMpewogICAgLy8gICAgICAgcmV0dXJuOwogICAgLy8gICB9CiAgICAvLyAgIC8vIENvbnN0cnVjdCBhIHRlbXAgaHVsbCBmb3IgZWFjaCB0cmlhbmdsZQogICAgLy8gICBjb25zdCBodWxsQiA9IG5ldyBDb252ZXhQb2x5aGVkcm9uKCk7CiAgICAvLyAgIGh1bGxCLmZhY2VzID0gW1swLDEsMl1dOwogICAgLy8gICBjb25zdCB2YSA9IG5ldyBWZWMzKCk7CiAgICAvLyAgIGNvbnN0IHZiID0gbmV3IFZlYzMoKTsKICAgIC8vICAgY29uc3QgdmMgPSBuZXcgVmVjMygpOwogICAgLy8gICBodWxsQi52ZXJ0aWNlcyA9IFsKICAgIC8vICAgICAgIHZhLAogICAgLy8gICAgICAgdmIsCiAgICAvLyAgICAgICB2YwogICAgLy8gICBdOwogICAgLy8gICBmb3IgKGxldCBpID0gMDsgaSA8IHNqLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAvLyAgICAgICBjb25zdCB0cmlhbmdsZU5vcm1hbCA9IG5ldyBWZWMzKCk7CiAgICAvLyAgICAgICBzai5nZXROb3JtYWwoaSwgdHJpYW5nbGVOb3JtYWwpOwogICAgLy8gICAgICAgaHVsbEIuZmFjZU5vcm1hbHMgPSBbdHJpYW5nbGVOb3JtYWxdOwogICAgLy8gICAgICAgc2ouZ2V0VHJpYW5nbGVWZXJ0aWNlcyhpLCB2YSwgdmIsIHZjKTsKICAgIC8vICAgICAgIGxldCBkID0gc2kudGVzdFNlcEF4aXModHJpYW5nbGVOb3JtYWwsIGh1bGxCLCB4aSwgcWksIHhqLCBxaik7CiAgICAvLyAgICAgICBpZighZCl7CiAgICAvLyAgICAgICAgICAgdHJpYW5nbGVOb3JtYWwuc2NhbGUoLTEsIHRyaWFuZ2xlTm9ybWFsKTsKICAgIC8vICAgICAgICAgICBkID0gc2kudGVzdFNlcEF4aXModHJpYW5nbGVOb3JtYWwsIGh1bGxCLCB4aSwgcWksIHhqLCBxaik7CiAgICAvLyAgICAgICAgICAgaWYoIWQpewogICAgLy8gICAgICAgICAgICAgICBjb250aW51ZTsKICAgIC8vICAgICAgICAgICB9CiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgICBjb25zdCByZXM6IENvbnZleFBvbHloZWRyb25Db250YWN0UG9pbnRbXSA9IFtdOwogICAgLy8gICAgICAgY29uc3QgcSA9IGNvbnZleENvbnZleF9xOwogICAgLy8gICAgICAgc2kuY2xpcEFnYWluc3RIdWxsKHhpLHFpLGh1bGxCLHhqLHFqLHRyaWFuZ2xlTm9ybWFsLC0xMDAsMTAwLHJlcyk7CiAgICAvLyAgICAgICBmb3IobGV0IGogPSAwOyBqICE9PSByZXMubGVuZ3RoOyBqKyspewogICAgLy8gICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSxiaixzaSxzaixyc2kscnNqKSwKICAgIC8vICAgICAgICAgICAgICAgcmkgPSByLnJpLAogICAgLy8gICAgICAgICAgICAgICByaiA9IHIucmo7CiAgICAvLyAgICAgICAgICAgci5uaS5jb3B5KHRyaWFuZ2xlTm9ybWFsKTsKICAgIC8vICAgICAgICAgICByLm5pLm5lZ2F0ZShyLm5pKTsKICAgIC8vICAgICAgICAgICByZXNbal0ubm9ybWFsLm5lZ2F0ZShxKTsKICAgIC8vICAgICAgICAgICBxLm11bHQocmVzW2pdLmRlcHRoLCBxKTsKICAgIC8vICAgICAgICAgICByZXNbal0ucG9pbnQudmFkZChxLCByaSk7CiAgICAvLyAgICAgICAgICAgcmouY29weShyZXNbal0ucG9pbnQpOwogICAgLy8gICAgICAgICAgIC8vIENvbnRhY3QgcG9pbnRzIGFyZSBpbiB3b3JsZCBjb29yZGluYXRlcy4gVHJhbnNmb3JtIGJhY2sgdG8gcmVsYXRpdmUKICAgIC8vICAgICAgICAgICByaS52c3ViKHhpLHJpKTsKICAgIC8vICAgICAgICAgICByai52c3ViKHhqLHJqKTsKICAgIC8vICAgICAgICAgICAvLyBNYWtlIHJlbGF0aXZlIHRvIGJvZGllcwogICAgLy8gICAgICAgICAgIHJpLnZhZGQoeGksIHJpKTsKICAgIC8vICAgICAgICAgICByaS52c3ViKGJpLnBvc2l0aW9uLCByaSk7CiAgICAvLyAgICAgICAgICAgcmoudmFkZCh4aiwgcmopOwogICAgLy8gICAgICAgICAgIHJqLnZzdWIoYmoucG9zaXRpb24sIHJqKTsKICAgIC8vICAgICAgICAgICByZXN1bHQucHVzaChyKTsKICAgIC8vICAgICAgIH0KICAgIC8vICAgfQogICAgLy8gfQoKCiAgfQogIGNvbnN0IGF2ZXJhZ2VOb3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IGF2ZXJhZ2VDb250YWN0UG9pbnRBID0gbmV3IFZlYzMoKTsKICBjb25zdCBhdmVyYWdlQ29udGFjdFBvaW50QiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wVmVjMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wVmVjMiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wUXVhdDEgPSBuZXcgUXVhdGVybmlvbigpOwogIGNvbnN0IHRtcFF1YXQyID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgY29uc3QgcGxhbmVUcmltZXNoX25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVUcmltZXNoX3JlbHBvcyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVUcmltZXNoX3Byb2plY3RlZCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9ub3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfcmVscG9zID0gbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92MiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9lZGdlVmVydGV4QSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9lZGdlVmVydGV4QiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9lZGdlVmVjdG9yID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX2VkZ2VWZWN0b3JVbml0ID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX2xvY2FsU3BoZXJlUG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX3RtcCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92YSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92YiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF92YyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9sb2NhbFNwaGVyZUFBQkIgPSBuZXcgQUFCQigpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdHJpYW5nbGVzID0gW107CiAgY29uc3QgcG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlID0gbmV3IFZlYzMoKTsKICBjb25zdCBwbGFuZV90b19zcGhlcmVfb3J0aG8gPSBuZXcgVmVjMygpOyAvLyBTZWUgaHR0cDovL2J1bGxldHBoeXNpY3MuY29tL0J1bGxldC9CdWxsZXRGdWxsL1NwaGVyZVRyaWFuZ2xlRGV0ZWN0b3JfOGNwcF9zb3VyY2UuaHRtbAoKICBjb25zdCBwb2ludEluUG9seWdvbl9lZGdlID0gbmV3IFZlYzMoKTsKICBjb25zdCBwb2ludEluUG9seWdvbl9lZGdlX3hfbm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBwb2ludEluUG9seWdvbl92dHAgPSBuZXcgVmVjMygpOwoKICBmdW5jdGlvbiBwb2ludEluUG9seWdvbih2ZXJ0cywgbm9ybWFsLCBwKSB7CiAgICBsZXQgcG9zaXRpdmVSZXN1bHQgPSBudWxsOwogICAgY29uc3QgTiA9IHZlcnRzLmxlbmd0aDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgIGNvbnN0IHYgPSB2ZXJ0c1tpXTsgLy8gR2V0IGVkZ2UgdG8gdGhlIG5leHQgdmVydGV4CgogICAgICBjb25zdCBlZGdlID0gcG9pbnRJblBvbHlnb25fZWRnZTsKICAgICAgdmVydHNbKGkgKyAxKSAlIE5dLnZzdWIodiwgZWRnZSk7IC8vIEdldCBjcm9zcyBwcm9kdWN0IGJldHdlZW4gcG9seWdvbiBub3JtYWwgYW5kIHRoZSBlZGdlCgogICAgICBjb25zdCBlZGdlX3hfbm9ybWFsID0gcG9pbnRJblBvbHlnb25fZWRnZV94X25vcm1hbDsgLy9jb25zdCBlZGdlX3hfbm9ybWFsID0gbmV3IFZlYzMoKTsKCiAgICAgIGVkZ2UuY3Jvc3Mobm9ybWFsLCBlZGdlX3hfbm9ybWFsKTsgLy8gR2V0IHZlY3RvciBiZXR3ZWVuIHBvaW50IGFuZCBjdXJyZW50IHZlcnRleAoKICAgICAgY29uc3QgdmVydGV4X3RvX3AgPSBwb2ludEluUG9seWdvbl92dHA7CiAgICAgIHAudnN1Yih2LCB2ZXJ0ZXhfdG9fcCk7IC8vIFRoaXMgZG90IHByb2R1Y3QgZGV0ZXJtaW5lcyB3aGljaCBzaWRlIG9mIHRoZSBlZGdlIHRoZSBwb2ludCBpcwoKICAgICAgY29uc3QgciA9IGVkZ2VfeF9ub3JtYWwuZG90KHZlcnRleF90b19wKTsgLy8gSWYgYWxsIHN1Y2ggZG90IHByb2R1Y3RzIGhhdmUgc2FtZSBzaWduLCB3ZSBhcmUgaW5zaWRlIHRoZSBwb2x5Z29uLgoKICAgICAgaWYgKHBvc2l0aXZlUmVzdWx0ID09PSBudWxsIHx8IHIgPiAwICYmIHBvc2l0aXZlUmVzdWx0ID09PSB0cnVlIHx8IHIgPD0gMCAmJiBwb3NpdGl2ZVJlc3VsdCA9PT0gZmFsc2UpIHsKICAgICAgICBpZiAocG9zaXRpdmVSZXN1bHQgPT09IG51bGwpIHsKICAgICAgICAgIHBvc2l0aXZlUmVzdWx0ID0gciA+IDA7CiAgICAgICAgfQoKICAgICAgICBjb250aW51ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7IC8vIEVuY291bnRlcmVkIHNvbWUgb3RoZXIgc2lnbi4gRXhpdC4KICAgICAgfQogICAgfSAvLyBJZiB3ZSBnb3QgaGVyZSwgYWxsIGRvdCBwcm9kdWN0cyB3ZXJlIG9mIHRoZSBzYW1lIHNpZ24uCgoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgY29uc3QgYm94X3RvX3NwaGVyZSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQm94X25zID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfbnMxID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfbnMyID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfc2lkZXMgPSBbbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKV07CiAgY29uc3Qgc3BoZXJlQm94X3NwaGVyZV90b19jb3JuZXIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUJveF9zaWRlX25zID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfc2lkZV9uczEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUJveF9zaWRlX25zMiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY29udmV4X3RvX3NwaGVyZSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X2VkZ2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF9lZGdlVW5pdCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X3NwaGVyZVRvQ29ybmVyID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVDb252ZXhfd29ybGRDb3JuZXIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF93b3JsZE5vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X3dvcmxkUG9pbnQgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF93b3JsZFNwaGVyZVBvaW50Q2xvc2VzdFRvUGxhbmUgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF9wZW5ldHJhdGlvblZlYyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X3NwaGVyZVRvV29ybGRQb2ludCA9IG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIGNvbnN0IHBsYW5lQ29udmV4X3YgPSBuZXcgVmVjMygpOwogIGNvbnN0IHBsYW5lQ29udmV4X25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVDb252ZXhfcmVscG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBwbGFuZUNvbnZleF9wcm9qZWN0ZWQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleENvbnZleF9zZXBBeGlzID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb252ZXhDb252ZXhfcSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGFydGljbGVQbGFuZV9ub3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHBhcnRpY2xlUGxhbmVfcmVscG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBwYXJ0aWNsZVBsYW5lX3Byb2plY3RlZCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGFydGljbGVTcGhlcmVfbm9ybWFsID0gbmV3IFZlYzMoKTsgLy8gV0lQCgogIGNvbnN0IGNxaiA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgY29uc3QgY29udmV4UGFydGljbGVfbG9jYWwgPSBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgY29uc3QgY29udmV4UGFydGljbGVfcGVuZXRyYXRlZEZhY2VOb3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleFBhcnRpY2xlX3ZlcnRleFRvUGFydGljbGUgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleFBhcnRpY2xlX3dvcmxkUGVuZXRyYXRpb25WZWMgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleEhlaWdodGZpZWxkX3RtcDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleEhlaWdodGZpZWxkX3RtcDIgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleEhlaWdodGZpZWxkX2ZhY2VMaXN0ID0gWzBdOwogIGNvbnN0IHNwaGVyZUhlaWdodGZpZWxkX3RtcDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUhlaWdodGZpZWxkX3RtcDIgPSBuZXcgVmVjMygpOwoKICBjbGFzcyBPdmVybGFwS2VlcGVyIHsKICAgIC8qKgogICAgICogQHRvZG8gUmVtb3ZlIHVzZWxlc3MgY29uc3RydWN0b3IKICAgICAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMuY3VycmVudCA9IFtdOwogICAgICB0aGlzLnByZXZpb3VzID0gW107CiAgICB9CiAgICAvKioKICAgICAqIGdldEtleQogICAgICovCgoKICAgIGdldEtleShpLCBqKSB7CiAgICAgIGlmIChqIDwgaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICByZXR1cm4gaSA8PCAxNiB8IGo7CiAgICB9CiAgICAvKioKICAgICAqIHNldAogICAgICovCgoKICAgIHNldChpLCBqKSB7CiAgICAgIC8vIEluc2VydGlvbiBzb3J0LiBUaGlzIHdheSB0aGUgZGlmZiB3aWxsIGhhdmUgbGluZWFyIGNvbXBsZXhpdHkuCiAgICAgIGNvbnN0IGtleSA9IHRoaXMuZ2V0S2V5KGksIGopOwogICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5jdXJyZW50OwogICAgICBsZXQgaW5kZXggPSAwOwoKICAgICAgd2hpbGUgKGtleSA+IGN1cnJlbnRbaW5kZXhdKSB7CiAgICAgICAgaW5kZXgrKzsKICAgICAgfQoKICAgICAgaWYgKGtleSA9PT0gY3VycmVudFtpbmRleF0pIHsKICAgICAgICByZXR1cm47IC8vIFBhaXIgd2FzIGFscmVhZHkgYWRkZWQKICAgICAgfQoKICAgICAgZm9yIChsZXQgaiA9IGN1cnJlbnQubGVuZ3RoIC0gMTsgaiA+PSBpbmRleDsgai0tKSB7CiAgICAgICAgY3VycmVudFtqICsgMV0gPSBjdXJyZW50W2pdOwogICAgICB9CgogICAgICBjdXJyZW50W2luZGV4XSA9IGtleTsKICAgIH0KICAgIC8qKgogICAgICogdGljawogICAgICovCgoKICAgIHRpY2soKSB7CiAgICAgIGNvbnN0IHRtcCA9IHRoaXMuY3VycmVudDsKICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy5wcmV2aW91czsKICAgICAgdGhpcy5wcmV2aW91cyA9IHRtcDsKICAgICAgdGhpcy5jdXJyZW50Lmxlbmd0aCA9IDA7CiAgICB9CiAgICAvKioKICAgICAqIGdldERpZmYKICAgICAqLwoKCiAgICBnZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpIHsKICAgICAgY29uc3QgYSA9IHRoaXMuY3VycmVudDsKICAgICAgY29uc3QgYiA9IHRoaXMucHJldmlvdXM7CiAgICAgIGNvbnN0IGFsID0gYS5sZW5ndGg7CiAgICAgIGNvbnN0IGJsID0gYi5sZW5ndGg7CiAgICAgIGxldCBqID0gMDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWw7IGkrKykgewogICAgICAgIGxldCBmb3VuZCA9IGZhbHNlOwogICAgICAgIGNvbnN0IGtleUEgPSBhW2ldOwoKICAgICAgICB3aGlsZSAoa2V5QSA+IGJbal0pIHsKICAgICAgICAgIGorKzsKICAgICAgICB9CgogICAgICAgIGZvdW5kID0ga2V5QSA9PT0gYltqXTsKCiAgICAgICAgaWYgKCFmb3VuZCkgewogICAgICAgICAgdW5wYWNrQW5kUHVzaChhZGRpdGlvbnMsIGtleUEpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaiA9IDA7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJsOyBpKyspIHsKICAgICAgICBsZXQgZm91bmQgPSBmYWxzZTsKICAgICAgICBjb25zdCBrZXlCID0gYltpXTsKCiAgICAgICAgd2hpbGUgKGtleUIgPiBhW2pdKSB7CiAgICAgICAgICBqKys7CiAgICAgICAgfQoKICAgICAgICBmb3VuZCA9IGFbal0gPT09IGtleUI7CgogICAgICAgIGlmICghZm91bmQpIHsKICAgICAgICAgIHVucGFja0FuZFB1c2gocmVtb3ZhbHMsIGtleUIpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICB9CgogIGZ1bmN0aW9uIHVucGFja0FuZFB1c2goYXJyYXksIGtleSkgewogICAgYXJyYXkucHVzaCgoa2V5ICYgMHhmZmZmMDAwMCkgPj4gMTYsIGtleSAmIDB4MDAwMGZmZmYpOwogIH0KCiAgY29uc3QgZ2V0S2V5ID0gKGksIGopID0+IGkgPCBqID8gYCR7aX0tJHtqfWAgOiBgJHtqfS0ke2l9YDsKICAvKioKICAgKiBUdXBsZURpY3Rpb25hcnkKICAgKi8KCgogIGNsYXNzIFR1cGxlRGljdGlvbmFyeSB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy5kYXRhID0gewogICAgICAgIGtleXM6IFtdCiAgICAgIH07CiAgICB9CgogICAgLyoqIGdldCAqLwogICAgZ2V0KGksIGopIHsKICAgICAgY29uc3Qga2V5ID0gZ2V0S2V5KGksIGopOwogICAgICByZXR1cm4gdGhpcy5kYXRhW2tleV07CiAgICB9CiAgICAvKiogc2V0ICovCgoKICAgIHNldChpLCBqLCB2YWx1ZSkgewogICAgICBjb25zdCBrZXkgPSBnZXRLZXkoaSwgaik7IC8vIENoZWNrIGlmIGtleSBhbHJlYWR5IGV4aXN0cwoKICAgICAgaWYgKCF0aGlzLmdldChpLCBqKSkgewogICAgICAgIHRoaXMuZGF0YS5rZXlzLnB1c2goa2V5KTsKICAgICAgfQoKICAgICAgdGhpcy5kYXRhW2tleV0gPSB2YWx1ZTsKICAgIH0KICAgIC8qKiBkZWxldGUgKi8KCgogICAgZGVsZXRlKGksIGopIHsKICAgICAgY29uc3Qga2V5ID0gZ2V0S2V5KGksIGopOwogICAgICBjb25zdCBpbmRleCA9IHRoaXMuZGF0YS5rZXlzLmluZGV4T2Yoa2V5KTsKCiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsKICAgICAgICB0aGlzLmRhdGEua2V5cy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB9CgogICAgICBkZWxldGUgdGhpcy5kYXRhW2tleV07CiAgICB9CiAgICAvKiogcmVzZXQgKi8KCgogICAgcmVzZXQoKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IGtleXMgPSBkYXRhLmtleXM7CgogICAgICB3aGlsZSAoa2V5cy5sZW5ndGggPiAwKSB7CiAgICAgICAgY29uc3Qga2V5ID0ga2V5cy5wb3AoKTsKICAgICAgICBkZWxldGUgZGF0YVtrZXldOwogICAgICB9CiAgICB9CgogIH0KCiAgLyoqCiAgICogVGhlIHBoeXNpY3Mgd29ybGQKICAgKi8KICBjbGFzcyBXb3JsZCBleHRlbmRzIEV2ZW50VGFyZ2V0IHsKICAgIC8qKgogICAgICogQ3VycmVudGx5IC8gbGFzdCB1c2VkIHRpbWVzdGVwLiBJcyBzZXQgdG8gLTEgaWYgbm90IGF2YWlsYWJsZS4gVGhpcyB2YWx1ZSBpcyB1cGRhdGVkIGJlZm9yZSBlYWNoIGludGVybmFsIHN0ZXAsIHdoaWNoIG1lYW5zIHRoYXQgaXQgaXMgImZyZXNoIiBpbnNpZGUgZXZlbnQgY2FsbGJhY2tzLgogICAgICovCgogICAgLyoqCiAgICAgKiBNYWtlcyBib2RpZXMgZ28gdG8gc2xlZXAgd2hlbiB0aGV5J3ZlIGJlZW4gaW5hY3RpdmUuCiAgICAgKiBAZGVmYXVsdCBmYWxzZQogICAgICovCgogICAgLyoqCiAgICAgKiBBbGwgdGhlIGN1cnJlbnQgY29udGFjdHMgKGluc3RhbmNlcyBvZiBDb250YWN0RXF1YXRpb24pIGluIHRoZSB3b3JsZC4KICAgICAqLwoKICAgIC8qKgogICAgICogSG93IG9mdGVuIHRvIG5vcm1hbGl6ZSBxdWF0ZXJuaW9ucy4gU2V0IHRvIDAgZm9yIGV2ZXJ5IHN0ZXAsIDEgZm9yIGV2ZXJ5IHNlY29uZCBldGMuLiBBIGxhcmdlciB2YWx1ZSBpbmNyZWFzZXMgcGVyZm9ybWFuY2UuIElmIGJvZGllcyB0ZW5kIHRvIGV4cGxvZGUsIHNldCB0byBhIHNtYWxsZXIgdmFsdWUgKHplcm8gdG8gYmUgc3VyZSBub3RoaW5nIGNhbiBnbyB3cm9uZykuCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNldCB0byB0cnVlIHRvIHVzZSBmYXN0IHF1YXRlcm5pb24gbm9ybWFsaXphdGlvbi4gSXQgaXMgb2Z0ZW4gZW5vdWdoIGFjY3VyYXRlIHRvIHVzZS4KICAgICAqIElmIGJvZGllcyB0ZW5kIHRvIGV4cGxvZGUsIHNldCB0byBmYWxzZS4KICAgICAqIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSB3YWxsLWNsb2NrIHRpbWUgc2luY2Ugc2ltdWxhdGlvbiBzdGFydC4KICAgICAqLwoKICAgIC8qKgogICAgICogTnVtYmVyIG9mIHRpbWVzdGVwcyB0YWtlbiBzaW5jZSBzdGFydC4KICAgICAqLwoKICAgIC8qKgogICAgICogRGVmYXVsdCBhbmQgbGFzdCB0aW1lc3RlcCBzaXplcy4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGdyYXZpdHkgb2YgdGhlIHdvcmxkLgogICAgICovCgogICAgLyoqCiAgICAgKiBHcmF2aXR5IHRvIHVzZSB3aGVuIGFwcHJveGltYXRpbmcgdGhlIGZyaWN0aW9uIG1heCBmb3JjZSAobXUqbWFzcypncmF2aXR5KS4KICAgICAqIElmIHVuZGVmaW5lZCwgZ2xvYmFsIGdyYXZpdHkgd2lsbCBiZSB1c2VkLgogICAgICogVXNlIHRvIGVuYWJsZSBmcmljdGlvbiBpbiBhIFdvcmxkIHdpdGggYSBudWxsIGdyYXZpdHkgdmVjdG9yIChubyBncmF2aXR5KS4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGJyb2FkcGhhc2UgYWxnb3JpdGhtIHRvIHVzZS4KICAgICAqIEBkZWZhdWx0IE5haXZlQnJvYWRwaGFzZQogICAgICovCgogICAgLyoqCiAgICAgKiBBbGwgYm9kaWVzIGluIHRoaXMgd29ybGQKICAgICAqLwoKICAgIC8qKgogICAgICogVHJ1ZSBpZiBhbnkgYm9kaWVzIGFyZSBub3Qgc2xlZXBpbmcsIGZhbHNlIGlmIGV2ZXJ5IGJvZHkgaXMgc2xlZXBpbmcuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBzb2x2ZXIgYWxnb3JpdGhtIHRvIHVzZS4KICAgICAqIEBkZWZhdWx0IEdTU29sdmVyCiAgICAgKi8KCiAgICAvKioKICAgICAqIGNvbGxpc2lvbk1hdHJpeAogICAgICovCgogICAgLyoqCiAgICAgKiBDb2xsaXNpb25NYXRyaXggZnJvbSB0aGUgcHJldmlvdXMgc3RlcC4KICAgICAqLwoKICAgIC8qKgogICAgICogQWxsIGFkZGVkIGNvbnRhY3RtYXRlcmlhbHMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFVzZWQgdG8gbG9vayB1cCBhIENvbnRhY3RNYXRlcmlhbCBnaXZlbiB0d28gaW5zdGFuY2VzIG9mIE1hdGVyaWFsLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgZGVmYXVsdCBtYXRlcmlhbCBvZiB0aGUgYm9kaWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGlzIGNvbnRhY3QgbWF0ZXJpYWwgaXMgdXNlZCBpZiBubyBzdWl0YWJsZSBjb250YWN0bWF0ZXJpYWwgaXMgZm91bmQgZm9yIGEgY29udGFjdC4KICAgICAqLwoKICAgIC8qKgogICAgICogVGltZSBhY2N1bXVsYXRvciBmb3IgaW50ZXJwb2xhdGlvbi4KICAgICAqIEBzZWUgaHR0cHM6Ly9nYWZmZXJvbmdhbWVzLmNvbS9nYW1lLXBoeXNpY3MvZml4LXlvdXItdGltZXN0ZXAvCiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBiZWVuIGFkZGVkIHRvIHRoZSB3b3JsZC4KICAgICAqLwoKICAgIC8qKgogICAgICogRGlzcGF0Y2hlZCBhZnRlciBhIGJvZHkgaGFzIGJlZW4gcmVtb3ZlZCBmcm9tIHRoZSB3b3JsZC4KICAgICAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBzdXBlcigpOwogICAgICB0aGlzLmR0ID0gLTE7CiAgICAgIHRoaXMuYWxsb3dTbGVlcCA9ICEhb3B0aW9ucy5hbGxvd1NsZWVwOwogICAgICB0aGlzLmNvbnRhY3RzID0gW107CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMgPSBbXTsKICAgICAgdGhpcy5xdWF0Tm9ybWFsaXplU2tpcCA9IG9wdGlvbnMucXVhdE5vcm1hbGl6ZVNraXAgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMucXVhdE5vcm1hbGl6ZVNraXAgOiAwOwogICAgICB0aGlzLnF1YXROb3JtYWxpemVGYXN0ID0gb3B0aW9ucy5xdWF0Tm9ybWFsaXplRmFzdCAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5xdWF0Tm9ybWFsaXplRmFzdCA6IGZhbHNlOwogICAgICB0aGlzLnRpbWUgPSAwLjA7CiAgICAgIHRoaXMuc3RlcG51bWJlciA9IDA7CiAgICAgIHRoaXMuZGVmYXVsdF9kdCA9IDEgLyA2MDsKICAgICAgdGhpcy5uZXh0SWQgPSAwOwogICAgICB0aGlzLmdyYXZpdHkgPSBuZXcgVmVjMygpOwoKICAgICAgaWYgKG9wdGlvbnMuZ3Jhdml0eSkgewogICAgICAgIHRoaXMuZ3Jhdml0eS5jb3B5KG9wdGlvbnMuZ3Jhdml0eSk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLmZyaWN0aW9uR3Jhdml0eSkgewogICAgICAgIHRoaXMuZnJpY3Rpb25HcmF2aXR5ID0gbmV3IFZlYzMoKTsKICAgICAgICB0aGlzLmZyaWN0aW9uR3Jhdml0eS5jb3B5KG9wdGlvbnMuZnJpY3Rpb25HcmF2aXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5icm9hZHBoYXNlID0gb3B0aW9ucy5icm9hZHBoYXNlICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmJyb2FkcGhhc2UgOiBuZXcgTmFpdmVCcm9hZHBoYXNlKCk7CiAgICAgIHRoaXMuYm9kaWVzID0gW107CiAgICAgIHRoaXMuaGFzQWN0aXZlQm9kaWVzID0gZmFsc2U7CiAgICAgIHRoaXMuc29sdmVyID0gb3B0aW9ucy5zb2x2ZXIgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuc29sdmVyIDogbmV3IEdTU29sdmVyKCk7CiAgICAgIHRoaXMuY29uc3RyYWludHMgPSBbXTsKICAgICAgdGhpcy5uYXJyb3dwaGFzZSA9IG5ldyBOYXJyb3dwaGFzZSh0aGlzKTsKICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXggPSBuZXcgQXJyYXlDb2xsaXNpb25NYXRyaXgoKTsKICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXhQcmV2aW91cyA9IG5ldyBBcnJheUNvbGxpc2lvbk1hdHJpeCgpOwogICAgICB0aGlzLmJvZHlPdmVybGFwS2VlcGVyID0gbmV3IE92ZXJsYXBLZWVwZXIoKTsKICAgICAgdGhpcy5zaGFwZU92ZXJsYXBLZWVwZXIgPSBuZXcgT3ZlcmxhcEtlZXBlcigpOwogICAgICB0aGlzLmNvbnRhY3RtYXRlcmlhbHMgPSBbXTsKICAgICAgdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZSA9IG5ldyBUdXBsZURpY3Rpb25hcnkoKTsKICAgICAgdGhpcy5kZWZhdWx0TWF0ZXJpYWwgPSBuZXcgTWF0ZXJpYWwoJ2RlZmF1bHQnKTsKICAgICAgdGhpcy5kZWZhdWx0Q29udGFjdE1hdGVyaWFsID0gbmV3IENvbnRhY3RNYXRlcmlhbCh0aGlzLmRlZmF1bHRNYXRlcmlhbCwgdGhpcy5kZWZhdWx0TWF0ZXJpYWwsIHsKICAgICAgICBmcmljdGlvbjogMC4zLAogICAgICAgIHJlc3RpdHV0aW9uOiAwLjAKICAgICAgfSk7CiAgICAgIHRoaXMuZG9Qcm9maWxpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5wcm9maWxlID0gewogICAgICAgIHNvbHZlOiAwLAogICAgICAgIG1ha2VDb250YWN0Q29uc3RyYWludHM6IDAsCiAgICAgICAgYnJvYWRwaGFzZTogMCwKICAgICAgICBpbnRlZ3JhdGU6IDAsCiAgICAgICAgbmFycm93cGhhc2U6IDAKICAgICAgfTsKICAgICAgdGhpcy5hY2N1bXVsYXRvciA9IDA7CiAgICAgIHRoaXMuc3Vic3lzdGVtcyA9IFtdOwogICAgICB0aGlzLmFkZEJvZHlFdmVudCA9IHsKICAgICAgICB0eXBlOiAnYWRkQm9keScsCiAgICAgICAgYm9keTogbnVsbAogICAgICB9OwogICAgICB0aGlzLnJlbW92ZUJvZHlFdmVudCA9IHsKICAgICAgICB0eXBlOiAncmVtb3ZlQm9keScsCiAgICAgICAgYm9keTogbnVsbAogICAgICB9OwogICAgICB0aGlzLmlkVG9Cb2R5TWFwID0ge307CiAgICAgIHRoaXMuYnJvYWRwaGFzZS5zZXRXb3JsZCh0aGlzKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBjb250YWN0IG1hdGVyaWFsIGJldHdlZW4gbWF0ZXJpYWxzIG0xIGFuZCBtMgogICAgICogQHJldHVybiBUaGUgY29udGFjdCBtYXRlcmlhbCBpZiBpdCB3YXMgZm91bmQuCiAgICAgKi8KCgogICAgZ2V0Q29udGFjdE1hdGVyaWFsKG0xLCBtMikgewogICAgICByZXR1cm4gdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZS5nZXQobTEuaWQsIG0yLmlkKTsKICAgIH0KICAgIC8qKgogICAgICogU3RvcmUgb2xkIGNvbGxpc2lvbiBzdGF0ZSBpbmZvCiAgICAgKi8KCgogICAgY29sbGlzaW9uTWF0cml4VGljaygpIHsKICAgICAgY29uc3QgdGVtcCA9IHRoaXMuY29sbGlzaW9uTWF0cml4UHJldmlvdXM7CiAgICAgIHRoaXMuY29sbGlzaW9uTWF0cml4UHJldmlvdXMgPSB0aGlzLmNvbGxpc2lvbk1hdHJpeDsKICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXggPSB0ZW1wOwogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5yZXNldCgpOwogICAgICB0aGlzLmJvZHlPdmVybGFwS2VlcGVyLnRpY2soKTsKICAgICAgdGhpcy5zaGFwZU92ZXJsYXBLZWVwZXIudGljaygpOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYSBjb25zdHJhaW50IHRvIHRoZSBzaW11bGF0aW9uLgogICAgICovCgoKICAgIGFkZENvbnN0cmFpbnQoYykgewogICAgICB0aGlzLmNvbnN0cmFpbnRzLnB1c2goYyk7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZXMgYSBjb25zdHJhaW50CiAgICAgKi8KCgogICAgcmVtb3ZlQ29uc3RyYWludChjKSB7CiAgICAgIGNvbnN0IGlkeCA9IHRoaXMuY29uc3RyYWludHMuaW5kZXhPZihjKTsKCiAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgdGhpcy5jb25zdHJhaW50cy5zcGxpY2UoaWR4LCAxKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSYXljYXN0IHRlc3QKICAgICAqIEBkZXByZWNhdGVkIFVzZSAucmF5Y2FzdEFsbCwgLnJheWNhc3RDbG9zZXN0IG9yIC5yYXljYXN0QW55IGluc3RlYWQuCiAgICAgKi8KCgogICAgcmF5VGVzdChmcm9tLCB0bywgcmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBSYXljYXN0UmVzdWx0KSB7CiAgICAgICAgLy8gRG8gcmF5Y2FzdENsb3Nlc3QKICAgICAgICB0aGlzLnJheWNhc3RDbG9zZXN0KGZyb20sIHRvLCB7CiAgICAgICAgICBza2lwQmFja2ZhY2VzOiB0cnVlCiAgICAgICAgfSwgcmVzdWx0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBEbyByYXljYXN0QWxsCiAgICAgICAgdGhpcy5yYXljYXN0QWxsKGZyb20sIHRvLCB7CiAgICAgICAgICBza2lwQmFja2ZhY2VzOiB0cnVlCiAgICAgICAgfSwgcmVzdWx0KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSYXkgY2FzdCBhZ2FpbnN0IGFsbCBib2RpZXMuIFRoZSBwcm92aWRlZCBjYWxsYmFjayB3aWxsIGJlIGV4ZWN1dGVkIGZvciBlYWNoIGhpdCB3aXRoIGEgUmF5Y2FzdFJlc3VsdCBhcyBzaW5nbGUgYXJndW1lbnQuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgYW55IGJvZHkgd2FzIGhpdC4KICAgICAqLwoKCiAgICByYXljYXN0QWxsKGZyb20sIHRvLCBvcHRpb25zLCBjYWxsYmFjaykgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBvcHRpb25zLm1vZGUgPSBSYXkuQUxMOwogICAgICBvcHRpb25zLmZyb20gPSBmcm9tOwogICAgICBvcHRpb25zLnRvID0gdG87CiAgICAgIG9wdGlvbnMuY2FsbGJhY2sgPSBjYWxsYmFjazsKICAgICAgcmV0dXJuIHRtcFJheS5pbnRlcnNlY3RXb3JsZCh0aGlzLCBvcHRpb25zKTsKICAgIH0KICAgIC8qKgogICAgICogUmF5IGNhc3QsIGFuZCBzdG9wIGF0IHRoZSBmaXJzdCByZXN1bHQuIE5vdGUgdGhhdCB0aGUgb3JkZXIgaXMgcmFuZG9tIC0gYnV0IHRoZSBtZXRob2QgaXMgZmFzdC4KICAgICAqIEByZXR1cm4gVHJ1ZSBpZiBhbnkgYm9keSB3YXMgaGl0LgogICAgICovCgoKICAgIHJheWNhc3RBbnkoZnJvbSwgdG8sIG9wdGlvbnMsIHJlc3VsdCkgewogICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7CiAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICB9CgogICAgICBvcHRpb25zLm1vZGUgPSBSYXkuQU5ZOwogICAgICBvcHRpb25zLmZyb20gPSBmcm9tOwogICAgICBvcHRpb25zLnRvID0gdG87CiAgICAgIG9wdGlvbnMucmVzdWx0ID0gcmVzdWx0OwogICAgICByZXR1cm4gdG1wUmF5LmludGVyc2VjdFdvcmxkKHRoaXMsIG9wdGlvbnMpOwogICAgfQogICAgLyoqCiAgICAgKiBSYXkgY2FzdCwgYW5kIHJldHVybiBpbmZvcm1hdGlvbiBvZiB0aGUgY2xvc2VzdCBoaXQuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgYW55IGJvZHkgd2FzIGhpdC4KICAgICAqLwoKCiAgICByYXljYXN0Q2xvc2VzdChmcm9tLCB0bywgb3B0aW9ucywgcmVzdWx0KSB7CiAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIG9wdGlvbnMubW9kZSA9IFJheS5DTE9TRVNUOwogICAgICBvcHRpb25zLmZyb20gPSBmcm9tOwogICAgICBvcHRpb25zLnRvID0gdG87CiAgICAgIG9wdGlvbnMucmVzdWx0ID0gcmVzdWx0OwogICAgICByZXR1cm4gdG1wUmF5LmludGVyc2VjdFdvcmxkKHRoaXMsIG9wdGlvbnMpOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYSByaWdpZCBib2R5IHRvIHRoZSBzaW11bGF0aW9uLgogICAgICogQHRvZG8gSWYgdGhlIHNpbXVsYXRpb24gaGFzIG5vdCB5ZXQgc3RhcnRlZCwgd2h5IHJlY3JldGUgYW5kIGNvcHkgYXJyYXlzIGZvciBlYWNoIGJvZHk/IEFjY3VtdWxhdGUgaW4gZHluYW1pYyBhcnJheXMgaW4gdGhpcyBjYXNlLgogICAgICogQHRvZG8gQWRkaW5nIGFuIGFycmF5IG9mIGJvZGllcyBzaG91bGQgYmUgcG9zc2libGUuIFRoaXMgd291bGQgc2F2ZSBzb21lIGxvb3BzIHRvbwogICAgICovCgoKICAgIGFkZEJvZHkoYm9keSkgewogICAgICBpZiAodGhpcy5ib2RpZXMuaW5jbHVkZXMoYm9keSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGJvZHkuaW5kZXggPSB0aGlzLmJvZGllcy5sZW5ndGg7CiAgICAgIHRoaXMuYm9kaWVzLnB1c2goYm9keSk7CiAgICAgIGJvZHkud29ybGQgPSB0aGlzOwogICAgICBib2R5LmluaXRQb3NpdGlvbi5jb3B5KGJvZHkucG9zaXRpb24pOwogICAgICBib2R5LmluaXRWZWxvY2l0eS5jb3B5KGJvZHkudmVsb2NpdHkpOwogICAgICBib2R5LnRpbWVMYXN0U2xlZXB5ID0gdGhpcy50aW1lOwoKICAgICAgaWYgKGJvZHkgaW5zdGFuY2VvZiBCb2R5KSB7CiAgICAgICAgYm9keS5pbml0QW5ndWxhclZlbG9jaXR5LmNvcHkoYm9keS5hbmd1bGFyVmVsb2NpdHkpOwogICAgICAgIGJvZHkuaW5pdFF1YXRlcm5pb24uY29weShib2R5LnF1YXRlcm5pb24pOwogICAgICB9CgogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5zZXROdW1PYmplY3RzKHRoaXMuYm9kaWVzLmxlbmd0aCk7CiAgICAgIHRoaXMuYWRkQm9keUV2ZW50LmJvZHkgPSBib2R5OwogICAgICB0aGlzLmlkVG9Cb2R5TWFwW2JvZHkuaWRdID0gYm9keTsKICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KHRoaXMuYWRkQm9keUV2ZW50KTsKICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlIGEgcmlnaWQgYm9keSBmcm9tIHRoZSBzaW11bGF0aW9uLgogICAgICovCgoKICAgIHJlbW92ZUJvZHkoYm9keSkgewogICAgICBib2R5LndvcmxkID0gbnVsbDsKICAgICAgY29uc3QgbiA9IHRoaXMuYm9kaWVzLmxlbmd0aCAtIDE7CiAgICAgIGNvbnN0IGJvZGllcyA9IHRoaXMuYm9kaWVzOwogICAgICBjb25zdCBpZHggPSBib2RpZXMuaW5kZXhPZihib2R5KTsKCiAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgYm9kaWVzLnNwbGljZShpZHgsIDEpOyAvLyBUb2RvOiBzaG91bGQgdXNlIGEgZ2FyYmFnZSBmcmVlIG1ldGhvZAogICAgICAgIC8vIFJlY29tcHV0ZSBpbmRleAoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gYm9kaWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBib2RpZXNbaV0uaW5kZXggPSBpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXguc2V0TnVtT2JqZWN0cyhuKTsKICAgICAgICB0aGlzLnJlbW92ZUJvZHlFdmVudC5ib2R5ID0gYm9keTsKICAgICAgICBkZWxldGUgdGhpcy5pZFRvQm9keU1hcFtib2R5LmlkXTsKICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQodGhpcy5yZW1vdmVCb2R5RXZlbnQpOwogICAgICB9CiAgICB9CgogICAgZ2V0Qm9keUJ5SWQoaWQpIHsKICAgICAgcmV0dXJuIHRoaXMuaWRUb0JvZHlNYXBbaWRdOwogICAgfQogICAgLyoqCiAgICAgKiBAdG9kbyBNYWtlIGEgZmFzdGVyIG1hcAogICAgICovCgoKICAgIGdldFNoYXBlQnlJZChpZCkgewogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmJvZGllczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9kaWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3Qgc2hhcGVzID0gYm9kaWVzW2ldLnNoYXBlczsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzaGFwZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGNvbnN0IHNoYXBlID0gc2hhcGVzW2pdOwoKICAgICAgICAgIGlmIChzaGFwZS5pZCA9PT0gaWQpIHsKICAgICAgICAgICAgcmV0dXJuIHNoYXBlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICAvKioKICAgICAqIEFkZHMgYSBjb250YWN0IG1hdGVyaWFsIHRvIHRoZSBXb3JsZAogICAgICovCgoKICAgIGFkZENvbnRhY3RNYXRlcmlhbChjbWF0KSB7CiAgICAgIC8vIEFkZCBjb250YWN0IG1hdGVyaWFsCiAgICAgIHRoaXMuY29udGFjdG1hdGVyaWFscy5wdXNoKGNtYXQpOyAvLyBBZGQgY3VycmVudCBjb250YWN0IG1hdGVyaWFsIHRvIHRoZSBtYXRlcmlhbCB0YWJsZQoKICAgICAgdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZS5zZXQoY21hdC5tYXRlcmlhbHNbMF0uaWQsIGNtYXQubWF0ZXJpYWxzWzFdLmlkLCBjbWF0KTsKICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlcyBhIGNvbnRhY3QgbWF0ZXJpYWwgZnJvbSB0aGUgV29ybGQuCiAgICAgKi8KCgogICAgcmVtb3ZlQ29udGFjdE1hdGVyaWFsKGNtYXQpIHsKICAgICAgY29uc3QgaWR4ID0gdGhpcy5jb250YWN0bWF0ZXJpYWxzLmluZGV4T2YoY21hdCk7CgogICAgICBpZiAoaWR4ID09PSAtMSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5jb250YWN0bWF0ZXJpYWxzLnNwbGljZShpZHgsIDEpOwogICAgICB0aGlzLmNvbnRhY3RNYXRlcmlhbFRhYmxlLmRlbGV0ZShjbWF0Lm1hdGVyaWFsc1swXS5pZCwgY21hdC5tYXRlcmlhbHNbMV0uaWQpOwogICAgfQogICAgLyoqCiAgICAgKiBTdGVwIHRoZSBzaW11bGF0aW9uIGZvcndhcmQga2VlcGluZyB0cmFjayBvZiBsYXN0IGNhbGxlZCB0aW1lCiAgICAgKiB0byBiZSBhYmxlIHRvIHN0ZXAgdGhlIHdvcmxkIGF0IGEgZml4ZWQgcmF0ZSwgaW5kZXBlbmRlbnRseSBvZiBmcmFtZXJhdGUuCiAgICAgKgogICAgICogQHBhcmFtIGR0IFRoZSBmaXhlZCB0aW1lIHN0ZXAgc2l6ZSB0byB1c2UgKGRlZmF1bHQ6IDEgLyA2MCkuCiAgICAgKiBAcGFyYW0gbWF4U3ViU3RlcHMgTWF4aW11bSBudW1iZXIgb2YgZml4ZWQgc3RlcHMgdG8gdGFrZSBwZXIgZnVuY3Rpb24gY2FsbCAoZGVmYXVsdDogMTApLgogICAgICogQHNlZSBodHRwczovL2dhZmZlcm9uZ2FtZXMuY29tL3Bvc3QvZml4X3lvdXJfdGltZXN0ZXAvCiAgICAgKiBAZXhhbXBsZQogICAgICogICAgIC8vIFJ1biB0aGUgc2ltdWxhdGlvbiBpbmRlcGVuZGVudGx5IG9mIGZyYW1lcmF0ZSBldmVyeSAxIC8gNjAgbXMKICAgICAqICAgICB3b3JsZC5maXhlZFN0ZXAoKQogICAgICovCgoKICAgIGZpeGVkU3RlcChkdCwgbWF4U3ViU3RlcHMpIHsKICAgICAgaWYgKGR0ID09PSB2b2lkIDApIHsKICAgICAgICBkdCA9IDEgLyA2MDsKICAgICAgfQoKICAgICAgaWYgKG1heFN1YlN0ZXBzID09PSB2b2lkIDApIHsKICAgICAgICBtYXhTdWJTdGVwcyA9IDEwOwogICAgICB9CgogICAgICBjb25zdCB0aW1lID0gcGVyZm9ybWFuY2Uubm93KCkgLyAxMDAwOyAvLyBzZWNvbmRzCgogICAgICBpZiAoIXRoaXMubGFzdENhbGxUaW1lKSB7CiAgICAgICAgdGhpcy5zdGVwKGR0LCB1bmRlZmluZWQsIG1heFN1YlN0ZXBzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCB0aW1lU2luY2VMYXN0Q2FsbGVkID0gdGltZSAtIHRoaXMubGFzdENhbGxUaW1lOwogICAgICAgIHRoaXMuc3RlcChkdCwgdGltZVNpbmNlTGFzdENhbGxlZCwgbWF4U3ViU3RlcHMpOwogICAgICB9CgogICAgICB0aGlzLmxhc3RDYWxsVGltZSA9IHRpbWU7CiAgICB9CiAgICAvKioKICAgICAqIFN0ZXAgdGhlIHBoeXNpY3Mgd29ybGQgZm9yd2FyZCBpbiB0aW1lLgogICAgICoKICAgICAqIFRoZXJlIGFyZSB0d28gbW9kZXMuIFRoZSBzaW1wbGUgbW9kZSBpcyBmaXhlZCB0aW1lc3RlcHBpbmcgd2l0aG91dCBpbnRlcnBvbGF0aW9uLiBJbiB0aGlzIGNhc2UgeW91IG9ubHkgdXNlIHRoZSBmaXJzdCBhcmd1bWVudC4gVGhlIHNlY29uZCBjYXNlIHVzZXMgaW50ZXJwb2xhdGlvbi4gSW4gdGhhdCB5b3UgYWxzbyBwcm92aWRlIHRoZSB0aW1lIHNpbmNlIHRoZSBmdW5jdGlvbiB3YXMgbGFzdCB1c2VkLCBhcyB3ZWxsIGFzIHRoZSBtYXhpbXVtIGZpeGVkIHRpbWVzdGVwcyB0byB0YWtlLgogICAgICoKICAgICAqIEBwYXJhbSBkdCBUaGUgZml4ZWQgdGltZSBzdGVwIHNpemUgdG8gdXNlLgogICAgICogQHBhcmFtIHRpbWVTaW5jZUxhc3RDYWxsZWQgVGhlIHRpbWUgZWxhcHNlZCBzaW5jZSB0aGUgZnVuY3Rpb24gd2FzIGxhc3QgY2FsbGVkLgogICAgICogQHBhcmFtIG1heFN1YlN0ZXBzIE1heGltdW0gbnVtYmVyIG9mIGZpeGVkIHN0ZXBzIHRvIHRha2UgcGVyIGZ1bmN0aW9uIGNhbGwgKGRlZmF1bHQ6IDEwKS4KICAgICAqIEBzZWUgaHR0cHM6Ly93ZWIuYXJjaGl2ZS5vcmcvd2ViLzIwMTgwNDI2MTU0NTMxL2h0dHA6Ly9idWxsZXRwaHlzaWNzLm9yZy9tZWRpYXdpa2ktMS41LjgvaW5kZXgucGhwL1N0ZXBwaW5nX1RoZV9Xb3JsZCNXaGF0X2RvX3RoZV9wYXJhbWV0ZXJzX3RvX2J0RHluYW1pY3NXb3JsZDo6c3RlcFNpbXVsYXRpb25fbWVhbi4zRgogICAgICogQGV4YW1wbGUKICAgICAqICAgICAvLyBmaXhlZCB0aW1lc3RlcHBpbmcgd2l0aG91dCBpbnRlcnBvbGF0aW9uCiAgICAgKiAgICAgd29ybGQuc3RlcCgxIC8gNjApCiAgICAgKi8KCgogICAgc3RlcChkdCwgdGltZVNpbmNlTGFzdENhbGxlZCwgbWF4U3ViU3RlcHMpIHsKICAgICAgaWYgKG1heFN1YlN0ZXBzID09PSB2b2lkIDApIHsKICAgICAgICBtYXhTdWJTdGVwcyA9IDEwOwogICAgICB9CgogICAgICBpZiAodGltZVNpbmNlTGFzdENhbGxlZCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgLy8gRml4ZWQsIHNpbXBsZSBzdGVwcGluZwogICAgICAgIHRoaXMuaW50ZXJuYWxTdGVwKGR0KTsgLy8gSW5jcmVtZW50IHRpbWUKCiAgICAgICAgdGhpcy50aW1lICs9IGR0OwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYWNjdW11bGF0b3IgKz0gdGltZVNpbmNlTGFzdENhbGxlZDsKICAgICAgICBjb25zdCB0MCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICAgIGxldCBzdWJzdGVwcyA9IDA7CgogICAgICAgIHdoaWxlICh0aGlzLmFjY3VtdWxhdG9yID49IGR0ICYmIHN1YnN0ZXBzIDwgbWF4U3ViU3RlcHMpIHsKICAgICAgICAgIC8vIERvIGZpeGVkIHN0ZXBzIHRvIGNhdGNoIHVwCiAgICAgICAgICB0aGlzLmludGVybmFsU3RlcChkdCk7CiAgICAgICAgICB0aGlzLmFjY3VtdWxhdG9yIC09IGR0OwogICAgICAgICAgc3Vic3RlcHMrKzsKCiAgICAgICAgICBpZiAocGVyZm9ybWFuY2Uubm93KCkgLSB0MCA+IGR0ICogMTAwMCkgewogICAgICAgICAgICAvLyBUaGUgZnJhbWVyYXRlIGlzIG5vdCBpbnRlcmFjdGl2ZSBhbnltb3JlLgogICAgICAgICAgICAvLyBXZSBhcmUgYmVsb3cgdGhlIHRhcmdldCBmcmFtZXJhdGUuCiAgICAgICAgICAgIC8vIEJldHRlciBiYWlsIG91dC4KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBSZW1vdmUgdGhlIGV4Y2VzcyBhY2N1bXVsYXRvciwgc2luY2Ugd2UgbWF5IG5vdAogICAgICAgIC8vIGhhdmUgaGFkIGVub3VnaCBzdWJzdGVwcyBhdmFpbGFibGUgdG8gY2F0Y2ggdXAKCgogICAgICAgIHRoaXMuYWNjdW11bGF0b3IgPSB0aGlzLmFjY3VtdWxhdG9yICUgZHQ7CiAgICAgICAgY29uc3QgdCA9IHRoaXMuYWNjdW11bGF0b3IgLyBkdDsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IHRoaXMuYm9kaWVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCBiID0gdGhpcy5ib2RpZXNbal07CiAgICAgICAgICBiLnByZXZpb3VzUG9zaXRpb24ubGVycChiLnBvc2l0aW9uLCB0LCBiLmludGVycG9sYXRlZFBvc2l0aW9uKTsKICAgICAgICAgIGIucHJldmlvdXNRdWF0ZXJuaW9uLnNsZXJwKGIucXVhdGVybmlvbiwgdCwgYi5pbnRlcnBvbGF0ZWRRdWF0ZXJuaW9uKTsKICAgICAgICAgIGIucHJldmlvdXNRdWF0ZXJuaW9uLm5vcm1hbGl6ZSgpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy50aW1lICs9IHRpbWVTaW5jZUxhc3RDYWxsZWQ7CiAgICAgIH0KICAgIH0KCiAgICBpbnRlcm5hbFN0ZXAoZHQpIHsKICAgICAgdGhpcy5kdCA9IGR0OwogICAgICBjb25zdCBjb250YWN0cyA9IHRoaXMuY29udGFjdHM7CiAgICAgIGNvbnN0IHAxID0gV29ybGRfc3RlcF9wMTsKICAgICAgY29uc3QgcDIgPSBXb3JsZF9zdGVwX3AyOwogICAgICBjb25zdCBOID0gdGhpcy5ib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmJvZGllczsKICAgICAgY29uc3Qgc29sdmVyID0gdGhpcy5zb2x2ZXI7CiAgICAgIGNvbnN0IGdyYXZpdHkgPSB0aGlzLmdyYXZpdHk7CiAgICAgIGNvbnN0IGRvUHJvZmlsaW5nID0gdGhpcy5kb1Byb2ZpbGluZzsKICAgICAgY29uc3QgcHJvZmlsZSA9IHRoaXMucHJvZmlsZTsKICAgICAgY29uc3QgRFlOQU1JQyA9IEJvZHkuRFlOQU1JQzsKICAgICAgbGV0IHByb2ZpbGluZ1N0YXJ0ID0gLUluZmluaXR5OwogICAgICBjb25zdCBjb25zdHJhaW50cyA9IHRoaXMuY29uc3RyYWludHM7CiAgICAgIGNvbnN0IGZyaWN0aW9uRXF1YXRpb25Qb29sID0gV29ybGRfc3RlcF9mcmljdGlvbkVxdWF0aW9uUG9vbDsKICAgICAgZ3Jhdml0eS5sZW5ndGgoKTsKICAgICAgY29uc3QgZ3ggPSBncmF2aXR5Lng7CiAgICAgIGNvbnN0IGd5ID0gZ3Jhdml0eS55OwogICAgICBjb25zdCBneiA9IGdyYXZpdHkuejsKICAgICAgbGV0IGkgPSAwOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsaW5nU3RhcnQgPSBwZXJmb3JtYW5jZS5ub3coKTsKICAgICAgfSAvLyBBZGQgZ3Jhdml0eSB0byBhbGwgb2JqZWN0cwoKCiAgICAgIGZvciAoaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IGJpID0gYm9kaWVzW2ldOwoKICAgICAgICBpZiAoYmkudHlwZSA9PT0gRFlOQU1JQykgewogICAgICAgICAgLy8gT25seSBmb3IgZHluYW1pYyBib2RpZXMKICAgICAgICAgIGNvbnN0IGYgPSBiaS5mb3JjZTsKICAgICAgICAgIGNvbnN0IG0gPSBiaS5tYXNzOwogICAgICAgICAgZi54ICs9IG0gKiBneDsKICAgICAgICAgIGYueSArPSBtICogZ3k7CiAgICAgICAgICBmLnogKz0gbSAqIGd6OwogICAgICAgIH0KICAgICAgfSAvLyBVcGRhdGUgc3Vic3lzdGVtcwoKCiAgICAgIGZvciAobGV0IGkgPSAwLCBOc3Vic3lzdGVtcyA9IHRoaXMuc3Vic3lzdGVtcy5sZW5ndGg7IGkgIT09IE5zdWJzeXN0ZW1zOyBpKyspIHsKICAgICAgICB0aGlzLnN1YnN5c3RlbXNbaV0udXBkYXRlKCk7CiAgICAgIH0gLy8gQ29sbGlzaW9uIGRldGVjdGlvbgoKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGluZ1N0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICAgIH0KCiAgICAgIHAxLmxlbmd0aCA9IDA7IC8vIENsZWFuIHVwIHBhaXIgYXJyYXlzIGZyb20gbGFzdCBzdGVwCgogICAgICBwMi5sZW5ndGggPSAwOwogICAgICB0aGlzLmJyb2FkcGhhc2UuY29sbGlzaW9uUGFpcnModGhpcywgcDEsIHAyKTsKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGUuYnJvYWRwaGFzZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gcHJvZmlsaW5nU3RhcnQ7CiAgICAgIH0gLy8gUmVtb3ZlIGNvbnN0cmFpbmVkIHBhaXJzIHdpdGggY29sbGlkZUNvbm5lY3RlZCA9PSBmYWxzZQoKCiAgICAgIGxldCBOY29uc3RyYWludHMgPSBjb25zdHJhaW50cy5sZW5ndGg7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOY29uc3RyYWludHM7IGkrKykgewogICAgICAgIGNvbnN0IGMgPSBjb25zdHJhaW50c1tpXTsKCiAgICAgICAgaWYgKCFjLmNvbGxpZGVDb25uZWN0ZWQpIHsKICAgICAgICAgIGZvciAobGV0IGogPSBwMS5sZW5ndGggLSAxOyBqID49IDA7IGogLT0gMSkgewogICAgICAgICAgICBpZiAoYy5ib2R5QSA9PT0gcDFbal0gJiYgYy5ib2R5QiA9PT0gcDJbal0gfHwgYy5ib2R5QiA9PT0gcDFbal0gJiYgYy5ib2R5QSA9PT0gcDJbal0pIHsKICAgICAgICAgICAgICBwMS5zcGxpY2UoaiwgMSk7CiAgICAgICAgICAgICAgcDIuc3BsaWNlKGosIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeFRpY2soKTsgLy8gR2VuZXJhdGUgY29udGFjdHMKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGluZ1N0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IG9sZGNvbnRhY3RzID0gV29ybGRfc3RlcF9vbGRDb250YWN0czsKICAgICAgY29uc3QgTm9sZENvbnRhY3RzID0gY29udGFjdHMubGVuZ3RoOwoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTm9sZENvbnRhY3RzOyBpKyspIHsKICAgICAgICBvbGRjb250YWN0cy5wdXNoKGNvbnRhY3RzW2ldKTsKICAgICAgfQoKICAgICAgY29udGFjdHMubGVuZ3RoID0gMDsgLy8gVHJhbnNmZXIgRnJpY3Rpb25FcXVhdGlvbiBmcm9tIGN1cnJlbnQgbGlzdCB0byB0aGUgcG9vbCBmb3IgcmV1c2UKCiAgICAgIGNvbnN0IE5vbGRGcmljdGlvbkVxdWF0aW9ucyA9IHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMubGVuZ3RoOwoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTm9sZEZyaWN0aW9uRXF1YXRpb25zOyBpKyspIHsKICAgICAgICBmcmljdGlvbkVxdWF0aW9uUG9vbC5wdXNoKHRoaXMuZnJpY3Rpb25FcXVhdGlvbnNbaV0pOwogICAgICB9CgogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25zLmxlbmd0aCA9IDA7CiAgICAgIHRoaXMubmFycm93cGhhc2UuZ2V0Q29udGFjdHMocDEsIHAyLCB0aGlzLCBjb250YWN0cywgb2xkY29udGFjdHMsIC8vIFRvIGJlIHJldXNlZAogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25zLCBmcmljdGlvbkVxdWF0aW9uUG9vbCk7CgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxlLm5hcnJvd3BoYXNlID0gcGVyZm9ybWFuY2Uubm93KCkgLSBwcm9maWxpbmdTdGFydDsKICAgICAgfSAvLyBMb29wIG92ZXIgYWxsIGNvbGxpc2lvbnMKCgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxpbmdTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICB9IC8vIEFkZCBhbGwgZnJpY3Rpb24gZXFzCgoKICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICBzb2x2ZXIuYWRkRXF1YXRpb24odGhpcy5mcmljdGlvbkVxdWF0aW9uc1tpXSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IG5jb250YWN0cyA9IGNvbnRhY3RzLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGsgPSAwOyBrICE9PSBuY29udGFjdHM7IGsrKykgewogICAgICAgIC8vIEN1cnJlbnQgY29udGFjdAogICAgICAgIGNvbnN0IGMgPSBjb250YWN0c1trXTsgLy8gR2V0IGN1cnJlbnQgY29sbGlzaW9uIGluZGVjZXMKCiAgICAgICAgY29uc3QgYmkgPSBjLmJpOwogICAgICAgIGNvbnN0IGJqID0gYy5iajsKICAgICAgICBjb25zdCBzaSA9IGMuc2k7CiAgICAgICAgY29uc3Qgc2ogPSBjLnNqOyAvLyBHZXQgY29sbGlzaW9uIHByb3BlcnRpZXMKCiAgICAgICAgbGV0IGNtOwoKICAgICAgICBpZiAoYmkubWF0ZXJpYWwgJiYgYmoubWF0ZXJpYWwpIHsKICAgICAgICAgIGNtID0gdGhpcy5nZXRDb250YWN0TWF0ZXJpYWwoYmkubWF0ZXJpYWwsIGJqLm1hdGVyaWFsKSB8fCB0aGlzLmRlZmF1bHRDb250YWN0TWF0ZXJpYWw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNtID0gdGhpcy5kZWZhdWx0Q29udGFjdE1hdGVyaWFsOwogICAgICAgIH0gLy8gYy5lbmFibGVkID0gYmkuY29sbGlzaW9uUmVzcG9uc2UgJiYgYmouY29sbGlzaW9uUmVzcG9uc2UgJiYgc2kuY29sbGlzaW9uUmVzcG9uc2UgJiYgc2ouY29sbGlzaW9uUmVzcG9uc2U7CgoKICAgICAgICBjbS5mcmljdGlvbjsgLy8gYy5yZXN0aXR1dGlvbiA9IGNtLnJlc3RpdHV0aW9uOwogICAgICAgIC8vIElmIGZyaWN0aW9uIG9yIHJlc3RpdHV0aW9uIHdlcmUgc3BlY2lmaWVkIGluIHRoZSBtYXRlcmlhbCwgdXNlIHRoZW0KCiAgICAgICAgaWYgKGJpLm1hdGVyaWFsICYmIGJqLm1hdGVyaWFsKSB7CiAgICAgICAgICBpZiAoYmkubWF0ZXJpYWwuZnJpY3Rpb24gPj0gMCAmJiBiai5tYXRlcmlhbC5mcmljdGlvbiA+PSAwKSB7CiAgICAgICAgICAgIGJpLm1hdGVyaWFsLmZyaWN0aW9uICogYmoubWF0ZXJpYWwuZnJpY3Rpb247CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGJpLm1hdGVyaWFsLnJlc3RpdHV0aW9uID49IDAgJiYgYmoubWF0ZXJpYWwucmVzdGl0dXRpb24gPj0gMCkgewogICAgICAgICAgICBjLnJlc3RpdHV0aW9uID0gYmkubWF0ZXJpYWwucmVzdGl0dXRpb24gKiBiai5tYXRlcmlhbC5yZXN0aXR1dGlvbjsKICAgICAgICAgIH0KICAgICAgICB9IC8vIGMuc2V0U3Bvb2tQYXJhbXMoCiAgICAgICAgLy8gICAgICAgICAgIGNtLmNvbnRhY3RFcXVhdGlvblN0aWZmbmVzcywKICAgICAgICAvLyAgICAgICAgICAgY20uY29udGFjdEVxdWF0aW9uUmVsYXhhdGlvbiwKICAgICAgICAvLyAgICAgICAgICAgZHQKICAgICAgICAvLyAgICAgICApOwoKCiAgICAgICAgc29sdmVyLmFkZEVxdWF0aW9uKGMpOyAvLyAvLyBBZGQgZnJpY3Rpb24gY29uc3RyYWludCBlcXVhdGlvbgogICAgICAgIC8vIGlmKG11ID4gMCl7CiAgICAgICAgLy8gCS8vIENyZWF0ZSAyIHRhbmdlbnQgZXF1YXRpb25zCiAgICAgICAgLy8gCWNvbnN0IG11ZyA9IG11ICogZ25vcm07CiAgICAgICAgLy8gCWNvbnN0IHJlZHVjZWRNYXNzID0gKGJpLmludk1hc3MgKyBiai5pbnZNYXNzKTsKICAgICAgICAvLyAJaWYocmVkdWNlZE1hc3MgPiAwKXsKICAgICAgICAvLyAJCXJlZHVjZWRNYXNzID0gMS9yZWR1Y2VkTWFzczsKICAgICAgICAvLyAJfQogICAgICAgIC8vIAljb25zdCBwb29sID0gZnJpY3Rpb25FcXVhdGlvblBvb2w7CiAgICAgICAgLy8gCWNvbnN0IGMxID0gcG9vbC5sZW5ndGggPyBwb29sLnBvcCgpIDogbmV3IEZyaWN0aW9uRXF1YXRpb24oYmksYmosbXVnKnJlZHVjZWRNYXNzKTsKICAgICAgICAvLyAJY29uc3QgYzIgPSBwb29sLmxlbmd0aCA/IHBvb2wucG9wKCkgOiBuZXcgRnJpY3Rpb25FcXVhdGlvbihiaSxiaixtdWcqcmVkdWNlZE1hc3MpOwogICAgICAgIC8vIAl0aGlzLmZyaWN0aW9uRXF1YXRpb25zLnB1c2goYzEsIGMyKTsKICAgICAgICAvLyAJYzEuYmkgPSBjMi5iaSA9IGJpOwogICAgICAgIC8vIAljMS5iaiA9IGMyLmJqID0gYmo7CiAgICAgICAgLy8gCWMxLm1pbkZvcmNlID0gYzIubWluRm9yY2UgPSAtbXVnKnJlZHVjZWRNYXNzOwogICAgICAgIC8vIAljMS5tYXhGb3JjZSA9IGMyLm1heEZvcmNlID0gbXVnKnJlZHVjZWRNYXNzOwogICAgICAgIC8vIAkvLyBDb3B5IG92ZXIgdGhlIHJlbGF0aXZlIHZlY3RvcnMKICAgICAgICAvLyAJYzEucmkuY29weShjLnJpKTsKICAgICAgICAvLyAJYzEucmouY29weShjLnJqKTsKICAgICAgICAvLyAJYzIucmkuY29weShjLnJpKTsKICAgICAgICAvLyAJYzIucmouY29weShjLnJqKTsKICAgICAgICAvLyAJLy8gQ29uc3RydWN0IHRhbmdlbnRzCiAgICAgICAgLy8gCWMubmkudGFuZ2VudHMoYzEudCwgYzIudCk7CiAgICAgICAgLy8gICAgICAgICAgIC8vIFNldCBzcG9vayBwYXJhbXMKICAgICAgICAvLyAgICAgICAgICAgYzEuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIGR0KTsKICAgICAgICAvLyAgICAgICAgICAgYzIuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIGR0KTsKICAgICAgICAvLyAgICAgICAgICAgYzEuZW5hYmxlZCA9IGMyLmVuYWJsZWQgPSBjLmVuYWJsZWQ7CiAgICAgICAgLy8gCS8vIEFkZCBlcXVhdGlvbnMgdG8gc29sdmVyCiAgICAgICAgLy8gCXNvbHZlci5hZGRFcXVhdGlvbihjMSk7CiAgICAgICAgLy8gCXNvbHZlci5hZGRFcXVhdGlvbihjMik7CiAgICAgICAgLy8gfQoKICAgICAgICBpZiAoYmkuYWxsb3dTbGVlcCAmJiBiaS50eXBlID09PSBCb2R5LkRZTkFNSUMgJiYgYmkuc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORyAmJiBiai5zbGVlcFN0YXRlID09PSBCb2R5LkFXQUtFICYmIGJqLnR5cGUgIT09IEJvZHkuU1RBVElDKSB7CiAgICAgICAgICBjb25zdCBzcGVlZFNxdWFyZWRCID0gYmoudmVsb2NpdHkubGVuZ3RoU3F1YXJlZCgpICsgYmouYW5ndWxhclZlbG9jaXR5Lmxlbmd0aFNxdWFyZWQoKTsKICAgICAgICAgIGNvbnN0IHNwZWVkTGltaXRTcXVhcmVkQiA9IGJqLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICAgIGlmIChzcGVlZFNxdWFyZWRCID49IHNwZWVkTGltaXRTcXVhcmVkQiAqIDIpIHsKICAgICAgICAgICAgYmkud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoYmouYWxsb3dTbGVlcCAmJiBiai50eXBlID09PSBCb2R5LkRZTkFNSUMgJiYgYmouc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORyAmJiBiaS5zbGVlcFN0YXRlID09PSBCb2R5LkFXQUtFICYmIGJpLnR5cGUgIT09IEJvZHkuU1RBVElDKSB7CiAgICAgICAgICBjb25zdCBzcGVlZFNxdWFyZWRBID0gYmkudmVsb2NpdHkubGVuZ3RoU3F1YXJlZCgpICsgYmkuYW5ndWxhclZlbG9jaXR5Lmxlbmd0aFNxdWFyZWQoKTsKICAgICAgICAgIGNvbnN0IHNwZWVkTGltaXRTcXVhcmVkQSA9IGJpLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICAgIGlmIChzcGVlZFNxdWFyZWRBID49IHNwZWVkTGltaXRTcXVhcmVkQSAqIDIpIHsKICAgICAgICAgICAgYmoud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBOb3cgd2Uga25vdyB0aGF0IGkgYW5kIGogYXJlIGluIGNvbnRhY3QuIFNldCBjb2xsaXNpb24gbWF0cml4IHN0YXRlCgoKICAgICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5zZXQoYmksIGJqLCB0cnVlKTsKCiAgICAgICAgaWYgKCF0aGlzLmNvbGxpc2lvbk1hdHJpeFByZXZpb3VzLmdldChiaSwgYmopKSB7CiAgICAgICAgICAvLyBGaXJzdCBjb250YWN0IQogICAgICAgICAgLy8gV2UgcmV1c2UgdGhlIGNvbGxpZGVFdmVudCBvYmplY3QsIG90aGVyd2lzZSB3ZSB3aWxsIGVuZCB1cCBjcmVhdGluZyBuZXcgb2JqZWN0cyBmb3IgZWFjaCBuZXcgY29udGFjdCwgZXZlbiBpZiB0aGVyZSdzIG5vIGV2ZW50IGxpc3RlbmVyIGF0dGFjaGVkLgogICAgICAgICAgV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQuYm9keSA9IGJqOwogICAgICAgICAgV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQuY29udGFjdCA9IGM7CiAgICAgICAgICBiaS5kaXNwYXRjaEV2ZW50KFdvcmxkX3N0ZXBfY29sbGlkZUV2ZW50KTsKICAgICAgICAgIFdvcmxkX3N0ZXBfY29sbGlkZUV2ZW50LmJvZHkgPSBiaTsKICAgICAgICAgIGJqLmRpc3BhdGNoRXZlbnQoV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5ib2R5T3ZlcmxhcEtlZXBlci5zZXQoYmkuaWQsIGJqLmlkKTsKICAgICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlci5zZXQoc2kuaWQsIHNqLmlkKTsKICAgICAgfQoKICAgICAgdGhpcy5lbWl0Q29udGFjdEV2ZW50cygpOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsZS5tYWtlQ29udGFjdENvbnN0cmFpbnRzID0gcGVyZm9ybWFuY2Uubm93KCkgLSBwcm9maWxpbmdTdGFydDsKICAgICAgICBwcm9maWxpbmdTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICB9IC8vIFdha2UgdXAgYm9kaWVzCgoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYmkgPSBib2RpZXNbaV07CgogICAgICAgIGlmIChiaS53YWtlVXBBZnRlck5hcnJvd3BoYXNlKSB7CiAgICAgICAgICBiaS53YWtlVXAoKTsKICAgICAgICAgIGJpLndha2VVcEFmdGVyTmFycm93cGhhc2UgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0gLy8gQWRkIHVzZXItYWRkZWQgY29uc3RyYWludHMKCgogICAgICBOY29uc3RyYWludHMgPSBjb25zdHJhaW50cy5sZW5ndGg7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOY29uc3RyYWludHM7IGkrKykgewogICAgICAgIGNvbnN0IGMgPSBjb25zdHJhaW50c1tpXTsKICAgICAgICBjLnVwZGF0ZSgpOwoKICAgICAgICBmb3IgKGxldCBqID0gMCwgTmVxID0gYy5lcXVhdGlvbnMubGVuZ3RoOyBqICE9PSBOZXE7IGorKykgewogICAgICAgICAgY29uc3QgZXEgPSBjLmVxdWF0aW9uc1tqXTsKICAgICAgICAgIHNvbHZlci5hZGRFcXVhdGlvbihlcSk7CiAgICAgICAgfQogICAgICB9IC8vIFNvbHZlIHRoZSBjb25zdHJhaW5lZCBzeXN0ZW0KCgogICAgICBzb2x2ZXIuc29sdmUoZHQsIHRoaXMpOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsZS5zb2x2ZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gcHJvZmlsaW5nU3RhcnQ7CiAgICAgIH0gLy8gUmVtb3ZlIGFsbCBjb250YWN0cyBmcm9tIHNvbHZlcgoKCiAgICAgIHNvbHZlci5yZW1vdmVBbGxFcXVhdGlvbnMoKTsgLy8gQXBwbHkgZGFtcGluZywgc2VlIGh0dHA6Ly9jb2RlLmdvb2dsZS5jb20vcC9idWxsZXQvaXNzdWVzL2RldGFpbD9pZD03NCBmb3IgZGV0YWlscwoKICAgICAgY29uc3QgcG93ID0gTWF0aC5wb3c7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKCiAgICAgICAgaWYgKGJpLnR5cGUgJiBEWU5BTUlDKSB7CiAgICAgICAgICAvLyBPbmx5IGZvciBkeW5hbWljIGJvZGllcwogICAgICAgICAgY29uc3QgbGQgPSBwb3coMS4wIC0gYmkubGluZWFyRGFtcGluZywgZHQpOwogICAgICAgICAgY29uc3QgdiA9IGJpLnZlbG9jaXR5OwogICAgICAgICAgdi5zY2FsZShsZCwgdik7CiAgICAgICAgICBjb25zdCBhdiA9IGJpLmFuZ3VsYXJWZWxvY2l0eTsKCiAgICAgICAgICBpZiAoYXYpIHsKICAgICAgICAgICAgY29uc3QgYWQgPSBwb3coMS4wIC0gYmkuYW5ndWxhckRhbXBpbmcsIGR0KTsKICAgICAgICAgICAgYXYuc2NhbGUoYWQsIGF2KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChXb3JsZF9zdGVwX3ByZVN0ZXBFdmVudCk7IC8vIExlYXAgZnJvZwogICAgICAvLyB2bmV3ID0gdiArIGgqZi9tCiAgICAgIC8vIHhuZXcgPSB4ICsgaCp2bmV3CgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxpbmdTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICB9CgogICAgICBjb25zdCBzdGVwbnVtYmVyID0gdGhpcy5zdGVwbnVtYmVyOwogICAgICBjb25zdCBxdWF0Tm9ybWFsaXplID0gc3RlcG51bWJlciAlICh0aGlzLnF1YXROb3JtYWxpemVTa2lwICsgMSkgPT09IDA7CiAgICAgIGNvbnN0IHF1YXROb3JtYWxpemVGYXN0ID0gdGhpcy5xdWF0Tm9ybWFsaXplRmFzdDsKCiAgICAgIGZvciAoaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGJvZGllc1tpXS5pbnRlZ3JhdGUoZHQsIHF1YXROb3JtYWxpemUsIHF1YXROb3JtYWxpemVGYXN0KTsKICAgICAgfQoKICAgICAgdGhpcy5jbGVhckZvcmNlcygpOwogICAgICB0aGlzLmJyb2FkcGhhc2UuZGlydHkgPSB0cnVlOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsZS5pbnRlZ3JhdGUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHByb2ZpbGluZ1N0YXJ0OwogICAgICB9IC8vIFVwZGF0ZSBzdGVwIG51bWJlcgoKCiAgICAgIHRoaXMuc3RlcG51bWJlciArPSAxOwogICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoV29ybGRfc3RlcF9wb3N0U3RlcEV2ZW50KTsgLy8gU2xlZXBpbmcgdXBkYXRlCgogICAgICBsZXQgaGFzQWN0aXZlQm9kaWVzID0gdHJ1ZTsKCiAgICAgIGlmICh0aGlzLmFsbG93U2xlZXApIHsKICAgICAgICBoYXNBY3RpdmVCb2RpZXMgPSBmYWxzZTsKCiAgICAgICAgZm9yIChpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKICAgICAgICAgIGJpLnNsZWVwVGljayh0aGlzLnRpbWUpOwoKICAgICAgICAgIGlmIChiaS5zbGVlcFN0YXRlICE9PSBCb2R5LlNMRUVQSU5HKSB7CiAgICAgICAgICAgIGhhc0FjdGl2ZUJvZGllcyA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmhhc0FjdGl2ZUJvZGllcyA9IGhhc0FjdGl2ZUJvZGllczsKICAgIH0KCiAgICBlbWl0Q29udGFjdEV2ZW50cygpIHsKICAgICAgY29uc3QgaGFzQmVnaW5Db250YWN0ID0gdGhpcy5oYXNBbnlFdmVudExpc3RlbmVyKCdiZWdpbkNvbnRhY3QnKTsKICAgICAgY29uc3QgaGFzRW5kQ29udGFjdCA9IHRoaXMuaGFzQW55RXZlbnRMaXN0ZW5lcignZW5kQ29udGFjdCcpOwoKICAgICAgaWYgKGhhc0JlZ2luQ29udGFjdCB8fCBoYXNFbmRDb250YWN0KSB7CiAgICAgICAgdGhpcy5ib2R5T3ZlcmxhcEtlZXBlci5nZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpOwogICAgICB9CgogICAgICBpZiAoaGFzQmVnaW5Db250YWN0KSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBhZGRpdGlvbnMubGVuZ3RoOyBpIDwgbDsgaSArPSAyKSB7CiAgICAgICAgICBiZWdpbkNvbnRhY3RFdmVudC5ib2R5QSA9IHRoaXMuZ2V0Qm9keUJ5SWQoYWRkaXRpb25zW2ldKTsKICAgICAgICAgIGJlZ2luQ29udGFjdEV2ZW50LmJvZHlCID0gdGhpcy5nZXRCb2R5QnlJZChhZGRpdGlvbnNbaSArIDFdKTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChiZWdpbkNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBiZWdpbkNvbnRhY3RFdmVudC5ib2R5QSA9IGJlZ2luQ29udGFjdEV2ZW50LmJvZHlCID0gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKGhhc0VuZENvbnRhY3QpIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHJlbW92YWxzLmxlbmd0aDsgaSA8IGw7IGkgKz0gMikgewogICAgICAgICAgZW5kQ29udGFjdEV2ZW50LmJvZHlBID0gdGhpcy5nZXRCb2R5QnlJZChyZW1vdmFsc1tpXSk7CiAgICAgICAgICBlbmRDb250YWN0RXZlbnQuYm9keUIgPSB0aGlzLmdldEJvZHlCeUlkKHJlbW92YWxzW2kgKyAxXSk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZW5kQ29udGFjdEV2ZW50KTsKICAgICAgICB9CgogICAgICAgIGVuZENvbnRhY3RFdmVudC5ib2R5QSA9IGVuZENvbnRhY3RFdmVudC5ib2R5QiA9IG51bGw7CiAgICAgIH0KCiAgICAgIGFkZGl0aW9ucy5sZW5ndGggPSByZW1vdmFscy5sZW5ndGggPSAwOwogICAgICBjb25zdCBoYXNCZWdpblNoYXBlQ29udGFjdCA9IHRoaXMuaGFzQW55RXZlbnRMaXN0ZW5lcignYmVnaW5TaGFwZUNvbnRhY3QnKTsKICAgICAgY29uc3QgaGFzRW5kU2hhcGVDb250YWN0ID0gdGhpcy5oYXNBbnlFdmVudExpc3RlbmVyKCdlbmRTaGFwZUNvbnRhY3QnKTsKCiAgICAgIGlmIChoYXNCZWdpblNoYXBlQ29udGFjdCB8fCBoYXNFbmRTaGFwZUNvbnRhY3QpIHsKICAgICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlci5nZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpOwogICAgICB9CgogICAgICBpZiAoaGFzQmVnaW5TaGFwZUNvbnRhY3QpIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGFkZGl0aW9ucy5sZW5ndGg7IGkgPCBsOyBpICs9IDIpIHsKICAgICAgICAgIGNvbnN0IHNoYXBlQSA9IHRoaXMuZ2V0U2hhcGVCeUlkKGFkZGl0aW9uc1tpXSk7CiAgICAgICAgICBjb25zdCBzaGFwZUIgPSB0aGlzLmdldFNoYXBlQnlJZChhZGRpdGlvbnNbaSArIDFdKTsKICAgICAgICAgIGJlZ2luU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gc2hhcGVBOwogICAgICAgICAgYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBzaGFwZUI7CiAgICAgICAgICBpZiAoc2hhcGVBKSBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlBID0gc2hhcGVBLmJvZHk7CiAgICAgICAgICBpZiAoc2hhcGVCKSBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlCID0gc2hhcGVCLmJvZHk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoYmVnaW5TaGFwZUNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlBID0gYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5ib2R5QiA9IGJlZ2luU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBudWxsOwogICAgICB9CgogICAgICBpZiAoaGFzRW5kU2hhcGVDb250YWN0KSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSByZW1vdmFscy5sZW5ndGg7IGkgPCBsOyBpICs9IDIpIHsKICAgICAgICAgIGNvbnN0IHNoYXBlQSA9IHRoaXMuZ2V0U2hhcGVCeUlkKHJlbW92YWxzW2ldKTsKICAgICAgICAgIGNvbnN0IHNoYXBlQiA9IHRoaXMuZ2V0U2hhcGVCeUlkKHJlbW92YWxzW2kgKyAxXSk7CiAgICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5zaGFwZUEgPSBzaGFwZUE7CiAgICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBzaGFwZUI7CiAgICAgICAgICBpZiAoc2hhcGVBKSBlbmRTaGFwZUNvbnRhY3RFdmVudC5ib2R5QSA9IHNoYXBlQS5ib2R5OwogICAgICAgICAgaWYgKHNoYXBlQikgZW5kU2hhcGVDb250YWN0RXZlbnQuYm9keUIgPSBzaGFwZUIuYm9keTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChlbmRTaGFwZUNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5ib2R5QSA9IGVuZFNoYXBlQ29udGFjdEV2ZW50LmJvZHlCID0gZW5kU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gZW5kU2hhcGVDb250YWN0RXZlbnQuc2hhcGVCID0gbnVsbDsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIGFsbCBib2R5IGZvcmNlcyBpbiB0aGUgd29ybGQgdG8gemVyby4KICAgICAqLwoKCiAgICBjbGVhckZvcmNlcygpIHsKICAgICAgY29uc3QgYm9kaWVzID0gdGhpcy5ib2RpZXM7CiAgICAgIGNvbnN0IE4gPSBib2RpZXMubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IGIgPSBib2RpZXNbaV07CiAgICAgICAgYi5mb3JjZTsKICAgICAgICBiLnRvcnF1ZTsKICAgICAgICBiLmZvcmNlLnNldCgwLCAwLCAwKTsKICAgICAgICBiLnRvcnF1ZS5zZXQoMCwgMCwgMCk7CiAgICAgIH0KICAgIH0KCiAgfSAvLyBUZW1wIHN0dWZmCgogIG5ldyBBQUJCKCk7CiAgY29uc3QgdG1wUmF5ID0gbmV3IFJheSgpOyAvLyBwZXJmb3JtYW5jZS5ub3coKSBmYWxsYmFjayBvbiBEYXRlLm5vdygpCgogIGNvbnN0IHBlcmZvcm1hbmNlID0gZ2xvYmFsVGhpcy5wZXJmb3JtYW5jZSB8fCB7fTsKCiAgaWYgKCFwZXJmb3JtYW5jZS5ub3cpIHsKICAgIGxldCBub3dPZmZzZXQgPSBEYXRlLm5vdygpOwoKICAgIGlmIChwZXJmb3JtYW5jZS50aW1pbmcgJiYgcGVyZm9ybWFuY2UudGltaW5nLm5hdmlnYXRpb25TdGFydCkgewogICAgICBub3dPZmZzZXQgPSBwZXJmb3JtYW5jZS50aW1pbmcubmF2aWdhdGlvblN0YXJ0OwogICAgfQoKICAgIHBlcmZvcm1hbmNlLm5vdyA9ICgpID0+IERhdGUubm93KCkgLSBub3dPZmZzZXQ7CiAgfQoKICBuZXcgVmVjMygpOyAvLyBEaXNwYXRjaGVkIGFmdGVyIHRoZSB3b3JsZCBoYXMgc3RlcHBlZCBmb3J3YXJkIGluIHRpbWUuCiAgLy8gUmV1c2FibGUgZXZlbnQgb2JqZWN0cyB0byBzYXZlIG1lbW9yeS4KCiAgY29uc3QgV29ybGRfc3RlcF9wb3N0U3RlcEV2ZW50ID0gewogICAgdHlwZTogJ3Bvc3RTdGVwJwogIH07IC8vIERpc3BhdGNoZWQgYmVmb3JlIHRoZSB3b3JsZCBzdGVwcyBmb3J3YXJkIGluIHRpbWUuCgogIGNvbnN0IFdvcmxkX3N0ZXBfcHJlU3RlcEV2ZW50ID0gewogICAgdHlwZTogJ3ByZVN0ZXAnCiAgfTsKICBjb25zdCBXb3JsZF9zdGVwX2NvbGxpZGVFdmVudCA9IHsKICAgIHR5cGU6IEJvZHkuQ09MTElERV9FVkVOVF9OQU1FLAogICAgYm9keTogbnVsbCwKICAgIGNvbnRhY3Q6IG51bGwKICB9OyAvLyBQb29scyBmb3IgdW51c2VkIG9iamVjdHMKCiAgY29uc3QgV29ybGRfc3RlcF9vbGRDb250YWN0cyA9IFtdOwogIGNvbnN0IFdvcmxkX3N0ZXBfZnJpY3Rpb25FcXVhdGlvblBvb2wgPSBbXTsgLy8gUmV1c2FibGUgYXJyYXlzIGZvciBjb2xsaXNpb24gcGFpcnMKCiAgY29uc3QgV29ybGRfc3RlcF9wMSA9IFtdOwogIGNvbnN0IFdvcmxkX3N0ZXBfcDIgPSBbXTsgLy8gU3R1ZmYgZm9yIGVtaXRDb250YWN0RXZlbnRzCgogIGNvbnN0IGFkZGl0aW9ucyA9IFtdOwogIGNvbnN0IHJlbW92YWxzID0gW107CiAgY29uc3QgYmVnaW5Db250YWN0RXZlbnQgPSB7CiAgICB0eXBlOiAnYmVnaW5Db250YWN0JywKICAgIGJvZHlBOiBudWxsLAogICAgYm9keUI6IG51bGwKICB9OwogIGNvbnN0IGVuZENvbnRhY3RFdmVudCA9IHsKICAgIHR5cGU6ICdlbmRDb250YWN0JywKICAgIGJvZHlBOiBudWxsLAogICAgYm9keUI6IG51bGwKICB9OwogIGNvbnN0IGJlZ2luU2hhcGVDb250YWN0RXZlbnQgPSB7CiAgICB0eXBlOiAnYmVnaW5TaGFwZUNvbnRhY3QnLAogICAgYm9keUE6IG51bGwsCiAgICBib2R5QjogbnVsbCwKICAgIHNoYXBlQTogbnVsbCwKICAgIHNoYXBlQjogbnVsbAogIH07CiAgY29uc3QgZW5kU2hhcGVDb250YWN0RXZlbnQgPSB7CiAgICB0eXBlOiAnZW5kU2hhcGVDb250YWN0JywKICAgIGJvZHlBOiBudWxsLAogICAgYm9keUI6IG51bGwsCiAgICBzaGFwZUE6IG51bGwsCiAgICBzaGFwZUI6IG51bGwKICB9OwoKICBjb25zdCBhZGRDb250YWN0TWF0ZXJpYWwgPSAod29ybGQsIGNyZWF0ZU1hdGVyaWFsLCBfcmVmLCB1dWlkKSA9PiB7CiAgICBsZXQgW21hdGVyaWFsQSwgbWF0ZXJpYWxCLCBvcHRpb25zXSA9IF9yZWY7CiAgICBjb25zdCBtYXRBID0gY3JlYXRlTWF0ZXJpYWwobWF0ZXJpYWxBKTsKICAgIGNvbnN0IG1hdEIgPSBjcmVhdGVNYXRlcmlhbChtYXRlcmlhbEIpOwogICAgY29uc3QgY29udGFjdE1hdGVyaWFsID0gbmV3IENvbnRhY3RNYXRlcmlhbChtYXRBLCBtYXRCLCBvcHRpb25zKTsKICAgIGNvbnRhY3RNYXRlcmlhbC51dWlkID0gdXVpZDsKICAgIHdvcmxkLmFkZENvbnRhY3RNYXRlcmlhbChjb250YWN0TWF0ZXJpYWwpOwogIH07CiAgY29uc3QgcmVtb3ZlQ29udGFjdE1hdGVyaWFsID0gKHdvcmxkLCBjbVVVSUQpID0+IHsKICAgIGNvbnN0IGluZGV4ID0gd29ybGQuY29udGFjdG1hdGVyaWFscy5maW5kSW5kZXgoX3JlZjIgPT4gewogICAgICBsZXQgewogICAgICAgIHV1aWQKICAgICAgfSA9IF9yZWYyOwogICAgICByZXR1cm4gdXVpZCA9PT0gY21VVUlEOwogICAgfSk7CiAgICBjb25zdCBbewogICAgICBpZDogaQogICAgfSwgewogICAgICBpZDogagogICAgfV0gPSB3b3JsZC5jb250YWN0bWF0ZXJpYWxzW2luZGV4XS5tYXRlcmlhbHM7CiAgICB3b3JsZC5jb250YWN0bWF0ZXJpYWxzLnNwbGljZShpbmRleCwgMSk7CiAgICBkZWxldGUgd29ybGQuY29udGFjdE1hdGVyaWFsVGFibGUuZGF0YVtpIDwgaiA/IGAke2l9LSR7an1gIDogYCR7an0tJHtpfWBdOwogIH07CgogIGxldCBtYXRlcmlhbElkID0gMDsKICBjb25zdCBjcmVhdGVNYXRlcmlhbEZhY3RvcnkgPSBtYXRlcmlhbHMgPT4gZnVuY3Rpb24gKG5hbWVPck9wdGlvbnMpIHsKICAgIGlmIChuYW1lT3JPcHRpb25zID09PSB2b2lkIDApIHsKICAgICAgbmFtZU9yT3B0aW9ucyA9IHt9OwogICAgfQogICAgY29uc3QgbWF0ZXJpYWxPcHRpb25zID0gdHlwZW9mIG5hbWVPck9wdGlvbnMgPT09ICdzdHJpbmcnID8gewogICAgICBuYW1lOiBuYW1lT3JPcHRpb25zCiAgICB9IDogewogICAgICBuYW1lOiBTeW1ib2wuZm9yKGBNYXRlcmlhbCR7bWF0ZXJpYWxJZCsrfWApLAogICAgICAuLi5uYW1lT3JPcHRpb25zCiAgICB9OwogICAgY29uc3QgewogICAgICBuYW1lCiAgICB9ID0gbWF0ZXJpYWxPcHRpb25zOwogICAgbWF0ZXJpYWxzW25hbWVdID0gbWF0ZXJpYWxzW25hbWVdIHx8IG5ldyBNYXRlcmlhbChtYXRlcmlhbE9wdGlvbnMpOwogICAgcmV0dXJuIG1hdGVyaWFsc1tuYW1lXTsKICB9OwoKICAvKioKICAgKiBAdHlwZWRlZiB7IGltcG9ydCgnY2Fubm9uLWVzJykuTWF0ZXJpYWxPcHRpb25zIH0gTWF0ZXJpYWxPcHRpb25zCiAgICovCgogIGNvbnN0IG1ha2VWZWMzID0gX3JlZiA9PiB7CiAgICBsZXQgW3gsIHksIHpdID0gX3JlZjsKICAgIHJldHVybiBuZXcgVmVjMyh4LCB5LCB6KTsKICB9OwogIGNvbnN0IHByZXBhcmVTcGhlcmUgPSBhcmdzID0+IEFycmF5LmlzQXJyYXkoYXJncykgPyBhcmdzIDogW2FyZ3NdOwogIGNvbnN0IHByZXBhcmVDb252ZXhQb2x5aGVkcm9uID0gX3JlZjIgPT4gewogICAgbGV0IFt2LCBmYWNlcywgbiwgYSwgYm91bmRpbmdTcGhlcmVSYWRpdXNdID0gX3JlZjI7CiAgICByZXR1cm4gW3sKICAgICAgYXhlczogYSA/IGEubWFwKG1ha2VWZWMzKSA6IHVuZGVmaW5lZCwKICAgICAgYm91bmRpbmdTcGhlcmVSYWRpdXMsCiAgICAgIGZhY2VzLAogICAgICBub3JtYWxzOiBuID8gbi5tYXAobWFrZVZlYzMpIDogdW5kZWZpbmVkLAogICAgICB2ZXJ0aWNlczogdiA/IHYubWFwKG1ha2VWZWMzKSA6IHVuZGVmaW5lZAogICAgfV07CiAgfTsKICBmdW5jdGlvbiBjcmVhdGVTaGFwZSh0eXBlLCBhcmdzKSB7CiAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgY2FzZSAnQm94JzoKICAgICAgICByZXR1cm4gbmV3IEJveChuZXcgVmVjMyguLi5hcmdzLm1hcCh2ID0+IHYgLyAyKSkpOwogICAgICAvLyBleHRlbnRzID0+IGhhbGZFeHRlbnRzCiAgICAgIGNhc2UgJ0NvbnZleFBvbHloZWRyb24nOgogICAgICAgIHJldHVybiBuZXcgQ29udmV4UG9seWhlZHJvbiguLi5wcmVwYXJlQ29udmV4UG9seWhlZHJvbihhcmdzKSk7CiAgICAgIGNhc2UgJ0N5bGluZGVyJzoKICAgICAgICByZXR1cm4gbmV3IEN5bGluZGVyKC4uLmFyZ3MpOwogICAgICAvLyBbIHJhZGl1c1RvcCwgcmFkaXVzQm90dG9tLCBoZWlnaHQsIG51bVNlZ21lbnRzIF0gPSBhcmdzCiAgICAgIGNhc2UgJ0hlaWdodGZpZWxkJzoKICAgICAgICByZXR1cm4gbmV3IEhlaWdodGZpZWxkKC4uLmFyZ3MpOwogICAgICAvLyBbIEFycmF5IGRhdGEsIG9wdGlvbnM6IHttaW5WYWx1ZSwgbWF4VmFsdWUsIGVsZW1lbnRTaXplfSAgXSA9IGFyZ3MKICAgICAgY2FzZSAnUGFydGljbGUnOgogICAgICAgIHJldHVybiBuZXcgUGFydGljbGUoKTsKICAgICAgLy8gbm8gYXJncwogICAgICBjYXNlICdQbGFuZSc6CiAgICAgICAgcmV0dXJuIG5ldyBQbGFuZSgpOwogICAgICAvLyBubyBhcmdzLCBpbmZpbml0ZSB4IGFuZCB5CiAgICAgIGNhc2UgJ1NwaGVyZSc6CiAgICAgICAgcmV0dXJuIG5ldyBTcGhlcmUoLi4ucHJlcGFyZVNwaGVyZShhcmdzKSk7CiAgICAgIC8vIHJhZGl1cyA9IGFyZ3MKICAgICAgY2FzZSAnVHJpbWVzaCc6CiAgICAgICAgcmV0dXJuIG5ldyBUcmltZXNoKC4uLmFyZ3MpOwogICAgICAvLyBbdmVydGljZXMsIGluZGljZXNdID0gYXJncwogICAgfQogIH0KCiAgLyoqCiAgICogQHBhcmFtIHtUSFJFRS5RdWF0ZXJuaW9ufSB0YXJnZXQKICAgKiBAcGFyYW0ge3sgcm90YXRpb24/OiBUSFJFRS5WZWN0b3IzVHVwbGUgcXVhdGVybmlvbj86IFRIUkVFLlZlY3RvcjRUdXBsZSB9fSBwcm9wcwogICAqIEByZXR1cm5zIHtUSFJFRS5RdWF0ZXJuaW9ufQogICAqLwogIGNvbnN0IHNldFF1YXRlcm5pb24gPSAodGFyZ2V0LCBfcmVmMykgPT4gewogICAgbGV0IHsKICAgICAgcXVhdGVybmlvbiwKICAgICAgcm90YXRpb24KICAgIH0gPSBfcmVmMzsKICAgIGlmIChxdWF0ZXJuaW9uKSB7CiAgICAgIHRhcmdldC5zZXQoLi4ucXVhdGVybmlvbik7CiAgICB9IGVsc2UgaWYgKHJvdGF0aW9uKSB7CiAgICAgIHRhcmdldC5zZXRGcm9tRXVsZXIoLi4ucm90YXRpb24pOwogICAgfQogICAgcmV0dXJuIHRhcmdldDsKICB9OwoKICAvKioKICAgKiBAZnVuY3Rpb24KICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucwogICAqIEBwYXJhbSB7c3RyaW5nfSBvcHRpb25zLnV1aWQKICAgKiBAcGFyYW0ge0JvZHlQcm9wc30gb3B0aW9ucy5wcm9wcwogICAqIEBwYXJhbSB7Qm9keVNoYXBlVHlwZX0gb3B0aW9ucy50eXBlCiAgICogQHBhcmFtIHsobWF0ZXJpYWxPcHRpb25zOiBNYXRlcmlhbE9wdGlvbnMpID0+IE1hdGVyaWFsID19IG9wdGlvbnMuY3JlYXRlTWF0ZXJpYWwKICAgKiBAcmV0dXJucyB7Qm9keX0KICAgKi8KICBjb25zdCBwcm9wc1RvQm9keSA9IG9wdGlvbnMgPT4gewogICAgY29uc3QgewogICAgICB1dWlkLAogICAgICBwcm9wcywKICAgICAgdHlwZSwKICAgICAgY3JlYXRlTWF0ZXJpYWwgPSBtYXRlcmlhbE9wdGlvbnMgPT4gbmV3IE1hdGVyaWFsKG1hdGVyaWFsT3B0aW9ucykKICAgIH0gPSBvcHRpb25zOwogICAgY29uc3QgewogICAgICBhbmd1bGFyRmFjdG9yID0gWzEsIDEsIDFdLAogICAgICBhbmd1bGFyVmVsb2NpdHkgPSBbMCwgMCwgMF0sCiAgICAgIGFyZ3MgPSBbXSwKICAgICAgY29sbGlzaW9uUmVzcG9uc2UsCiAgICAgIGxpbmVhckZhY3RvciA9IFsxLCAxLCAxXSwKICAgICAgbWFzcywKICAgICAgbWF0ZXJpYWwsCiAgICAgIG9uQ29sbGlkZSwKICAgICAgcG9zaXRpb24gPSBbMCwgMCwgMF0sCiAgICAgIHJvdGF0aW9uLAogICAgICBxdWF0ZXJuaW9uLAogICAgICBzaGFwZXMsCiAgICAgIHR5cGU6IGJvZHlUeXBlLAogICAgICB2ZWxvY2l0eSA9IFswLCAwLCAwXSwKICAgICAgLi4uZXh0cmEKICAgIH0gPSBwcm9wczsKICAgIGNvbnN0IGJvZHkgPSBuZXcgQm9keSh7CiAgICAgIC4uLmV4dHJhLAogICAgICBtYXNzOiBib2R5VHlwZSA9PT0gJ1N0YXRpYycgPyAwIDogbWFzcywKICAgICAgbWF0ZXJpYWw6IG1hdGVyaWFsID8gY3JlYXRlTWF0ZXJpYWwobWF0ZXJpYWwpIDogdW5kZWZpbmVkLAogICAgICB0eXBlOiBib2R5VHlwZSA/IEJvZHlbYm9keVR5cGUudG9VcHBlckNhc2UoKV0gOiB1bmRlZmluZWQKICAgIH0pOwogICAgYm9keS51dWlkID0gdXVpZDsKICAgIGlmIChjb2xsaXNpb25SZXNwb25zZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGJvZHkuY29sbGlzaW9uUmVzcG9uc2UgPSBjb2xsaXNpb25SZXNwb25zZTsKICAgIH0KICAgIGlmICh0eXBlID09PSAnQ29tcG91bmQnKSB7CiAgICAgIHNoYXBlcy5mb3JFYWNoKF9yZWY0ID0+IHsKICAgICAgICBsZXQgewogICAgICAgICAgdHlwZSwKICAgICAgICAgIGFyZ3MsCiAgICAgICAgICBwb3NpdGlvbiwKICAgICAgICAgIHJvdGF0aW9uLAogICAgICAgICAgcXVhdGVybmlvbiwKICAgICAgICAgIG1hdGVyaWFsLAogICAgICAgICAgLi4uZXh0cmEKICAgICAgICB9ID0gX3JlZjQ7CiAgICAgICAgY29uc3Qgc2hhcGVCb2R5ID0gYm9keS5hZGRTaGFwZShjcmVhdGVTaGFwZSh0eXBlLCBhcmdzKSwgcG9zaXRpb24gPyBuZXcgVmVjMyguLi5wb3NpdGlvbikgOiB1bmRlZmluZWQsIHNldFF1YXRlcm5pb24obmV3IFF1YXRlcm5pb24oMCwgMCwgMCwgMSksIHsKICAgICAgICAgIHF1YXRlcm5pb24sCiAgICAgICAgICByb3RhdGlvbgogICAgICAgIH0pKTsKICAgICAgICBpZiAobWF0ZXJpYWwpIHNoYXBlQm9keS5tYXRlcmlhbCA9IGNyZWF0ZU1hdGVyaWFsKG1hdGVyaWFsKTsKICAgICAgICBPYmplY3QuYXNzaWduKHNoYXBlQm9keSwgZXh0cmEpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGJvZHkuYWRkU2hhcGUoY3JlYXRlU2hhcGUodHlwZSwgYXJncykpOwogICAgfQogICAgYm9keS5wb3NpdGlvbi5zZXQocG9zaXRpb25bMF0sIHBvc2l0aW9uWzFdLCBwb3NpdGlvblsyXSk7CiAgICBib2R5LnZlbG9jaXR5LnNldCh2ZWxvY2l0eVswXSwgdmVsb2NpdHlbMV0sIHZlbG9jaXR5WzJdKTsKICAgIGJvZHkuYW5ndWxhclZlbG9jaXR5LnNldChhbmd1bGFyVmVsb2NpdHlbMF0sIGFuZ3VsYXJWZWxvY2l0eVsxXSwgYW5ndWxhclZlbG9jaXR5WzJdKTsKICAgIGJvZHkubGluZWFyRmFjdG9yLnNldChsaW5lYXJGYWN0b3JbMF0sIGxpbmVhckZhY3RvclsxXSwgbGluZWFyRmFjdG9yWzJdKTsKICAgIGJvZHkuYW5ndWxhckZhY3Rvci5zZXQoYW5ndWxhckZhY3RvclswXSwgYW5ndWxhckZhY3RvclsxXSwgYW5ndWxhckZhY3RvclsyXSk7CiAgICBzZXRRdWF0ZXJuaW9uKGJvZHkucXVhdGVybmlvbiwgewogICAgICBxdWF0ZXJuaW9uLAogICAgICByb3RhdGlvbgogICAgfSk7CiAgICByZXR1cm4gYm9keTsKICB9OwoKICBjb25zdCBhZGRCb2RpZXMgPSAoc3RhdGUsIGNyZWF0ZU1hdGVyaWFsLCBfcmVmKSA9PiB7CiAgICBsZXQgewogICAgICBwcm9wcywKICAgICAgdHlwZSwKICAgICAgdXVpZAogICAgfSA9IF9yZWY7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHV1aWQubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgYm9keSA9IHByb3BzVG9Cb2R5KHsKICAgICAgICBjcmVhdGVNYXRlcmlhbCwKICAgICAgICBwcm9wczogcHJvcHNbaV0sCiAgICAgICAgdHlwZSwKICAgICAgICB1dWlkOiB1dWlkW2ldCiAgICAgIH0pOwogICAgICBzdGF0ZS53b3JsZC5hZGRCb2R5KGJvZHkpOwogICAgICBpZiAocHJvcHNbaV0ub25Db2xsaWRlKSBib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2NvbGxpZGUnLCBfcmVmMiA9PiB7CiAgICAgICAgbGV0IHsKICAgICAgICAgIHR5cGUsCiAgICAgICAgICBib2R5LAogICAgICAgICAgdGFyZ2V0LAogICAgICAgICAgY29udGFjdAogICAgICAgIH0gPSBfcmVmMjsKICAgICAgICBpZiAoIWJvZHkudXVpZCB8fCAhdGFyZ2V0LnV1aWQpIHJldHVybjsKICAgICAgICBjb25zdCB7CiAgICAgICAgICBuaSwKICAgICAgICAgIHJpLAogICAgICAgICAgcmosCiAgICAgICAgICBiaSwKICAgICAgICAgIGJqLAogICAgICAgICAgaWQKICAgICAgICB9ID0gY29udGFjdDsKICAgICAgICBjb25zdCBjb250YWN0UG9pbnQgPSBiaS5wb3NpdGlvbi52YWRkKHJpKTsKICAgICAgICBjb25zdCBjb250YWN0Tm9ybWFsID0gYmkgPT09IGJvZHkgPyBuaSA6IG5pLnNjYWxlKC0xKTsKICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIGJvZHk6IGJvZHkudXVpZCwKICAgICAgICAgIGNvbGxpc2lvbkZpbHRlcnM6IHsKICAgICAgICAgICAgYm9keUZpbHRlckdyb3VwOiBib2R5LmNvbGxpc2lvbkZpbHRlckdyb3VwLAogICAgICAgICAgICBib2R5RmlsdGVyTWFzazogYm9keS5jb2xsaXNpb25GaWx0ZXJNYXNrLAogICAgICAgICAgICB0YXJnZXRGaWx0ZXJHcm91cDogdGFyZ2V0LmNvbGxpc2lvbkZpbHRlckdyb3VwLAogICAgICAgICAgICB0YXJnZXRGaWx0ZXJNYXNrOiB0YXJnZXQuY29sbGlzaW9uRmlsdGVyTWFzawogICAgICAgICAgfSwKICAgICAgICAgIGNvbnRhY3Q6IHsKICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiB1c2UgaWQgaW5zdGVhZCBvZiB1dWlkCiAgICAgICAgICAgIGJpOiBiaS51dWlkLAogICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIFRPRE86IHVzZSBpZCBpbnN0ZWFkIG9mIHV1aWQKICAgICAgICAgICAgYmo6IGJqLnV1aWQsCiAgICAgICAgICAgIC8vIE5vcm1hbCBvZiB0aGUgY29udGFjdCwgcmVsYXRpdmUgdG8gdGhlIGNvbGxpZGluZyBib2R5CiAgICAgICAgICAgIGNvbnRhY3ROb3JtYWw6IGNvbnRhY3ROb3JtYWwudG9BcnJheSgpLAogICAgICAgICAgICAvLyBXb3JsZCBwb3NpdGlvbiBvZiB0aGUgY29udGFjdAogICAgICAgICAgICBjb250YWN0UG9pbnQ6IGNvbnRhY3RQb2ludC50b0FycmF5KCksCiAgICAgICAgICAgIGlkLAogICAgICAgICAgICBpbXBhY3RWZWxvY2l0eTogY29udGFjdC5nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsKCksCiAgICAgICAgICAgIG5pOiBuaS50b0FycmF5KCksCiAgICAgICAgICAgIHJpOiByaS50b0FycmF5KCksCiAgICAgICAgICAgIHJqOiByai50b0FycmF5KCkKICAgICAgICAgIH0sCiAgICAgICAgICBvcDogJ2V2ZW50JywKICAgICAgICAgIHRhcmdldDogdGFyZ2V0LnV1aWQsCiAgICAgICAgICB0eXBlCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH07CgogIGNvbnN0IHRyaXBsZXRUb1ZlYzMgPSB0ID0+IHQgPyBuZXcgVmVjMyguLi50KSA6IHVuZGVmaW5lZDsKCiAgY29uc3QgYWRkQ29uc3RyYWludCA9IChzdGF0ZSwgX3JlZikgPT4gewogICAgbGV0IHsKICAgICAgcHJvcHM6IFtib2R5QSwgYm9keUIsIHsKICAgICAgICBhbmdsZSwKICAgICAgICBheGlzQSwKICAgICAgICBheGlzQiwKICAgICAgICBjb2xsaWRlQ29ubmVjdGVkLAogICAgICAgIGRpc3RhbmNlLAogICAgICAgIG1heEZvcmNlLAogICAgICAgIG1heE11bHRpcGxpZXIsCiAgICAgICAgcGl2b3RBLAogICAgICAgIHBpdm90QiwKICAgICAgICB0d2lzdEFuZ2xlLAogICAgICAgIHdha2VVcEJvZGllcwogICAgICB9XSwKICAgICAgdHlwZSwKICAgICAgdXVpZAogICAgfSA9IF9yZWY7CiAgICBsZXQgY29uc3RyYWludDsKICAgIHN3aXRjaCAodHlwZSkgewogICAgICBjYXNlICdQb2ludFRvUG9pbnQnOgogICAgICAgIGNvbnN0cmFpbnQgPSBuZXcgUG9pbnRUb1BvaW50Q29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCB0cmlwbGV0VG9WZWMzKHBpdm90QSksIHN0YXRlLmJvZGllc1tib2R5Ql0sIHRyaXBsZXRUb1ZlYzMocGl2b3RCKSwgbWF4Rm9yY2UpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdDb25lVHdpc3QnOgogICAgICAgIGNvbnN0cmFpbnQgPSBuZXcgQ29uZVR3aXN0Q29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCB7CiAgICAgICAgICBhbmdsZSwKICAgICAgICAgIGF4aXNBOiB0cmlwbGV0VG9WZWMzKGF4aXNBKSwKICAgICAgICAgIGF4aXNCOiB0cmlwbGV0VG9WZWMzKGF4aXNCKSwKICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQsCiAgICAgICAgICBtYXhGb3JjZSwKICAgICAgICAgIHBpdm90QTogdHJpcGxldFRvVmVjMyhwaXZvdEEpLAogICAgICAgICAgcGl2b3RCOiB0cmlwbGV0VG9WZWMzKHBpdm90QiksCiAgICAgICAgICB0d2lzdEFuZ2xlCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0hpbmdlJzoKICAgICAgICBjb25zdHJhaW50ID0gbmV3IEhpbmdlQ29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCB7CiAgICAgICAgICBheGlzQTogdHJpcGxldFRvVmVjMyhheGlzQSksCiAgICAgICAgICBheGlzQjogdHJpcGxldFRvVmVjMyhheGlzQiksCiAgICAgICAgICBjb2xsaWRlQ29ubmVjdGVkLAogICAgICAgICAgbWF4Rm9yY2UsCiAgICAgICAgICBwaXZvdEE6IHRyaXBsZXRUb1ZlYzMocGl2b3RBKSwKICAgICAgICAgIHBpdm90QjogdHJpcGxldFRvVmVjMyhwaXZvdEIpCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0Rpc3RhbmNlJzoKICAgICAgICBjb25zdHJhaW50ID0gbmV3IERpc3RhbmNlQ29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCBkaXN0YW5jZSwgbWF4Rm9yY2UpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdMb2NrJzoKICAgICAgICBjb25zdHJhaW50ID0gbmV3IExvY2tDb25zdHJhaW50KHN0YXRlLmJvZGllc1tib2R5QV0sIHN0YXRlLmJvZGllc1tib2R5Ql0sIHsKICAgICAgICAgIG1heEZvcmNlCiAgICAgICAgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgY29uc3RyYWludCA9IG5ldyBDb25zdHJhaW50KHN0YXRlLmJvZGllc1tib2R5QV0sIHN0YXRlLmJvZGllc1tib2R5Ql0sIHsKICAgICAgICAgIGNvbGxpZGVDb25uZWN0ZWQsCiAgICAgICAgICB3YWtlVXBCb2RpZXMKICAgICAgICB9KTsKICAgICAgICBicmVhazsKICAgIH0KICAgIGNvbnN0cmFpbnQudXVpZCA9IHV1aWQ7CiAgICBzdGF0ZS53b3JsZC5hZGRDb25zdHJhaW50KGNvbnN0cmFpbnQpOwogICAgaWYgKG1heE11bHRpcGxpZXIgIT09IHVuZGVmaW5lZCkgewogICAgICBjb25zdCBwb3N0U3RlcENvbnN0cmFpbnQgPSAoKSA9PiB7CiAgICAgICAgLy8gVGhlIG11bHRpcGxpZXIgaXMgcHJvcG9ydGlvbmFsIHRvIGhvdyBtdWNoIGZvcmNlIGlzIGFkZGVkIHRvIHRoZSBib2RpZXMgYnkgdGhlIGNvbnN0cmFpbnQuCiAgICAgICAgLy8gSWYgdGhpcyBleGNlZWRzIGEgbGltaXQgdGhlIGNvbnN0cmFpbnQgaXMgZGlzYWJsZWQuCiAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IE1hdGguYWJzKGNvbnN0cmFpbnQuZXF1YXRpb25zWzBdLm11bHRpcGxpZXIpOwogICAgICAgIGlmIChtdWx0aXBsaWVyID4gbWF4TXVsdGlwbGllcikgewogICAgICAgICAgY29uc3RyYWludC5kaXNhYmxlKCk7CiAgICAgICAgfQogICAgICB9OwogICAgICBzdGF0ZS5jb25zdHJhaW50c1t1dWlkXSA9IHBvc3RTdGVwQ29uc3RyYWludDsKICAgICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS5jb25zdHJhaW50c1t1dWlkXSk7CiAgICB9CiAgfTsKCiAgZnVuY3Rpb24gdG9VcHBlcmNhc2Uoc3RyKSB7CiAgICByZXR1cm4gc3RyLnRvVXBwZXJDYXNlKCk7CiAgfQogIGNvbnN0IGFkZFJheSA9IChzdGF0ZSwgX3JlZikgPT4gewogICAgbGV0IHsKICAgICAgcHJvcHM6IHsKICAgICAgICBmcm9tLAogICAgICAgIG1vZGUsCiAgICAgICAgdG8sCiAgICAgICAgLi4ucmF5T3B0aW9ucwogICAgICB9LAogICAgICB1dWlkCiAgICB9ID0gX3JlZjsKICAgIGNvbnN0IHJheSA9IG5ldyBSYXkodHJpcGxldFRvVmVjMyhmcm9tKSwgdHJpcGxldFRvVmVjMyh0bykpOwogICAgY29uc3Qgb3B0aW9ucyA9IHsKICAgICAgbW9kZTogUkFZX01PREVTW3RvVXBwZXJjYXNlKG1vZGUpXSwKICAgICAgcmVzdWx0OiBuZXcgUmF5Y2FzdFJlc3VsdCgpLAogICAgICAuLi5yYXlPcHRpb25zCiAgICB9OwogICAgc3RhdGUucmF5c1t1dWlkXSA9ICgpID0+IHsKICAgICAgcmF5LmludGVyc2VjdFdvcmxkKHN0YXRlLndvcmxkLCBvcHRpb25zKTsKICAgICAgaWYgKCFvcHRpb25zLnJlc3VsdCB8fCAhb3B0aW9ucy5yZXN1bHQuYm9keSkgcmV0dXJuOwogICAgICBjb25zdCB7CiAgICAgICAgYm9keSwKICAgICAgICBzaGFwZSwKICAgICAgICByYXlGcm9tV29ybGQsCiAgICAgICAgcmF5VG9Xb3JsZCwKICAgICAgICBoaXROb3JtYWxXb3JsZCwKICAgICAgICBoaXRQb2ludFdvcmxkLAogICAgICAgIC4uLnJlc3QKICAgICAgfSA9IG9wdGlvbnMucmVzdWx0OwogICAgICBjb25zdCBib2R5VVVJRCA9IGJvZHkudXVpZDsKICAgICAgaWYgKCFib2R5VVVJRCkgcmV0dXJuOwogICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICBib2R5OiBib2R5VVVJRCwKICAgICAgICBoaXROb3JtYWxXb3JsZDogaGl0Tm9ybWFsV29ybGQudG9BcnJheSgpLAogICAgICAgIGhpdFBvaW50V29ybGQ6IGhpdFBvaW50V29ybGQudG9BcnJheSgpLAogICAgICAgIG9wOiAnZXZlbnQnLAogICAgICAgIHJheTogewogICAgICAgICAgY29sbGlzaW9uRmlsdGVyR3JvdXA6IHJheS5jb2xsaXNpb25GaWx0ZXJHcm91cCwKICAgICAgICAgIGNvbGxpc2lvbkZpbHRlck1hc2s6IHJheS5jb2xsaXNpb25GaWx0ZXJNYXNrLAogICAgICAgICAgZGlyZWN0aW9uOiByYXkuZGlyZWN0aW9uLnRvQXJyYXkoKSwKICAgICAgICAgIGZyb20sCiAgICAgICAgICB0bywKICAgICAgICAgIHV1aWQKICAgICAgICB9LAogICAgICAgIHJheUZyb21Xb3JsZDogcmF5RnJvbVdvcmxkLnRvQXJyYXkoKSwKICAgICAgICByYXlUb1dvcmxkOiByYXlUb1dvcmxkLnRvQXJyYXkoKSwKICAgICAgICBzaGFwZTogc2hhcGUgPyB7CiAgICAgICAgICAuLi5zaGFwZSwKICAgICAgICAgIGJvZHk6IGJvZHlVVUlECiAgICAgICAgfSA6IG51bGwsCiAgICAgICAgdHlwZTogJ3JheWhpdCcsCiAgICAgICAgLi4ucmVzdAogICAgICB9KTsKICAgIH07CiAgICBzdGF0ZS53b3JsZC5hZGRFdmVudExpc3RlbmVyKCdwcmVTdGVwJywgc3RhdGUucmF5c1t1dWlkXSk7CiAgfTsKCiAgY29uc3QgYWRkUmF5Y2FzdFZlaGljbGUgPSAoc3RhdGUsIGRhdGEpID0+IHsKICAgIGNvbnN0IFtjaGFzc2lzQm9keSwgd2hlZWxzLCB3aGVlbEluZm9zLCBpbmRleEZvcndhcmRBeGlzLCBpbmRleFJpZ2h0QXhpcywgaW5kZXhVcEF4aXNdID0gZGF0YS5wcm9wczsKICAgIGNvbnN0IHZlaGljbGUgPSBuZXcgUmF5Y2FzdFZlaGljbGUoewogICAgICBjaGFzc2lzQm9keTogc3RhdGUuYm9kaWVzW2NoYXNzaXNCb2R5XSwKICAgICAgaW5kZXhGb3J3YXJkQXhpcywKICAgICAgaW5kZXhSaWdodEF4aXMsCiAgICAgIGluZGV4VXBBeGlzCiAgICB9KTsKICAgIHZlaGljbGUud29ybGQgPSBzdGF0ZS53b3JsZDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd2hlZWxJbmZvcy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCB7CiAgICAgICAgYXhsZUxvY2FsLAogICAgICAgIGNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbCwKICAgICAgICBkaXJlY3Rpb25Mb2NhbCwKICAgICAgICAuLi5yZXN0CiAgICAgIH0gPSB3aGVlbEluZm9zW2ldOwogICAgICB2ZWhpY2xlLmFkZFdoZWVsKHsKICAgICAgICBheGxlTG9jYWw6IHRyaXBsZXRUb1ZlYzMoYXhsZUxvY2FsKSwKICAgICAgICBjaGFzc2lzQ29ubmVjdGlvblBvaW50TG9jYWw6IHRyaXBsZXRUb1ZlYzMoY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludExvY2FsKSwKICAgICAgICBkaXJlY3Rpb25Mb2NhbDogdHJpcGxldFRvVmVjMyhkaXJlY3Rpb25Mb2NhbCksCiAgICAgICAgLi4ucmVzdAogICAgICB9KTsKICAgIH0KICAgIGNvbnN0IHByZVN0ZXAgPSAoKSA9PiB7CiAgICAgIHZlaGljbGUudXBkYXRlVmVoaWNsZShzdGF0ZS53b3JsZC5kdCk7CiAgICB9OwogICAgY29uc3QgcG9zdFN0ZXAgPSAoKSA9PiB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVoaWNsZS53aGVlbEluZm9zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmVoaWNsZS51cGRhdGVXaGVlbFRyYW5zZm9ybShpKTsKICAgICAgICBjb25zdCB0ID0gdmVoaWNsZS53aGVlbEluZm9zW2ldLndvcmxkVHJhbnNmb3JtOwogICAgICAgIGNvbnN0IHdoZWVsQm9keSA9IHN0YXRlLmJvZGllc1t3aGVlbHNbaV1dOwogICAgICAgIHdoZWVsQm9keS5wb3NpdGlvbi5jb3B5KHQucG9zaXRpb24pOwogICAgICAgIHdoZWVsQm9keS5xdWF0ZXJuaW9uLmNvcHkodC5xdWF0ZXJuaW9uKTsKICAgICAgfQogICAgfTsKICAgIHN0YXRlLnZlaGljbGVzW2RhdGEudXVpZF0gPSB7CiAgICAgIHBvc3RTdGVwLAogICAgICBwcmVTdGVwLAogICAgICB2ZWhpY2xlCiAgICB9OwogICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHByZVN0ZXApOwogICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBwb3N0U3RlcCk7CiAgfTsKCiAgY29uc3QgYWRkU3ByaW5nID0gKHN0YXRlLCBfcmVmKSA9PiB7CiAgICBsZXQgewogICAgICBwcm9wczogW2JvZHlBLCBib2R5QiwgewogICAgICAgIGRhbXBpbmcsCiAgICAgICAgbG9jYWxBbmNob3JBLAogICAgICAgIGxvY2FsQW5jaG9yQiwKICAgICAgICByZXN0TGVuZ3RoLAogICAgICAgIHN0aWZmbmVzcywKICAgICAgICB3b3JsZEFuY2hvckEsCiAgICAgICAgd29ybGRBbmNob3JCCiAgICAgIH1dLAogICAgICB1dWlkCiAgICB9ID0gX3JlZjsKICAgIGNvbnN0IHNwcmluZyA9IG5ldyBTcHJpbmcoc3RhdGUuYm9kaWVzW2JvZHlBXSwgc3RhdGUuYm9kaWVzW2JvZHlCXSwgewogICAgICBkYW1waW5nLAogICAgICBsb2NhbEFuY2hvckE6IHRyaXBsZXRUb1ZlYzMobG9jYWxBbmNob3JBKSwKICAgICAgbG9jYWxBbmNob3JCOiB0cmlwbGV0VG9WZWMzKGxvY2FsQW5jaG9yQiksCiAgICAgIHJlc3RMZW5ndGgsCiAgICAgIHN0aWZmbmVzcywKICAgICAgd29ybGRBbmNob3JBOiB0cmlwbGV0VG9WZWMzKHdvcmxkQW5jaG9yQSksCiAgICAgIHdvcmxkQW5jaG9yQjogdHJpcGxldFRvVmVjMyh3b3JsZEFuY2hvckIpCiAgICB9KTsKICAgIHNwcmluZy51dWlkID0gdXVpZDsKICAgIGNvbnN0IHBvc3RTdGVwU3ByaW5nID0gKCkgPT4gc3ByaW5nLmFwcGx5Rm9yY2UoKTsKICAgIHN0YXRlLnNwcmluZ3NbdXVpZF0gPSBwb3N0U3RlcFNwcmluZzsKICAgIHN0YXRlLnNwcmluZ0luc3RhbmNlc1t1dWlkXSA9IHNwcmluZzsKCiAgICAvLyBDb21wdXRlIHRoZSBmb3JjZSBhZnRlciBlYWNoIHN0ZXAKICAgIHN0YXRlLndvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgc3RhdGUuc3ByaW5nc1t1dWlkXSk7CiAgfTsKCiAgZnVuY3Rpb24gZW1pdEJlZ2luQ29udGFjdChfcmVmKSB7CiAgICBsZXQgewogICAgICBib2R5QSwKICAgICAgYm9keUIKICAgIH0gPSBfcmVmOwogICAgaWYgKCEoYm9keUEgIT0gbnVsbCAmJiBib2R5QS51dWlkKSB8fCAhKGJvZHlCICE9IG51bGwgJiYgYm9keUIudXVpZCkpIHJldHVybjsKICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICBib2R5QTogYm9keUEudXVpZCwKICAgICAgYm9keUI6IGJvZHlCLnV1aWQsCiAgICAgIG9wOiAnZXZlbnQnLAogICAgICB0eXBlOiAnY29sbGlkZUJlZ2luJwogICAgfSk7CiAgfQogIGZ1bmN0aW9uIGVtaXRFbmRDb250YWN0KF9yZWYyKSB7CiAgICBsZXQgewogICAgICBib2R5QSwKICAgICAgYm9keUIKICAgIH0gPSBfcmVmMjsKICAgIGlmICghKGJvZHlBICE9IG51bGwgJiYgYm9keUEudXVpZCkgfHwgIShib2R5QiAhPSBudWxsICYmIGJvZHlCLnV1aWQpKSByZXR1cm47CiAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgYm9keUE6IGJvZHlBLnV1aWQsCiAgICAgIGJvZHlCOiBib2R5Qi51dWlkLAogICAgICBvcDogJ2V2ZW50JywKICAgICAgdHlwZTogJ2NvbGxpZGVFbmQnCiAgICB9KTsKICB9CiAgY29uc3QgaW5pdCA9ICh3b3JsZCwgX3JlZjMpID0+IHsKICAgIGxldCB7CiAgICAgIGFsbG93U2xlZXAsCiAgICAgIGF4aXNJbmRleCA9IDAsCiAgICAgIGJyb2FkcGhhc2UsCiAgICAgIGRlZmF1bHRDb250YWN0TWF0ZXJpYWwsCiAgICAgIGZyaWN0aW9uR3Jhdml0eSwKICAgICAgZ3Jhdml0eSwKICAgICAgaXRlcmF0aW9ucywKICAgICAgcXVhdE5vcm1hbGl6ZUZhc3QsCiAgICAgIHF1YXROb3JtYWxpemVTa2lwLAogICAgICBzb2x2ZXIsCiAgICAgIHRvbGVyYW5jZQogICAgfSA9IF9yZWYzOwogICAgd29ybGQuYWxsb3dTbGVlcCA9IGFsbG93U2xlZXA7CiAgICB3b3JsZC5ncmF2aXR5LnNldCguLi5ncmF2aXR5KTsKICAgIHdvcmxkLmZyaWN0aW9uR3Jhdml0eSA9IGZyaWN0aW9uR3Jhdml0eSA/IG5ldyBWZWMzKC4uLmZyaWN0aW9uR3Jhdml0eSkgOiB1bmRlZmluZWQ7CiAgICB3b3JsZC5xdWF0Tm9ybWFsaXplRmFzdCA9IHF1YXROb3JtYWxpemVGYXN0OwogICAgd29ybGQucXVhdE5vcm1hbGl6ZVNraXAgPSBxdWF0Tm9ybWFsaXplU2tpcDsKICAgIGlmIChzb2x2ZXIgPT09ICdTcGxpdCcpIHsKICAgICAgd29ybGQuc29sdmVyID0gbmV3IFNwbGl0U29sdmVyKG5ldyBHU1NvbHZlcigpKTsKICAgIH0KICAgIGlmICh3b3JsZC5zb2x2ZXIgaW5zdGFuY2VvZiBHU1NvbHZlcikgewogICAgICB3b3JsZC5zb2x2ZXIudG9sZXJhbmNlID0gdG9sZXJhbmNlOwogICAgICB3b3JsZC5zb2x2ZXIuaXRlcmF0aW9ucyA9IGl0ZXJhdGlvbnM7CiAgICB9CiAgICB3b3JsZC5icm9hZHBoYXNlID0gYnJvYWRwaGFzZSA9PT0gJ1NBUCcgPyBuZXcgU0FQQnJvYWRwaGFzZSh3b3JsZCkgOiBuZXcgTmFpdmVCcm9hZHBoYXNlKCk7CiAgICBpZiAod29ybGQuYnJvYWRwaGFzZSBpbnN0YW5jZW9mIFNBUEJyb2FkcGhhc2UpIHsKICAgICAgd29ybGQuYnJvYWRwaGFzZS5heGlzSW5kZXggPSBheGlzSW5kZXg7CiAgICB9CiAgICB3b3JsZC5hZGRFdmVudExpc3RlbmVyKCdiZWdpbkNvbnRhY3QnLCBlbWl0QmVnaW5Db250YWN0KTsKICAgIHdvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ2VuZENvbnRhY3QnLCBlbWl0RW5kQ29udGFjdCk7CiAgICBPYmplY3QuYXNzaWduKHdvcmxkLmRlZmF1bHRDb250YWN0TWF0ZXJpYWwsIGRlZmF1bHRDb250YWN0TWF0ZXJpYWwpOwogIH07CgogIGNvbnN0IGlzUW9yViA9IHYgPT4gdiBpbnN0YW5jZW9mIFF1YXRlcm5pb24gfHwgdiBpbnN0YW5jZW9mIFZlYzM7CiAgY29uc3Qgc3RlcCA9IChzdGF0ZSwgX3JlZikgPT4gewogICAgbGV0IHsKICAgICAgcG9zaXRpb25zLAogICAgICBwcm9wczogewogICAgICAgIG1heFN1YlN0ZXBzLAogICAgICAgIHN0ZXBTaXplLAogICAgICAgIHRpbWVTaW5jZUxhc3RDYWxsZWQKICAgICAgfSwKICAgICAgcXVhdGVybmlvbnMKICAgIH0gPSBfcmVmOwogICAgc3RhdGUud29ybGQuc3RlcChzdGVwU2l6ZSwgdGltZVNpbmNlTGFzdENhbGxlZCwgbWF4U3ViU3RlcHMpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdGF0ZS53b3JsZC5ib2RpZXMubGVuZ3RoOyBpICs9IDEpIHsKICAgICAgY29uc3QgcCA9IHN0YXRlLndvcmxkLmJvZGllc1tpXS5wb3NpdGlvbjsKICAgICAgY29uc3QgcSA9IHN0YXRlLndvcmxkLmJvZGllc1tpXS5xdWF0ZXJuaW9uOwogICAgICBwb3NpdGlvbnNbMyAqIGkgKyAwXSA9IHAueDsKICAgICAgcG9zaXRpb25zWzMgKiBpICsgMV0gPSBwLnk7CiAgICAgIHBvc2l0aW9uc1szICogaSArIDJdID0gcC56OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDBdID0gcS54OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDFdID0gcS55OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDJdID0gcS56OwogICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDNdID0gcS53OwogICAgfQogICAgY29uc3Qgb2JzZXJ2YXRpb25zID0gW107CiAgICBmb3IgKGNvbnN0IGlkIG9mIE9iamVjdC5rZXlzKHN0YXRlLnN1YnNjcmlwdGlvbnMpKSB7CiAgICAgIGNvbnN0IFt1dWlkLCB0eXBlLCB0YXJnZXQgPSAnYm9kaWVzJ10gPSBzdGF0ZS5zdWJzY3JpcHRpb25zW2lkXTsKICAgICAgY29uc3QgewogICAgICAgIGJvZGllcywKICAgICAgICB2ZWhpY2xlcwogICAgICB9ID0gc3RhdGU7CiAgICAgIGNvbnN0IHZhbHVlID0gdGFyZ2V0ID09PSAndmVoaWNsZXMnID8KICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiBEaWZmZXJlbnRpYXRlIHRoZXNlICJ0eXBlcyIKICAgICAgdmVoaWNsZXNbdXVpZF0udmVoaWNsZVt0eXBlXSA6CiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgVE9ETzogRGlmZmVyZW50aWF0ZSB0aGVzZSAidHlwZXMiCiAgICAgIGJvZGllc1t1dWlkXVt0eXBlXTsKICAgICAgY29uc3Qgc2VyaWFsaXphYmxlVmFsdWUgPSBpc1FvclYodmFsdWUpID8gdmFsdWUudG9BcnJheSgpIDogdmFsdWU7CiAgICAgIG9ic2VydmF0aW9ucy5wdXNoKFtOdW1iZXIoaWQpLCBzZXJpYWxpemFibGVWYWx1ZSwKICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiBEaWZmZXJlbnRpYXRlIHRoZXNlICJ0eXBlcyIKICAgICAgdHlwZV0pOwogICAgfQogICAgY29uc3QgbWVzc2FnZSA9IHsKICAgICAgYWN0aXZlOiBzdGF0ZS53b3JsZC5oYXNBY3RpdmVCb2RpZXMsCiAgICAgIG9ic2VydmF0aW9ucywKICAgICAgb3A6ICdmcmFtZScsCiAgICAgIHBvc2l0aW9ucywKICAgICAgcXVhdGVybmlvbnMKICAgIH07CiAgICBpZiAoc3RhdGUuYm9kaWVzTmVlZFN5bmNpbmcpIHsKICAgICAgbWVzc2FnZS5ib2RpZXMgPSBzdGF0ZS53b3JsZC5ib2RpZXMucmVkdWNlKChib2RpZXMsIGJvZHkpID0+IHsKICAgICAgICBpZiAoYm9keS51dWlkKSBib2RpZXMucHVzaChib2R5LnV1aWQpOwogICAgICAgIHJldHVybiBib2RpZXM7CiAgICAgIH0sIFtdKTsKICAgICAgc3RhdGUuYm9kaWVzTmVlZFN5bmNpbmcgPSBmYWxzZTsKICAgIH0KICAgIHNlbGYucG9zdE1lc3NhZ2UobWVzc2FnZSwgW3Bvc2l0aW9ucy5idWZmZXIsIHF1YXRlcm5pb25zLmJ1ZmZlcl0pOwogIH07CgogIGNvbnN0IHN0YXRlID0gewogICAgYm9kaWVzOiB7fSwKICAgIGJvZGllc05lZWRTeW5jaW5nOiBmYWxzZSwKICAgIGNvbnN0cmFpbnRzOiB7fSwKICAgIG1hdGVyaWFsczoge30sCiAgICByYXlzOiB7fSwKICAgIHNwcmluZ0luc3RhbmNlczoge30sCiAgICBzcHJpbmdzOiB7fSwKICAgIHN1YnNjcmlwdGlvbnM6IHt9LAogICAgdmVoaWNsZXM6IHt9LAogICAgd29ybGQ6IG5ldyBXb3JsZCgpCiAgfTsKCiAgLy8vIDxyZWZlcmVuY2Ugbm8tZGVmYXVsdC1saWI9InRydWUiLz4KICBjb25zdCBpc0hpbmdlQ29uc3RyYWludCA9IGMgPT4gYyBpbnN0YW5jZW9mIEhpbmdlQ29uc3RyYWludDsKICBmdW5jdGlvbiBzeW5jQm9kaWVzKCkgewogICAgc3RhdGUuYm9kaWVzTmVlZFN5bmNpbmcgPSB0cnVlOwogICAgc3RhdGUuYm9kaWVzID0gc3RhdGUud29ybGQuYm9kaWVzLnJlZHVjZSgoYm9kaWVzLCBib2R5KSA9PiBib2R5LnV1aWQgPyB7CiAgICAgIC4uLmJvZGllcywKICAgICAgW2JvZHkudXVpZF06IGJvZHkKICAgIH0gOiBib2RpZXMsIHt9KTsKICB9CiAgY29uc3QgYnJvYWRwaGFzZXMgPSB7CiAgICBOYWl2ZUJyb2FkcGhhc2UsCiAgICBTQVBCcm9hZHBoYXNlCiAgfTsKICBjb25zdCBjcmVhdGVNYXRlcmlhbCA9IGNyZWF0ZU1hdGVyaWFsRmFjdG9yeShzdGF0ZS5tYXRlcmlhbHMpOwogIHNlbGYub25tZXNzYWdlID0gX3JlZiA9PiB7CiAgICBsZXQgewogICAgICBkYXRhCiAgICB9ID0gX3JlZjsKICAgIHN3aXRjaCAoZGF0YS5vcCkgewogICAgICBjYXNlICdpbml0JzoKICAgICAgICB7CiAgICAgICAgICBpbml0KHN0YXRlLndvcmxkLCBkYXRhLnByb3BzKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnc3RlcCc6CiAgICAgICAgewogICAgICAgICAgc3RlcChzdGF0ZSwgZGF0YSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ2FkZEJvZGllcyc6CiAgICAgICAgewogICAgICAgICAgYWRkQm9kaWVzKHN0YXRlLCBjcmVhdGVNYXRlcmlhbCwgZGF0YSk7CiAgICAgICAgICBzeW5jQm9kaWVzKCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3JlbW92ZUJvZGllcyc6CiAgICAgICAgewogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLnV1aWQubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlQm9keShzdGF0ZS5ib2RpZXNbZGF0YS51dWlkW2ldXSk7CiAgICAgICAgICAgIGNvbnN0IGtleSA9IE9iamVjdC5rZXlzKHN0YXRlLnN1YnNjcmlwdGlvbnMpLmZpbmQoayA9PiBzdGF0ZS5zdWJzY3JpcHRpb25zW2tdWzBdID09PSBkYXRhLnV1aWRbaV0pOwogICAgICAgICAgICBpZiAoa2V5KSB7CiAgICAgICAgICAgICAgZGVsZXRlIHN0YXRlLnN1YnNjcmlwdGlvbnNba2V5XTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgc3luY0JvZGllcygpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdzdWJzY3JpYmUnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IHsKICAgICAgICAgICAgaWQsCiAgICAgICAgICAgIHRhcmdldCwKICAgICAgICAgICAgdHlwZQogICAgICAgICAgfSA9IGRhdGEucHJvcHM7CiAgICAgICAgICBzdGF0ZS5zdWJzY3JpcHRpb25zW2lkXSA9IFtkYXRhLnV1aWQsIHR5cGUsIHRhcmdldF07CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzoKICAgICAgICB7CiAgICAgICAgICBkZWxldGUgc3RhdGUuc3Vic2NyaXB0aW9uc1tkYXRhLnByb3BzXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnc2V0UG9zaXRpb24nOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLnBvc2l0aW9uLnNldChkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0UXVhdGVybmlvbic6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0ucXVhdGVybmlvbi5zZXQoZGF0YS5wcm9wc1swXSwgZGF0YS5wcm9wc1sxXSwgZGF0YS5wcm9wc1syXSwgZGF0YS5wcm9wc1szXSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldFJvdGF0aW9uJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5xdWF0ZXJuaW9uLnNldEZyb21FdWxlcihkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0VmVsb2NpdHknOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLnZlbG9jaXR5LnNldChkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QW5ndWxhclZlbG9jaXR5JzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hbmd1bGFyVmVsb2NpdHkuc2V0KGRhdGEucHJvcHNbMF0sIGRhdGEucHJvcHNbMV0sIGRhdGEucHJvcHNbMl0pOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRMaW5lYXJGYWN0b3InOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmxpbmVhckZhY3Rvci5zZXQoZGF0YS5wcm9wc1swXSwgZGF0YS5wcm9wc1sxXSwgZGF0YS5wcm9wc1syXSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldEFuZ3VsYXJGYWN0b3InOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFuZ3VsYXJGYWN0b3Iuc2V0KGRhdGEucHJvcHNbMF0sIGRhdGEucHJvcHNbMV0sIGRhdGEucHJvcHNbMl0pOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRNYXNzJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5tYXNzID0gZGF0YS5wcm9wczsKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS51cGRhdGVNYXNzUHJvcGVydGllcygpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRNYXRlcmlhbCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0ubWF0ZXJpYWwgPSBkYXRhLnByb3BzID8gY3JlYXRlTWF0ZXJpYWwoZGF0YS5wcm9wcykgOiBudWxsOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRMaW5lYXJEYW1waW5nJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5saW5lYXJEYW1waW5nID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QW5ndWxhckRhbXBpbmcnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFuZ3VsYXJEYW1waW5nID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QWxsb3dTbGVlcCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0uYWxsb3dTbGVlcCA9IGRhdGEucHJvcHM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldFNsZWVwU3BlZWRMaW1pdCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0uc2xlZXBTcGVlZExpbWl0ID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0U2xlZXBUaW1lTGltaXQnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLnNsZWVwVGltZUxpbWl0ID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0Q29sbGlzaW9uRmlsdGVyR3JvdXAnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmNvbGxpc2lvbkZpbHRlckdyb3VwID0gZGF0YS5wcm9wczsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0Q29sbGlzaW9uRmlsdGVyTWFzayc6CiAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0uY29sbGlzaW9uRmlsdGVyTWFzayA9IGRhdGEucHJvcHM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldENvbGxpc2lvblJlc3BvbnNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5jb2xsaXNpb25SZXNwb25zZSA9IGRhdGEucHJvcHM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldEZpeGVkUm90YXRpb24nOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmZpeGVkUm90YXRpb24gPSBkYXRhLnByb3BzOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRGcmljdGlvbkdyYXZpdHknOgogICAgICAgIHN0YXRlLndvcmxkLmZyaWN0aW9uR3Jhdml0eSA9IGRhdGEucHJvcHMgPyBuZXcgVmVjMyguLi5kYXRhLnByb3BzKSA6IHVuZGVmaW5lZDsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0SXNUcmlnZ2VyJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5pc1RyaWdnZXIgPSBkYXRhLnByb3BzOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRHcmF2aXR5JzoKICAgICAgICBzdGF0ZS53b3JsZC5ncmF2aXR5LnNldChkYXRhLnByb3BzWzBdLCBkYXRhLnByb3BzWzFdLCBkYXRhLnByb3BzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0VG9sZXJhbmNlJzoKICAgICAgICBpZiAoc3RhdGUud29ybGQuc29sdmVyIGluc3RhbmNlb2YgR1NTb2x2ZXIpIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnNvbHZlci50b2xlcmFuY2UgPSBkYXRhLnByb3BzOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0SXRlcmF0aW9ucyc6CiAgICAgICAgaWYgKHN0YXRlLndvcmxkLnNvbHZlciBpbnN0YW5jZW9mIEdTU29sdmVyKSB7CiAgICAgICAgICBzdGF0ZS53b3JsZC5zb2x2ZXIuaXRlcmF0aW9ucyA9IGRhdGEucHJvcHM7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzZXRCcm9hZHBoYXNlJzoKICAgICAgICBzdGF0ZS53b3JsZC5icm9hZHBoYXNlID0gbmV3IChicm9hZHBoYXNlc1tgJHtkYXRhLnByb3BzfUJyb2FkcGhhc2VgXSB8fCBOYWl2ZUJyb2FkcGhhc2UpKHN0YXRlLndvcmxkKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0QXhpc0luZGV4JzoKICAgICAgICBpZiAoc3RhdGUud29ybGQuYnJvYWRwaGFzZSBpbnN0YW5jZW9mIFNBUEJyb2FkcGhhc2UpIHsKICAgICAgICAgIHN0YXRlLndvcmxkLmJyb2FkcGhhc2UuYXhpc0luZGV4ID0gZGF0YS5wcm9wcyA9PT0gdW5kZWZpbmVkIHx8IGRhdGEucHJvcHMgPT09IG51bGwgPyAwIDogZGF0YS5wcm9wczsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2FwcGx5Rm9yY2UnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFwcGx5Rm9yY2UobmV3IFZlYzMoLi4uZGF0YS5wcm9wc1swXSksIG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnYXBwbHlJbXB1bHNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hcHBseUltcHVsc2UobmV3IFZlYzMoLi4uZGF0YS5wcm9wc1swXSksIG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnYXBwbHlMb2NhbEZvcmNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hcHBseUxvY2FsRm9yY2UobmV3IFZlYzMoLi4uZGF0YS5wcm9wc1swXSksIG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnYXBwbHlMb2NhbEltcHVsc2UnOgogICAgICAgIHN0YXRlLmJvZGllc1tkYXRhLnV1aWRdLmFwcGx5TG9jYWxJbXB1bHNlKG5ldyBWZWMzKC4uLmRhdGEucHJvcHNbMF0pLCBuZXcgVmVjMyguLi5kYXRhLnByb3BzWzFdKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2FwcGx5VG9ycXVlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5hcHBseVRvcnF1ZShuZXcgVmVjMyguLi5kYXRhLnByb3BzWzBdKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2FkZENvbnN0cmFpbnQnOgogICAgICAgIHsKICAgICAgICAgIGFkZENvbnN0cmFpbnQoc3RhdGUsIGRhdGEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdyZW1vdmVDb25zdHJhaW50JzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoX3JlZjIgPT4gewogICAgICAgICAgbGV0IHsKICAgICAgICAgICAgdXVpZAogICAgICAgICAgfSA9IF9yZWYyOwogICAgICAgICAgcmV0dXJuIHV1aWQgPT09IGRhdGEudXVpZDsKICAgICAgICB9KS5tYXAoYyA9PiBzdGF0ZS53b3JsZC5yZW1vdmVDb25zdHJhaW50KGMpKTsKICAgICAgICBpZiAoc3RhdGUuY29uc3RyYWludHNbZGF0YS51dWlkXSkgewogICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS5jb25zdHJhaW50c1tkYXRhLnV1aWRdKTsKICAgICAgICAgIGRlbGV0ZSBzdGF0ZS5jb25zdHJhaW50c1tkYXRhLnV1aWRdOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSAnZW5hYmxlQ29uc3RyYWludCc6CiAgICAgICAgc3RhdGUud29ybGQuY29uc3RyYWludHMuZmlsdGVyKGMgPT4gYy51dWlkID09PSBkYXRhLnV1aWQpLm1hcChjID0+IGMuZW5hYmxlKCkpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdkaXNhYmxlQ29uc3RyYWludCc6CiAgICAgICAgc3RhdGUud29ybGQuY29uc3RyYWludHMuZmlsdGVyKGMgPT4gYy51dWlkID09PSBkYXRhLnV1aWQpLm1hcChjID0+IGMuZGlzYWJsZSgpKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnZW5hYmxlQ29uc3RyYWludE1vdG9yJzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoYyA9PiBjLnV1aWQgPT09IGRhdGEudXVpZCkuZmlsdGVyKGlzSGluZ2VDb25zdHJhaW50KS5tYXAoYyA9PiBjLmVuYWJsZU1vdG9yKCkpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdkaXNhYmxlQ29uc3RyYWludE1vdG9yJzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoYyA9PiBjLnV1aWQgPT09IGRhdGEudXVpZCkuZmlsdGVyKGlzSGluZ2VDb25zdHJhaW50KS5tYXAoYyA9PiBjLmRpc2FibGVNb3RvcigpKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnc2V0Q29uc3RyYWludE1vdG9yU3BlZWQnOgogICAgICAgIHN0YXRlLndvcmxkLmNvbnN0cmFpbnRzLmZpbHRlcihjID0+IGMudXVpZCA9PT0gZGF0YS51dWlkKS5maWx0ZXIoaXNIaW5nZUNvbnN0cmFpbnQpLm1hcChjID0+IGMuc2V0TW90b3JTcGVlZChkYXRhLnByb3BzKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3NldENvbnN0cmFpbnRNb3Rvck1heEZvcmNlJzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoYyA9PiBjLnV1aWQgPT09IGRhdGEudXVpZCkuZmlsdGVyKGlzSGluZ2VDb25zdHJhaW50KS5tYXAoYyA9PiBjLnNldE1vdG9yTWF4Rm9yY2UoZGF0YS5wcm9wcykpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdhZGRTcHJpbmcnOgogICAgICAgIHsKICAgICAgICAgIGFkZFNwcmluZyhzdGF0ZSwgZGF0YSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3NldFNwcmluZ1N0aWZmbmVzcyc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuc3ByaW5nSW5zdGFuY2VzW2RhdGEudXVpZF0uc3RpZmZuZXNzID0gZGF0YS5wcm9wczsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnc2V0U3ByaW5nUmVzdExlbmd0aCc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuc3ByaW5nSW5zdGFuY2VzW2RhdGEudXVpZF0ucmVzdExlbmd0aCA9IGRhdGEucHJvcHM7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3NldFNwcmluZ0RhbXBpbmcnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLnNwcmluZ0luc3RhbmNlc1tkYXRhLnV1aWRdLmRhbXBpbmcgPSBkYXRhLnByb3BzOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdyZW1vdmVTcHJpbmcnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgc3RhdGUuc3ByaW5nc1tkYXRhLnV1aWRdKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnYWRkUmF5JzoKICAgICAgICB7CiAgICAgICAgICBhZGRSYXkoc3RhdGUsIGRhdGEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdyZW1vdmVSYXknOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3ByZVN0ZXAnLCBzdGF0ZS5yYXlzW2RhdGEudXVpZF0pOwogICAgICAgICAgZGVsZXRlIHN0YXRlLnJheXNbZGF0YS51dWlkXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAnYWRkUmF5Y2FzdFZlaGljbGUnOgogICAgICAgIHsKICAgICAgICAgIGFkZFJheWNhc3RWZWhpY2xlKHN0YXRlLCBkYXRhKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAncmVtb3ZlUmF5Y2FzdFZlaGljbGUnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3ByZVN0ZXAnLCBzdGF0ZS52ZWhpY2xlc1tkYXRhLnV1aWRdLnByZVN0ZXApOwogICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS52ZWhpY2xlc1tkYXRhLnV1aWRdLnBvc3RTdGVwKTsKICAgICAgICAgIHN0YXRlLnZlaGljbGVzW2RhdGEudXVpZF0udmVoaWNsZS53b3JsZCA9IG51bGw7CiAgICAgICAgICBkZWxldGUgc3RhdGUudmVoaWNsZXNbZGF0YS51dWlkXTsKICAgICAgICAgIGNvbnN0IGtleSA9IE9iamVjdC5rZXlzKHN0YXRlLnN1YnNjcmlwdGlvbnMpLmZpbmQoayA9PiBzdGF0ZS5zdWJzY3JpcHRpb25zW2tdWzBdID09PSBkYXRhLnV1aWQpOwogICAgICAgICAgaWYgKGtleSkgewogICAgICAgICAgICBkZWxldGUgc3RhdGUuc3Vic2NyaXB0aW9uc1trZXldOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdzZXRSYXljYXN0VmVoaWNsZVN0ZWVyaW5nVmFsdWUnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IFt2YWx1ZSwgd2hlZWxJbmRleF0gPSBkYXRhLnByb3BzOwogICAgICAgICAgc3RhdGUudmVoaWNsZXNbZGF0YS51dWlkXS52ZWhpY2xlLnNldFN0ZWVyaW5nVmFsdWUodmFsdWUsIHdoZWVsSW5kZXgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdhcHBseVJheWNhc3RWZWhpY2xlRW5naW5lRm9yY2UnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IFt2YWx1ZSwgd2hlZWxJbmRleF0gPSBkYXRhLnByb3BzOwogICAgICAgICAgc3RhdGUudmVoaWNsZXNbZGF0YS51dWlkXS52ZWhpY2xlLmFwcGx5RW5naW5lRm9yY2UodmFsdWUsIHdoZWVsSW5kZXgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICBjYXNlICdzZXRSYXljYXN0VmVoaWNsZUJyYWtlJzoKICAgICAgICB7CiAgICAgICAgICBjb25zdCBbYnJha2UsIHdoZWVsSW5kZXhdID0gZGF0YS5wcm9wczsKICAgICAgICAgIHN0YXRlLnZlaGljbGVzW2RhdGEudXVpZF0udmVoaWNsZS5zZXRCcmFrZShicmFrZSwgd2hlZWxJbmRleCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ2FkZENvbnRhY3RNYXRlcmlhbCc6CiAgICAgICAgewogICAgICAgICAgYWRkQ29udGFjdE1hdGVyaWFsKHN0YXRlLndvcmxkLCBjcmVhdGVNYXRlcmlhbCwgZGF0YS5wcm9wcywgZGF0YS51dWlkKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgY2FzZSAncmVtb3ZlQ29udGFjdE1hdGVyaWFsJzoKICAgICAgICB7CiAgICAgICAgICByZW1vdmVDb250YWN0TWF0ZXJpYWwoc3RhdGUud29ybGQsIGRhdGEudXVpZCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3dha2VVcCc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuYm9kaWVzW2RhdGEudXVpZF0ud2FrZVVwKCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIGNhc2UgJ3NsZWVwJzoKICAgICAgICB7CiAgICAgICAgICBzdGF0ZS5ib2RpZXNbZGF0YS51dWlkXS5zbGVlcCgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQogIH07Cgp9KSgpOwoK");class $ue extends Due{constructor(n){let{allowSleep:i=!1,axisIndex:r=0,broadphase:o="Naive",defaultContactMaterial:a={contactEquationStiffness:1e6},frictionGravity:s=null,gravity:l=[0,-9.81,0],iterations:c=5,quatNormalizeFast:g=!1,quatNormalizeSkip:u=0,size:d=1e3,solver:C="GS",tolerance:f=.001}=n;super();ry(this,"messageQueue",[]);ry(this,"worker",null);this.config={allowSleep:i,axisIndex:r,broadphase:o,defaultContactMaterial:a,frictionGravity:s,gravity:l,iterations:c,quatNormalizeFast:g,quatNormalizeSkip:u,size:d,solver:C,tolerance:f},this.buffers={positions:new Float32Array(d*3),quaternions:new Float32Array(d*4)}}get axisIndex(){return this.config.axisIndex}set axisIndex(n){this.config.axisIndex=n,this.postMessage({op:"setAxisIndex",props:n})}get broadphase(){return this.config.broadphase}set broadphase(n){this.config.broadphase=n,this.postMessage({op:"setBroadphase",props:n})}get frictionGravity(){return this.config.frictionGravity}set frictionGravity(n){this.config.frictionGravity=n,this.postMessage({op:"setFrictionGravity",props:n})}get gravity(){return this.config.gravity}set gravity(n){this.config.gravity=n,this.postMessage({op:"setGravity",props:n})}get iterations(){return this.config.iterations}set iterations(n){this.config.iterations=n,this.postMessage({op:"setIterations",props:n})}get tolerance(){return this.config.tolerance}set tolerance(n){this.config.tolerance=n,this.postMessage({op:"setTolerance",props:n})}addBodies(n){let{props:i,type:r,uuid:o}=n;this.postMessage({op:"addBodies",props:i,type:r,uuid:o})}addConstraint(n){let{props:[i,r,o],type:a,uuid:s}=n;this.postMessage({op:"addConstraint",props:[i,r,o],type:a,uuid:s})}addContactMaterial(n){let{props:i,uuid:r}=n;this.postMessage({op:"addContactMaterial",props:i,uuid:r})}addRay(n){let{props:i,uuid:r}=n;this.postMessage({op:"addRay",props:i,uuid:r})}addRaycastVehicle(n){let{props:[i,r,o,a,s,l],uuid:c}=n;this.postMessage({op:"addRaycastVehicle",props:[i,r,o,a,s,l],uuid:c})}addSpring(n){let{props:[i,r,o],uuid:a}=n;this.postMessage({op:"addSpring",props:[i,r,o],uuid:a})}applyForce(n){let{props:i,uuid:r}=n;this.postMessage({op:"applyForce",props:i,uuid:r})}applyImpulse(n){let{props:i,uuid:r}=n;this.postMessage({op:"applyImpulse",props:i,uuid:r})}applyLocalForce(n){let{props:i,uuid:r}=n;this.postMessage({op:"applyLocalForce",props:i,uuid:r})}applyLocalImpulse(n){let{props:i,uuid:r}=n;this.postMessage({op:"applyLocalImpulse",props:i,uuid:r})}applyRaycastVehicleEngineForce(n){let{props:i,uuid:r}=n;this.postMessage({op:"applyRaycastVehicleEngineForce",props:i,uuid:r})}applyTorque(n){let{props:i,uuid:r}=n;this.postMessage({op:"applyTorque",props:i,uuid:r})}connect(){this.worker=new jue,this.worker.onmessage=n=>{if(n.data.op==="frame"){this.buffers.positions=n.data.positions,this.buffers.quaternions=n.data.quaternions,this.emit(n.data.op,n.data);return}this.emit(n.data.type,n.data)};for(const n of this.messageQueue)this.worker.postMessage(n);this.messageQueue.length=0}disableConstraint(n){let{uuid:i}=n;this.postMessage({op:"disableConstraint",uuid:i})}disableConstraintMotor(n){let{uuid:i}=n;this.postMessage({op:"disableConstraintMotor",uuid:i})}disconnect(){this.worker&&(this.worker.onmessage=null)}enableConstraint(n){let{uuid:i}=n;this.postMessage({op:"enableConstraint",uuid:i})}enableConstraintMotor(n){let{uuid:i}=n;this.postMessage({op:"enableConstraintMotor",uuid:i})}init(){const{allowSleep:n,axisIndex:i,broadphase:r,defaultContactMaterial:o,frictionGravity:a,gravity:s,iterations:l,quatNormalizeFast:c,quatNormalizeSkip:g,solver:u,tolerance:d}=this.config;this.postMessage({op:"init",props:{allowSleep:n,axisIndex:i,broadphase:r,defaultContactMaterial:o,frictionGravity:a,gravity:s,iterations:l,quatNormalizeFast:c,quatNormalizeSkip:g,solver:u,tolerance:d}})}removeBodies(n){let{uuid:i}=n;this.postMessage({op:"removeBodies",uuid:i})}removeConstraint(n){let{uuid:i}=n;this.postMessage({op:"removeConstraint",uuid:i})}removeContactMaterial(n){let{uuid:i}=n;this.postMessage({op:"removeContactMaterial",uuid:i})}removeRay(n){let{uuid:i}=n;this.postMessage({op:"removeRay",uuid:i})}removeRaycastVehicle(n){let{uuid:i}=n;this.postMessage({op:"removeRaycastVehicle",uuid:i})}removeSpring(n){let{uuid:i}=n;this.postMessage({op:"removeSpring",uuid:i})}setAllowSleep(n){let{props:i,uuid:r}=n;this.postMessage({op:"setAllowSleep",props:i,uuid:r})}setAngularDamping(n){let{props:i,uuid:r}=n;this.postMessage({op:"setAngularDamping",props:i,uuid:r})}setAngularFactor(n){let{props:i,uuid:r}=n;this.postMessage({op:"setAngularFactor",props:i,uuid:r})}setAngularVelocity(n){let{props:i,uuid:r}=n;this.postMessage({op:"setAngularVelocity",props:i,uuid:r})}setCollisionFilterGroup(n){let{props:i,uuid:r}=n;this.postMessage({op:"setCollisionFilterGroup",props:i,uuid:r})}setCollisionFilterMask(n){let{props:i,uuid:r}=n;this.postMessage({op:"setCollisionFilterMask",props:i,uuid:r})}setCollisionResponse(n){let{props:i,uuid:r}=n;this.postMessage({op:"setCollisionResponse",props:i,uuid:r})}setConstraintMotorMaxForce(n){let{props:i,uuid:r}=n;this.postMessage({op:"setConstraintMotorMaxForce",props:i,uuid:r})}setConstraintMotorSpeed(n){let{props:i,uuid:r}=n;this.postMessage({op:"setConstraintMotorSpeed",props:i,uuid:r})}setFixedRotation(n){let{props:i,uuid:r}=n;this.postMessage({op:"setFixedRotation",props:i,uuid:r})}setIsTrigger(n){let{props:i,uuid:r}=n;this.postMessage({op:"setIsTrigger",props:i,uuid:r})}setLinearDamping(n){let{props:i,uuid:r}=n;this.postMessage({op:"setLinearDamping",props:i,uuid:r})}setLinearFactor(n){let{props:i,uuid:r}=n;this.postMessage({op:"setLinearFactor",props:i,uuid:r})}setMass(n){let{props:i,uuid:r}=n;this.postMessage({op:"setMass",props:i,uuid:r})}setMaterial(n){let{props:i,uuid:r}=n;this.postMessage({op:"setMaterial",props:i,uuid:r})}setPosition(n){let{props:i,uuid:r}=n;this.postMessage({op:"setPosition",props:i,uuid:r})}setQuaternion(n){let{props:[i,r,o,a],uuid:s}=n;this.postMessage({op:"setQuaternion",props:[i,r,o,a],uuid:s})}setRaycastVehicleBrake(n){let{props:i,uuid:r}=n;this.postMessage({op:"setRaycastVehicleBrake",props:i,uuid:r})}setRaycastVehicleSteeringValue(n){let{props:i,uuid:r}=n;this.postMessage({op:"setRaycastVehicleSteeringValue",props:i,uuid:r})}setRotation(n){let{props:i,uuid:r}=n;this.postMessage({op:"setRotation",props:i,uuid:r})}setSleepSpeedLimit(n){let{props:i,uuid:r}=n;this.postMessage({op:"setSleepSpeedLimit",props:i,uuid:r})}setSleepTimeLimit(n){let{props:i,uuid:r}=n;this.postMessage({op:"setSleepTimeLimit",props:i,uuid:r})}setSpringDamping(n){let{props:i,uuid:r}=n;this.postMessage({op:"setSpringDamping",props:i,uuid:r})}setSpringRestLength(n){let{props:i,uuid:r}=n;this.postMessage({op:"setSpringRestLength",props:i,uuid:r})}setSpringStiffness(n){let{props:i,uuid:r}=n;this.postMessage({op:"setSpringStiffness",props:i,uuid:r})}setUserData(n){let{props:i,uuid:r}=n;this.postMessage({op:"setUserData",props:i,uuid:r})}setVelocity(n){let{props:i,uuid:r}=n;this.postMessage({op:"setVelocity",props:i,uuid:r})}sleep(n){let{uuid:i}=n;this.postMessage({op:"sleep",uuid:i})}step(n){var i;const{buffers:{positions:r,quaternions:o}}=this;!r.byteLength&&!o.byteLength||(i=this.worker)==null||i.postMessage({op:"step",positions:r,props:n,quaternions:o},[r.buffer,o.buffer])}subscribe(n){let{props:{id:i,target:r,type:o},uuid:a}=n;this.postMessage({op:"subscribe",props:{id:i,target:r,type:o},uuid:a})}terminate(){var n;(n=this.worker)==null||n.terminate(),this.worker=null}unsubscribe(n){let{props:i}=n;this.postMessage({op:"unsubscribe",props:i})}wakeUp(n){let{uuid:i}=n;this.postMessage({op:"wakeUp",uuid:i})}postMessage(n){if(this.worker)return this.worker.postMessage(n);this.messageQueue.push(n)}}class qs{constructor(e){e===void 0&&(e=[0,0,0,0,0,0,0,0,0]),this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const n=this.elements;n[0]=e.x,n[4]=e.y,n[8]=e.z}getTrace(e){e===void 0&&(e=new Ae);const n=this.elements;return e.x=n[0],e.y=n[4],e.z=n[8],e}vmult(e,n){n===void 0&&(n=new Ae);const i=this.elements,r=e.x,o=e.y,a=e.z;return n.x=i[0]*r+i[1]*o+i[2]*a,n.y=i[3]*r+i[4]*o+i[5]*a,n.z=i[6]*r+i[7]*o+i[8]*a,n}smult(e){for(let n=0;n<this.elements.length;n++)this.elements[n]*=e}mmult(e,n){n===void 0&&(n=new qs);const i=this.elements,r=e.elements,o=n.elements,a=i[0],s=i[1],l=i[2],c=i[3],g=i[4],u=i[5],d=i[6],C=i[7],f=i[8],v=r[0],p=r[1],m=r[2],A=r[3],b=r[4],G=r[5],w=r[6],S=r[7],Z=r[8];return o[0]=a*v+s*A+l*w,o[1]=a*p+s*b+l*S,o[2]=a*m+s*G+l*Z,o[3]=c*v+g*A+u*w,o[4]=c*p+g*b+u*S,o[5]=c*m+g*G+u*Z,o[6]=d*v+C*A+f*w,o[7]=d*p+C*b+f*S,o[8]=d*m+C*G+f*Z,n}scale(e,n){n===void 0&&(n=new qs);const i=this.elements,r=n.elements;for(let o=0;o!==3;o++)r[3*o+0]=e.x*i[3*o+0],r[3*o+1]=e.y*i[3*o+1],r[3*o+2]=e.z*i[3*o+2];return n}solve(e,n){n===void 0&&(n=new Ae);const i=3,r=4,o=[];let a,s;for(a=0;a<i*r;a++)o.push(0);for(a=0;a<3;a++)for(s=0;s<3;s++)o[a+r*s]=this.elements[a+3*s];o[3+4*0]=e.x,o[3+4*1]=e.y,o[3+4*2]=e.z;let l=3;const c=l;let g;const u=4;let d;do{if(a=c-l,o[a+r*a]===0){for(s=a+1;s<c;s++)if(o[a+r*s]!==0){g=u;do d=u-g,o[d+r*a]+=o[d+r*s];while(--g);break}}if(o[a+r*a]!==0)for(s=a+1;s<c;s++){const C=o[a+r*s]/o[a+r*a];g=u;do d=u-g,o[d+r*s]=d<=a?0:o[d+r*s]-o[d+r*a]*C;while(--g)}}while(--l);if(n.z=o[2*r+3]/o[2*r+2],n.y=(o[1*r+3]-o[1*r+2]*n.z)/o[1*r+1],n.x=(o[0*r+3]-o[0*r+2]*n.z-o[0*r+1]*n.y)/o[0*r+0],isNaN(n.x)||isNaN(n.y)||isNaN(n.z)||n.x===1/0||n.y===1/0||n.z===1/0)throw`Could not solve equation! Got x=[${n.toString()}], b=[${e.toString()}], A=[${this.toString()}]`;return n}e(e,n,i){if(i===void 0)return this.elements[n+3*e];this.elements[n+3*e]=i}copy(e){for(let n=0;n<e.elements.length;n++)this.elements[n]=e.elements[n];return this}toString(){let e="";const n=",";for(let i=0;i<9;i++)e+=this.elements[i]+n;return e}reverse(e){e===void 0&&(e=new qs);const n=3,i=6,r=que;let o,a;for(o=0;o<3;o++)for(a=0;a<3;a++)r[o+i*a]=this.elements[o+3*a];r[3+6*0]=1,r[3+6*1]=0,r[3+6*2]=0,r[4+6*0]=0,r[4+6*1]=1,r[4+6*2]=0,r[5+6*0]=0,r[5+6*1]=0,r[5+6*2]=1;let s=3;const l=s;let c;const g=i;let u;do{if(o=l-s,r[o+i*o]===0){for(a=o+1;a<l;a++)if(r[o+i*a]!==0){c=g;do u=g-c,r[u+i*o]+=r[u+i*a];while(--c);break}}if(r[o+i*o]!==0)for(a=o+1;a<l;a++){const d=r[o+i*a]/r[o+i*o];c=g;do u=g-c,r[u+i*a]=u<=o?0:r[u+i*a]-r[u+i*o]*d;while(--c)}}while(--s);o=2;do{a=o-1;do{const d=r[o+i*a]/r[o+i*o];c=i;do u=i-c,r[u+i*a]=r[u+i*a]-r[u+i*o]*d;while(--c)}while(a--)}while(--o);o=2;do{const d=1/r[o+i*o];c=i;do u=i-c,r[u+i*o]=r[u+i*o]*d;while(--c)}while(o--);o=2;do{a=2;do{if(u=r[n+a+i*o],isNaN(u)||u===1/0)throw`Could not reverse! A=[${this.toString()}]`;e.e(o,a,u)}while(a--)}while(o--);return e}setRotationFromQuaternion(e){const n=e.x,i=e.y,r=e.z,o=e.w,a=n+n,s=i+i,l=r+r,c=n*a,g=n*s,u=n*l,d=i*s,C=i*l,f=r*l,v=o*a,p=o*s,m=o*l,A=this.elements;return A[3*0+0]=1-(d+f),A[3*0+1]=g-m,A[3*0+2]=u+p,A[3*1+0]=g+m,A[3*1+1]=1-(c+f),A[3*1+2]=C-v,A[3*2+0]=u-p,A[3*2+1]=C+v,A[3*2+2]=1-(c+d),this}transpose(e){e===void 0&&(e=new qs);const n=this.elements,i=e.elements;let r;return i[0]=n[0],i[4]=n[4],i[8]=n[8],r=n[1],i[1]=n[3],i[3]=r,r=n[2],i[2]=n[6],i[6]=r,r=n[5],i[5]=n[7],i[7]=r,e}}const que=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class Ae{constructor(e,n,i){e===void 0&&(e=0),n===void 0&&(n=0),i===void 0&&(i=0),this.x=e,this.y=n,this.z=i}cross(e,n){n===void 0&&(n=new Ae);const i=e.x,r=e.y,o=e.z,a=this.x,s=this.y,l=this.z;return n.x=s*o-l*r,n.y=l*i-a*o,n.z=a*r-s*i,n}set(e,n,i){return this.x=e,this.y=n,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,n){if(n)n.x=e.x+this.x,n.y=e.y+this.y,n.z=e.z+this.z;else return new Ae(this.x+e.x,this.y+e.y,this.z+e.z)}vsub(e,n){if(n)n.x=this.x-e.x,n.y=this.y-e.y,n.z=this.z-e.z;else return new Ae(this.x-e.x,this.y-e.y,this.z-e.z)}crossmat(){return new qs([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,n=this.y,i=this.z,r=Math.sqrt(e*e+n*n+i*i);if(r>0){const o=1/r;this.x*=o,this.y*=o,this.z*=o}else this.x=0,this.y=0,this.z=0;return r}unit(e){e===void 0&&(e=new Ae);const n=this.x,i=this.y,r=this.z;let o=Math.sqrt(n*n+i*i+r*r);return o>0?(o=1/o,e.x=n*o,e.y=i*o,e.z=r*o):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,n=this.y,i=this.z;return Math.sqrt(e*e+n*n+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const n=this.x,i=this.y,r=this.z,o=e.x,a=e.y,s=e.z;return Math.sqrt((o-n)*(o-n)+(a-i)*(a-i)+(s-r)*(s-r))}distanceSquared(e){const n=this.x,i=this.y,r=this.z,o=e.x,a=e.y,s=e.z;return(o-n)*(o-n)+(a-i)*(a-i)+(s-r)*(s-r)}scale(e,n){n===void 0&&(n=new Ae);const i=this.x,r=this.y,o=this.z;return n.x=e*i,n.y=e*r,n.z=e*o,n}vmul(e,n){return n===void 0&&(n=new Ae),n.x=e.x*this.x,n.y=e.y*this.y,n.z=e.z*this.z,n}addScaledVector(e,n,i){return i===void 0&&(i=new Ae),i.x=this.x+e*n.x,i.y=this.y+e*n.y,i.z=this.z+e*n.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return this.x===0&&this.y===0&&this.z===0}negate(e){return e===void 0&&(e=new Ae),e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,n){const i=this.length();if(i>0){const r=ede,o=1/i;r.set(this.x*o,this.y*o,this.z*o);const a=tde;Math.abs(r.x)<.9?(a.set(1,0,0),r.cross(a,e)):(a.set(0,1,0),r.cross(a,e)),r.cross(e,n)}else e.set(1,0,0),n.set(0,1,0)}toString(){return`${this.x},${this.y},${this.z}`}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,n,i){const r=this.x,o=this.y,a=this.z;i.x=r+(e.x-r)*n,i.y=o+(e.y-o)*n,i.z=a+(e.z-a)*n}almostEquals(e,n){return n===void 0&&(n=1e-6),!(Math.abs(this.x-e.x)>n||Math.abs(this.y-e.y)>n||Math.abs(this.z-e.z)>n)}almostZero(e){return e===void 0&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,n){return this.negate(m3),m3.almostEquals(e,n)}clone(){return new Ae(this.x,this.y,this.z)}}Ae.ZERO=new Ae(0,0,0);Ae.UNIT_X=new Ae(1,0,0);Ae.UNIT_Y=new Ae(0,1,0);Ae.UNIT_Z=new Ae(0,0,1);const ede=new Ae,tde=new Ae,m3=new Ae;class ya{constructor(e){e===void 0&&(e={}),this.lowerBound=new Ae,this.upperBound=new Ae,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,n,i,r){const o=this.lowerBound,a=this.upperBound,s=i;o.copy(e[0]),s&&s.vmult(o,o),a.copy(o);for(let l=1;l<e.length;l++){let c=e[l];s&&(s.vmult(c,A3),c=A3),c.x>a.x&&(a.x=c.x),c.x<o.x&&(o.x=c.x),c.y>a.y&&(a.y=c.y),c.y<o.y&&(o.y=c.y),c.z>a.z&&(a.z=c.z),c.z<o.z&&(o.z=c.z)}return n&&(n.vadd(o,o),n.vadd(a,a)),r&&(o.x-=r,o.y-=r,o.z-=r,a.x+=r,a.y+=r,a.z+=r),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return new ya().copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const n=this.lowerBound,i=this.upperBound,r=e.lowerBound,o=e.upperBound,a=r.x<=i.x&&i.x<=o.x||n.x<=o.x&&o.x<=i.x,s=r.y<=i.y&&i.y<=o.y||n.y<=o.y&&o.y<=i.y,l=r.z<=i.z&&i.z<=o.z||n.z<=o.z&&o.z<=i.z;return a&&s&&l}volume(){const e=this.lowerBound,n=this.upperBound;return(n.x-e.x)*(n.y-e.y)*(n.z-e.z)}contains(e){const n=this.lowerBound,i=this.upperBound,r=e.lowerBound,o=e.upperBound;return n.x<=r.x&&i.x>=o.x&&n.y<=r.y&&i.y>=o.y&&n.z<=r.z&&i.z>=o.z}getCorners(e,n,i,r,o,a,s,l){const c=this.lowerBound,g=this.upperBound;e.copy(c),n.set(g.x,c.y,c.z),i.set(g.x,g.y,c.z),r.set(c.x,g.y,g.z),o.set(g.x,c.y,g.z),a.set(c.x,g.y,c.z),s.set(c.x,c.y,g.z),l.copy(g)}toLocalFrame(e,n){const i=p3,r=i[0],o=i[1],a=i[2],s=i[3],l=i[4],c=i[5],g=i[6],u=i[7];this.getCorners(r,o,a,s,l,c,g,u);for(let d=0;d!==8;d++){const C=i[d];e.pointToLocal(C,C)}return n.setFromPoints(i)}toWorldFrame(e,n){const i=p3,r=i[0],o=i[1],a=i[2],s=i[3],l=i[4],c=i[5],g=i[6],u=i[7];this.getCorners(r,o,a,s,l,c,g,u);for(let d=0;d!==8;d++){const C=i[d];e.pointToWorld(C,C)}return n.setFromPoints(i)}overlapsRay(e){const{direction:n,from:i}=e,r=1/n.x,o=1/n.y,a=1/n.z,s=(this.lowerBound.x-i.x)*r,l=(this.upperBound.x-i.x)*r,c=(this.lowerBound.y-i.y)*o,g=(this.upperBound.y-i.y)*o,u=(this.lowerBound.z-i.z)*a,d=(this.upperBound.z-i.z)*a,C=Math.max(Math.max(Math.min(s,l),Math.min(c,g)),Math.min(u,d)),f=Math.min(Math.min(Math.max(s,l),Math.max(c,g)),Math.max(u,d));return!(f<0||C>f)}}const A3=new Ae,p3=[new Ae,new Ae,new Ae,new Ae,new Ae,new Ae,new Ae,new Ae];class Or{constructor(e,n,i,r){e===void 0&&(e=0),n===void 0&&(n=0),i===void 0&&(i=0),r===void 0&&(r=1),this.x=e,this.y=n,this.z=i,this.w=r}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}toString(){return`${this.x},${this.y},${this.z},${this.w}`}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,n){const i=Math.sin(n*.5);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(n*.5),this}toAxisAngle(e){e===void 0&&(e=new Ae),this.normalize();const n=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,n]}setFromVectors(e,n){if(e.isAntiparallelTo(n)){const i=nde,r=ide;e.tangents(i,r),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(n);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(e.length()**2*n.length()**2)+e.dot(n),this.normalize()}return this}mult(e,n){n===void 0&&(n=new Or);const i=this.x,r=this.y,o=this.z,a=this.w,s=e.x,l=e.y,c=e.z,g=e.w;return n.x=i*g+a*s+r*c-o*l,n.y=r*g+a*l+o*s-i*c,n.z=o*g+a*c+i*l-r*s,n.w=a*g-i*s-r*l-o*c,n}inverse(e){e===void 0&&(e=new Or);const n=this.x,i=this.y,r=this.z,o=this.w;this.conjugate(e);const a=1/(n*n+i*i+r*r+o*o);return e.x*=a,e.y*=a,e.z*=a,e.w*=a,e}conjugate(e){return e===void 0&&(e=new Or),e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,n){n===void 0&&(n=new Ae);const i=e.x,r=e.y,o=e.z,a=this.x,s=this.y,l=this.z,c=this.w,g=c*i+s*o-l*r,u=c*r+l*i-a*o,d=c*o+a*r-s*i,C=-a*i-s*r-l*o;return n.x=g*c+C*-a+u*-l-d*-s,n.y=u*c+C*-s+d*-a-g*-l,n.z=d*c+C*-l+g*-s-u*-a,n}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,n){n===void 0&&(n="YZX");let i,r,o;const a=this.x,s=this.y,l=this.z,c=this.w;switch(n){case"YZX":const g=a*s+l*c;if(g>.499&&(i=2*Math.atan2(a,c),r=Math.PI/2,o=0),g<-.499&&(i=-2*Math.atan2(a,c),r=-Math.PI/2,o=0),i===void 0){const u=a*a,d=s*s,C=l*l;i=Math.atan2(2*s*c-2*a*l,1-2*d-2*C),r=Math.asin(2*g),o=Math.atan2(2*a*c-2*s*l,1-2*u-2*C)}break;default:throw new Error(`Euler order ${n} not supported yet.`)}e.y=i,e.z=r,e.x=o}setFromEuler(e,n,i,r){r===void 0&&(r="XYZ");const o=Math.cos(e/2),a=Math.cos(n/2),s=Math.cos(i/2),l=Math.sin(e/2),c=Math.sin(n/2),g=Math.sin(i/2);return r==="XYZ"?(this.x=l*a*s+o*c*g,this.y=o*c*s-l*a*g,this.z=o*a*g+l*c*s,this.w=o*a*s-l*c*g):r==="YXZ"?(this.x=l*a*s+o*c*g,this.y=o*c*s-l*a*g,this.z=o*a*g-l*c*s,this.w=o*a*s+l*c*g):r==="ZXY"?(this.x=l*a*s-o*c*g,this.y=o*c*s+l*a*g,this.z=o*a*g+l*c*s,this.w=o*a*s-l*c*g):r==="ZYX"?(this.x=l*a*s-o*c*g,this.y=o*c*s+l*a*g,this.z=o*a*g-l*c*s,this.w=o*a*s+l*c*g):r==="YZX"?(this.x=l*a*s+o*c*g,this.y=o*c*s+l*a*g,this.z=o*a*g-l*c*s,this.w=o*a*s-l*c*g):r==="XZY"&&(this.x=l*a*s-o*c*g,this.y=o*c*s-l*a*g,this.z=o*a*g+l*c*s,this.w=o*a*s+l*c*g),this}clone(){return new Or(this.x,this.y,this.z,this.w)}slerp(e,n,i){i===void 0&&(i=new Or);const r=this.x,o=this.y,a=this.z,s=this.w;let l=e.x,c=e.y,g=e.z,u=e.w,d,C,f,v,p;return C=r*l+o*c+a*g+s*u,C<0&&(C=-C,l=-l,c=-c,g=-g,u=-u),1-C>1e-6?(d=Math.acos(C),f=Math.sin(d),v=Math.sin((1-n)*d)/f,p=Math.sin(n*d)/f):(v=1-n,p=n),i.x=v*r+p*l,i.y=v*o+p*c,i.z=v*a+p*g,i.w=v*s+p*u,i}integrate(e,n,i,r){r===void 0&&(r=new Or);const o=e.x*i.x,a=e.y*i.y,s=e.z*i.z,l=this.x,c=this.y,g=this.z,u=this.w,d=n*.5;return r.x+=d*(o*u+a*g-s*c),r.y+=d*(a*u+s*l-o*g),r.z+=d*(s*u+o*c-a*l),r.w+=d*(-o*l-a*c-s*g),r}}const nde=new Ae,ide=new Ae,rde={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class rn{constructor(e){e===void 0&&(e={}),this.id=rn.idCounter++,this.type=e.type||0,this.boundingSphereRadius=0,this.collisionResponse=e.collisionResponse?e.collisionResponse:!0,this.collisionFilterGroup=e.collisionFilterGroup!==void 0?e.collisionFilterGroup:1,this.collisionFilterMask=e.collisionFilterMask!==void 0?e.collisionFilterMask:-1,this.material=e.material?e.material:null,this.body=null}updateBoundingSphereRadius(){throw`computeBoundingSphereRadius() not implemented for shape type ${this.type}`}volume(){throw`volume() not implemented for shape type ${this.type}`}calculateLocalInertia(e,n){throw`calculateLocalInertia() not implemented for shape type ${this.type}`}calculateWorldAABB(e,n,i,r){throw`calculateWorldAABB() not implemented for shape type ${this.type}`}}rn.idCounter=0;rn.types=rde;class Io{constructor(e){e===void 0&&(e={}),this.position=new Ae,this.quaternion=new Or,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,n){return Io.pointToLocalFrame(this.position,this.quaternion,e,n)}pointToWorld(e,n){return Io.pointToWorldFrame(this.position,this.quaternion,e,n)}vectorToWorldFrame(e,n){return n===void 0&&(n=new Ae),this.quaternion.vmult(e,n),n}static pointToLocalFrame(e,n,i,r){return r===void 0&&(r=new Ae),i.vsub(e,r),n.conjugate(v3),v3.vmult(r,r),r}static pointToWorldFrame(e,n,i,r){return r===void 0&&(r=new Ae),n.vmult(i,r),r.vadd(e,r),r}static vectorToWorldFrame(e,n,i){return i===void 0&&(i=new Ae),e.vmult(n,i),i}static vectorToLocalFrame(e,n,i,r){return r===void 0&&(r=new Ae),n.w*=-1,n.vmult(i,r),n.w*=-1,r}}const v3=new Or;new Ae;new Ae;new Ae;new Ae;new Ae,new Ae,new Ae,new Ae,new Ae,new Ae,new Ae,new Ae;new Ae;new Or;new ya;new qs;new qs;new qs;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Or;new Ae;new Ae;new Ae;new Ae;class US{constructor(){this.rayFromWorld=new Ae,this.rayToWorld=new Ae,this.hitNormalWorld=new Ae,this.hitPointWorld=new Ae,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,n,i,r,o,a,s){this.rayFromWorld.copy(e),this.rayToWorld.copy(n),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(r),this.shape=o,this.body=a,this.distance=s}}let vL,bL,yL,GL,BL,SL,wL;const k1={CLOSEST:1,ANY:2,ALL:4};vL=rn.types.SPHERE;bL=rn.types.PLANE;yL=rn.types.BOX;GL=rn.types.CYLINDER;BL=rn.types.CONVEXPOLYHEDRON;SL=rn.types.HEIGHTFIELD;wL=rn.types.TRIMESH;class Wr{get[vL](){return this._intersectSphere}get[bL](){return this._intersectPlane}get[yL](){return this._intersectBox}get[GL](){return this._intersectConvex}get[BL](){return this._intersectConvex}get[SL](){return this._intersectHeightfield}get[wL](){return this._intersectTrimesh}constructor(e,n){e===void 0&&(e=new Ae),n===void 0&&(n=new Ae),this.from=e.clone(),this.to=n.clone(),this.direction=new Ae,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=Wr.ANY,this.result=new US,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,n){return this.mode=n.mode||Wr.ANY,this.result=n.result||new US,this.skipBackfaces=!!n.skipBackfaces,this.collisionFilterMask=typeof n.collisionFilterMask<"u"?n.collisionFilterMask:-1,this.collisionFilterGroup=typeof n.collisionFilterGroup<"u"?n.collisionFilterGroup:-1,this.checkCollisionResponse=typeof n.checkCollisionResponse<"u"?n.checkCollisionResponse:!0,n.from&&this.from.copy(n.from),n.to&&this.to.copy(n.to),this.callback=n.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(b3),IB.length=0,e.broadphase.aabbQuery(e,b3,IB),this.intersectBodies(IB),this.hasHit}intersectBody(e,n){n&&(this.result=n,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||!(this.collisionFilterGroup&e.collisionFilterMask)||!(e.collisionFilterGroup&this.collisionFilterMask))return;const r=ode,o=ade;for(let a=0,s=e.shapes.length;a<s;a++){const l=e.shapes[a];if(!(i&&!l.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[a],o),e.quaternion.vmult(e.shapeOffsets[a],r),r.vadd(e.position,r),this.intersectShape(l,o,r,e),this.result.shouldStop))break}}intersectBodies(e,n){n&&(this.result=n,this.updateDirection());for(let i=0,r=e.length;!this.result.shouldStop&&i<r;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,n,i,r){const o=this.from;if(vde(o,this.direction,i)>e.boundingSphereRadius)return;const s=this[e.type];s&&s.call(this,e,n,i,r,e)}_intersectBox(e,n,i,r,o){return this._intersectConvex(e.convexPolyhedronRepresentation,n,i,r,o)}_intersectPlane(e,n,i,r,o){const a=this.from,s=this.to,l=this.direction,c=new Ae(0,0,1);n.vmult(c,c);const g=new Ae;a.vsub(i,g);const u=g.dot(c);s.vsub(i,g);const d=g.dot(c);if(u*d>0||a.distanceTo(s)<u)return;const C=c.dot(l);if(Math.abs(C)<this.precision)return;const f=new Ae,v=new Ae,p=new Ae;a.vsub(i,f);const m=-c.dot(f)/C;l.scale(m,v),a.vadd(v,p),this.reportIntersection(c,p,o,r,-1)}getAABB(e){const{lowerBound:n,upperBound:i}=e,r=this.to,o=this.from;n.x=Math.min(r.x,o.x),n.y=Math.min(r.y,o.y),n.z=Math.min(r.z,o.z),i.x=Math.max(r.x,o.x),i.y=Math.max(r.y,o.y),i.z=Math.max(r.z,o.z)}_intersectHeightfield(e,n,i,r,o){e.data,e.elementSize;const a=sde;a.from.copy(this.from),a.to.copy(this.to),Io.pointToLocalFrame(i,n,a.from,a.from),Io.pointToLocalFrame(i,n,a.to,a.to),a.updateDirection();const s=lde;let l,c,g,u;l=c=0,g=u=e.data.length-1;const d=new ya;a.getAABB(d),e.getIndexOfPosition(d.lowerBound.x,d.lowerBound.y,s,!0),l=Math.max(l,s[0]),c=Math.max(c,s[1]),e.getIndexOfPosition(d.upperBound.x,d.upperBound.y,s,!0),g=Math.min(g,s[0]+1),u=Math.min(u,s[1]+1);for(let C=l;C<g;C++)for(let f=c;f<u;f++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(C,f,d),!!d.overlapsRay(a)){if(e.getConvexTrianglePillar(C,f,!1),Io.pointToWorldFrame(i,n,e.pillarOffset,EA),this._intersectConvex(e.pillarConvex,n,EA,r,o,y3),this.result.shouldStop)return;e.getConvexTrianglePillar(C,f,!0),Io.pointToWorldFrame(i,n,e.pillarOffset,EA),this._intersectConvex(e.pillarConvex,n,EA,r,o,y3)}}}_intersectSphere(e,n,i,r,o){const a=this.from,s=this.to,l=e.radius,c=(s.x-a.x)**2+(s.y-a.y)**2+(s.z-a.z)**2,g=2*((s.x-a.x)*(a.x-i.x)+(s.y-a.y)*(a.y-i.y)+(s.z-a.z)*(a.z-i.z)),u=(a.x-i.x)**2+(a.y-i.y)**2+(a.z-i.z)**2-l**2,d=g**2-4*c*u,C=cde,f=gde;if(!(d<0))if(d===0)a.lerp(s,d,C),C.vsub(i,f),f.normalize(),this.reportIntersection(f,C,o,r,-1);else{const v=(-g-Math.sqrt(d))/(2*c),p=(-g+Math.sqrt(d))/(2*c);if(v>=0&&v<=1&&(a.lerp(s,v,C),C.vsub(i,f),f.normalize(),this.reportIntersection(f,C,o,r,-1)),this.result.shouldStop)return;p>=0&&p<=1&&(a.lerp(s,p,C),C.vsub(i,f),f.normalize(),this.reportIntersection(f,C,o,r,-1))}}_intersectConvex(e,n,i,r,o,a){const s=ude,l=G3,c=a&&a.faceList||null,g=e.faces,u=e.vertices,d=e.faceNormals,C=this.direction,f=this.from,v=this.to,p=f.distanceTo(v),m=c?c.length:g.length,A=this.result;for(let b=0;!A.shouldStop&&b<m;b++){const G=c?c[b]:b,w=g[G],S=d[G],Z=n,x=i;l.copy(u[w[0]]),Z.vmult(l,l),l.vadd(x,l),l.vsub(f,l),Z.vmult(S,s);const R=C.dot(s);if(Math.abs(R)<this.precision)continue;const W=s.dot(l)/R;if(!(W<0)){C.scale(W,co),co.vadd(f,co),Na.copy(u[w[0]]),Z.vmult(Na,Na),x.vadd(Na,Na);for(let M=1;!A.shouldStop&&M<w.length-1;M++){cs.copy(u[w[M]]),gs.copy(u[w[M+1]]),Z.vmult(cs,cs),Z.vmult(gs,gs),x.vadd(cs,cs),x.vadd(gs,gs);const N=co.distanceTo(f);!(Wr.pointInTriangle(co,Na,cs,gs)||Wr.pointInTriangle(co,cs,Na,gs))||N>p||this.reportIntersection(s,co,o,r,G)}}}}_intersectTrimesh(e,n,i,r,o,a){const s=dde,l=Ade,c=pde,g=G3,u=Ide,d=Cde,C=hde,f=mde,v=fde,p=e.indices;e.vertices;const m=this.from,A=this.to,b=this.direction;c.position.copy(i),c.quaternion.copy(n),Io.vectorToLocalFrame(i,n,b,u),Io.pointToLocalFrame(i,n,m,d),Io.pointToLocalFrame(i,n,A,C),C.x*=e.scale.x,C.y*=e.scale.y,C.z*=e.scale.z,d.x*=e.scale.x,d.y*=e.scale.y,d.z*=e.scale.z,C.vsub(d,u),u.normalize();const G=d.distanceSquared(C);e.tree.rayQuery(this,c,l);for(let w=0,S=l.length;!this.result.shouldStop&&w!==S;w++){const Z=l[w];e.getNormal(Z,s),e.getVertex(p[Z*3],Na),Na.vsub(d,g);const x=u.dot(s),R=s.dot(g)/x;if(R<0)continue;u.scale(R,co),co.vadd(d,co),e.getVertex(p[Z*3+1],cs),e.getVertex(p[Z*3+2],gs);const W=co.distanceSquared(d);!(Wr.pointInTriangle(co,cs,Na,gs)||Wr.pointInTriangle(co,Na,cs,gs))||W>G||(Io.vectorToWorldFrame(n,s,v),Io.pointToWorldFrame(i,n,co,f),this.reportIntersection(v,f,o,r,Z))}l.length=0}reportIntersection(e,n,i,r,o){const a=this.from,s=this.to,l=a.distanceTo(n),c=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(c.hitFaceIndex=typeof o<"u"?o:-1,this.mode){case Wr.ALL:this.hasHit=!0,c.set(a,s,e,n,i,r,l),c.hasHit=!0,this.callback(c);break;case Wr.CLOSEST:(l<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(a,s,e,n,i,r,l));break;case Wr.ANY:this.hasHit=!0,c.hasHit=!0,c.set(a,s,e,n,i,r,l),c.shouldStop=!0;break}}static pointInTriangle(e,n,i,r){r.vsub(n,tg),i.vsub(n,nC),e.vsub(n,CB);const o=tg.dot(tg),a=tg.dot(nC),s=tg.dot(CB),l=nC.dot(nC),c=nC.dot(CB);let g,u;return(g=l*s-a*c)>=0&&(u=o*c-a*s)>=0&&g+u<o*l-a*a}}Wr.CLOSEST=k1.CLOSEST;Wr.ANY=k1.ANY;Wr.ALL=k1.ALL;const b3=new ya,IB=[],nC=new Ae,CB=new Ae,ode=new Ae,ade=new Or,co=new Ae,Na=new Ae,cs=new Ae,gs=new Ae;new Ae;new US;const y3={faceList:[0]},EA=new Ae,sde=new Wr,lde=[],cde=new Ae,gde=new Ae,ude=new Ae;new Ae;new Ae;const G3=new Ae,dde=new Ae,Ide=new Ae,Cde=new Ae,hde=new Ae,fde=new Ae,mde=new Ae;new ya;const Ade=[],pde=new Io,tg=new Ae,YA=new Ae;function vde(t,e,n){n.vsub(t,tg);const i=tg.dot(e);return e.scale(i,YA),YA.vadd(t,YA),n.distanceTo(YA)}new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Wr;new Ae;new Ae;new Ae;new Ae(1,0,0),new Ae(0,1,0),new Ae(0,0,1);new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new ya;new Ae;new ya;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new ya;new Ae;new Io;new ya;rn.types.SPHERE,rn.types.SPHERE|rn.types.PLANE,rn.types.BOX|rn.types.BOX,rn.types.SPHERE|rn.types.BOX,rn.types.PLANE|rn.types.BOX,rn.types.CONVEXPOLYHEDRON,rn.types.SPHERE|rn.types.CONVEXPOLYHEDRON,rn.types.PLANE|rn.types.CONVEXPOLYHEDRON,rn.types.BOX|rn.types.CONVEXPOLYHEDRON,rn.types.SPHERE|rn.types.HEIGHTFIELD,rn.types.BOX|rn.types.HEIGHTFIELD,rn.types.CONVEXPOLYHEDRON|rn.types.HEIGHTFIELD,rn.types.PARTICLE|rn.types.SPHERE,rn.types.PLANE|rn.types.PARTICLE,rn.types.BOX|rn.types.PARTICLE,rn.types.PARTICLE|rn.types.CONVEXPOLYHEDRON,rn.types.CYLINDER,rn.types.SPHERE|rn.types.CYLINDER,rn.types.PLANE|rn.types.CYLINDER,rn.types.BOX|rn.types.CYLINDER,rn.types.CONVEXPOLYHEDRON|rn.types.CYLINDER,rn.types.HEIGHTFIELD|rn.types.CYLINDER,rn.types.PARTICLE|rn.types.CYLINDER,rn.types.SPHERE|rn.types.TRIMESH,rn.types.PLANE|rn.types.TRIMESH;new Ae;new Ae;new Ae;new Ae;new Ae;new Or;new Or;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new ya;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae,new Ae,new Ae,new Ae,new Ae,new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Or;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new Ae;new ya;new Wr;const iC=globalThis.performance||{};if(!iC.now){let t=Date.now();iC.timing&&iC.timing.navigationStart&&(t=iC.timing.navigationStart),iC.now=()=>Date.now()-t}new Ae;class el{constructor(e){e===void 0&&(e=[0,0,0,0,0,0,0,0,0]),this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const n=this.elements;n[0]=e.x,n[4]=e.y,n[8]=e.z}getTrace(e){e===void 0&&(e=new pe);const n=this.elements;return e.x=n[0],e.y=n[4],e.z=n[8],e}vmult(e,n){n===void 0&&(n=new pe);const i=this.elements,r=e.x,o=e.y,a=e.z;return n.x=i[0]*r+i[1]*o+i[2]*a,n.y=i[3]*r+i[4]*o+i[5]*a,n.z=i[6]*r+i[7]*o+i[8]*a,n}smult(e){for(let n=0;n<this.elements.length;n++)this.elements[n]*=e}mmult(e,n){n===void 0&&(n=new el);const i=this.elements,r=e.elements,o=n.elements,a=i[0],s=i[1],l=i[2],c=i[3],g=i[4],u=i[5],d=i[6],C=i[7],f=i[8],v=r[0],p=r[1],m=r[2],A=r[3],b=r[4],G=r[5],w=r[6],S=r[7],Z=r[8];return o[0]=a*v+s*A+l*w,o[1]=a*p+s*b+l*S,o[2]=a*m+s*G+l*Z,o[3]=c*v+g*A+u*w,o[4]=c*p+g*b+u*S,o[5]=c*m+g*G+u*Z,o[6]=d*v+C*A+f*w,o[7]=d*p+C*b+f*S,o[8]=d*m+C*G+f*Z,n}scale(e,n){n===void 0&&(n=new el);const i=this.elements,r=n.elements;for(let o=0;o!==3;o++)r[3*o+0]=e.x*i[3*o+0],r[3*o+1]=e.y*i[3*o+1],r[3*o+2]=e.z*i[3*o+2];return n}solve(e,n){n===void 0&&(n=new pe);const i=3,r=4,o=[];let a,s;for(a=0;a<i*r;a++)o.push(0);for(a=0;a<3;a++)for(s=0;s<3;s++)o[a+r*s]=this.elements[a+3*s];o[3+4*0]=e.x,o[3+4*1]=e.y,o[3+4*2]=e.z;let l=3;const c=l;let g;const u=4;let d;do{if(a=c-l,o[a+r*a]===0){for(s=a+1;s<c;s++)if(o[a+r*s]!==0){g=u;do d=u-g,o[d+r*a]+=o[d+r*s];while(--g);break}}if(o[a+r*a]!==0)for(s=a+1;s<c;s++){const C=o[a+r*s]/o[a+r*a];g=u;do d=u-g,o[d+r*s]=d<=a?0:o[d+r*s]-o[d+r*a]*C;while(--g)}}while(--l);if(n.z=o[2*r+3]/o[2*r+2],n.y=(o[1*r+3]-o[1*r+2]*n.z)/o[1*r+1],n.x=(o[0*r+3]-o[0*r+2]*n.z-o[0*r+1]*n.y)/o[0*r+0],isNaN(n.x)||isNaN(n.y)||isNaN(n.z)||n.x===1/0||n.y===1/0||n.z===1/0)throw`Could not solve equation! Got x=[${n.toString()}], b=[${e.toString()}], A=[${this.toString()}]`;return n}e(e,n,i){if(i===void 0)return this.elements[n+3*e];this.elements[n+3*e]=i}copy(e){for(let n=0;n<e.elements.length;n++)this.elements[n]=e.elements[n];return this}toString(){let e="";const n=",";for(let i=0;i<9;i++)e+=this.elements[i]+n;return e}reverse(e){e===void 0&&(e=new el);const n=3,i=6,r=bde;let o,a;for(o=0;o<3;o++)for(a=0;a<3;a++)r[o+i*a]=this.elements[o+3*a];r[3+6*0]=1,r[3+6*1]=0,r[3+6*2]=0,r[4+6*0]=0,r[4+6*1]=1,r[4+6*2]=0,r[5+6*0]=0,r[5+6*1]=0,r[5+6*2]=1;let s=3;const l=s;let c;const g=i;let u;do{if(o=l-s,r[o+i*o]===0){for(a=o+1;a<l;a++)if(r[o+i*a]!==0){c=g;do u=g-c,r[u+i*o]+=r[u+i*a];while(--c);break}}if(r[o+i*o]!==0)for(a=o+1;a<l;a++){const d=r[o+i*a]/r[o+i*o];c=g;do u=g-c,r[u+i*a]=u<=o?0:r[u+i*a]-r[u+i*o]*d;while(--c)}}while(--s);o=2;do{a=o-1;do{const d=r[o+i*a]/r[o+i*o];c=i;do u=i-c,r[u+i*a]=r[u+i*a]-r[u+i*o]*d;while(--c)}while(a--)}while(--o);o=2;do{const d=1/r[o+i*o];c=i;do u=i-c,r[u+i*o]=r[u+i*o]*d;while(--c)}while(o--);o=2;do{a=2;do{if(u=r[n+a+i*o],isNaN(u)||u===1/0)throw`Could not reverse! A=[${this.toString()}]`;e.e(o,a,u)}while(a--)}while(o--);return e}setRotationFromQuaternion(e){const n=e.x,i=e.y,r=e.z,o=e.w,a=n+n,s=i+i,l=r+r,c=n*a,g=n*s,u=n*l,d=i*s,C=i*l,f=r*l,v=o*a,p=o*s,m=o*l,A=this.elements;return A[3*0+0]=1-(d+f),A[3*0+1]=g-m,A[3*0+2]=u+p,A[3*1+0]=g+m,A[3*1+1]=1-(c+f),A[3*1+2]=C-v,A[3*2+0]=u-p,A[3*2+1]=C+v,A[3*2+2]=1-(c+d),this}transpose(e){e===void 0&&(e=new el);const n=this.elements,i=e.elements;let r;return i[0]=n[0],i[4]=n[4],i[8]=n[8],r=n[1],i[1]=n[3],i[3]=r,r=n[2],i[2]=n[6],i[6]=r,r=n[5],i[5]=n[7],i[7]=r,e}}const bde=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class pe{constructor(e,n,i){e===void 0&&(e=0),n===void 0&&(n=0),i===void 0&&(i=0),this.x=e,this.y=n,this.z=i}cross(e,n){n===void 0&&(n=new pe);const i=e.x,r=e.y,o=e.z,a=this.x,s=this.y,l=this.z;return n.x=s*o-l*r,n.y=l*i-a*o,n.z=a*r-s*i,n}set(e,n,i){return this.x=e,this.y=n,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,n){if(n)n.x=e.x+this.x,n.y=e.y+this.y,n.z=e.z+this.z;else return new pe(this.x+e.x,this.y+e.y,this.z+e.z)}vsub(e,n){if(n)n.x=this.x-e.x,n.y=this.y-e.y,n.z=this.z-e.z;else return new pe(this.x-e.x,this.y-e.y,this.z-e.z)}crossmat(){return new el([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,n=this.y,i=this.z,r=Math.sqrt(e*e+n*n+i*i);if(r>0){const o=1/r;this.x*=o,this.y*=o,this.z*=o}else this.x=0,this.y=0,this.z=0;return r}unit(e){e===void 0&&(e=new pe);const n=this.x,i=this.y,r=this.z;let o=Math.sqrt(n*n+i*i+r*r);return o>0?(o=1/o,e.x=n*o,e.y=i*o,e.z=r*o):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,n=this.y,i=this.z;return Math.sqrt(e*e+n*n+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const n=this.x,i=this.y,r=this.z,o=e.x,a=e.y,s=e.z;return Math.sqrt((o-n)*(o-n)+(a-i)*(a-i)+(s-r)*(s-r))}distanceSquared(e){const n=this.x,i=this.y,r=this.z,o=e.x,a=e.y,s=e.z;return(o-n)*(o-n)+(a-i)*(a-i)+(s-r)*(s-r)}scale(e,n){n===void 0&&(n=new pe);const i=this.x,r=this.y,o=this.z;return n.x=e*i,n.y=e*r,n.z=e*o,n}vmul(e,n){return n===void 0&&(n=new pe),n.x=e.x*this.x,n.y=e.y*this.y,n.z=e.z*this.z,n}addScaledVector(e,n,i){return i===void 0&&(i=new pe),i.x=this.x+e*n.x,i.y=this.y+e*n.y,i.z=this.z+e*n.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return this.x===0&&this.y===0&&this.z===0}negate(e){return e===void 0&&(e=new pe),e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,n){const i=this.length();if(i>0){const r=yde,o=1/i;r.set(this.x*o,this.y*o,this.z*o);const a=Gde;Math.abs(r.x)<.9?(a.set(1,0,0),r.cross(a,e)):(a.set(0,1,0),r.cross(a,e)),r.cross(e,n)}else e.set(1,0,0),n.set(0,1,0)}toString(){return`${this.x},${this.y},${this.z}`}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,n,i){const r=this.x,o=this.y,a=this.z;i.x=r+(e.x-r)*n,i.y=o+(e.y-o)*n,i.z=a+(e.z-a)*n}almostEquals(e,n){return n===void 0&&(n=1e-6),!(Math.abs(this.x-e.x)>n||Math.abs(this.y-e.y)>n||Math.abs(this.z-e.z)>n)}almostZero(e){return e===void 0&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,n){return this.negate(B3),B3.almostEquals(e,n)}clone(){return new pe(this.x,this.y,this.z)}}pe.ZERO=new pe(0,0,0);pe.UNIT_X=new pe(1,0,0);pe.UNIT_Y=new pe(0,1,0);pe.UNIT_Z=new pe(0,0,1);const yde=new pe,Gde=new pe,B3=new pe;class Ga{constructor(e){e===void 0&&(e={}),this.lowerBound=new pe,this.upperBound=new pe,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,n,i,r){const o=this.lowerBound,a=this.upperBound,s=i;o.copy(e[0]),s&&s.vmult(o,o),a.copy(o);for(let l=1;l<e.length;l++){let c=e[l];s&&(s.vmult(c,S3),c=S3),c.x>a.x&&(a.x=c.x),c.x<o.x&&(o.x=c.x),c.y>a.y&&(a.y=c.y),c.y<o.y&&(o.y=c.y),c.z>a.z&&(a.z=c.z),c.z<o.z&&(o.z=c.z)}return n&&(n.vadd(o,o),n.vadd(a,a)),r&&(o.x-=r,o.y-=r,o.z-=r,a.x+=r,a.y+=r,a.z+=r),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return new Ga().copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const n=this.lowerBound,i=this.upperBound,r=e.lowerBound,o=e.upperBound,a=r.x<=i.x&&i.x<=o.x||n.x<=o.x&&o.x<=i.x,s=r.y<=i.y&&i.y<=o.y||n.y<=o.y&&o.y<=i.y,l=r.z<=i.z&&i.z<=o.z||n.z<=o.z&&o.z<=i.z;return a&&s&&l}volume(){const e=this.lowerBound,n=this.upperBound;return(n.x-e.x)*(n.y-e.y)*(n.z-e.z)}contains(e){const n=this.lowerBound,i=this.upperBound,r=e.lowerBound,o=e.upperBound;return n.x<=r.x&&i.x>=o.x&&n.y<=r.y&&i.y>=o.y&&n.z<=r.z&&i.z>=o.z}getCorners(e,n,i,r,o,a,s,l){const c=this.lowerBound,g=this.upperBound;e.copy(c),n.set(g.x,c.y,c.z),i.set(g.x,g.y,c.z),r.set(c.x,g.y,g.z),o.set(g.x,c.y,g.z),a.set(c.x,g.y,c.z),s.set(c.x,c.y,g.z),l.copy(g)}toLocalFrame(e,n){const i=w3,r=i[0],o=i[1],a=i[2],s=i[3],l=i[4],c=i[5],g=i[6],u=i[7];this.getCorners(r,o,a,s,l,c,g,u);for(let d=0;d!==8;d++){const C=i[d];e.pointToLocal(C,C)}return n.setFromPoints(i)}toWorldFrame(e,n){const i=w3,r=i[0],o=i[1],a=i[2],s=i[3],l=i[4],c=i[5],g=i[6],u=i[7];this.getCorners(r,o,a,s,l,c,g,u);for(let d=0;d!==8;d++){const C=i[d];e.pointToWorld(C,C)}return n.setFromPoints(i)}overlapsRay(e){const{direction:n,from:i}=e,r=1/n.x,o=1/n.y,a=1/n.z,s=(this.lowerBound.x-i.x)*r,l=(this.upperBound.x-i.x)*r,c=(this.lowerBound.y-i.y)*o,g=(this.upperBound.y-i.y)*o,u=(this.lowerBound.z-i.z)*a,d=(this.upperBound.z-i.z)*a,C=Math.max(Math.max(Math.min(s,l),Math.min(c,g)),Math.min(u,d)),f=Math.min(Math.min(Math.max(s,l),Math.max(c,g)),Math.max(u,d));return!(f<0||C>f)}}const S3=new pe,w3=[new pe,new pe,new pe,new pe,new pe,new pe,new pe,new pe];class Jr{constructor(e,n,i,r){e===void 0&&(e=0),n===void 0&&(n=0),i===void 0&&(i=0),r===void 0&&(r=1),this.x=e,this.y=n,this.z=i,this.w=r}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}toString(){return`${this.x},${this.y},${this.z},${this.w}`}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,n){const i=Math.sin(n*.5);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(n*.5),this}toAxisAngle(e){e===void 0&&(e=new pe),this.normalize();const n=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,n]}setFromVectors(e,n){if(e.isAntiparallelTo(n)){const i=Bde,r=Sde;e.tangents(i,r),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(n);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(e.length()**2*n.length()**2)+e.dot(n),this.normalize()}return this}mult(e,n){n===void 0&&(n=new Jr);const i=this.x,r=this.y,o=this.z,a=this.w,s=e.x,l=e.y,c=e.z,g=e.w;return n.x=i*g+a*s+r*c-o*l,n.y=r*g+a*l+o*s-i*c,n.z=o*g+a*c+i*l-r*s,n.w=a*g-i*s-r*l-o*c,n}inverse(e){e===void 0&&(e=new Jr);const n=this.x,i=this.y,r=this.z,o=this.w;this.conjugate(e);const a=1/(n*n+i*i+r*r+o*o);return e.x*=a,e.y*=a,e.z*=a,e.w*=a,e}conjugate(e){return e===void 0&&(e=new Jr),e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,n){n===void 0&&(n=new pe);const i=e.x,r=e.y,o=e.z,a=this.x,s=this.y,l=this.z,c=this.w,g=c*i+s*o-l*r,u=c*r+l*i-a*o,d=c*o+a*r-s*i,C=-a*i-s*r-l*o;return n.x=g*c+C*-a+u*-l-d*-s,n.y=u*c+C*-s+d*-a-g*-l,n.z=d*c+C*-l+g*-s-u*-a,n}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,n){n===void 0&&(n="YZX");let i,r,o;const a=this.x,s=this.y,l=this.z,c=this.w;switch(n){case"YZX":const g=a*s+l*c;if(g>.499&&(i=2*Math.atan2(a,c),r=Math.PI/2,o=0),g<-.499&&(i=-2*Math.atan2(a,c),r=-Math.PI/2,o=0),i===void 0){const u=a*a,d=s*s,C=l*l;i=Math.atan2(2*s*c-2*a*l,1-2*d-2*C),r=Math.asin(2*g),o=Math.atan2(2*a*c-2*s*l,1-2*u-2*C)}break;default:throw new Error(`Euler order ${n} not supported yet.`)}e.y=i,e.z=r,e.x=o}setFromEuler(e,n,i,r){r===void 0&&(r="XYZ");const o=Math.cos(e/2),a=Math.cos(n/2),s=Math.cos(i/2),l=Math.sin(e/2),c=Math.sin(n/2),g=Math.sin(i/2);return r==="XYZ"?(this.x=l*a*s+o*c*g,this.y=o*c*s-l*a*g,this.z=o*a*g+l*c*s,this.w=o*a*s-l*c*g):r==="YXZ"?(this.x=l*a*s+o*c*g,this.y=o*c*s-l*a*g,this.z=o*a*g-l*c*s,this.w=o*a*s+l*c*g):r==="ZXY"?(this.x=l*a*s-o*c*g,this.y=o*c*s+l*a*g,this.z=o*a*g+l*c*s,this.w=o*a*s-l*c*g):r==="ZYX"?(this.x=l*a*s-o*c*g,this.y=o*c*s+l*a*g,this.z=o*a*g-l*c*s,this.w=o*a*s+l*c*g):r==="YZX"?(this.x=l*a*s+o*c*g,this.y=o*c*s+l*a*g,this.z=o*a*g-l*c*s,this.w=o*a*s-l*c*g):r==="XZY"&&(this.x=l*a*s-o*c*g,this.y=o*c*s-l*a*g,this.z=o*a*g+l*c*s,this.w=o*a*s+l*c*g),this}clone(){return new Jr(this.x,this.y,this.z,this.w)}slerp(e,n,i){i===void 0&&(i=new Jr);const r=this.x,o=this.y,a=this.z,s=this.w;let l=e.x,c=e.y,g=e.z,u=e.w,d,C,f,v,p;return C=r*l+o*c+a*g+s*u,C<0&&(C=-C,l=-l,c=-c,g=-g,u=-u),1-C>1e-6?(d=Math.acos(C),f=Math.sin(d),v=Math.sin((1-n)*d)/f,p=Math.sin(n*d)/f):(v=1-n,p=n),i.x=v*r+p*l,i.y=v*o+p*c,i.z=v*a+p*g,i.w=v*s+p*u,i}integrate(e,n,i,r){r===void 0&&(r=new Jr);const o=e.x*i.x,a=e.y*i.y,s=e.z*i.z,l=this.x,c=this.y,g=this.z,u=this.w,d=n*.5;return r.x+=d*(o*u+a*g-s*c),r.y+=d*(a*u+s*l-o*g),r.z+=d*(s*u+o*c-a*l),r.w+=d*(-o*l-a*c-s*g),r}}const Bde=new pe,Sde=new pe,wde={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class on{constructor(e){e===void 0&&(e={}),this.id=on.idCounter++,this.type=e.type||0,this.boundingSphereRadius=0,this.collisionResponse=e.collisionResponse?e.collisionResponse:!0,this.collisionFilterGroup=e.collisionFilterGroup!==void 0?e.collisionFilterGroup:1,this.collisionFilterMask=e.collisionFilterMask!==void 0?e.collisionFilterMask:-1,this.material=e.material?e.material:null,this.body=null}updateBoundingSphereRadius(){throw`computeBoundingSphereRadius() not implemented for shape type ${this.type}`}volume(){throw`volume() not implemented for shape type ${this.type}`}calculateLocalInertia(e,n){throw`calculateLocalInertia() not implemented for shape type ${this.type}`}calculateWorldAABB(e,n,i,r){throw`calculateWorldAABB() not implemented for shape type ${this.type}`}}on.idCounter=0;on.types=wde;class Co{constructor(e){e===void 0&&(e={}),this.position=new pe,this.quaternion=new Jr,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,n){return Co.pointToLocalFrame(this.position,this.quaternion,e,n)}pointToWorld(e,n){return Co.pointToWorldFrame(this.position,this.quaternion,e,n)}vectorToWorldFrame(e,n){return n===void 0&&(n=new pe),this.quaternion.vmult(e,n),n}static pointToLocalFrame(e,n,i,r){return r===void 0&&(r=new pe),i.vsub(e,r),n.conjugate(Z3),Z3.vmult(r,r),r}static pointToWorldFrame(e,n,i,r){return r===void 0&&(r=new pe),n.vmult(i,r),r.vadd(e,r),r}static vectorToWorldFrame(e,n,i){return i===void 0&&(i=new pe),e.vmult(n,i),i}static vectorToLocalFrame(e,n,i,r){return r===void 0&&(r=new pe),n.w*=-1,n.vmult(i,r),n.w*=-1,r}}const Z3=new Jr;new pe;new pe;new pe;new pe;new pe,new pe,new pe,new pe,new pe,new pe,new pe,new pe;new pe;new Jr;new Ga;new el;new el;new el;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new Jr;new pe;new pe;new pe;new pe;class DS{constructor(){this.rayFromWorld=new pe,this.rayToWorld=new pe,this.hitNormalWorld=new pe,this.hitPointWorld=new pe,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,n,i,r,o,a,s){this.rayFromWorld.copy(e),this.rayToWorld.copy(n),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(r),this.shape=o,this.body=a,this.distance=s}}let ZL,xL,RL,WL,VL,ML,NL;const P1={CLOSEST:1,ANY:2,ALL:4};ZL=on.types.SPHERE;xL=on.types.PLANE;RL=on.types.BOX;WL=on.types.CYLINDER;VL=on.types.CONVEXPOLYHEDRON;ML=on.types.HEIGHTFIELD;NL=on.types.TRIMESH;class Vr{get[ZL](){return this._intersectSphere}get[xL](){return this._intersectPlane}get[RL](){return this._intersectBox}get[WL](){return this._intersectConvex}get[VL](){return this._intersectConvex}get[ML](){return this._intersectHeightfield}get[NL](){return this._intersectTrimesh}constructor(e,n){e===void 0&&(e=new pe),n===void 0&&(n=new pe),this.from=e.clone(),this.to=n.clone(),this.direction=new pe,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=Vr.ANY,this.result=new DS,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,n){return this.mode=n.mode||Vr.ANY,this.result=n.result||new DS,this.skipBackfaces=!!n.skipBackfaces,this.collisionFilterMask=typeof n.collisionFilterMask<"u"?n.collisionFilterMask:-1,this.collisionFilterGroup=typeof n.collisionFilterGroup<"u"?n.collisionFilterGroup:-1,this.checkCollisionResponse=typeof n.checkCollisionResponse<"u"?n.checkCollisionResponse:!0,n.from&&this.from.copy(n.from),n.to&&this.to.copy(n.to),this.callback=n.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(x3),hB.length=0,e.broadphase.aabbQuery(e,x3,hB),this.intersectBodies(hB),this.hasHit}intersectBody(e,n){n&&(this.result=n,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||!(this.collisionFilterGroup&e.collisionFilterMask)||!(e.collisionFilterGroup&this.collisionFilterMask))return;const r=Zde,o=xde;for(let a=0,s=e.shapes.length;a<s;a++){const l=e.shapes[a];if(!(i&&!l.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[a],o),e.quaternion.vmult(e.shapeOffsets[a],r),r.vadd(e.position,r),this.intersectShape(l,o,r,e),this.result.shouldStop))break}}intersectBodies(e,n){n&&(this.result=n,this.updateDirection());for(let i=0,r=e.length;!this.result.shouldStop&&i<r;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,n,i,r){const o=this.from;if(Tde(o,this.direction,i)>e.boundingSphereRadius)return;const s=this[e.type];s&&s.call(this,e,n,i,r,e)}_intersectBox(e,n,i,r,o){return this._intersectConvex(e.convexPolyhedronRepresentation,n,i,r,o)}_intersectPlane(e,n,i,r,o){const a=this.from,s=this.to,l=this.direction,c=new pe(0,0,1);n.vmult(c,c);const g=new pe;a.vsub(i,g);const u=g.dot(c);s.vsub(i,g);const d=g.dot(c);if(u*d>0||a.distanceTo(s)<u)return;const C=c.dot(l);if(Math.abs(C)<this.precision)return;const f=new pe,v=new pe,p=new pe;a.vsub(i,f);const m=-c.dot(f)/C;l.scale(m,v),a.vadd(v,p),this.reportIntersection(c,p,o,r,-1)}getAABB(e){const{lowerBound:n,upperBound:i}=e,r=this.to,o=this.from;n.x=Math.min(r.x,o.x),n.y=Math.min(r.y,o.y),n.z=Math.min(r.z,o.z),i.x=Math.max(r.x,o.x),i.y=Math.max(r.y,o.y),i.z=Math.max(r.z,o.z)}_intersectHeightfield(e,n,i,r,o){e.data,e.elementSize;const a=Rde;a.from.copy(this.from),a.to.copy(this.to),Co.pointToLocalFrame(i,n,a.from,a.from),Co.pointToLocalFrame(i,n,a.to,a.to),a.updateDirection();const s=Wde;let l,c,g,u;l=c=0,g=u=e.data.length-1;const d=new Ga;a.getAABB(d),e.getIndexOfPosition(d.lowerBound.x,d.lowerBound.y,s,!0),l=Math.max(l,s[0]),c=Math.max(c,s[1]),e.getIndexOfPosition(d.upperBound.x,d.upperBound.y,s,!0),g=Math.min(g,s[0]+1),u=Math.min(u,s[1]+1);for(let C=l;C<g;C++)for(let f=c;f<u;f++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(C,f,d),!!d.overlapsRay(a)){if(e.getConvexTrianglePillar(C,f,!1),Co.pointToWorldFrame(i,n,e.pillarOffset,zA),this._intersectConvex(e.pillarConvex,n,zA,r,o,R3),this.result.shouldStop)return;e.getConvexTrianglePillar(C,f,!0),Co.pointToWorldFrame(i,n,e.pillarOffset,zA),this._intersectConvex(e.pillarConvex,n,zA,r,o,R3)}}}_intersectSphere(e,n,i,r,o){const a=this.from,s=this.to,l=e.radius,c=(s.x-a.x)**2+(s.y-a.y)**2+(s.z-a.z)**2,g=2*((s.x-a.x)*(a.x-i.x)+(s.y-a.y)*(a.y-i.y)+(s.z-a.z)*(a.z-i.z)),u=(a.x-i.x)**2+(a.y-i.y)**2+(a.z-i.z)**2-l**2,d=g**2-4*c*u,C=Vde,f=Mde;if(!(d<0))if(d===0)a.lerp(s,d,C),C.vsub(i,f),f.normalize(),this.reportIntersection(f,C,o,r,-1);else{const v=(-g-Math.sqrt(d))/(2*c),p=(-g+Math.sqrt(d))/(2*c);if(v>=0&&v<=1&&(a.lerp(s,v,C),C.vsub(i,f),f.normalize(),this.reportIntersection(f,C,o,r,-1)),this.result.shouldStop)return;p>=0&&p<=1&&(a.lerp(s,p,C),C.vsub(i,f),f.normalize(),this.reportIntersection(f,C,o,r,-1))}}_intersectConvex(e,n,i,r,o,a){const s=Nde,l=W3,c=a&&a.faceList||null,g=e.faces,u=e.vertices,d=e.faceNormals,C=this.direction,f=this.from,v=this.to,p=f.distanceTo(v),m=c?c.length:g.length,A=this.result;for(let b=0;!A.shouldStop&&b<m;b++){const G=c?c[b]:b,w=g[G],S=d[G],Z=n,x=i;l.copy(u[w[0]]),Z.vmult(l,l),l.vadd(x,l),l.vsub(f,l),Z.vmult(S,s);const R=C.dot(s);if(Math.abs(R)<this.precision)continue;const W=s.dot(l)/R;if(!(W<0)){C.scale(W,go),go.vadd(f,go),Fa.copy(u[w[0]]),Z.vmult(Fa,Fa),x.vadd(Fa,Fa);for(let M=1;!A.shouldStop&&M<w.length-1;M++){us.copy(u[w[M]]),ds.copy(u[w[M+1]]),Z.vmult(us,us),Z.vmult(ds,ds),x.vadd(us,us),x.vadd(ds,ds);const N=go.distanceTo(f);!(Vr.pointInTriangle(go,Fa,us,ds)||Vr.pointInTriangle(go,us,Fa,ds))||N>p||this.reportIntersection(s,go,o,r,G)}}}}_intersectTrimesh(e,n,i,r,o,a){const s=Fde,l=Kde,c=Lde,g=W3,u=Hde,d=Xde,C=Ede,f=zde,v=Yde,p=e.indices;e.vertices;const m=this.from,A=this.to,b=this.direction;c.position.copy(i),c.quaternion.copy(n),Co.vectorToLocalFrame(i,n,b,u),Co.pointToLocalFrame(i,n,m,d),Co.pointToLocalFrame(i,n,A,C),C.x*=e.scale.x,C.y*=e.scale.y,C.z*=e.scale.z,d.x*=e.scale.x,d.y*=e.scale.y,d.z*=e.scale.z,C.vsub(d,u),u.normalize();const G=d.distanceSquared(C);e.tree.rayQuery(this,c,l);for(let w=0,S=l.length;!this.result.shouldStop&&w!==S;w++){const Z=l[w];e.getNormal(Z,s),e.getVertex(p[Z*3],Fa),Fa.vsub(d,g);const x=u.dot(s),R=s.dot(g)/x;if(R<0)continue;u.scale(R,go),go.vadd(d,go),e.getVertex(p[Z*3+1],us),e.getVertex(p[Z*3+2],ds);const W=go.distanceSquared(d);!(Vr.pointInTriangle(go,us,Fa,ds)||Vr.pointInTriangle(go,Fa,us,ds))||W>G||(Co.vectorToWorldFrame(n,s,v),Co.pointToWorldFrame(i,n,go,f),this.reportIntersection(v,f,o,r,Z))}l.length=0}reportIntersection(e,n,i,r,o){const a=this.from,s=this.to,l=a.distanceTo(n),c=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(c.hitFaceIndex=typeof o<"u"?o:-1,this.mode){case Vr.ALL:this.hasHit=!0,c.set(a,s,e,n,i,r,l),c.hasHit=!0,this.callback(c);break;case Vr.CLOSEST:(l<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(a,s,e,n,i,r,l));break;case Vr.ANY:this.hasHit=!0,c.hasHit=!0,c.set(a,s,e,n,i,r,l),c.shouldStop=!0;break}}static pointInTriangle(e,n,i,r){r.vsub(n,ng),i.vsub(n,rC),e.vsub(n,fB);const o=ng.dot(ng),a=ng.dot(rC),s=ng.dot(fB),l=rC.dot(rC),c=rC.dot(fB);let g,u;return(g=l*s-a*c)>=0&&(u=o*c-a*s)>=0&&g+u<o*l-a*a}}Vr.CLOSEST=P1.CLOSEST;Vr.ANY=P1.ANY;Vr.ALL=P1.ALL;const x3=new Ga,hB=[],rC=new pe,fB=new pe,Zde=new pe,xde=new Jr,go=new pe,Fa=new pe,us=new pe,ds=new pe;new pe;new DS;const R3={faceList:[0]},zA=new pe,Rde=new Vr,Wde=[],Vde=new pe,Mde=new pe,Nde=new pe;new pe;new pe;const W3=new pe,Fde=new pe,Hde=new pe,Xde=new pe,Ede=new pe,Yde=new pe,zde=new pe;new Ga;const Kde=[],Lde=new Co,ng=new pe,KA=new pe;function Tde(t,e,n){n.vsub(t,ng);const i=ng.dot(e);return e.scale(i,KA),KA.vadd(t,KA),n.distanceTo(KA)}new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new Vr;new pe;new pe;new pe;new pe(1,0,0),new pe(0,1,0),new pe(0,0,1);new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new Ga;new pe;new Ga;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new Ga;new pe;new Co;new Ga;on.types.SPHERE,on.types.SPHERE|on.types.PLANE,on.types.BOX|on.types.BOX,on.types.SPHERE|on.types.BOX,on.types.PLANE|on.types.BOX,on.types.CONVEXPOLYHEDRON,on.types.SPHERE|on.types.CONVEXPOLYHEDRON,on.types.PLANE|on.types.CONVEXPOLYHEDRON,on.types.BOX|on.types.CONVEXPOLYHEDRON,on.types.SPHERE|on.types.HEIGHTFIELD,on.types.BOX|on.types.HEIGHTFIELD,on.types.CONVEXPOLYHEDRON|on.types.HEIGHTFIELD,on.types.PARTICLE|on.types.SPHERE,on.types.PLANE|on.types.PARTICLE,on.types.BOX|on.types.PARTICLE,on.types.PARTICLE|on.types.CONVEXPOLYHEDRON,on.types.CYLINDER,on.types.SPHERE|on.types.CYLINDER,on.types.PLANE|on.types.CYLINDER,on.types.BOX|on.types.CYLINDER,on.types.CONVEXPOLYHEDRON|on.types.CYLINDER,on.types.HEIGHTFIELD|on.types.CYLINDER,on.types.PARTICLE|on.types.CYLINDER,on.types.SPHERE|on.types.TRIMESH,on.types.PLANE|on.types.TRIMESH;new pe;new pe;new pe;new pe;new pe;new Jr;new Jr;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new Ga;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe,new pe,new pe,new pe,new pe,new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new Jr;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new pe;new Ga;new Vr;const oC=globalThis.performance||{};if(!oC.now){let t=Date.now();oC.timing&&oC.timing.navigationStart&&(t=oC.timing.navigationStart),oC.now=()=>Date.now()-t}new pe;const _de=y.createContext(null),kde=()=>y.useContext(_de),FL=y.createContext(null),Pde=()=>{const t=y.useContext(FL);if(!t)throw new Error("Physics context not found. @react-three/cannon & components can only be used within a Physics provider");return t};new ge(1,1,1);new ge;new ln;const V3=new Vn;function Ude(t){const e=y.useRef(null);return t&&typeof t!="function"?t:e}function M3(t){return t.charAt(0).toUpperCase()+t.slice(1)}function gr(t,e){const n=e===void 0?"":`/${e}`;return typeof t=="function"?null:t&&t.current&&`${t.current.uuid}${n}`}const Dde=new Ei,Ode=new sr,Jde=t=>e=>t(Dde.setFromQuaternion(Ode.fromArray(e)).toArray());let HL=0;function mB(t,e,n,i,r,o){return o===void 0&&(o="bodies"),a=>{const s=HL++;n[s]={[i]:a};const l=gr(t,r);return l&&e.subscribe({props:{id:s,target:o,type:i},uuid:l}),()=>{delete n[s],e.unsubscribe({props:s})}}}function N3(t,e){let{position:n=[0,0,0],rotation:i=[0,0,0],userData:r={}}=e;t.userData=r,t.position.set(...n),t.rotation.set(...i),t.updateMatrix()}function F3(t,e,n){let{onCollide:i,onCollideBegin:r,onCollideEnd:o}=e;t[n]={collide:i,collideBegin:r,collideEnd:o}}function XL(t,e,n,i,r){i===void 0&&(i=null),r===void 0&&(r=[]);const o=Ude(i),{events:a,refs:s,scaleOverrides:l,subscriptions:c,worker:g}=Pde(),u=kde();y.useLayoutEffect(()=>{o.current||(o.current=new Vn);const C=o.current,f=g,v=C instanceof vd?(C.instanceMatrix.setUsage(c9),C.count):1,p=C instanceof vd?new Array(v).fill(0).map((A,b)=>`${C.uuid}/${b}`):[C.uuid],m=C instanceof vd?p.map((A,b)=>{const G=e(b);return N3(V3,G),C.setMatrixAt(b,V3.matrix),C.instanceMatrix.needsUpdate=!0,s[A]=C,u==null||u.add(A,G,t),F3(a,G,A),{...G,args:n(G.args)}}):p.map((A,b)=>{const G=e(b);return N3(C,G),s[A]=C,u==null||u.add(A,G,t),F3(a,G,A),{...G,args:n(G.args)}});return f.addBodies({props:m.map(A=>{let{onCollide:b,onCollideBegin:G,onCollideEnd:w,...S}=A;return{onCollide:!!b,...S}}),type:t,uuid:p}),()=>{p.forEach(A=>{delete s[A],u==null||u.remove(A),delete a[A]}),f.removeBodies({uuid:p})}},r);const d=y.useMemo(()=>{const C=(b,G)=>{const w=`set${M3(b)}`;return{set:S=>{const Z=gr(o,G);Z&&g[w]({props:S,uuid:Z})},subscribe:mB(o,g,c,b,G)}},f=b=>({copy:w=>{let{w:S,x:Z,y:x,z:R}=w;const W=gr(o,b);W&&g.setQuaternion({props:[Z,x,R,S],uuid:W})},set:(w,S,Z,x)=>{const R=gr(o,b);R&&g.setQuaternion({props:[w,S,Z,x],uuid:R})},subscribe:mB(o,g,c,"quaternion",b)}),v=b=>({copy:G=>{let{x:w,y:S,z:Z}=G;const x=gr(o,b);x&&g.setRotation({props:[w,S,Z],uuid:x})},set:(G,w,S)=>{const Z=gr(o,b);Z&&g.setRotation({props:[G,w,S],uuid:Z})},subscribe:G=>{const w=HL++,S="bodies",Z="quaternion",x=gr(o,b);return c[w]={[Z]:Jde(G)},x&&g.subscribe({props:{id:w,target:S,type:Z},uuid:x}),()=>{delete c[w],g.unsubscribe({props:w})}}}),p=(b,G)=>{const w=`set${M3(b)}`;return{copy:S=>{let{x:Z,y:x,z:R}=S;const W=gr(o,G);W&&g[w]({props:[Z,x,R],uuid:W})},set:(S,Z,x)=>{const R=gr(o,G);R&&g[w]({props:[S,Z,x],uuid:R})},subscribe:mB(o,g,c,b,G)}};function m(b){return{allowSleep:C("allowSleep",b),angularDamping:C("angularDamping",b),angularFactor:p("angularFactor",b),angularVelocity:p("angularVelocity",b),applyForce(G,w){const S=gr(o,b);S&&g.applyForce({props:[G,w],uuid:S})},applyImpulse(G,w){const S=gr(o,b);S&&g.applyImpulse({props:[G,w],uuid:S})},applyLocalForce(G,w){const S=gr(o,b);S&&g.applyLocalForce({props:[G,w],uuid:S})},applyLocalImpulse(G,w){const S=gr(o,b);S&&g.applyLocalImpulse({props:[G,w],uuid:S})},applyTorque(G){const w=gr(o,b);w&&g.applyTorque({props:[G],uuid:w})},collisionFilterGroup:C("collisionFilterGroup",b),collisionFilterMask:C("collisionFilterMask",b),collisionResponse:C("collisionResponse",b),fixedRotation:C("fixedRotation",b),isTrigger:C("isTrigger",b),linearDamping:C("linearDamping",b),linearFactor:p("linearFactor",b),mass:C("mass",b),material:C("material",b),position:p("position",b),quaternion:f(b),rotation:v(b),scaleOverride(G){const w=gr(o,b);w&&(l[w]=new ge(...G))},sleep(){const G=gr(o,b);G&&g.sleep({uuid:G})},sleepSpeedLimit:C("sleepSpeedLimit",b),sleepTimeLimit:C("sleepTimeLimit",b),userData:C("userData",b),velocity:p("velocity",b),wakeUp(){const G=gr(o,b);G&&g.wakeUp({uuid:G})}}}const A={};return{...m(void 0),at:b=>A[b]||(A[b]=m(b))}},[]);return[o,d]}function Qde(t,e,n){return XL("Plane",t,()=>[],e,n)}function jde(t,e,n){const i=[1,1,1];return XL("Box",t,function(r){return r===void 0&&(r=i),r},e,n)}const $de=new ge,qde=new ge(1,1,1),eIe=new sr,LA=new ln;function H3(t,e,n,i,r){return i===void 0&&(i=qde),t!==void 0?(LA.compose($de.fromArray(e,t*3),eIe.fromArray(n,t*4),i),r&&(r.matrixAutoUpdate=!1,r.matrix.copy(LA)),LA):LA.identity()}const tIe=()=>{const t=[];return e=>t.includes(e)?!1:!!t.push(e)};function nIe(t){let{allowSleep:e=!1,axisIndex:n=0,broadphase:i="Naive",children:r,defaultContactMaterial:o={contactEquationStiffness:1e6},frictionGravity:a=null,gravity:s=[0,-9.81,0],isPaused:l=!1,iterations:c=5,maxSubSteps:g=10,quatNormalizeFast:u=!1,quatNormalizeSkip:d=0,shouldInvalidate:C=!0,size:f=1e3,solver:v="GS",stepSize:p=1/60,tolerance:m=.001}=t;const{invalidate:A}=Dr(),[{bodies:b,events:G,refs:w,scaleOverrides:S,subscriptions:Z,worker:x}]=y.useState(()=>({bodies:{},events:{},refs:{},scaleOverrides:{},subscriptions:{},worker:new $ue({allowSleep:e,axisIndex:n,broadphase:i,defaultContactMaterial:o,frictionGravity:a,gravity:s,iterations:c,quatNormalizeFast:u,quatNormalizeSkip:d,size:f,solver:v,tolerance:m})}));let R=0;const W=y.useCallback((J,F)=>{l||(R+=F,x.step({maxSubSteps:g,stepSize:p,timeSinceLastCalled:R}),R=0)},[l,g,p]),M=J=>{var F;let{body:L,contact:{bi:z,bj:K,...O},target:j,...P}=J;const $=(F=G[j])==null?void 0:F.collide;$&&$({body:w[L],contact:{bi:w[z],bj:w[K],...O},target:w[j],...P})},N=J=>{var F,L;let{bodyA:z,bodyB:K}=J;const O=(F=G[z])==null?void 0:F.collideBegin;O&&O({body:w[K],op:"event",target:w[z],type:"collideBegin"});const j=(L=G[K])==null?void 0:L.collideBegin;j&&j({body:w[z],op:"event",target:w[K],type:"collideBegin"})},X=J=>{var F,L;let{bodyA:z,bodyB:K}=J;const O=(F=G[z])==null?void 0:F.collideEnd;O&&O({body:w[K],op:"event",target:w[z],type:"collideEnd"});const j=(L=G[K])==null?void 0:L.collideEnd;j&&j({body:w[z],op:"event",target:w[K],type:"collideEnd"})},E=J=>{let{active:F,bodies:L=[],observations:z,positions:K,quaternions:O}=J;for(let j=0;j<L.length;j++)b[L[j]]=j;if(z.forEach(j=>{let[P,$,oe]=j;const de=(Z[P]||{})[oe];de&&de($)}),!!F){for(const j of Object.values(w).filter(tIe()))if(j instanceof vd)for(let P=0;P<j.count;P++){const $=`${j.uuid}/${P}`,oe=b[$];oe!==void 0&&(j.setMatrixAt(P,H3(oe,K,O,S[$])),j.instanceMatrix.needsUpdate=!0)}else{const P=S[j.uuid]||j.scale;H3(b[j.uuid],K,O,P,j)}C&&A()}},Q=J=>{var F;let{body:L,ray:{uuid:z,...K},...O}=J;const j=(F=G[z])==null?void 0:F.rayhit;j&&j({body:L?w[L]:null,ray:{uuid:z,...K},...O})};N1(W),y.useEffect(()=>(x.connect(),x.init(),x.on("collide",M),x.on("collideBegin",N),x.on("collideEnd",X),x.on("frame",E),x.on("rayhit",Q),()=>{x.terminate(),x.removeAllListeners()}),[]),y.useEffect(()=>{x.axisIndex=n},[n]),y.useEffect(()=>{x.broadphase=i},[i]),y.useEffect(()=>{x.gravity=s},[s]),y.useEffect(()=>{x.iterations=c},[c]),y.useEffect(()=>{x.tolerance=m},[m]);const k=y.useMemo(()=>({bodies:b,events:G,refs:w,scaleOverrides:S,subscriptions:Z,worker:x}),[b,G,w,Z,x]);return Nt.jsx(FL.Provider,{value:k,children:r})}function iIe({showDice:t,diceFaces:e}){try{return Nt.jsx(rIe,{showDice:t,diceFaces:e})}catch(n){return console.error("Error en DiceThreeJS:",n),Nt.jsxs("div",{style:{color:"white",textAlign:"center",padding:"20px"},children:[Nt.jsx("h3",{children:"Error al cargar el dado 3D"}),Nt.jsx("p",{children:"Tu navegador podra no soportar WebGL."})]})}}function rIe({showDice:t,diceFaces:e}){const[n,i]=y.useState(!1),[r,o]=y.useState(!0);return y.useEffect(()=>{const a=document.createElement("canvas");a.getContext("webgl")||a.getContext("webgl2")||o(!1),a.remove()},[]),y.useEffect(()=>{t||i(!1)},[t]),t?r?Nt.jsxs("div",{style:{width:"100%",height:"100%",position:"relative"},children:[Nt.jsx("div",{style:{position:"absolute",top:"20px",left:"50%",transform:"translateX(-50%)",zIndex:10},children:Nt.jsx("button",{disabled:n,onClick:()=>i(!0),style:{padding:"12px 24px",fontSize:"16px",backgroundColor:n?"#666":"#048FC9",color:"white",border:"2px solid white",borderRadius:"8px",cursor:n?"not-allowed":"pointer",boxShadow:"0px 4px 10px rgba(0, 0, 0, 0.3)"},children:n?"Tirando...":"Tirar Dado"})})," ",Nt.jsxs(tge,{shadows:!0,camera:{position:[0,4,8],fov:48},style:{width:"100%",height:"100vh",position:"absolute",top:0,left:0,zIndex:0},gl:{antialias:!0,alpha:!0,preserveDrawingBuffer:!1},children:[Nt.jsx(Kue,{preset:"warehouse"}),Nt.jsx("ambientLight",{intensity:.5}),Nt.jsx("directionalLight",{position:[5,5,5],intensity:1,castShadow:!0}),Nt.jsxs(nIe,{gravity:[0,-9.8,0],children:[Nt.jsx(oIe,{}),Nt.jsx(aIe,{isRolling:n,setIsRolling:i,diceFaces:e})]}),Nt.jsx(yue,{enablePan:!1,enableZoom:!1})]})]}):Nt.jsxs("div",{style:{color:"white",textAlign:"center",padding:"20px"},children:[Nt.jsx("h3",{children:"WebGL no soportado"}),Nt.jsx("p",{children:"Tu navegador no soporta WebGL requerido para el dado 3D."})]}):null}function oIe(){const t=y.useRef(null);return Qde(()=>({rotation:[-Math.PI/2,0,0],position:[0,0,0]}),t),Nt.jsxs("mesh",{ref:t,receiveShadow:!0,children:[Nt.jsx("planeGeometry",{args:[10,10]}),Nt.jsx("meshStandardMaterial",{color:"#E33",transparent:!0,opacity:0})]})}function aIe({isRolling:t,setIsRolling:e,diceFaces:n}){const[i,r]=jde(()=>({mass:1,position:[0,2,0],args:[2,2,2],onCollide:()=>e(!1)}));return y.useEffect(()=>{t&&(r.position.set(0,2,0),r.velocity.set((Math.random()-.5)*2,Math.random()*5+2,(Math.random()-.5)*2),r.angularVelocity.set((Math.random()-.5)*7,(Math.random()-.5)*5,(Math.random()-.5)*5))},[t,r]),Nt.jsxs("mesh",{ref:i,castShadow:!0,scale:[1,1,1],children:[Nt.jsx("boxGeometry",{args:[2,2,2]}),Nt.jsx("meshStandardMaterial",{color:"white"}),n.map((o,a)=>Nt.jsx(sIe,{text:o,faceIndex:a},a))]})}function sIe({text:t,faceIndex:e}){const n=[{pos:new ge(0,0,1.01),rot:new Ei(0,0,0)},{pos:new ge(0,0,-1.01),rot:new Ei(0,Math.PI,0)},{pos:new ge(0,1.01,0),rot:new Ei(-Math.PI/2,0,0)},{pos:new ge(0,-1.01,0),rot:new Ei(Math.PI/2,0,0)},{pos:new ge(1.01,0,0),rot:new Ei(0,Math.PI/2,0)},{pos:new ge(-1.01,0,0),rot:new Ei(0,-Math.PI/2,0)}],{pos:i,rot:r}=n[e];return Nt.jsx(bue,{position:i,rotation:r,fontSize:.5,color:"black",anchorX:"center",anchorY:"middle",children:t})}const lIe=()=>{const[t,e]=y.useState([]),[n,i]=y.useState(null),[r,o]=y.useState(!1),[a,s]=y.useState(""),[l,c]=y.useState(""),[g,u]=y.useState(!1),[d,C]=y.useState(!1),[f,v]=y.useState(null),[p,m]=y.useState(!1),[A,b]=y.useState(!1),[G,w]=y.useState(!0),[S,Z]=y.useState(2),[x,R]=y.useState(!1),[W]=y.useState(["1","2","3","4","Hable","Alto"]),M=["#FF5733","#FFD700","#2ECC71","#E74C3C"],N=28,X=Nt.jsx(aZ,{spin:!0,style:{fontSize:"48px",color:"#ff2d66"}}),E={"--button-bg-color":"#584ea7","--button-color":"#f5f5f5","--button-box-shadow":"0px 4px 10px rgba(0, 0, 0, 0.2)"},[Q,k]=y.useState([]),[J,F]=y.useState(null),[L,z]=y.useState({x:0,y:0});y.useEffect(()=>{(async()=>{try{const ae=await(await fetch("/questions.json")).json(),He=JSON.parse(localStorage.getItem("questions")||"null");He?e(He):(e(ae),localStorage.setItem("questions",JSON.stringify(ae)))}catch(he){console.error("Error loading questions:",he),e([])}})()},[]);const K=()=>{if(b(!1),m(!1),o(!0),t.length===0){i(null);return}const ne=Math.floor(Math.random()*t.length),he=t[ne],ae=t.filter((He,ve)=>ve!==ne);e(ae),i(he),setTimeout(()=>{o(!1),m(!0)},1e3)},O=()=>{localStorage.setItem("questions",JSON.stringify(t))},j=()=>{if(a.trim()!==""&&l.trim()!==""&&f!==null){const ne=[...t];ne[f]={question:a,answer:l},e(ne),s(""),c(""),v(null),C(!1),O()}},P=ne=>{const he=t.filter((ae,He)=>He!==ne);e(he),O()},$=()=>{if(a.trim()!==""&&l.trim()!==""){const ne=[...t,{question:a,answer:l}];e(ne),s(""),c(""),O()}},oe=async()=>{localStorage.removeItem("questions");const he=await(await fetch("/questions.json")).json();e(he),localStorage.setItem("questions",JSON.stringify(he))},ie=(ne,he)=>{ne.preventDefault(),F(he);const ae=Q.find(He=>He.id===he);ae&&z({x:ne.clientX-ae.x,y:ne.clientY-ae.y}),document.body.style.userSelect="none"},de=(ne,he)=>{ne.preventDefault();const ae=ne.touches[0];F(he);const He=Q.find(ve=>ve.id===he);He&&z({x:ae.clientX-He.x,y:ae.clientY-He.y}),document.body.style.userSelect="none"},Ve=ne=>{J!==null&&k(he=>he.map(ae=>ae.id===J?{...ae,x:Math.max(N,Math.min(window.innerWidth-N,ne.clientX-L.x)),y:Math.max(N,Math.min(window.innerHeight-N,ne.clientY-L.y))}:ae))},Se=ne=>{if(J!==null){ne.preventDefault();const he=ne.touches[0];k(ae=>ae.map(He=>He.id===J?{...He,x:Math.max(N,Math.min(window.innerWidth-N,he.clientX-L.x)),y:Math.max(N,Math.min(window.innerHeight-N,he.clientY-L.y))}:He))}},me=()=>{F(null),document.body.style.userSelect="auto"},T=()=>{F(null),document.body.style.userSelect="auto"};y.useEffect(()=>{if(J!==null)return window.addEventListener("mousemove",Ve),window.addEventListener("mouseup",me),window.addEventListener("touchmove",Se,{passive:!1}),window.addEventListener("touchend",T),()=>{window.removeEventListener("mousemove",Ve),window.removeEventListener("mouseup",me),window.removeEventListener("touchmove",Se),window.removeEventListener("touchend",T)}},[J]);const Ge=()=>{const ne=window.innerWidth,he=window.innerHeight,ae=ne<=768,He=ae?100:150,ve=ae?80:100;return[{x:He,y:ve},{x:ne-He,y:ve},{x:He,y:he-ve},{x:ne-He,y:he-ve}]};return y.useEffect(()=>{if(!G){const ne=Ge();k(Array.from({length:S}).map((he,ae)=>({id:ae,color:M[ae],x:ne[ae].x,y:ne[ae].y})))}},[G,S]),y.useEffect(()=>{const ne=()=>{if(!G&&Q.length>0){const he=Ge();k(ae=>ae.map((He,ve)=>{var Me,q;return{...He,x:((Me=he[ve])==null?void 0:Me.x)||He.x,y:((q=he[ve])==null?void 0:q.y)||He.y}}))}};return window.addEventListener("resize",ne),()=>window.removeEventListener("resize",ne)},[G,Q.length]),Nt.jsxs("div",{className:"container",style:{padding:"20px",position:"relative",width:"100%",height:"100vh",overflow:"hidden",zIndex:2},children:[n===null&&r&&Nt.jsx("h2",{children:"No hay ms preguntas"}),r&&n!==null&&Nt.jsx("div",{className:"flex justify-center items-center",style:{margin:"25px",padding:"25px"},children:Nt.jsx(YZ,{indicator:X})}),n&&!r&&p&&Nt.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100%",height:"100vh",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center"},children:Nt.jsxs(EZ,{className:"fade-in cartapregunta",bordered:!1,style:{position:"relative",minWidth:320,maxWidth:420,width:"90vw",boxShadow:"0 8px 32px rgba(0,0,0,0.4)"},bodyStyle:{paddingTop:48},children:[Nt.jsx(nr,{type:"text",onClick:()=>m(!1),style:{position:"absolute",top:8,right:8,zIndex:101,fontSize:20},children:""}),Nt.jsx("h2",{style:{fontSize:"1.9rem",fontWeight:"bold"},children:n.question}),!A&&Nt.jsx(nr,{style:{marginTop:"10px",backgroundColor:"#2b2926",color:"white",borderColor:"#2b2926",boxShadow:"0px 4px 10px rgba(0, 0, 0, 0.2)"},onClick:()=>b(!0),children:"Ver Respuesta"}),A&&Nt.jsx("p",{style:{marginTop:"10px",color:"#2434a5",fontSize:"1.6rem",fontWeight:"semibold"},children:n.answer})]})})," ",Nt.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",marginTop:"20px",position:"relative",zIndex:50},children:Nt.jsx(nr,{type:"default",className:"custom-button",onClick:K,style:{minHeight:"50px",width:"220px",fontSize:"16px",fontWeight:"bold",...E},children:"OBTENER PREGUNTA"})})," ",Nt.jsx(nr,{type:"default",onClick:()=>R(!0),className:"dice-button",style:{position:"absolute",top:"20px",left:"20px",width:"60px",height:"60px",borderRadius:"12px",fontSize:"24px",display:"flex",alignItems:"center",justifyContent:"center",...E},title:x?"Cerrar dado":"Activar dado",children:""})," ",Nt.jsx(nr,{type:"default",icon:Nt.jsx(ote,{}),onClick:()=>u(!0),className:"settings-button",style:{position:"absolute",top:"20px",right:"20px",width:"50px",height:"50px",borderRadius:"8px"},title:"Configurar preguntas"}),Nt.jsxs(_o,{title:"Configurar Preguntas",open:g,onCancel:()=>u(!1),footer:null,children:[Nt.jsx("h3",{children:"Agregar Nueva Pregunta"}),Nt.jsx(js,{placeholder:"Escribe una nueva pregunta",value:a,onChange:ne=>s(ne.target.value),style:{marginBottom:"10px"}}),Nt.jsx(js,{placeholder:"Escribe la respuesta",value:l,onChange:ne=>c(ne.target.value),style:{marginBottom:"10px"}}),Nt.jsx(nr,{type:"primary",icon:Nt.jsx(PY,{}),onClick:$,style:{marginTop:"10px",minHeight:"50px"},children:"Agregar Pregunta"}),Nt.jsx("h3",{style:{marginTop:"20px"},children:"Listado de Preguntas"}),Nt.jsx(pS,{dataSource:t,renderItem:(ne,he)=>Nt.jsx(pS.Item,{actions:[Nt.jsx(nr,{type:"link",icon:Nt.jsx(nte,{}),onClick:()=>{v(he),s(ne.question),c(ne.answer||""),C(!0)},children:"Editar"}),Nt.jsx(nr,{style:{minHeight:"50px"},type:"link",icon:Nt.jsx(qee,{}),danger:!0,onClick:()=>P(he),children:"Eliminar"})],children:ne.question})}),Nt.jsx(nr,{type:"default",danger:!0,style:{marginTop:"20px",minHeight:"50px"},onClick:oe,children:"Restaurar Preguntas Predeterminadas"})]}),Nt.jsxs(_o,{title:"Editar Pregunta",open:d,onCancel:()=>C(!1),onOk:j,okText:"Guardar",cancelText:"Cancelar",children:[Nt.jsx(js,{placeholder:"Edita la pregunta",value:a,onChange:ne=>s(ne.target.value)}),Nt.jsx(js,{placeholder:"Edita la respuesta",value:l,onChange:ne=>c(ne.target.value)})]}),Nt.jsxs(_o,{title:"Selecciona la cantidad de jugadores",open:G,footer:null,closable:!1,centered:!0,children:[Nt.jsx("div",{style:{display:"flex",justifyContent:"center",gap:16},children:[2,3].map(ne=>Nt.jsx(nr,{type:S===ne?"primary":"default",onClick:()=>Z(ne),style:{width:60,height:60,fontSize:24,borderRadius:"50%"},children:ne},ne))}),Nt.jsx(nr,{type:"primary",style:{marginTop:24,width:"100%",minHeight:"50px",borderRadius:8},onClick:()=>w(!1),children:"Comenzar"})]})," ",Q.map(ne=>Nt.jsx("div",{className:"player-token",onMouseDown:he=>ie(he,ne.id),onTouchStart:he=>de(he,ne.id),style:{position:"absolute",left:ne.x-N,top:ne.y-N,width:N*2,height:N*2,borderRadius:"50%",background:ne.color,border:"3px solid #fff",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",cursor:"grab",zIndex:10,display:G?"none":"block",transition:J===ne.id?"none":"box-shadow 0.2s",touchAction:"none"},children:Nt.jsxs("span",{style:{color:"#fff",fontWeight:"bold",fontSize:22,lineHeight:`${N*2}px`,textAlign:"center",width:"100%",display:"block",userSelect:"none"},children:[ne.id+1," "]})},ne.id))," ",x&&Nt.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100vh",backgroundColor:"transparent",zIndex:200,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:[Nt.jsx(nr,{onClick:()=>R(!1),style:{position:"absolute",top:20,right:20,zIndex:210,fontSize:18,pointerEvents:"auto",...E},children:" Cerrar"}),Nt.jsx("div",{style:{width:"100%",height:"100%",pointerEvents:"auto"},children:Nt.jsx(iIe,{showDice:x,diceFaces:W})})]})]})};JH(document.getElementById("root")).render(Nt.jsx(y.StrictMode,{children:Nt.jsx(lIe,{})}));
